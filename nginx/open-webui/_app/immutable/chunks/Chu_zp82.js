var Wr=Object.defineProperty;var qr=(n,e,t)=>e in n?Wr(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var vt=(n,e,t)=>qr(n,typeof e!="symbol"?e+"":e,t);import{S as He,i as ze,s as Re,l as A,e as E,t as q,C as Q,p as H,c as N,a as k,b as F,d as h,D as $,f as c,g as I,h as p,E as X,L as ot,G as ce,j as Z,q as b,r as y,F as Y,X as Fe,P as et,k as Te,v as Ge,T as Tt,w as It,H as We,I as Ze,K as Qe,x as xn,z as er,A as tr,B as lr,y as x,u as ee,$ as st,m as ae,n as Ne,Z as jt,U as sr,M as Oe,N as _e,O as pe,a7 as vl,ao as Fr,W as Et,a4 as Nt,a3 as At,a0 as Gr,a1 as Jr}from"./BCvnKofF.js";import{e as Ce,u as zt,o as Xt,d as Kr}from"./CSm0urZa.js";import"./IHki7fMi.js";import{d as Ct,e as kl,m as nr,a as pt,i as Zr,K as wl,L as Il,N as Qr,P as Xr,c as rr,T as yl,u as Ut,n as Yt,g as xe,W as Yr,b as Ml,D as El,F as $r}from"./__JRYNd1.js";import{t as qe}from"./DZnh-gzO.js";import{h as xr,u as ei,j as ti}from"./CRKgkQeq.js";import{b as Qt,D as Nl,f as ir,E as li,w as kt,B as wt,l as ar,m as Ht,v as Dl}from"./563rTQSo.js";import{d as ft}from"./I1CDPYOB.js";import"./BFK-koEx.js";import{c as Tl,f as si}from"./sduOQFBO.js";import{r as ni}from"./D91jHgxN.js";import{s as ri}from"./BhRMWZDW.js";import{i as ii}from"./B3f1U3mZ.js";import{C as ai,P as or,N as $t}from"./CpfZ3bFL.js";import{S as xt,a as oi}from"./DVRWqTFx.js";import{aG as fr,aV as fi,aW as ui,aL as Vt,aq as el,aX as ci}from"./BxwRg2Dc.js";import{T as Pe}from"./APGfqsGw.js";import{T as di}from"./qWjd6Jn2.js";import{X as Wt}from"./BKFELi7o.js";import{C as ur}from"./C11Xkt-C.js";import{C as cr}from"./Re39ekWt.js";import{S as hi}from"./xhfJ-qLd.js";import{C as dr}from"./OFvj_JRi.js";import{I as mi}from"./BmIpgewV.js";import{M as hr}from"./CAH0SlZd.js";import{T as gi}from"./x4nRNQGH.js";import{S as tl}from"./CVAJiM1o.js";import{B as ll}from"./C4dRBApd.js";import{C as _i}from"./BvFsrLtf.js";import{E as pi}from"./Cf1cxNje.js";import"./CF4_YkFU.js";import{c as bi}from"./CzjYtDrJ.js";import{F as sl}from"./CZjVz-mK.js";import{f as Dt}from"./BkbMBbnp.js";import"./BPHf6JLV.js";import{b as vi,c as qt}from"./DON4Monn.js";import{f as ki}from"./CBc5jlPY.js";import{D as wi}from"./BaykB1nf.js";import{L as Ii}from"./BbgEtkne.js";import{F as yi}from"./CU2r43ac.js";import{E as Mi}from"./BCAb_axV.js";function Cl(n,e,t){const l=n.slice();return l[23]=e[t],l}function Vl(n,e,t){const l=n.slice();return l[26]=e[t],l}function Sl(n){var s;let e,t=n[8].t('This response was generated by "{{model}}"',{model:n[7]?((s=n[7])==null?void 0:s.name)??n[7].id:n[1].selectedModelId})+"",l;return{c(){e=E("div"),l=q(t),this.h()},l(r){e=N(r,"DIV",{class:!0});var i=k(e);l=F(i,t),i.forEach(h),this.h()},h(){c(e,"class","text-xs font-medium pt-1.5 -mb-0.5")},m(r,i){I(r,e,i),p(e,l)},p(r,i){var o;i&386&&t!==(t=r[8].t('This response was generated by "{{model}}"',{model:r[7]?((o=r[7])==null?void 0:o.name)??r[7].id:r[1].selectedModelId})+"")&&Z(l,t)},d(r){r&&h(e)}}}function Bl(n){let e,t=n[26]+"",l,s,r,i,o,a;function f(){return n[12](n[26])}return{c(){e=E("button"),l=q(t),s=A(),this.h()},l(u){e=N(u,"BUTTON",{class:!0});var d=k(e);l=F(d,t),s=H(d),d.forEach(h),this.h()},h(){var u,d;c(e,"class",r="size-7 text-sm border border-gray-100 dark:border-gray-850 hover:bg-gray-50 dark:hover:bg-gray-850 "+(n[6]===n[26]?"bg-gray-100 dark:bg-gray-800":"")+" transition rounded-full disabled:cursor-not-allowed disabled:text-gray-500 disabled:bg-white dark:disabled:bg-gray-900"),e.disabled=i=((d=(u=n[1])==null?void 0:u.annotation)==null?void 0:d.rating)===-1?n[26]>5:n[26]<6},m(u,d){I(u,e,d),p(e,l),p(e,s),o||(a=ce(e,"click",f),o=!0)},p(u,d){var g,m;n=u,d&64&&r!==(r="size-7 text-sm border border-gray-100 dark:border-gray-850 hover:bg-gray-50 dark:hover:bg-gray-850 "+(n[6]===n[26]?"bg-gray-100 dark:bg-gray-800":"")+" transition rounded-full disabled:cursor-not-allowed disabled:text-gray-500 disabled:bg-white dark:disabled:bg-gray-900")&&c(e,"class",r),d&2&&i!==(i=((m=(g=n[1])==null?void 0:g.annotation)==null?void 0:m.rating)===-1?n[26]>5:n[26]<6)&&(e.disabled=i)},d(u){u&&h(e),o=!1,a()}}}function Ol(n){let e,t=n[8].t("Why?")+"",l,s,r,i=Ce(n[3]),o=[];for(let a=0;a<i.length;a+=1)o[a]=Rl(Cl(n,i,a));return{c(){e=E("div"),l=q(t),s=A(),r=E("div");for(let a=0;a<o.length;a+=1)o[a].c();this.h()},l(a){e=N(a,"DIV",{class:!0});var f=k(e);l=F(f,t),f.forEach(h),s=H(a),r=N(a,"DIV",{class:!0});var u=k(r);for(let d=0;d<o.length;d+=1)o[d].l(u);u.forEach(h),this.h()},h(){c(e,"class","text-sm mt-1.5 font-medium"),c(r,"class","flex flex-wrap gap-1.5 text-sm mt-1.5")},m(a,f){I(a,e,f),p(e,l),I(a,s,f),I(a,r,f);for(let u=0;u<o.length;u+=1)o[u]&&o[u].m(r,null)},p(a,f){if(f&256&&t!==(t=a[8].t("Why?")+"")&&Z(l,t),f&280){i=Ce(a[3]);let u;for(u=0;u<i.length;u+=1){const d=Cl(a,i,u);o[u]?o[u].p(d,f):(o[u]=Rl(d),o[u].c(),o[u].m(r,null))}for(;u<o.length;u+=1)o[u].d(1);o.length=i.length}},d(a){a&&(h(e),h(s),h(r)),Fe(o,a)}}}function Ei(n){let e=n[23]+"",t;return{c(){t=q(e)},l(l){t=F(l,e)},m(l,s){I(l,t,s)},p(l,s){s&8&&e!==(e=l[23]+"")&&Z(t,e)},d(l){l&&h(t)}}}function Ni(n){let e=n[8].t("Other")+"",t;return{c(){t=q(e)},l(l){t=F(l,e)},m(l,s){I(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Other")+"")&&Z(t,e)},d(l){l&&h(t)}}}function Di(n){let e=n[8].t("Being lazy")+"",t;return{c(){t=q(e)},l(l){t=F(l,e)},m(l,s){I(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Being lazy")+"")&&Z(t,e)},d(l){l&&h(t)}}}function Ti(n){let e=n[8].t("Refused when it shouldn't have")+"",t;return{c(){t=q(e)},l(l){t=F(l,e)},m(l,s){I(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Refused when it shouldn't have")+"")&&Z(t,e)},d(l){l&&h(t)}}}function Ci(n){let e=n[8].t("Didn't fully follow instructions")+"",t;return{c(){t=q(e)},l(l){t=F(l,e)},m(l,s){I(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Didn't fully follow instructions")+"")&&Z(t,e)},d(l){l&&h(t)}}}function Vi(n){let e=n[8].t("Not factually correct")+"",t;return{c(){t=q(e)},l(l){t=F(l,e)},m(l,s){I(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Not factually correct")+"")&&Z(t,e)},d(l){l&&h(t)}}}function Si(n){let e=n[8].t("Not helpful")+"",t;return{c(){t=q(e)},l(l){t=F(l,e)},m(l,s){I(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Not helpful")+"")&&Z(t,e)},d(l){l&&h(t)}}}function Bi(n){let e=n[8].t("Too verbose")+"",t;return{c(){t=q(e)},l(l){t=F(l,e)},m(l,s){I(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Too verbose")+"")&&Z(t,e)},d(l){l&&h(t)}}}function Oi(n){let e=n[8].t("Don't like the style")+"",t;return{c(){t=q(e)},l(l){t=F(l,e)},m(l,s){I(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Don't like the style")+"")&&Z(t,e)},d(l){l&&h(t)}}}function Ri(n){let e=n[8].t("Thorough explanation")+"",t;return{c(){t=q(e)},l(l){t=F(l,e)},m(l,s){I(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Thorough explanation")+"")&&Z(t,e)},d(l){l&&h(t)}}}function Pi(n){let e=n[8].t("Attention to detail")+"",t;return{c(){t=q(e)},l(l){t=F(l,e)},m(l,s){I(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Attention to detail")+"")&&Z(t,e)},d(l){l&&h(t)}}}function Li(n){let e=n[8].t("Positive attitude")+"",t;return{c(){t=q(e)},l(l){t=F(l,e)},m(l,s){I(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Positive attitude")+"")&&Z(t,e)},d(l){l&&h(t)}}}function ji(n){let e=n[8].t("Showcased creativity")+"",t;return{c(){t=q(e)},l(l){t=F(l,e)},m(l,s){I(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Showcased creativity")+"")&&Z(t,e)},d(l){l&&h(t)}}}function Ai(n){let e=n[8].t("Followed instructions perfectly")+"",t;return{c(){t=q(e)},l(l){t=F(l,e)},m(l,s){I(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Followed instructions perfectly")+"")&&Z(t,e)},d(l){l&&h(t)}}}function Hi(n){let e=n[8].t("Accurate information")+"",t;return{c(){t=q(e)},l(l){t=F(l,e)},m(l,s){I(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Accurate information")+"")&&Z(t,e)},d(l){l&&h(t)}}}function Rl(n){let e,t,l,s,r;function i(u,d){return u[23]==="accurate_information"?Hi:u[23]==="followed_instructions_perfectly"?Ai:u[23]==="showcased_creativity"?ji:u[23]==="positive_attitude"?Li:u[23]==="attention_to_detail"?Pi:u[23]==="thorough_explanation"?Ri:u[23]==="dont_like_the_style"?Oi:u[23]==="too_verbose"?Bi:u[23]==="not_helpful"?Si:u[23]==="not_factually_correct"?Vi:u[23]==="didnt_fully_follow_instructions"?Ci:u[23]==="refused_when_it_shouldnt_have"?Ti:u[23]==="being_lazy"?Di:u[23]==="other"?Ni:Ei}let o=i(n),a=o(n);function f(){return n[13](n[23])}return{c(){e=E("button"),a.c(),t=A(),this.h()},l(u){e=N(u,"BUTTON",{class:!0});var d=k(e);a.l(d),t=H(d),d.forEach(h),this.h()},h(){c(e,"class",l="px-3 py-0.5 border border-gray-100 dark:border-gray-850 hover:bg-gray-50 dark:hover:bg-gray-850 "+(n[4]===n[23]?"bg-gray-100 dark:bg-gray-800":"")+" transition rounded-xl")},m(u,d){I(u,e,d),a.m(e,null),p(e,t),s||(r=ce(e,"click",f),s=!0)},p(u,d){n=u,o===(o=i(n))&&a?a.p(n,d):(a.d(1),a=o(n),a&&(a.c(),a.m(e,t))),d&24&&l!==(l="px-3 py-0.5 border border-gray-100 dark:border-gray-850 hover:bg-gray-50 dark:hover:bg-gray-850 "+(n[4]===n[23]?"bg-gray-100 dark:bg-gray-800":"")+" transition rounded-xl")&&c(e,"class",l)},d(u){u&&h(e),a.d(),s=!1,r()}}}function zi(n){var R;let e,t,l,s,r=n[8].t("How would you rate this response?")+"",i,o,a,f,u,d,g,m,_,D,v,M,T=n[8].t("Awful")+"",P,L,S,w,C=n[8].t("Amazing")+"",V,O,B,G,U,j,ue,le,he,J,oe,me,re,ie=n[8].t("Save")+"",ge,se,fe,Me,Ee,ve=((R=n[1])==null?void 0:R.arena)&&Sl(n);f=new Wt({props:{className:"size-4"}});let Se=Ce(Array.from({length:10}).map(Pl)),we=[];for(let K=0;K<Se.length;K+=1)we[K]=Bl(Vl(n,Se,K));let ke=n[3].length>0&&Ol(n);return oe=new di({props:{tags:n[2]}}),oe.$on("delete",n[15]),oe.$on("add",n[16]),{c(){ve&&ve.c(),e=A(),t=E("div"),l=E("div"),s=E("div"),i=q(r),o=A(),a=E("button"),Q(f.$$.fragment),u=A(),d=E("div"),g=E("div"),m=E("div");for(let K=0;K<we.length;K+=1)we[K].c();_=A(),D=E("div"),v=E("div"),M=q("1 - "),P=q(T),L=A(),S=E("div"),w=q("10 - "),V=q(C),O=A(),B=E("div"),ke&&ke.c(),G=A(),U=E("div"),j=E("textarea"),le=A(),he=E("div"),J=E("div"),Q(oe.$$.fragment),me=A(),re=E("button"),ge=q(ie),this.h()},l(K){ve&&ve.l(K),e=H(K),t=N(K,"DIV",{class:!0,id:!0});var ne=k(t);l=N(ne,"DIV",{class:!0});var be=k(l);s=N(be,"DIV",{class:!0});var ye=k(s);i=F(ye,r),ye.forEach(h),o=H(be),a=N(be,"BUTTON",{});var W=k(a);$(f.$$.fragment,W),W.forEach(h),be.forEach(h),u=H(ne),d=N(ne,"DIV",{class:!0});var de=k(d);g=N(de,"DIV",{class:!0});var Ie=k(g);m=N(Ie,"DIV",{class:!0});var Ve=k(m);for(let ut=0;ut<we.length;ut+=1)we[ut].l(Ve);Ve.forEach(h),_=H(Ie),D=N(Ie,"DIV",{class:!0});var je=k(D);v=N(je,"DIV",{});var Le=k(v);M=F(Le,"1 - "),P=F(Le,T),Le.forEach(h),L=H(je),S=N(je,"DIV",{});var te=k(S);w=F(te,"10 - "),V=F(te,C),te.forEach(h),je.forEach(h),Ie.forEach(h),de.forEach(h),O=H(ne),B=N(ne,"DIV",{});var Xe=k(B);ke&&ke.l(Xe),Xe.forEach(h),G=H(ne),U=N(ne,"DIV",{class:!0});var Ye=k(U);j=N(Ye,"TEXTAREA",{class:!0,placeholder:!0,rows:!0}),k(j).forEach(h),Ye.forEach(h),le=H(ne),he=N(ne,"DIV",{class:!0});var Ke=k(he);J=N(Ke,"DIV",{class:!0});var nt=k(J);$(oe.$$.fragment,nt),nt.forEach(h),me=H(Ke),re=N(Ke,"BUTTON",{class:!0});var dt=k(re);ge=F(dt,ie),dt.forEach(h),Ke.forEach(h),ne.forEach(h),this.h()},h(){c(s,"class","text-sm font-medium"),c(l,"class","flex justify-between items-center"),c(m,"class","mt-1.5 w-fit flex gap-1 pb-2"),c(D,"class","sticky top-0 bottom-0 left-0 right-0 flex justify-between text-xs"),c(g,"class","relative w-fit overflow-x-auto scrollbar-none"),c(d,"class","w-full flex justify-center"),c(j,"class","w-full text-sm px-1 py-2 bg-transparent outline-hidden resize-none rounded-xl"),c(j,"placeholder",ue=n[8].t("Feel free to add specific details")),c(j,"rows","3"),c(U,"class","mt-2"),c(J,"class","flex items-end group"),c(re,"class","px-3.5 py-1.5 text-sm font-medium bg-black hover:bg-gray-900 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full"),c(he,"class","mt-2 gap-1.5 flex justify-between"),c(t,"class","my-2.5 rounded-xl px-4 py-3 border border-gray-100 dark:border-gray-850"),c(t,"id",se="message-feedback-"+n[1].id)},m(K,ne){ve&&ve.m(K,ne),I(K,e,ne),I(K,t,ne),p(t,l),p(l,s),p(s,i),p(l,o),p(l,a),X(f,a,null),p(t,u),p(t,d),p(d,g),p(g,m);for(let be=0;be<we.length;be+=1)we[be]&&we[be].m(m,null);p(g,_),p(g,D),p(D,v),p(v,M),p(v,P),p(D,L),p(D,S),p(S,w),p(S,V),p(t,O),p(t,B),ke&&ke.m(B,null),p(t,G),p(t,U),p(U,j),ot(j,n[5]),p(t,le),p(t,he),p(he,J),X(oe,J,null),p(he,me),p(he,re),p(re,ge),fe=!0,Me||(Ee=[ce(a,"click",n[11]),ce(j,"input",n[14]),ce(re,"click",n[17])],Me=!0)},p(K,[ne]){var ye;if((ye=K[1])!=null&&ye.arena?ve?ve.p(K,ne):(ve=Sl(K),ve.c(),ve.m(e.parentNode,e)):ve&&(ve.d(1),ve=null),(!fe||ne&256)&&r!==(r=K[8].t("How would you rate this response?")+"")&&Z(i,r),ne&66){Se=Ce(Array.from({length:10}).map(Pl));let W;for(W=0;W<Se.length;W+=1){const de=Vl(K,Se,W);we[W]?we[W].p(de,ne):(we[W]=Bl(de),we[W].c(),we[W].m(m,null))}for(;W<we.length;W+=1)we[W].d(1);we.length=Se.length}(!fe||ne&256)&&T!==(T=K[8].t("Awful")+"")&&Z(P,T),(!fe||ne&256)&&C!==(C=K[8].t("Amazing")+"")&&Z(V,C),K[3].length>0?ke?ke.p(K,ne):(ke=Ol(K),ke.c(),ke.m(B,null)):ke&&(ke.d(1),ke=null),(!fe||ne&256&&ue!==(ue=K[8].t("Feel free to add specific details")))&&c(j,"placeholder",ue),ne&32&&ot(j,K[5]);const be={};ne&4&&(be.tags=K[2]),oe.$set(be),(!fe||ne&256)&&ie!==(ie=K[8].t("Save")+"")&&Z(ge,ie),(!fe||ne&2&&se!==(se="message-feedback-"+K[1].id))&&c(t,"id",se)},i(K){fe||(b(f.$$.fragment,K),b(oe.$$.fragment,K),fe=!0)},o(K){y(f.$$.fragment,K),y(oe.$$.fragment,K),fe=!1},d(K){K&&(h(e),h(t)),ve&&ve.d(K),Y(f),Fe(we,K),ke&&ke.d(),Y(oe),Me=!1,et(Ee)}}}const Pl=(n,e)=>e+1;function Ui(n,e,t){let l,s;Te(n,Ct,B=>t(18,s=B));const r=Ge("i18n");Te(n,r,B=>t(8,l=B));const i=Tt();let{message:o}=e,{show:a=!1}=e,f=["accurate_information","followed_instructions_perfectly","showcased_creativity","positive_attitude","attention_to_detail","thorough_explanation","other"],u=["dont_like_the_style","too_verbose","not_helpful","not_factually_correct","didnt_fully_follow_instructions","refused_when_it_shouldnt_have","being_lazy","other"],d=[],g=[],m=null,_="",D=null,v=null;const M=()=>{var B,G,U,j,ue;m||t(4,m=((B=o==null?void 0:o.annotation)==null?void 0:B.reason)??""),_||t(5,_=((G=o==null?void 0:o.annotation)==null?void 0:G.comment)??""),t(2,d=(((U=o==null?void 0:o.annotation)==null?void 0:U.tags)??[]).map(le=>({name:le}))),D||t(6,D=((ue=(j=o==null?void 0:o.annotation)==null?void 0:j.details)==null?void 0:ue.rating)??null)};It(()=>{o!=null&&o.arena&&(t(7,v=s.find(B=>B.id===o.selectedModelId)),qe.success(l.t('This response was generated by "{{model}}"',{model:v?(v==null?void 0:v.name)??v.id:o.selectedModelId})))});const T=()=>{i("save",{reason:m,comment:_,tags:d.map(B=>B.name),details:{rating:D}}),qe.success(l.t("Thanks for your feedback!")),t(0,a=!1)},P=()=>{t(0,a=!1)},L=B=>{t(6,D=B)},S=B=>{t(4,m=B)};function w(){_=this.value,t(5,_)}const C=B=>{t(2,d=d.filter(G=>G.name.replaceAll(" ","_").toLowerCase()!==B.detail.replaceAll(" ","_").toLowerCase()))},V=B=>{t(2,d=[...d,{name:B.detail}])},O=()=>{T()};return n.$$set=B=>{"message"in B&&t(1,o=B.message),"show"in B&&t(0,a=B.show)},n.$$.update=()=>{var B,G;n.$$.dirty&2&&(((B=o==null?void 0:o.annotation)==null?void 0:B.rating)===1?t(3,g=f):((G=o==null?void 0:o.annotation)==null?void 0:G.rating)===-1&&t(3,g=u)),n.$$.dirty&2&&o&&M()},[a,o,d,g,m,_,D,v,l,r,T,P,L,S,w,C,V,O]}class Wi extends He{constructor(e){super(),ze(this,e,Ui,zi,Re,{message:1,show:0})}}function Ll(n,e,t){const l=n.slice();return l[5]=e[t],l[7]=t,l}function qi(n){let e,t;return e=new ur({props:{strokeWidth:"3.5",className:"size-3.5 "}}),{c(){Q(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){y(e.$$.fragment,l),t=!1},d(l){Y(e,l)}}}function Fi(n){let e,t;return e=new cr({props:{strokeWidth:"3.5",className:"size-3.5 "}}),{c(){Q(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){y(e.$$.fragment,l),t=!1},d(l){Y(e,l)}}}function Gi(n){let e,t,l,s,r;const i=n[2].default,o=xn(i,n,n[4],null),a=[Fi,qi],f=[];function u(d,g){return d[1]?0:1}return l=u(n),s=f[l]=a[l](n),{c(){e=E("div"),o&&o.c(),t=A(),s.c(),this.h()},l(d){e=N(d,"DIV",{class:!0});var g=k(e);o&&o.l(g),t=H(g),s.l(g),g.forEach(h),this.h()},h(){c(e,"class","flex items-center gap-2 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 transition")},m(d,g){I(d,e,g),o&&o.m(e,null),p(e,t),f[l].m(e,null),r=!0},p(d,g){o&&o.p&&(!r||g&16)&&er(o,i,d,d[4],r?lr(i,d[4],g,null):tr(d[4]),null);let m=l;l=u(d),l!==m&&(x(),y(f[m],1,1,()=>{f[m]=null}),ee(),s=f[l],s||(s=f[l]=a[l](d),s.c()),b(s,1),s.m(e,null))},i(d){r||(b(o,d),b(s),r=!0)},o(d){y(o,d),y(s),r=!1},d(d){d&&h(e),o&&o.d(d),f[l].d()}}}function jl(n){let e,t,l,s,r,i=n[0].query+"",o,a,f,u='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-4"><path fill-rule="evenodd" d="M4.22 11.78a.75.75 0 0 1 0-1.06L9.44 5.5H5.75a.75.75 0 0 1 0-1.5h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V6.56l-5.22 5.22a.75.75 0 0 1-1.06 0Z" clip-rule="evenodd"></path></svg>',d,g;return l=new hi({}),{c(){e=E("a"),t=E("div"),Q(l.$$.fragment),s=A(),r=E("div"),o=q(i),a=A(),f=E("div"),f.innerHTML=u,this.h()},l(m){e=N(m,"A",{href:!0,target:!0,class:!0});var _=k(e);t=N(_,"DIV",{class:!0});var D=k(t);$(l.$$.fragment,D),s=H(D),r=N(D,"DIV",{class:!0});var v=k(r);o=F(v,i),v.forEach(h),D.forEach(h),a=H(_),f=N(_,"DIV",{class:!0,"data-svelte-h":!0}),st(f)!=="svelte-14xjows"&&(f.innerHTML=u),_.forEach(h),this.h()},h(){c(r,"class","line-clamp-1"),c(t,"class","flex gap-2 items-center"),c(f,"class","ml-1 text-white dark:text-gray-900 group-hover/item:text-gray-600 dark:group-hover/item:text-white transition"),c(e,"href",d="https://www.google.com/search?q="+n[0].query),c(e,"target","_blank"),c(e,"class","flex w-full items-center p-3 px-4 border-b border-gray-300/30 dark:border-gray-700/50 group/item justify-between font-normal text-gray-800 dark:text-gray-300 no-underline")},m(m,_){I(m,e,_),p(e,t),X(l,t,null),p(t,s),p(t,r),p(r,o),p(e,a),p(e,f),g=!0},p(m,_){(!g||_&1)&&i!==(i=m[0].query+"")&&Z(o,i),(!g||_&1&&d!==(d="https://www.google.com/search?q="+m[0].query))&&c(e,"href",d)},i(m){g||(b(l.$$.fragment,m),g=!0)},o(m){y(l.$$.fragment,m),g=!1},d(m){m&&h(e),Y(l)}}}function Al(n){let e,t,l=n[5]+"",s,r,i,o='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-4"><path fill-rule="evenodd" d="M4.22 11.78a.75.75 0 0 1 0-1.06L9.44 5.5H5.75a.75.75 0 0 1 0-1.5h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V6.56l-5.22 5.22a.75.75 0 0 1-1.06 0Z" clip-rule="evenodd"></path></svg>',a,f,u;return{c(){e=E("a"),t=E("div"),s=q(l),r=A(),i=E("div"),i.innerHTML=o,a=A(),this.h()},l(d){e=N(d,"A",{href:!0,target:!0,class:!0});var g=k(e);t=N(g,"DIV",{class:!0});var m=k(t);s=F(m,l),m.forEach(h),r=H(g),i=N(g,"DIV",{class:!0,"data-svelte-h":!0}),st(i)!=="svelte-14xjows"&&(i.innerHTML=o),a=H(g),g.forEach(h),this.h()},h(){c(t,"class","line-clamp-1"),c(i,"class","ml-1 text-white dark:text-gray-900 group-hover/item:text-gray-600 dark:group-hover/item:text-white transition"),c(e,"href",f=n[5]),c(e,"target","_blank"),c(e,"class",u="flex w-full items-center p-3 px-4 "+(n[7]===n[0].urls.length-1?"":"border-b border-gray-300/30 dark:border-gray-700/50")+" group/item justify-between font-normal text-gray-800 dark:text-gray-300")},m(d,g){I(d,e,g),p(e,t),p(t,s),p(e,r),p(e,i),p(e,a)},p(d,g){g&1&&l!==(l=d[5]+"")&&Z(s,l),g&1&&f!==(f=d[5])&&c(e,"href",f),g&1&&u!==(u="flex w-full items-center p-3 px-4 "+(d[7]===d[0].urls.length-1?"":"border-b border-gray-300/30 dark:border-gray-700/50")+" group/item justify-between font-normal text-gray-800 dark:text-gray-300")&&c(e,"class",u)},d(d){d&&h(e)}}}function Ji(n){var o;let e,t,l,s=((o=n[0])==null?void 0:o.query)&&jl(n),r=Ce(n[0].urls),i=[];for(let a=0;a<r.length;a+=1)i[a]=Al(Ll(n,r,a));return{c(){e=E("div"),s&&s.c(),t=A();for(let a=0;a<i.length;a+=1)i[a].c();this.h()},l(a){e=N(a,"DIV",{class:!0,slot:!0});var f=k(e);s&&s.l(f),t=H(f);for(let u=0;u<i.length;u+=1)i[u].l(f);f.forEach(h),this.h()},h(){c(e,"class","text-sm border border-gray-300/30 dark:border-gray-700/50 rounded-xl mb-1.5"),c(e,"slot","content")},m(a,f){I(a,e,f),s&&s.m(e,null),p(e,t);for(let u=0;u<i.length;u+=1)i[u]&&i[u].m(e,null);l=!0},p(a,f){var u;if((u=a[0])!=null&&u.query?s?(s.p(a,f),f&1&&b(s,1)):(s=jl(a),s.c(),b(s,1),s.m(e,t)):s&&(x(),y(s,1,1,()=>{s=null}),ee()),f&1){r=Ce(a[0].urls);let d;for(d=0;d<r.length;d+=1){const g=Ll(a,r,d);i[d]?i[d].p(g,f):(i[d]=Al(g),i[d].c(),i[d].m(e,null))}for(;d<i.length;d+=1)i[d].d(1);i.length=r.length}},i(a){l||(b(s),l=!0)},o(a){y(s),l=!1},d(a){a&&h(e),s&&s.d(),Fe(i,a)}}}function Ki(n){let e,t,l;function s(i){n[3](i)}let r={className:"w-full space-y-1",$$slots:{content:[Ji],default:[Gi]},$$scope:{ctx:n}};return n[1]!==void 0&&(r.open=n[1]),e=new fr({props:r}),We.push(()=>Ze(e,"open",s)),{c(){Q(e.$$.fragment)},l(i){$(e.$$.fragment,i)},m(i,o){X(e,i,o),l=!0},p(i,[o]){const a={};o&19&&(a.$$scope={dirty:o,ctx:i}),!t&&o&2&&(t=!0,a.open=i[1],Qe(()=>t=!1)),e.$set(a)},i(i){l||(b(e.$$.fragment,i),l=!0)},o(i){y(e.$$.fragment,i),l=!1},d(i){Y(e,i)}}}function Zi(n,e,t){let{$$slots:l={},$$scope:s}=e,{status:r={urls:[],query:""}}=e,i=!1;function o(a){i=a,t(1,i)}return n.$$set=a=>{"status"in a&&t(0,r=a.status),"$$scope"in a&&t(4,s=a.$$scope)},[r,i,l,o,s]}class Qi extends He{constructor(e){super(),ze(this,e,Zi,Ki,Re,{status:0})}}function Xi(n){let e=JSON.stringify(n[0])+"",t;return{c(){t=q(e)},l(l){t=F(l,e)},m(l,s){I(l,t,s)},p(l,s){s&1&&e!==(e=JSON.stringify(l[0])+"")&&Z(t,e)},d(l){l&&h(t)}}}function Yi(n){let e;function t(r,i){var o,a,f,u,d;return(o=r[0])!=null&&o.error&&((f=(a=r[0])==null?void 0:a.error)!=null&&f.message)?la:(u=r[0])!=null&&u.detail?ta:(d=r[0])!=null&&d.message?ea:xi}let l=t(n),s=l(n);return{c(){s.c(),e=ae()},l(r){s.l(r),e=ae()},m(r,i){s.m(r,i),I(r,e,i)},p(r,i){l===(l=t(r))&&s?s.p(r,i):(s.d(1),s=l(r),s&&(s.c(),s.m(e.parentNode,e)))},d(r){r&&h(e),s.d(r)}}}function $i(n){let e;return{c(){e=q(n[0])},l(t){e=F(t,n[0])},m(t,l){I(t,e,l)},p(t,l){l&1&&Z(e,t[0])},d(t){t&&h(e)}}}function xi(n){let e=JSON.stringify(n[0])+"",t;return{c(){t=q(e)},l(l){t=F(l,e)},m(l,s){I(l,t,s)},p(l,s){s&1&&e!==(e=JSON.stringify(l[0])+"")&&Z(t,e)},d(l){l&&h(t)}}}function ea(n){let e=n[0].message+"",t;return{c(){t=q(e)},l(l){t=F(l,e)},m(l,s){I(l,t,s)},p(l,s){s&1&&e!==(e=l[0].message+"")&&Z(t,e)},d(l){l&&h(t)}}}function ta(n){let e=n[0].detail+"",t;return{c(){t=q(e)},l(l){t=F(l,e)},m(l,s){I(l,t,s)},p(l,s){s&1&&e!==(e=l[0].detail+"")&&Z(t,e)},d(l){l&&h(t)}}}function la(n){let e=n[0].error.message+"",t;return{c(){t=q(e)},l(l){t=F(l,e)},m(l,s){I(l,t,s)},p(l,s){s&1&&e!==(e=l[0].error.message+"")&&Z(t,e)},d(l){l&&h(t)}}}function sa(n){let e,t,l,s,r,i;l=new mi({props:{className:"size-5 text-red-700 dark:text-red-400"}});function o(u,d){return typeof u[0]=="string"?$i:typeof u[0]=="object"&&u[0]!==null?Yi:Xi}let a=o(n),f=a(n);return{c(){e=E("div"),t=E("div"),Q(l.$$.fragment),s=A(),r=E("div"),f.c(),this.h()},l(u){e=N(u,"DIV",{class:!0});var d=k(e);t=N(d,"DIV",{class:!0});var g=k(t);$(l.$$.fragment,g),g.forEach(h),s=H(d),r=N(d,"DIV",{class:!0});var m=k(r);f.l(m),m.forEach(h),d.forEach(h),this.h()},h(){c(t,"class","self-start mt-0.5"),c(r,"class","self-center text-sm"),c(e,"class","flex my-2 gap-2.5 border px-4 py-3 border-red-600/10 bg-red-600/10 rounded-lg")},m(u,d){I(u,e,d),p(e,t),X(l,t,null),p(e,s),p(e,r),f.m(r,null),i=!0},p(u,[d]){a===(a=o(u))&&f?f.p(u,d):(f.d(1),f=a(u),f&&(f.c(),f.m(r,null)))},i(u){i||(b(l.$$.fragment,u),i=!0)},o(u){y(l.$$.fragment,u),i=!1},d(u){u&&h(e),Y(l),f.d()}}}function na(n,e,t){let{content:l=""}=e;return n.$$set=s=>{"content"in s&&t(0,l=s.content)},[l]}let ra=class extends He{constructor(e){super(),ze(this,e,na,sa,Re,{content:0})}};function Hl(n,e,t){const l=n.slice();return l[10]=e[t],l[12]=t,l}function ia(n){const e=n.slice(),t=ba(e[10].distance);return e[13]=t,e}function aa(n){let e,t=n[4].t("No source available")+"",l;return{c(){e=E("div"),l=q(t),this.h()},l(s){e=N(s,"DIV",{class:!0});var r=k(e);l=F(r,t),r.forEach(h),this.h()},h(){c(e,"class","text-sm dark:text-gray-400")},m(s,r){I(s,e,r),p(e,l)},p(s,r){r&16&&t!==(t=s[4].t("No source available")+"")&&Z(l,t)},i:Ne,o:Ne,d(s){s&&h(e)}}}function oa(n){var a;let e,t,l,s,r;e=new Pe({props:{className:"w-fit",content:n[4].t("Open file"),placement:"top-start",tippyOptions:{duration:[500,0]},$$slots:{default:[fa]},$$scope:{ctx:n}}});let i=((a=n[10].metadata)==null?void 0:a.parameters)&&Ul(n),o=n[2]&&Wl(n);return{c(){Q(e.$$.fragment),t=A(),i&&i.c(),l=A(),o&&o.c(),s=ae()},l(f){$(e.$$.fragment,f),t=H(f),i&&i.l(f),l=H(f),o&&o.l(f),s=ae()},m(f,u){X(e,f,u),I(f,t,u),i&&i.m(f,u),I(f,l,u),o&&o.m(f,u),I(f,s,u),r=!0},p(f,u){var g;const d={};u&16&&(d.content=f[4].t("Open file")),u&16408&&(d.$$scope={dirty:u,ctx:f}),e.$set(d),(g=f[10].metadata)!=null&&g.parameters?i?(i.p(f,u),u&8&&b(i,1)):(i=Ul(f),i.c(),b(i,1),i.m(l.parentNode,l)):i&&(x(),y(i,1,1,()=>{i=null}),ee()),f[2]?o?(o.p(f,u),u&4&&b(o,1)):(o=Wl(f),o.c(),b(o,1),o.m(s.parentNode,s)):o&&(x(),y(o,1,1,()=>{o=null}),ee())},i(f){r||(b(e.$$.fragment,f),b(i),b(o),r=!0)},o(f){y(e.$$.fragment,f),y(i),y(o),r=!1},d(f){f&&(h(t),h(l),h(s)),Y(e,f),i&&i.d(f),o&&o.d(f)}}}function zl(n){let e,t,l=n[4].t("page")+"",s,r,i=n[10].metadata.page+1+"",o,a;return{c(){e=E("span"),t=q("("),s=q(l),r=A(),o=q(i),a=q(")"),this.h()},l(f){e=N(f,"SPAN",{class:!0});var u=k(e);t=F(u,"("),s=F(u,l),r=H(u),o=F(u,i),a=F(u,")"),u.forEach(h),this.h()},h(){c(e,"class","text-xs text-gray-500 dark:text-gray-400")},m(f,u){I(f,e,u),p(e,t),p(e,s),p(e,r),p(e,o),p(e,a)},p(f,u){u&16&&l!==(l=f[4].t("page")+"")&&Z(s,l),u&8&&i!==(i=f[10].metadata.page+1+"")&&Z(o,i)},d(f){f&&h(e)}}}function fa(n){var f,u,d,g;let e,t,l=n[6](((u=(f=n[10])==null?void 0:f.metadata)==null?void 0:u.name)??n[10].source.name)+"",s,r,i,o=Number.isInteger((g=(d=n[10])==null?void 0:d.metadata)==null?void 0:g.page),a=o&&zl(n);return{c(){e=E("div"),t=E("a"),s=q(l),i=A(),a&&a.c(),this.h()},l(m){e=N(m,"DIV",{class:!0});var _=k(e);t=N(_,"A",{class:!0,href:!0,target:!0});var D=k(t);s=F(D,l),D.forEach(h),i=H(_),a&&a.l(_),_.forEach(h),this.h()},h(){var m,_,D,v,M,T,P,L;c(t,"class","hover:text-gray-500 dark:hover:text-gray-100 underline grow"),c(t,"href",r=(_=(m=n[10])==null?void 0:m.metadata)!=null&&_.file_id?`${kl}/files/${(v=(D=n[10])==null?void 0:D.metadata)==null?void 0:v.file_id}/content${((T=(M=n[10])==null?void 0:M.metadata)==null?void 0:T.page)!==void 0?`#page=${n[10].metadata.page+1}`:""}`:(L=(P=n[10].source)==null?void 0:P.url)!=null&&L.includes("http")?n[10].source.url:"#"),c(t,"target","_blank"),c(e,"class","text-sm dark:text-gray-400 flex items-center gap-2 w-fit")},m(m,_){I(m,e,_),p(e,t),p(t,s),p(e,i),a&&a.m(e,null)},p(m,_){var D,v,M,T,P,L,S,w,C,V,O,B;_&8&&l!==(l=m[6](((v=(D=m[10])==null?void 0:D.metadata)==null?void 0:v.name)??m[10].source.name)+"")&&Z(s,l),_&8&&r!==(r=(T=(M=m[10])==null?void 0:M.metadata)!=null&&T.file_id?`${kl}/files/${(L=(P=m[10])==null?void 0:P.metadata)==null?void 0:L.file_id}/content${((w=(S=m[10])==null?void 0:S.metadata)==null?void 0:w.page)!==void 0?`#page=${m[10].metadata.page+1}`:""}`:(V=(C=m[10].source)==null?void 0:C.url)!=null&&V.includes("http")?m[10].source.url:"#")&&c(t,"href",r),_&8&&(o=Number.isInteger((B=(O=m[10])==null?void 0:O.metadata)==null?void 0:B.page)),o?a?a.p(m,_):(a=zl(m),a.c(),a.m(e,null)):a&&(a.d(1),a=null)},d(m){m&&h(e),a&&a.d()}}}function Ul(n){let e,t=n[4].t("Parameters")+"",l,s,r,i;return r=new gi({props:{readonly:!0,value:JSON.stringify(n[10].metadata.parameters,null,2)}}),{c(){e=E("div"),l=q(t),s=A(),Q(r.$$.fragment),this.h()},l(o){e=N(o,"DIV",{class:!0});var a=k(e);l=F(a,t),a.forEach(h),s=H(o),$(r.$$.fragment,o),this.h()},h(){c(e,"class","text-sm font-medium dark:text-gray-300 mt-2 mb-0.5")},m(o,a){I(o,e,a),p(e,l),I(o,s,a),X(r,o,a),i=!0},p(o,a){(!i||a&16)&&t!==(t=o[4].t("Parameters")+"")&&Z(l,t);const f={};a&8&&(f.value=JSON.stringify(o[10].metadata.parameters,null,2)),r.$set(f)},i(o){i||(b(r.$$.fragment,o),i=!0)},o(o){y(r.$$.fragment,o),i=!1},d(o){o&&(h(e),h(s)),Y(r,o)}}}function Wl(n){let e,t=n[4].t("Relevance")+"",l,s,r,i,o,a;const f=[ca,ua],u=[];function d(g,m){return g[10].distance!==void 0?0:1}return r=d(n),i=u[r]=f[r](n),{c(){e=E("div"),l=q(t),s=A(),i.c(),o=ae(),this.h()},l(g){e=N(g,"DIV",{class:!0});var m=k(e);l=F(m,t),m.forEach(h),s=H(g),i.l(g),o=ae(),this.h()},h(){c(e,"class","text-sm font-medium dark:text-gray-300 mt-2")},m(g,m){I(g,e,m),p(e,l),I(g,s,m),u[r].m(g,m),I(g,o,m),a=!0},p(g,m){(!a||m&16)&&t!==(t=g[4].t("Relevance")+"")&&Z(l,t);let _=r;r=d(g),r===_?u[r].p(g,m):(x(),y(u[_],1,1,()=>{u[_]=null}),ee(),i=u[r],i?i.p(g,m):(i=u[r]=f[r](g),i.c()),b(i,1),i.m(o.parentNode,o))},i(g){a||(b(i),a=!0)},o(g){y(i),a=!1},d(g){g&&(h(e),h(s),h(o)),u[r].d(g)}}}function ua(n){let e,t=n[4].t("No distance available")+"",l;return{c(){e=E("div"),l=q(t),this.h()},l(s){e=N(s,"DIV",{class:!0});var r=k(e);l=F(r,t),r.forEach(h),this.h()},h(){c(e,"class","text-sm dark:text-gray-400")},m(s,r){I(s,e,r),p(e,l)},p(s,r){r&16&&t!==(t=s[4].t("No distance available")+"")&&Z(l,t)},i:Ne,o:Ne,d(s){s&&h(e)}}}function ca(n){let e,t;return e=new Pe({props:{className:"w-fit",content:n[4].t("Semantic distance to query"),placement:"top-start",tippyOptions:{duration:[500,0]},$$slots:{default:[ha]},$$scope:{ctx:n}}}),{c(){Q(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},p(l,s){const r={};s&16&&(r.content=l[4].t("Semantic distance to query")),s&16394&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){y(e.$$.fragment,l),t=!1},d(l){Y(e,l)}}}function da(n){var i;let e,t,l=(((i=n[10])==null?void 0:i.distance)??0).toFixed(4)+"",s,r;return{c(){e=E("span"),t=q("("),s=q(l),r=q(")"),this.h()},l(o){e=N(o,"SPAN",{class:!0});var a=k(e);t=F(a,"("),s=F(a,l),r=F(a,")"),a.forEach(h),this.h()},h(){c(e,"class","text-gray-500 dark:text-gray-500")},m(o,a){I(o,e,a),p(e,t),p(e,s),p(e,r)},p(o,a){var f;a&8&&l!==(l=(((f=o[10])==null?void 0:f.distance)??0).toFixed(4)+"")&&Z(s,l)},d(o){o&&h(e)}}}function ql(n){var r;let e,t,l=typeof n[13]=="number"&&Fl(n),s=typeof((r=n[10])==null?void 0:r.distance)=="number"&&Gl(n);return{c(){l&&l.c(),e=A(),s&&s.c(),t=ae()},l(i){l&&l.l(i),e=H(i),s&&s.l(i),t=ae()},m(i,o){l&&l.m(i,o),I(i,e,o),s&&s.m(i,o),I(i,t,o)},p(i,o){var a;typeof i[13]=="number"?l?l.p(i,o):(l=Fl(i),l.c(),l.m(e.parentNode,e)):l&&(l.d(1),l=null),typeof((a=i[10])==null?void 0:a.distance)=="number"?s?s.p(i,o):(s=Gl(i),s.c(),s.m(t.parentNode,t)):s&&(s.d(1),s=null)},d(i){i&&(h(e),h(t)),l&&l.d(i),s&&s.d(i)}}}function Fl(n){let e,t=n[13].toFixed(2)+"",l,s,r;return{c(){e=E("span"),l=q(t),s=q("%"),this.h()},l(i){e=N(i,"SPAN",{class:!0});var o=k(e);l=F(o,t),s=F(o,"%"),o.forEach(h),this.h()},h(){c(e,"class",r=`px-1 rounded-sm font-medium ${Zl(n[13])}`)},m(i,o){I(i,e,o),p(e,l),p(e,s)},p(i,o){o&8&&t!==(t=i[13].toFixed(2)+"")&&Z(l,t),o&8&&r!==(r=`px-1 rounded-sm font-medium ${Zl(i[13])}`)&&c(e,"class",r)},d(i){i&&h(e)}}}function Gl(n){var i;let e,t,l=(((i=n[10])==null?void 0:i.distance)??0).toFixed(4)+"",s,r;return{c(){e=E("span"),t=q("("),s=q(l),r=q(")"),this.h()},l(o){e=N(o,"SPAN",{class:!0});var a=k(e);t=F(a,"("),s=F(a,l),r=F(a,")"),a.forEach(h),this.h()},h(){c(e,"class","text-gray-500 dark:text-gray-500")},m(o,a){I(o,e,a),p(e,t),p(e,s),p(e,r)},p(o,a){var f;a&8&&l!==(l=(((f=o[10])==null?void 0:f.distance)??0).toFixed(4)+"")&&Z(s,l)},d(o){o&&h(e)}}}function ha(n){let e;function t(i,o){var a;if(i[1])return ql;if(typeof((a=i[10])==null?void 0:a.distance)=="number")return da}function l(i,o){return o===ql?ia(i):i}let s=t(n),r=s&&s(l(n,s));return{c(){e=E("div"),r&&r.c(),this.h()},l(i){e=N(i,"DIV",{class:!0});var o=k(e);r&&r.l(o),o.forEach(h),this.h()},h(){c(e,"class","text-sm my-1 dark:text-gray-400 flex items-center gap-2 w-fit")},m(i,o){I(i,e,o),r&&r.m(e,null)},p(i,o){s===(s=t(i))&&r?r.p(l(i,s),o):(r&&r.d(1),r=s&&s(l(i,s)),r&&(r.c(),r.m(e,null)))},d(i){i&&h(e),r&&r.d()}}}function ma(n){let e,t,l=n[10].document+"",s,r;return{c(){e=E("pre"),t=q("                "),s=q(l),r=q(`
              `),this.h()},l(i){e=N(i,"PRE",{class:!0});var o=k(e);t=F(o,"                "),s=F(o,l),r=F(o,`
              `),o.forEach(h),this.h()},h(){c(e,"class","text-sm dark:text-gray-400 whitespace-pre-line")},m(i,o){I(i,e,o),p(e,t),p(e,s),p(e,r)},p(i,o){o&8&&l!==(l=i[10].document+"")&&Z(s,l)},d(i){i&&h(e)}}}function ga(n){let e,t,l;return{c(){e=E("iframe"),this.h()},l(s){e=N(s,"IFRAME",{class:!0,sandbox:!0,srcdoc:!0,title:!0}),k(e).forEach(h),this.h()},h(){c(e,"class","w-full border-0 h-auto rounded-none"),c(e,"sandbox","allow-scripts allow-forms allow-same-origin"),c(e,"srcdoc",t=n[10].document),c(e,"title",l=n[4].t("Content"))},m(s,r){I(s,e,r)},p(s,r){r&8&&t!==(t=s[10].document)&&c(e,"srcdoc",t),r&16&&l!==(l=s[4].t("Content"))&&c(e,"title",l)},d(s){s&&h(e)}}}function Jl(n){let e;return{c(){e=E("hr"),this.h()},l(t){e=N(t,"HR",{class:!0}),this.h()},h(){c(e,"class","border-gray-100 dark:border-gray-850 my-3")},m(t,l){I(t,e,l)},d(t){t&&h(e)}}}function Kl(n){let e,t,l=n[4].t("Source")+"",s,r,i,o,a,f,u,d=n[4].t("Content")+"",g,m,_,D,v;const M=[oa,aa],T=[];function P(V,O){var B;return(B=V[10].source)!=null&&B.name?0:1}i=P(n),o=T[i]=M[i](n);function L(V,O){var B;return(B=V[10].metadata)!=null&&B.html?ga:ma}let S=L(n),w=S(n),C=n[12]!==n[3].length-1&&Jl();return{c(){e=E("div"),t=E("div"),s=q(l),r=A(),o.c(),a=A(),f=E("div"),u=E("div"),g=q(d),m=A(),w.c(),_=A(),C&&C.c(),D=ae(),this.h()},l(V){e=N(V,"DIV",{class:!0});var O=k(e);t=N(O,"DIV",{class:!0});var B=k(t);s=F(B,l),B.forEach(h),r=H(O),o.l(O),O.forEach(h),a=H(V),f=N(V,"DIV",{class:!0});var G=k(f);u=N(G,"DIV",{class:!0});var U=k(u);g=F(U,d),U.forEach(h),m=H(G),w.l(G),G.forEach(h),_=H(V),C&&C.l(V),D=ae(),this.h()},h(){c(t,"class","text-sm font-medium dark:text-gray-300"),c(e,"class","flex flex-col w-full"),c(u,"class","text-sm font-medium dark:text-gray-300 mt-2"),c(f,"class","flex flex-col w-full")},m(V,O){I(V,e,O),p(e,t),p(t,s),p(e,r),T[i].m(e,null),I(V,a,O),I(V,f,O),p(f,u),p(u,g),p(f,m),w.m(f,null),I(V,_,O),C&&C.m(V,O),I(V,D,O),v=!0},p(V,O){(!v||O&16)&&l!==(l=V[4].t("Source")+"")&&Z(s,l);let B=i;i=P(V),i===B?T[i].p(V,O):(x(),y(T[B],1,1,()=>{T[B]=null}),ee(),o=T[i],o?o.p(V,O):(o=T[i]=M[i](V),o.c()),b(o,1),o.m(e,null)),(!v||O&16)&&d!==(d=V[4].t("Content")+"")&&Z(g,d),S===(S=L(V))&&w?w.p(V,O):(w.d(1),w=S(V),w&&(w.c(),w.m(f,null))),V[12]!==V[3].length-1?C||(C=Jl(),C.c(),C.m(D.parentNode,D)):C&&(C.d(1),C=null)},i(V){v||(b(o),v=!0)},o(V){y(o),v=!1},d(V){V&&(h(e),h(a),h(f),h(_),h(D)),T[i].d(),w.d(),C&&C.d(V)}}}function _a(n){let e,t,l,s=n[4].t("Citation")+"",r,i,o,a,f,u,d,g,m,_;a=new Wt({props:{className:"size-5"}});let D=Ce(n[3]),v=[];for(let T=0;T<D.length;T+=1)v[T]=Kl(Hl(n,D,T));const M=T=>y(v[T],1,1,()=>{v[T]=null});return{c(){e=E("div"),t=E("div"),l=E("div"),r=q(s),i=A(),o=E("button"),Q(a.$$.fragment),f=A(),u=E("div"),d=E("div");for(let T=0;T<v.length;T+=1)v[T].c();this.h()},l(T){e=N(T,"DIV",{});var P=k(e);t=N(P,"DIV",{class:!0});var L=k(t);l=N(L,"DIV",{class:!0});var S=k(l);r=F(S,s),S.forEach(h),i=H(L),o=N(L,"BUTTON",{class:!0});var w=k(o);$(a.$$.fragment,w),w.forEach(h),L.forEach(h),f=H(P),u=N(P,"DIV",{class:!0});var C=k(u);d=N(C,"DIV",{class:!0});var V=k(d);for(let O=0;O<v.length;O+=1)v[O].l(V);V.forEach(h),C.forEach(h),P.forEach(h),this.h()},h(){c(l,"class","text-lg font-medium self-center capitalize"),c(o,"class","self-center"),c(t,"class","flex justify-between dark:text-gray-300 px-5 pt-4 pb-2"),c(d,"class","flex flex-col w-full dark:text-gray-200 overflow-y-scroll max-h-[22rem] scrollbar-hidden"),c(u,"class","flex flex-col md:flex-row w-full px-6 pb-5 md:space-x-4")},m(T,P){I(T,e,P),p(e,t),p(t,l),p(l,r),p(t,i),p(t,o),X(a,o,null),p(e,f),p(e,u),p(u,d);for(let L=0;L<v.length;L+=1)v[L]&&v[L].m(d,null);g=!0,m||(_=ce(o,"click",n[8]),m=!0)},p(T,P){if((!g||P&16)&&s!==(s=T[4].t("Citation")+"")&&Z(r,s),P&94){D=Ce(T[3]);let L;for(L=0;L<D.length;L+=1){const S=Hl(T,D,L);v[L]?(v[L].p(S,P),b(v[L],1)):(v[L]=Kl(S),v[L].c(),b(v[L],1),v[L].m(d,null))}for(x(),L=D.length;L<v.length;L+=1)M(L);ee()}},i(T){if(!g){b(a.$$.fragment,T);for(let P=0;P<D.length;P+=1)b(v[P]);g=!0}},o(T){y(a.$$.fragment,T),v=v.filter(Boolean);for(let P=0;P<v.length;P+=1)y(v[P]);g=!1},d(T){T&&h(e),Y(a),Fe(v,T),m=!1,_()}}}function pa(n){let e,t,l;function s(i){n[9](i)}let r={size:"lg",$$slots:{default:[_a]},$$scope:{ctx:n}};return n[0]!==void 0&&(r.show=n[0]),e=new hr({props:r}),We.push(()=>Ze(e,"show",s)),{c(){Q(e.$$.fragment)},l(i){$(e.$$.fragment,i)},m(i,o){X(e,i,o),l=!0},p(i,[o]){const a={};o&16415&&(a.$$scope={dirty:o,ctx:i}),!t&&o&1&&(t=!0,a.show=i[0],Qe(()=>t=!1)),e.$set(a)},i(i){l||(b(e.$$.fragment,i),l=!0)},o(i){y(e.$$.fragment,i),l=!1},d(i){Y(e,i)}}}function ba(n){return typeof n!="number"?null:n<0?0:n>1?100:Math.round(n*1e4)/100}function Zl(n){return n>=80?"bg-green-200 dark:bg-green-800 text-green-800 dark:text-green-200":n>=60?"bg-yellow-200 dark:bg-yellow-800 text-yellow-800 dark:text-yellow-200":n>=40?"bg-orange-200 dark:bg-orange-800 text-orange-800 dark:text-orange-200":"bg-red-200 dark:bg-red-800 text-red-800 dark:text-red-200"}function va(n,e,t){let l;const s=Ge("i18n");Te(n,s,m=>t(4,l=m));let{show:r=!1}=e,{citation:i}=e,{showPercentage:o=!1}=e,{showRelevance:a=!0}=e,f=[];const u=m=>{try{return decodeURIComponent(m)}catch{return m}},d=()=>{t(0,r=!1)};function g(m){r=m,t(0,r)}return n.$$set=m=>{"show"in m&&t(0,r=m.show),"citation"in m&&t(7,i=m.citation),"showPercentage"in m&&t(1,o=m.showPercentage),"showRelevance"in m&&t(2,a=m.showRelevance)},n.$$.update=()=>{var m;n.$$.dirty&136&&i&&(t(3,f=(m=i.document)==null?void 0:m.map((_,D)=>{var v,M;return{source:i.source,document:_,metadata:(v=i.metadata)==null?void 0:v[D],distance:(M=i.distances)==null?void 0:M[D]}})),f.every(_=>_.distance!==void 0)&&t(3,f=f.sort((_,D)=>(D.distance??1/0)-(_.distance??1/0))))},[r,o,a,f,l,s,u,i,d,g]}class ka extends He{constructor(e){super(),ze(this,e,va,pa,Re,{show:0,citation:7,showPercentage:1,showRelevance:2})}}function Ql(n,e,t){const l=n.slice();return l[19]=e[t],l[21]=t,l}function Xl(n,e,t){const l=n.slice();return l[19]=e[t],l[21]=t,l}function Yl(n,e,t){const l=n.slice();return l[19]=e[t],l[21]=t,l}function $l(n){let e,t,l,s;const r=[Ia,wa],i=[];function o(a,f){return a[1].length<=3?0:1}return t=o(n),l=i[t]=r[t](n),{c(){e=E("div"),l.c(),this.h()},l(a){e=N(a,"DIV",{class:!0});var f=k(e);l.l(f),f.forEach(h),this.h()},h(){c(e,"class","py-0.5 -mx-0.5 w-full flex gap-1 items-center flex-wrap")},m(a,f){I(a,e,f),i[t].m(e,null),s=!0},p(a,f){let u=t;t=o(a),t===u?i[t].p(a,f):(x(),y(i[u],1,1,()=>{i[u]=null}),ee(),l=i[t],l?l.p(a,f):(l=i[t]=r[t](a),l.c()),b(l,1),l.m(e,null))},i(a){s||(b(l),s=!0)},o(a){y(l),s=!1},d(a){a&&h(e),i[t].d()}}}function wa(n){let e,t,l;function s(i){n[18](i)}let r={id:`collapsible-${n[0]}`,className:"w-full max-w-full ",buttonClassName:"w-fit max-w-full",$$slots:{content:[Na],default:[Ea]},$$scope:{ctx:n}};return n[6]!==void 0&&(r.open=n[6]),e=new fr({props:r}),We.push(()=>Ze(e,"open",s)),{c(){Q(e.$$.fragment)},l(i){$(e.$$.fragment,i)},m(i,o){X(e,i,o),l=!0},p(i,o){const a={};o&1&&(a.id=`collapsible-${i[0]}`),o&16777458&&(a.$$scope={dirty:o,ctx:i}),!t&&o&64&&(t=!0,a.open=i[6],Qe(()=>t=!1)),e.$set(a)},i(i){l||(b(e.$$.fragment,i),l=!0)},o(i){y(e.$$.fragment,i),l=!1},d(i){Y(e,i)}}}function Ia(n){let e,t=Ce(n[1]),l=[];for(let s=0;s<t.length;s+=1)l[s]=ns(Yl(n,t,s));return{c(){e=E("div");for(let s=0;s<l.length;s+=1)l[s].c();this.h()},l(s){e=N(s,"DIV",{class:!0});var r=k(e);for(let i=0;i<l.length;i+=1)l[i].l(r);r.forEach(h),this.h()},h(){c(e,"class","flex text-xs font-medium flex-wrap")},m(s,r){I(s,e,r);for(let i=0;i<l.length;i+=1)l[i]&&l[i].m(e,null)},p(s,r){if(r&563){t=Ce(s[1]);let i;for(i=0;i<t.length;i+=1){const o=Yl(s,t,i);l[i]?l[i].p(o,r):(l[i]=ns(o),l[i].c(),l[i].m(e,null))}for(;i<l.length;i+=1)l[i].d(1);l.length=t.length}},i:Ne,o:Ne,d(s){s&&h(e),Fe(l,s)}}}function xl(n){let e,t=n[21]+1+"",l;return{c(){e=E("div"),l=q(t),this.h()},l(s){e=N(s,"DIV",{class:!0});var r=k(e);l=F(r,t),r.forEach(h),this.h()},h(){c(e,"class","bg-gray-50 dark:bg-gray-800 rounded-full size-4")},m(s,r){I(s,e,r),p(e,l)},d(s){s&&h(e)}}}function es(n){let e,t=n[1].every(n[13]),l,s,r=n[9](n[19].source.name)+"",i,o,a,f,u=t&&xl(n);function d(){return n[17](n[19])}return{c(){e=E("button"),u&&u.c(),l=A(),s=E("div"),i=q(r),o=A(),this.h()},l(g){e=N(g,"BUTTON",{class:!0});var m=k(e);u&&u.l(m),l=H(m),s=N(m,"DIV",{class:!0});var _=k(s);i=F(_,r),_.forEach(h),o=H(m),m.forEach(h),this.h()},h(){c(s,"class","flex-1 mx-1 truncate"),c(e,"class","no-toggle outline-hidden flex dark:text-gray-300 p-1 bg-gray-50 hover:bg-gray-100 dark:bg-gray-900 dark:hover:bg-gray-850 transition rounded-xl max-w-96")},m(g,m){I(g,e,m),u&&u.m(e,null),p(e,l),p(e,s),p(s,i),p(e,o),a||(f=[ce(e,"click",d),ce(e,"pointerup",Va)],a=!0)},p(g,m){n=g,m&2&&(t=n[1].every(n[13])),t?u||(u=xl(n),u.c(),u.m(e,l)):u&&(u.d(1),u=null),m&2&&r!==(r=n[9](n[19].source.name)+"")&&Z(i,r)},d(g){g&&h(e),u&&u.d(),a=!1,et(f)}}}function ya(n){let e,t;return e=new ur({props:{strokeWidth:"3.5",className:"size-3.5"}}),{c(){Q(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){y(e.$$.fragment,l),t=!1},d(l){Y(e,l)}}}function Ma(n){let e,t;return e=new cr({props:{strokeWidth:"3.5",className:"size-3.5"}}),{c(){Q(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){y(e.$$.fragment,l),t=!1},d(l){Y(e,l)}}}function Ea(n){let e,t,l,s=n[7].t("References from")+"",r,i,o,a,f,u,d,g=n[7].t("and")+"",m,_,D=n[1].length-2+"",v,M,T,P=n[7].t("more")+"",L,S,w,C,V,O,B=Ce(n[1].slice(0,2)),G=[];for(let le=0;le<B.length;le+=1)G[le]=es(Ql(n,B,le));const U=[Ma,ya],j=[];function ue(le,he){return le[6]?0:1}return C=ue(n),V=j[C]=U[C](n),{c(){e=E("div"),t=E("div"),l=E("span"),r=q(s),i=A(),o=E("div"),a=E("div");for(let le=0;le<G.length;le+=1)G[le].c();f=A(),u=E("div"),d=E("span"),m=q(g),_=A(),v=q(D),M=A(),T=E("span"),L=q(P),S=A(),w=E("div"),V.c(),this.h()},l(le){e=N(le,"DIV",{class:!0});var he=k(e);t=N(he,"DIV",{class:!0});var J=k(t);l=N(J,"SPAN",{class:!0});var oe=k(l);r=F(oe,s),oe.forEach(h),i=H(J),o=N(J,"DIV",{class:!0});var me=k(o);a=N(me,"DIV",{class:!0});var re=k(a);for(let Me=0;Me<G.length;Me+=1)G[Me].l(re);re.forEach(h),me.forEach(h),f=H(J),u=N(J,"DIV",{class:!0});var ie=k(u);d=N(ie,"SPAN",{class:!0});var ge=k(d);m=F(ge,g),ge.forEach(h),_=H(ie),v=F(ie,D),M=H(ie),T=N(ie,"SPAN",{});var se=k(T);L=F(se,P),se.forEach(h),ie.forEach(h),J.forEach(h),S=H(he),w=N(he,"DIV",{class:!0});var fe=k(w);V.l(fe),fe.forEach(h),he.forEach(h),this.h()},h(){c(l,"class","whitespace-nowrap hidden sm:inline shrink-0"),c(a,"class","flex text-xs font-medium items-center"),c(o,"class","flex items-center overflow-auto scrollbar-none w-full max-w-full flex-1"),c(d,"class","hidden sm:inline"),c(u,"class","flex items-center gap-1 whitespace-nowrap shrink-0"),c(t,"class","flex-1 flex items-center gap-1 overflow-auto scrollbar-none w-full max-w-full"),c(w,"class","shrink-0"),c(e,"class","flex w-full overflow-auto items-center gap-2 text-gray-500 hover:text-gray-600 dark:hover:text-gray-400 transition cursor-pointer")},m(le,he){I(le,e,he),p(e,t),p(t,l),p(l,r),p(t,i),p(t,o),p(o,a);for(let J=0;J<G.length;J+=1)G[J]&&G[J].m(a,null);p(t,f),p(t,u),p(u,d),p(d,m),p(u,_),p(u,v),p(u,M),p(u,T),p(T,L),p(e,S),p(e,w),j[C].m(w,null),O=!0},p(le,he){if((!O||he&128)&&s!==(s=le[7].t("References from")+"")&&Z(r,s),he&562){B=Ce(le[1].slice(0,2));let oe;for(oe=0;oe<B.length;oe+=1){const me=Ql(le,B,oe);G[oe]?G[oe].p(me,he):(G[oe]=es(me),G[oe].c(),G[oe].m(a,null))}for(;oe<G.length;oe+=1)G[oe].d(1);G.length=B.length}(!O||he&128)&&g!==(g=le[7].t("and")+"")&&Z(m,g),(!O||he&2)&&D!==(D=le[1].length-2+"")&&Z(v,D),(!O||he&128)&&P!==(P=le[7].t("more")+"")&&Z(L,P);let J=C;C=ue(le),C!==J&&(x(),y(j[J],1,1,()=>{j[J]=null}),ee(),V=j[C],V||(V=j[C]=U[C](le),V.c()),b(V,1),V.m(w,null))},i(le){O||(b(V),O=!0)},o(le){y(V),O=!1},d(le){le&&h(e),Fe(G,le),j[C].d()}}}function ts(n){let e,t=n[21]+3+"",l;return{c(){e=E("div"),l=q(t),this.h()},l(s){e=N(s,"DIV",{class:!0});var r=k(e);l=F(r,t),r.forEach(h),this.h()},h(){c(e,"class","bg-gray-50 dark:bg-gray-800 rounded-full size-4")},m(s,r){I(s,e,r),p(e,l)},d(s){s&&h(e)}}}function ls(n){let e,t=n[1].every(n[12]),l,s,r=n[9](n[19].source.name)+"",i,o,a,f,u=t&&ts(n);function d(){return n[16](n[19])}return{c(){e=E("button"),u&&u.c(),l=A(),s=E("div"),i=q(r),o=A(),this.h()},l(g){e=N(g,"BUTTON",{class:!0});var m=k(e);u&&u.l(m),l=H(m),s=N(m,"DIV",{class:!0});var _=k(s);i=F(_,r),_.forEach(h),o=H(m),m.forEach(h),this.h()},h(){c(s,"class","flex-1 mx-1 truncate"),c(e,"class","no-toggle outline-hidden flex dark:text-gray-300 p-1 bg-gray-50 hover:bg-gray-100 dark:bg-gray-900 dark:hover:bg-gray-850 transition rounded-xl max-w-96")},m(g,m){I(g,e,m),u&&u.m(e,null),p(e,l),p(e,s),p(s,i),p(e,o),a||(f=ce(e,"click",d),a=!0)},p(g,m){n=g,m&2&&(t=n[1].every(n[12])),t?u||(u=ts(n),u.c(),u.m(e,l)):u&&(u.d(1),u=null),m&2&&r!==(r=n[9](n[19].source.name)+"")&&Z(i,r)},d(g){g&&h(e),u&&u.d(),a=!1,f()}}}function Na(n){let e,t,l=Ce(n[1].slice(2)),s=[];for(let r=0;r<l.length;r+=1)s[r]=ls(Xl(n,l,r));return{c(){e=E("div"),t=E("div");for(let r=0;r<s.length;r+=1)s[r].c();this.h()},l(r){e=N(r,"DIV",{slot:!0});var i=k(e);t=N(i,"DIV",{class:!0});var o=k(t);for(let a=0;a<s.length;a+=1)s[a].l(o);o.forEach(h),i.forEach(h),this.h()},h(){c(t,"class","flex text-xs font-medium flex-wrap"),c(e,"slot","content")},m(r,i){I(r,e,i),p(e,t);for(let o=0;o<s.length;o+=1)s[o]&&s[o].m(t,null)},p(r,i){if(i&562){l=Ce(r[1].slice(2));let o;for(o=0;o<l.length;o+=1){const a=Xl(r,l,o);s[o]?s[o].p(a,i):(s[o]=ls(a),s[o].c(),s[o].m(t,null))}for(;o<s.length;o+=1)s[o].d(1);s.length=l.length}},d(r){r&&h(e),Fe(s,r)}}}function ss(n){let e,t=n[21]+1+"",l;return{c(){e=E("div"),l=q(t),this.h()},l(s){e=N(s,"DIV",{class:!0});var r=k(e);l=F(r,t),r.forEach(h),this.h()},h(){c(e,"class","bg-gray-50 dark:bg-gray-800 rounded-full size-4")},m(s,r){I(s,e,r),p(e,l)},d(s){s&&h(e)}}}function ns(n){let e,t=n[1].every(n[11]),l,s,r=n[9](n[19].source.name)+"",i,o,a,f,u,d=t&&ss(n);function g(){return n[15](n[19])}return{c(){e=E("button"),d&&d.c(),l=A(),s=E("div"),i=q(r),o=A(),this.h()},l(m){e=N(m,"BUTTON",{id:!0,class:!0});var _=k(e);d&&d.l(_),l=H(_),s=N(_,"DIV",{class:!0});var D=k(s);i=F(D,r),D.forEach(h),o=H(_),_.forEach(h),this.h()},h(){c(s,"class","flex-1 mx-1 truncate text-black/60 hover:text-black dark:text-white/60 dark:hover:text-white transition"),c(e,"id",a=`source-${n[0]}-${n[21]+1}`),c(e,"class","no-toggle outline-hidden flex dark:text-gray-300 p-1 bg-white dark:bg-gray-900 rounded-xl max-w-96")},m(m,_){I(m,e,_),d&&d.m(e,null),p(e,l),p(e,s),p(s,i),p(e,o),f||(u=ce(e,"click",g),f=!0)},p(m,_){n=m,_&2&&(t=n[1].every(n[11])),t?d||(d=ss(n),d.c(),d.m(e,l)):d&&(d.d(1),d=null),_&2&&r!==(r=n[9](n[19].source.name)+"")&&Z(i,r),_&1&&a!==(a=`source-${n[0]}-${n[21]+1}`)&&c(e,"id",a)},d(m){m&&h(e),d&&d.d(),f=!1,u()}}}function Da(n){let e,t,l,s,r;function i(f){n[14](f)}let o={citation:n[5],showPercentage:n[2],showRelevance:n[3]};n[4]!==void 0&&(o.show=n[4]),e=new ka({props:o}),We.push(()=>Ze(e,"show",i));let a=n[1].length>0&&$l(n);return{c(){Q(e.$$.fragment),l=A(),a&&a.c(),s=ae()},l(f){$(e.$$.fragment,f),l=H(f),a&&a.l(f),s=ae()},m(f,u){X(e,f,u),I(f,l,u),a&&a.m(f,u),I(f,s,u),r=!0},p(f,[u]){const d={};u&32&&(d.citation=f[5]),u&4&&(d.showPercentage=f[2]),u&8&&(d.showRelevance=f[3]),!t&&u&16&&(t=!0,d.show=f[4],Qe(()=>t=!1)),e.$set(d),f[1].length>0?a?(a.p(f,u),u&2&&b(a,1)):(a=$l(f),a.c(),b(a,1),a.m(s.parentNode,s)):a&&(x(),y(a,1,1,()=>{a=null}),ee())},i(f){r||(b(e.$$.fragment,f),b(a),r=!0)},o(f){y(e.$$.fragment,f),y(a),r=!1},d(f){f&&(h(l),h(s)),Y(e,f),a&&a.d(f)}}}function Ta(n){const e=n.flatMap(s=>s.distances??[]),t=e.filter(s=>s!==void 0&&s>=-1&&s<=1).length,l=e.filter(s=>s!==void 0&&(s<-1||s>1)).length;return!(e.length===0||t===e.length-1&&l===1||l===e.length-1&&t===1)}function Ca(n){return n.flatMap(t=>t.distances??[]).every(t=>t!==void 0&&t>=-1&&t<=1)}const Va=n=>{n.stopPropagation()};function Sa(n,e,t){let l;const s=Ge("i18n");Te(n,s,w=>t(7,l=w));let{id:r=""}=e,{sources:i=[]}=e,o=[],a=!1,f=!0,u=!1,d=null,g=!1;const m=w=>{try{return decodeURIComponent(w)}catch{return w}},_=w=>w.distances!==void 0,D=w=>w.distances!==void 0,v=w=>w.distances!==void 0;function M(w){u=w,t(4,u)}const T=w=>{t(4,u=!0),t(5,d=w)},P=w=>{t(4,u=!0),t(5,d=w)},L=w=>{t(4,u=!0),t(5,d=w)};function S(w){g=w,t(6,g)}return n.$$set=w=>{"id"in w&&t(0,r=w.id),"sources"in w&&t(10,i=w.sources)},n.$$.update=()=>{n.$$.dirty&1026&&(t(1,o=i.reduce((w,C)=>(Object.keys(C).length===0||C.document.forEach((V,O)=>{var le,he,J;const B=(le=C.metadata)==null?void 0:le[O],G=(he=C.distances)==null?void 0:he[O],U=(B==null?void 0:B.source)??((J=C==null?void 0:C.source)==null?void 0:J.id)??"N/A";let j=C==null?void 0:C.source;B!=null&&B.name&&(j={...j,name:B.name}),(U.startsWith("http://")||U.startsWith("https://"))&&(j={...j,name:U,url:U});const ue=w.find(oe=>oe.id===U);ue?(ue.document.push(V),ue.metadata.push(B),G!==void 0&&ue.distances.push(G)):w.push({id:U,source:j,document:[V],metadata:B?[B]:[],distances:G!==void 0?[G]:void 0})}),w),[])),t(3,f=Ta(o)),t(2,a=Ca(o)))},[r,o,a,f,u,d,g,l,s,m,i,_,D,v,M,T,P,L,S]}class Ba extends He{constructor(e){super(),ze(this,e,Sa,Da,Re,{id:0,sources:10})}}function rs(n,e,t){const l=n.slice();return l[6]=e[t],l}function is(n){let e,t,l,s;const r=[Pa,Ra,Oa],i=[];function o(a,f){var u,d;return(u=a[1].result)!=null&&u.error?0:(d=a[1].result)!=null&&d.output?1:2}return t=o(n),l=i[t]=r[t](n),{c(){e=E("div"),l.c()},l(a){e=N(a,"DIV",{});var f=k(e);l.l(f),f.forEach(h)},m(a,f){I(a,e,f),i[t].m(e,null),s=!0},p(a,f){let u=t;t=o(a),t!==u&&(x(),y(i[u],1,1,()=>{i[u]=null}),ee(),l=i[t],l||(l=i[t]=r[t](a),l.c()),b(l,1),l.m(e,null))},i(a){s||(b(l),s=!0)},o(a){y(l),s=!1},d(a){a&&h(e),i[t].d()}}}function Oa(n){let e,t;return e=new ll({props:{type:"warning",content:"incomplete"}}),{c(){Q(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){y(e.$$.fragment,l),t=!1},d(l){Y(e,l)}}}function Ra(n){let e,t;return e=new ll({props:{type:"success",content:"success"}}),{c(){Q(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){y(e.$$.fragment,l),t=!1},d(l){Y(e,l)}}}function Pa(n){let e,t;return e=new ll({props:{type:"error",content:"error"}}),{c(){Q(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){y(e.$$.fragment,l),t=!1},d(l){Y(e,l)}}}function as(n){let e,t,l;return t=new tl({props:{className:"size-4"}}),{c(){e=E("div"),Q(t.$$.fragment)},l(s){e=N(s,"DIV",{});var r=k(e);$(t.$$.fragment,r),r.forEach(h)},m(s,r){I(s,e,r),X(t,e,null),l=!0},i(s){l||(b(t.$$.fragment,s),l=!0)},o(s){y(t.$$.fragment,s),l=!1},d(s){s&&h(e),Y(t)}}}function La(n){let e=n[2].t("Code execution")+"",t;return{c(){t=q(e)},l(l){t=F(l,e)},m(l,s){I(l,t,s)},p(l,s){s&4&&e!==(e=l[2].t("Code execution")+"")&&Z(t,e)},d(l){l&&h(t)}}}function ja(n){var i;let e=n[2].t("Code execution")+"",t,l,s=((i=n[1])==null?void 0:i.name)+"",r;return{c(){t=q(e),l=q(": "),r=q(s)},l(o){t=F(o,e),l=F(o,": "),r=F(o,s)},m(o,a){I(o,t,a),I(o,l,a),I(o,r,a)},p(o,a){var f;a&4&&e!==(e=o[2].t("Code execution")+"")&&Z(t,e),a&2&&s!==(s=((f=o[1])==null?void 0:f.name)+"")&&Z(r,s)},d(o){o&&(h(t),h(l),h(r))}}}function os(n){var r,i,o,a;let e,t,l=((i=(r=n[1])==null?void 0:r.result)==null?void 0:i.error)&&fs(n),s=((a=(o=n[1])==null?void 0:o.result)==null?void 0:a.output)&&us(n);return{c(){e=E("div"),l&&l.c(),t=A(),s&&s.c(),this.h()},l(f){e=N(f,"DIV",{class:!0});var u=k(e);l&&l.l(u),t=H(u),s&&s.l(u),u.forEach(h),this.h()},h(){c(e,"class","dark:bg-[#202123] dark:text-white px-4 py-4 rounded-b-lg flex flex-col gap-3")},m(f,u){I(f,e,u),l&&l.m(e,null),p(e,t),s&&s.m(e,null)},p(f,u){var d,g,m,_;(g=(d=f[1])==null?void 0:d.result)!=null&&g.error?l?l.p(f,u):(l=fs(f),l.c(),l.m(e,t)):l&&(l.d(1),l=null),(_=(m=f[1])==null?void 0:m.result)!=null&&_.output?s?s.p(f,u):(s=us(f),s.c(),s.m(e,null)):s&&(s.d(1),s=null)},d(f){f&&h(e),l&&l.d(),s&&s.d()}}}function fs(n){var f,u;let e,t,l=n[2].t("ERROR")+"",s,r,i,o=((u=(f=n[1])==null?void 0:f.result)==null?void 0:u.error)+"",a;return{c(){e=E("div"),t=E("div"),s=q(l),r=A(),i=E("div"),a=q(o),this.h()},l(d){e=N(d,"DIV",{});var g=k(e);t=N(g,"DIV",{class:!0});var m=k(t);s=F(m,l),m.forEach(h),r=H(g),i=N(g,"DIV",{class:!0});var _=k(i);a=F(_,o),_.forEach(h),g.forEach(h),this.h()},h(){c(t,"class","text-gray-500 text-xs mb-1"),c(i,"class","text-sm")},m(d,g){I(d,e,g),p(e,t),p(t,s),p(e,r),p(e,i),p(i,a)},p(d,g){var m,_;g&4&&l!==(l=d[2].t("ERROR")+"")&&Z(s,l),g&2&&o!==(o=((_=(m=d[1])==null?void 0:m.result)==null?void 0:_.error)+"")&&Z(a,o)},d(d){d&&h(e)}}}function us(n){var f,u;let e,t,l=n[2].t("OUTPUT")+"",s,r,i,o=((u=(f=n[1])==null?void 0:f.result)==null?void 0:u.output)+"",a;return{c(){e=E("div"),t=E("div"),s=q(l),r=A(),i=E("div"),a=q(o),this.h()},l(d){e=N(d,"DIV",{});var g=k(e);t=N(g,"DIV",{class:!0});var m=k(t);s=F(m,l),m.forEach(h),r=H(g),i=N(g,"DIV",{class:!0});var _=k(i);a=F(_,o),_.forEach(h),g.forEach(h),this.h()},h(){c(t,"class","text-gray-500 text-xs mb-1"),c(i,"class","text-sm")},m(d,g){I(d,e,g),p(e,t),p(t,s),p(e,r),p(e,i),p(i,a)},p(d,g){var m,_;g&4&&l!==(l=d[2].t("OUTPUT")+"")&&Z(s,l),g&2&&o!==(o=((_=(m=d[1])==null?void 0:m.result)==null?void 0:_.output)+"")&&Z(a,o)},d(d){d&&h(e)}}}function cs(n){var d,g;let e,t,l,s,r=n[2].t("Files")+"",i,o,a,f=Ce((g=(d=n[1])==null?void 0:d.result)==null?void 0:g.files),u=[];for(let m=0;m<f.length;m+=1)u[m]=ds(rs(n,f,m));return{c(){e=E("div"),t=E("hr"),l=A(),s=E("div"),i=q(r),o=A(),a=E("ul");for(let m=0;m<u.length;m+=1)u[m].c();this.h()},l(m){e=N(m,"DIV",{class:!0});var _=k(e);t=N(_,"HR",{class:!0}),l=H(_),s=N(_,"DIV",{class:!0});var D=k(s);i=F(D,r),D.forEach(h),o=H(_),a=N(_,"UL",{class:!0});var v=k(a);for(let M=0;M<u.length;M+=1)u[M].l(v);v.forEach(h),_.forEach(h),this.h()},h(){c(t,"class","border-gray-100 dark:border-gray-850 my-2"),c(s,"class","text-sm font-medium dark:text-gray-300"),c(a,"class","mt-1 list-disc pl-4 text-xs"),c(e,"class","flex flex-col w-full")},m(m,_){I(m,e,_),p(e,t),p(e,l),p(e,s),p(s,i),p(e,o),p(e,a);for(let D=0;D<u.length;D+=1)u[D]&&u[D].m(a,null)},p(m,_){var D,v;if(_&4&&r!==(r=m[2].t("Files")+"")&&Z(i,r),_&2){f=Ce((v=(D=m[1])==null?void 0:D.result)==null?void 0:v.files);let M;for(M=0;M<f.length;M+=1){const T=rs(m,f,M);u[M]?u[M].p(T,_):(u[M]=ds(T),u[M].c(),u[M].m(a,null))}for(;M<u.length;M+=1)u[M].d(1);u.length=f.length}},d(m){m&&h(e),Fe(u,m)}}}function ds(n){let e,t,l=n[6].name+"",s,r,i;return{c(){e=E("li"),t=E("a"),s=q(l),i=A(),this.h()},l(o){e=N(o,"LI",{});var a=k(e);t=N(a,"A",{href:!0,target:!0});var f=k(t);s=F(f,l),f.forEach(h),i=H(a),a.forEach(h),this.h()},h(){c(t,"href",r=n[6].url),c(t,"target","_blank")},m(o,a){I(o,e,a),p(e,t),p(t,s),p(e,i)},p(o,a){a&2&&l!==(l=o[6].name+"")&&Z(s,l),a&2&&r!==(r=o[6].url)&&c(t,"href",r)},d(o){o&&h(e)}}}function Aa(n){var U,j,ue,le,he,J,oe,me,re,ie,ge,se,fe,Me,Ee,ve,Se,we,ke;let e,t,l,s,r,i,o,a,f,u,d,g,m,_,D,v,M,T,P,L,S=((U=n[1])==null?void 0:U.result)&&is(n),w=!((j=n[1])!=null&&j.result)&&as();function C(R,K){var ne;return(ne=R[1])!=null&&ne.name?ja:La}let V=C(n),O=V(n);u=new Wt({props:{className:"size-5"}}),D=new fi({props:{id:"code-exec-"+((ue=n[1])==null?void 0:ue.id)+"-code",lang:((le=n[1])==null?void 0:le.language)??"",code:((he=n[1])==null?void 0:he.code)??"",className:"",editorClassName:(J=n[1])!=null&&J.result&&((me=(oe=n[1])==null?void 0:oe.result)!=null&&me.error||(ie=(re=n[1])==null?void 0:re.result)!=null&&ie.output)?"rounded-b-none":"",run:!1}});let B=((ge=n[1])==null?void 0:ge.result)&&(((fe=(se=n[1])==null?void 0:se.result)==null?void 0:fe.error)||((Ee=(Me=n[1])==null?void 0:Me.result)==null?void 0:Ee.output))&&os(n),G=((Se=(ve=n[1])==null?void 0:ve.result)==null?void 0:Se.files)&&((ke=(we=n[1])==null?void 0:we.result)==null?void 0:ke.files.length)>0&&cs(n);return{c(){e=E("div"),t=E("div"),l=E("div"),S&&S.c(),s=A(),r=E("div"),w&&w.c(),i=A(),o=E("div"),O.c(),a=A(),f=E("button"),Q(u.$$.fragment),d=A(),g=E("div"),m=E("div"),_=E("div"),Q(D.$$.fragment),v=A(),B&&B.c(),M=A(),G&&G.c(),this.h()},l(R){e=N(R,"DIV",{});var K=k(e);t=N(K,"DIV",{class:!0});var ne=k(t);l=N(ne,"DIV",{class:!0});var be=k(l);S&&S.l(be),s=H(be),r=N(be,"DIV",{class:!0});var ye=k(r);w&&w.l(ye),i=H(ye),o=N(ye,"DIV",{});var W=k(o);O.l(W),W.forEach(h),ye.forEach(h),be.forEach(h),a=H(ne),f=N(ne,"BUTTON",{class:!0});var de=k(f);$(u.$$.fragment,de),de.forEach(h),ne.forEach(h),d=H(K),g=N(K,"DIV",{class:!0});var Ie=k(g);m=N(Ie,"DIV",{class:!0});var Ve=k(m);_=N(Ve,"DIV",{class:!0});var je=k(_);$(D.$$.fragment,je),je.forEach(h),v=H(Ve),B&&B.l(Ve),M=H(Ve),G&&G.l(Ve),Ve.forEach(h),Ie.forEach(h),K.forEach(h),this.h()},h(){c(r,"class","flex gap-2 items-center"),c(l,"class","text-lg font-medium self-center flex flex-col gap-0.5 capitalize"),c(f,"class","self-center"),c(t,"class","flex justify-between dark:text-gray-300 px-5 pt-4 pb-2"),c(_,"class","flex flex-col w-full"),c(m,"class","flex flex-col w-full dark:text-gray-200 overflow-y-scroll max-h-[22rem] scrollbar-hidden"),c(g,"class","flex flex-col md:flex-row w-full px-4 pb-5")},m(R,K){I(R,e,K),p(e,t),p(t,l),S&&S.m(l,null),p(l,s),p(l,r),w&&w.m(r,null),p(r,i),p(r,o),O.m(o,null),p(t,a),p(t,f),X(u,f,null),p(e,d),p(e,g),p(g,m),p(m,_),X(D,_,null),p(m,v),B&&B.m(m,null),p(m,M),G&&G.m(m,null),T=!0,P||(L=ce(f,"click",n[4]),P=!0)},p(R,K){var be,ye,W,de,Ie,Ve,je,Le,te,Xe,Ye,Ke,nt,dt,ut,St,Bt,Ot,Rt;(be=R[1])!=null&&be.result?S?(S.p(R,K),K&2&&b(S,1)):(S=is(R),S.c(),b(S,1),S.m(l,s)):S&&(x(),y(S,1,1,()=>{S=null}),ee()),(ye=R[1])!=null&&ye.result?w&&(x(),y(w,1,1,()=>{w=null}),ee()):w?K&2&&b(w,1):(w=as(),w.c(),b(w,1),w.m(r,i)),V===(V=C(R))&&O?O.p(R,K):(O.d(1),O=V(R),O&&(O.c(),O.m(o,null)));const ne={};K&2&&(ne.id="code-exec-"+((W=R[1])==null?void 0:W.id)+"-code"),K&2&&(ne.lang=((de=R[1])==null?void 0:de.language)??""),K&2&&(ne.code=((Ie=R[1])==null?void 0:Ie.code)??""),K&2&&(ne.editorClassName=(Ve=R[1])!=null&&Ve.result&&((Le=(je=R[1])==null?void 0:je.result)!=null&&Le.error||(Xe=(te=R[1])==null?void 0:te.result)!=null&&Xe.output)?"rounded-b-none":""),D.$set(ne),(Ye=R[1])!=null&&Ye.result&&((nt=(Ke=R[1])==null?void 0:Ke.result)!=null&&nt.error||(ut=(dt=R[1])==null?void 0:dt.result)!=null&&ut.output)?B?B.p(R,K):(B=os(R),B.c(),B.m(m,M)):B&&(B.d(1),B=null),(Bt=(St=R[1])==null?void 0:St.result)!=null&&Bt.files&&((Rt=(Ot=R[1])==null?void 0:Ot.result)==null?void 0:Rt.files.length)>0?G?G.p(R,K):(G=cs(R),G.c(),G.m(m,null)):G&&(G.d(1),G=null)},i(R){T||(b(S),b(w),b(u.$$.fragment,R),b(D.$$.fragment,R),T=!0)},o(R){y(S),y(w),y(u.$$.fragment,R),y(D.$$.fragment,R),T=!1},d(R){R&&h(e),S&&S.d(),w&&w.d(),O.d(),Y(u),Y(D),B&&B.d(),G&&G.d(),P=!1,L()}}}function Ha(n){let e,t,l;function s(i){n[5](i)}let r={size:"lg",$$slots:{default:[Aa]},$$scope:{ctx:n}};return n[0]!==void 0&&(r.show=n[0]),e=new hr({props:r}),We.push(()=>Ze(e,"show",s)),{c(){Q(e.$$.fragment)},l(i){$(e.$$.fragment,i)},m(i,o){X(e,i,o),l=!0},p(i,[o]){const a={};o&519&&(a.$$scope={dirty:o,ctx:i}),!t&&o&1&&(t=!0,a.show=i[0],Qe(()=>t=!1)),e.$set(a)},i(i){l||(b(e.$$.fragment,i),l=!0)},o(i){y(e.$$.fragment,i),l=!1},d(i){Y(e,i)}}}function za(n,e,t){let l;const s=Ge("i18n");Te(n,s,f=>t(2,l=f));let{show:r=!1}=e,{codeExecution:i=null}=e;const o=()=>{t(0,r=!1),t(1,i=null)};function a(f){r=f,t(0,r)}return n.$$set=f=>{"show"in f&&t(0,r=f.show),"codeExecution"in f&&t(1,i=f.codeExecution)},[r,i,l,s,o,a]}class Ua extends He{constructor(e){super(),ze(this,e,za,Ha,Re,{show:0,codeExecution:1})}}function hs(n,e,t){const l=n.slice();return l[6]=e[t],l}function ms(n){let e,t=[],l=new Map,s,r=Ce(n[0]);const i=o=>o[6].id;for(let o=0;o<r.length;o+=1){let a=hs(n,r,o),f=i(a);l.set(f,t[o]=gs(f,a))}return{c(){e=E("div");for(let o=0;o<t.length;o+=1)t[o].c();this.h()},l(o){e=N(o,"DIV",{class:!0});var a=k(e);for(let f=0;f<t.length;f+=1)t[f].l(a);a.forEach(h),this.h()},h(){c(e,"class","mt-1 mb-2 w-full flex gap-1 items-center flex-wrap")},m(o,a){I(o,e,a);for(let f=0;f<t.length;f+=1)t[f]&&t[f].m(e,null);s=!0},p(o,a){a&7&&(r=Ce(o[0]),x(),t=zt(t,a,i,1,o,r,l,e,Xt,gs,null,hs),ee())},i(o){if(!s){for(let a=0;a<r.length;a+=1)b(t[a]);s=!0}},o(o){for(let a=0;a<t.length;a+=1)y(t[a]);s=!1},d(o){o&&h(e);for(let a=0;a<t.length;a+=1)t[a].d()}}}function Wa(n){let e,t;return e=new tl({props:{className:"size-4"}}),{c(){Q(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},p:Ne,i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){y(e.$$.fragment,l),t=!1},d(l){Y(e,l)}}}function qa(n){let e,t,l,s;const r=[Ja,Ga,Fa],i=[];function o(a,f){var u,d;return(u=a[6].result)!=null&&u.error?0:(d=a[6].result)!=null&&d.output?1:2}return e=o(n),t=i[e]=r[e](n),{c(){t.c(),l=ae()},l(a){t.l(a),l=ae()},m(a,f){i[e].m(a,f),I(a,l,f),s=!0},p(a,f){let u=e;e=o(a),e!==u&&(x(),y(i[u],1,1,()=>{i[u]=null}),ee(),t=i[e],t||(t=i[e]=r[e](a),t.c()),b(t,1),t.m(l.parentNode,l))},i(a){s||(b(t),s=!0)},o(a){y(t),s=!1},d(a){a&&h(l),i[e].d(a)}}}function Fa(n){let e,t;return e=new pi({}),{c(){Q(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){y(e.$$.fragment,l),t=!1},d(l){Y(e,l)}}}function Ga(n){let e,t;return e=new _i({props:{strokeWidth:"3",className:"size-3"}}),{c(){Q(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){y(e.$$.fragment,l),t=!1},d(l){Y(e,l)}}}function Ja(n){let e,t;return e=new Wt({}),{c(){Q(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){y(e.$$.fragment,l),t=!1},d(l){Y(e,l)}}}function gs(n,e){let t,l,s,r,i,o,a,f=e[6].name+"",u,d,g,m,_,D;const v=[qa,Wa],M=[];function T(L,S){var w;return(w=L[6])!=null&&w.result?0:1}r=T(e),i=M[r]=v[r](e);function P(){return e[4](e[6])}return{key:n,first:null,c(){t=E("div"),l=E("button"),s=E("div"),i.c(),o=A(),a=E("div"),u=q(f),g=A(),this.h()},l(L){t=N(L,"DIV",{class:!0});var S=k(t);l=N(S,"BUTTON",{class:!0});var w=k(l);s=N(w,"DIV",{class:!0});var C=k(s);i.l(C),C.forEach(h),o=H(w),a=N(w,"DIV",{class:!0});var V=k(a);u=F(V,f),V.forEach(h),w.forEach(h),g=H(S),S.forEach(h),this.h()},h(){var L;c(s,"class","bg-white dark:bg-gray-700 rounded-full size-4 flex items-center justify-center"),c(a,"class",d="flex-1 mx-2 line-clamp-1 code-execution-name "+((L=e[6])!=null&&L.result?"":"pulse")+" svelte-1gvtig2"),c(l,"class","flex dark:text-gray-300 py-1 px-1 bg-gray-50 hover:bg-gray-100 dark:bg-gray-850 dark:hover:bg-gray-800 transition rounded-xl max-w-96"),c(t,"class","flex gap-1 text-xs font-semibold"),this.first=t},m(L,S){I(L,t,S),p(t,l),p(l,s),M[r].m(s,null),p(l,o),p(l,a),p(a,u),p(t,g),m=!0,_||(D=ce(l,"click",P),_=!0)},p(L,S){var C;e=L;let w=r;r=T(e),r===w?M[r].p(e,S):(x(),y(M[w],1,1,()=>{M[w]=null}),ee(),i=M[r],i?i.p(e,S):(i=M[r]=v[r](e),i.c()),b(i,1),i.m(s,null)),(!m||S&1)&&f!==(f=e[6].name+"")&&Z(u,f),(!m||S&1&&d!==(d="flex-1 mx-2 line-clamp-1 code-execution-name "+((C=e[6])!=null&&C.result?"":"pulse")+" svelte-1gvtig2"))&&c(a,"class",d)},i(L){m||(b(i),m=!0)},o(L){y(i),m=!1},d(L){L&&h(t),M[r].d(),_=!1,D()}}}function Ka(n){let e,t,l,s,r;function i(f){n[3](f)}let o={codeExecution:n[1]};n[2]!==void 0&&(o.show=n[2]),e=new Ua({props:o}),We.push(()=>Ze(e,"show",i));let a=n[0].length>0&&ms(n);return{c(){Q(e.$$.fragment),l=A(),a&&a.c(),s=ae()},l(f){$(e.$$.fragment,f),l=H(f),a&&a.l(f),s=ae()},m(f,u){X(e,f,u),I(f,l,u),a&&a.m(f,u),I(f,s,u),r=!0},p(f,[u]){const d={};u&2&&(d.codeExecution=f[1]),!t&&u&4&&(t=!0,d.show=f[2],Qe(()=>t=!1)),e.$set(d),f[0].length>0?a?(a.p(f,u),u&1&&b(a,1)):(a=ms(f),a.c(),b(a,1),a.m(s.parentNode,s)):a&&(x(),y(a,1,1,()=>{a=null}),ee())},i(f){r||(b(e.$$.fragment,f),b(a),r=!0)},o(f){y(e.$$.fragment,f),y(a),r=!1},d(f){f&&(h(l),h(s)),Y(e,f),a&&a.d(f)}}}function Za(n,e,t){let{codeExecutions:l=[]}=e,s=null,r=!1;const i=()=>{s&&t(1,s=l.find(f=>f.id===s.id))};function o(f){r=f,t(2,r)}const a=f=>{t(1,s=f),t(2,r=!0)};return n.$$set=f=>{"codeExecutions"in f&&t(0,l=f.codeExecutions)},n.$$.update=()=>{n.$$.dirty&1&&l&&i()},[l,s,r,o,a]}class Qa extends He{constructor(e){super(),ze(this,e,Za,Ka,Re,{codeExecutions:0})}}function _s(n,e,t){const l=n.slice();return l[25]=e[t],l}function Xa(n){let e,t,l,s,r,i,o,a,f,u,d,g;s=new Vt({props:{id:`${n[1]}-float-prompt`,content:n[6]}});const m=[xa,$a],_=[];function D(M,T){var P;return T&128&&(a=null),a==null&&(a=!M[7]||((P=M[7])==null?void 0:P.trim())===""),a?0:1}f=D(n,-1),u=_[f]=m[f](n);let v=n[8]&&ps(n);return{c(){e=E("div"),t=E("div"),l=E("div"),Q(s.$$.fragment),r=A(),i=E("div"),o=E("div"),u.c(),d=A(),v&&v.c(),this.h()},l(M){e=N(M,"DIV",{class:!0});var T=k(e);t=N(T,"DIV",{class:!0});var P=k(t);l=N(P,"DIV",{class:!0});var L=k(l);$(s.$$.fragment,L),L.forEach(h),P.forEach(h),r=H(T),i=N(T,"DIV",{class:!0});var S=k(i);o=N(S,"DIV",{class:!0,id:!0});var w=k(o);u.l(w),d=H(w),v&&v.l(w),w.forEach(h),S.forEach(h),T.forEach(h),this.h()},h(){c(l,"class","font-medium"),c(t,"class","bg-gray-50/50 dark:bg-gray-800 dark:text-gray-100 text-medium rounded-xl px-3.5 py-3 w-full"),c(o,"class","max-h-80 overflow-y-auto w-full markdown-prose-xs"),c(o,"id","response-container"),c(i,"class","bg-white dark:bg-gray-850 dark:text-gray-100 text-medium rounded-xl px-3.5 py-3 w-full"),c(e,"class","bg-white dark:bg-gray-850 dark:text-gray-100 rounded-xl shadow-xl w-80 max-w-full")},m(M,T){I(M,e,T),p(e,t),p(t,l),X(s,l,null),p(e,r),p(e,i),p(i,o),_[f].m(o,null),p(o,d),v&&v.m(o,null),g=!0},p(M,T){const P={};T&2&&(P.id=`${M[1]}-float-prompt`),T&64&&(P.content=M[6]),s.$set(P);let L=f;f=D(M,T),f===L?_[f].p(M,T):(x(),y(_[L],1,1,()=>{_[L]=null}),ee(),u=_[f],u?u.p(M,T):(u=_[f]=m[f](M),u.c()),b(u,1),u.m(o,d)),M[8]?v?v.p(M,T):(v=ps(M),v.c(),v.m(o,null)):v&&(v.d(1),v=null)},i(M){g||(b(s.$$.fragment,M),b(u),g=!0)},o(M){y(s.$$.fragment,M),y(u),g=!1},d(M){M&&h(e),Y(s),_[f].d(),v&&v.d()}}}function Ya(n){let e,t,l,s;const r=[to,eo],i=[];function o(a,f){return a[2]?1:0}return e=o(n),t=i[e]=r[e](n),{c(){t.c(),l=ae()},l(a){t.l(a),l=ae()},m(a,f){i[e].m(a,f),I(a,l,f),s=!0},p(a,f){let u=e;e=o(a),e===u?i[e].p(a,f):(x(),y(i[u],1,1,()=>{i[u]=null}),ee(),t=i[e],t?t.p(a,f):(t=i[e]=r[e](a),t.c()),b(t,1),t.m(l.parentNode,l))},i(a){s||(b(t),s=!0)},o(a){y(t),s=!1},d(a){a&&h(l),i[e].d(a)}}}function $a(n){let e,t;return e=new Vt({props:{id:`${n[1]}-float-response`,content:n[7]}}),{c(){Q(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},p(l,s){const r={};s&2&&(r.id=`${l[1]}-float-response`),s&128&&(r.content=l[7]),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){y(e.$$.fragment,l),t=!1},d(l){Y(e,l)}}}function xa(n){let e,t;return e=new xt({props:{size:"sm"}}),{c(){Q(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},p:Ne,i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){y(e.$$.fragment,l),t=!1},d(l){Y(e,l)}}}function ps(n){let e,t,l=n[9].t("Add")+"",s,r,i;return{c(){e=E("div"),t=E("button"),s=q(l),this.h()},l(o){e=N(o,"DIV",{class:!0});var a=k(e);t=N(a,"BUTTON",{class:!0});var f=k(t);s=F(f,l),f.forEach(h),a.forEach(h),this.h()},h(){c(t,"class","px-3.5 py-1.5 text-sm font-medium bg-black hover:bg-gray-900 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full"),c(e,"class","flex justify-end pt-3 text-sm font-medium")},m(o,a){I(o,e,a),p(e,t),p(t,s),r||(i=ce(t,"click",n[12]),r=!0)},p(o,a){a&512&&l!==(l=o[9].t("Add")+"")&&Z(s,l)},d(o){o&&h(e),r=!1,i()}}}function eo(n){let e,t,l,s,r,i,o,a,f,u,d;return{c(){e=E("div"),t=E("input"),s=A(),r=E("div"),i=E("button"),o=_e("svg"),a=_e("path"),this.h()},l(g){e=N(g,"DIV",{class:!0});var m=k(e);t=N(m,"INPUT",{type:!0,id:!0,class:!0,placeholder:!0}),s=H(m),r=N(m,"DIV",{class:!0});var _=k(r);i=N(_,"BUTTON",{class:!0});var D=k(i);o=pe(D,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var v=k(o);a=pe(v,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),k(a).forEach(h),v.forEach(h),D.forEach(h),_.forEach(h),m.forEach(h),this.h()},h(){c(t,"type","text"),c(t,"id","floating-message-input"),c(t,"class","ml-5 bg-transparent outline-hidden w-full flex-1 text-sm"),c(t,"placeholder",l=n[9].t("Ask a question")),c(a,"fill-rule","evenodd"),c(a,"d","M8 14a.75.75 0 0 1-.75-.75V4.56L4.03 7.78a.75.75 0 0 1-1.06-1.06l4.5-4.5a.75.75 0 0 1 1.06 0l4.5 4.5a.75.75 0 0 1-1.06 1.06L8.75 4.56v8.69A.75.75 0 0 1 8 14Z"),c(a,"clip-rule","evenodd"),c(o,"xmlns","http://www.w3.org/2000/svg"),c(o,"viewBox","0 0 16 16"),c(o,"fill","currentColor"),c(o,"class","size-4"),c(i,"class",f=(n[5]!==""?"bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 ":"text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled")+" transition rounded-full p-1.5 m-0.5 self-center"),c(r,"class","ml-1 mr-2"),c(e,"class","py-1 flex dark:text-gray-100 bg-gray-50 dark:bg-gray-800 border border-gray-100 dark:border-gray-850 w-72 rounded-full shadow-xl")},m(g,m){I(g,e,m),p(e,t),ot(t,n[5]),p(e,s),p(e,r),p(r,i),p(i,o),p(o,a),u||(d=[ce(t,"input",n[19]),ce(t,"keydown",n[20]),ce(i,"click",n[21])],u=!0)},p(g,m){m&512&&l!==(l=g[9].t("Ask a question"))&&c(t,"placeholder",l),m&32&&t.value!==g[5]&&ot(t,g[5]),m&32&&f!==(f=(g[5]!==""?"bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 ":"text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled")+" transition rounded-full p-1.5 m-0.5 self-center")&&c(i,"class",f)},i:Ne,o:Ne,d(g){g&&h(e),u=!1,et(d)}}}function to(n){let e,t,l=Ce(n[0]),s=[];for(let i=0;i<l.length;i+=1)s[i]=vs(_s(n,l,i));const r=i=>y(s[i],1,1,()=>{s[i]=null});return{c(){e=E("div");for(let i=0;i<s.length;i+=1)s[i].c();this.h()},l(i){e=N(i,"DIV",{class:!0});var o=k(e);for(let a=0;a<s.length;a+=1)s[a].l(o);o.forEach(h),this.h()},h(){c(e,"class","flex flex-row gap-0.5 shrink-0 p-1 bg-white dark:bg-gray-850 dark:text-gray-100 text-medium rounded-lg shadow-xl")},m(i,o){I(i,e,o);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null);t=!0},p(i,o){if(o&2109){l=Ce(i[0]);let a;for(a=0;a<l.length;a+=1){const f=_s(i,l,a);s[a]?(s[a].p(f,o),b(s[a],1)):(s[a]=vs(f),s[a].c(),b(s[a],1),s[a].m(e,null))}for(x(),a=l.length;a<s.length;a+=1)r(a);ee()}},i(i){if(!t){for(let o=0;o<l.length;o+=1)b(s[o]);t=!0}},o(i){s=s.filter(Boolean);for(let o=0;o<s.length;o+=1)y(s[o]);t=!1},d(i){i&&h(e),Fe(s,i)}}}function bs(n){let e,t,l;var s=n[25].icon;function r(i,o){return{props:{className:"size-3 shrink-0"}}}return s&&(e=vl(s,r())),{c(){e&&Q(e.$$.fragment),t=ae()},l(i){e&&$(e.$$.fragment,i),t=ae()},m(i,o){e&&X(e,i,o),I(i,t,o),l=!0},p(i,o){if(o&1&&s!==(s=i[25].icon)){if(e){x();const a=e;y(a.$$.fragment,1,0,()=>{Y(a,1)}),ee()}s?(e=vl(s,r()),Q(e.$$.fragment),b(e.$$.fragment,1),X(e,t.parentNode,t)):e=null}},i(i){l||(e&&b(e.$$.fragment,i),l=!0)},o(i){e&&y(e.$$.fragment,i),l=!1},d(i){i&&h(t),e&&Y(e,i)}}}function vs(n){let e,t,l,s=n[25].label+"",r,i,o,a,f,u=n[25].icon&&bs(n);function d(){return n[18](n[25])}return{c(){e=E("button"),u&&u.c(),t=A(),l=E("div"),r=q(s),i=A(),this.h()},l(g){e=N(g,"BUTTON",{class:!0});var m=k(e);u&&u.l(m),t=H(m),l=N(m,"DIV",{class:!0});var _=k(l);r=F(_,s),_.forEach(h),i=H(m),m.forEach(h),this.h()},h(){c(l,"class","shrink-0"),c(e,"class","px-1 hover:bg-gray-50 dark:hover:bg-gray-800 rounded-sm flex items-center gap-1 min-w-fit")},m(g,m){I(g,e,m),u&&u.m(e,null),p(e,t),p(e,l),p(l,r),p(e,i),o=!0,a||(f=ce(e,"click",d),a=!0)},p(g,m){n=g,n[25].icon?u?(u.p(n,m),m&1&&b(u,1)):(u=bs(n),u.c(),b(u,1),u.m(e,t)):u&&(x(),y(u,1,1,()=>{u=null}),ee()),(!o||m&1)&&s!==(s=n[25].label+"")&&Z(r,s)},i(g){o||(b(u),o=!0)},o(g){y(u),o=!1},d(g){g&&h(e),u&&u.d(),a=!1,f()}}}function lo(n){let e,t,l,s,r;const i=[Ya,Xa],o=[];function a(f,u){return f[7]===null?0:1}return t=a(n),l=o[t]=i[t](n),{c(){e=E("div"),l.c(),this.h()},l(f){e=N(f,"DIV",{id:!0,class:!0,style:!0});var u=k(e);l.l(u),u.forEach(h),this.h()},h(){c(e,"id",s=`floating-buttons-${n[1]}`),c(e,"class","absolute rounded-lg mt-1 text-xs z-9999"),jt(e,"display","none")},m(f,u){I(f,e,u),o[t].m(e,null),r=!0},p(f,[u]){let d=t;t=a(f),t===d?o[t].p(f,u):(x(),y(o[d],1,1,()=>{o[d]=null}),ee(),l=o[t],l?l.p(f,u):(l=o[t]=i[t](f),l.c()),b(l,1),l.m(e,null)),(!r||u&2&&s!==(s=`floating-buttons-${f[1]}`))&&c(e,"id",s)},i(f){r||(b(l),r=!0)},o(f){y(l),r=!1},d(f){f&&h(e),o[t].d()}}}function so(n,e,t){let l;const s=Ge("i18n");Te(n,s,U=>t(9,l=U));let{id:r=""}=e,{messageId:i=""}=e,{model:o=null}=e,{messages:a=[]}=e,{actions:f=[]}=e,{onAdd:u=U=>{}}=e,d=!1,g=null,m="",_="",D="",v=null,M=!1,T=null;const P=[{id:"ask",label:l.t("Ask"),icon:ai,input:!0,prompt:`{{SELECTED_CONTENT}}


{{INPUT_CONTENT}}`},{id:"explain",label:l.t("Explain"),icon:ui,prompt:`{{SELECTED_CONTENT}}


${l.t("Explain")}`}],L=async()=>{const U=document.getElementById("response-container");U&&U.scrollHeight-U.clientHeight<=U.scrollTop+50&&(U.scrollTop=U.scrollHeight)},S=async U=>{if(!o){qe.error("Model not selected");return}let j=m.split(`
`).map(ie=>`> ${ie}`).join(`
`),ue=f.find(ie=>ie.id===U);if(!ue){qe.error("Action not found");return}let le=(ue==null?void 0:ue.prompt)??"",he=[];const J=/\{\{(.*?)\|tool:id="([^"]+)"\}\}/g;le=le.replace(J,(ie,ge,se)=>(he.push(se),ge));let oe=/\{\{TOOL:([^\}]+)\}\}/g,me;for(;(me=oe.exec(le))!==null;)he.push(me[1]);le=le.replace(oe,""),le.includes("{{INPUT_CONTENT}}")&&d&&(le=le.replace("{{INPUT_CONTENT}}",_),t(5,_="")),le=le.replace("{{CONTENT}}",m),le=le.replace("{{SELECTED_CONTENT}}",j),t(6,D=le),t(7,v="");let re;if([re,T]=await bi(localStorage.token,{model:o,messages:[...a,{role:"user",content:D}].map(ie=>({role:ie.role,content:ie.content})),...he.length>0?{tool_ids:he}:{},stream:!0}),re&&re.ok){const ie=re.body.getReader(),ge=new TextDecoder,se=async()=>{var fe,Me;for(;;){const{done:Ee,value:ve}=await ie.read();if(Ee)break;const we=ge.decode(ve,{stream:!0}).split(`
`).filter(ke=>ke.trim()!=="");for(const ke of we)if(ke.startsWith("data: "))if(ke.startsWith("data: [DONE]")){t(8,M=!0),await Oe(),L();continue}else try{const R=JSON.parse(ke.slice(6));R.choices&&((Me=(fe=R.choices[0])==null?void 0:fe.delta)!=null&&Me.content)&&(t(7,v+=R.choices[0].delta.content),L())}catch(R){console.error(R)}}};try{await se()}catch(fe){fe.name!=="AbortError"&&console.error(fe)}}else qe.error("An error occurred while fetching the explanation")},w=async()=>{u({modelId:o,parentId:i,messages:[{role:"user",content:D},{role:"assistant",content:v}]})},C=()=>{T&&T.abort(),t(3,g=null),t(4,m=""),t(7,v=null),t(8,M=!1),t(2,d=!1),t(5,_="")};sr(()=>{T&&T.abort()});const V=async U=>{t(4,m=window.getSelection().toString()),t(3,g=U),U.prompt.includes("{{INPUT_CONTENT}}")?(t(2,d=!0),t(5,_=""),await Oe(),setTimeout(()=>{const j=document.getElementById("floating-message-input");j&&j.focus()},0)):S(U.id)};function O(){_=this.value,t(5,_)}const B=U=>{U.key==="Enter"&&S(g==null?void 0:g.id)},G=()=>{S(g==null?void 0:g.id)};return n.$$set=U=>{"id"in U&&t(1,r=U.id),"messageId"in U&&t(13,i=U.messageId),"model"in U&&t(14,o=U.model),"messages"in U&&t(15,a=U.messages),"actions"in U&&t(0,f=U.actions),"onAdd"in U&&t(16,u=U.onAdd)},n.$$.update=()=>{n.$$.dirty&1&&f.length===0&&t(0,f=P)},[f,r,d,g,m,_,D,v,M,l,s,S,w,i,o,a,u,C,V,O,B,G]}class no extends He{constructor(e){super(),ze(this,e,so,lo,Re,{id:1,messageId:13,model:14,messages:15,actions:0,onAdd:16,closeHandler:17})}get closeHandler(){return this.$$.ctx[17]}}function ks(n){var s,r,i,o;let e,t,l={id:n[0],messageId:n[3],actions:((s=n[19])==null?void 0:s.floatingActionButtons)??[],model:(n[4]??[]).includes((r=n[6])==null?void 0:r.id)?(i=n[6])==null?void 0:i.id:(n[4]??[]).length>0?n[4].at(0):(o=n[6])==null?void 0:o.id,messages:Qt(n[2],n[0]),onAdd:n[26]};return e=new no({props:l}),n[27](e),{c(){Q(e.$$.fragment)},l(a){$(e.$$.fragment,a)},m(a,f){X(e,a,f),t=!0},p(a,f){var d,g,m,_;const u={};f&1&&(u.id=a[0]),f&8&&(u.messageId=a[3]),f&524288&&(u.actions=((d=a[19])==null?void 0:d.floatingActionButtons)??[]),f&80&&(u.model=(a[4]??[]).includes((g=a[6])==null?void 0:g.id)?(m=a[6])==null?void 0:m.id:(a[4]??[]).length>0?a[4].at(0):(_=a[6])==null?void 0:_.id),f&5&&(u.messages=Qt(a[2],a[0])),f&32768&&(u.onAdd=a[26]),e.$set(u)},i(a){t||(b(e.$$.fragment,a),t=!0)},o(a){y(e.$$.fragment,a),t=!1},d(a){n[27](null),Y(e,a)}}}function ro(n){let e,t,l,s,r;t=new Vt({props:{id:n[0],content:n[1],model:n[6],save:n[8],preview:n[9],done:n[5],topPadding:n[11],sourceIds:(n[7]??[]).reduce(n[22],[]),onSourceClick:n[13],onTaskClick:n[14],onSave:n[12],onUpdate:n[23],onPreview:n[24]}});let i=n[10]&&n[6]&&ks(n);return{c(){e=E("div"),Q(t.$$.fragment),l=A(),i&&i.c(),s=ae()},l(o){e=N(o,"DIV",{});var a=k(e);$(t.$$.fragment,a),a.forEach(h),l=H(o),i&&i.l(o),s=ae()},m(o,a){I(o,e,a),X(t,e,null),n[25](e),I(o,l,a),i&&i.m(o,a),I(o,s,a),r=!0},p(o,[a]){const f={};a&1&&(f.id=o[0]),a&2&&(f.content=o[1]),a&64&&(f.model=o[6]),a&256&&(f.save=o[8]),a&512&&(f.preview=o[9]),a&32&&(f.done=o[5]),a&2048&&(f.topPadding=o[11]),a&192&&(f.sourceIds=(o[7]??[]).reduce(o[22],[])),a&8192&&(f.onSourceClick=o[13]),a&16384&&(f.onTaskClick=o[14]),a&4096&&(f.onSave=o[12]),a&1835008&&(f.onUpdate=o[23]),t.$set(f),o[10]&&o[6]?i?(i.p(o,a),a&1088&&b(i,1)):(i=ks(o),i.c(),b(i,1),i.m(s.parentNode,s)):i&&(x(),y(i,1,1,()=>{i=null}),ee())},i(o){r||(b(t.$$.fragment,o),b(i),r=!0)},o(o){y(t.$$.fragment,o),y(i),r=!1},d(o){o&&(h(e),h(l),h(s)),Y(t),n[25](null),i&&i.d(o)}}}function io(n,e,t){let l,s,r;Te(n,nr,J=>t(18,l=J)),Te(n,pt,J=>t(19,s=J)),Te(n,Zr,J=>t(20,r=J)),Ge("i18n");let{id:i}=e,{content:o}=e,{history:a}=e,{messageId:f}=e,{selectedModels:u=[]}=e,{done:d=!0}=e,{model:g=null}=e,{sources:m=null}=e,{save:_=!1}=e,{preview:D=!1}=e,{floatingButtons:v=!0}=e,{topPadding:M=!1}=e,{onSave:T=J=>{}}=e,{onSourceClick:P=J=>{}}=e,{onTaskClick:L=J=>{}}=e,{onAddMessages:S=J=>{}}=e,w,C;const V=J=>{const oe=document.getElementById(`floating-buttons-${i}`);if(!(w!=null&&w.contains(J.target))&&!(oe!=null&&oe.contains(J.target))){O();return}setTimeout(async()=>{if(await Oe(),!(w!=null&&w.contains(J.target)))return;let me=window.getSelection();if(me.toString().trim().length>0){const ie=me.getRangeAt(0).getBoundingClientRect(),ge=w.getBoundingClientRect(),se=ie.bottom-ge.top,fe=ie.left-ge.left;if(oe){oe.style.display="block";const Me=ge.width-fe;let Ee=l?window.innerWidth/2:window.innerWidth/3;if(Me<Ee){const ve=ge.right-ie.right;oe.style.right=`${ve}px`,oe.style.left="auto"}else oe.style.left=`${fe}px`,oe.style.right="auto";oe.style.top=`${se+5}px`}}else O()},0)},O=()=>{const J=document.getElementById(`floating-buttons-${i}`);J&&(J.style.display="none"),C&&typeof(C==null?void 0:C.closeHandler)=="function"&&(C==null||C.closeHandler())},B=J=>{J.key==="Escape"&&O()};It(()=>{v&&(w==null||w.addEventListener("mouseup",V),document.addEventListener("mouseup",V),document.addEventListener("keydown",B))}),sr(()=>{v&&(w==null||w.removeEventListener("mouseup",V),document.removeEventListener("mouseup",V),document.removeEventListener("keydown",B))});const G=(J,oe)=>{let me=[];return oe.document.forEach((re,ie)=>{var fe,Me,Ee,ve,Se;if(((Ee=(Me=(fe=g==null?void 0:g.info)==null?void 0:fe.meta)==null?void 0:Me.capabilities)==null?void 0:Ee.citations)==!1)return me.push("N/A"),me;const ge=(ve=oe.metadata)==null?void 0:ve[ie],se=(ge==null?void 0:ge.source)??"N/A";return ge!=null&&ge.name?(me.push(ge.name),me):(se.startsWith("http://")||se.startsWith("https://")?me.push(se):me.push(((Se=oe==null?void 0:oe.source)==null?void 0:Se.name)??se),me)}),J=[...J,...me],J.filter((re,ie)=>J.indexOf(re)===ie)},U=J=>{const{lang:oe,text:me}=J;((s==null?void 0:s.detectArtifacts)??!0)&&(["html","svg"].includes(oe)||oe==="xml"&&me.includes("svg"))&&!l&&r&&(wl.set(!0),Il.set(!0))},j=async J=>{await Qr.set(J),await Il.set(!0),await wl.set(!0),await Xr.set(!1)};function ue(J){We[J?"unshift":"push"](()=>{w=J,t(16,w)})}const le=({modelId:J,parentId:oe,messages:me})=>{S({modelId:J,parentId:oe,messages:me}),O()};function he(J){We[J?"unshift":"push"](()=>{C=J,t(17,C)})}return n.$$set=J=>{"id"in J&&t(0,i=J.id),"content"in J&&t(1,o=J.content),"history"in J&&t(2,a=J.history),"messageId"in J&&t(3,f=J.messageId),"selectedModels"in J&&t(4,u=J.selectedModels),"done"in J&&t(5,d=J.done),"model"in J&&t(6,g=J.model),"sources"in J&&t(7,m=J.sources),"save"in J&&t(8,_=J.save),"preview"in J&&t(9,D=J.preview),"floatingButtons"in J&&t(10,v=J.floatingButtons),"topPadding"in J&&t(11,M=J.topPadding),"onSave"in J&&t(12,T=J.onSave),"onSourceClick"in J&&t(13,P=J.onSourceClick),"onTaskClick"in J&&t(14,L=J.onTaskClick),"onAddMessages"in J&&t(15,S=J.onAddMessages)},[i,o,a,f,u,d,g,m,_,D,v,M,T,P,L,S,w,C,l,s,r,O,G,U,j,ue,le,he]}class ao extends He{constructor(e){super(),ze(this,e,io,ro,Re,{id:0,content:1,history:2,messageId:3,selectedModels:4,done:5,model:6,sources:7,save:8,preview:9,floatingButtons:10,topPadding:11,onSave:12,onSourceClick:13,onTaskClick:14,onAddMessages:15})}}function oo(n){return new Worker(""+new URL("../workers/kokoro.worker-C3fj7GC4.js",import.meta.url).href,{type:"module",name:n==null?void 0:n.name})}class fo{constructor(e="fp32"){vt(this,"worker",null);vt(this,"initialized",!1);vt(this,"dtype");vt(this,"requestQueue",[]);vt(this,"processing",!1);this.dtype=e}async init(){if(this.worker){console.warn("KokoroWorker is already initialized.");return}return this.worker=new oo,this.worker.onmessage=e=>{const{status:t,error:l,audioUrl:s}=e.data;if(t==="init:complete")this.initialized=!0;else if(t==="init:error")console.error(l),this.initialized=!1;else if(t==="generate:complete"){const r=this.requestQueue.shift();r&&(r.resolve(s),this.processNextRequest())}else if(t==="generate:error"){const r=this.requestQueue.shift();r&&(r.reject(new Error(l)),this.processNextRequest())}},new Promise((e,t)=>{this.worker.postMessage({type:"init",payload:{dtype:this.dtype}});const l=s=>{s.data.status==="init:complete"?(this.worker.removeEventListener("message",l),this.initialized=!0,e()):s.data.status==="init:error"&&(this.worker.removeEventListener("message",l),t(new Error(s.data.error)))};this.worker.addEventListener("message",l)})}async generate({text:e,voice:t}){if(!this.initialized||!this.worker)throw new Error("KokoroTTS Worker is not initialized yet.");return new Promise((l,s)=>{this.requestQueue.push({text:e,voice:t,resolve:l,reject:s}),this.processing||this.processNextRequest()})}processNextRequest(){if(this.requestQueue.length===0){this.processing=!1;return}this.processing=!0;const{text:e,voice:t}=this.requestQueue[0];this.worker.postMessage({type:"generate",payload:{text:e,voice:t}})}terminate(){this.worker&&(this.worker.terminate(),this.worker=null,this.initialized=!1,this.requestQueue=[],this.processing=!1)}}function uo(n){let e,t;return{c(){e=_e("svg"),t=_e("path"),this.h()},l(l){e=pe(l,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var s=k(e);t=pe(s,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),k(t).forEach(h),s.forEach(h),this.h()},h(){c(t,"fill-rule","evenodd"),c(t,"d","M2.75 2a.75.75 0 0 1 .75.75v6.5h7.94l-.97-.97a.75.75 0 0 1 1.06-1.06l2.25 2.25a.75.75 0 0 1 0 1.06l-2.25 2.25a.75.75 0 1 1-1.06-1.06l.97-.97H2.75A.75.75 0 0 1 2 10V2.75A.75.75 0 0 1 2.75 2Z"),c(t,"clip-rule","evenodd"),c(e,"xmlns","http://www.w3.org/2000/svg"),c(e,"viewBox","0 0 16 16"),c(e,"fill","currentColor"),c(e,"class",n[0])},m(l,s){I(l,e,s),p(e,t)},p(l,[s]){s&1&&c(e,"class",l[0])},i:Ne,o:Ne,d(l){l&&h(e)}}}function co(n,e,t){let{className:l="size-4"}=e,{strokeWidth:s="1.5"}=e;return n.$$set=r=>{"className"in r&&t(0,l=r.className),"strokeWidth"in r&&t(1,s=r.strokeWidth)},[l,s]}class ho extends He{constructor(e){super(),ze(this,e,co,uo,Re,{className:0,strokeWidth:1})}}function ws(n,e,t){const l=n.slice();return l[5]=e[t],l[7]=t,l}function mo(n){let e,t,l,s,r=n[5]+"",i,o,a,f,u,d;t=new ho({props:{className:"size-3.5"}});function g(){return n[4](n[5])}return{c(){e=E("div"),Q(t.$$.fragment),l=A(),s=E("div"),i=q(r),this.h()},l(m){e=N(m,"DIV",{class:!0,title:!0,"aria-label":!0});var _=k(e);$(t.$$.fragment,_),l=H(_),s=N(_,"DIV",{class:!0});var D=k(s);i=F(D,r),D.forEach(h),_.forEach(h),this.h()},h(){c(s,"class","line-clamp-1"),c(e,"class","mr-2 py-1.5 bg-transparent text-left text-sm flex items-center gap-2 px-1.5 text-gray-500 dark:text-gray-400 hover:text-black dark:hover:text-white transition cursor-pointer"),c(e,"title",o=n[5]),c(e,"aria-label",a=n[5])},m(m,_){I(m,e,_),X(t,e,null),p(e,l),p(e,s),p(s,i),f=!0,u||(d=ce(e,"click",g),u=!0)},p(m,_){n=m,(!f||_&1)&&r!==(r=n[5]+"")&&Z(i,r),(!f||_&1&&o!==(o=n[5]))&&c(e,"title",o),(!f||_&1&&a!==(a=n[5]))&&c(e,"aria-label",a)},i(m){f||(b(t.$$.fragment,m),f=!0)},o(m){y(t.$$.fragment,m),f=!1},d(m){m&&h(e),Y(t),u=!1,d()}}}function Is(n){let e;return{c(){e=E("hr"),this.h()},l(t){e=N(t,"HR",{class:!0}),this.h()},h(){c(e,"class","border-gray-100 dark:border-gray-850")},m(t,l){I(t,e,l)},d(t){t&&h(e)}}}function ys(n,e){let t,l,s,r,i;l=new Pe({props:{content:e[5],placement:"top-start",className:"line-clamp-1",$$slots:{default:[mo]},$$scope:{ctx:e}}});let o=e[7]<e[0].length-1&&Is();return{key:n,first:null,c(){t=ae(),Q(l.$$.fragment),s=A(),o&&o.c(),r=ae(),this.h()},l(a){t=ae(),$(l.$$.fragment,a),s=H(a),o&&o.l(a),r=ae(),this.h()},h(){this.first=t},m(a,f){I(a,t,f),X(l,a,f),I(a,s,f),o&&o.m(a,f),I(a,r,f),i=!0},p(a,f){e=a;const u={};f&1&&(u.content=e[5]),f&259&&(u.$$scope={dirty:f,ctx:e}),l.$set(u),e[7]<e[0].length-1?o||(o=Is(),o.c(),o.m(r.parentNode,r)):o&&(o.d(1),o=null)},i(a){i||(b(l.$$.fragment,a),i=!0)},o(a){y(l.$$.fragment,a),i=!1},d(a){a&&(h(t),h(s),h(r)),Y(l,a),o&&o.d(a)}}}function go(n){let e,t,l=n[2].t("Follow up")+"",s,r,i,o=[],a=new Map,f,u=Ce(n[0]);const d=g=>g[7];for(let g=0;g<u.length;g+=1){let m=ws(n,u,g),_=d(m);a.set(_,o[g]=ys(_,m))}return{c(){e=E("div"),t=E("div"),s=q(l),r=A(),i=E("div");for(let g=0;g<o.length;g+=1)o[g].c();this.h()},l(g){e=N(g,"DIV",{class:!0});var m=k(e);t=N(m,"DIV",{class:!0});var _=k(t);s=F(_,l),_.forEach(h),r=H(m),i=N(m,"DIV",{class:!0});var D=k(i);for(let v=0;v<o.length;v+=1)o[v].l(D);D.forEach(h),m.forEach(h),this.h()},h(){c(t,"class","text-sm font-medium"),c(i,"class","flex flex-col text-left gap-1 mt-1.5"),c(e,"class","mt-4")},m(g,m){I(g,e,m),p(e,t),p(t,s),p(e,r),p(e,i);for(let _=0;_<o.length;_+=1)o[_]&&o[_].m(i,null);f=!0},p(g,[m]){(!f||m&4)&&l!==(l=g[2].t("Follow up")+"")&&Z(s,l),m&3&&(u=Ce(g[0]),x(),o=zt(o,m,d,1,g,u,a,i,Xt,ys,null,ws),ee())},i(g){if(!f){for(let m=0;m<u.length;m+=1)b(o[m]);f=!0}},o(g){for(let m=0;m<o.length;m+=1)y(o[m]);f=!1},d(g){g&&h(e);for(let m=0;m<o.length;m+=1)o[m].d()}}}function _o(n,e,t){let l;const s=Ge("i18n");Te(n,s,a=>t(2,l=a));let{followUps:r=[]}=e,{onClick:i=()=>{}}=e;const o=a=>i(a);return n.$$set=a=>{"followUps"in a&&t(0,r=a.followUps),"onClick"in a&&t(1,i=a.onClick)},[r,i,l,s,o]}class po extends He{constructor(e){super(),ze(this,e,_o,go,Re,{followUps:0,onClick:1})}}function bo(n){let e,t,l,s,r;return{c(){e=_e("svg"),t=_e("path"),l=_e("path"),s=_e("path"),r=_e("path"),this.h()},l(i){e=pe(i,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var o=k(e);t=pe(o,"path",{d:!0,"stroke-linecap":!0,"stroke-linejoin":!0}),k(t).forEach(h),l=pe(o,"path",{d:!0,"stroke-linecap":!0,"stroke-linejoin":!0}),k(l).forEach(h),s=pe(o,"path",{d:!0,"stroke-linecap":!0,"stroke-linejoin":!0}),k(s).forEach(h),r=pe(o,"path",{d:!0,"stroke-linecap":!0,"stroke-linejoin":!0}),k(r).forEach(h),o.forEach(h),this.h()},h(){c(t,"d","M11 6H21"),c(t,"stroke-linecap","round"),c(t,"stroke-linejoin","round"),c(l,"d","M11 12H21"),c(l,"stroke-linecap","round"),c(l,"stroke-linejoin","round"),c(s,"d","M11 18H21"),c(s,"stroke-linecap","round"),c(s,"stroke-linejoin","round"),c(r,"d","M5 19V5M5 19L3 16.5M5 19L7 16.5M5 5L3 7M5 5L7 7"),c(r,"stroke-linecap","round"),c(r,"stroke-linejoin","round"),c(e,"xmlns","http://www.w3.org/2000/svg"),c(e,"fill","none"),c(e,"viewBox","0 0 24 24"),c(e,"stroke-width",n[1]),c(e,"stroke","currentColor"),c(e,"class",n[0])},m(i,o){I(i,e,o),p(e,t),p(e,l),p(e,s),p(e,r)},p(i,[o]){o&2&&c(e,"stroke-width",i[1]),o&1&&c(e,"class",i[0])},i:Ne,o:Ne,d(i){i&&h(e)}}}function vo(n,e,t){let{className:l="size-4"}=e,{strokeWidth:s="1.5"}=e;return n.$$set=r=>{"className"in r&&t(0,l=r.className),"strokeWidth"in r&&t(1,s=r.strokeWidth)},[l,s]}class ko extends He{constructor(e){super(),ze(this,e,vo,bo,Re,{className:0,strokeWidth:1})}}function wo(n){let e,t,l,s,r;return{c(){e=_e("svg"),t=_e("path"),l=_e("path"),s=_e("path"),r=_e("path"),this.h()},l(i){e=pe(i,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var o=k(e);t=pe(o,"path",{d:!0,"stroke-linecap":!0,"stroke-linejoin":!0}),k(t).forEach(h),l=pe(o,"path",{d:!0,"stroke-linecap":!0,"stroke-linejoin":!0}),k(l).forEach(h),s=pe(o,"path",{d:!0,"stroke-linecap":!0,"stroke-linejoin":!0}),k(s).forEach(h),r=pe(o,"path",{d:!0,"stroke-linecap":!0,"stroke-linejoin":!0}),k(r).forEach(h),o.forEach(h),this.h()},h(){c(t,"d","M11 6H21"),c(t,"stroke-linecap","round"),c(t,"stroke-linejoin","round"),c(l,"d","M11 12H21"),c(l,"stroke-linecap","round"),c(l,"stroke-linejoin","round"),c(s,"d","M11 18H21"),c(s,"stroke-linecap","round"),c(s,"stroke-linejoin","round"),c(r,"d","M5 19V5M5 10L3 8M5 10L7 8M5 14L3 16M5 14L7 16"),c(r,"stroke-linecap","round"),c(r,"stroke-linejoin","round"),c(e,"xmlns","http://www.w3.org/2000/svg"),c(e,"fill","none"),c(e,"viewBox","0 0 24 24"),c(e,"stroke-width",n[1]),c(e,"stroke","currentColor"),c(e,"class",n[0])},m(i,o){I(i,e,o),p(e,t),p(e,l),p(e,s),p(e,r)},p(i,[o]){o&2&&c(e,"stroke-width",i[1]),o&1&&c(e,"class",i[0])},i:Ne,o:Ne,d(i){i&&h(e)}}}function Io(n,e,t){let{className:l="size-4"}=e,{strokeWidth:s="1.5"}=e;return n.$$set=r=>{"className"in r&&t(0,l=r.className),"strokeWidth"in r&&t(1,s=r.strokeWidth)},[l,s]}class yo extends He{constructor(e){super(),ze(this,e,Io,wo,Re,{className:0,strokeWidth:1})}}function Mo(n){let e;const t=n[6].default,l=xn(t,n,n[15],null);return{c(){l&&l.c()},l(s){l&&l.l(s)},m(s,r){l&&l.m(s,r),e=!0},p(s,r){l&&l.p&&(!e||r&32768)&&er(l,t,s,s[15],e?lr(t,s[15],r,null):tr(s[15]),null)},i(s){e||(b(l,s),e=!0)},o(s){y(l,s),e=!1},d(s){l&&l.d(s)}}}function Eo(n){let e,t,l,s,r=n[4].t("Try Again")+"",i;return{c(){e=_e("svg"),t=_e("path"),l=A(),s=E("div"),i=q(r),this.h()},l(o){e=pe(o,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,"aria-hidden":!0,stroke:!0,class:!0});var a=k(e);t=pe(a,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(t).forEach(h),a.forEach(h),l=H(o),s=N(o,"DIV",{class:!0});var f=k(s);i=F(f,r),f.forEach(h),this.h()},h(){c(t,"stroke-linecap","round"),c(t,"stroke-linejoin","round"),c(t,"d","M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99"),c(e,"xmlns","http://www.w3.org/2000/svg"),c(e,"fill","none"),c(e,"viewBox","0 0 24 24"),c(e,"stroke-width","2"),c(e,"aria-hidden","true"),c(e,"stroke","currentColor"),c(e,"class","w-4 h-4"),c(s,"class","flex items-center")},m(o,a){I(o,e,a),p(e,t),I(o,l,a),I(o,s,a),p(s,i)},p(o,a){a&16&&r!==(r=o[4].t("Try Again")+"")&&Z(i,r)},d(o){o&&(h(e),h(l),h(s))}}}function No(n){let e,t,l,s=n[4].t("Add Details")+"",r,i;return e=new ko({props:{strokeWidth:"2"}}),{c(){Q(e.$$.fragment),t=A(),l=E("div"),r=q(s),this.h()},l(o){$(e.$$.fragment,o),t=H(o),l=N(o,"DIV",{class:!0});var a=k(l);r=F(a,s),a.forEach(h),this.h()},h(){c(l,"class","flex items-center")},m(o,a){X(e,o,a),I(o,t,a),I(o,l,a),p(l,r),i=!0},p(o,a){(!i||a&16)&&s!==(s=o[4].t("Add Details")+"")&&Z(r,s)},i(o){i||(b(e.$$.fragment,o),i=!0)},o(o){y(e.$$.fragment,o),i=!1},d(o){o&&(h(t),h(l)),Y(e,o)}}}function Do(n){let e,t,l,s=n[4].t("More Concise")+"",r,i;return e=new yo({props:{strokeWidth:"2"}}),{c(){Q(e.$$.fragment),t=A(),l=E("div"),r=q(s),this.h()},l(o){$(e.$$.fragment,o),t=H(o),l=N(o,"DIV",{class:!0});var a=k(l);r=F(a,s),a.forEach(h),this.h()},h(){c(l,"class","flex items-center")},m(o,a){X(e,o,a),I(o,t,a),I(o,l,a),p(l,r),i=!0},p(o,a){(!i||a&16)&&s!==(s=o[4].t("More Concise")+"")&&Z(r,s)},i(o){i||(b(e.$$.fragment,o),i=!0)},o(o){y(e.$$.fragment,o),i=!1},d(o){o&&(h(t),h(l)),Y(e,o)}}}function To(n){let e,t,l,s,r,i,o,a,f,u,d,g,m,_,D,v,M,T,P,L;return m=new qt({props:{class:"flex  gap-2  items-center px-3 py-1.5 text-sm  font-medium cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-lg",$$slots:{default:[Eo]},$$scope:{ctx:n}}}),m.$on("click",n[10]),D=new qt({props:{class:"flex  gap-2  items-center px-3 py-1.5 text-sm  font-medium cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-lg",$$slots:{default:[No]},$$scope:{ctx:n}}}),D.$on("click",n[11]),M=new qt({props:{class:"flex  gap-2  items-center px-3 py-1.5 text-sm  font-medium cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-lg",$$slots:{default:[Do]},$$scope:{ctx:n}}}),M.$on("click",n[12]),{c(){e=E("div"),t=E("input"),s=A(),r=E("div"),i=E("button"),o=_e("svg"),a=_e("path"),u=A(),d=E("hr"),g=A(),Q(m.$$.fragment),_=A(),Q(D.$$.fragment),v=A(),Q(M.$$.fragment),this.h()},l(S){e=N(S,"DIV",{class:!0});var w=k(e);t=N(w,"INPUT",{type:!0,id:!0,class:!0,placeholder:!0,autocomplete:!0}),s=H(w),r=N(w,"DIV",{class:!0});var C=k(r);i=N(C,"BUTTON",{class:!0});var V=k(i);o=pe(V,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var O=k(o);a=pe(O,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),k(a).forEach(h),O.forEach(h),V.forEach(h),C.forEach(h),w.forEach(h),u=H(S),d=N(S,"HR",{class:!0}),g=H(S),$(m.$$.fragment,S),_=H(S),$(D.$$.fragment,S),v=H(S),$(M.$$.fragment,S),this.h()},h(){c(t,"type","text"),c(t,"id","floating-message-input"),c(t,"class","bg-transparent outline-hidden w-full flex-1 text-sm"),c(t,"placeholder",l=n[4].t("Suggest a change")),c(t,"autocomplete","off"),c(a,"fill-rule","evenodd"),c(a,"d","M8 14a.75.75 0 0 1-.75-.75V4.56L4.03 7.78a.75.75 0 0 1-1.06-1.06l4.5-4.5a.75.75 0 0 1 1.06 0l4.5 4.5a.75.75 0 0 1-1.06 1.06L8.75 4.56v8.69A.75.75 0 0 1 8 14Z"),c(a,"clip-rule","evenodd"),c(o,"xmlns","http://www.w3.org/2000/svg"),c(o,"viewBox","0 0 16 16"),c(o,"fill","currentColor"),c(o,"class","size-3.5"),c(i,"class",f=(n[3]!==""?"bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 ":"text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled")+" transition rounded-full p-1 self-center"),c(r,"class","ml-2 self-center flex items-center"),c(e,"class","py-1.5 px-2.5 flex dark:text-gray-100"),c(d,"class","border-gray-50 dark:border-gray-800 my-1 mx-2")},m(S,w){I(S,e,w),p(e,t),ot(t,n[3]),p(e,s),p(e,r),p(r,i),p(i,o),p(o,a),I(S,u,w),I(S,d,w),I(S,g,w),X(m,S,w),I(S,_,w),X(D,S,w),I(S,v,w),X(M,S,w),T=!0,P||(L=[ce(t,"input",n[7]),ce(t,"keydown",n[8]),ce(i,"click",n[9])],P=!0)},p(S,w){(!T||w&16&&l!==(l=S[4].t("Suggest a change")))&&c(t,"placeholder",l),w&8&&t.value!==S[3]&&ot(t,S[3]),(!T||w&8&&f!==(f=(S[3]!==""?"bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 ":"text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled")+" transition rounded-full p-1 self-center"))&&c(i,"class",f);const C={};w&32784&&(C.$$scope={dirty:w,ctx:S}),m.$set(C);const V={};w&32784&&(V.$$scope={dirty:w,ctx:S}),D.$set(V);const O={};w&32784&&(O.$$scope={dirty:w,ctx:S}),M.$set(O)},i(S){T||(b(m.$$.fragment,S),b(D.$$.fragment,S),b(M.$$.fragment,S),T=!0)},o(S){y(m.$$.fragment,S),y(D.$$.fragment,S),y(M.$$.fragment,S),T=!1},d(S){S&&(h(e),h(u),h(d),h(g),h(_),h(v)),Y(m,S),Y(D,S),Y(M,S),P=!1,et(L)}}}function Co(n){let e,t,l;return t=new vi({props:{class:"w-full max-w-[190px] rounded-xl px-1 py-1 z-50 bg-white dark:bg-gray-850 dark:text-white shadow-lg",sideOffset:-2,side:"bottom",align:"start",transition:ki,$$slots:{default:[To]},$$scope:{ctx:n}}}),{c(){e=E("div"),Q(t.$$.fragment),this.h()},l(s){e=N(s,"DIV",{slot:!0});var r=k(e);$(t.$$.fragment,r),r.forEach(h),this.h()},h(){c(e,"slot","content")},m(s,r){I(s,e,r),X(t,e,null),l=!0},p(s,r){const i={};r&32797&&(i.$$scope={dirty:r,ctx:s}),t.$set(i)},i(s){l||(b(t.$$.fragment,s),l=!0)},o(s){y(t.$$.fragment,s),l=!1},d(s){s&&h(e),Y(t)}}}function Vo(n){let e,t,l;function s(i){n[13](i)}let r={align:"end",$$slots:{content:[Co],default:[Mo]},$$scope:{ctx:n}};return n[2]!==void 0&&(r.show=n[2]),e=new wi({props:r}),We.push(()=>Ze(e,"show",s)),e.$on("change",n[14]),{c(){Q(e.$$.fragment)},l(i){$(e.$$.fragment,i)},m(i,o){X(e,i,o),l=!0},p(i,[o]){const a={};o&32797&&(a.$$scope={dirty:o,ctx:i}),!t&&o&4&&(t=!0,a.show=i[2],Qe(()=>t=!1)),e.$set(a)},i(i){l||(b(e.$$.fragment,i),l=!0)},o(i){y(e.$$.fragment,i),l=!1},d(i){Y(e,i)}}}function So(n,e,t){let l,{$$slots:s={},$$scope:r}=e;const i=Ge("i18n");Te(n,i,P=>t(4,l=P));let{onRegenerate:o=(P=null)=>{}}=e,{onClose:a=()=>{}}=e,f=!1,u="";function d(){u=this.value,t(3,u)}const g=P=>{P.key==="Enter"&&(o(u),t(2,f=!1))},m=()=>{o(u),t(2,f=!1)},_=()=>{o(),t(2,f=!1)},D=()=>{o(l.t("Add Details"))},v=()=>{o(l.t("More Concise"))};function M(P){f=P,t(2,f)}const T=P=>{P.detail===!1&&a()};return n.$$set=P=>{"onRegenerate"in P&&t(0,o=P.onRegenerate),"onClose"in P&&t(1,a=P.onClose),"$$scope"in P&&t(15,r=P.$$scope)},[o,a,f,u,l,i,s,d,g,m,_,D,v,M,T,r]}class Bo extends He{constructor(e){super(),ze(this,e,So,Vo,Re,{onRegenerate:0,onClose:1})}}function Ms(n,e,t){const l=n.slice();return l[94]=e[t],l}function Es(n,e,t){const l=n.slice();return l[97]=e[t],l}function Ft(n){var l,s,r;const e=n.slice(),t=(((l=e[17])==null?void 0:l.statusHistory)??[...(s=e[17])!=null&&s.status?[(r=e[17])==null?void 0:r.status]:[]]).at(-1);return e[100]=t,e}function Oo(n){var s;let e,t=(((s=n[21])==null?void 0:s.name)??n[17].model)+"",l;return{c(){e=E("span"),l=q(t),this.h()},l(r){e=N(r,"SPAN",{class:!0});var i=k(e);l=F(i,t),i.forEach(h),this.h()},h(){c(e,"class","line-clamp-1 text-black dark:text-white")},m(r,i){I(r,e,i),p(e,l)},p(r,i){var o;i[0]&2228224&&t!==(t=(((o=r[21])==null?void 0:o.name)??r[17].model)+"")&&Z(l,t)},d(r){r&&h(e)}}}function Ns(n){let e,t,l;return t=new Pe({props:{content:ft(n[17].timestamp*1e3).format("LLLL"),$$slots:{default:[Ro]},$$scope:{ctx:n}}}),{c(){e=E("div"),Q(t.$$.fragment),this.h()},l(s){e=N(s,"DIV",{class:!0});var r=k(e);$(t.$$.fragment,r),r.forEach(h),this.h()},h(){c(e,"class","self-center text-xs invisible group-hover:visible text-gray-400 font-medium first-letter:capitalize ml-0.5 translate-y-[1px]")},m(s,r){I(s,e,r),X(t,e,null),l=!0},p(s,r){const i={};r[0]&131072&&(i.content=ft(s[17].timestamp*1e3).format("LLLL")),r[0]&131072|r[3]&256&&(i.$$scope={dirty:r,ctx:s}),t.$set(i)},i(s){l||(b(t.$$.fragment,s),l=!0)},o(s){y(t.$$.fragment,s),l=!1},d(s){s&&h(e),Y(t)}}}function Ro(n){let e,t=wt(n[17].timestamp*1e3)+"",l;return{c(){e=E("span"),l=q(t),this.h()},l(s){e=N(s,"SPAN",{class:!0});var r=k(e);l=F(r,t),r.forEach(h),this.h()},h(){c(e,"class","line-clamp-1")},m(s,r){I(s,e,r),p(e,l)},p(s,r){r[0]&131072&&t!==(t=wt(s[17].timestamp*1e3)+"")&&Z(l,t)},d(s){s&&h(e)}}}function Po(n){var i;let e,t,l,s;e=new Pe({props:{content:((i=n[21])==null?void 0:i.name)??n[17].model,placement:"top-start",$$slots:{default:[Oo]},$$scope:{ctx:n}}});let r=n[17].timestamp&&Ns(n);return{c(){Q(e.$$.fragment),t=A(),r&&r.c(),l=ae()},l(o){$(e.$$.fragment,o),t=H(o),r&&r.l(o),l=ae()},m(o,a){X(e,o,a),I(o,t,a),r&&r.m(o,a),I(o,l,a),s=!0},p(o,a){var u;const f={};a[0]&2228224&&(f.content=((u=o[21])==null?void 0:u.name)??o[17].model),a[0]&2228224|a[3]&256&&(f.$$scope={dirty:a,ctx:o}),e.$set(f),o[17].timestamp?r?(r.p(o,a),a[0]&131072&&b(r,1)):(r=Ns(o),r.c(),b(r,1),r.m(l.parentNode,l)):r&&(x(),y(r,1,1,()=>{r=null}),ee())},i(o){s||(b(e.$$.fragment,o),b(r),s=!0)},o(o){y(e.$$.fragment,o),y(r),s=!1},d(o){o&&(h(t),h(l)),Y(e,o),r&&r.d(o)}}}function Ds(n){var s;let e,t,l=!((s=n[100])!=null&&s.hidden)&&Ts(n);return{c(){l&&l.c(),e=ae()},l(r){l&&l.l(r),e=ae()},m(r,i){l&&l.m(r,i),I(r,e,i),t=!0},p(r,i){var o;(o=r[100])!=null&&o.hidden?l&&(x(),y(l,1,1,()=>{l=null}),ee()):l?(l.p(r,i),i[0]&131072&&b(l,1)):(l=Ts(r),l.c(),b(l,1),l.m(e.parentNode,e))},i(r){t||(b(l),t=!0)},o(r){y(l),t=!1},d(r){r&&h(e),l&&l.d(r)}}}function Ts(n){let e,t,l,s;const r=[Ao,jo,Lo],i=[];function o(a,f){var u,d,g;return((u=a[100])==null?void 0:u.action)==="web_search"&&((d=a[100])!=null&&d.urls)?0:((g=a[100])==null?void 0:g.action)==="knowledge_search"?1:2}return t=o(n),l=i[t]=r[t](n),{c(){e=E("div"),l.c(),this.h()},l(a){e=N(a,"DIV",{class:!0});var f=k(e);l.l(f),f.forEach(h),this.h()},h(){c(e,"class","status-description flex items-center gap-2 py-0.5")},m(a,f){I(a,e,f),i[t].m(e,null),s=!0},p(a,f){let u=t;t=o(a),t===u?i[t].p(a,f):(x(),y(i[u],1,1,()=>{i[u]=null}),ee(),l=i[t],l?l.p(a,f):(l=i[t]=r[t](a),l.c()),b(l,1),l.m(e,null))},i(a){s||(b(l),s=!0)},o(a){y(l),s=!1},d(a){a&&h(e),i[t].d()}}}function Lo(n){let e,t,l,s;function r(a,f){var u,d,g,m;return f[0]&131072&&(l=null),l==null&&(l=!!((u=a[100])!=null&&u.description.includes("{{searchQuery}}"))),l?qo:((d=a[100])==null?void 0:d.description)==="No search query generated"?Wo:((g=a[100])==null?void 0:g.description)==="Generating search query"?Uo:((m=a[100])==null?void 0:m.description)==="Searching the web"?zo:Ho}let i=r(n,[-1,-1,-1,-1]),o=i(n);return{c(){e=E("div"),t=E("div"),o.c(),this.h()},l(a){e=N(a,"DIV",{class:!0});var f=k(e);t=N(f,"DIV",{class:!0});var u=k(t);o.l(u),u.forEach(h),f.forEach(h),this.h()},h(){var a;c(t,"class",s=(((a=n[100])==null?void 0:a.done)===!1?"shimmer":"")+" text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap"),c(e,"class","flex flex-col justify-center -space-y-0.5")},m(a,f){I(a,e,f),p(e,t),o.m(t,null)},p(a,f){var u;i===(i=r(a,f))&&o?o.p(a,f):(o.d(1),o=i(a),o&&(o.c(),o.m(t,null))),f[0]&131072&&s!==(s=(((u=a[100])==null?void 0:u.done)===!1?"shimmer":"")+" text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap")&&c(t,"class",s)},i:Ne,o:Ne,d(a){a&&h(e),o.d()}}}function jo(n){let e,t,l=n[32].t('Searching Knowledge for "{{searchQuery}}"',{searchQuery:n[100].query})+"",s,r;return{c(){e=E("div"),t=E("div"),s=q(l),this.h()},l(i){e=N(i,"DIV",{class:!0});var o=k(e);t=N(o,"DIV",{class:!0});var a=k(t);s=F(a,l),a.forEach(h),o.forEach(h),this.h()},h(){var i;c(t,"class",r=(((i=n[100])==null?void 0:i.done)===!1?"shimmer":"")+" text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap"),c(e,"class","flex flex-col justify-center -space-y-0.5")},m(i,o){I(i,e,o),p(e,t),p(t,s)},p(i,o){var a;o[0]&131072|o[1]&2&&l!==(l=i[32].t('Searching Knowledge for "{{searchQuery}}"',{searchQuery:i[100].query})+"")&&Z(s,l),o[0]&131072&&r!==(r=(((a=i[100])==null?void 0:a.done)===!1?"shimmer":"")+" text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap")&&c(t,"class",r)},i:Ne,o:Ne,d(i){i&&h(e)}}}function Ao(n){let e,t;return e=new Qi({props:{status:n[100],$$slots:{default:[Zo]},$$scope:{ctx:n}}}),{c(){Q(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},p(l,s){const r={};s[0]&131072&&(r.status=l[100]),s[0]&131072|s[1]&2|s[3]&256&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){y(e.$$.fragment,l),t=!1},d(l){Y(e,l)}}}function Ho(n){var l;let e=((l=n[100])==null?void 0:l.description)+"",t;return{c(){t=q(e)},l(s){t=F(s,e)},m(s,r){I(s,t,r)},p(s,r){var i;r[0]&131072&&e!==(e=((i=s[100])==null?void 0:i.description)+"")&&Z(t,e)},d(s){s&&h(t)}}}function zo(n){let e=n[32].t("Searching the web...")+"",t;return{c(){t=q(e)},l(l){t=F(l,e)},m(l,s){I(l,t,s)},p(l,s){s[1]&2&&e!==(e=l[32].t("Searching the web...")+"")&&Z(t,e)},d(l){l&&h(t)}}}function Uo(n){let e=n[32].t("Generating search query")+"",t;return{c(){t=q(e)},l(l){t=F(l,e)},m(l,s){I(l,t,s)},p(l,s){s[1]&2&&e!==(e=l[32].t("Generating search query")+"")&&Z(t,e)},d(l){l&&h(t)}}}function Wo(n){let e=n[32].t("No search query generated")+"",t;return{c(){t=q(e)},l(l){t=F(l,e)},m(l,s){I(l,t,s)},p(l,s){s[1]&2&&e!==(e=l[32].t("No search query generated")+"")&&Z(t,e)},d(l){l&&h(t)}}}function qo(n){var l,s;let e=n[32].t((l=n[100])==null?void 0:l.description,{searchQuery:(s=n[100])==null?void 0:s.query})+"",t;return{c(){t=q(e)},l(r){t=F(r,e)},m(r,i){I(r,t,i)},p(r,i){var o,a;i[0]&131072|i[1]&2&&e!==(e=r[32].t((o=r[100])==null?void 0:o.description,{searchQuery:(a=r[100])==null?void 0:a.query})+"")&&Z(t,e)},d(r){r&&h(t)}}}function Fo(n){var l;let e=((l=n[100])==null?void 0:l.description)+"",t;return{c(){t=q(e)},l(s){t=F(s,e)},m(s,r){I(s,t,r)},p(s,r){var i;r[0]&131072&&e!==(e=((i=s[100])==null?void 0:i.description)+"")&&Z(t,e)},d(s){s&&h(t)}}}function Go(n){let e=n[32].t("Generating search query")+"",t;return{c(){t=q(e)},l(l){t=F(l,e)},m(l,s){I(l,t,s)},p(l,s){s[1]&2&&e!==(e=l[32].t("Generating search query")+"")&&Z(t,e)},d(l){l&&h(t)}}}function Jo(n){let e=n[32].t("No search query generated")+"",t;return{c(){t=q(e)},l(l){t=F(l,e)},m(l,s){I(l,t,s)},p(l,s){s[1]&2&&e!==(e=l[32].t("No search query generated")+"")&&Z(t,e)},d(l){l&&h(t)}}}function Ko(n){var l,s;let e=n[32].t((l=n[100])==null?void 0:l.description,{count:(s=n[100])==null?void 0:s.urls.length})+"",t;return{c(){t=q(e)},l(r){t=F(r,e)},m(r,i){I(r,t,i)},p(r,i){var o,a;i[0]&131072|i[1]&2&&e!==(e=r[32].t((o=r[100])==null?void 0:o.description,{count:(a=r[100])==null?void 0:a.urls.length})+"")&&Z(t,e)},d(r){r&&h(t)}}}function Zo(n){let e,t,l,s;function r(a,f){var u,d,g;return f[0]&131072&&(l=null),l==null&&(l=!!((u=a[100])!=null&&u.description.includes("{{count}}"))),l?Ko:((d=a[100])==null?void 0:d.description)==="No search query generated"?Jo:((g=a[100])==null?void 0:g.description)==="Generating search query"?Go:Fo}let i=r(n,[-1,-1,-1,-1]),o=i(n);return{c(){e=E("div"),t=E("div"),o.c(),this.h()},l(a){e=N(a,"DIV",{class:!0});var f=k(e);t=N(f,"DIV",{class:!0});var u=k(t);o.l(u),u.forEach(h),f.forEach(h),this.h()},h(){var a;c(t,"class",s=(((a=n[100])==null?void 0:a.done)===!1?"shimmer":"")+" text-base line-clamp-1 text-wrap"),c(e,"class","flex flex-col justify-center -space-y-0.5")},m(a,f){I(a,e,f),p(e,t),o.m(t,null)},p(a,f){var u;i===(i=r(a,f))&&o?o.p(a,f):(o.d(1),o=i(a),o&&(o.c(),o.m(t,null))),f[0]&131072&&s!==(s=(((u=a[100])==null?void 0:u.done)===!1?"shimmer":"")+" text-base line-clamp-1 text-wrap")&&c(t,"class",s)},d(a){a&&h(e),o.d()}}}function Cs(n){let e,t,l=Ce(n[17].files),s=[];for(let i=0;i<l.length;i+=1)s[i]=Vs(Es(n,l,i));const r=i=>y(s[i],1,1,()=>{s[i]=null});return{c(){e=E("div");for(let i=0;i<s.length;i+=1)s[i].c();this.h()},l(i){e=N(i,"DIV",{class:!0});var o=k(e);for(let a=0;a<s.length;a+=1)s[a].l(o);o.forEach(h),this.h()},h(){c(e,"class","my-1 w-full flex overflow-x-auto gap-2 flex-wrap")},m(i,o){I(i,e,o);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null);t=!0},p(i,o){if(o[0]&131072){l=Ce(i[17].files);let a;for(a=0;a<l.length;a+=1){const f=Es(i,l,a);s[a]?(s[a].p(f,o),b(s[a],1)):(s[a]=Vs(f),s[a].c(),b(s[a],1),s[a].m(e,null))}for(x(),a=l.length;a<s.length;a+=1)r(a);ee()}},i(i){if(!t){for(let o=0;o<l.length;o+=1)b(s[o]);t=!0}},o(i){s=s.filter(Boolean);for(let o=0;o<s.length;o+=1)y(s[o]);t=!1},d(i){i&&h(e),Fe(s,i)}}}function Qo(n){var l;let e,t;return e=new sl({props:{item:n[97],url:n[97].url,name:n[97].name,type:n[97].type,size:(l=n[97])==null?void 0:l.size,colorClassName:"bg-white dark:bg-gray-850 "}}),{c(){Q(e.$$.fragment)},l(s){$(e.$$.fragment,s)},m(s,r){X(e,s,r),t=!0},p(s,r){var o;const i={};r[0]&131072&&(i.item=s[97]),r[0]&131072&&(i.url=s[97].url),r[0]&131072&&(i.name=s[97].name),r[0]&131072&&(i.type=s[97].type),r[0]&131072&&(i.size=(o=s[97])==null?void 0:o.size),e.$set(i)},i(s){t||(b(e.$$.fragment,s),t=!0)},o(s){y(e.$$.fragment,s),t=!1},d(s){Y(e,s)}}}function Xo(n){let e,t;return e=new el({props:{src:n[97].url,alt:n[17].content}}),{c(){Q(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},p(l,s){const r={};s[0]&131072&&(r.src=l[97].url),s[0]&131072&&(r.alt=l[17].content),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){y(e.$$.fragment,l),t=!1},d(l){Y(e,l)}}}function Vs(n){let e,t,l,s,r;const i=[Xo,Qo],o=[];function a(f,u){return f[97].type==="image"?0:1}return t=a(n),l=o[t]=i[t](n),{c(){e=E("div"),l.c(),s=A()},l(f){e=N(f,"DIV",{});var u=k(e);l.l(u),s=H(u),u.forEach(h)},m(f,u){I(f,e,u),o[t].m(e,null),p(e,s),r=!0},p(f,u){let d=t;t=a(f),t===d?o[t].p(f,u):(x(),y(o[d],1,1,()=>{o[d]=null}),ee(),l=o[t],l?l.p(f,u):(l=o[t]=i[t](f),l.c()),b(l,1),l.m(e,s))},i(f){r||(b(l),r=!0)},o(f){y(l),r=!1},d(f){f&&h(e),o[t].d()}}}function Yo(n){var _,D,v,M,T,P,L;let e,t,l,s,r,i,o;const a=[ef,xo],f=[];function u(S,w){var C,V,O;return S[17].content===""&&!S[17].error&&(((C=S[17])==null?void 0:C.statusHistory)??[...(V=S[17])!=null&&V.status?[(O=S[17])==null?void 0:O.status]:[]]).length===0?0:S[17].content&&S[17].error!==!0?1:-1}~(t=u(n))&&(l=f[t]=a[t](n));let d=((_=n[17])==null?void 0:_.error)&&Ss(n),g=(((D=n[17])==null?void 0:D.sources)||((v=n[17])==null?void 0:v.citations))&&(((L=(P=(T=(M=n[21])==null?void 0:M.info)==null?void 0:T.meta)==null?void 0:P.capabilities)==null?void 0:L.citations)??!0)&&Bs(n),m=n[17].code_executions&&Os(n);return{c(){e=E("div"),l&&l.c(),s=A(),d&&d.c(),r=A(),g&&g.c(),i=A(),m&&m.c(),this.h()},l(S){e=N(S,"DIV",{class:!0,id:!0});var w=k(e);l&&l.l(w),s=H(w),d&&d.l(w),r=H(w),g&&g.l(w),i=H(w),m&&m.l(w),w.forEach(h),this.h()},h(){c(e,"class","w-full flex flex-col relative"),c(e,"id","response-content-container")},m(S,w){I(S,e,w),~t&&f[t].m(e,null),p(e,s),d&&d.m(e,null),p(e,r),g&&g.m(e,null),p(e,i),m&&m.m(e,null),o=!0},p(S,w){var V,O,B,G,U,j,ue;let C=t;t=u(S),t===C?~t&&f[t].p(S,w):(l&&(x(),y(f[C],1,1,()=>{f[C]=null}),ee()),~t?(l=f[t],l?l.p(S,w):(l=f[t]=a[t](S),l.c()),b(l,1),l.m(e,s)):l=null),(V=S[17])!=null&&V.error?d?(d.p(S,w),w[0]&131072&&b(d,1)):(d=Ss(S),d.c(),b(d,1),d.m(e,r)):d&&(x(),y(d,1,1,()=>{d=null}),ee()),((O=S[17])!=null&&O.sources||(B=S[17])!=null&&B.citations)&&(((ue=(j=(U=(G=S[21])==null?void 0:G.info)==null?void 0:U.meta)==null?void 0:j.capabilities)==null?void 0:ue.citations)??!0)?g?(g.p(S,w),w[0]&2228224&&b(g,1)):(g=Bs(S),g.c(),b(g,1),g.m(e,i)):g&&(x(),y(g,1,1,()=>{g=null}),ee()),S[17].code_executions?m?(m.p(S,w),w[0]&131072&&b(m,1)):(m=Os(S),m.c(),b(m,1),m.m(e,null)):m&&(x(),y(m,1,1,()=>{m=null}),ee())},i(S){o||(b(l),b(d),b(g),b(m),o=!0)},o(S){y(l),y(d),y(g),y(m),o=!1},d(S){S&&h(e),~t&&f[t].d(),d&&d.d(),g&&g.d(),m&&m.d()}}}function $o(n){let e,t,l,s,r,i,o,a=n[32].t("Save As Copy")+"",f,u,d,g,m=n[32].t("Cancel")+"",_,D,v,M=n[32].t("Save")+"",T,P,L;return{c(){e=E("div"),t=E("textarea"),s=A(),r=E("div"),i=E("div"),o=E("button"),f=q(a),u=A(),d=E("div"),g=E("button"),_=q(m),D=A(),v=E("button"),T=q(M),this.h()},l(S){e=N(S,"DIV",{class:!0});var w=k(e);t=N(w,"TEXTAREA",{id:!0,class:!0}),k(t).forEach(h),s=H(w),r=N(w,"DIV",{class:!0});var C=k(r);i=N(C,"DIV",{});var V=k(i);o=N(V,"BUTTON",{id:!0,class:!0});var O=k(o);f=F(O,a),O.forEach(h),V.forEach(h),u=H(C),d=N(C,"DIV",{class:!0});var B=k(d);g=N(B,"BUTTON",{id:!0,class:!0});var G=k(g);_=F(G,m),G.forEach(h),D=H(B),v=N(B,"BUTTON",{id:!0,class:!0});var U=k(v);T=F(U,M),U.forEach(h),B.forEach(h),C.forEach(h),w.forEach(h),this.h()},h(){c(t,"id",l="message-edit-"+n[17].id),c(t,"class","bg-transparent outline-hidden w-full resize-none"),c(o,"id","save-new-message-button"),c(o,"class","px-4 py-2 bg-gray-50 hover:bg-gray-100 dark:bg-gray-800 dark:hover:bg-gray-700 border border-gray-100 dark:border-gray-700 text-gray-700 dark:text-gray-200 transition rounded-3xl"),c(g,"id","close-edit-message-button"),c(g,"class","px-4 py-2 bg-white dark:bg-gray-900 hover:bg-gray-100 text-gray-800 dark:text-gray-100 transition rounded-3xl"),c(v,"id","confirm-edit-message-button"),c(v,"class","px-4 py-2 bg-gray-900 dark:bg-white hover:bg-gray-850 text-gray-100 dark:text-gray-800 transition rounded-3xl"),c(d,"class","flex space-x-1.5"),c(r,"class","mt-2 mb-1 flex justify-between text-sm font-medium"),c(e,"class","w-full bg-gray-50 dark:bg-gray-800 rounded-3xl px-5 py-3 my-2")},m(S,w){I(S,e,w),p(e,t),n[54](t),ot(t,n[22]),p(e,s),p(e,r),p(r,i),p(i,o),p(o,f),p(r,u),p(r,d),p(d,g),p(g,_),p(d,D),p(d,v),p(v,T),P||(L=[ce(t,"input",n[55]),ce(t,"input",Df),ce(t,"keydown",n[56]),ce(o,"click",n[57]),ce(g,"click",n[58]),ce(v,"click",n[59])],P=!0)},p(S,w){w[0]&131072&&l!==(l="message-edit-"+S[17].id)&&c(t,"id",l),w[0]&4194304&&ot(t,S[22]),w[1]&2&&a!==(a=S[32].t("Save As Copy")+"")&&Z(f,a),w[1]&2&&m!==(m=S[32].t("Cancel")+"")&&Z(_,m),w[1]&2&&M!==(M=S[32].t("Save")+"")&&Z(T,M)},i:Ne,o:Ne,d(S){S&&h(e),n[54](null),P=!1,et(L)}}}function xo(n){var l,s,r,i;let e,t;return e=new ao({props:{id:`${n[1]}-${n[17].id}`,messageId:n[17].id,history:n[0],selectedModels:n[2],content:n[17].content,sources:n[17].sources,floatingButtons:((l=n[17])==null?void 0:l.done)&&!n[15]&&(((s=n[30])==null?void 0:s.showFloatingActionButtons)??!0),save:!n[15],preview:!n[15],topPadding:n[16],done:((r=n[30])==null?void 0:r.chatFadeStreamingText)??!0?((i=n[17])==null?void 0:i.done)??!1:!0,model:n[21],onTaskClick:n[60],onSourceClick:n[61],onAddMessages:n[62],onSave:n[63]}}),{c(){Q(e.$$.fragment)},l(o){$(e.$$.fragment,o)},m(o,a){X(e,o,a),t=!0},p(o,a){var u,d,g,m;const f={};a[0]&131074&&(f.id=`${o[1]}-${o[17].id}`),a[0]&131072&&(f.messageId=o[17].id),a[0]&1&&(f.history=o[0]),a[0]&4&&(f.selectedModels=o[2]),a[0]&131072&&(f.content=o[17].content),a[0]&131072&&(f.sources=o[17].sources),a[0]&1073905664&&(f.floatingButtons=((u=o[17])==null?void 0:u.done)&&!o[15]&&(((d=o[30])==null?void 0:d.showFloatingActionButtons)??!0)),a[0]&32768&&(f.save=!o[15]),a[0]&32768&&(f.preview=!o[15]),a[0]&65536&&(f.topPadding=o[16]),a[0]&1073872896&&(f.done=((g=o[30])==null?void 0:g.chatFadeStreamingText)??!0?((m=o[17])==null?void 0:m.done)??!1:!0),a[0]&2097152&&(f.model=o[21]),a[0]&131072&&(f.onSourceClick=o[61]),a[0]&8192&&(f.onAddMessages=o[62]),a[0]&131329&&(f.onSave=o[63]),e.$set(f)},i(o){t||(b(e.$$.fragment,o),t=!0)},o(o){y(e.$$.fragment,o),t=!1},d(o){Y(e,o)}}}function ef(n){let e,t;return e=new xt({}),{c(){Q(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},p:Ne,i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){y(e.$$.fragment,l),t=!1},d(l){Y(e,l)}}}function Ss(n){var l,s;let e,t;return e=new ra({props:{content:((s=(l=n[17])==null?void 0:l.error)==null?void 0:s.content)??n[17].content}}),{c(){Q(e.$$.fragment)},l(r){$(e.$$.fragment,r)},m(r,i){X(e,r,i),t=!0},p(r,i){var a,f;const o={};i[0]&131072&&(o.content=((f=(a=r[17])==null?void 0:a.error)==null?void 0:f.content)??r[17].content),e.$set(o)},i(r){t||(b(e.$$.fragment,r),t=!0)},o(r){y(e.$$.fragment,r),t=!1},d(r){Y(e,r)}}}function Bs(n){var l,s,r;let e,t;return e=new Ba({props:{id:(l=n[17])==null?void 0:l.id,sources:((s=n[17])==null?void 0:s.sources)??((r=n[17])==null?void 0:r.citations)}}),{c(){Q(e.$$.fragment)},l(i){$(e.$$.fragment,i)},m(i,o){X(e,i,o),t=!0},p(i,o){var f,u,d;const a={};o[0]&131072&&(a.id=(f=i[17])==null?void 0:f.id),o[0]&131072&&(a.sources=((u=i[17])==null?void 0:u.sources)??((d=i[17])==null?void 0:d.citations)),e.$set(a)},i(i){t||(b(e.$$.fragment,i),t=!0)},o(i){y(e.$$.fragment,i),t=!1},d(i){Y(e,i)}}}function Os(n){let e,t;return e=new Qa({props:{codeExecutions:n[17].code_executions}}),{c(){Q(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},p(l,s){const r={};s[0]&131072&&(r.codeExecutions=l[17].code_executions),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){y(e.$$.fragment,l),t=!1},d(l){Y(e,l)}}}function Rs(n){var f,u;let e,t,l,s,r,i=(n[17].done||n[3].length>1)&&Ps(n),o=n[17].done&&n[28]&&Qs(n),a=(n[14]||(((f=n[30])==null?void 0:f.keepFollowUpPrompts)??!1))&&n[17].done&&!n[15]&&(((u=n[17])==null?void 0:u.followUps)??[]).length>0&&Xs(n);return{c(){e=E("div"),i&&i.c(),t=A(),o&&o.c(),l=A(),a&&a.c(),s=ae(),this.h()},l(d){e=N(d,"DIV",{class:!0});var g=k(e);i&&i.l(g),g.forEach(h),t=H(d),o&&o.l(d),l=H(d),a&&a.l(d),s=ae(),this.h()},h(){c(e,"class","flex justify-start overflow-x-auto buttons text-gray-600 dark:text-gray-500 mt-0.5 svelte-1u5gq5j")},m(d,g){I(d,e,g),i&&i.m(e,null),n[82](e),I(d,t,g),o&&o.m(d,g),I(d,l,g),a&&a.m(d,g),I(d,s,g),r=!0},p(d,g){var m,_;d[17].done||d[3].length>1?i?(i.p(d,g),g[0]&131080&&b(i,1)):(i=Ps(d),i.c(),b(i,1),i.m(e,null)):i&&(x(),y(i,1,1,()=>{i=null}),ee()),d[17].done&&d[28]?o?(o.p(d,g),g[0]&268566528&&b(o,1)):(o=Qs(d),o.c(),b(o,1),o.m(l.parentNode,l)):o&&(x(),y(o,1,1,()=>{o=null}),ee()),(d[14]||(((m=d[30])==null?void 0:m.keepFollowUpPrompts)??!1))&&d[17].done&&!d[15]&&(((_=d[17])==null?void 0:_.followUps)??[]).length>0?a?(a.p(d,g),g[0]&1073922048&&b(a,1)):(a=Xs(d),a.c(),b(a,1),a.m(s.parentNode,s)):a&&(x(),y(a,1,1,()=>{a=null}),ee())},i(d){r||(b(i),b(o),b(a),r=!0)},o(d){y(i),y(o),y(a),r=!1},d(d){d&&(h(e),h(t),h(l),h(s)),i&&i.d(),n[82](null),o&&o.d(d),a&&a.d(d)}}}function Ps(n){let e,t,l,s=n[3].length>1&&Ls(n),r=n[17].done&&js(n);return{c(){s&&s.c(),e=A(),r&&r.c(),t=ae()},l(i){s&&s.l(i),e=H(i),r&&r.l(i),t=ae()},m(i,o){s&&s.m(i,o),I(i,e,o),r&&r.m(i,o),I(i,t,o),l=!0},p(i,o){i[3].length>1?s?s.p(i,o):(s=Ls(i),s.c(),s.m(e.parentNode,e)):s&&(s.d(1),s=null),i[17].done?r?(r.p(i,o),o[0]&131072&&b(r,1)):(r=js(i),r.c(),b(r,1),r.m(t.parentNode,t)):r&&(x(),y(r,1,1,()=>{r=null}),ee())},i(i){l||(b(r),l=!0)},o(i){y(r),l=!1},d(i){i&&(h(e),h(t)),s&&s.d(i),r&&r.d(i)}}}function Ls(n){let e,t,l,s,r,i,o,a,f,u,d,g,m;function _(M,T){return M[24]?lf:tf}let D=_(n),v=D(n);return{c(){e=E("div"),t=E("button"),l=_e("svg"),s=_e("path"),i=A(),v.c(),o=A(),a=E("button"),f=_e("svg"),u=_e("path"),this.h()},l(M){e=N(M,"DIV",{class:!0,dir:!0});var T=k(e);t=N(T,"BUTTON",{"aria-label":!0,class:!0});var P=k(t);l=pe(P,"svg",{"aria-hidden":!0,xmlns:!0,fill:!0,viewBox:!0,stroke:!0,"stroke-width":!0,class:!0});var L=k(l);s=pe(L,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(s).forEach(h),L.forEach(h),P.forEach(h),i=H(T),v.l(T),o=H(T),a=N(T,"BUTTON",{class:!0,"aria-label":!0});var S=k(a);f=pe(S,"svg",{xmlns:!0,fill:!0,"aria-hidden":!0,viewBox:!0,stroke:!0,"stroke-width":!0,class:!0});var w=k(f);u=pe(w,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(u).forEach(h),w.forEach(h),S.forEach(h),T.forEach(h),this.h()},h(){c(s,"stroke-linecap","round"),c(s,"stroke-linejoin","round"),c(s,"d","M15.75 19.5 8.25 12l7.5-7.5"),c(l,"aria-hidden","true"),c(l,"xmlns","http://www.w3.org/2000/svg"),c(l,"fill","none"),c(l,"viewBox","0 0 24 24"),c(l,"stroke","currentColor"),c(l,"stroke-width","2.5"),c(l,"class","size-3.5"),c(t,"aria-label",r=n[32].t("Previous message")),c(t,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),c(u,"stroke-linecap","round"),c(u,"stroke-linejoin","round"),c(u,"d","m8.25 4.5 7.5 7.5-7.5 7.5"),c(f,"xmlns","http://www.w3.org/2000/svg"),c(f,"fill","none"),c(f,"aria-hidden","true"),c(f,"viewBox","0 0 24 24"),c(f,"stroke","currentColor"),c(f,"stroke-width","2.5"),c(f,"class","size-3.5"),c(a,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),c(a,"aria-label",d=n[32].t("Next message")),c(e,"class","flex self-center min-w-fit"),c(e,"dir","ltr")},m(M,T){I(M,e,T),p(e,t),p(t,l),p(l,s),p(e,i),v.m(e,null),p(e,o),p(e,a),p(a,f),p(f,u),g||(m=[ce(t,"click",n[64]),ce(a,"click",n[68])],g=!0)},p(M,T){T[1]&2&&r!==(r=M[32].t("Previous message"))&&c(t,"aria-label",r),D===(D=_(M))&&v?v.p(M,T):(v.d(1),v=D(M),v&&(v.c(),v.m(e,o))),T[1]&2&&d!==(d=M[32].t("Next message"))&&c(a,"aria-label",d)},d(M){M&&h(e),v.d(),g=!1,et(m)}}}function tf(n){let e,t=n[3].indexOf(n[17].id)+1+"",l,s,r=n[3].length+"",i,o,a;return{c(){e=E("div"),l=q(t),s=q("/"),i=q(r),this.h()},l(f){e=N(f,"DIV",{class:!0});var u=k(e);l=F(u,t),s=F(u,"/"),i=F(u,r),u.forEach(h),this.h()},h(){c(e,"class","text-sm tracking-widest font-semibold self-center dark:text-gray-100 min-w-fit")},m(f,u){I(f,e,u),p(e,l),p(e,s),p(e,i),o||(a=ce(e,"dblclick",n[67]),o=!0)},p(f,u){u[0]&131080&&t!==(t=f[3].indexOf(f[17].id)+1+"")&&Z(l,t),u[0]&8&&r!==(r=f[3].length+"")&&Z(i,r)},d(f){f&&h(e),o=!1,a()}}}function lf(n){let e,t,l,s,r,i,o=n[3].length+"",a,f,u;return{c(){e=E("div"),t=E("input"),i=q("/"),a=q(o),this.h()},l(d){e=N(d,"DIV",{class:!0});var g=k(e);t=N(g,"INPUT",{id:!0,type:!0,min:!0,max:!0,class:!0}),i=F(g,"/"),a=F(g,o),g.forEach(h),this.h()},h(){c(t,"id",l="message-index-input-"+n[17].id),c(t,"type","number"),t.value=s=n[3].indexOf(n[17].id)+1,c(t,"min","1"),c(t,"max",r=n[3].length),c(t,"class","bg-transparent font-semibold self-center dark:text-gray-100 min-w-fit outline-hidden"),c(e,"class","text-sm flex justify-center font-semibold self-center dark:text-gray-100 min-w-fit")},m(d,g){I(d,e,g),p(e,t),p(e,i),p(e,a),f||(u=[ce(t,"focus",Tf),ce(t,"blur",n[65]),ce(t,"keydown",n[66])],f=!0)},p(d,g){g[0]&131072&&l!==(l="message-index-input-"+d[17].id)&&c(t,"id",l),g[0]&131080&&s!==(s=d[3].indexOf(d[17].id)+1)&&t.value!==s&&(t.value=s),g[0]&8&&r!==(r=d[3].length)&&c(t,"max",r),g[0]&8&&o!==(o=d[3].length+"")&&Z(a,o)},d(d){d&&h(e),f=!1,et(u)}}}function js(n){var _,D,v,M,T,P,L,S,w;let e,t,l,s,r,i,o,a,f=!n[15]&&As(n);t=new Pe({props:{content:n[32].t("Copy"),placement:"bottom",$$slots:{default:[nf]},$$scope:{ctx:n}}});let u=(((_=n[33])==null?void 0:_.role)==="admin"||(((M=(v=(D=n[33])==null?void 0:D.permissions)==null?void 0:v.chat)==null?void 0:M.tts)??!0))&&zs(n),d=((T=n[31])==null?void 0:T.features.enable_image_generation)&&(((P=n[33])==null?void 0:P.role)==="admin"||((w=(S=(L=n[33])==null?void 0:L.permissions)==null?void 0:S.features)==null?void 0:w.image_generation))&&!n[15]&&Us(n),g=n[17].usage&&Ws(n),m=!n[15]&&qs(n);return{c(){f&&f.c(),e=A(),Q(t.$$.fragment),l=A(),u&&u.c(),s=A(),d&&d.c(),r=A(),g&&g.c(),i=A(),m&&m.c(),o=ae()},l(C){f&&f.l(C),e=H(C),$(t.$$.fragment,C),l=H(C),u&&u.l(C),s=H(C),d&&d.l(C),r=H(C),g&&g.l(C),i=H(C),m&&m.l(C),o=ae()},m(C,V){f&&f.m(C,V),I(C,e,V),X(t,C,V),I(C,l,V),u&&u.m(C,V),I(C,s,V),d&&d.m(C,V),I(C,r,V),g&&g.m(C,V),I(C,i,V),m&&m.m(C,V),I(C,o,V),a=!0},p(C,V){var B,G,U,j,ue,le,he,J,oe;C[15]?f&&(x(),y(f,1,1,()=>{f=null}),ee()):f?(f.p(C,V),V[0]&32768&&b(f,1)):(f=As(C),f.c(),b(f,1),f.m(e.parentNode,e));const O={};V[1]&2&&(O.content=C[32].t("Copy")),V[0]&147456|V[1]&2|V[3]&256&&(O.$$scope={dirty:V,ctx:C}),t.$set(O),((B=C[33])==null?void 0:B.role)==="admin"||(((j=(U=(G=C[33])==null?void 0:G.permissions)==null?void 0:U.chat)==null?void 0:j.tts)??!0)?u?(u.p(C,V),V[1]&4&&b(u,1)):(u=zs(C),u.c(),b(u,1),u.m(s.parentNode,s)):u&&(x(),y(u,1,1,()=>{u=null}),ee()),(ue=C[31])!=null&&ue.features.enable_image_generation&&(((le=C[33])==null?void 0:le.role)==="admin"||(oe=(J=(he=C[33])==null?void 0:he.permissions)==null?void 0:J.features)!=null&&oe.image_generation)&&!C[15]?d?(d.p(C,V),V[0]&32768|V[1]&5&&b(d,1)):(d=Us(C),d.c(),b(d,1),d.m(r.parentNode,r)):d&&(x(),y(d,1,1,()=>{d=null}),ee()),C[17].usage?g?(g.p(C,V),V[0]&131072&&b(g,1)):(g=Ws(C),g.c(),b(g,1),g.m(i.parentNode,i)):g&&(x(),y(g,1,1,()=>{g=null}),ee()),C[15]?m&&(x(),y(m,1,1,()=>{m=null}),ee()):m?(m.p(C,V),V[0]&32768&&b(m,1)):(m=qs(C),m.c(),b(m,1),m.m(o.parentNode,o))},i(C){a||(b(f),b(t.$$.fragment,C),b(u),b(d),b(g),b(m),a=!0)},o(C){y(f),y(t.$$.fragment,C),y(u),y(d),y(g),y(m),a=!1},d(C){C&&(h(e),h(l),h(s),h(r),h(i),h(o)),f&&f.d(C),Y(t,C),u&&u.d(C),d&&d.d(C),g&&g.d(C),m&&m.d(C)}}}function As(n){var s,r,i,o;let e,t,l=(((s=n[33])==null?void 0:s.role)==="user"?((o=(i=(r=n[33])==null?void 0:r.permissions)==null?void 0:i.chat)==null?void 0:o.edit)??!0:!0)&&Hs(n);return{c(){l&&l.c(),e=ae()},l(a){l&&l.l(a),e=ae()},m(a,f){l&&l.m(a,f),I(a,e,f),t=!0},p(a,f){var u,d,g,m;((u=a[33])==null?void 0:u.role)!=="user"||(((m=(g=(d=a[33])==null?void 0:d.permissions)==null?void 0:g.chat)==null?void 0:m.edit)??!0)?l?(l.p(a,f),f[1]&4&&b(l,1)):(l=Hs(a),l.c(),b(l,1),l.m(e.parentNode,e)):l&&(x(),y(l,1,1,()=>{l=null}),ee())},i(a){t||(b(l),t=!0)},o(a){y(l),t=!1},d(a){a&&h(e),l&&l.d(a)}}}function Hs(n){let e,t;return e=new Pe({props:{content:n[32].t("Edit"),placement:"bottom",$$slots:{default:[sf]},$$scope:{ctx:n}}}),{c(){Q(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},p(l,s){const r={};s[1]&2&&(r.content=l[32].t("Edit")),s[0]&16384|s[1]&2|s[3]&256&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){y(e.$$.fragment,l),t=!1},d(l){Y(e,l)}}}function sf(n){let e,t,l,s,r,i,o;return{c(){e=E("button"),t=_e("svg"),l=_e("path"),this.h()},l(a){e=N(a,"BUTTON",{"aria-label":!0,class:!0});var f=k(e);t=pe(f,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,"aria-hidden":!0,stroke:!0,class:!0});var u=k(t);l=pe(u,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(l).forEach(h),u.forEach(h),f.forEach(h),this.h()},h(){c(l,"stroke-linecap","round"),c(l,"stroke-linejoin","round"),c(l,"d","M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125"),c(t,"xmlns","http://www.w3.org/2000/svg"),c(t,"fill","none"),c(t,"viewBox","0 0 24 24"),c(t,"stroke-width","2.3"),c(t,"aria-hidden","true"),c(t,"stroke","currentColor"),c(t,"class","w-4 h-4"),c(e,"aria-label",s=n[32].t("Edit")),c(e,"class",r=(n[14]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(a,f){I(a,e,f),p(e,t),p(t,l),i||(o=ce(e,"click",n[69]),i=!0)},p(a,f){f[1]&2&&s!==(s=a[32].t("Edit"))&&c(e,"aria-label",s),f[0]&16384&&r!==(r=(a[14]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")&&c(e,"class",r)},d(a){a&&h(e),i=!1,o()}}}function nf(n){let e,t,l,s,r,i,o;return{c(){e=E("button"),t=_e("svg"),l=_e("path"),this.h()},l(a){e=N(a,"BUTTON",{"aria-label":!0,class:!0});var f=k(e);t=pe(f,"svg",{xmlns:!0,fill:!0,"aria-hidden":!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var u=k(t);l=pe(u,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(l).forEach(h),u.forEach(h),f.forEach(h),this.h()},h(){c(l,"stroke-linecap","round"),c(l,"stroke-linejoin","round"),c(l,"d","M15.666 3.888A2.25 2.25 0 0013.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 01-.75.75H9a.75.75 0 01-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 01-2.25 2.25H6.75A2.25 2.25 0 014.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 011.927-.184"),c(t,"xmlns","http://www.w3.org/2000/svg"),c(t,"fill","none"),c(t,"aria-hidden","true"),c(t,"viewBox","0 0 24 24"),c(t,"stroke-width","2.3"),c(t,"stroke","currentColor"),c(t,"class","w-4 h-4"),c(e,"aria-label",s=n[32].t("Copy")),c(e,"class",r=(n[14]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition copy-response-button")},m(a,f){I(a,e,f),p(e,t),p(t,l),i||(o=ce(e,"click",n[70]),i=!0)},p(a,f){f[1]&2&&s!==(s=a[32].t("Copy"))&&c(e,"aria-label",s),f[0]&16384&&r!==(r=(a[14]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition copy-response-button")&&c(e,"class",r)},d(a){a&&h(e),i=!1,o()}}}function zs(n){let e,t;return e=new Pe({props:{content:n[32].t("Read Aloud"),placement:"bottom",$$slots:{default:[ff]},$$scope:{ctx:n}}}),{c(){Q(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},p(l,s){const r={};s[1]&2&&(r.content=l[32].t("Read Aloud")),s[0]&100810752|s[1]&2|s[3]&256&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){y(e.$$.fragment,l),t=!1},d(l){Y(e,l)}}}function rf(n){let e,t;return{c(){e=_e("svg"),t=_e("path"),this.h()},l(l){e=pe(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"aria-hidden":!0,"stroke-width":!0,stroke:!0,class:!0});var s=k(e);t=pe(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(t).forEach(h),s.forEach(h),this.h()},h(){c(t,"stroke-linecap","round"),c(t,"stroke-linejoin","round"),c(t,"d","M19.114 5.636a9 9 0 010 12.728M16.463 8.288a5.25 5.25 0 010 7.424M6.75 8.25l4.72-4.72a.75.75 0 011.28.53v15.88a.75.75 0 01-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.01 9.01 0 012.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75z"),c(e,"xmlns","http://www.w3.org/2000/svg"),c(e,"fill","none"),c(e,"viewBox","0 0 24 24"),c(e,"aria-hidden","true"),c(e,"stroke-width","2.3"),c(e,"stroke","currentColor"),c(e,"class","w-4 h-4")},m(l,s){I(l,e,s),p(e,t)},d(l){l&&h(e)}}}function af(n){let e,t;return{c(){e=_e("svg"),t=_e("path"),this.h()},l(l){e=pe(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"aria-hidden":!0,"stroke-width":!0,stroke:!0,class:!0});var s=k(e);t=pe(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(t).forEach(h),s.forEach(h),this.h()},h(){c(t,"stroke-linecap","round"),c(t,"stroke-linejoin","round"),c(t,"d","M17.25 9.75 19.5 12m0 0 2.25 2.25M19.5 12l2.25-2.25M19.5 12l-2.25 2.25m-10.5-6 4.72-4.72a.75.75 0 0 1 1.28.53v15.88a.75.75 0 0 1-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.009 9.009 0 0 1 2.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75Z"),c(e,"xmlns","http://www.w3.org/2000/svg"),c(e,"fill","none"),c(e,"viewBox","0 0 24 24"),c(e,"aria-hidden","true"),c(e,"stroke-width","2.3"),c(e,"stroke","currentColor"),c(e,"class","w-4 h-4")},m(l,s){I(l,e,s),p(e,t)},d(l){l&&h(e)}}}function of(n){let e,t,l,s,r,i;return{c(){e=_e("svg"),t=_e("style"),l=q(`.spinner_S1WN {
															animation: spinner_MGfb 0.8s linear infinite;
															animation-delay: -0.8s;
														}

														.spinner_Km9P {
															animation-delay: -0.65s;
														}

														.spinner_JApP {
															animation-delay: -0.5s;
														}

														@keyframes spinner_MGfb {
															93.75%,
															100% {
																opacity: 0.2;
															}
														}
													`),s=_e("circle"),r=_e("circle"),i=_e("circle"),this.h()},l(o){e=pe(o,"svg",{class:!0,fill:!0,viewBox:!0,"aria-hidden":!0,xmlns:!0});var a=k(e);t=pe(a,"style",{});var f=k(t);l=F(f,`.spinner_S1WN {
															animation: spinner_MGfb 0.8s linear infinite;
															animation-delay: -0.8s;
														}

														.spinner_Km9P {
															animation-delay: -0.65s;
														}

														.spinner_JApP {
															animation-delay: -0.5s;
														}

														@keyframes spinner_MGfb {
															93.75%,
															100% {
																opacity: 0.2;
															}
														}
													`),f.forEach(h),s=pe(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),k(s).forEach(h),r=pe(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),k(r).forEach(h),i=pe(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),k(i).forEach(h),a.forEach(h),this.h()},h(){c(s,"class","spinner_S1WN"),c(s,"cx","4"),c(s,"cy","12"),c(s,"r","3"),c(r,"class","spinner_S1WN spinner_Km9P"),c(r,"cx","12"),c(r,"cy","12"),c(r,"r","3"),c(i,"class","spinner_S1WN spinner_JApP"),c(i,"cx","20"),c(i,"cy","12"),c(i,"r","3"),c(e,"class","w-4 h-4"),c(e,"fill","currentColor"),c(e,"viewBox","0 0 24 24"),c(e,"aria-hidden","true"),c(e,"xmlns","http://www.w3.org/2000/svg")},m(o,a){I(o,e,a),p(e,t),p(t,l),p(e,s),p(e,r),p(e,i)},d(o){o&&h(e)}}}function ff(n){let e,t,l,s,r,i;function o(u,d){return u[26]?of:u[25]?af:rf}let a=o(n),f=a(n);return{c(){e=E("button"),f.c(),this.h()},l(u){e=N(u,"BUTTON",{"aria-label":!0,id:!0,class:!0});var d=k(e);f.l(d),d.forEach(h),this.h()},h(){c(e,"aria-label",t=n[32].t("Read Aloud")),c(e,"id",l="speak-button-"+n[17].id),c(e,"class",s=(n[14]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(u,d){I(u,e,d),f.m(e,null),r||(i=ce(e,"click",n[71]),r=!0)},p(u,d){a!==(a=o(u))&&(f.d(1),f=a(u),f&&(f.c(),f.m(e,null))),d[1]&2&&t!==(t=u[32].t("Read Aloud"))&&c(e,"aria-label",t),d[0]&131072&&l!==(l="speak-button-"+u[17].id)&&c(e,"id",l),d[0]&16384&&s!==(s=(u[14]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")&&c(e,"class",s)},d(u){u&&h(e),f.d(),r=!1,i()}}}function Us(n){let e,t;return e=new Pe({props:{content:n[32].t("Generate Image"),placement:"bottom",$$slots:{default:[df]},$$scope:{ctx:n}}}),{c(){Q(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},p(l,s){const r={};s[1]&2&&(r.content=l[32].t("Generate Image")),s[0]&134365184|s[1]&2|s[3]&256&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){y(e.$$.fragment,l),t=!1},d(l){Y(e,l)}}}function uf(n){let e,t;return{c(){e=_e("svg"),t=_e("path"),this.h()},l(l){e=pe(l,"svg",{xmlns:!0,fill:!0,"aria-hidden":!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=k(e);t=pe(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(t).forEach(h),s.forEach(h),this.h()},h(){c(t,"stroke-linecap","round"),c(t,"stroke-linejoin","round"),c(t,"d","m2.25 15.75 5.159-5.159a2.25 2.25 0 0 1 3.182 0l5.159 5.159m-1.5-1.5 1.409-1.409a2.25 2.25 0 0 1 3.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 0 0 1.5-1.5V6a1.5 1.5 0 0 0-1.5-1.5H3.75A1.5 1.5 0 0 0 2.25 6v12a1.5 1.5 0 0 0 1.5 1.5Zm10.5-11.25h.008v.008h-.008V8.25Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"),c(e,"xmlns","http://www.w3.org/2000/svg"),c(e,"fill","none"),c(e,"aria-hidden","true"),c(e,"viewBox","0 0 24 24"),c(e,"stroke-width","2.3"),c(e,"stroke","currentColor"),c(e,"class","w-4 h-4")},m(l,s){I(l,e,s),p(e,t)},d(l){l&&h(e)}}}function cf(n){let e,t,l,s,r,i;return{c(){e=_e("svg"),t=_e("style"),l=q(`.spinner_S1WN {
															animation: spinner_MGfb 0.8s linear infinite;
															animation-delay: -0.8s;
														}

														.spinner_Km9P {
															animation-delay: -0.65s;
														}

														.spinner_JApP {
															animation-delay: -0.5s;
														}

														@keyframes spinner_MGfb {
															93.75%,
															100% {
																opacity: 0.2;
															}
														}
													`),s=_e("circle"),r=_e("circle"),i=_e("circle"),this.h()},l(o){e=pe(o,"svg",{"aria-hidden":!0,class:!0,fill:!0,viewBox:!0,xmlns:!0});var a=k(e);t=pe(a,"style",{});var f=k(t);l=F(f,`.spinner_S1WN {
															animation: spinner_MGfb 0.8s linear infinite;
															animation-delay: -0.8s;
														}

														.spinner_Km9P {
															animation-delay: -0.65s;
														}

														.spinner_JApP {
															animation-delay: -0.5s;
														}

														@keyframes spinner_MGfb {
															93.75%,
															100% {
																opacity: 0.2;
															}
														}
													`),f.forEach(h),s=pe(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),k(s).forEach(h),r=pe(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),k(r).forEach(h),i=pe(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),k(i).forEach(h),a.forEach(h),this.h()},h(){c(s,"class","spinner_S1WN"),c(s,"cx","4"),c(s,"cy","12"),c(s,"r","3"),c(r,"class","spinner_S1WN spinner_Km9P"),c(r,"cx","12"),c(r,"cy","12"),c(r,"r","3"),c(i,"class","spinner_S1WN spinner_JApP"),c(i,"cx","20"),c(i,"cy","12"),c(i,"r","3"),c(e,"aria-hidden","true"),c(e,"class","w-4 h-4"),c(e,"fill","currentColor"),c(e,"viewBox","0 0 24 24"),c(e,"xmlns","http://www.w3.org/2000/svg")},m(o,a){I(o,e,a),p(e,t),p(t,l),p(e,s),p(e,r),p(e,i)},d(o){o&&h(e)}}}function df(n){let e,t,l,s,r;function i(f,u){return f[27]?cf:uf}let o=i(n),a=o(n);return{c(){e=E("button"),a.c(),this.h()},l(f){e=N(f,"BUTTON",{"aria-label":!0,class:!0});var u=k(e);a.l(u),u.forEach(h),this.h()},h(){c(e,"aria-label",t=n[32].t("Generate Image")),c(e,"class",l=(n[14]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(f,u){I(f,e,u),a.m(e,null),s||(r=ce(e,"click",n[72]),s=!0)},p(f,u){o!==(o=i(f))&&(a.d(1),a=o(f),a&&(a.c(),a.m(e,null))),u[1]&2&&t!==(t=f[32].t("Generate Image"))&&c(e,"aria-label",t),u[0]&16384&&l!==(l=(f[14]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")&&c(e,"class",l)},d(f){f&&h(e),a.d(),s=!1,r()}}}function Ws(n){let e,t;return e=new Pe({props:{content:n[17].usage?`<pre>${kt(JSON.stringify(n[17].usage,null,2).replace(/"([^(")"]+)":/g,"$1:").slice(1,-1).split(`
`).map(en).map(tn).join(`
`))}</pre>`:"",placement:"bottom",$$slots:{default:[hf]},$$scope:{ctx:n}}}),{c(){Q(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},p(l,s){const r={};s[0]&131072&&(r.content=l[17].usage?`<pre>${kt(JSON.stringify(l[17].usage,null,2).replace(/"([^(")"]+)":/g,"$1:").slice(1,-1).split(`
`).map(en).map(tn).join(`
`))}</pre>`:""),s[0]&147456|s[3]&256&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){y(e.$$.fragment,l),t=!1},d(l){Y(e,l)}}}function hf(n){let e,t,l,s,r,i,o;return{c(){e=E("button"),t=_e("svg"),l=_e("path"),this.h()},l(a){e=N(a,"BUTTON",{"aria-hidden":!0,class:!0,id:!0});var f=k(e);t=pe(f,"svg",{"aria-hidden":!0,xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var u=k(t);l=pe(u,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(l).forEach(h),u.forEach(h),f.forEach(h),this.h()},h(){c(l,"stroke-linecap","round"),c(l,"stroke-linejoin","round"),c(l,"d","M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z"),c(t,"aria-hidden","true"),c(t,"xmlns","http://www.w3.org/2000/svg"),c(t,"fill","none"),c(t,"viewBox","0 0 24 24"),c(t,"stroke-width","2.3"),c(t,"stroke","currentColor"),c(t,"class","w-4 h-4"),c(e,"aria-hidden","true"),c(e,"class",s=(n[14]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition whitespace-pre-wrap"),c(e,"id",r="info-"+n[17].id)},m(a,f){I(a,e,f),p(e,t),p(t,l),i||(o=ce(e,"click",n[73]),i=!0)},p(a,f){f[0]&16384&&s!==(s=(a[14]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition whitespace-pre-wrap")&&c(e,"class",s),f[0]&131072&&r!==(r="info-"+a[17].id)&&c(e,"id",r)},d(a){a&&h(e),i=!1,o()}}}function qs(n){var v;let e,t,l,s,r,i,o,a,f=!n[34]&&(((v=n[31])==null?void 0:v.features.enable_message_rating)??!0)&&Fs(n),u=n[14]&&Gs(n);const d=[bf,pf],g=[];function m(M,T){var P;return((P=M[30])==null?void 0:P.regenerateMenu)??!0?0:1}l=m(n),s=g[l]=d[l](n);let _=n[3].length>1&&Js(n),D=n[14]&&Ks(n);return{c(){f&&f.c(),e=A(),u&&u.c(),t=A(),s.c(),r=A(),_&&_.c(),i=A(),D&&D.c(),o=ae()},l(M){f&&f.l(M),e=H(M),u&&u.l(M),t=H(M),s.l(M),r=H(M),_&&_.l(M),i=H(M),D&&D.l(M),o=ae()},m(M,T){f&&f.m(M,T),I(M,e,T),u&&u.m(M,T),I(M,t,T),g[l].m(M,T),I(M,r,T),_&&_.m(M,T),I(M,i,T),D&&D.m(M,T),I(M,o,T),a=!0},p(M,T){var L;!M[34]&&(((L=M[31])==null?void 0:L.features.enable_message_rating)??!0)?f?(f.p(M,T),T[1]&9&&b(f,1)):(f=Fs(M),f.c(),b(f,1),f.m(e.parentNode,e)):f&&(x(),y(f,1,1,()=>{f=null}),ee()),M[14]?u?(u.p(M,T),T[0]&16384&&b(u,1)):(u=Gs(M),u.c(),b(u,1),u.m(t.parentNode,t)):u&&(x(),y(u,1,1,()=>{u=null}),ee());let P=l;l=m(M),l===P?g[l].p(M,T):(x(),y(g[P],1,1,()=>{g[P]=null}),ee(),s=g[l],s?s.p(M,T):(s=g[l]=d[l](M),s.c()),b(s,1),s.m(r.parentNode,r)),M[3].length>1?_?(_.p(M,T),T[0]&8&&b(_,1)):(_=Js(M),_.c(),b(_,1),_.m(i.parentNode,i)):_&&(x(),y(_,1,1,()=>{_=null}),ee()),M[14]?D?(D.p(M,T),T[0]&16384&&b(D,1)):(D=Ks(M),D.c(),b(D,1),D.m(o.parentNode,o)):D&&(x(),y(D,1,1,()=>{D=null}),ee())},i(M){a||(b(f),b(u),b(s),b(_),b(D),a=!0)},o(M){y(f),y(u),y(s),y(_),y(D),a=!1},d(M){M&&(h(e),h(t),h(r),h(i),h(o)),f&&f.d(M),u&&u.d(M),g[l].d(M),_&&_.d(M),D&&D.d(M)}}}function Fs(n){let e,t,l,s;return e=new Pe({props:{content:n[32].t("Good Response"),placement:"bottom",$$slots:{default:[mf]},$$scope:{ctx:n}}}),l=new Pe({props:{content:n[32].t("Bad Response"),placement:"bottom",$$slots:{default:[gf]},$$scope:{ctx:n}}}),{c(){Q(e.$$.fragment),t=A(),Q(l.$$.fragment)},l(r){$(e.$$.fragment,r),t=H(r),$(l.$$.fragment,r)},m(r,i){X(e,r,i),I(r,t,i),X(l,r,i),s=!0},p(r,i){const o={};i[1]&2&&(o.content=r[32].t("Good Response")),i[0]&537018368|i[1]&2|i[3]&256&&(o.$$scope={dirty:i,ctx:r}),e.$set(o);const a={};i[1]&2&&(a.content=r[32].t("Bad Response")),i[0]&537018368|i[1]&2|i[3]&256&&(a.$$scope={dirty:i,ctx:r}),l.$set(a)},i(r){s||(b(e.$$.fragment,r),b(l.$$.fragment,r),s=!0)},o(r){y(e.$$.fragment,r),y(l.$$.fragment,r),s=!1},d(r){r&&h(t),Y(e,r),Y(l,r)}}}function mf(n){let e,t,l,s,r,i,o;return{c(){e=E("button"),t=_e("svg"),l=_e("path"),this.h()},l(a){e=N(a,"BUTTON",{"aria-label":!0,class:!0});var f=k(e);t=pe(f,"svg",{"aria-hidden":!0,stroke:!0,fill:!0,"stroke-width":!0,viewBox:!0,"stroke-linecap":!0,"stroke-linejoin":!0,class:!0,xmlns:!0});var u=k(t);l=pe(u,"path",{d:!0}),k(l).forEach(h),u.forEach(h),f.forEach(h),this.h()},h(){var a,f;c(l,"d","M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3"),c(t,"aria-hidden","true"),c(t,"stroke","currentColor"),c(t,"fill","none"),c(t,"stroke-width","2.3"),c(t,"viewBox","0 0 24 24"),c(t,"stroke-linecap","round"),c(t,"stroke-linejoin","round"),c(t,"class","w-4 h-4"),c(t,"xmlns","http://www.w3.org/2000/svg"),c(e,"aria-label",s=n[32].t("Good Response")),c(e,"class",r=(n[14]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg "+((((f=(a=n[17])==null?void 0:a.annotation)==null?void 0:f.rating)??"").toString()==="1"?"bg-gray-100 dark:bg-gray-800":"")+" dark:hover:text-white hover:text-black transition disabled:cursor-progress disabled:hover:bg-transparent"),e.disabled=n[29]},m(a,f){I(a,e,f),p(e,t),p(t,l),i||(o=ce(e,"click",n[74]),i=!0)},p(a,f){var u,d;f[1]&2&&s!==(s=a[32].t("Good Response"))&&c(e,"aria-label",s),f[0]&147456&&r!==(r=(a[14]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg "+((((d=(u=a[17])==null?void 0:u.annotation)==null?void 0:d.rating)??"").toString()==="1"?"bg-gray-100 dark:bg-gray-800":"")+" dark:hover:text-white hover:text-black transition disabled:cursor-progress disabled:hover:bg-transparent")&&c(e,"class",r),f[0]&536870912&&(e.disabled=a[29])},d(a){a&&h(e),i=!1,o()}}}function gf(n){let e,t,l,s,r,i,o;return{c(){e=E("button"),t=_e("svg"),l=_e("path"),this.h()},l(a){e=N(a,"BUTTON",{"aria-label":!0,class:!0});var f=k(e);t=pe(f,"svg",{"aria-hidden":!0,stroke:!0,fill:!0,"stroke-width":!0,viewBox:!0,"stroke-linecap":!0,"stroke-linejoin":!0,class:!0,xmlns:!0});var u=k(t);l=pe(u,"path",{d:!0}),k(l).forEach(h),u.forEach(h),f.forEach(h),this.h()},h(){var a,f;c(l,"d","M10 15v4a3 3 0 0 0 3 3l4-9V2H5.72a2 2 0 0 0-2 1.7l-1.38 9a2 2 0 0 0 2 2.3zm7-13h2.67A2.31 2.31 0 0 1 22 4v7a2.31 2.31 0 0 1-2.33 2H17"),c(t,"aria-hidden","true"),c(t,"stroke","currentColor"),c(t,"fill","none"),c(t,"stroke-width","2.3"),c(t,"viewBox","0 0 24 24"),c(t,"stroke-linecap","round"),c(t,"stroke-linejoin","round"),c(t,"class","w-4 h-4"),c(t,"xmlns","http://www.w3.org/2000/svg"),c(e,"aria-label",s=n[32].t("Bad Response")),c(e,"class",r=(n[14]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg "+((((f=(a=n[17])==null?void 0:a.annotation)==null?void 0:f.rating)??"").toString()==="-1"?"bg-gray-100 dark:bg-gray-800":"")+" dark:hover:text-white hover:text-black transition disabled:cursor-progress disabled:hover:bg-transparent"),e.disabled=n[29]},m(a,f){I(a,e,f),p(e,t),p(t,l),i||(o=ce(e,"click",n[75]),i=!0)},p(a,f){var u,d;f[1]&2&&s!==(s=a[32].t("Bad Response"))&&c(e,"aria-label",s),f[0]&147456&&r!==(r=(a[14]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg "+((((d=(u=a[17])==null?void 0:u.annotation)==null?void 0:d.rating)??"").toString()==="-1"?"bg-gray-100 dark:bg-gray-800":"")+" dark:hover:text-white hover:text-black transition disabled:cursor-progress disabled:hover:bg-transparent")&&c(e,"class",r),f[0]&536870912&&(e.disabled=a[29])},d(a){a&&h(e),i=!1,o()}}}function Gs(n){let e,t;return e=new Pe({props:{content:n[32].t("Continue Response"),placement:"bottom",$$slots:{default:[_f]},$$scope:{ctx:n}}}),{c(){Q(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},p(l,s){const r={};s[1]&2&&(r.content=l[32].t("Continue Response")),s[0]&18432|s[1]&2|s[3]&256&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){y(e.$$.fragment,l),t=!1},d(l){Y(e,l)}}}function _f(n){let e,t,l,s,r,i,o,a;return{c(){e=E("button"),t=_e("svg"),l=_e("path"),s=_e("path"),this.h()},l(f){e=N(f,"BUTTON",{"aria-label":!0,type:!0,id:!0,class:!0});var u=k(e);t=pe(u,"svg",{"aria-hidden":!0,xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var d=k(t);l=pe(d,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(l).forEach(h),s=pe(d,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(s).forEach(h),d.forEach(h),u.forEach(h),this.h()},h(){c(l,"stroke-linecap","round"),c(l,"stroke-linejoin","round"),c(l,"d","M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"),c(s,"stroke-linecap","round"),c(s,"stroke-linejoin","round"),c(s,"d","M15.91 11.672a.375.375 0 0 1 0 .656l-5.603 3.113a.375.375 0 0 1-.557-.328V8.887c0-.286.307-.466.557-.327l5.603 3.112Z"),c(t,"aria-hidden","true"),c(t,"xmlns","http://www.w3.org/2000/svg"),c(t,"fill","none"),c(t,"viewBox","0 0 24 24"),c(t,"stroke-width","2.3"),c(t,"stroke","currentColor"),c(t,"class","w-4 h-4"),c(e,"aria-label",r=n[32].t("Continue Response")),c(e,"type","button"),c(e,"id","continue-response-button"),c(e,"class",i=(n[14]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(f,u){I(f,e,u),p(e,t),p(t,l),p(t,s),o||(a=ce(e,"click",n[76]),o=!0)},p(f,u){u[1]&2&&r!==(r=f[32].t("Continue Response"))&&c(e,"aria-label",r),u[0]&16384&&i!==(i=(f[14]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")&&c(e,"class",i)},d(f){f&&h(e),o=!1,a()}}}function pf(n){let e,t;return e=new Pe({props:{content:n[32].t("Regenerate"),placement:"bottom",$$slots:{default:[vf]},$$scope:{ctx:n}}}),{c(){Q(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},p(l,s){const r={};s[1]&2&&(r.content=l[32].t("Regenerate")),s[0]&270684160|s[1]&2|s[3]&256&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){y(e.$$.fragment,l),t=!1},d(l){Y(e,l)}}}function bf(n){let e,t,l,s,r,i;return l=new Bo({props:{onRegenerate:n[78],$$slots:{default:[wf]},$$scope:{ctx:n}}}),{c(){e=E("button"),t=A(),Q(l.$$.fragment),this.h()},l(o){e=N(o,"BUTTON",{type:!0,class:!0}),k(e).forEach(h),t=H(o),$(l.$$.fragment,o),this.h()},h(){c(e,"type","button"),c(e,"class","hidden regenerate-response-button")},m(o,a){I(o,e,a),I(o,t,a),X(l,o,a),s=!0,r||(i=ce(e,"click",n[77]),r=!0)},p(o,a){const f={};a[0]&270667776&&(f.onRegenerate=o[78]),a[0]&16384|a[1]&2|a[3]&256&&(f.$$scope={dirty:a,ctx:o}),l.$set(f)},i(o){s||(b(l.$$.fragment,o),s=!0)},o(o){y(l.$$.fragment,o),s=!1},d(o){o&&(h(e),h(t)),Y(l,o),r=!1,i()}}}function vf(n){let e,t,l,s,r,i,o;return{c(){e=E("button"),t=_e("svg"),l=_e("path"),this.h()},l(a){e=N(a,"BUTTON",{type:!0,"aria-label":!0,class:!0});var f=k(e);t=pe(f,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,"aria-hidden":!0,stroke:!0,class:!0});var u=k(t);l=pe(u,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(l).forEach(h),u.forEach(h),f.forEach(h),this.h()},h(){c(l,"stroke-linecap","round"),c(l,"stroke-linejoin","round"),c(l,"d","M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99"),c(t,"xmlns","http://www.w3.org/2000/svg"),c(t,"fill","none"),c(t,"viewBox","0 0 24 24"),c(t,"stroke-width","2.3"),c(t,"aria-hidden","true"),c(t,"stroke","currentColor"),c(t,"class","w-4 h-4"),c(e,"type","button"),c(e,"aria-label",s=n[32].t("Regenerate")),c(e,"class",r=(n[14]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")},m(a,f){I(a,e,f),p(e,t),p(t,l),i||(o=ce(e,"click",n[79]),i=!0)},p(a,f){f[1]&2&&s!==(s=a[32].t("Regenerate"))&&c(e,"aria-label",s),f[0]&16384&&r!==(r=(a[14]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")&&c(e,"class",r)},d(a){a&&h(e),i=!1,o()}}}function kf(n){let e,t,l,s,r;return{c(){e=E("div"),t=_e("svg"),l=_e("path"),this.h()},l(i){e=N(i,"DIV",{"aria-label":!0,class:!0});var o=k(e);t=pe(o,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,"aria-hidden":!0,stroke:!0,class:!0});var a=k(t);l=pe(a,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(l).forEach(h),a.forEach(h),o.forEach(h),this.h()},h(){c(l,"stroke-linecap","round"),c(l,"stroke-linejoin","round"),c(l,"d","M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99"),c(t,"xmlns","http://www.w3.org/2000/svg"),c(t,"fill","none"),c(t,"viewBox","0 0 24 24"),c(t,"stroke-width","2.3"),c(t,"aria-hidden","true"),c(t,"stroke","currentColor"),c(t,"class","w-4 h-4"),c(e,"aria-label",s=n[32].t("Regenerate")),c(e,"class",r=(n[14]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(i,o){I(i,e,o),p(e,t),p(t,l)},p(i,o){o[1]&2&&s!==(s=i[32].t("Regenerate"))&&c(e,"aria-label",s),o[0]&16384&&r!==(r=(i[14]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")&&c(e,"class",r)},d(i){i&&h(e)}}}function wf(n){let e,t;return e=new Pe({props:{content:n[32].t("Regenerate"),placement:"bottom",$$slots:{default:[kf]},$$scope:{ctx:n}}}),{c(){Q(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},p(l,s){const r={};s[1]&2&&(r.content=l[32].t("Regenerate")),s[0]&16384|s[1]&2|s[3]&256&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){y(e.$$.fragment,l),t=!1},d(l){Y(e,l)}}}function Js(n){let e,t;return e=new Pe({props:{content:n[32].t("Delete"),placement:"bottom",$$slots:{default:[If]},$$scope:{ctx:n}}}),{c(){Q(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},p(l,s){const r={};s[1]&2&&(r.content=l[32].t("Delete")),s[0]&1064960|s[1]&2|s[3]&256&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){y(e.$$.fragment,l),t=!1},d(l){Y(e,l)}}}function If(n){let e,t,l,s,r,i,o;return{c(){e=E("button"),t=_e("svg"),l=_e("path"),this.h()},l(a){e=N(a,"BUTTON",{type:!0,"aria-label":!0,id:!0,class:!0});var f=k(e);t=pe(f,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,"aria-hidden":!0,class:!0});var u=k(t);l=pe(u,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(l).forEach(h),u.forEach(h),f.forEach(h),this.h()},h(){c(l,"stroke-linecap","round"),c(l,"stroke-linejoin","round"),c(l,"d","m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"),c(t,"xmlns","http://www.w3.org/2000/svg"),c(t,"fill","none"),c(t,"viewBox","0 0 24 24"),c(t,"stroke-width","2"),c(t,"stroke","currentColor"),c(t,"aria-hidden","true"),c(t,"class","w-4 h-4"),c(e,"type","button"),c(e,"aria-label",s=n[32].t("Delete")),c(e,"id","delete-response-button"),c(e,"class",r=(n[14]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(a,f){I(a,e,f),p(e,t),p(t,l),i||(o=ce(e,"click",n[80]),i=!0)},p(a,f){f[1]&2&&s!==(s=a[32].t("Delete"))&&c(e,"aria-label",s),f[0]&16384&&r!==(r=(a[14]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")&&c(e,"class",r)},d(a){a&&h(e),i=!1,o()}}}function Ks(n){var i;let e,t,l=Ce(((i=n[21])==null?void 0:i.actions)??[]),s=[];for(let o=0;o<l.length;o+=1)s[o]=Zs(Ms(n,l,o));const r=o=>y(s[o],1,1,()=>{s[o]=null});return{c(){for(let o=0;o<s.length;o+=1)s[o].c();e=ae()},l(o){for(let a=0;a<s.length;a+=1)s[a].l(o);e=ae()},m(o,a){for(let f=0;f<s.length;f+=1)s[f]&&s[f].m(o,a);I(o,e,a),t=!0},p(o,a){var f;if(a[0]&2245120){l=Ce(((f=o[21])==null?void 0:f.actions)??[]);let u;for(u=0;u<l.length;u+=1){const d=Ms(o,l,u);s[u]?(s[u].p(d,a),b(s[u],1)):(s[u]=Zs(d),s[u].c(),b(s[u],1),s[u].m(e.parentNode,e))}for(x(),u=l.length;u<s.length;u+=1)r(u);ee()}},i(o){if(!t){for(let a=0;a<l.length;a+=1)b(s[a]);t=!0}},o(o){s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)y(s[a]);t=!1},d(o){o&&h(e),Fe(s,o)}}}function yf(n){let e,t;return e=new oi({props:{strokeWidth:"2.1",className:"size-4"}}),{c(){Q(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},p:Ne,i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){y(e.$$.fragment,l),t=!1},d(l){Y(e,l)}}}function Mf(n){let e,t,l,s,r;return{c(){e=E("div"),t=E("img"),this.h()},l(i){e=N(i,"DIV",{class:!0});var o=k(e);t=N(o,"IMG",{src:!0,class:!0,style:!0,alt:!0}),o.forEach(h),this.h()},h(){At(t.src,l=n[94].icon)||c(t,"src",l),c(t,"class",s="w-4 h-4 "+(n[94].icon.includes("svg")?"dark:invert-[80%]":"")),jt(t,"fill","currentColor"),c(t,"alt",r=n[94].name),c(e,"class","size-4")},m(i,o){I(i,e,o),p(e,t)},p(i,o){o[0]&2097152&&!At(t.src,l=i[94].icon)&&c(t,"src",l),o[0]&2097152&&s!==(s="w-4 h-4 "+(i[94].icon.includes("svg")?"dark:invert-[80%]":""))&&c(t,"class",s),o[0]&2097152&&r!==(r=i[94].name)&&c(t,"alt",r)},i:Ne,o:Ne,d(i){i&&h(e)}}}function Ef(n){let e,t,l,s,r,i,o,a,f;const u=[Mf,yf],d=[];function g(_,D){var v;return(v=_[94])!=null&&v.icon?0:1}t=g(n),l=d[t]=u[t](n);function m(){return n[81](n[94])}return{c(){e=E("button"),l.c(),i=A(),this.h()},l(_){e=N(_,"BUTTON",{type:!0,"aria-label":!0,class:!0});var D=k(e);l.l(D),D.forEach(h),i=H(_),this.h()},h(){c(e,"type","button"),c(e,"aria-label",s=n[94].name),c(e,"class",r=(n[14]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(_,D){I(_,e,D),d[t].m(e,null),I(_,i,D),o=!0,a||(f=ce(e,"click",m),a=!0)},p(_,D){n=_;let v=t;t=g(n),t===v?d[t].p(n,D):(x(),y(d[v],1,1,()=>{d[v]=null}),ee(),l=d[t],l?l.p(n,D):(l=d[t]=u[t](n),l.c()),b(l,1),l.m(e,null)),(!o||D[0]&2097152&&s!==(s=n[94].name))&&c(e,"aria-label",s),(!o||D[0]&16384&&r!==(r=(n[14]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition"))&&c(e,"class",r)},i(_){o||(b(l),o=!0)},o(_){y(l),o=!1},d(_){_&&(h(e),h(i)),d[t].d(),a=!1,f()}}}function Zs(n){let e,t;return e=new Pe({props:{content:n[94].name,placement:"bottom",$$slots:{default:[Ef]},$$scope:{ctx:n}}}),{c(){Q(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},p(l,s){const r={};s[0]&2097152&&(r.content=l[94].name),s[0]&2245120|s[3]&256&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){y(e.$$.fragment,l),t=!1},d(l){Y(e,l)}}}function Qs(n){let e,t,l,s;function r(a){n[83](a)}function i(a){n[84](a)}let o={};return n[17]!==void 0&&(o.message=n[17]),n[28]!==void 0&&(o.show=n[28]),e=new Wi({props:o}),We.push(()=>Ze(e,"message",r)),We.push(()=>Ze(e,"show",i)),e.$on("save",n[85]),{c(){Q(e.$$.fragment)},l(a){$(e.$$.fragment,a)},m(a,f){X(e,a,f),s=!0},p(a,f){const u={};!t&&f[0]&131072&&(t=!0,u.message=a[17],Qe(()=>t=!1)),!l&&f[0]&268435456&&(l=!0,u.show=a[28],Qe(()=>l=!1)),e.$set(u)},i(a){s||(b(e.$$.fragment,a),s=!0)},o(a){y(e.$$.fragment,a),s=!1},d(a){Y(e,a)}}}function Xs(n){var r;let e,t,l,s;return t=new po({props:{followUps:(r=n[17])==null?void 0:r.followUps,onClick:n[86]}}),{c(){e=E("div"),Q(t.$$.fragment),this.h()},l(i){e=N(i,"DIV",{class:!0});var o=k(e);$(t.$$.fragment,o),o.forEach(h),this.h()},h(){c(e,"class","mt-2.5")},m(i,o){I(i,e,o),X(t,e,null),s=!0},p(i,o){var f;const a={};o[0]&131072&&(a.followUps=(f=i[17])==null?void 0:f.followUps),o[0]&1073873936&&(a.onClick=i[86]),t.$set(a)},i(i){s||(b(t.$$.fragment,i),i&&(l||Et(()=>{l=Nt(e,Dt,{duration:100}),l.start()})),s=!0)},o(i){y(t.$$.fragment,i),s=!1},d(i){i&&h(e),Y(t)}}}function Ys(n){var s;let e,t=(((s=n[17])==null?void 0:s.content)??"")+"",l;return{c(){e=E("div"),l=q(t),this.h()},l(r){e=N(r,"DIV",{"aria-live":!0,class:!0});var i=k(e);l=F(i,t),i.forEach(h),this.h()},h(){c(e,"aria-live","polite"),c(e,"class","sr-only")},m(r,i){I(r,e,i),p(e,l)},p(r,i){var o;i[0]&131072&&t!==(t=(((o=r[17])==null?void 0:o.content)??"")+"")&&Z(l,t)},d(r){r&&h(e)}}}function $s(n){var ue,le,he,J,oe,me,re,ie,ge;let e,t,l,s,r,i,o,a,f,u,d,g=((ue=n[17])==null?void 0:ue.files)&&((le=n[17].files)==null?void 0:le.filter(xs).length)>0,m,_,D,v,M,T,P,L,S,w;l=new or({props:{src:((oe=(J=(he=n[21])==null?void 0:he.info)==null?void 0:J.meta)==null?void 0:oe.profile_image_url)??(n[32].language==="dg-DG"?`${xe}/doge.png`:`${xe}/favicon.png`),className:"size-8 assistant-message-profile-image"}}),i=new $t({props:{$$slots:{default:[Po]},$$scope:{ctx:n}}});let C=(((me=n[17])==null?void 0:me.statusHistory)??[...(re=n[17])!=null&&re.status?[(ie=n[17])==null?void 0:ie.status]:[]]).length>0&&Ds(Ft(n)),V=g&&Cs(n);const O=[$o,Yo],B=[];function G(se,fe){return se[18]===!0?0:1}_=G(n),D=B[_]=O[_](n);let U=!n[18]&&Rs(n),j=((ge=n[17])==null?void 0:ge.done)&&Ys(n);return{c(){e=E("div"),t=E("div"),Q(l.$$.fragment),s=A(),r=E("div"),Q(i.$$.fragment),o=A(),a=E("div"),f=E("div"),u=E("div"),C&&C.c(),d=A(),V&&V.c(),m=A(),D.c(),M=A(),U&&U.c(),T=A(),j&&j.c(),this.h()},l(se){e=N(se,"DIV",{class:!0,id:!0,dir:!0});var fe=k(e);t=N(fe,"DIV",{class:!0});var Me=k(t);$(l.$$.fragment,Me),Me.forEach(h),s=H(fe),r=N(fe,"DIV",{class:!0});var Ee=k(r);$(i.$$.fragment,Ee),o=H(Ee),a=N(Ee,"DIV",{});var ve=k(a);f=N(ve,"DIV",{class:!0});var Se=k(f);u=N(Se,"DIV",{});var we=k(u);C&&C.l(we),d=H(we),V&&V.l(we),m=H(we),D.l(we),we.forEach(h),Se.forEach(h),M=H(ve),U&&U.l(ve),ve.forEach(h),T=H(Ee),j&&j.l(Ee),Ee.forEach(h),fe.forEach(h),this.h()},h(){c(t,"class",Fr("shrink-0 ltr:mr-3 rtl:ml-3 hidden @lg:flex mt-1 ")+" svelte-1u5gq5j"),c(f,"class",v="chat-"+n[17].role+" w-full min-w-full markdown-prose svelte-1u5gq5j"),c(r,"class","flex-auto w-0 pl-1 relative"),c(e,"class",P="flex w-full message-"+n[17].id+" svelte-1u5gq5j"),c(e,"id",L="message-"+n[17].id),c(e,"dir",S=n[30].chatDirection)},m(se,fe){I(se,e,fe),p(e,t),X(l,t,null),p(e,s),p(e,r),X(i,r,null),p(r,o),p(r,a),p(a,f),p(f,u),C&&C.m(u,null),p(u,d),V&&V.m(u,null),p(u,m),B[_].m(u,null),p(a,M),U&&U.m(a,null),p(r,T),j&&j.m(r,null),w=!0},p(se,fe){var Se,we,ke,R,K,ne,be,ye,W;const Me={};fe[0]&2097152|fe[1]&2&&(Me.src=((ke=(we=(Se=se[21])==null?void 0:Se.info)==null?void 0:we.meta)==null?void 0:ke.profile_image_url)??(se[32].language==="dg-DG"?`${xe}/doge.png`:`${xe}/favicon.png`)),l.$set(Me);const Ee={};fe[0]&2228224|fe[3]&256&&(Ee.$$scope={dirty:fe,ctx:se}),i.$set(Ee),(((R=se[17])==null?void 0:R.statusHistory)??[...(K=se[17])!=null&&K.status?[(ne=se[17])==null?void 0:ne.status]:[]]).length>0?C?(C.p(Ft(se),fe),fe[0]&131072&&b(C,1)):(C=Ds(Ft(se)),C.c(),b(C,1),C.m(u,d)):C&&(x(),y(C,1,1,()=>{C=null}),ee()),fe[0]&131072&&(g=((be=se[17])==null?void 0:be.files)&&((ye=se[17].files)==null?void 0:ye.filter(xs).length)>0),g?V?(V.p(se,fe),fe[0]&131072&&b(V,1)):(V=Cs(se),V.c(),b(V,1),V.m(u,m)):V&&(x(),y(V,1,1,()=>{V=null}),ee());let ve=_;_=G(se),_===ve?B[_].p(se,fe):(x(),y(B[ve],1,1,()=>{B[ve]=null}),ee(),D=B[_],D?D.p(se,fe):(D=B[_]=O[_](se),D.c()),b(D,1),D.m(u,null)),(!w||fe[0]&131072&&v!==(v="chat-"+se[17].role+" w-full min-w-full markdown-prose svelte-1u5gq5j"))&&c(f,"class",v),se[18]?U&&(x(),y(U,1,1,()=>{U=null}),ee()):U?(U.p(se,fe),fe[0]&262144&&b(U,1)):(U=Rs(se),U.c(),b(U,1),U.m(a,null)),(W=se[17])!=null&&W.done?j?j.p(se,fe):(j=Ys(se),j.c(),j.m(r,null)):j&&(j.d(1),j=null),(!w||fe[0]&131072&&P!==(P="flex w-full message-"+se[17].id+" svelte-1u5gq5j"))&&c(e,"class",P),(!w||fe[0]&131072&&L!==(L="message-"+se[17].id))&&c(e,"id",L),(!w||fe[0]&1073741824&&S!==(S=se[30].chatDirection))&&c(e,"dir",S)},i(se){w||(b(l.$$.fragment,se),b(i.$$.fragment,se),b(C),b(V),b(D),b(U),w=!0)},o(se){y(l.$$.fragment,se),y(i.$$.fragment,se),y(C),y(V),y(D),y(U),w=!1},d(se){se&&h(e),Y(l),Y(i),C&&C.d(),V&&V.d(),B[_].d(),U&&U.d(),j&&j.d()}}}function Nf(n){let e,t,l,s=n[17].id,r,i;function o(u){n[52](u)}let a={title:n[32].t("Delete message?")};n[20]!==void 0&&(a.show=n[20]),e=new dr({props:a}),We.push(()=>Ze(e,"show",o)),e.$on("confirm",n[53]);let f=$s(n);return{c(){Q(e.$$.fragment),l=A(),f.c(),r=ae()},l(u){$(e.$$.fragment,u),l=H(u),f.l(u),r=ae()},m(u,d){X(e,u,d),I(u,l,d),f.m(u,d),I(u,r,d),i=!0},p(u,d){const g={};d[1]&2&&(g.title=u[32].t("Delete message?")),!t&&d[0]&1048576&&(t=!0,g.show=u[20],Qe(()=>t=!1)),e.$set(g),d[0]&131072&&Re(s,s=u[17].id)?(x(),y(f,1,1,Ne),ee(),f=$s(u),f.c(),b(f,1),f.m(r.parentNode,r)):f.p(u,d)},i(u){i||(b(e.$$.fragment,u),b(f),i=!0)},o(u){y(e.$$.fragment,u),y(f),i=!1},d(u){u&&(h(l),h(r)),Y(e,u),f.d(u)}}}const xs=n=>n.type==="image",Df=n=>{n.target.style.height="",n.target.style.height=`${n.target.scrollHeight}px`},Tf=n=>{n.target.select()},en=n=>n.slice(2),tn=n=>n.endsWith(",")?n.slice(0,-1):n;function Cf(n,e,t){let l,s,r,i,o,a,f;Te(n,Ct,z=>t(51,l=z)),Te(n,pt,z=>t(30,s=z)),Te(n,rr,z=>t(31,r=z)),Te(n,yl,z=>t(90,i=z)),Te(n,Ut,z=>t(33,a=z)),Te(n,Yt,z=>t(34,f=z));const u=Ge("i18n");Te(n,u,z=>t(32,o=z));const d=Tt();let{chatId:g=""}=e,{history:m}=e,{messageId:_}=e,{selectedModels:D=[]}=e,v=JSON.parse(JSON.stringify(m.messages[_])),{siblings:M}=e,{setInputText:T=()=>{}}=e,{gotoMessage:P=()=>{}}=e,{showPreviousMessage:L}=e,{showNextMessage:S}=e,{updateChat:w}=e,{editMessage:C}=e,{saveMessage:V}=e,{rateMessage:O}=e,{actionMessage:B}=e,{deleteMessage:G}=e,{submitMessage:U}=e,{continueResponse:j}=e,{regenerateResponse:ue}=e,{addMessages:le}=e,{isLastMessage:he=!0}=e,{readOnly:J=!1}=e,{topPadding:oe=!1}=e,me,re=!1,ie=null,ge=!1,se="",fe,Me=!1,Ee={},ve=!1,Se,we=!1,ke=!1,R=!1;const K=async z=>{var De,Ae;z=Nl(z),(((De=r==null?void 0:r.ui)==null?void 0:De.response_watermark)??"").trim()!==""&&(z=`${z}

${(Ae=r==null?void 0:r.ui)==null?void 0:Ae.response_watermark}`),await ir(z,null,(s==null?void 0:s.copyFormatted)??!1)&&qe.success(o.t("Copying to clipboard was successful!"))},ne=z=>new Promise(Be=>{Se=z;const De=Ee[z];if(!De)return Be();De.play(),De.onended=async()=>{await new Promise(Ae=>setTimeout(Ae,300)),Object.keys(Ee).length-1===z&&t(25,ve=!1),Be()}}),be=async()=>{var Be,De,Ae,rt,it,Pt,ht,yt,Ue,$e,ct,Mt,Lt,rl,il,al,ol,fl,ul,cl,dl,hl,ml;if(ve){try{speechSynthesis.cancel(),Se!==void 0&&Ee[Se]&&(Ee[Se].pause(),Ee[Se].currentTime=0)}catch{}t(25,ve=!1),Se=void 0;return}if(!((v==null?void 0:v.content)??"").trim().length){qe.info(o.t("No content to speak"));return}t(25,ve=!0);const z=Nl(v.content);if(r.audio.tts.engine===""){let tt=[];const bt=setInterval(()=>{var lt,mt,at;if(tt=speechSynthesis.getVoices(),tt.length>0){clearInterval(bt);const Je=((lt=tt==null?void 0:tt.filter(_t=>{var gl,_l,pl,bl;return _t.voiceURI===(((_l=(gl=s==null?void 0:s.audio)==null?void 0:gl.tts)==null?void 0:_l.voice)??((bl=(pl=r==null?void 0:r.audio)==null?void 0:pl.tts)==null?void 0:bl.voice))}))==null?void 0:lt.at(0))??void 0,gt=new SpeechSynthesisUtterance(z);gt.rate=((at=(mt=s.audio)==null?void 0:mt.tts)==null?void 0:at.playbackRate)??1,gt.onend=()=>{var _t;t(25,ve=!1),s.conversationMode&&((_t=document.getElementById("voice-input-button"))==null||_t.click())},Je&&(gt.voice=Je),speechSynthesis.speak(gt)}},100)}else{t(26,we=!0);const tt=li(z,((De=(Be=r==null?void 0:r.audio)==null?void 0:Be.tts)==null?void 0:De.split_on)??"punctuation");if(!tt.length){qe.info(o.t("No content to speak")),t(25,ve=!1),t(26,we=!1);return}Ee=tt.reduce((lt,mt,at)=>(lt[at]=null,lt),{});let bt=Promise.resolve();if(((rt=(Ae=s.audio)==null?void 0:Ae.tts)==null?void 0:rt.engine)==="browser-kokoro"){i||(await yl.set(new fo({dtype:((ht=(Pt=(it=s.audio)==null?void 0:it.tts)==null?void 0:Pt.engineConfig)==null?void 0:ht.dtype)??"fp32"})),await i.init());for(const[lt,mt]of tt.entries()){const at=await i.generate({text:mt,voice:((Ue=(yt=s==null?void 0:s.audio)==null?void 0:yt.tts)==null?void 0:Ue.voice)??((ct=($e=r==null?void 0:r.audio)==null?void 0:$e.tts)==null?void 0:ct.voice)}).catch(Je=>{console.error(Je),qe.error(`${Je}`),t(25,ve=!1),t(26,we=!1)});if(at){const Je=new Audio(at);Je.playbackRate=((Lt=(Mt=s.audio)==null?void 0:Mt.tts)==null?void 0:Lt.playbackRate)??1,Ee[lt]=Je,t(26,we=!1),bt=bt.then(()=>ne(lt))}}}else for(const[lt,mt]of tt.entries()){const at=await ri(localStorage.token,((il=(rl=s==null?void 0:s.audio)==null?void 0:rl.tts)==null?void 0:il.defaultVoice)===r.audio.tts.voice?((ol=(al=s==null?void 0:s.audio)==null?void 0:al.tts)==null?void 0:ol.voice)??((ul=(fl=r==null?void 0:r.audio)==null?void 0:fl.tts)==null?void 0:ul.voice):(dl=(cl=r==null?void 0:r.audio)==null?void 0:cl.tts)==null?void 0:dl.voice,mt).catch(Je=>{console.error(Je),qe.error(`${Je}`),t(25,ve=!1),t(26,we=!1)});if(at){const Je=await at.blob(),gt=URL.createObjectURL(Je),_t=new Audio(gt);_t.playbackRate=((ml=(hl=s.audio)==null?void 0:hl.tts)==null?void 0:ml.playbackRate)??1,Ee[lt]=_t,t(26,we=!1),bt=bt.then(()=>ne(lt))}}}};let ye=[];function W(z){const Be=[];let De=0;return z=z.replace(/<details[\s\S]*?<\/details>/gi,Ae=>(Be.push(Ae),`<details id="__DETAIL_${De++}__"/>`)),ye=Be,z}function de(z){return z.replace(/<details id="__DETAIL_(\d+)__"\/>/g,(De,Ae)=>ye[parseInt(Ae)]||"")}const Ie=async()=>{t(18,ge=!0),t(22,se=W(v.content)),await Oe(),t(23,fe.style.height="",fe),t(23,fe.style.height=`${fe.scrollHeight}px`,fe)},Ve=async()=>{const z=de(se||"");C(v.id,{content:z},!1),t(18,ge=!1),t(22,se=""),await Oe()},je=async()=>{const z=de(se||"");C(v.id,{content:z}),t(18,ge=!1),t(22,se=""),await Oe()},Le=async()=>{t(18,ge=!1),t(22,se=""),await Oe()},te=async z=>{t(27,ke=!0);const Be=await ii(localStorage.token,z.content).catch(De=>{qe.error(`${De}`)});if(Be){const De=Be.map(Ae=>({type:"image",url:`${Ae.url}`}));V(z.id,{...z,files:De})}t(27,ke=!1)};let Xe=!1;const Ye=async(z=null,Be=null)=>{var yt;t(29,Xe=!0);const De={...v,annotation:{...(v==null?void 0:v.annotation)??{},...z!==null?{rating:z}:{},...Be||{}}},Ae=await xr(localStorage.token,g).catch(Ue=>{qe.error(`${Ue}`)});if(!Ae)return;const rt=Qt(m,v.id);let it={type:"rating",data:{...De!=null&&De.annotation?De.annotation:{},model_id:(v==null?void 0:v.selectedModelId)??v.model,...m.messages[v.parentId].childrenIds.length>1?{sibling_model_ids:m.messages[v.parentId].childrenIds.filter(Ue=>Ue!==v.id).map(Ue=>{var $e;return(($e=m.messages[Ue])==null?void 0:$e.selectedModelId)??m.messages[Ue].model})}:{}},meta:{arena:v?v.arena:!1,model_id:v.model,message_id:v.id,message_index:rt.length,chat_id:g},snapshot:{chat:Ae}};const Pt=[it.data.model_id,...it.data.sibling_model_ids??[]].reduce((Ue,$e)=>{var Mt;const ct=l.find(Lt=>Lt.id===$e);return ct?Ue[ct.id]=((Mt=ct==null?void 0:ct.info)==null?void 0:Mt.base_model_id)??null:console.warn(`Model with ID ${$e} not found`),Ue},{});it.meta.base_models=Pt;let ht=null;if(v!=null&&v.feedbackId?ht=await Tl(localStorage.token,v.feedbackId,it).catch(Ue=>{qe.error(`${Ue}`)}):(ht=await si(localStorage.token,it).catch(Ue=>{qe.error(`${Ue}`)}),ht&&(De.feedbackId=ht.id)),V(v.id,De),await Oe(),!Be&&(t(28,R=!0),!((yt=De.annotation)!=null&&yt.tags))){const Ue=await ni(localStorage.token,v.model,rt,g).catch($e=>(console.error($e),[]));Ue&&(De.annotation.tags=Ue,it.data.tags=Ue,V(v.id,De),await Tl(localStorage.token,De.feedbackId,it).catch($e=>{qe.error(`${$e}`)}))}t(29,Xe=!1)},Ke=async()=>{G(v.id)};It(async()=>{await Oe(),me&&me.addEventListener("wheel",function(z){me.scrollWidth<=me.clientWidth||(z.preventDefault(),z.deltaY!==0&&t(19,me.scrollLeft+=z.deltaY,me))})});function nt(z){re=z,t(20,re)}const dt=()=>{Ke()};function ut(z){We[z?"unshift":"push"](()=>{fe=z,t(23,fe)})}function St(){se=this.value,t(22,se)}const Bt=z=>{var Ae,rt;z.key==="Escape"&&((Ae=document.getElementById("close-edit-message-button"))==null||Ae.click());const Be=z.metaKey||z.ctrlKey,De=z.key==="Enter";Be&&De&&((rt=document.getElementById("confirm-edit-message-button"))==null||rt.click())},Ot=()=>{je()},Rt=()=>{Le()},mr=()=>{Ve()},gr=async z=>{},_r=async(z,Be)=>{let De=document.getElementById(`source-${v.id}-${Be}`);const Ae=document.getElementById(`collapsible-${v.id}`);De?De.click():Ae&&(Ae.querySelector("div:first-child").dispatchEvent(new PointerEvent("pointerup",{})),await new Promise(rt=>{requestAnimationFrame(()=>{requestAnimationFrame(rt)})}),De=document.getElementById(`source-${v.id}-${Be}`),De&&De.click())},pr=({modelId:z,parentId:Be,messages:De})=>{le({modelId:z,parentId:Be,messages:De})},br=({raw:z,oldContent:Be,newContent:De})=>{t(0,m.messages[v.id].content=m.messages[v.id].content.replace(z,z.replace(Be,De)),m),w()},vr=()=>{L(v)},kr=z=>{P(v,z.target.value-1),t(24,Me=!1)},wr=z=>{z.key==="Enter"&&(P(v,z.target.value-1),t(24,Me=!1))},Ir=async()=>{t(24,Me=!0),await Oe();const z=document.getElementById(`message-index-input-${v.id}`);z&&(z.focus(),z.select())},yr=()=>{S(v)},Mr=()=>{Ie()},Er=()=>{K(v.content)},Nr=()=>{we||be()},Dr=()=>{ke||te(v)},Tr=()=>{},Cr=async()=>{await Ye(1),window.setTimeout(()=>{var z;(z=document.getElementById(`message-feedback-${v.id}`))==null||z.scrollIntoView()},0)},Vr=async()=>{await Ye(-1),window.setTimeout(()=>{var z;(z=document.getElementById(`message-feedback-${v.id}`))==null||z.scrollIntoView()},0)},Sr=()=>{j()},Br=()=>{t(28,R=!1),ue(v),((ie==null?void 0:ie.actions)??[]).forEach(z=>{d("action",{id:z.id,event:{id:"regenerate-response",data:{messageId:v.id}}})})},Or=(z=null)=>{t(28,R=!1),ue(v,z),((ie==null?void 0:ie.actions)??[]).forEach(Be=>{d("action",{id:Be.id,event:{id:"regenerate-response",data:{messageId:v.id}}})})},Rr=()=>{t(28,R=!1),ue(v),((ie==null?void 0:ie.actions)??[]).forEach(z=>{d("action",{id:z.id,event:{id:"regenerate-response",data:{messageId:v.id}}})})},Pr=()=>{t(20,re=!0)},Lr=z=>{B(z.id,v)};function jr(z){We[z?"unshift":"push"](()=>{me=z,t(19,me)})}function Ar(z){v=z,t(17,v),t(0,m),t(46,_)}function Hr(z){R=z,t(28,R)}const zr=async z=>{await Ye(null,{...z.detail})},Ur=z=>{(s==null?void 0:s.insertFollowUpPrompt)??!1?T(z):U(v==null?void 0:v.id,z)};return n.$$set=z=>{"chatId"in z&&t(1,g=z.chatId),"history"in z&&t(0,m=z.history),"messageId"in z&&t(46,_=z.messageId),"selectedModels"in z&&t(2,D=z.selectedModels),"siblings"in z&&t(3,M=z.siblings),"setInputText"in z&&t(4,T=z.setInputText),"gotoMessage"in z&&t(5,P=z.gotoMessage),"showPreviousMessage"in z&&t(6,L=z.showPreviousMessage),"showNextMessage"in z&&t(7,S=z.showNextMessage),"updateChat"in z&&t(8,w=z.updateChat),"editMessage"in z&&t(47,C=z.editMessage),"saveMessage"in z&&t(48,V=z.saveMessage),"rateMessage"in z&&t(49,O=z.rateMessage),"actionMessage"in z&&t(9,B=z.actionMessage),"deleteMessage"in z&&t(50,G=z.deleteMessage),"submitMessage"in z&&t(10,U=z.submitMessage),"continueResponse"in z&&t(11,j=z.continueResponse),"regenerateResponse"in z&&t(12,ue=z.regenerateResponse),"addMessages"in z&&t(13,le=z.addMessages),"isLastMessage"in z&&t(14,he=z.isLastMessage),"readOnly"in z&&t(15,J=z.readOnly),"topPadding"in z&&t(16,oe=z.topPadding)},n.$$.update=()=>{n.$$.dirty[0]&131073|n.$$.dirty[1]&32768&&m.messages&&JSON.stringify(v)!==JSON.stringify(m.messages[_])&&t(17,v=JSON.parse(JSON.stringify(m.messages[_]))),n.$$.dirty[0]&131072|n.$$.dirty[1]&1048576&&t(21,ie=l.find(z=>z.id===v.model)),n.$$.dirty[0]&262144&&(ge||(async()=>await Oe())())},[m,g,D,M,T,P,L,S,w,B,U,j,ue,le,he,J,oe,v,ge,me,re,ie,se,fe,Me,ve,we,ke,R,Xe,s,r,o,a,f,u,d,K,be,Ie,Ve,je,Le,te,Ye,Ke,_,C,V,O,G,l,nt,dt,ut,St,Bt,Ot,Rt,mr,gr,_r,pr,br,vr,kr,wr,Ir,yr,Mr,Er,Nr,Dr,Tr,Cr,Vr,Sr,Br,Or,Rr,Pr,Lr,jr,Ar,Hr,zr,Ur]}class nl extends He{constructor(e){super(),ze(this,e,Cf,Nf,Re,{chatId:1,history:0,messageId:46,selectedModels:2,siblings:3,setInputText:4,gotoMessage:5,showPreviousMessage:6,showNextMessage:7,updateChat:8,editMessage:47,saveMessage:48,rateMessage:49,actionMessage:9,deleteMessage:50,submitMessage:10,continueResponse:11,regenerateResponse:12,addMessages:13,isLastMessage:14,readOnly:15,topPadding:16},null,[-1,-1,-1,-1])}}function Vf(n){let e,t;return{c(){e=_e("svg"),t=_e("path"),this.h()},l(l){e=pe(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=k(e);t=pe(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(t).forEach(h),s.forEach(h),this.h()},h(){c(t,"stroke-linecap","round"),c(t,"stroke-linejoin","round"),c(t,"d","M8 8v8m0-8a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm0 8a2 2 0 1 0 0 4 2 2 0 0 0 0-4Zm6-2a2 2 0 1 1 4 0 2 2 0 0 1-4 0Zm0 0h-1a5 5 0 0 1-5-5v-.5"),c(e,"xmlns","http://www.w3.org/2000/svg"),c(e,"fill","none"),c(e,"viewBox","0 0 24 24"),c(e,"stroke-width",n[1]),c(e,"stroke","currentColor"),c(e,"class",n[0])},m(l,s){I(l,e,s),p(e,t)},p(l,[s]){s&2&&c(e,"stroke-width",l[1]),s&1&&c(e,"class",l[0])},i:Ne,o:Ne,d(l){l&&h(e)}}}function Sf(n,e,t){let{className:l="w-4 h-4"}=e,{strokeWidth:s="1.5"}=e;return n.$$set=r=>{"className"in r&&t(0,l=r.className),"strokeWidth"in r&&t(1,s=r.strokeWidth)},[l,s]}class Bf extends He{constructor(e){super(),ze(this,e,Sf,Vf,Re,{className:0,strokeWidth:1})}}function Gt(n){var l;const e=n.slice(),t=(l=e[0].messages[e[2]])==null?void 0:l.merged;return e[18]=t,e}function ln(n,e,t){const l=n.slice();return l[52]=e[t],l}function Jt(n){const e=n.slice(),t=e[20][e[52]].messageIds[e[21][e[52]]];return e[51]=t,e}function Kt(n){const e=n.slice(),t=e[20][e[22]].messageIds[e[21][e[22]]];return e[51]=t,e}function sn(n,e,t){const l=n.slice();return l[52]=e[t],l}function Zt(n){const e=n.slice(),t=e[20][e[52]].messageIds[e[21][e[52]]];e[51]=t;const l=e[24].find(function(...r){return n[36](e[51],...r)});return e[55]=l,e}function nn(n){let e,t,l,s,r,i,o;const a=[Rf,Of],f=[];function u(g,m){var _;return((_=g[23])==null?void 0:_.displayMultiModelResponsesInTabs)??!1?0:1}l=u(n),s=f[l]=a[l](n);let d=!n[5]&&gn(n);return{c(){e=E("div"),t=E("div"),s.c(),i=A(),d&&d.c(),this.h()},l(g){e=N(g,"DIV",{});var m=k(e);t=N(m,"DIV",{class:!0,id:!0});var _=k(t);s.l(_),_.forEach(h),i=H(m),d&&d.l(m),m.forEach(h),this.h()},h(){c(t,"class","flex snap-x snap-mandatory overflow-x-auto scrollbar-hidden"),c(t,"id",r="responses-container-"+n[1]+"-"+n[19].id)},m(g,m){I(g,e,m),p(e,t),f[l].m(t,null),p(e,i),d&&d.m(e,null),o=!0},p(g,m){let _=l;l=u(g),l===_?f[l].p(g,m):(x(),y(f[_],1,1,()=>{f[_]=null}),ee(),s=f[l],s?s.p(g,m):(s=f[l]=a[l](g),s.c()),b(s,1),s.m(t,null)),(!o||m[0]&524290&&r!==(r="responses-container-"+g[1]+"-"+g[19].id))&&c(t,"id",r),g[5]?d&&(x(),y(d,1,1,()=>{d=null}),ee()):d?(d.p(g,m),m[0]&32&&b(d,1)):(d=gn(g),d.c(),b(d,1),d.m(e,null))},i(g){o||(b(s),b(d),o=!0)},o(g){y(s),y(d),o=!1},d(g){g&&h(e),f[l].d(),d&&d.d()}}}function Of(n){let e,t,l=Ce(Object.keys(n[20])),s=[];for(let i=0;i<l.length;i+=1)s[i]=fn(ln(n,l,i));const r=i=>y(s[i],1,1,()=>{s[i]=null});return{c(){for(let i=0;i<s.length;i+=1)s[i].c();e=ae()},l(i){for(let o=0;o<s.length;o+=1)s[o].l(i);e=ae()},m(i,o){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(i,o);I(i,e,o),t=!0},p(i,o){if(o[0]&1916272623|o[1]&1){l=Ce(Object.keys(i[20]));let a;for(a=0;a<l.length;a+=1){const f=ln(i,l,a);s[a]?(s[a].p(f,o),b(s[a],1)):(s[a]=fn(f),s[a].c(),b(s[a],1),s[a].m(e.parentNode,e))}for(x(),a=l.length;a<s.length;a+=1)r(a);ee()}},i(i){if(!t){for(let o=0;o<l.length;o+=1)b(s[o]);t=!0}},o(i){s=s.filter(Boolean);for(let o=0;o<s.length;o+=1)y(s[o]);t=!1},d(i){i&&h(e),Fe(s,i)}}}function Rf(n){let e,t,l,s,r,i=Ce(Object.keys(n[20])),o=[];for(let f=0;f<i.length;f+=1)o[f]=cn(sn(n,i,f));let a=n[22]!==null&&dn(Kt(n));return{c(){e=E("div"),t=E("div"),l=E("div");for(let f=0;f<o.length;f+=1)o[f].c();s=A(),a&&a.c(),this.h()},l(f){e=N(f,"DIV",{class:!0});var u=k(e);t=N(u,"DIV",{class:!0});var d=k(t);l=N(d,"DIV",{class:!0});var g=k(l);for(let m=0;m<o.length;m+=1)o[m].l(g);g.forEach(h),d.forEach(h),s=H(u),a&&a.l(u),u.forEach(h),this.h()},h(){c(l,"class","flex gap-2 scrollbar-none overflow-x-auto w-fit text-center font-medium bg-transparent pt-1 text-sm"),c(t,"class","flex w-full mb-4.5 border-b border-gray-200 dark:border-gray-850"),c(e,"class","w-full")},m(f,u){I(f,e,u),p(e,t),p(t,l);for(let d=0;d<o.length;d+=1)o[d]&&o[d].m(l,null);p(e,s),a&&a.m(e,null),r=!0},p(f,u){if(u[0]&24117249|u[1]&1){i=Ce(Object.keys(f[20]));let d;for(d=0;d<i.length;d+=1){const g=sn(f,i,d);o[d]?o[d].p(g,u):(o[d]=cn(g),o[d].c(),o[d].m(l,null))}for(;d<o.length;d+=1)o[d].d(1);o.length=i.length}f[22]!==null?a?(a.p(Kt(f),u),u[0]&4194304&&b(a,1)):(a=dn(Kt(f)),a.c(),b(a,1),a.m(e,null)):a&&(x(),y(a,1,1,()=>{a=null}),ee())},i(f){r||(b(a),r=!0)},o(f){y(a),r=!1},d(f){f&&h(e),Fe(o,f),a&&a.d()}}}function rn(n){let e,t=n[0].currentId,l,s,r,i,o,a=on(n);function f(){return n[46](n[51],n[52])}return{c(){e=E("div"),a.c(),l=A(),this.h()},l(u){e=N(u,"DIV",{class:!0});var d=k(e);a.l(d),l=H(d),d.forEach(h),this.h()},h(){var u;c(e,"class",s="snap-center w-full max-w-full m-1 border "+(((u=n[0].messages[n[2]])==null?void 0:u.modelIdx)==n[52]?`bg-gray-50 dark:bg-gray-850 border-gray-100 dark:border-gray-800 border-2 ${n[25]?"min-w-full":"min-w-80"}`:`border-gray-100 dark:border-gray-850 border-dashed ${n[25]?"min-w-full":"min-w-80"}`)+" transition-all p-5 rounded-2xl")},m(u,d){I(u,e,d),a.m(e,null),p(e,l),r=!0,i||(o=ce(e,"click",f),i=!0)},p(u,d){var g;n=u,d[0]&1&&Re(t,t=n[0].currentId)?(x(),y(a,1,1,Ne),ee(),a=on(n),a.c(),b(a,1),a.m(e,l)):a.p(n,d),(!r||d[0]&34603013&&s!==(s="snap-center w-full max-w-full m-1 border "+(((g=n[0].messages[n[2]])==null?void 0:g.modelIdx)==n[52]?`bg-gray-50 dark:bg-gray-850 border-gray-100 dark:border-gray-800 border-2 ${n[25]?"min-w-full":"min-w-80"}`:`border-gray-100 dark:border-gray-850 border-dashed ${n[25]?"min-w-full":"min-w-80"}`)+" transition-all p-5 rounded-2xl"))&&c(e,"class",s)},i(u){r||(b(a),r=!0)},o(u){y(a),r=!1},d(u){u&&h(e),a.d(u),i=!1,o()}}}function an(n){let e,t;function l(...o){return n[42](n[52],...o)}function s(){return n[43](n[52])}function r(){return n[44](n[52])}function i(...o){return n[45](n[52],...o)}return e=new nl({props:{chatId:n[1],history:n[0],messageId:n[51],selectedModels:n[3],isLastMessage:!0,siblings:n[20][n[52]].messageIds,gotoMessage:l,showPreviousMessage:s,showNextMessage:r,setInputText:n[6],updateChat:n[7],editMessage:n[8],saveMessage:n[9],rateMessage:n[10],deleteMessage:n[13],actionMessage:n[11],submitMessage:n[12],continueResponse:n[14],regenerateResponse:i,addMessages:n[16],readOnly:n[5],topPadding:n[17]}}),{c(){Q(e.$$.fragment)},l(o){$(e.$$.fragment,o)},m(o,a){X(e,o,a),t=!0},p(o,a){n=o;const f={};a[0]&2&&(f.chatId=n[1]),a[0]&1&&(f.history=n[0]),a[0]&3145728&&(f.messageId=n[51]),a[0]&8&&(f.selectedModels=n[3]),a[0]&1048576&&(f.siblings=n[20][n[52]].messageIds),a[0]&1048576&&(f.gotoMessage=l),a[0]&1048576&&(f.showPreviousMessage=s),a[0]&1048576&&(f.showNextMessage=r),a[0]&64&&(f.setInputText=n[6]),a[0]&128&&(f.updateChat=n[7]),a[0]&256&&(f.editMessage=n[8]),a[0]&512&&(f.saveMessage=n[9]),a[0]&1024&&(f.rateMessage=n[10]),a[0]&8192&&(f.deleteMessage=n[13]),a[0]&2048&&(f.actionMessage=n[11]),a[0]&4096&&(f.submitMessage=n[12]),a[0]&16384&&(f.continueResponse=n[14]),a[0]&3178496&&(f.regenerateResponse=i),a[0]&65536&&(f.addMessages=n[16]),a[0]&32&&(f.readOnly=n[5]),a[0]&131072&&(f.topPadding=n[17]),e.$set(f)},i(o){t||(b(e.$$.fragment,o),t=!0)},o(o){y(e.$$.fragment,o),t=!1},d(o){Y(e,o)}}}function on(n){let e,t,l=n[18]&&an(n);return{c(){l&&l.c(),e=ae()},l(s){l&&l.l(s),e=ae()},m(s,r){l&&l.m(s,r),I(s,e,r),t=!0},p(s,r){s[18]?l?(l.p(s,r),r[0]&262144&&b(l,1)):(l=an(s),l.c(),b(l,1),l.m(e.parentNode,e)):l&&(x(),y(l,1,1,()=>{l=null}),ee())},i(s){t||(b(l),t=!0)},o(s){y(l),t=!1},d(s){s&&h(e),l&&l.d(s)}}}function fn(n){let e,t,l=n[21][n[52]]!==void 0&&n[20][n[52]].messageIds.length>0&&rn(Jt(n));return{c(){l&&l.c(),e=ae()},l(s){l&&l.l(s),e=ae()},m(s,r){l&&l.m(s,r),I(s,e,r),t=!0},p(s,r){s[21][s[52]]!==void 0&&s[20][s[52]].messageIds.length>0?l?(l.p(Jt(s),r),r[0]&3145728&&b(l,1)):(l=rn(Jt(s)),l.c(),b(l,1),l.m(e.parentNode,e)):l&&(x(),y(l,1,1,()=>{l=null}),ee())},i(s){t||(b(l),t=!0)},o(s){y(l),t=!1},d(s){s&&h(e),l&&l.d(s)}}}function un(n){var d;let e,t,l,s=(n[55]?`${n[55].name}`:(d=n[0].messages[n[51]])==null?void 0:d.model)+"",r,i,o,a,f;function u(){return n[37](n[52],n[51])}return{c(){e=E("button"),t=E("div"),l=E("div"),r=q(s),i=A(),this.h()},l(g){e=N(g,"BUTTON",{class:!0});var m=k(e);t=N(m,"DIV",{class:!0});var _=k(t);l=N(_,"DIV",{class:!0});var D=k(l);r=F(D,s),D.forEach(h),_.forEach(h),i=H(m),m.forEach(h),this.h()},h(){c(l,"class","-translate-y-[1px]"),c(t,"class","flex items-center gap-1.5"),c(e,"class",o="min-w-fit "+(n[22]==n[52]?" dark:border-gray-300 ":" opacity-35 border-transparent")+" pb-1.5 px-2.5 transition border-b-2")},m(g,m){I(g,e,m),p(e,t),p(t,l),p(l,r),p(e,i),a||(f=ce(e,"click",u),a=!0)},p(g,m){var _;n=g,m[0]&19922945&&s!==(s=(n[55]?`${n[55].name}`:(_=n[0].messages[n[51]])==null?void 0:_.model)+"")&&Z(r,s),m[0]&5242880&&o!==(o="min-w-fit "+(n[22]==n[52]?" dark:border-gray-300 ":" opacity-35 border-transparent")+" pb-1.5 px-2.5 transition border-b-2")&&c(e,"class",o)},d(g){g&&h(e),a=!1,f()}}}function cn(n){let e,t=n[21][n[52]]!==void 0&&n[20][n[52]].messageIds.length>0&&un(Zt(n));return{c(){t&&t.c(),e=ae()},l(l){t&&t.l(l),e=ae()},m(l,s){t&&t.m(l,s),I(l,e,s)},p(l,s){l[21][l[52]]!==void 0&&l[20][l[52]].messageIds.length>0?t?t.p(Zt(l),s):(t=un(Zt(l)),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(l){l&&h(e),t&&t.d(l)}}}function dn(n){let e=n[0].currentId,t,l,s=mn(n);return{c(){s.c(),t=ae()},l(r){s.l(r),t=ae()},m(r,i){s.m(r,i),I(r,t,i),l=!0},p(r,i){i[0]&1&&Re(e,e=r[0].currentId)?(x(),y(s,1,1,Ne),ee(),s=mn(r),s.c(),b(s,1),s.m(t.parentNode,t)):s.p(r,i)},i(r){l||(b(s),l=!0)},o(r){y(s),l=!1},d(r){r&&h(t),s.d(r)}}}function hn(n){let e,t;return e=new nl({props:{chatId:n[1],history:n[0],messageId:n[51],selectedModels:n[3],isLastMessage:!0,siblings:n[20][n[22]].messageIds,gotoMessage:n[38],showPreviousMessage:n[39],showNextMessage:n[40],setInputText:n[6],updateChat:n[7],editMessage:n[8],saveMessage:n[9],rateMessage:n[10],deleteMessage:n[13],actionMessage:n[11],submitMessage:n[12],continueResponse:n[14],regenerateResponse:n[41],addMessages:n[16],readOnly:n[5],topPadding:n[17]}}),{c(){Q(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},p(l,s){const r={};s[0]&2&&(r.chatId=l[1]),s[0]&1&&(r.history=l[0]),s[0]&7340032&&(r.messageId=l[51]),s[0]&8&&(r.selectedModels=l[3]),s[0]&5242880&&(r.siblings=l[20][l[22]].messageIds),s[0]&4194304&&(r.gotoMessage=l[38]),s[0]&4194304&&(r.showPreviousMessage=l[39]),s[0]&4194304&&(r.showNextMessage=l[40]),s[0]&64&&(r.setInputText=l[6]),s[0]&128&&(r.updateChat=l[7]),s[0]&256&&(r.editMessage=l[8]),s[0]&512&&(r.saveMessage=l[9]),s[0]&1024&&(r.rateMessage=l[10]),s[0]&8192&&(r.deleteMessage=l[13]),s[0]&2048&&(r.actionMessage=l[11]),s[0]&4096&&(r.submitMessage=l[12]),s[0]&16384&&(r.continueResponse=l[14]),s[0]&7372800&&(r.regenerateResponse=l[41]),s[0]&65536&&(r.addMessages=l[16]),s[0]&32&&(r.readOnly=l[5]),s[0]&131072&&(r.topPadding=l[17]),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){y(e.$$.fragment,l),t=!1},d(l){Y(e,l)}}}function mn(n){let e,t,l=n[18]&&hn(n);return{c(){l&&l.c(),e=ae()},l(s){l&&l.l(s),e=ae()},m(s,r){l&&l.m(s,r),I(s,e,r),t=!0},p(s,r){s[18]?l?(l.p(s,r),r[0]&262144&&b(l,1)):(l=hn(s),l.c(),b(l,1),l.m(e.parentNode,e)):l&&(x(),y(l,1,1,()=>{l=null}),ee())},i(s){t||(b(l),t=!0)},o(s){y(l),t=!1},d(s){s&&h(e),l&&l.d(s)}}}function gn(n){let e=!Object.keys(n[20]).find(n[35]),t,l,s=e&&_n(n);return{c(){s&&s.c(),t=ae()},l(r){s&&s.l(r),t=ae()},m(r,i){s&&s.m(r,i),I(r,t,i),l=!0},p(r,i){i[0]&3145729&&(e=!Object.keys(r[20]).find(r[35])),e?s?(s.p(r,i),i[0]&3145729&&b(s,1)):(s=_n(r),s.c(),b(s,1),s.m(t.parentNode,t)):s&&(x(),y(s,1,1,()=>{s=null}),ee())},i(r){l||(b(s),l=!0)},o(r){y(s),l=!1},d(r){r&&h(t),s&&s.d(r)}}}function _n(n){var o,a;let e,t,l,s,r=((a=(o=n[0].messages[n[2]])==null?void 0:o.merged)==null?void 0:a.status)&&pn(Gt(n)),i=n[4]&&vn(n);return{c(){e=E("div"),t=E("div"),r&&r.c(),l=A(),i&&i.c(),this.h()},l(f){e=N(f,"DIV",{class:!0});var u=k(e);t=N(u,"DIV",{class:!0});var d=k(t);r&&r.l(d),d.forEach(h),l=H(u),i&&i.l(u),u.forEach(h),this.h()},h(){c(t,"class","w-full"),c(e,"class","flex justify-end")},m(f,u){I(f,e,u),p(e,t),r&&r.m(t,null),p(e,l),i&&i.m(e,null),s=!0},p(f,u){var d,g;(g=(d=f[0].messages[f[2]])==null?void 0:d.merged)!=null&&g.status?r?(r.p(Gt(f),u),u[0]&5&&b(r,1)):(r=pn(Gt(f)),r.c(),b(r,1),r.m(t,null)):r&&(x(),y(r,1,1,()=>{r=null}),ee()),f[4]?i?(i.p(f,u),u[0]&16&&b(i,1)):(i=vn(f),i.c(),b(i,1),i.m(e,null)):i&&(x(),y(i,1,1,()=>{i=null}),ee())},i(f){s||(b(r),b(i),s=!0)},o(f){y(r),y(i),s=!1},d(f){f&&h(e),r&&r.d(),i&&i.d()}}}function pn(n){let e,t,l,s,r,i,o;t=new $t({props:{$$slots:{default:[Pf]},$$scope:{ctx:n}}});const a=[jf,Lf],f=[];function u(d,g){var m;return(((m=d[18])==null?void 0:m.content)??"")===""?0:1}return r=u(n),i=f[r]=a[r](n),{c(){e=E("div"),Q(t.$$.fragment),l=A(),s=E("div"),i.c(),this.h()},l(d){e=N(d,"DIV",{class:!0});var g=k(e);$(t.$$.fragment,g),l=H(g),s=N(g,"DIV",{class:!0});var m=k(s);i.l(m),m.forEach(h),g.forEach(h),this.h()},h(){c(s,"class","mt-1 markdown-prose w-full min-w-full"),c(e,"class","w-full rounded-xl pl-5 pr-2 py-2 mt-2")},m(d,g){I(d,e,g),X(t,e,null),p(e,l),p(e,s),f[r].m(s,null),o=!0},p(d,g){const m={};g[0]&67108869|g[1]&134217728&&(m.$$scope={dirty:g,ctx:d}),t.$set(m);let _=r;r=u(d),r===_?f[r].p(d,g):(x(),y(f[_],1,1,()=>{f[_]=null}),ee(),i=f[r],i?i.p(d,g):(i=f[r]=a[r](d),i.c()),b(i,1),i.m(s,null))},i(d){o||(b(t.$$.fragment,d),b(i),o=!0)},o(d){y(t.$$.fragment,d),y(i),o=!1},d(d){d&&h(e),Y(t),f[r].d()}}}function bn(n){let e,t=ft(n[18].timestamp*1e3).format("LT")+"",l;return{c(){e=E("span"),l=q(t),this.h()},l(s){e=N(s,"SPAN",{class:!0});var r=k(e);l=F(r,t),r.forEach(h),this.h()},h(){c(e,"class","self-center invisible group-hover:visible text-gray-400 text-xs font-medium uppercase ml-0.5 -mt-0.5")},m(s,r){I(s,e,r),p(e,l)},p(s,r){r[0]&5&&t!==(t=ft(s[18].timestamp*1e3).format("LT")+"")&&Z(l,t)},d(s){s&&h(e)}}}function Pf(n){let e=n[26].t("Merged Response")+"",t,l,s,r=n[18].timestamp&&bn(n);return{c(){t=q(e),l=A(),r&&r.c(),s=ae()},l(i){t=F(i,e),l=H(i),r&&r.l(i),s=ae()},m(i,o){I(i,t,o),I(i,l,o),r&&r.m(i,o),I(i,s,o)},p(i,o){o[0]&67108864&&e!==(e=i[26].t("Merged Response")+"")&&Z(t,e),i[18].timestamp?r?r.p(i,o):(r=bn(i),r.c(),r.m(s.parentNode,s)):r&&(r.d(1),r=null)},d(i){i&&(h(t),h(l),h(s)),r&&r.d(i)}}}function Lf(n){let e,t;return e=new Vt({props:{id:"merged",content:n[18].content??""}}),{c(){Q(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},p(l,s){const r={};s[0]&5&&(r.content=l[18].content??""),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){y(e.$$.fragment,l),t=!1},d(l){Y(e,l)}}}function jf(n){let e,t;return e=new xt({}),{c(){Q(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},p:Ne,i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){y(e.$$.fragment,l),t=!1},d(l){Y(e,l)}}}function vn(n){let e,t,l;return t=new Pe({props:{content:n[26].t("Merge Responses"),placement:"bottom",$$slots:{default:[Af]},$$scope:{ctx:n}}}),{c(){e=E("div"),Q(t.$$.fragment),this.h()},l(s){e=N(s,"DIV",{class:!0});var r=k(e);$(t.$$.fragment,r),r.forEach(h),this.h()},h(){c(e,"class","shrink-0 text-gray-600 dark:text-gray-500 mt-1")},m(s,r){I(s,e,r),X(t,e,null),l=!0},p(s,r){const i={};r[0]&67108864&&(i.content=s[26].t("Merge Responses")),r[1]&134217728&&(i.$$scope={dirty:r,ctx:s}),t.$set(i)},i(s){l||(b(t.$$.fragment,s),l=!0)},o(s){y(t.$$.fragment,s),l=!1},d(s){s&&h(e),Y(t)}}}function Af(n){let e,t,l,s,r;return t=new Bf({props:{className:" size-5 "}}),{c(){e=E("button"),Q(t.$$.fragment),this.h()},l(i){e=N(i,"BUTTON",{type:!0,id:!0,class:!0});var o=k(e);$(t.$$.fragment,o),o.forEach(h),this.h()},h(){c(e,"type","button"),c(e,"id","merge-response-button"),c(e,"class","visible p-1 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(i,o){I(i,e,o),X(t,e,null),l=!0,s||(r=ce(e,"click",n[47]),s=!0)},p:Ne,i(i){l||(b(t.$$.fragment,i),l=!0)},o(i){y(t.$$.fragment,i),l=!1},d(i){i&&h(e),Y(t),s=!1,r()}}}function Hf(n){let e,t,l=n[19]&&nn(n);return{c(){l&&l.c(),e=ae()},l(s){l&&l.l(s),e=ae()},m(s,r){l&&l.m(s,r),I(s,e,r),t=!0},p(s,r){s[19]?l?(l.p(s,r),r[0]&524288&&b(l,1)):(l=nn(s),l.c(),b(l,1),l.m(e.parentNode,e)):l&&(x(),y(l,1,1,()=>{l=null}),ee())},i(s){t||(b(l),t=!0)},o(s){y(l),t=!1},d(s){s&&h(e),l&&l.d(s)}}}function zf(n,e,t){let l,s,r,i;Te(n,pt,W=>t(23,l=W)),Te(n,Ct,W=>t(24,s=W)),Te(n,nr,W=>t(25,r=W));const o=Ge("i18n");Te(n,o,W=>t(26,i=W)),ft.extend(ar);let{chatId:a}=e,{history:f}=e,{messageId:u}=e,{selectedModels:d=[]}=e,{isLastMessage:g}=e,{readOnly:m=!1}=e,{setInputText:_=()=>{}}=e,{updateChat:D}=e,{editMessage:v}=e,{saveMessage:M}=e,{rateMessage:T}=e,{actionMessage:P}=e,{submitMessage:L}=e,{deleteMessage:S}=e,{continueResponse:w}=e,{regenerateResponse:C}=e,{mergeResponses:V}=e,{addMessages:O}=e,{triggerScroll:B}=e,{topPadding:G=!1}=e;Tt();let U,j={},ue={},le=null,he=JSON.parse(JSON.stringify(f.messages[u]));const J=async(W,de)=>{t(21,ue[W]=Math.max(0,Math.min(de,j[W].messageIds.length-1)),ue);let Ie=j[W].messageIds[ue[W]],Ve=f.messages[Ie].childrenIds;for(;Ve.length!==0;)Ie=Ve.at(-1),Ve=f.messages[Ie].childrenIds;t(0,f.currentId=Ie,f),await Oe(),await D(),B()},oe=async W=>{t(21,ue[W]=Math.max(0,ue[W]-1),ue);let de=j[W].messageIds[ue[W]],Ie=f.messages[de].childrenIds;for(;Ie.length!==0;)de=Ie.at(-1),Ie=f.messages[de].childrenIds;t(0,f.currentId=de,f),await Oe(),await D(),B()},me=async W=>{t(21,ue[W]=Math.min(j[W].messageIds.length-1,ue[W]+1),ue);let de=j[W].messageIds[ue[W]],Ie=f.messages[de].childrenIds;for(;Ie.length!==0;)de=Ie.at(-1),Ie=f.messages[de].childrenIds;t(0,f.currentId=de,f),await Oe(),await D(),B()},re=async()=>{var W;await Oe(),t(19,U=f.messages[u].parentId?f.messages[f.messages[u].parentId]:null),t(20,j=U==null?void 0:U.models.reduce((de,Ie,Ve)=>{let je=U==null?void 0:U.childrenIds.map(Le=>f.messages[Le]).filter(Le=>(Le==null?void 0:Le.modelIdx)===Ve).map(Le=>Le.id);if(je.length===0){let Le=U==null?void 0:U.childrenIds.map(te=>f.messages[te]).filter(te=>(te==null?void 0:te.model)===Ie);Le.forEach(te=>{te.modelIdx=Ve}),je=Le.map(te=>te.id)}return{...de,[Ve]:{messageIds:je}}},{})),t(21,ue=U==null?void 0:U.models.reduce((de,Ie,Ve)=>{const je=j[Ve].messageIds.findIndex(Le=>Le===u);return je!==-1?{...de,[Ve]:je}:{...de,[Ve]:j[Ve].messageIds.length-1}},{})),t(22,le=(W=f.messages[u])==null?void 0:W.modelIdx),await Oe()},ie=async(W,de)=>{if(u!=W){let Ie=W,Ve=f.messages[Ie].childrenIds;for(;Ve.length!==0;)Ie=Ve.at(-1),Ve=f.messages[Ie].childrenIds;t(0,f.currentId=Ie,f),t(22,le=de)}},ge=async()=>{const W=Object.keys(j).map(de=>{const{messageIds:Ie}=j[de],Ve=Ie[ue[de]];return f.messages[Ve].content});V(u,W,a)};It(async()=>{if(await re(),await Oe(),(l==null?void 0:l.scrollOnBranchChange)??!0){const W=document.getElementById(`message-${u}`);W&&W.scrollIntoView({block:"start"})}});const se=W=>{var Ve;const{messageIds:de}=j[W],Ie=de[ue[W]];return!((Ve=f.messages[Ie])!=null&&Ve.done)},fe=(W,de)=>{var Ie;return de.id===((Ie=f.messages[W])==null?void 0:Ie.model)},Me=async(W,de)=>{le!=W&&t(22,le=W),ie(de,W)},Ee=(W,de)=>J(le,de),ve=()=>oe(le),Se=()=>me(le),we=async(W,de=null)=>{C(W,de),await Oe(),t(21,ue[le]=j[le].messageIds.length-1,ue)},ke=(W,de,Ie)=>J(W,Ie),R=W=>oe(W),K=W=>me(W),ne=async(W,de,Ie=null)=>{C(de,Ie),await Oe(),t(21,ue[W]=j[W].messageIds.length-1,ue)},be=async(W,de)=>{ie(W,de)},ye=()=>{ge()};return n.$$set=W=>{"chatId"in W&&t(1,a=W.chatId),"history"in W&&t(0,f=W.history),"messageId"in W&&t(2,u=W.messageId),"selectedModels"in W&&t(3,d=W.selectedModels),"isLastMessage"in W&&t(4,g=W.isLastMessage),"readOnly"in W&&t(5,m=W.readOnly),"setInputText"in W&&t(6,_=W.setInputText),"updateChat"in W&&t(7,D=W.updateChat),"editMessage"in W&&t(8,v=W.editMessage),"saveMessage"in W&&t(9,M=W.saveMessage),"rateMessage"in W&&t(10,T=W.rateMessage),"actionMessage"in W&&t(11,P=W.actionMessage),"submitMessage"in W&&t(12,L=W.submitMessage),"deleteMessage"in W&&t(13,S=W.deleteMessage),"continueResponse"in W&&t(14,w=W.continueResponse),"regenerateResponse"in W&&t(15,C=W.regenerateResponse),"mergeResponses"in W&&t(33,V=W.mergeResponses),"addMessages"in W&&t(16,O=W.addMessages),"triggerScroll"in W&&t(34,B=W.triggerScroll),"topPadding"in W&&t(17,G=W.topPadding)},n.$$.update=()=>{n.$$.dirty[0]&262149&&f.messages&&JSON.stringify(he)!==JSON.stringify(f.messages[u])&&t(18,he=JSON.parse(JSON.stringify(f.messages[u])))},[f,a,u,d,g,m,_,D,v,M,T,P,L,S,w,C,O,G,he,U,j,ue,le,l,s,r,i,o,J,oe,me,ie,ge,V,B,se,fe,Me,Ee,ve,Se,we,ke,R,K,ne,be,ye]}class Uf extends He{constructor(e){super(),ze(this,e,zf,Hf,Re,{chatId:1,history:0,messageId:2,selectedModels:3,isLastMessage:4,readOnly:5,setInputText:6,updateChat:7,editMessage:8,saveMessage:9,rateMessage:10,actionMessage:11,submitMessage:12,deleteMessage:13,continueResponse:14,regenerateResponse:15,mergeResponses:33,addMessages:16,triggerScroll:34,topPadding:17},null,[-1,-1])}}function kn(n,e,t){const l=n.slice();return l[55]=e[t],l[57]=t,l}function wn(n,e,t){const l=n.slice();return l[55]=e[t],l}function In(n){var s,r,i,o;let e,t,l;return t=new or({props:{src:n[9].user?((i=(r=(s=n[18].find(n[32]))==null?void 0:s.info)==null?void 0:r.meta)==null?void 0:i.profile_image_url)??`${xe}/user.png`:((o=n[0])==null?void 0:o.profile_image_url)??`${xe}/user.png`,className:"size-8 user-message-profile-image"}}),{c(){e=E("div"),Q(t.$$.fragment),this.h()},l(a){e=N(a,"DIV",{class:!0});var f=k(e);$(t.$$.fragment,f),f.forEach(h),this.h()},h(){c(e,"class","shrink-0 ltr:mr-3 rtl:ml-3 mt-1")},m(a,f){I(a,e,f),X(t,e,null),l=!0},p(a,f){var d,g,m,_;const u={};f[0]&262657&&(u.src=a[9].user?((m=(g=(d=a[18].find(a[32]))==null?void 0:d.info)==null?void 0:g.meta)==null?void 0:m.profile_image_url)??`${xe}/user.png`:((_=a[0])==null?void 0:_.profile_image_url)??`${xe}/user.png`),t.$set(u)},i(a){l||(b(t.$$.fragment,a),l=!0)},o(a){y(t.$$.fragment,a),l=!1},d(a){a&&h(e),Y(t)}}}function Wf(n){let e,t,l,s;return l=new Pe({props:{content:ft(n[9].timestamp*1e3).format("LLLL"),$$slots:{default:[Ff]},$$scope:{ctx:n}}}),{c(){e=E("div"),t=E("div"),Q(l.$$.fragment),this.h()},l(r){e=N(r,"DIV",{class:!0});var i=k(e);t=N(i,"DIV",{class:!0});var o=k(t);$(l.$$.fragment,o),o.forEach(h),i.forEach(h),this.h()},h(){c(t,"class","text-[0.65rem] invisible group-hover:visible text-gray-400 font-medium first-letter:capitalize mb-0.5"),c(e,"class","flex justify-end pr-2 text-xs")},m(r,i){I(r,e,i),p(e,t),X(l,t,null),s=!0},p(r,i){const o={};i[0]&512&&(o.content=ft(r[9].timestamp*1e3).format("LLLL")),i[0]&512|i[1]&536870912&&(o.$$scope={dirty:i,ctx:r}),l.$set(o)},i(r){s||(b(l.$$.fragment,r),s=!0)},o(r){y(l.$$.fragment,r),s=!1},d(r){r&&h(e),Y(l)}}}function qf(n){let e,t,l;return t=new $t({props:{$$slots:{default:[Qf]},$$scope:{ctx:n}}}),{c(){e=E("div"),Q(t.$$.fragment)},l(s){e=N(s,"DIV",{});var r=k(e);$(t.$$.fragment,r),r.forEach(h)},m(s,r){I(s,e,r),X(t,e,null),l=!0},p(s,r){const i={};r[0]&721409|r[1]&536870912&&(i.$$scope={dirty:r,ctx:s}),t.$set(i)},i(s){l||(b(t.$$.fragment,s),l=!0)},o(s){y(t.$$.fragment,s),l=!1},d(s){s&&h(e),Y(t)}}}function Ff(n){let e,t=wt(n[9].timestamp*1e3)+"",l;return{c(){e=E("span"),l=q(t),this.h()},l(s){e=N(s,"SPAN",{class:!0});var r=k(e);l=F(r,t),r.forEach(h),this.h()},h(){c(e,"class","line-clamp-1")},m(s,r){I(s,e,r),p(e,l)},p(s,r){r[0]&512&&t!==(t=wt(s[9].timestamp*1e3)+"")&&Z(l,t)},d(s){s&&h(e)}}}function Gf(n){let e=n[16].t("You")+"",t;return{c(){t=q(e)},l(l){t=F(l,e)},m(l,s){I(l,t,s)},p(l,s){s[0]&65536&&e!==(e=l[16].t("You")+"")&&Z(t,e)},d(l){l&&h(t)}}}function Jf(n){let e=n[0].name+"",t;return{c(){t=q(e)},l(l){t=F(l,e)},m(l,s){I(l,t,s)},p(l,s){s[0]&1&&e!==(e=l[0].name+"")&&Z(t,e)},d(l){l&&h(t)}}}function Kf(n){var o;let e=n[16].t("You")+"",t,l,s,r=(((o=n[9])==null?void 0:o.user)??"")+"",i;return{c(){t=q(e),l=A(),s=E("span"),i=q(r),this.h()},l(a){t=F(a,e),l=H(a),s=N(a,"SPAN",{class:!0});var f=k(s);i=F(f,r),f.forEach(h),this.h()},h(){c(s,"class","text-gray-500 text-sm font-medium")},m(a,f){I(a,t,f),I(a,l,f),I(a,s,f),p(s,i)},p(a,f){var u;f[0]&65536&&e!==(e=a[16].t("You")+"")&&Z(t,e),f[0]&512&&r!==(r=(((u=a[9])==null?void 0:u.user)??"")+"")&&Z(i,r)},d(a){a&&(h(t),h(l),h(s))}}}function yn(n){let e,t,l;return t=new Pe({props:{content:ft(n[9].timestamp*1e3).format("LLLL"),$$slots:{default:[Zf]},$$scope:{ctx:n}}}),{c(){e=E("div"),Q(t.$$.fragment),this.h()},l(s){e=N(s,"DIV",{class:!0});var r=k(e);$(t.$$.fragment,r),r.forEach(h),this.h()},h(){c(e,"class","self-center text-xs invisible group-hover:visible text-gray-400 font-medium first-letter:capitalize ml-0.5 translate-y-[1px]")},m(s,r){I(s,e,r),X(t,e,null),l=!0},p(s,r){const i={};r[0]&512&&(i.content=ft(s[9].timestamp*1e3).format("LLLL")),r[0]&512|r[1]&536870912&&(i.$$scope={dirty:r,ctx:s}),t.$set(i)},i(s){l||(b(t.$$.fragment,s),l=!0)},o(s){y(t.$$.fragment,s),l=!1},d(s){s&&h(e),Y(t)}}}function Zf(n){let e,t=wt(n[9].timestamp*1e3)+"",l;return{c(){e=E("span"),l=q(t),this.h()},l(s){e=N(s,"SPAN",{class:!0});var r=k(e);l=F(r,t),r.forEach(h),this.h()},h(){c(e,"class","line-clamp-1")},m(s,r){I(s,e,r),p(e,l)},p(s,r){r[0]&512&&t!==(t=wt(s[9].timestamp*1e3)+"")&&Z(l,t)},d(s){s&&h(e)}}}function Qf(n){let e,t,l;function s(a,f){return a[9].user?Kf:a[17].showUsername||a[19].name!==a[0].name?Jf:Gf}let r=s(n),i=r(n),o=n[9].timestamp&&yn(n);return{c(){i.c(),e=A(),o&&o.c(),t=ae()},l(a){i.l(a),e=H(a),o&&o.l(a),t=ae()},m(a,f){i.m(a,f),I(a,e,f),o&&o.m(a,f),I(a,t,f),l=!0},p(a,f){r===(r=s(a))&&i?i.p(a,f):(i.d(1),i=r(a),i&&(i.c(),i.m(e.parentNode,e))),a[9].timestamp?o?(o.p(a,f),f[0]&512&&b(o,1)):(o=yn(a),o.c(),b(o,1),o.m(t.parentNode,t)):o&&(x(),y(o,1,1,()=>{o=null}),ee())},i(a){l||(b(o),l=!0)},o(a){y(o),l=!1},d(a){a&&(h(e),h(t)),i.d(a),o&&o.d(a)}}}function Mn(n){let e,t,l=n[9].files&&En(n);return{c(){l&&l.c(),e=ae()},l(s){l&&l.l(s),e=ae()},m(s,r){l&&l.m(s,r),I(s,e,r),t=!0},p(s,r){s[9].files?l?(l.p(s,r),r[0]&512&&b(l,1)):(l=En(s),l.c(),b(l,1),l.m(e.parentNode,e)):l&&(x(),y(l,1,1,()=>{l=null}),ee())},i(s){t||(b(l),t=!0)},o(s){y(l),t=!1},d(s){s&&h(e),l&&l.d(s)}}}function En(n){let e,t,l=Ce(n[9].files),s=[];for(let i=0;i<l.length;i+=1)s[i]=Nn(wn(n,l,i));const r=i=>y(s[i],1,1,()=>{s[i]=null});return{c(){e=E("div");for(let i=0;i<s.length;i+=1)s[i].c();this.h()},l(i){e=N(i,"DIV",{class:!0});var o=k(e);for(let a=0;a<s.length;a+=1)s[a].l(o);o.forEach(h),this.h()},h(){c(e,"class","mb-1 w-full flex flex-col justify-end overflow-x-auto gap-1 flex-wrap")},m(i,o){I(i,e,o);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null);t=!0},p(i,o){if(o[0]&131584){l=Ce(i[9].files);let a;for(a=0;a<l.length;a+=1){const f=wn(i,l,a);s[a]?(s[a].p(f,o),b(s[a],1)):(s[a]=Nn(f),s[a].c(),b(s[a],1),s[a].m(e,null))}for(x(),a=l.length;a<s.length;a+=1)r(a);ee()}},i(i){if(!t){for(let o=0;o<l.length;o+=1)b(s[o]);t=!0}},o(i){s=s.filter(Boolean);for(let o=0;o<s.length;o+=1)y(s[o]);t=!1},d(i){i&&h(e),Fe(s,i)}}}function Xf(n){var l;let e,t;return e=new sl({props:{item:n[55],url:n[55].url,name:n[55].name,type:n[55].type,size:(l=n[55])==null?void 0:l.size,colorClassName:"bg-white dark:bg-gray-850 "}}),{c(){Q(e.$$.fragment)},l(s){$(e.$$.fragment,s)},m(s,r){X(e,s,r),t=!0},p(s,r){var o;const i={};r[0]&512&&(i.item=s[55]),r[0]&512&&(i.url=s[55].url),r[0]&512&&(i.name=s[55].name),r[0]&512&&(i.type=s[55].type),r[0]&512&&(i.size=(o=s[55])==null?void 0:o.size),e.$set(i)},i(s){t||(b(e.$$.fragment,s),t=!0)},o(s){y(e.$$.fragment,s),t=!1},d(s){Y(e,s)}}}function Yf(n){let e,t;return e=new el({props:{src:n[55].url,imageClassName:" max-h-96 rounded-lg"}}),{c(){Q(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},p(l,s){const r={};s[0]&512&&(r.src=l[55].url),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){y(e.$$.fragment,l),t=!1},d(l){Y(e,l)}}}function Nn(n){let e,t,l,s,r,i;const o=[Yf,Xf],a=[];function f(u,d){return u[55].type==="image"?0:1}return t=f(n),l=a[t]=o[t](n),{c(){e=E("div"),l.c(),s=A(),this.h()},l(u){e=N(u,"DIV",{class:!0});var d=k(e);l.l(d),s=H(d),d.forEach(h),this.h()},h(){var u;c(e,"class",r=((u=n[17])==null?void 0:u.chatBubble)??!0?"self-end":"")},m(u,d){I(u,e,d),a[t].m(e,null),p(e,s),i=!0},p(u,d){var m;let g=t;t=f(u),t===g?a[t].p(u,d):(x(),y(a[g],1,1,()=>{a[g]=null}),ee(),l=a[t],l?l.p(u,d):(l=a[t]=o[t](u),l.c()),b(l,1),l.m(e,s)),(!i||d[0]&131072&&r!==(r=((m=u[17])==null?void 0:m.chatBubble)??!0?"self-end":""))&&c(e,"class",r)},i(u){i||(b(l),i=!0)},o(u){y(l),i=!1},d(u){u&&h(e),a[t].d()}}}function Dn(n){let e,t,l,s;const r=[xf,$f],i=[];function o(a,f){return a[12]===!0?0:1}return e=o(n),t=i[e]=r[e](n),{c(){t.c(),l=ae()},l(a){t.l(a),l=ae()},m(a,f){i[e].m(a,f),I(a,l,f),s=!0},p(a,f){let u=e;e=o(a),e===u?i[e].p(a,f):(x(),y(i[u],1,1,()=>{i[u]=null}),ee(),t=i[e],t?t.p(a,f):(t=i[e]=r[e](a),t.c()),b(t,1),t.m(l.parentNode,l))},i(a){s||(b(t),s=!0)},o(a){y(t),s=!1},d(a){a&&h(l),i[e].d(a)}}}function $f(n){var L,S;let e,t,l,s,r,i,o,a,f,u,d,g,m,_,D=n[9].content&&Tn(n),v=!(((L=n[17])==null?void 0:L.chatBubble)??!0)&&Cn(n),M=!n[7]&&Sn(n);u=new Pe({props:{content:n[16].t("Copy"),placement:"bottom",$$slots:{default:[su]},$$scope:{ctx:n}}});let T=!n[7]&&(!n[6]||n[2].length>1)&&Bn(n),P=(((S=n[17])==null?void 0:S.chatBubble)??!0)&&On(n);return{c(){e=E("div"),t=E("div"),l=E("div"),D&&D.c(),i=A(),o=E("div"),v&&v.c(),a=A(),M&&M.c(),f=A(),Q(u.$$.fragment),d=A(),T&&T.c(),g=A(),P&&P.c(),this.h()},l(w){e=N(w,"DIV",{class:!0});var C=k(e);t=N(C,"DIV",{class:!0});var V=k(t);l=N(V,"DIV",{class:!0});var O=k(l);D&&D.l(O),O.forEach(h),V.forEach(h),i=H(C),o=N(C,"DIV",{class:!0});var B=k(o);v&&v.l(B),a=H(B),M&&M.l(B),f=H(B),$(u.$$.fragment,B),d=H(B),T&&T.l(B),g=H(B),P&&P.l(B),B.forEach(h),C.forEach(h),this.h()},h(){var w,C,V;c(l,"class",s="rounded-3xl "+(((w=n[17])==null?void 0:w.chatBubble)??!0?`max-w-[90%] px-5 py-2  bg-gray-50 dark:bg-gray-850 ${n[9].files?"rounded-tr-lg":""}`:" w-full")),c(t,"class",r="flex "+(((C=n[17])==null?void 0:C.chatBubble)??!0?"justify-end pb-1":"w-full")),c(o,"class",m="flex "+(((V=n[17])==null?void 0:V.chatBubble)??!0?"justify-end":"")+" text-gray-600 dark:text-gray-500"),c(e,"class","w-full")},m(w,C){I(w,e,C),p(e,t),p(t,l),D&&D.m(l,null),p(e,i),p(e,o),v&&v.m(o,null),p(o,a),M&&M.m(o,null),p(o,f),X(u,o,null),p(o,d),T&&T.m(o,null),p(o,g),P&&P.m(o,null),_=!0},p(w,C){var O,B,G,U,j;w[9].content?D?(D.p(w,C),C[0]&512&&b(D,1)):(D=Tn(w),D.c(),b(D,1),D.m(l,null)):D&&(x(),y(D,1,1,()=>{D=null}),ee()),(!_||C[0]&131584&&s!==(s="rounded-3xl "+(((O=w[17])==null?void 0:O.chatBubble)??!0?`max-w-[90%] px-5 py-2  bg-gray-50 dark:bg-gray-850 ${w[9].files?"rounded-tr-lg":""}`:" w-full")))&&c(l,"class",s),(!_||C[0]&131072&&r!==(r="flex "+(((B=w[17])==null?void 0:B.chatBubble)??!0?"justify-end pb-1":"w-full")))&&c(t,"class",r),((G=w[17])==null?void 0:G.chatBubble)??!0?v&&(v.d(1),v=null):v?v.p(w,C):(v=Cn(w),v.c(),v.m(o,a)),w[7]?M&&(x(),y(M,1,1,()=>{M=null}),ee()):M?(M.p(w,C),C[0]&128&&b(M,1)):(M=Sn(w),M.c(),b(M,1),M.m(o,f));const V={};C[0]&65536&&(V.content=w[16].t("Copy")),C[0]&512|C[1]&536870912&&(V.$$scope={dirty:C,ctx:w}),u.$set(V),!w[7]&&(!w[6]||w[2].length>1)?T?(T.p(w,C),C[0]&196&&b(T,1)):(T=Bn(w),T.c(),b(T,1),T.m(o,g)):T&&(x(),y(T,1,1,()=>{T=null}),ee()),((U=w[17])==null?void 0:U.chatBubble)??!0?P?P.p(w,C):(P=On(w),P.c(),P.m(o,null)):P&&(P.d(1),P=null),(!_||C[0]&131072&&m!==(m="flex "+(((j=w[17])==null?void 0:j.chatBubble)??!0?"justify-end":"")+" text-gray-600 dark:text-gray-500"))&&c(o,"class",m)},i(w){_||(b(D),b(M),b(u.$$.fragment,w),b(T),_=!0)},o(w){y(D),y(M),y(u.$$.fragment,w),y(T),_=!1},d(w){w&&h(e),D&&D.d(),v&&v.d(),M&&M.d(),Y(u),T&&T.d(),P&&P.d()}}}function xf(n){let e,t,l,s,r,i,o,a,f,u=n[16].t("Save")+"",d,g,m,_,D=n[16].t("Cancel")+"",v,M,T,P=n[16].t("Send")+"",L,S,w,C,V=(n[14]??[]).length>0&&Pn(n);return{c(){e=E("div"),V&&V.c(),t=A(),l=E("div"),s=E("textarea"),i=A(),o=E("div"),a=E("div"),f=E("button"),d=q(u),g=A(),m=E("div"),_=E("button"),v=q(D),M=A(),T=E("button"),L=q(P),this.h()},l(O){e=N(O,"DIV",{class:!0});var B=k(e);V&&V.l(B),t=H(B),l=N(B,"DIV",{class:!0});var G=k(l);s=N(G,"TEXTAREA",{id:!0,class:!0}),k(s).forEach(h),G.forEach(h),i=H(B),o=N(B,"DIV",{class:!0});var U=k(o);a=N(U,"DIV",{});var j=k(a);f=N(j,"BUTTON",{id:!0,class:!0});var ue=k(f);d=F(ue,u),ue.forEach(h),j.forEach(h),g=H(U),m=N(U,"DIV",{class:!0});var le=k(m);_=N(le,"BUTTON",{id:!0,class:!0});var he=k(_);v=F(he,D),he.forEach(h),M=H(le),T=N(le,"BUTTON",{id:!0,class:!0});var J=k(T);L=F(J,P),J.forEach(h),le.forEach(h),U.forEach(h),B.forEach(h),this.h()},h(){c(s,"id",r="message-edit-"+n[9].id),c(s,"class","bg-transparent outline-hidden w-full resize-none"),c(l,"class","max-h-96 overflow-auto"),c(f,"id","save-edit-message-button"),c(f,"class","px-4 py-2 bg-gray-50 hover:bg-gray-100 dark:bg-gray-800 dark:hover:bg-gray-700 border border-gray-100 dark:border-gray-700 text-gray-700 dark:text-gray-200 transition rounded-3xl"),c(_,"id","close-edit-message-button"),c(_,"class","px-4 py-2 bg-white dark:bg-gray-900 hover:bg-gray-100 text-gray-800 dark:text-gray-100 transition rounded-3xl"),c(T,"id","confirm-edit-message-button"),c(T,"class","px-4 py-2 bg-gray-900 dark:bg-white hover:bg-gray-850 text-gray-100 dark:text-gray-800 transition rounded-3xl"),c(m,"class","flex space-x-1.5"),c(o,"class","mt-2 mb-1 flex justify-between text-sm font-medium"),c(e,"class","w-full bg-gray-50 dark:bg-gray-800 rounded-3xl px-5 py-3 mb-2")},m(O,B){I(O,e,B),V&&V.m(e,null),p(e,t),p(e,l),p(l,s),n[36](s),ot(s,n[13]),p(e,i),p(e,o),p(o,a),p(a,f),p(f,d),p(o,g),p(o,m),p(m,_),p(_,v),p(m,M),p(m,T),p(T,L),S=!0,w||(C=[ce(s,"input",n[37]),ce(s,"input",uu),ce(s,"keydown",n[38]),ce(f,"click",n[39]),ce(_,"click",n[40]),ce(T,"click",n[41])],w=!0)},p(O,B){(O[14]??[]).length>0?V?(V.p(O,B),B[0]&16384&&b(V,1)):(V=Pn(O),V.c(),b(V,1),V.m(e,t)):V&&(x(),y(V,1,1,()=>{V=null}),ee()),(!S||B[0]&512&&r!==(r="message-edit-"+O[9].id))&&c(s,"id",r),B[0]&8192&&ot(s,O[13]),(!S||B[0]&65536)&&u!==(u=O[16].t("Save")+"")&&Z(d,u),(!S||B[0]&65536)&&D!==(D=O[16].t("Cancel")+"")&&Z(v,D),(!S||B[0]&65536)&&P!==(P=O[16].t("Send")+"")&&Z(L,P)},i(O){S||(b(V),S=!0)},o(O){y(V),S=!1},d(O){O&&h(e),V&&V.d(),n[36](null),w=!1,et(C)}}}function Tn(n){let e,t;return e=new Vt({props:{id:`${n[1]}-${n[9].id}`,content:n[9].content,topPadding:n[8]}}),{c(){Q(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},p(l,s){const r={};s[0]&514&&(r.id=`${l[1]}-${l[9].id}`),s[0]&512&&(r.content=l[9].content),s[0]&256&&(r.topPadding=l[8]),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){y(e.$$.fragment,l),t=!1},d(l){Y(e,l)}}}function Cn(n){let e,t=n[2].length>1&&Vn(n);return{c(){t&&t.c(),e=ae()},l(l){t&&t.l(l),e=ae()},m(l,s){t&&t.m(l,s),I(l,e,s)},p(l,s){l[2].length>1?t?t.p(l,s):(t=Vn(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(l){l&&h(e),t&&t.d(l)}}}function Vn(n){let e,t,l='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5"></path></svg>',s,r,i,o='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5"></path></svg>',a,f;function u(m,_){return m[11]?tu:eu}let d=u(n),g=d(n);return{c(){e=E("div"),t=E("button"),t.innerHTML=l,s=A(),g.c(),r=A(),i=E("button"),i.innerHTML=o,this.h()},l(m){e=N(m,"DIV",{class:!0,dir:!0});var _=k(e);t=N(_,"BUTTON",{class:!0,"data-svelte-h":!0}),st(t)!=="svelte-buado9"&&(t.innerHTML=l),s=H(_),g.l(_),r=H(_),i=N(_,"BUTTON",{class:!0,"data-svelte-h":!0}),st(i)!=="svelte-4phel2"&&(i.innerHTML=o),_.forEach(h),this.h()},h(){c(t,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),c(i,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),c(e,"class","flex self-center"),c(e,"dir","ltr")},m(m,_){I(m,e,_),p(e,t),p(e,s),g.m(e,null),p(e,r),p(e,i),a||(f=[ce(t,"click",n[42]),ce(i,"click",n[46])],a=!0)},p(m,_){d===(d=u(m))&&g?g.p(m,_):(g.d(1),g=d(m),g&&(g.c(),g.m(e,r)))},d(m){m&&h(e),g.d(),a=!1,et(f)}}}function eu(n){let e,t=n[2].indexOf(n[9].id)+1+"",l,s,r=n[2].length+"",i,o,a;return{c(){e=E("div"),l=q(t),s=q("/"),i=q(r),this.h()},l(f){e=N(f,"DIV",{class:!0});var u=k(e);l=F(u,t),s=F(u,"/"),i=F(u,r),u.forEach(h),this.h()},h(){c(e,"class","text-sm tracking-widest font-semibold self-center dark:text-gray-100 min-w-fit")},m(f,u){I(f,e,u),p(e,l),p(e,s),p(e,i),o||(a=ce(e,"dblclick",n[45]),o=!0)},p(f,u){u[0]&516&&t!==(t=f[2].indexOf(f[9].id)+1+"")&&Z(l,t),u[0]&4&&r!==(r=f[2].length+"")&&Z(i,r)},d(f){f&&h(e),o=!1,a()}}}function tu(n){let e,t,l,s,r,i,o=n[2].length+"",a,f,u;return{c(){e=E("div"),t=E("input"),i=q("/"),a=q(o),this.h()},l(d){e=N(d,"DIV",{class:!0});var g=k(e);t=N(g,"INPUT",{id:!0,type:!0,min:!0,max:!0,class:!0}),i=F(g,"/"),a=F(g,o),g.forEach(h),this.h()},h(){c(t,"id",l="message-index-input-"+n[9].id),c(t,"type","number"),t.value=s=n[2].indexOf(n[9].id)+1,c(t,"min","1"),c(t,"max",r=n[2].length),c(t,"class","bg-transparent font-semibold self-center dark:text-gray-100 min-w-fit outline-hidden"),c(e,"class","text-sm flex justify-center font-semibold self-center dark:text-gray-100 min-w-fit")},m(d,g){I(d,e,g),p(e,t),p(e,i),p(e,a),f||(u=[ce(t,"focus",cu),ce(t,"blur",n[43]),ce(t,"keydown",n[44])],f=!0)},p(d,g){g[0]&512&&l!==(l="message-index-input-"+d[9].id)&&c(t,"id",l),g[0]&516&&s!==(s=d[2].indexOf(d[9].id)+1)&&t.value!==s&&(t.value=s),g[0]&4&&r!==(r=d[2].length)&&c(t,"max",r),g[0]&4&&o!==(o=d[2].length+"")&&Z(a,o)},d(d){d&&h(e),f=!1,et(u)}}}function Sn(n){let e,t;return e=new Pe({props:{content:n[16].t("Edit"),placement:"bottom",$$slots:{default:[lu]},$$scope:{ctx:n}}}),{c(){Q(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},p(l,s){const r={};s[0]&65536&&(r.content=l[16].t("Edit")),s[1]&536870912&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){y(e.$$.fragment,l),t=!1},d(l){Y(e,l)}}}function lu(n){let e,t='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.3" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125"></path></svg>',l,s;return{c(){e=E("button"),e.innerHTML=t,this.h()},l(r){e=N(r,"BUTTON",{class:!0,"data-svelte-h":!0}),st(e)!=="svelte-tlrz1q"&&(e.innerHTML=t),this.h()},h(){c(e,"class","invisible group-hover:visible p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition edit-user-message-button")},m(r,i){I(r,e,i),l||(s=ce(e,"click",n[47]),l=!0)},p:Ne,d(r){r&&h(e),l=!1,s()}}}function su(n){let e,t='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.3" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M15.666 3.888A2.25 2.25 0 0013.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 01-.75.75H9a.75.75 0 01-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 01-2.25 2.25H6.75A2.25 2.25 0 014.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 011.927-.184"></path></svg>',l,s;return{c(){e=E("button"),e.innerHTML=t,this.h()},l(r){e=N(r,"BUTTON",{class:!0,"data-svelte-h":!0}),st(e)!=="svelte-1ivgdx2"&&(e.innerHTML=t),this.h()},h(){c(e,"class","invisible group-hover:visible p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(r,i){I(r,e,i),l||(s=ce(e,"click",n[48]),l=!0)},p:Ne,d(r){r&&h(e),l=!1,s()}}}function Bn(n){let e,t;return e=new Pe({props:{content:n[16].t("Delete"),placement:"bottom",$$slots:{default:[nu]},$$scope:{ctx:n}}}),{c(){Q(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},p(l,s){const r={};s[0]&65536&&(r.content=l[16].t("Delete")),s[0]&1024|s[1]&536870912&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){y(e.$$.fragment,l),t=!1},d(l){Y(e,l)}}}function nu(n){let e,t='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"></path></svg>',l,s;return{c(){e=E("button"),e.innerHTML=t,this.h()},l(r){e=N(r,"BUTTON",{class:!0,"data-svelte-h":!0}),st(e)!=="svelte-146x2zz"&&(e.innerHTML=t),this.h()},h(){c(e,"class","invisible group-hover:visible p-1 rounded-sm dark:hover:text-white hover:text-black transition")},m(r,i){I(r,e,i),l||(s=ce(e,"click",n[49]),l=!0)},p:Ne,d(r){r&&h(e),l=!1,s()}}}function On(n){let e,t=n[2].length>1&&Rn(n);return{c(){t&&t.c(),e=ae()},l(l){t&&t.l(l),e=ae()},m(l,s){t&&t.m(l,s),I(l,e,s)},p(l,s){l[2].length>1?t?t.p(l,s):(t=Rn(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(l){l&&h(e),t&&t.d(l)}}}function Rn(n){let e,t,l='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5"></path></svg>',s,r,i,o='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5"></path></svg>',a,f;function u(m,_){return m[11]?iu:ru}let d=u(n),g=d(n);return{c(){e=E("div"),t=E("button"),t.innerHTML=l,s=A(),g.c(),r=A(),i=E("button"),i.innerHTML=o,this.h()},l(m){e=N(m,"DIV",{class:!0,dir:!0});var _=k(e);t=N(_,"BUTTON",{class:!0,"data-svelte-h":!0}),st(t)!=="svelte-buado9"&&(t.innerHTML=l),s=H(_),g.l(_),r=H(_),i=N(_,"BUTTON",{class:!0,"data-svelte-h":!0}),st(i)!=="svelte-4phel2"&&(i.innerHTML=o),_.forEach(h),this.h()},h(){c(t,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),c(i,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),c(e,"class","flex self-center"),c(e,"dir","ltr")},m(m,_){I(m,e,_),p(e,t),p(e,s),g.m(e,null),p(e,r),p(e,i),a||(f=[ce(t,"click",n[50]),ce(i,"click",n[54])],a=!0)},p(m,_){d===(d=u(m))&&g?g.p(m,_):(g.d(1),g=d(m),g&&(g.c(),g.m(e,r)))},d(m){m&&h(e),g.d(),a=!1,et(f)}}}function ru(n){let e,t=n[2].indexOf(n[9].id)+1+"",l,s,r=n[2].length+"",i,o,a;return{c(){e=E("div"),l=q(t),s=q("/"),i=q(r),this.h()},l(f){e=N(f,"DIV",{class:!0});var u=k(e);l=F(u,t),s=F(u,"/"),i=F(u,r),u.forEach(h),this.h()},h(){c(e,"class","text-sm tracking-widest font-semibold self-center dark:text-gray-100 min-w-fit")},m(f,u){I(f,e,u),p(e,l),p(e,s),p(e,i),o||(a=ce(e,"dblclick",n[53]),o=!0)},p(f,u){u[0]&516&&t!==(t=f[2].indexOf(f[9].id)+1+"")&&Z(l,t),u[0]&4&&r!==(r=f[2].length+"")&&Z(i,r)},d(f){f&&h(e),o=!1,a()}}}function iu(n){let e,t,l,s,r,i,o=n[2].length+"",a,f,u;return{c(){e=E("div"),t=E("input"),i=q("/"),a=q(o),this.h()},l(d){e=N(d,"DIV",{class:!0});var g=k(e);t=N(g,"INPUT",{id:!0,type:!0,min:!0,max:!0,class:!0}),i=F(g,"/"),a=F(g,o),g.forEach(h),this.h()},h(){c(t,"id",l="message-index-input-"+n[9].id),c(t,"type","number"),t.value=s=n[2].indexOf(n[9].id)+1,c(t,"min","1"),c(t,"max",r=n[2].length),c(t,"class","bg-transparent font-semibold self-center dark:text-gray-100 min-w-fit outline-hidden"),c(e,"class","text-sm flex justify-center font-semibold self-center dark:text-gray-100 min-w-fit")},m(d,g){I(d,e,g),p(e,t),p(e,i),p(e,a),f||(u=[ce(t,"focus",du),ce(t,"blur",n[51]),ce(t,"keydown",n[52])],f=!0)},p(d,g){g[0]&512&&l!==(l="message-index-input-"+d[9].id)&&c(t,"id",l),g[0]&516&&s!==(s=d[2].indexOf(d[9].id)+1)&&t.value!==s&&(t.value=s),g[0]&4&&r!==(r=d[2].length)&&c(t,"max",r),g[0]&4&&o!==(o=d[2].length+"")&&Z(a,o)},d(d){d&&h(e),f=!1,et(u)}}}function Pn(n){let e,t,l=Ce(n[14]),s=[];for(let i=0;i<l.length;i+=1)s[i]=Ln(kn(n,l,i));const r=i=>y(s[i],1,1,()=>{s[i]=null});return{c(){e=E("div");for(let i=0;i<s.length;i+=1)s[i].c();this.h()},l(i){e=N(i,"DIV",{class:!0});var o=k(e);for(let a=0;a<s.length;a+=1)s[a].l(o);o.forEach(h),this.h()},h(){c(e,"class","flex items-center flex-wrap gap-2 -mx-2 mb-1")},m(i,o){I(i,e,o);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null);t=!0},p(i,o){if(o[0]&16384){l=Ce(i[14]);let a;for(a=0;a<l.length;a+=1){const f=kn(i,l,a);s[a]?(s[a].p(f,o),b(s[a],1)):(s[a]=Ln(f),s[a].c(),b(s[a],1),s[a].m(e,null))}for(x(),a=l.length;a<s.length;a+=1)r(a);ee()}},i(i){if(!t){for(let o=0;o<l.length;o+=1)b(s[o]);t=!0}},o(i){s=s.filter(Boolean);for(let o=0;o<s.length;o+=1)y(s[o]);t=!1},d(i){i&&h(e),Fe(s,i)}}}function au(n){var r;let e,t;function l(){return n[34](n[57])}function s(){return n[35](n[55])}return e=new sl({props:{item:n[55],name:n[55].name,type:n[55].type,size:(r=n[55])==null?void 0:r.size,loading:n[55].status==="uploading",dismissible:!0,edit:!0}}),e.$on("dismiss",l),e.$on("click",s),{c(){Q(e.$$.fragment)},l(i){$(e.$$.fragment,i)},m(i,o){X(e,i,o),t=!0},p(i,o){var f;n=i;const a={};o[0]&16384&&(a.item=n[55]),o[0]&16384&&(a.name=n[55].name),o[0]&16384&&(a.type=n[55].type),o[0]&16384&&(a.size=(f=n[55])==null?void 0:f.size),o[0]&16384&&(a.loading=n[55].status==="uploading"),e.$set(a)},i(i){t||(b(e.$$.fragment,i),t=!0)},o(i){y(e.$$.fragment,i),t=!1},d(i){Y(e,i)}}}function ou(n){let e,t,l,s,r,i,o='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="size-4"><path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"></path></svg>',a,f,u,d;l=new el({props:{src:n[55].url,alt:"input",imageClassName:" size-14 rounded-xl object-cover"}});function g(){return n[33](n[57])}return{c(){e=E("div"),t=E("div"),Q(l.$$.fragment),s=A(),r=E("div"),i=E("button"),i.innerHTML=o,a=A(),this.h()},l(m){e=N(m,"DIV",{class:!0});var _=k(e);t=N(_,"DIV",{class:!0});var D=k(t);$(l.$$.fragment,D),D.forEach(h),s=H(_),r=N(_,"DIV",{class:!0});var v=k(r);i=N(v,"BUTTON",{class:!0,type:!0,"data-svelte-h":!0}),st(i)!=="svelte-1ki5d3w"&&(i.innerHTML=o),v.forEach(h),a=H(_),_.forEach(h),this.h()},h(){c(t,"class","relative flex items-center"),c(i,"class","bg-white text-black border border-white rounded-full group-hover:visible invisible transition"),c(i,"type","button"),c(r,"class","absolute -top-1 -right-1"),c(e,"class","relative group")},m(m,_){I(m,e,_),p(e,t),X(l,t,null),p(e,s),p(e,r),p(r,i),p(e,a),f=!0,u||(d=ce(i,"click",g),u=!0)},p(m,_){n=m;const D={};_[0]&16384&&(D.src=n[55].url),l.$set(D)},i(m){f||(b(l.$$.fragment,m),f=!0)},o(m){y(l.$$.fragment,m),f=!1},d(m){m&&h(e),Y(l),u=!1,d()}}}function Ln(n){let e,t,l,s;const r=[ou,au],i=[];function o(a,f){return a[55].type==="image"?0:1}return e=o(n),t=i[e]=r[e](n),{c(){t.c(),l=ae()},l(a){t.l(a),l=ae()},m(a,f){i[e].m(a,f),I(a,l,f),s=!0},p(a,f){let u=e;e=o(a),e===u?i[e].p(a,f):(x(),y(i[u],1,1,()=>{i[u]=null}),ee(),t=i[e],t?t.p(a,f):(t=i[e]=r[e](a),t.c()),b(t,1),t.m(l.parentNode,l))},i(a){s||(b(t),s=!0)},o(a){y(t),s=!1},d(a){a&&h(l),i[e].d(a)}}}function fu(n){var V;let e,t,l,s,r,i,o,a,f,u,d,g,m,_,D;function v(O){n[30](O)}let M={title:n[16].t("Delete message?")};n[10]!==void 0&&(M.show=n[10]),e=new dr({props:M}),We.push(()=>Ze(e,"show",v)),e.$on("confirm",n[31]);let T=!(((V=n[17])==null?void 0:V.chatBubble)??!0)&&In(n);const P=[qf,Wf],L=[];function S(O,B){var G;return((G=O[17])==null?void 0:G.chatBubble)??!0?O[9].timestamp?1:-1:0}~(o=S(n))&&(a=L[o]=P[o](n));let w=n[12]!==!0&&Mn(n),C=n[9].content!==""&&Dn(n);return{c(){Q(e.$$.fragment),l=A(),s=E("div"),T&&T.c(),r=A(),i=E("div"),a&&a.c(),f=A(),u=E("div"),w&&w.c(),d=A(),C&&C.c(),this.h()},l(O){$(e.$$.fragment,O),l=H(O),s=N(O,"DIV",{class:!0,dir:!0,id:!0});var B=k(s);T&&T.l(B),r=H(B),i=N(B,"DIV",{class:!0});var G=k(i);a&&a.l(G),f=H(G),u=N(G,"DIV",{class:!0});var U=k(u);w&&w.l(U),d=H(U),C&&C.l(U),U.forEach(h),G.forEach(h),B.forEach(h),this.h()},h(){c(u,"class",g="chat-"+n[9].role+" w-full min-w-full markdown-prose"),c(i,"class","flex-auto w-0 max-w-full pl-1"),c(s,"class","flex w-full user-message group"),c(s,"dir",m=n[17].chatDirection),c(s,"id",_="message-"+n[9].id)},m(O,B){X(e,O,B),I(O,l,B),I(O,s,B),T&&T.m(s,null),p(s,r),p(s,i),~o&&L[o].m(i,null),p(i,f),p(i,u),w&&w.m(u,null),p(u,d),C&&C.m(u,null),D=!0},p(O,B){var j;const G={};B[0]&65536&&(G.title=O[16].t("Delete message?")),!t&&B[0]&1024&&(t=!0,G.show=O[10],Qe(()=>t=!1)),e.$set(G),((j=O[17])==null?void 0:j.chatBubble)??!0?T&&(x(),y(T,1,1,()=>{T=null}),ee()):T?(T.p(O,B),B[0]&131072&&b(T,1)):(T=In(O),T.c(),b(T,1),T.m(s,r));let U=o;o=S(O),o===U?~o&&L[o].p(O,B):(a&&(x(),y(L[U],1,1,()=>{L[U]=null}),ee()),~o?(a=L[o],a?a.p(O,B):(a=L[o]=P[o](O),a.c()),b(a,1),a.m(i,f)):a=null),O[12]!==!0?w?(w.p(O,B),B[0]&4096&&b(w,1)):(w=Mn(O),w.c(),b(w,1),w.m(u,d)):w&&(x(),y(w,1,1,()=>{w=null}),ee()),O[9].content!==""?C?(C.p(O,B),B[0]&512&&b(C,1)):(C=Dn(O),C.c(),b(C,1),C.m(u,null)):C&&(x(),y(C,1,1,()=>{C=null}),ee()),(!D||B[0]&512&&g!==(g="chat-"+O[9].role+" w-full min-w-full markdown-prose"))&&c(u,"class",g),(!D||B[0]&131072&&m!==(m=O[17].chatDirection))&&c(s,"dir",m),(!D||B[0]&512&&_!==(_="message-"+O[9].id))&&c(s,"id",_)},i(O){D||(b(e.$$.fragment,O),b(T),b(a),b(w),b(C),D=!0)},o(O){y(e.$$.fragment,O),y(T),y(a),y(w),y(C),D=!1},d(O){O&&(h(l),h(s)),Y(e,O),T&&T.d(),~o&&L[o].d(),w&&w.d(),C&&C.d()}}}const uu=n=>{n.target.style.height="",n.target.style.height=`${n.target.scrollHeight}px`},cu=n=>{n.target.select()},du=n=>{n.target.select()};function hu(n,e,t){let l,s,r,i;Te(n,pt,te=>t(17,s=te)),Te(n,Ct,te=>t(18,r=te)),Te(n,Ut,te=>t(19,i=te));const o=Ge("i18n");Te(n,o,te=>t(16,l=te)),ft.extend(ar);let{user:a}=e,{chatId:f}=e,{history:u}=e,{messageId:d}=e,{siblings:g}=e,{gotoMessage:m}=e,{showPreviousMessage:_}=e,{showNextMessage:D}=e,{editMessage:v}=e,{deleteMessage:M}=e,{isFirstMessage:T}=e,{readOnly:P}=e,{topPadding:L=!1}=e,S=!1,w=!1,C=!1,V="",O=[],B,G=JSON.parse(JSON.stringify(u.messages[d]));const U=async te=>{await ir(te)&&qe.success(l.t("Copying to clipboard was successful!"))},j=async()=>{t(12,C=!0),t(13,V=G.content),t(14,O=G.files),await Oe(),B&&(t(15,B.style.height="",B),t(15,B.style.height=`${B.scrollHeight}px`,B),B==null||B.focus())},ue=async(te=!0)=>{v(G.id,{content:V,files:O},te),t(12,C=!1),t(13,V=""),t(14,O=[])},le=()=>{t(12,C=!1),t(13,V=""),t(14,O=[])},he=async()=>{M(G.id)};It(()=>{});function J(te){S=te,t(10,S)}const oe=()=>{he()},me=te=>te.id===G.user,re=te=>{O.splice(te,1),t(14,O)},ie=async te=>{O.splice(te,1),t(14,O)},ge=te=>{};function se(te){We[te?"unshift":"push"](()=>{B=te,t(15,B)})}function fe(){V=this.value,t(13,V)}const Me=te=>{var Ke,nt;te.key==="Escape"&&((Ke=document.getElementById("close-edit-message-button"))==null||Ke.click());const Xe=te.metaKey||te.ctrlKey,Ye=te.key==="Enter";Xe&&Ye&&((nt=document.getElementById("confirm-edit-message-button"))==null||nt.click())},Ee=()=>{ue(!1)},ve=()=>{le()},Se=()=>{ue()},we=()=>{_(G)},ke=te=>{m(G,te.target.value-1),t(11,w=!1)},R=te=>{te.key==="Enter"&&(m(G,te.target.value-1),t(11,w=!1))},K=async()=>{t(11,w=!0),await Oe();const te=document.getElementById(`message-index-input-${G.id}`);te&&(te.focus(),te.select())},ne=()=>{D(G)},be=()=>{j()},ye=()=>{U(G.content)},W=()=>{t(10,S=!0)},de=()=>{_(G)},Ie=te=>{m(G,te.target.value-1),t(11,w=!1)},Ve=te=>{te.key==="Enter"&&(m(G,te.target.value-1),t(11,w=!1))},je=async()=>{t(11,w=!0),await Oe();const te=document.getElementById(`message-index-input-${G.id}`);te&&(te.focus(),te.select())},Le=()=>{D(G)};return n.$$set=te=>{"user"in te&&t(0,a=te.user),"chatId"in te&&t(1,f=te.chatId),"history"in te&&t(26,u=te.history),"messageId"in te&&t(27,d=te.messageId),"siblings"in te&&t(2,g=te.siblings),"gotoMessage"in te&&t(3,m=te.gotoMessage),"showPreviousMessage"in te&&t(4,_=te.showPreviousMessage),"showNextMessage"in te&&t(5,D=te.showNextMessage),"editMessage"in te&&t(28,v=te.editMessage),"deleteMessage"in te&&t(29,M=te.deleteMessage),"isFirstMessage"in te&&t(6,T=te.isFirstMessage),"readOnly"in te&&t(7,P=te.readOnly),"topPadding"in te&&t(8,L=te.topPadding)},n.$$.update=()=>{n.$$.dirty[0]&201327104&&u.messages&&JSON.stringify(G)!==JSON.stringify(u.messages[d])&&t(9,G=JSON.parse(JSON.stringify(u.messages[d])))},[a,f,g,m,_,D,T,P,L,G,S,w,C,V,O,B,l,s,r,i,o,U,j,ue,le,he,u,d,v,M,J,oe,me,re,ie,ge,se,fe,Me,Ee,ve,Se,we,ke,R,K,ne,be,ye,W,de,Ie,Ve,je,Le]}class mu extends He{constructor(e){super(),ze(this,e,hu,fu,Re,{user:0,chatId:1,history:26,messageId:27,siblings:2,gotoMessage:3,showPreviousMessage:4,showNextMessage:5,editMessage:28,deleteMessage:29,isFirstMessage:6,readOnly:7,topPadding:8},null,[-1,-1])}}function jn(n){let e,t,l,s;const r=[pu,_u,gu],i=[];function o(a,f){var u,d;return a[0].messages[a[4]].role==="user"?0:(((d=(u=a[0].messages[a[0].messages[a[4]].parentId])==null?void 0:u.models)==null?void 0:d.length)??1)===1?1:2}return e=o(n),t=i[e]=r[e](n),{c(){t.c(),l=ae()},l(a){t.l(a),l=ae()},m(a,f){i[e].m(a,f),I(a,l,f),s=!0},p(a,f){let u=e;e=o(a),e===u?i[e].p(a,f):(x(),y(i[u],1,1,()=>{i[u]=null}),ee(),t=i[e],t?t.p(a,f):(t=i[e]=r[e](a),t.c()),b(t,1),t.m(l.parentNode,l))},i(a){s||(b(t),s=!0)},o(a){y(t),s=!1},d(a){a&&h(l),i[e].d(a)}}}function gu(n){var i;let e,t,l;function s(o){n[25](o)}let r={chatId:n[1],messageId:n[4],selectedModels:n[2],isLastMessage:n[4]===((i=n[0])==null?void 0:i.currentId),setInputText:n[6],updateChat:n[10],editMessage:n[11],saveMessage:n[12],rateMessage:n[14],actionMessage:n[15],submitMessage:n[16],deleteMessage:n[13],continueResponse:n[18],regenerateResponse:n[17],mergeResponses:n[19],triggerScroll:n[21],addMessages:n[20],readOnly:n[22],topPadding:n[23]};return n[0]!==void 0&&(r.history=n[0]),e=new Uf({props:r}),We.push(()=>Ze(e,"history",s)),{c(){Q(e.$$.fragment)},l(o){$(e.$$.fragment,o)},m(o,a){X(e,o,a),l=!0},p(o,a){var u;const f={};a&2&&(f.chatId=o[1]),a&16&&(f.messageId=o[4]),a&4&&(f.selectedModels=o[2]),a&17&&(f.isLastMessage=o[4]===((u=o[0])==null?void 0:u.currentId)),a&64&&(f.setInputText=o[6]),a&1024&&(f.updateChat=o[10]),a&2048&&(f.editMessage=o[11]),a&4096&&(f.saveMessage=o[12]),a&16384&&(f.rateMessage=o[14]),a&32768&&(f.actionMessage=o[15]),a&65536&&(f.submitMessage=o[16]),a&8192&&(f.deleteMessage=o[13]),a&262144&&(f.continueResponse=o[18]),a&131072&&(f.regenerateResponse=o[17]),a&524288&&(f.mergeResponses=o[19]),a&2097152&&(f.triggerScroll=o[21]),a&1048576&&(f.addMessages=o[20]),a&4194304&&(f.readOnly=o[22]),a&8388608&&(f.topPadding=o[23]),!t&&a&1&&(t=!0,f.history=o[0],Qe(()=>t=!1)),e.$set(f)},i(o){l||(b(e.$$.fragment,o),l=!0)},o(o){y(e.$$.fragment,o),l=!1},d(o){Y(e,o)}}}function _u(n){var l;let e,t;return e=new nl({props:{chatId:n[1],history:n[0],messageId:n[4],selectedModels:n[2],isLastMessage:n[4]===n[0].currentId,siblings:((l=n[0].messages[n[0].messages[n[4]].parentId])==null?void 0:l.childrenIds)??[],setInputText:n[6],gotoMessage:n[7],showPreviousMessage:n[8],showNextMessage:n[9],updateChat:n[10],editMessage:n[11],saveMessage:n[12],rateMessage:n[14],actionMessage:n[15],submitMessage:n[16],deleteMessage:n[13],continueResponse:n[18],regenerateResponse:n[17],addMessages:n[20],readOnly:n[22],topPadding:n[23]}}),{c(){Q(e.$$.fragment)},l(s){$(e.$$.fragment,s)},m(s,r){X(e,s,r),t=!0},p(s,r){var o;const i={};r&2&&(i.chatId=s[1]),r&1&&(i.history=s[0]),r&16&&(i.messageId=s[4]),r&4&&(i.selectedModels=s[2]),r&17&&(i.isLastMessage=s[4]===s[0].currentId),r&17&&(i.siblings=((o=s[0].messages[s[0].messages[s[4]].parentId])==null?void 0:o.childrenIds)??[]),r&64&&(i.setInputText=s[6]),r&128&&(i.gotoMessage=s[7]),r&256&&(i.showPreviousMessage=s[8]),r&512&&(i.showNextMessage=s[9]),r&1024&&(i.updateChat=s[10]),r&2048&&(i.editMessage=s[11]),r&4096&&(i.saveMessage=s[12]),r&16384&&(i.rateMessage=s[14]),r&32768&&(i.actionMessage=s[15]),r&65536&&(i.submitMessage=s[16]),r&8192&&(i.deleteMessage=s[13]),r&262144&&(i.continueResponse=s[18]),r&131072&&(i.regenerateResponse=s[17]),r&1048576&&(i.addMessages=s[20]),r&4194304&&(i.readOnly=s[22]),r&8388608&&(i.topPadding=s[23]),e.$set(i)},i(s){t||(b(e.$$.fragment,s),t=!0)},o(s){y(e.$$.fragment,s),t=!1},d(s){Y(e,s)}}}function pu(n){var l;let e,t;return e=new mu({props:{user:n[5],chatId:n[1],history:n[0],messageId:n[4],isFirstMessage:n[3]===0,siblings:n[0].messages[n[4]].parentId!==null?((l=n[0].messages[n[0].messages[n[4]].parentId])==null?void 0:l.childrenIds)??[]:Object.values(n[0].messages).filter(An).map(Hn)??[],gotoMessage:n[7],showPreviousMessage:n[8],showNextMessage:n[9],editMessage:n[11],deleteMessage:n[13],readOnly:n[22],topPadding:n[23]}}),{c(){Q(e.$$.fragment)},l(s){$(e.$$.fragment,s)},m(s,r){X(e,s,r),t=!0},p(s,r){var o;const i={};r&32&&(i.user=s[5]),r&2&&(i.chatId=s[1]),r&1&&(i.history=s[0]),r&16&&(i.messageId=s[4]),r&8&&(i.isFirstMessage=s[3]===0),r&17&&(i.siblings=s[0].messages[s[4]].parentId!==null?((o=s[0].messages[s[0].messages[s[4]].parentId])==null?void 0:o.childrenIds)??[]:Object.values(s[0].messages).filter(An).map(Hn)??[]),r&128&&(i.gotoMessage=s[7]),r&256&&(i.showPreviousMessage=s[8]),r&512&&(i.showNextMessage=s[9]),r&2048&&(i.editMessage=s[11]),r&8192&&(i.deleteMessage=s[13]),r&4194304&&(i.readOnly=s[22]),r&8388608&&(i.topPadding=s[23]),e.$set(i)},i(s){t||(b(e.$$.fragment,s),t=!0)},o(s){y(e.$$.fragment,s),t=!1},d(s){Y(e,s)}}}function bu(n){let e,t,l,s=n[0].messages[n[4]]&&jn(n);return{c(){e=E("div"),s&&s.c(),this.h()},l(r){e=N(r,"DIV",{class:!0});var i=k(e);s&&s.l(i),i.forEach(h),this.h()},h(){var r;c(e,"class",t="flex flex-col justify-between px-5 mb-3 w-full "+(((r=n[24])==null?void 0:r.widescreenMode)??null?"max-w-full":"max-w-5xl")+" mx-auto rounded-lg group")},m(r,i){I(r,e,i),s&&s.m(e,null),l=!0},p(r,[i]){var o;r[0].messages[r[4]]?s?(s.p(r,i),i&17&&b(s,1)):(s=jn(r),s.c(),b(s,1),s.m(e,null)):s&&(x(),y(s,1,1,()=>{s=null}),ee()),(!l||i&16777216&&t!==(t="flex flex-col justify-between px-5 mb-3 w-full "+(((o=r[24])==null?void 0:o.widescreenMode)??null?"max-w-full":"max-w-5xl")+" mx-auto rounded-lg group"))&&c(e,"class",t)},i(r){l||(b(s),l=!0)},o(r){y(s),l=!1},d(r){r&&h(e),s&&s.d()}}}const An=n=>n.parentId===null,Hn=n=>n.id;function vu(n,e,t){let l;Te(n,pt,j=>t(24,l=j)),Tt(),Ge("i18n");let{chatId:s}=e,{selectedModels:r=[]}=e,{idx:i=0}=e,{history:o}=e,{messageId:a}=e,{user:f}=e,{setInputText:u=()=>{}}=e,{gotoMessage:d}=e,{showPreviousMessage:g}=e,{showNextMessage:m}=e,{updateChat:_}=e,{editMessage:D}=e,{saveMessage:v}=e,{deleteMessage:M}=e,{rateMessage:T}=e,{actionMessage:P}=e,{submitMessage:L}=e,{regenerateResponse:S}=e,{continueResponse:w}=e,{mergeResponses:C}=e,{addMessages:V}=e,{triggerScroll:O}=e,{readOnly:B=!1}=e,{topPadding:G=!1}=e;function U(j){o=j,t(0,o)}return n.$$set=j=>{"chatId"in j&&t(1,s=j.chatId),"selectedModels"in j&&t(2,r=j.selectedModels),"idx"in j&&t(3,i=j.idx),"history"in j&&t(0,o=j.history),"messageId"in j&&t(4,a=j.messageId),"user"in j&&t(5,f=j.user),"setInputText"in j&&t(6,u=j.setInputText),"gotoMessage"in j&&t(7,d=j.gotoMessage),"showPreviousMessage"in j&&t(8,g=j.showPreviousMessage),"showNextMessage"in j&&t(9,m=j.showNextMessage),"updateChat"in j&&t(10,_=j.updateChat),"editMessage"in j&&t(11,D=j.editMessage),"saveMessage"in j&&t(12,v=j.saveMessage),"deleteMessage"in j&&t(13,M=j.deleteMessage),"rateMessage"in j&&t(14,T=j.rateMessage),"actionMessage"in j&&t(15,P=j.actionMessage),"submitMessage"in j&&t(16,L=j.submitMessage),"regenerateResponse"in j&&t(17,S=j.regenerateResponse),"continueResponse"in j&&t(18,w=j.continueResponse),"mergeResponses"in j&&t(19,C=j.mergeResponses),"addMessages"in j&&t(20,V=j.addMessages),"triggerScroll"in j&&t(21,O=j.triggerScroll),"readOnly"in j&&t(22,B=j.readOnly),"topPadding"in j&&t(23,G=j.topPadding)},[o,s,r,i,a,f,u,d,g,m,_,D,v,M,T,P,L,S,w,C,V,O,B,G,l,U]}class ku extends He{constructor(e){super(),ze(this,e,vu,bu,Re,{chatId:1,selectedModels:2,idx:3,history:0,messageId:4,user:5,setInputText:6,gotoMessage:7,showPreviousMessage:8,showNextMessage:9,updateChat:10,editMessage:11,saveMessage:12,deleteMessage:13,rateMessage:14,actionMessage:15,submitMessage:16,regenerateResponse:17,continueResponse:18,mergeResponses:19,addMessages:20,triggerScroll:21,readOnly:22,topPadding:23})}}function zn(n,e,t){const l=n.slice();return l[14]=e[t],l[16]=t,l}function wu(n){let e,t,l,s,r;return{c(){e=E("div"),t=q(n[5]),l=q(" ‧ v"),s=q(Ml),this.h()},l(i){e=N(i,"DIV",{class:!0});var o=k(e);t=F(o,n[5]),l=F(o," ‧ v"),s=F(o,Ml),o.forEach(h),this.h()},h(){var i;c(e,"class",r="flex w-full "+(((i=n[4])==null?void 0:i.landingPageMode)==="chat"?" -mt-1":"text-center items-center justify-center")+" self-start text-gray-600 dark:text-gray-400")},m(i,o){I(i,e,o),p(e,t),p(e,l),p(e,s)},p(i,o){var a;o&32&&Z(t,i[5]),o&16&&r!==(r="flex w-full "+(((a=i[4])==null?void 0:a.landingPageMode)==="chat"?" -mt-1":"text-center items-center justify-center")+" self-start text-gray-600 dark:text-gray-400")&&c(e,"class",r)},i:Ne,o:Ne,d(i){i&&h(e)}}}function Iu(n){let e,t,l=n[3].t("Suggested")+"",s,r;return e=new ci({}),{c(){Q(e.$$.fragment),t=A(),s=q(l)},l(i){$(e.$$.fragment,i),t=H(i),s=F(i,l)},m(i,o){X(e,i,o),I(i,t,o),I(i,s,o),r=!0},p(i,o){(!r||o&8)&&l!==(l=i[3].t("Suggested")+"")&&Z(s,l)},i(i){r||(b(e.$$.fragment,i),r=!0)},o(i){y(e.$$.fragment,i),r=!1},d(i){i&&(h(t),h(s)),Y(e,i)}}}function Un(n){let e,t=[],l=new Map,s,r=Ce(n[2]);const i=o=>o[14].id||o[14].content;for(let o=0;o<r.length;o+=1){let a=zn(n,r,o),f=i(a);l.set(f,t[o]=Wn(f,a))}return{c(){e=E("div");for(let o=0;o<t.length;o+=1)t[o].c();this.h()},l(o){e=N(o,"DIV",{role:!0,class:!0});var a=k(e);for(let f=0;f<t.length;f+=1)t[f].l(a);a.forEach(h),this.h()},h(){c(e,"role","list"),c(e,"class",s="max-h-40 overflow-auto scrollbar-none items-start "+n[0]+" svelte-1co34if")},m(o,a){I(o,e,a);for(let f=0;f<t.length;f+=1)t[f]&&t[f].m(e,null)},p(o,a){a&14&&(r=Ce(o[2]),t=zt(t,a,i,1,o,r,l,e,Kr,Wn,null,zn)),a&1&&s!==(s="max-h-40 overflow-auto scrollbar-none items-start "+o[0]+" svelte-1co34if")&&c(e,"class",s)},d(o){o&&h(e);for(let a=0;a<t.length;a+=1)t[a].d()}}}function yu(n){let e,t=n[14].content+"",l,s,r,i=n[3].t("Prompt")+"",o;return{c(){e=E("div"),l=q(t),s=A(),r=E("div"),o=q(i),this.h()},l(a){e=N(a,"DIV",{class:!0});var f=k(e);l=F(f,t),f.forEach(h),s=H(a),r=N(a,"DIV",{class:!0});var u=k(r);o=F(u,i),u.forEach(h),this.h()},h(){c(e,"class","font-medium dark:text-gray-300 dark:group-hover:text-gray-200 transition line-clamp-1"),c(r,"class","text-xs text-gray-600 dark:text-gray-400 font-normal line-clamp-1")},m(a,f){I(a,e,f),p(e,l),I(a,s,f),I(a,r,f),p(r,o)},p(a,f){f&4&&t!==(t=a[14].content+"")&&Z(l,t),f&8&&i!==(i=a[3].t("Prompt")+"")&&Z(o,i)},d(a){a&&(h(e),h(s),h(r))}}}function Mu(n){let e,t=n[14].title[0]+"",l,s,r,i=n[14].title[1]+"",o;return{c(){e=E("div"),l=q(t),s=A(),r=E("div"),o=q(i),this.h()},l(a){e=N(a,"DIV",{class:!0});var f=k(e);l=F(f,t),f.forEach(h),s=H(a),r=N(a,"DIV",{class:!0});var u=k(r);o=F(u,i),u.forEach(h),this.h()},h(){c(e,"class","font-medium dark:text-gray-300 dark:group-hover:text-gray-200 transition line-clamp-1"),c(r,"class","text-xs text-gray-600 dark:text-gray-400 font-normal line-clamp-1")},m(a,f){I(a,e,f),p(e,l),I(a,s,f),I(a,r,f),p(r,o)},p(a,f){f&4&&t!==(t=a[14].title[0]+"")&&Z(l,t),f&4&&i!==(i=a[14].title[1]+"")&&Z(o,i)},d(a){a&&(h(e),h(s),h(r))}}}function Wn(n,e){let t,l,s,r,i;function o(d,g){return d[14].title&&d[14].title[0]!==""?Mu:yu}let a=o(e),f=a(e);function u(){return e[10](e[14])}return{key:n,first:null,c(){t=E("button"),l=E("div"),f.c(),s=A(),this.h()},l(d){t=N(d,"BUTTON",{role:!0,class:!0,style:!0});var g=k(t);l=N(g,"DIV",{class:!0});var m=k(l);f.l(m),m.forEach(h),s=H(g),g.forEach(h),this.h()},h(){c(l,"class","flex flex-col text-left"),c(t,"role","listitem"),c(t,"class","waterfall flex flex-col flex-1 shrink-0 w-full justify-between px-3 py-2 rounded-xl bg-transparent hover:bg-black/5 dark:hover:bg-white/5 transition group svelte-1co34if"),jt(t,"animation-delay",e[16]*60+"ms"),this.first=t},m(d,g){I(d,t,g),p(t,l),f.m(l,null),p(t,s),r||(i=ce(t,"click",u),r=!0)},p(d,g){e=d,a===(a=o(e))&&f?f.p(e,g):(f.d(1),f=a(e),f&&(f.c(),f.m(l,null))),g&4&&jt(t,"animation-delay",e[16]*60+"ms")},d(d){d&&h(t),f.d(),r=!1,i()}}}function Eu(n){let e,t,l,s,r,i;const o=[Iu,wu],a=[];function f(d,g){return d[2].length>0?0:1}t=f(n),l=a[t]=o[t](n);let u=n[2].length>0&&Un(n);return{c(){e=E("div"),l.c(),s=A(),r=E("div"),u&&u.c(),this.h()},l(d){e=N(d,"DIV",{class:!0});var g=k(e);l.l(g),g.forEach(h),s=H(d),r=N(d,"DIV",{class:!0});var m=k(r);u&&u.l(m),m.forEach(h),this.h()},h(){c(e,"class","mb-1 flex gap-1 text-xs font-medium items-center text-gray-600 dark:text-gray-400"),c(r,"class","h-40 w-full")},m(d,g){I(d,e,g),a[t].m(e,null),I(d,s,g),I(d,r,g),u&&u.m(r,null),i=!0},p(d,[g]){let m=t;t=f(d),t===m?a[t].p(d,g):(x(),y(a[m],1,1,()=>{a[m]=null}),ee(),l=a[t],l?l.p(d,g):(l=a[t]=o[t](d),l.c()),b(l,1),l.m(e,null)),d[2].length>0?u?u.p(d,g):(u=Un(d),u.c(),u.m(r,null)):u&&(u.d(1),u=null)},i(d){i||(b(l),i=!0)},o(d){y(l),i=!1},d(d){d&&(h(e),h(s),h(r)),a[t].d(),u&&u.d()}}}function Nu(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if((n[t].id??n[t].content)!==(e[t].id??e[t].content))return!1;return!0}function Du(n,e,t){let l,s,r;Te(n,pt,M=>t(4,s=M)),Te(n,Yr,M=>t(5,r=M));const i=Ge("i18n");Te(n,i,M=>t(3,l=M));let{suggestionPrompts:o=[]}=e,{className:a=""}=e,{inputValue:f=""}=e,{onSelect:u=M=>{}}=e,d=[];const g={keys:["content","title"],threshold:.5};let m,_=[];const D=M=>{if(M.length>500)t(2,_=[]);else{const T=M.trim()&&m?m.search(M.trim()).map(P=>P.item):d;Nu(_,T)||t(2,_=T)}},v=M=>u({type:"prompt",data:M.content});return n.$$set=M=>{"suggestionPrompts"in M&&t(7,o=M.suggestionPrompts),"className"in M&&t(0,a=M.className),"inputValue"in M&&t(8,f=M.inputValue),"onSelect"in M&&t(1,u=M.onSelect)},n.$$.update=()=>{n.$$.dirty&384&&o&&(t(9,d=[...o??[]].sort(()=>Math.random()-.5)),D(f)),n.$$.dirty&512&&(m=new yi(d,g)),n.$$.dirty&256&&D(f)},[a,u,_,l,s,r,i,o,f,d,v]}class Tu extends He{constructor(e){super(),ze(this,e,Du,Eu,Re,{suggestionPrompts:7,className:0,inputValue:8,onSelect:1})}}function qn(n,e,t){const l=n.slice();return l[13]=e[t],l[15]=t,l}function Cu(n){let e,t;return{c(){e=E("img"),this.h()},l(l){e=N(l,"IMG",{crossorigin:!0,src:!0,class:!0,alt:!0,draggable:!0}),this.h()},h(){var l,s,r;c(e,"crossorigin","anonymous"),At(e.src,t=((r=(s=(l=n[13])==null?void 0:l.info)==null?void 0:s.meta)==null?void 0:r.profile_image_url)??(n[5].language==="dg-DG"?`${xe}/doge.png`:`${xe}/static/favicon.png`))||c(e,"src",t),c(e,"class","size-[2.7rem] rounded-full border-[1px] border-gray-100 dark:border-none"),c(e,"alt","logo"),c(e,"draggable","false")},m(l,s){I(l,e,s)},p(l,s){var r,i,o;s&33&&!At(e.src,t=((o=(i=(r=l[13])==null?void 0:r.info)==null?void 0:i.meta)==null?void 0:o.profile_image_url)??(l[5].language==="dg-DG"?`${xe}/doge.png`:`${xe}/static/favicon.png`))&&c(e,"src",t)},d(l){l&&h(e)}}}function Fn(n){var a,f,u;let e,t,l,s,r,i;t=new Pe({props:{content:Ht.parse(kt(((u=(f=(a=n[0][n[4]])==null?void 0:a.info)==null?void 0:f.meta)==null?void 0:u.description)??"").replaceAll(`
`,"<br>")),placement:"right",$$slots:{default:[Cu]},$$scope:{ctx:n}}});function o(){return n[12](n[15])}return{c(){e=E("button"),Q(t.$$.fragment),l=A()},l(d){e=N(d,"BUTTON",{});var g=k(e);$(t.$$.fragment,g),l=H(g),g.forEach(h)},m(d,g){I(d,e,g),X(t,e,null),p(e,l),s=!0,r||(i=ce(e,"click",o),r=!0)},p(d,g){var _,D,v;n=d;const m={};g&17&&(m.content=Ht.parse(kt(((v=(D=(_=n[0][n[4]])==null?void 0:_.info)==null?void 0:D.meta)==null?void 0:v.description)??"").replaceAll(`
`,"<br>"))),g&65569&&(m.$$scope={dirty:g,ctx:n}),t.$set(m)},i(d){s||(b(t.$$.fragment,d),s=!0)},o(d){y(t.$$.fragment,d),s=!1},d(d){d&&h(e),Y(t),r=!1,i()}}}function Gn(n){let e,t;return e=new Pe({props:{content:n[5].t("This chat won't appear in history and your messages will not be saved."),className:"w-full flex justify-start mb-0.5",placement:"top",$$slots:{default:[Vu]},$$scope:{ctx:n}}}),{c(){Q(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},p(l,s){const r={};s&32&&(r.content=l[5].t("This chat won't appear in history and your messages will not be saved.")),s&65568&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){y(e.$$.fragment,l),t=!1},d(l){Y(e,l)}}}function Vu(n){let e,t,l=n[5].t("Temporary Chat")+"",s,r;return t=new Mi({props:{strokeWidth:"2.5",className:"size-5"}}),{c(){e=E("div"),Q(t.$$.fragment),s=q(l),this.h()},l(i){e=N(i,"DIV",{class:!0});var o=k(e);$(t.$$.fragment,o),s=F(o,l),o.forEach(h),this.h()},h(){c(e,"class","flex items-center gap-2 text-gray-500 font-medium text-lg mt-2 w-fit")},m(i,o){I(i,e,o),X(t,e,null),p(e,s),r=!0},p(i,o){(!r||o&32)&&l!==(l=i[5].t("Temporary Chat")+"")&&Z(s,l)},i(i){r||(b(t.$$.fragment,i),r=!0)},o(i){y(t.$$.fragment,i),r=!1},d(i){i&&h(e),Y(t)}}}function Su(n){var l;let e=n[5].t("Hello, {{name}}",{name:(l=n[7])==null?void 0:l.name})+"",t;return{c(){t=q(e)},l(s){t=F(s,e)},m(s,r){I(s,t,r)},p(s,r){var i;r&160&&e!==(e=s[5].t("Hello, {{name}}",{name:(i=s[7])==null?void 0:i.name})+"")&&Z(t,e)},d(s){s&&h(t)}}}function Bu(n){var l;let e=((l=n[0][n[4]])==null?void 0:l.name)+"",t;return{c(){t=q(e)},l(s){t=F(s,e)},m(s,r){I(s,t,r)},p(s,r){var i;r&17&&e!==(e=((i=s[0][s[4]])==null?void 0:i.name)+"")&&Z(t,e)},d(s){s&&h(t)}}}function Ou(n){let e,t=n[5].t("How can I help you today?")+"",l;return{c(){e=E("div"),l=q(t),this.h()},l(s){e=N(s,"DIV",{class:!0});var r=k(e);l=F(r,t),r.forEach(h),this.h()},h(){c(e,"class","font-medium text-gray-400 dark:text-gray-500 line-clamp-1 font-p")},m(s,r){I(s,e,r),p(e,l)},p(s,r){r&32&&t!==(t=s[5].t("How can I help you today?")+"")&&Z(l,t)},d(s){s&&h(e)}}}function Ru(n){var o,a,f,u,d,g;let e,t,l=Ht.parse(kt((f=(a=(o=n[0][n[4]])==null?void 0:o.info)==null?void 0:a.meta)==null?void 0:f.description).replaceAll(`
`,"<br>"))+"",s,r,i=((g=(d=(u=n[0][n[4]])==null?void 0:u.info)==null?void 0:d.meta)==null?void 0:g.user)&&Jn(n);return{c(){e=E("div"),t=new Gr(!1),s=A(),i&&i.c(),r=ae(),this.h()},l(m){e=N(m,"DIV",{class:!0});var _=k(e);t=Jr(_,!1),_.forEach(h),s=H(m),i&&i.l(m),r=ae(),this.h()},h(){t.a=null,c(e,"class","mt-0.5 text-base font-normal text-gray-500 dark:text-gray-400 line-clamp-3 markdown")},m(m,_){I(m,e,_),t.m(l,e),I(m,s,_),i&&i.m(m,_),I(m,r,_)},p(m,_){var D,v,M,T,P,L;_&17&&l!==(l=Ht.parse(kt((M=(v=(D=m[0][m[4]])==null?void 0:D.info)==null?void 0:v.meta)==null?void 0:M.description).replaceAll(`
`,"<br>"))+"")&&t.p(l),(L=(P=(T=m[0][m[4]])==null?void 0:T.info)==null?void 0:P.meta)!=null&&L.user?i?i.p(m,_):(i=Jn(m),i.c(),i.m(r.parentNode,r)):i&&(i.d(1),i=null)},d(m){m&&(h(e),h(s),h(r)),i&&i.d(m)}}}function Jn(n){let e,t;function l(i,o){var a,f,u;return(u=(f=(a=i[0][i[4]])==null?void 0:a.info)==null?void 0:f.meta)!=null&&u.user.community?Lu:Pu}let s=l(n),r=s(n);return{c(){e=E("div"),t=q(`By
								`),r.c(),this.h()},l(i){e=N(i,"DIV",{class:!0});var o=k(e);t=F(o,`By
								`),r.l(o),o.forEach(h),this.h()},h(){c(e,"class","mt-0.5 text-sm font-normal text-gray-400 dark:text-gray-500")},m(i,o){I(i,e,o),p(e,t),r.m(e,null)},p(i,o){s===(s=l(i))&&r?r.p(i,o):(r.d(1),r=s(i),r&&(r.c(),r.m(e,null)))},d(i){i&&h(e),r.d()}}}function Pu(n){var l,s,r;let e=((r=(s=(l=n[0][n[4]])==null?void 0:l.info)==null?void 0:s.meta)==null?void 0:r.user.name)+"",t;return{c(){t=q(e)},l(i){t=F(i,e)},m(i,o){I(i,t,o)},p(i,o){var a,f,u;o&17&&e!==(e=((u=(f=(a=i[0][i[4]])==null?void 0:a.info)==null?void 0:f.meta)==null?void 0:u.user.name)+"")&&Z(t,e)},d(i){i&&h(t)}}}function Lu(n){var r,i,o,a,f,u,d,g,m;let e,t=((o=(i=(r=n[0][n[4]])==null?void 0:r.info)==null?void 0:i.meta)!=null&&o.user.name?(u=(f=(a=n[0][n[4]])==null?void 0:a.info)==null?void 0:f.meta)==null?void 0:u.user.name:`@${(m=(g=(d=n[0][n[4]])==null?void 0:d.info)==null?void 0:g.meta)==null?void 0:m.user.username}`)+"",l,s;return{c(){e=E("a"),l=q(t),this.h()},l(_){e=N(_,"A",{href:!0});var D=k(e);l=F(D,t),D.forEach(h),this.h()},h(){var _,D,v;c(e,"href",s="https://openwebui.com/m/"+((v=(D=(_=n[0][n[4]])==null?void 0:_.info)==null?void 0:D.meta)==null?void 0:v.user.username))},m(_,D){I(_,e,D),p(e,l)},p(_,D){var v,M,T,P,L,S,w,C,V,O,B,G;D&17&&t!==(t=((T=(M=(v=_[0][_[4]])==null?void 0:v.info)==null?void 0:M.meta)!=null&&T.user.name?(S=(L=(P=_[0][_[4]])==null?void 0:P.info)==null?void 0:L.meta)==null?void 0:S.user.name:`@${(V=(C=(w=_[0][_[4]])==null?void 0:w.info)==null?void 0:C.meta)==null?void 0:V.user.username}`)+"")&&Z(l,t),D&17&&s!==(s="https://openwebui.com/m/"+((G=(B=(O=_[0][_[4]])==null?void 0:O.info)==null?void 0:B.meta)==null?void 0:G.user.username))&&c(e,"href",s)},d(_){_&&h(e)}}}function Kn(n){var j,ue,le,he,J,oe,me;let e,t,l,s,r,i,o,a,f,u,d,g,m,_,D,v,M,T,P=Ce(n[0]),L=[];for(let re=0;re<P.length;re+=1)L[re]=Fn(qn(n,P,re));const S=re=>y(L[re],1,1,()=>{L[re]=null});let w=n[6]&&Gn(n);function C(re,ie){var ge;return(ge=re[0][re[4]])!=null&&ge.name?Bu:Su}let V=C(n),O=V(n);function B(re,ie){var ge,se,fe;return((fe=(se=(ge=re[0][re[4]])==null?void 0:ge.info)==null?void 0:se.meta)==null?void 0:fe.description)??null?Ru:Ou}let G=B(n),U=G(n);return v=new Tu({props:{className:"grid grid-cols-2",suggestionPrompts:((le=(ue=(j=n[1])==null?void 0:j.info)==null?void 0:ue.meta)==null?void 0:le.suggestion_prompts)??((oe=(J=(he=n[0][n[4]])==null?void 0:he.info)==null?void 0:J.meta)==null?void 0:oe.suggestion_prompts)??((me=n[8])==null?void 0:me.default_prompt_suggestions)??[],onSelect:n[2]}}),{c(){e=E("div"),t=E("div"),l=E("div");for(let re=0;re<L.length;re+=1)L[re].c();r=A(),w&&w.c(),i=A(),o=E("div"),a=E("div"),f=E("div"),O.c(),d=A(),g=E("div"),U.c(),_=A(),D=E("div"),Q(v.$$.fragment),this.h()},l(re){e=N(re,"DIV",{class:!0});var ie=k(e);t=N(ie,"DIV",{class:!0});var ge=k(t);l=N(ge,"DIV",{class:!0});var se=k(l);for(let we=0;we<L.length;we+=1)L[we].l(se);se.forEach(h),ge.forEach(h),r=H(ie),w&&w.l(ie),i=H(ie),o=N(ie,"DIV",{class:!0});var fe=k(o);a=N(fe,"DIV",{});var Me=k(a);f=N(Me,"DIV",{class:!0});var Ee=k(f);O.l(Ee),Ee.forEach(h),d=H(Me),g=N(Me,"DIV",{});var ve=k(g);U.l(ve),ve.forEach(h),Me.forEach(h),fe.forEach(h),_=H(ie),D=N(ie,"DIV",{class:!0});var Se=k(D);$(v.$$.fragment,Se),Se.forEach(h),ie.forEach(h),this.h()},h(){c(l,"class","flex -space-x-4 mb-0.5"),c(t,"class","flex justify-start"),c(f,"class","capitalize line-clamp-1"),c(o,"class","mt-2 mb-4 text-3xl text-gray-800 dark:text-gray-100 font-medium text-left flex items-center gap-4 font-primary"),c(D,"class","w-full font-primary"),c(e,"class","m-auto w-full max-w-6xl px-8 lg:px-20")},m(re,ie){I(re,e,ie),p(e,t),p(t,l);for(let ge=0;ge<L.length;ge+=1)L[ge]&&L[ge].m(l,null);p(e,r),w&&w.m(e,null),p(e,i),p(e,o),p(o,a),p(a,f),O.m(f,null),p(a,d),p(a,g),U.m(g,null),p(e,_),p(e,D),X(v,D,null),T=!0},p(re,ie){var se,fe,Me,Ee,ve,Se,we;if(ie&49){P=Ce(re[0]);let ke;for(ke=0;ke<P.length;ke+=1){const R=qn(re,P,ke);L[ke]?(L[ke].p(R,ie),b(L[ke],1)):(L[ke]=Fn(R),L[ke].c(),b(L[ke],1),L[ke].m(l,null))}for(x(),ke=P.length;ke<L.length;ke+=1)S(ke);ee()}re[6]?w?(w.p(re,ie),ie&64&&b(w,1)):(w=Gn(re),w.c(),b(w,1),w.m(e,i)):w&&(x(),y(w,1,1,()=>{w=null}),ee()),V===(V=C(re))&&O?O.p(re,ie):(O.d(1),O=V(re),O&&(O.c(),O.m(f,null))),G===(G=B(re))&&U?U.p(re,ie):(U.d(1),U=G(re),U&&(U.c(),U.m(g,null)));const ge={};ie&275&&(ge.suggestionPrompts=((Me=(fe=(se=re[1])==null?void 0:se.info)==null?void 0:fe.meta)==null?void 0:Me.suggestion_prompts)??((Se=(ve=(Ee=re[0][re[4]])==null?void 0:Ee.info)==null?void 0:ve.meta)==null?void 0:Se.suggestion_prompts)??((we=re[8])==null?void 0:we.default_prompt_suggestions)??[]),ie&4&&(ge.onSelect=re[2]),v.$set(ge)},i(re){if(!T){for(let ie=0;ie<P.length;ie+=1)b(L[ie]);re&&(s||Et(()=>{s=Nt(l,Dt,{duration:200}),s.start()})),b(w),re&&(u||Et(()=>{u=Nt(f,Dt,{duration:200}),u.start()})),re&&(m||Et(()=>{m=Nt(g,Dt,{duration:200,delay:200}),m.start()})),b(v.$$.fragment,re),re&&(M||Et(()=>{M=Nt(D,Dt,{duration:200,delay:300}),M.start()})),T=!0}},o(re){L=L.filter(Boolean);for(let ie=0;ie<L.length;ie+=1)y(L[ie]);y(w),y(v.$$.fragment,re),T=!1},d(re){re&&h(e),Fe(L,re),w&&w.d(),O.d(),U.d(),Y(v)}}}function ju(n){let e=n[3],t,l,s=Kn(n);return{c(){s.c(),t=ae()},l(r){s.l(r),t=ae()},m(r,i){s.m(r,i),I(r,t,i),l=!0},p(r,[i]){i&8&&Re(e,e=r[3])?(x(),y(s,1,1,Ne),ee(),s=Kn(r),s.c(),b(s,1),s.m(t.parentNode,t)):s.p(r,i)},i(r){l||(b(s),l=!0)},o(r){y(s),l=!1},d(r){r&&h(t),s.d(r)}}}function Au(n,e,t){let l,s,r,i,o;Te(n,Ct,v=>t(11,l=v)),Te(n,Yt,v=>t(6,r=v)),Te(n,Ut,v=>t(7,i=v)),Te(n,rr,v=>t(8,o=v));const a=Ge("i18n");Te(n,a,v=>t(5,s=v));let{modelIds:f=[]}=e,{models:u=[]}=e,{atSelectedModel:d}=e,{onSelect:g=v=>{}}=e,m=!1,_=0;It(()=>{t(3,m=!0)});const D=v=>{t(4,_=v)};return n.$$set=v=>{"modelIds"in v&&t(10,f=v.modelIds),"models"in v&&t(0,u=v.models),"atSelectedModel"in v&&t(1,d=v.atSelectedModel),"onSelect"in v&&t(2,g=v.onSelect)},n.$$.update=()=>{n.$$.dirty&3072&&t(0,u=f.map(v=>l.find(M=>M.id===v))),n.$$.dirty&1025&&f.length>0&&t(4,_=u.length-1)},[u,d,g,m,_,s,r,i,o,a,f,l,D]}class Hu extends He{constructor(e){super(),ze(this,e,Au,ju,Re,{modelIds:10,models:0,atSelectedModel:1,onSelect:2})}}function Zn(n,e,t){const l=n.slice();return l[45]=e[t],l[47]=t,l}function zu(n){let e,t=n[2],l,s=$n(n);return{c(){e=E("div"),s.c(),this.h()},l(r){e=N(r,"DIV",{class:!0});var i=k(e);s.l(i),i.forEach(h),this.h()},h(){c(e,"class","w-full pt-2")},m(r,i){I(r,e,i),s.m(e,null),l=!0},p(r,i){i[0]&4&&Re(t,t=r[2])?(x(),y(s,1,1,Ne),ee(),s=$n(r),s.c(),b(s,1),s.m(e,null)):s.p(r,i)},i(r){l||(b(s),l=!0)},o(r){y(s),l=!1},d(r){r&&h(e),s.d(r)}}}function Uu(n){let e,t;return e=new Hu({props:{modelIds:n[4],atSelectedModel:n[5],onSelect:n[15]}}),{c(){Q(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},p(l,s){const r={};s[0]&16&&(r.modelIds=l[4]),s[0]&32&&(r.atSelectedModel=l[5]),s[0]&32768&&(r.onSelect=l[15]),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){y(e.$$.fragment,l),t=!1},d(l){Y(e,l)}}}function Qn(n){let e,t;return e=new Ii({props:{$$slots:{default:[Wu]},$$scope:{ctx:n}}}),e.$on("visible",n[36]),{c(){Q(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},p(l,s){const r={};s[1]&131072&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){y(e.$$.fragment,l),t=!1},d(l){Y(e,l)}}}function Wu(n){let e,t,l,s,r="Loading...",i;return t=new tl({props:{className:" size-4"}}),{c(){e=E("div"),Q(t.$$.fragment),l=A(),s=E("div"),s.textContent=r,this.h()},l(o){e=N(o,"DIV",{class:!0});var a=k(e);$(t.$$.fragment,a),l=H(a),s=N(a,"DIV",{class:!0,"data-svelte-h":!0}),st(s)!=="svelte-17uns3n"&&(s.textContent=r),a.forEach(h),this.h()},h(){c(s,"class",""),c(e,"class","w-full flex justify-center py-1 text-xs animate-pulse items-center gap-2")},m(o,a){I(o,e,a),X(t,e,null),p(e,l),p(e,s),i=!0},p:Ne,i(o){i||(b(t.$$.fragment,o),i=!0)},o(o){y(t.$$.fragment,o),i=!1},d(o){o&&h(e),Y(t)}}}function Xn(n,e){let t,l,s,r;function i(a){e[37](a)}let o={chatId:e[2],selectedModels:e[4],messageId:e[45].id,idx:e[47],user:e[3],setInputText:e[6],gotoMessage:e[21],showPreviousMessage:e[22],showNextMessage:e[23],updateChat:e[20],editMessage:e[25],deleteMessage:e[28],rateMessage:e[24],actionMessage:e[26],saveMessage:e[27],submitMessage:e[10],regenerateResponse:e[8],continueResponse:e[7],mergeResponses:e[9],addMessages:e[11],triggerScroll:e[29],readOnly:e[12],topPadding:e[13]};return e[0]!==void 0&&(o.history=e[0]),l=new ku({props:o}),We.push(()=>Ze(l,"history",i)),{key:n,first:null,c(){t=ae(),Q(l.$$.fragment),this.h()},l(a){t=ae(),$(l.$$.fragment,a),this.h()},h(){this.first=t},m(a,f){I(a,t,f),X(l,a,f),r=!0},p(a,f){e=a;const u={};f[0]&4&&(u.chatId=e[2]),f[0]&16&&(u.selectedModels=e[4]),f[0]&65536&&(u.messageId=e[45].id),f[0]&65536&&(u.idx=e[47]),f[0]&8&&(u.user=e[3]),f[0]&64&&(u.setInputText=e[6]),f[0]&1024&&(u.submitMessage=e[10]),f[0]&256&&(u.regenerateResponse=e[8]),f[0]&128&&(u.continueResponse=e[7]),f[0]&512&&(u.mergeResponses=e[9]),f[0]&2048&&(u.addMessages=e[11]),f[0]&4096&&(u.readOnly=e[12]),f[0]&8192&&(u.topPadding=e[13]),!s&&f[0]&1&&(s=!0,u.history=e[0],Qe(()=>s=!1)),l.$set(u)},i(a){r||(b(l.$$.fragment,a),r=!0)},o(a){y(l.$$.fragment,a),r=!1},d(a){a&&h(t),Y(l,a)}}}function Yn(n){let e;return{c(){e=E("div"),this.h()},l(t){e=N(t,"DIV",{class:!0}),k(e).forEach(h),this.h()},h(){c(e,"class","pb-6")},m(t,l){I(t,e,l)},d(t){t&&h(e)}}}function $n(n){var D;let e,t=((D=n[16].at(0))==null?void 0:D.parentId)!==null,l,s=[],r=new Map,i,o,a,f,u,d=t&&Qn(n),g=Ce(n[16]);const m=v=>v[45].id;for(let v=0;v<g.length;v+=1){let M=Zn(n,g,v),T=m(M);r.set(T,s[v]=Xn(T,M))}let _=n[14]&&Yn();return{c(){e=E("div"),d&&d.c(),l=A();for(let v=0;v<s.length;v+=1)s[v].c();i=A(),o=E("div"),a=A(),_&&_.c(),f=ae(),this.h()},l(v){e=N(v,"DIV",{class:!0});var M=k(e);d&&d.l(M),l=H(M);for(let T=0;T<s.length;T+=1)s[T].l(M);M.forEach(h),i=H(v),o=N(v,"DIV",{class:!0}),k(o).forEach(h),a=H(v),_&&_.l(v),f=ae(),this.h()},h(){c(e,"class","w-full"),c(o,"class","pb-12")},m(v,M){I(v,e,M),d&&d.m(e,null),p(e,l);for(let T=0;T<s.length;T+=1)s[T]&&s[T].m(e,null);I(v,i,M),I(v,o,M),I(v,a,M),_&&_.m(v,M),I(v,f,M),u=!0},p(v,M){var T;M[0]&65536&&(t=((T=v[16].at(0))==null?void 0:T.parentId)!==null),t?d?(d.p(v,M),M[0]&65536&&b(d,1)):(d=Qn(v),d.c(),b(d,1),d.m(e,l)):d&&(x(),y(d,1,1,()=>{d=null}),ee()),M[0]&1072775133&&(g=Ce(v[16]),x(),s=zt(s,M,m,1,v,g,r,e,Xt,Xn,null,Zn),ee()),v[14]?_||(_=Yn(),_.c(),_.m(f.parentNode,f)):_&&(_.d(1),_=null)},i(v){if(!u){b(d);for(let M=0;M<g.length;M+=1)b(s[M]);u=!0}},o(v){y(d);for(let M=0;M<s.length;M+=1)y(s[M]);u=!1},d(v){v&&(h(e),h(i),h(o),h(a),h(f)),d&&d.d();for(let M=0;M<s.length;M+=1)s[M].d();_&&_.d(v)}}}function qu(n){let e,t,l,s,r;const i=[Uu,zu],o=[];function a(f,u){var d;return u[0]&1&&(t=null),t==null&&(t=Object.keys(((d=f[0])==null?void 0:d.messages)??{}).length==0),t?0:1}return l=a(n,[-1,-1]),s=o[l]=i[l](n),{c(){e=E("div"),s.c(),this.h()},l(f){e=N(f,"DIV",{class:!0});var u=k(e);s.l(u),u.forEach(h),this.h()},h(){c(e,"class",n[1])},m(f,u){I(f,e,u),o[l].m(e,null),r=!0},p(f,u){let d=l;l=a(f,u),l===d?o[l].p(f,u):(x(),y(o[d],1,1,()=>{o[d]=null}),ee(),s=o[l],s?s.p(f,u):(s=o[l]=i[l](f),s.c()),b(s,1),s.m(e,null)),(!r||u[0]&2)&&c(e,"class",f[1])},i(f){r||(b(s),r=!0)},o(f){y(s),r=!1},d(f){f&&h(e),o[l].d()}}}function Fu(n,e,t){let l,s,r,i,o;Te(n,pt,R=>t(39,s=R)),Te(n,El,R=>t(40,r=R)),Te(n,Yt,R=>t(41,i=R)),Te(n,Ut,R=>t(42,o=R)),Tt();const a=Ge("i18n");Te(n,a,R=>t(38,l=R));let{className:f="h-full flex pt-8"}=e,{chatId:u=""}=e,{user:d=o}=e,{prompt:g}=e,{history:m={}}=e,{selectedModels:_}=e,{atSelectedModel:D}=e,v=[],{setInputText:M=()=>{}}=e,{sendMessage:T}=e,{continueResponse:P}=e,{regenerateResponse:L}=e,{mergeResponses:S}=e,{chatActionHandler:w}=e,{showMessage:C=()=>{}}=e,{submitMessage:V=()=>{}}=e,{addMessages:O=()=>{}}=e,{readOnly:B=!1}=e,{topPadding:G=!1}=e,{bottomPadding:U=!1}=e,{autoScroll:j}=e,{onSelect:ue=R=>{}}=e,le=20,he=!1;const J=async()=>{const R=document.getElementById("messages-container");R.scrollTop=R.scrollTop+100,t(17,he=!0),t(35,le+=20),await Oe(),t(17,he=!1)},oe=()=>{const R=document.getElementById("messages-container");R.scrollTop=R.scrollHeight},me=async()=>{i||(t(0,m),await Oe(),await ei(localStorage.token,u,{history:m,messages:v}),El.set(1),await $r.set(await ti(localStorage.token,r)))},re=async(R,K)=>{let ne;R.parentId!==null?ne=m.messages[R.parentId].childrenIds:ne=Object.values(m.messages).filter(ye=>ye.parentId===null).map(ye=>ye.id),K=Math.max(0,Math.min(K,ne.length-1));let be=ne[K];if(R.id!==be){let ye=m.messages[be].childrenIds;for(;ye.length!==0;)be=ye.at(-1),ye=m.messages[be].childrenIds;t(0,m.currentId=be,m)}if(await Oe(),(s==null?void 0:s.scrollOnBranchChange)??!0){const ye=document.getElementById("messages-container");t(30,j=ye.scrollHeight-ye.scrollTop<=ye.clientHeight+50),setTimeout(()=>{oe()},100)}},ie=async R=>{if(R.parentId!==null){let K=m.messages[R.parentId].childrenIds[Math.max(m.messages[R.parentId].childrenIds.indexOf(R.id)-1,0)];if(R.id!==K){let ne=m.messages[K].childrenIds;for(;ne.length!==0;)K=ne.at(-1),ne=m.messages[K].childrenIds;t(0,m.currentId=K,m)}}else{let K=Object.values(m.messages).filter(be=>be.parentId===null).map(be=>be.id),ne=K[Math.max(K.indexOf(R.id)-1,0)];if(R.id!==ne){let be=m.messages[ne].childrenIds;for(;be.length!==0;)ne=be.at(-1),be=m.messages[ne].childrenIds;t(0,m.currentId=ne,m)}}if(await Oe(),(s==null?void 0:s.scrollOnBranchChange)??!0){const K=document.getElementById("messages-container");t(30,j=K.scrollHeight-K.scrollTop<=K.clientHeight+50),setTimeout(()=>{oe()},100)}},ge=async R=>{if(R.parentId!==null){let K=m.messages[R.parentId].childrenIds[Math.min(m.messages[R.parentId].childrenIds.indexOf(R.id)+1,m.messages[R.parentId].childrenIds.length-1)];if(R.id!==K){let ne=m.messages[K].childrenIds;for(;ne.length!==0;)K=ne.at(-1),ne=m.messages[K].childrenIds;t(0,m.currentId=K,m)}}else{let K=Object.values(m.messages).filter(be=>be.parentId===null).map(be=>be.id),ne=K[Math.min(K.indexOf(R.id)+1,K.length-1)];if(R.id!==ne){let be=m.messages[ne].childrenIds;for(;be.length!==0;)ne=be.at(-1),be=m.messages[ne].childrenIds;t(0,m.currentId=ne,m)}}if(await Oe(),(s==null?void 0:s.scrollOnBranchChange)??!0){const K=document.getElementById("messages-container");t(30,j=K.scrollHeight-K.scrollTop<=K.clientHeight+50),setTimeout(()=>{oe()},100)}},se=async(R,K)=>{t(0,m.messages[R].annotation={...m.messages[R].annotation,rating:K},m),await me()},fe=async(R,{content:K,files:ne},be=!0)=>{if((_??[]).filter(ye=>ye).length===0){qe.error(l.t("Model not selected"));return}if(m.messages[R].role==="user")if(be){let ye=K,W=Dl(),de={id:W,parentId:m.messages[R].parentId,childrenIds:[],role:"user",content:ye,...ne&&{files:ne},models:_,timestamp:Math.floor(Date.now()/1e3)},Ie=m.messages[R].parentId;Ie!==null&&t(0,m.messages[Ie].childrenIds=[...m.messages[Ie].childrenIds,W],m),t(0,m.messages[W]=de,m),t(0,m.currentId=W,m),await Oe(),await T(m,W)}else t(0,m.messages[R].content=K,m),t(0,m.messages[R].files=ne,m),await me();else if(be){const ye=Dl(),W=m.messages[R],de=W.parentId,Ie={...W,id:ye,parentId:de,childrenIds:[],files:void 0,content:K,timestamp:Math.floor(Date.now()/1e3)};t(0,m.messages[ye]=Ie,m),t(0,m.currentId=ye,m),de!==null&&t(0,m.messages[de].childrenIds=[...m.messages[de].childrenIds,ye],m),await me()}else t(0,m.messages[R].originalContent=m.messages[R].content,m),t(0,m.messages[R].content=K,m),await me()},Me=async(R,K,ne=null)=>{await w(u,R,K.model,K.id,ne)},Ee=async(R,K)=>{t(0,m.messages[R]=K,m),await me()},ve=async R=>{const K=m.messages[R],ne=K.parentId,be=K.childrenIds??[],ye=be.flatMap(W=>{var de;return((de=m.messages[W])==null?void 0:de.childrenIds)??[]});ne&&m.messages[ne]&&t(0,m.messages[ne].childrenIds=[...m.messages[ne].childrenIds.filter(W=>W!==R),...ye],m),ye.forEach(W=>{m.messages[W]&&t(0,m.messages[W].parentId=ne,m)}),[R,...be].forEach(W=>{delete m.messages[W]}),await Oe(),C({id:ne}),await me()},Se=()=>{if(j){const R=document.getElementById("messages-container");t(30,j=R.scrollHeight-R.scrollTop<=R.clientHeight+50),setTimeout(()=>{oe()},100)}},we=R=>{he||J()};function ke(R){m=R,t(0,m)}return n.$$set=R=>{"className"in R&&t(1,f=R.className),"chatId"in R&&t(2,u=R.chatId),"user"in R&&t(3,d=R.user),"prompt"in R&&t(31,g=R.prompt),"history"in R&&t(0,m=R.history),"selectedModels"in R&&t(4,_=R.selectedModels),"atSelectedModel"in R&&t(5,D=R.atSelectedModel),"setInputText"in R&&t(6,M=R.setInputText),"sendMessage"in R&&t(32,T=R.sendMessage),"continueResponse"in R&&t(7,P=R.continueResponse),"regenerateResponse"in R&&t(8,L=R.regenerateResponse),"mergeResponses"in R&&t(9,S=R.mergeResponses),"chatActionHandler"in R&&t(33,w=R.chatActionHandler),"showMessage"in R&&t(34,C=R.showMessage),"submitMessage"in R&&t(10,V=R.submitMessage),"addMessages"in R&&t(11,O=R.addMessages),"readOnly"in R&&t(12,B=R.readOnly),"topPadding"in R&&t(13,G=R.topPadding),"bottomPadding"in R&&t(14,U=R.bottomPadding),"autoScroll"in R&&t(30,j=R.autoScroll),"onSelect"in R&&t(15,ue=R.onSelect)},n.$$.update=()=>{if(n.$$.dirty[0]&1|n.$$.dirty[1]&16)if(m.currentId){let R=[],K=m.messages[m.currentId];for(;K&&R.length<=le;)R.unshift({...K}),K=K.parentId!==null?m.messages[K.parentId]:null;t(16,v=R)}else t(16,v=[]);n.$$.dirty[0]&1073758208&&j&&U&&(async()=>(await Oe(),oe()))()},[m,f,u,d,_,D,M,P,L,S,V,O,B,G,U,ue,v,he,a,J,me,re,ie,ge,se,fe,Me,Ee,ve,Se,j,g,T,w,C,le,we,ke]}class Rc extends He{constructor(e){super(),ze(this,e,Fu,qu,Re,{className:1,chatId:2,user:3,prompt:31,history:0,selectedModels:4,atSelectedModel:5,setInputText:6,sendMessage:32,continueResponse:7,regenerateResponse:8,mergeResponses:9,chatActionHandler:33,showMessage:34,submitMessage:10,addMessages:11,readOnly:12,topPadding:13,bottomPadding:14,autoScroll:30,onSelect:15},null,[-1,-1])}}export{fo as K,Rc as M,Tu as S};
//# sourceMappingURL=Chu_zp82.js.map
