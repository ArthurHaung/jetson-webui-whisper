var mD=Object.defineProperty;var hv=n=>{throw TypeError(n)};var pD=(n,e,t)=>e in n?mD(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var Ue=(n,e,t)=>pD(n,typeof e!="symbol"?e+"":e,t),sw=(n,e,t)=>e.has(n)||hv("Cannot "+t);var x=(n,e,t)=>(sw(n,e,"read from private field"),t?t.call(n):e.get(n)),U=(n,e,t)=>e.has(n)?hv("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),O=(n,e,t,i)=>(sw(n,e,"write to private field"),i?i.call(n,t):e.set(n,t),t),F=(n,e,t)=>(sw(n,e,"access private method"),t);var Fr=(n,e,t,i)=>({set _(s){O(n,e,s,t)},get _(){return x(n,e,i)}});import{S as Nt,i as Ot,s as Ft,H as At,I as qt,e as te,l as Ae,C as pe,c as ne,p as Se,D as ye,f as A,Z as rn,g as ee,E as be,G as pt,K as Wt,q as L,r as j,d as S,F as xe,k as Pe,v as hs,M as hn,a as V,x as Xs,z as Ys,A as Js,B as Zs,m as Ut,y as ot,u as lt,X as To,h as q,N as nt,O as it,t as _t,b as vt,j as St,$ as Ro,n as kt,T as eo,w as fl,U as $h,P as ia,a3 as k0,J as Zg,L as So,a0 as r4,a1 as a4,as as bn,aa as is,ab as li,ac as gl,ae as ua,_ as js,a8 as Ye,ah as Dp,at as x3,am as zI,a7 as y3,ag as Yn,ad as Mg,W as h0,aj as bD,au as xD,ap as yD,an as uv,ao as dv,Y as fv,V as Ox,a4 as e1,o as wD}from"./BCvnKofF.js";import{g as jI}from"./D0QH3NT1.js";import"./IHki7fMi.js";import{t as Jt}from"./DZnh-gzO.js";import{j as $o,bB as GI,bC as o4,bD as rw,bE as aw,aG as Qg,bF as _D,aq as vD,bG as kD,bH as CD,bI as AD,bJ as SD}from"./BxwRg2Dc.js";import{C as ID,D as ED,I as TD,a as RD,h as MD,b as VI,c as PD,P as ND}from"./Fxg2rT5y.js";import{w as nn,a as No,d as t1,g as gv}from"./xuwbn1vA.js";import{p as mv}from"./BmJE08SH.js";import{t as Jd,u as T0,c as $g,m as cx,E as qI,a as Ya,n as Gd,d as em,T as r8,g as tl,e as OD,_ as pv,$ as Va,L as Qi,P as u0,K as ic,W as WI,i as xu,s as a8,J as DD,j as FD,f as bv,C as LD,N as BD,Q as n1,D as Tl,F as _c,o as UD,S as Dx,l as HD}from"./__JRYNd1.js";import{v as Rl,L as xv,M as zD,b as da,a as jD,i as GD,j as VD,k as qD,n as WD,o as KD,p as XD,m as Pg,q as YD,f as l4,y as JD,l as ZD,g as QD,w as w3,N as $D,O as eF,P as tF,d as nF,E as ow,D as lw}from"./563rTQSo.js";import{h as o8,v as iF,j as D0,C as sF,u as cw,e as rF,a as aF}from"./CRKgkQeq.js";import{g as oF}from"./CzjYtDrJ.js";import{p as lF,c as cF}from"./CBKxn51Y.js";import{j as yv,g as wv,l as _v}from"./9LbPmuGo.js";import{w as hF,x as uF,y as dF,z as fF,A as gF,B as mF,C as pF}from"./D91jHgxN.js";import{g as c4,j as bF,k as xF,m as yF}from"./xj_uBj-E.js";import{f as i1}from"./BkbMBbnp.js";import _3 from"./CF4_YkFU.js";import{e as Qn,u as hx,o as Z5,d as wF}from"./CSm0urZa.js";import{u as _F}from"./D6CENwhP.js";import"./BPHf6JLV.js";import{M as KI,a as XI,b as YI,E as vv,h as vF}from"./DAap3lXm.js";import{b as h4,c as ba}from"./DON4Monn.js";import{f as Q5}from"./CBc5jlPY.js";import{D as u4}from"./BaykB1nf.js";import{T as Ci}from"./APGfqsGw.js";import{S as kF}from"./tdSpSj3L.js";import{W as CF,B as d4}from"./C5TGS3lC.js";import{V as AF,R as SF,D as IF}from"./B3ekWpbL.js";import{F as EF}from"./05LA_aw1.js";import{M as TF}from"./CAH0SlZd.js";import{X as ux}from"./BKFELi7o.js";import{F as JI}from"./CZjVz-mK.js";import{G as RF}from"./bJmCJBZA.js";import{a as MF}from"./DVRWqTFx.js";import{K as PF,S as NF,M as OF}from"./Chu_zp82.js";import{T as DF,S as FF,F as LF,a as BF,u as UF,d as HF}from"./C1Vc74pn.js";import{S as zF}from"./CtGD3hzL.js";import{f as ZI,A as jF}from"./BGshmsd7.js";import{M as GF,U as VF}from"./BOwlRIJ5.js";import{P as qF}from"./IshcvDtC.js";import{S as WF}from"./BMxeivvf.js";import{A as KF}from"./By1-Ss5A.js";import{g as XF,j as YF,k as JF,m as ZF}from"./MGwuBfPN.js";import{S as f4}from"./CVAJiM1o.js";import{V as QF,H as $F}from"./D9qucroO.js";import{s as eL,t as tL}from"./BhRMWZDW.js";import{P as QI}from"./CpfZ3bFL.js";import{g as Gh,a as Fp}from"./CgU5AtxT.js";import{E as nL}from"./B76JyeGP.js";import{C as $I}from"./OFvj_JRi.js";import{E as iL}from"./BCAb_axV.js";import{d as l8}from"./I1CDPYOB.js";import{C as $5}from"./Re39ekWt.js";import{C as eE}from"./C11Xkt-C.js";import{E as sL}from"./Cf1cxNje.js";function rL(n){let e;for(;e=n.sourceEvent;)n=e;return n}function Ml(n,e){if(n=rL(n),e===void 0&&(e=n.currentTarget),e){var t=e.ownerSVGElement||e;if(t.createSVGPoint){var i=t.createSVGPoint();return i.x=n.clientX,i.y=n.clientY,i=i.matrixTransform(e.getScreenCTM().inverse()),[i.x,i.y]}if(e.getBoundingClientRect){var s=e.getBoundingClientRect();return[n.clientX-s.left-e.clientLeft,n.clientY-s.top-e.clientTop]}}return[n.pageX,n.pageY]}const aL={passive:!1},Lp={capture:!0,passive:!1};function hw(n){n.stopImmediatePropagation()}function s1(n){n.preventDefault(),n.stopImmediatePropagation()}function tE(n){var e=n.document.documentElement,t=$o(n).on("dragstart.drag",s1,Lp);"onselectstart"in e?t.on("selectstart.drag",s1,Lp):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function nE(n,e){var t=n.document.documentElement,i=$o(n).on("dragstart.drag",null);e&&(i.on("click.drag",s1,Lp),setTimeout(function(){i.on("click.drag",null)},0)),"onselectstart"in t?i.on("selectstart.drag",null):(t.style.MozUserSelect=t.__noselect,delete t.__noselect)}const Fx=n=>()=>n;function c8(n,{sourceEvent:e,subject:t,target:i,identifier:s,active:r,x:a,y:o,dx:l,dy:c,dispatch:h}){Object.defineProperties(this,{type:{value:n,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:t,enumerable:!0,configurable:!0},target:{value:i,enumerable:!0,configurable:!0},identifier:{value:s,enumerable:!0,configurable:!0},active:{value:r,enumerable:!0,configurable:!0},x:{value:a,enumerable:!0,configurable:!0},y:{value:o,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:c,enumerable:!0,configurable:!0},_:{value:h}})}c8.prototype.on=function(){var n=this._.on.apply(this._,arguments);return n===this._?this:n};function oL(n){return!n.ctrlKey&&!n.button}function lL(){return this.parentNode}function cL(n,e){return e??{x:n.x,y:n.y}}function hL(){return navigator.maxTouchPoints||"ontouchstart"in this}function uL(){var n=oL,e=lL,t=cL,i=hL,s={},r=GI("start","drag","end"),a=0,o,l,c,h,u=0;function d(_){_.on("mousedown.drag",f).filter(i).on("touchstart.drag",b).on("touchmove.drag",p,aL).on("touchend.drag touchcancel.drag",y).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function f(_,v){if(!(h||!n.call(this,_,v))){var C=w(this,e.call(this,_,v),_,v,"mouse");C&&($o(_.view).on("mousemove.drag",g,Lp).on("mouseup.drag",m,Lp),tE(_.view),hw(_),c=!1,o=_.clientX,l=_.clientY,C("start",_))}}function g(_){if(s1(_),!c){var v=_.clientX-o,C=_.clientY-l;c=v*v+C*C>u}s.mouse("drag",_)}function m(_){$o(_.view).on("mousemove.drag mouseup.drag",null),nE(_.view,c),s1(_),s.mouse("end",_)}function b(_,v){if(n.call(this,_,v)){var C=_.changedTouches,k=e.call(this,_,v),I=C.length,E,T;for(E=0;E<I;++E)(T=w(this,k,_,v,C[E].identifier,C[E]))&&(hw(_),T("start",_,C[E]))}}function p(_){var v=_.changedTouches,C=v.length,k,I;for(k=0;k<C;++k)(I=s[v[k].identifier])&&(s1(_),I("drag",_,v[k]))}function y(_){var v=_.changedTouches,C=v.length,k,I;for(h&&clearTimeout(h),h=setTimeout(function(){h=null},500),k=0;k<C;++k)(I=s[v[k].identifier])&&(hw(_),I("end",_,v[k]))}function w(_,v,C,k,I,E){var T=r.copy(),M=Ml(E||C,v),D,H,R;if((R=t.call(_,new c8("beforestart",{sourceEvent:C,target:d,identifier:I,active:a,x:M[0],y:M[1],dx:0,dy:0,dispatch:T}),k))!=null)return D=R.x-M[0]||0,H=R.y-M[1]||0,function z(P,B,Z){var G=M,Y;switch(P){case"start":s[I]=z,Y=a++;break;case"end":delete s[I],--a;case"drag":M=Ml(Z||B,v),Y=a;break}T.call(P,_,new c8(P,{sourceEvent:B,subject:R,target:d,identifier:I,active:Y,x:M[0]+D,y:M[1]+H,dx:M[0]-G[0],dy:M[1]-G[1],dispatch:T}),k)}}return d.filter=function(_){return arguments.length?(n=typeof _=="function"?_:Fx(!!_),d):n},d.container=function(_){return arguments.length?(e=typeof _=="function"?_:Fx(_),d):e},d.subject=function(_){return arguments.length?(t=typeof _=="function"?_:Fx(_),d):t},d.touchable=function(_){return arguments.length?(i=typeof _=="function"?_:Fx(!!_),d):i},d.on=function(){var _=r.on.apply(r,arguments);return _===r?d:_},d.clickDistance=function(_){return arguments.length?(u=(_=+_)*_,d):Math.sqrt(u)},d}var dL=1e-12;function kv(n){return((n=Math.exp(n))+1/n)/2}function fL(n){return((n=Math.exp(n))-1/n)/2}function gL(n){return((n=Math.exp(2*n))-1)/(n+1)}const mL=function n(e,t,i){function s(r,a){var o=r[0],l=r[1],c=r[2],h=a[0],u=a[1],d=a[2],f=h-o,g=u-l,m=f*f+g*g,b,p;if(m<dL)p=Math.log(d/c)/e,b=function(k){return[o+k*f,l+k*g,c*Math.exp(e*k*p)]};else{var y=Math.sqrt(m),w=(d*d-c*c+i*m)/(2*c*t*y),_=(d*d-c*c-i*m)/(2*d*t*y),v=Math.log(Math.sqrt(w*w+1)-w),C=Math.log(Math.sqrt(_*_+1)-_);p=(C-v)/e,b=function(k){var I=k*p,E=kv(v),T=c/(t*y)*(E*gL(e*I+v)-fL(v));return[o+T*f,l+T*g,c*E/kv(e*I+v)]}}return b.duration=p*1e3*e/Math.SQRT2,b}return s.rho=function(r){var a=Math.max(.001,+r),o=a*a,l=o*o;return n(a,o,l)},s}(Math.SQRT2,2,4),Lx=n=>()=>n;function pL(n,{sourceEvent:e,target:t,transform:i,dispatch:s}){Object.defineProperties(this,{type:{value:n,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:t,enumerable:!0,configurable:!0},transform:{value:i,enumerable:!0,configurable:!0},_:{value:s}})}function uw(n){n.stopImmediatePropagation()}function Im(n){n.preventDefault(),n.stopImmediatePropagation()}function bL(n){return(!n.ctrlKey||n.type==="wheel")&&!n.button}function xL(){var n=this;return n instanceof SVGElement?(n=n.ownerSVGElement||n,n.hasAttribute("viewBox")?(n=n.viewBox.baseVal,[[n.x,n.y],[n.x+n.width,n.y+n.height]]):[[0,0],[n.width.baseVal.value,n.height.baseVal.value]]):[[0,0],[n.clientWidth,n.clientHeight]]}function Cv(){return this.__zoom||o4}function yL(n){return-n.deltaY*(n.deltaMode===1?.05:n.deltaMode?1:.002)*(n.ctrlKey?10:1)}function wL(){return navigator.maxTouchPoints||"ontouchstart"in this}function _L(n,e,t){var i=n.invertX(e[0][0])-t[0][0],s=n.invertX(e[1][0])-t[1][0],r=n.invertY(e[0][1])-t[0][1],a=n.invertY(e[1][1])-t[1][1];return n.translate(s>i?(i+s)/2:Math.min(0,i)||Math.max(0,s),a>r?(r+a)/2:Math.min(0,r)||Math.max(0,a))}function vL(){var n=bL,e=xL,t=_L,i=yL,s=wL,r=[0,1/0],a=[[-1/0,-1/0],[1/0,1/0]],o=250,l=mL,c=GI("start","zoom","end"),h,u,d,f=500,g=150,m=0,b=10;function p(R){R.property("__zoom",Cv).on("wheel.zoom",I,{passive:!1}).on("mousedown.zoom",E).on("dblclick.zoom",T).filter(s).on("touchstart.zoom",M).on("touchmove.zoom",D).on("touchend.zoom touchcancel.zoom",H).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}p.transform=function(R,z,P,B){var Z=R.selection?R.selection():R;Z.property("__zoom",Cv),R!==Z?v(R,z,P,B):Z.interrupt().each(function(){C(this,arguments).event(B).start().zoom(null,typeof z=="function"?z.apply(this,arguments):z).end()})},p.scaleBy=function(R,z,P,B){p.scaleTo(R,function(){var Z=this.__zoom.k,G=typeof z=="function"?z.apply(this,arguments):z;return Z*G},P,B)},p.scaleTo=function(R,z,P,B){p.transform(R,function(){var Z=e.apply(this,arguments),G=this.__zoom,Y=P==null?_(Z):typeof P=="function"?P.apply(this,arguments):P,J=G.invert(Y),se=typeof z=="function"?z.apply(this,arguments):z;return t(w(y(G,se),Y,J),Z,a)},P,B)},p.translateBy=function(R,z,P,B){p.transform(R,function(){return t(this.__zoom.translate(typeof z=="function"?z.apply(this,arguments):z,typeof P=="function"?P.apply(this,arguments):P),e.apply(this,arguments),a)},null,B)},p.translateTo=function(R,z,P,B,Z){p.transform(R,function(){var G=e.apply(this,arguments),Y=this.__zoom,J=B==null?_(G):typeof B=="function"?B.apply(this,arguments):B;return t(o4.translate(J[0],J[1]).scale(Y.k).translate(typeof z=="function"?-z.apply(this,arguments):-z,typeof P=="function"?-P.apply(this,arguments):-P),G,a)},B,Z)};function y(R,z){return z=Math.max(r[0],Math.min(r[1],z)),z===R.k?R:new rw(z,R.x,R.y)}function w(R,z,P){var B=z[0]-P[0]*R.k,Z=z[1]-P[1]*R.k;return B===R.x&&Z===R.y?R:new rw(R.k,B,Z)}function _(R){return[(+R[0][0]+ +R[1][0])/2,(+R[0][1]+ +R[1][1])/2]}function v(R,z,P,B){R.on("start.zoom",function(){C(this,arguments).event(B).start()}).on("interrupt.zoom end.zoom",function(){C(this,arguments).event(B).end()}).tween("zoom",function(){var Z=this,G=arguments,Y=C(Z,G).event(B),J=e.apply(Z,G),se=P==null?_(J):typeof P=="function"?P.apply(Z,G):P,fe=Math.max(J[1][0]-J[0][0],J[1][1]-J[0][1]),he=Z.__zoom,de=typeof z=="function"?z.apply(Z,G):z,ge=l(he.invert(se).concat(fe/he.k),de.invert(se).concat(fe/de.k));return function(N){if(N===1)N=de;else{var K=ge(N),oe=fe/K[2];N=new rw(oe,se[0]-K[0]*oe,se[1]-K[1]*oe)}Y.zoom(null,N)}})}function C(R,z,P){return!P&&R.__zooming||new k(R,z)}function k(R,z){this.that=R,this.args=z,this.active=0,this.sourceEvent=null,this.extent=e.apply(R,z),this.taps=0}k.prototype={event:function(R){return R&&(this.sourceEvent=R),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(R,z){return this.mouse&&R!=="mouse"&&(this.mouse[1]=z.invert(this.mouse[0])),this.touch0&&R!=="touch"&&(this.touch0[1]=z.invert(this.touch0[0])),this.touch1&&R!=="touch"&&(this.touch1[1]=z.invert(this.touch1[0])),this.that.__zoom=z,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(R){var z=$o(this.that).datum();c.call(R,this.that,new pL(R,{sourceEvent:this.sourceEvent,target:p,type:R,transform:this.that.__zoom,dispatch:c}),z)}};function I(R,...z){if(!n.apply(this,arguments))return;var P=C(this,z).event(R),B=this.__zoom,Z=Math.max(r[0],Math.min(r[1],B.k*Math.pow(2,i.apply(this,arguments)))),G=Ml(R);if(P.wheel)(P.mouse[0][0]!==G[0]||P.mouse[0][1]!==G[1])&&(P.mouse[1]=B.invert(P.mouse[0]=G)),clearTimeout(P.wheel);else{if(B.k===Z)return;P.mouse=[G,B.invert(G)],aw(this),P.start()}Im(R),P.wheel=setTimeout(Y,g),P.zoom("mouse",t(w(y(B,Z),P.mouse[0],P.mouse[1]),P.extent,a));function Y(){P.wheel=null,P.end()}}function E(R,...z){if(d||!n.apply(this,arguments))return;var P=R.currentTarget,B=C(this,z,!0).event(R),Z=$o(R.view).on("mousemove.zoom",se,!0).on("mouseup.zoom",fe,!0),G=Ml(R,P),Y=R.clientX,J=R.clientY;tE(R.view),uw(R),B.mouse=[G,this.__zoom.invert(G)],aw(this),B.start();function se(he){if(Im(he),!B.moved){var de=he.clientX-Y,ge=he.clientY-J;B.moved=de*de+ge*ge>m}B.event(he).zoom("mouse",t(w(B.that.__zoom,B.mouse[0]=Ml(he,P),B.mouse[1]),B.extent,a))}function fe(he){Z.on("mousemove.zoom mouseup.zoom",null),nE(he.view,B.moved),Im(he),B.event(he).end()}}function T(R,...z){if(n.apply(this,arguments)){var P=this.__zoom,B=Ml(R.changedTouches?R.changedTouches[0]:R,this),Z=P.invert(B),G=P.k*(R.shiftKey?.5:2),Y=t(w(y(P,G),B,Z),e.apply(this,z),a);Im(R),o>0?$o(this).transition().duration(o).call(v,Y,B,R):$o(this).call(p.transform,Y,B,R)}}function M(R,...z){if(n.apply(this,arguments)){var P=R.touches,B=P.length,Z=C(this,z,R.changedTouches.length===B).event(R),G,Y,J,se;for(uw(R),Y=0;Y<B;++Y)J=P[Y],se=Ml(J,this),se=[se,this.__zoom.invert(se),J.identifier],Z.touch0?!Z.touch1&&Z.touch0[2]!==se[2]&&(Z.touch1=se,Z.taps=0):(Z.touch0=se,G=!0,Z.taps=1+!!h);h&&(h=clearTimeout(h)),G&&(Z.taps<2&&(u=se[0],h=setTimeout(function(){h=null},f)),aw(this),Z.start())}}function D(R,...z){if(this.__zooming){var P=C(this,z).event(R),B=R.changedTouches,Z=B.length,G,Y,J,se;for(Im(R),G=0;G<Z;++G)Y=B[G],J=Ml(Y,this),P.touch0&&P.touch0[2]===Y.identifier?P.touch0[0]=J:P.touch1&&P.touch1[2]===Y.identifier&&(P.touch1[0]=J);if(Y=P.that.__zoom,P.touch1){var fe=P.touch0[0],he=P.touch0[1],de=P.touch1[0],ge=P.touch1[1],N=(N=de[0]-fe[0])*N+(N=de[1]-fe[1])*N,K=(K=ge[0]-he[0])*K+(K=ge[1]-he[1])*K;Y=y(Y,Math.sqrt(N/K)),J=[(fe[0]+de[0])/2,(fe[1]+de[1])/2],se=[(he[0]+ge[0])/2,(he[1]+ge[1])/2]}else if(P.touch0)J=P.touch0[0],se=P.touch0[1];else return;P.zoom("touch",t(w(Y,J,se),P.extent,a))}}function H(R,...z){if(this.__zooming){var P=C(this,z).event(R),B=R.changedTouches,Z=B.length,G,Y;for(uw(R),d&&clearTimeout(d),d=setTimeout(function(){d=null},f),G=0;G<Z;++G)Y=B[G],P.touch0&&P.touch0[2]===Y.identifier?delete P.touch0:P.touch1&&P.touch1[2]===Y.identifier&&delete P.touch1;if(P.touch1&&!P.touch0&&(P.touch0=P.touch1,delete P.touch1),P.touch0)P.touch0[1]=this.__zoom.invert(P.touch0[0]);else if(P.end(),P.taps===2&&(Y=Ml(Y,this),Math.hypot(u[0]-Y[0],u[1]-Y[1])<b)){var J=$o(this).on("dblclick.zoom");J&&J.apply(this,arguments)}}}return p.wheelDelta=function(R){return arguments.length?(i=typeof R=="function"?R:Lx(+R),p):i},p.filter=function(R){return arguments.length?(n=typeof R=="function"?R:Lx(!!R),p):n},p.touchable=function(R){return arguments.length?(s=typeof R=="function"?R:Lx(!!R),p):s},p.extent=function(R){return arguments.length?(e=typeof R=="function"?R:Lx([[+R[0][0],+R[0][1]],[+R[1][0],+R[1][1]]]),p):e},p.scaleExtent=function(R){return arguments.length?(r[0]=+R[0],r[1]=+R[1],p):[r[0],r[1]]},p.translateExtent=function(R){return arguments.length?(a[0][0]=+R[0][0],a[1][0]=+R[1][0],a[0][1]=+R[0][1],a[1][1]=+R[1][1],p):[[a[0][0],a[0][1]],[a[1][0],a[1][1]]]},p.constrain=function(R){return arguments.length?(t=R,p):t},p.duration=function(R){return arguments.length?(o=+R,p):o},p.interpolate=function(R){return arguments.length?(l=R,p):l},p.on=function(){var R=c.on.apply(c,arguments);return R===c?p:R},p.clickDistance=function(R){return arguments.length?(m=(R=+R)*R,p):Math.sqrt(m)},p.tapDistance=function(R){return arguments.length?(b=+R,p):b},p}function kL(n){let e,t,i,s,r,a,o;return l(),{feed:c,reset:l};function l(){e=!0,t="",i=0,s=-1,r=void 0,a=void 0,o=""}function c(u){t=t?t+u:u,e&&CL(t)&&(t=t.slice(iE.length)),e=!1;const d=t.length;let f=0,g=!1;for(;f<d;){g&&(t[f]===`
`&&++f,g=!1);let m=-1,b=s,p;for(let y=i;m<0&&y<d;++y)p=t[y],p===":"&&b<0?b=y-f:p==="\r"?(g=!0,m=y-f):p===`
`&&(m=y-f);if(m<0){i=d-f,s=b;break}else i=0,s=-1;h(t,f,b,m),f+=m+1}f===d?t="":f>0&&(t=t.slice(f))}function h(u,d,f,g){if(g===0){o.length>0&&(n({type:"event",id:r,event:a||void 0,data:o.slice(0,-1)}),o="",r=void 0),a=void 0;return}const m=f<0,b=u.slice(d,d+(m?g:f));let p=0;m?p=g:u[d+f+1]===" "?p=f+2:p=f+1;const y=d+p,w=g-p,_=u.slice(y,y+w).toString();if(b==="data")o+=_?"".concat(_,`
`):`
`;else if(b==="event")a=_;else if(b==="id"&&!_.includes("\0"))r=_;else if(b==="retry"){const v=parseInt(_,10);Number.isNaN(v)||n({type:"reconnect-interval",value:v})}}}const iE=[239,187,191];function CL(n){return iE.every((e,t)=>n.charCodeAt(t)===e)}class AL extends TransformStream{constructor(){let e;super({start(t){e=kL(i=>{i.type==="event"&&t.enqueue(i)})},transform(t){e.feed(t)}})}}async function SL(n,e){const t=n.pipeThrough(new TextDecoderStream).pipeThrough(new AL).getReader();let i=IL(t);return e&&(i=EL(i)),i}async function*IL(n){var e,t,i;for(;;){const{value:s,done:r}=await n.read();if(r){yield{done:!0,value:""};break}if(!s)continue;const a=s.data;if(a.startsWith("[DONE]")){yield{done:!0,value:""};break}try{const o=JSON.parse(a);if(o.error){yield{done:!0,value:"",error:o.error};break}if(o.sources){yield{done:!1,value:"",sources:o.sources};continue}if(o.selected_model_id){yield{done:!1,value:"",selectedModelId:o.selected_model_id};continue}if(o.usage){yield{done:!1,value:"",usage:o.usage};continue}yield{done:!1,value:((i=(t=(e=o.choices)==null?void 0:e[0])==null?void 0:t.delta)==null?void 0:i.content)??""}}catch(o){console.error("Error extracting delta from SSE event:",o)}}}async function*EL(n){for await(const e of n){if(e.done){yield e;return}if(e.error){yield e;continue}if(e.sources){yield e;continue}if(e.selectedModelId){yield e;continue}if(e.usage){yield e;continue}let t=e.value;if(t.length<5){yield{done:!1,value:t};continue}for(;t!="";){const i=Math.min(Math.floor(Math.random()*3)+1,t.length);yield{done:!1,value:t.slice(0,i)},(document==null?void 0:document.visibilityState)!=="hidden"&&await TL(5),t=t.slice(i)}}}const TL=n=>new Promise(e=>setTimeout(e,n)),Vr=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),h8=[.001,0,0,.001,0,0],dw=1.35,ja={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},H0={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},sE="pdfjs_internal_editor_",_n={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,SIGNATURE:101},Vn={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35,DRAW_STEP:41},RL={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},kr={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},C9={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},bs={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},Af={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},ey={ERRORS:0,WARNINGS:1,INFOS:5},v3={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},Bx={moveTo:0,lineTo:1,curveTo:2,closePath:3},ML={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let ty=ey.WARNINGS;function PL(n){Number.isInteger(n)&&(ty=n)}function NL(){return ty}function ny(n){ty>=ey.INFOS&&`${n}`}function vn(n){ty>=ey.WARNINGS&&`${n}`}function bi(n){throw new Error(n)}function ws(n,e){n||bi(e)}function OL(n){switch(n==null?void 0:n.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function rE(n,e=null,t=null){if(!n)return null;if(t&&typeof n=="string"){if(t.addDefaultProtocol&&n.startsWith("www.")){const s=n.match(/\./g);(s==null?void 0:s.length)>=2&&(n=`http://${n}`)}if(t.tryConvertEncoding)try{n=UL(n)}catch{}}const i=e?URL.parse(n,e):URL.parse(n);return OL(i)?i:null}function aE(n,e,t=!1){const i=URL.parse(n);return i?(i.hash=e,i.href):t&&rE(n,"http://example.com")?n.split("#",1)[0]+`${e?`#${e}`:""}`:""}function zn(n,e,t,i=!1){return Object.defineProperty(n,e,{value:t,enumerable:!i,configurable:!0,writable:!1}),t}const ff=function(){function e(t,i){this.message=t,this.name=i}return e.prototype=new Error,e.constructor=e,e}();let Av=class extends ff{constructor(e,t){super(e,"PasswordException"),this.code=t}},fw=class extends ff{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}},u8=class extends ff{constructor(e){super(e,"InvalidPDFException")}},k3=class extends ff{constructor(e,t,i){super(e,"ResponseException"),this.status=t,this.missing=i}},DL=class extends ff{constructor(e){super(e,"FormatError")}},Vh=class extends ff{constructor(e){super(e,"AbortException")}};function oE(n){(typeof n!="object"||(n==null?void 0:n.length)===void 0)&&bi("Invalid argument for bytesToString");const e=n.length,t=8192;if(e<t)return String.fromCharCode.apply(null,n);const i=[];for(let s=0;s<e;s+=t){const r=Math.min(s+t,e),a=n.subarray(s,r);i.push(String.fromCharCode.apply(null,a))}return i.join("")}function dx(n){typeof n!="string"&&bi("Invalid argument for stringToBytes");const e=n.length,t=new Uint8Array(e);for(let i=0;i<e;++i)t[i]=n.charCodeAt(i)&255;return t}function FL(n){return String.fromCharCode(n>>24&255,n>>16&255,n>>8&255,n&255)}function LL(){const n=new Uint8Array(4);return n[0]=1,new Uint32Array(n.buffer,0,1)[0]===1}function BL(){try{return new Function(""),!0}catch{return!1}}class br{static get isLittleEndian(){return zn(this,"isLittleEndian",LL())}static get isEvalSupported(){return zn(this,"isEvalSupported",BL())}static get isOffscreenCanvasSupported(){return zn(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return zn(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){const{platform:e,userAgent:t}=navigator;return zn(this,"platform",{isAndroid:t.includes("Android"),isLinux:e.includes("Linux"),isMac:e.includes("Mac"),isWindows:e.includes("Win"),isFirefox:t.includes("Firefox")})}static get isCSSRoundSupported(){var e,t;return zn(this,"isCSSRoundSupported",(t=(e=globalThis.CSS)==null?void 0:e.supports)==null?void 0:t.call(e,"width: round(1.5px, 1px)"))}}const gw=Array.from(Array(256).keys(),n=>n.toString(16).padStart(2,"0"));var w0,s8,A9,d8;let sn=(s8=class{static makeHexColor(e,t,i){return`#${gw[e]}${gw[t]}${gw[i]}`}static scaleMinMax(e,t){let i;e[0]?(e[0]<0&&(i=t[0],t[0]=t[2],t[2]=i),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(i=t[1],t[1]=t[3],t[3]=i),t[1]*=e[3],t[3]*=e[3]):(i=t[0],t[0]=t[1],t[1]=i,i=t[2],t[2]=t[3],t[3]=i,e[1]<0&&(i=t[1],t[1]=t[3],t[3]=i),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(i=t[0],t[0]=t[2],t[2]=i),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static applyTransform(e,t,i=0){const s=e[i],r=e[i+1];e[i]=s*t[0]+r*t[2]+t[4],e[i+1]=s*t[1]+r*t[3]+t[5]}static applyTransformToBezier(e,t,i=0){const s=t[0],r=t[1],a=t[2],o=t[3],l=t[4],c=t[5];for(let h=0;h<6;h+=2){const u=e[i+h],d=e[i+h+1];e[i+h]=u*s+d*a+l,e[i+h+1]=u*r+d*o+c}}static applyInverseTransform(e,t){const i=e[0],s=e[1],r=t[0]*t[3]-t[1]*t[2];e[0]=(i*t[3]-s*t[2]+t[2]*t[5]-t[4]*t[3])/r,e[1]=(-i*t[1]+s*t[0]+t[4]*t[1]-t[5]*t[0])/r}static axialAlignedBoundingBox(e,t,i){const s=t[0],r=t[1],a=t[2],o=t[3],l=t[4],c=t[5],h=e[0],u=e[1],d=e[2],f=e[3];let g=s*h+l,m=g,b=s*d+l,p=b,y=o*u+c,w=y,_=o*f+c,v=_;if(r!==0||a!==0){const C=r*h,k=r*d,I=a*u,E=a*f;g+=I,p+=I,b+=E,m+=E,y+=C,v+=C,_+=k,w+=k}i[0]=Math.min(i[0],g,b,m,p),i[1]=Math.min(i[1],y,_,w,v),i[2]=Math.max(i[2],g,b,m,p),i[3]=Math.max(i[3],y,_,w,v)}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e,t){const i=e[0],s=e[1],r=e[2],a=e[3],o=i**2+s**2,l=i*r+s*a,c=r**2+a**2,h=(o+c)/2,u=Math.sqrt(h**2-(o*c-l**2));t[0]=Math.sqrt(h+u||1),t[1]=Math.sqrt(h-u||1)}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const i=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),s=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(i>s)return null;const r=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),a=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return r>a?null:[i,r,s,a]}static pointBoundingBox(e,t,i){i[0]=Math.min(i[0],e),i[1]=Math.min(i[1],t),i[2]=Math.max(i[2],e),i[3]=Math.max(i[3],t)}static rectBoundingBox(e,t,i,s,r){r[0]=Math.min(r[0],e,i),r[1]=Math.min(r[1],t,s),r[2]=Math.max(r[2],e,i),r[3]=Math.max(r[3],t,s)}static bezierBoundingBox(e,t,i,s,r,a,o,l,c){c[0]=Math.min(c[0],e,o),c[1]=Math.min(c[1],t,l),c[2]=Math.max(c[2],e,o),c[3]=Math.max(c[3],t,l),F(this,w0,d8).call(this,e,i,r,o,t,s,a,l,3*(-e+3*(i-r)+o),6*(e-2*i+r),3*(i-e),c),F(this,w0,d8).call(this,e,i,r,o,t,s,a,l,3*(-t+3*(s-a)+l),6*(t-2*s+a),3*(s-t),c)}},w0=new WeakSet,A9=function(e,t,i,s,r,a,o,l,c,h){if(c<=0||c>=1)return;const u=1-c,d=c*c,f=d*c,g=u*(u*(u*e+3*c*t)+3*d*i)+f*s,m=u*(u*(u*r+3*c*a)+3*d*o)+f*l;h[0]=Math.min(h[0],g),h[1]=Math.min(h[1],m),h[2]=Math.max(h[2],g),h[3]=Math.max(h[3],m)},d8=function(e,t,i,s,r,a,o,l,c,h,u,d){if(Math.abs(c)<1e-12){Math.abs(h)>=1e-12&&F(this,w0,A9).call(this,e,t,i,s,r,a,o,l,-u/h,d);return}const f=h**2-4*u*c;if(f<0)return;const g=Math.sqrt(f),m=2*c;F(this,w0,A9).call(this,e,t,i,s,r,a,o,l,(-h+g)/m,d),F(this,w0,A9).call(this,e,t,i,s,r,a,o,l,(-h-g)/m,d)},U(s8,w0),s8);function UL(n){return decodeURIComponent(escape(n))}let mw=null,Sv=null;function HL(n){return mw||(mw=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Sv=new Map([["ﬅ","ſt"]])),n.replaceAll(mw,(e,t,i)=>t?t.normalize("NFKC"):Sv.get(i))}function lE(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const n=new Uint8Array(32);return crypto.getRandomValues(n),oE(n)}const g4="pdfjs_internal_id_";function zL(n,e,t){if(!Array.isArray(t)||t.length<2)return!1;const[i,s,...r]=t;if(!n(i)&&!Number.isInteger(i)||!e(s))return!1;const a=r.length;let o=!0;switch(s.name){case"XYZ":if(a<2||a>3)return!1;break;case"Fit":case"FitB":return a===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(a>1)return!1;break;case"FitR":if(a!==4)return!1;o=!1;break;default:return!1}for(const l of r)if(!(typeof l=="number"||o&&l===null))return!1;return!0}function qr(n,e,t){return Math.min(Math.max(n,e),t)}function cE(n){return Uint8Array.prototype.toBase64?n.toBase64():btoa(oE(n))}function jL(n){return Uint8Array.fromBase64?Uint8Array.fromBase64(n):dx(atob(n))}typeof Promise.try!="function"&&(Promise.try=function(n,...e){return new Promise(t=>{t(n(...e))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(n){return n.reduce((e,t)=>e+t,0)});const bc="http://www.w3.org/2000/svg",vu=class vu{};Ue(vu,"CSS",96),Ue(vu,"PDF",72),Ue(vu,"PDF_TO_CSS_UNITS",vu.CSS/vu.PDF);let qh=vu;async function fx(n,e="text"){if(Xm(n,document.baseURI)){const t=await fetch(n);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,i)=>{const s=new XMLHttpRequest;s.open("GET",n,!0),s.responseType=e,s.onreadystatechange=()=>{if(s.readyState===XMLHttpRequest.DONE){if(s.status===200||s.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(s.response);return}t(s.responseText);return}i(new Error(s.statusText))}},s.send(null)})}class gx{constructor({viewBox:e,userUnit:t,scale:i,rotation:s,offsetX:r=0,offsetY:a=0,dontFlip:o=!1}){this.viewBox=e,this.userUnit=t,this.scale=i,this.rotation=s,this.offsetX=r,this.offsetY=a,i*=t;const l=(e[2]+e[0])/2,c=(e[3]+e[1])/2;let h,u,d,f;switch(s%=360,s<0&&(s+=360),s){case 180:h=-1,u=0,d=0,f=1;break;case 90:h=0,u=1,d=1,f=0;break;case 270:h=0,u=-1,d=-1,f=0;break;case 0:h=1,u=0,d=0,f=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}o&&(d=-d,f=-f);let g,m,b,p;h===0?(g=Math.abs(c-e[1])*i+r,m=Math.abs(l-e[0])*i+a,b=(e[3]-e[1])*i,p=(e[2]-e[0])*i):(g=Math.abs(l-e[0])*i+r,m=Math.abs(c-e[1])*i+a,b=(e[2]-e[0])*i,p=(e[3]-e[1])*i),this.transform=[h*i,u*i,d*i,f*i,g-h*i*l-d*i*c,m-u*i*l-f*i*c],this.width=b,this.height=p}get rawDims(){const e=this.viewBox;return zn(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:i=this.offsetX,offsetY:s=this.offsetY,dontFlip:r=!1}={}){return new gx({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:i,offsetY:s,dontFlip:r})}convertToViewportPoint(e,t){const i=[e,t];return sn.applyTransform(i,this.transform),i}convertToViewportRectangle(e){const t=[e[0],e[1]];sn.applyTransform(t,this.transform);const i=[e[2],e[3]];return sn.applyTransform(i,this.transform),[t[0],t[1],i[0],i[1]]}convertToPdfPoint(e,t){const i=[e,t];return sn.applyInverseTransform(i,this.transform),i}}class m4 extends ff{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function iy(n){const e=n.length;let t=0;for(;t<e&&n[t].trim()==="";)t++;return n.substring(t,t+5).toLowerCase()==="data:"}function p4(n){return typeof n=="string"&&/\.pdf$/i.test(n)}function GL(n){return[n]=n.split(/[#?]/,1),n.substring(n.lastIndexOf("/")+1)}function VL(n,e="document.pdf"){if(typeof n!="string")return e;if(iy(n))return vn('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const i=(o=>{try{return new URL(o)}catch{try{return new URL(decodeURIComponent(o))}catch{try{return new URL(o,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(o),"https://foo.bar")}catch{return null}}}}})(n);if(!i)return e;const s=o=>{try{let l=decodeURIComponent(o);return l.includes("/")?(l=l.split("/").at(-1),l.test(/^\.pdf$/i)?l:o):l}catch{return o}},r=/\.pdf$/i,a=i.pathname.split("/").at(-1);if(r.test(a))return s(a);if(i.searchParams.size>0){const o=Array.from(i.searchParams.values()).reverse();for(const c of o)if(r.test(c))return s(c);const l=Array.from(i.searchParams.keys()).reverse();for(const c of l)if(r.test(c))return s(c)}if(i.hash){const l=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(i.hash);if(l)return s(l[0])}return e}class Iv{constructor(){Ue(this,"started",Object.create(null));Ue(this,"times",[])}time(e){e in this.started&&vn(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||vn(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:i}of this.times)t=Math.max(i.length,t);for(const{name:i,start:s,end:r}of this.times)e.push(`${i.padEnd(t)} ${r-s}ms
`);return e.join("")}}function Xm(n,e){const t=e?URL.parse(n,e):URL.parse(n);return(t==null?void 0:t.protocol)==="http:"||(t==null?void 0:t.protocol)==="https:"}function ll(n){n.preventDefault()}function ys(n){n.preventDefault(),n.stopPropagation()}function qL(n){""+n}var m2;class b4{static toDateObject(e){if(!e||typeof e!="string")return null;x(this,m2)||O(this,m2,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const t=x(this,m2).exec(e);if(!t)return null;const i=parseInt(t[1],10);let s=parseInt(t[2],10);s=s>=1&&s<=12?s-1:0;let r=parseInt(t[3],10);r=r>=1&&r<=31?r:1;let a=parseInt(t[4],10);a=a>=0&&a<=23?a:0;let o=parseInt(t[5],10);o=o>=0&&o<=59?o:0;let l=parseInt(t[6],10);l=l>=0&&l<=59?l:0;const c=t[7]||"Z";let h=parseInt(t[8],10);h=h>=0&&h<=23?h:0;let u=parseInt(t[9],10)||0;return u=u>=0&&u<=59?u:0,c==="-"?(a+=h,o+=u):c==="+"&&(a-=h,o-=u),new Date(Date.UTC(i,s,r,a,o,l))}}m2=new WeakMap,U(b4,m2);function WL(n,{scale:e=1,rotation:t=0}){const{width:i,height:s}=n.attributes.style,r=[0,0,parseInt(i),parseInt(s)];return new gx({viewBox:r,userUnit:1,scale:e,rotation:t})}function x4(n){if(n.startsWith("#")){const e=parseInt(n.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return n.startsWith("rgb(")?n.slice(4,-1).split(",").map(e=>parseInt(e)):n.startsWith("rgba(")?n.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(vn(`Not a valid color format: "${n}"`),[0,0,0])}function KL(n){const e=document.createElement("span");e.style.visibility="hidden",e.style.colorScheme="only light",document.body.append(e);for(const t of n.keys()){e.style.color=t;const i=window.getComputedStyle(e).color;n.set(t,x4(i))}e.remove()}function Yi(n){const{a:e,b:t,c:i,d:s,e:r,f:a}=n.getTransform();return[e,t,i,s,r,a]}function wl(n){const{a:e,b:t,c:i,d:s,e:r,f:a}=n.getTransform().invertSelf();return[e,t,i,s,r,a]}function Zd(n,e,t=!1,i=!0){if(e instanceof gx){const{pageWidth:s,pageHeight:r}=e.rawDims,{style:a}=n,o=br.isCSSRoundSupported,l=`var(--total-scale-factor) * ${s}px`,c=`var(--total-scale-factor) * ${r}px`,h=o?`round(down, ${l}, var(--scale-round-x))`:`calc(${l})`,u=o?`round(down, ${c}, var(--scale-round-y))`:`calc(${c})`;!t||e.rotation%180===0?(a.width=h,a.height=u):(a.width=u,a.height=h)}i&&n.setAttribute("data-main-rotation",e.rotation)}class cc{constructor(){const{pixelRatio:e}=cc;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(e,t,i,s,r=-1){let a=1/0,o=1/0,l=1/0;i=cc.capPixels(i,r),i>0&&(a=Math.sqrt(i/(e*t))),s!==-1&&(o=s/e,l=s/t);const c=Math.min(a,o,l);return this.sx>c||this.sy>c?(this.sx=c,this.sy=c,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(e,t){if(t>=0){const i=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+t/100));return e>0?Math.min(e,i):i}return e}}const f8=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];var G0,Tu,ao,V0,p2,p1,b2,x5,hE,Jr,uE,dE,Ym,S9;const kc=class kc{constructor(e){U(this,Jr);U(this,G0,null);U(this,Tu,null);U(this,ao);U(this,V0,null);U(this,p2,null);U(this,p1,null);O(this,ao,e),x(kc,b2)||O(kc,b2,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"}))}render(){const e=O(this,G0,document.createElement("div"));e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=x(this,ao)._uiManager._signal;e.addEventListener("contextmenu",ll,{signal:t}),e.addEventListener("pointerdown",F(kc,x5,hE),{signal:t});const i=O(this,V0,document.createElement("div"));i.className="buttons",e.append(i);const s=x(this,ao).toolbarPosition;if(s){const{style:r}=e,a=x(this,ao)._uiManager.direction==="ltr"?1-s[0]:s[0];r.insetInlineEnd=`${100*a}%`,r.top=`calc(${100*s[1]}% + var(--editor-toolbar-vert-offset))`}return e}get div(){return x(this,G0)}hide(){var e;x(this,G0).classList.add("hidden"),(e=x(this,Tu))==null||e.hideDropdown()}show(){var e;x(this,G0).classList.remove("hidden"),(e=x(this,p2))==null||e.shown()}addDeleteButton(){const{editorType:e,_uiManager:t}=x(this,ao),i=document.createElement("button");i.className="delete",i.tabIndex=0,i.setAttribute("data-l10n-id",x(kc,b2)[e]),F(this,Jr,Ym).call(this,i),i.addEventListener("click",s=>{t.delete()},{signal:t._signal}),x(this,V0).append(i)}async addAltText(e){const t=await e.render();F(this,Jr,Ym).call(this,t),x(this,V0).append(t,x(this,Jr,S9)),O(this,p2,e)}addColorPicker(e){O(this,Tu,e);const t=e.renderButton();F(this,Jr,Ym).call(this,t),x(this,V0).append(t,x(this,Jr,S9))}async addEditSignatureButton(e){const t=O(this,p1,await e.renderEditButton(x(this,ao)));F(this,Jr,Ym).call(this,t),x(this,V0).append(t,x(this,Jr,S9))}async addButton(e,t){switch(e){case"colorPicker":this.addColorPicker(t);break;case"altText":await this.addAltText(t);break;case"editSignature":await this.addEditSignatureButton(t);break;case"delete":this.addDeleteButton();break}}updateEditSignatureButton(e){x(this,p1)&&(x(this,p1).title=e)}remove(){var e;x(this,G0).remove(),(e=x(this,Tu))==null||e.destroy(),O(this,Tu,null)}};G0=new WeakMap,Tu=new WeakMap,ao=new WeakMap,V0=new WeakMap,p2=new WeakMap,p1=new WeakMap,b2=new WeakMap,x5=new WeakSet,hE=function(e){e.stopPropagation()},Jr=new WeakSet,uE=function(e){x(this,ao)._focusEventsAllowed=!1,ys(e)},dE=function(e){x(this,ao)._focusEventsAllowed=!0,ys(e)},Ym=function(e){const t=x(this,ao)._uiManager._signal;e.addEventListener("focusin",F(this,Jr,uE).bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",F(this,Jr,dE).bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",ll,{signal:t})},S9=function(){const e=document.createElement("div");return e.className="divider",e},U(kc,x5),U(kc,b2,null);let g8=kc;var x2,Ru,Mu,Jh,fE,gE,mE;class XL{constructor(e){U(this,Jh);U(this,x2,null);U(this,Ru,null);U(this,Mu);O(this,Mu,e)}show(e,t,i){const[s,r]=F(this,Jh,gE).call(this,t,i),{style:a}=x(this,Ru)||O(this,Ru,F(this,Jh,fE).call(this));e.append(x(this,Ru)),a.insetInlineEnd=`${100*s}%`,a.top=`calc(${100*r}% + var(--editor-toolbar-vert-offset))`}hide(){x(this,Ru).remove()}}x2=new WeakMap,Ru=new WeakMap,Mu=new WeakMap,Jh=new WeakSet,fE=function(){const e=O(this,Ru,document.createElement("div"));e.className="editToolbar",e.setAttribute("role","toolbar"),e.addEventListener("contextmenu",ll,{signal:x(this,Mu)._signal});const t=O(this,x2,document.createElement("div"));return t.className="buttons",e.append(t),F(this,Jh,mE).call(this),e},gE=function(e,t){let i=0,s=0;for(const r of e){const a=r.y+r.height;if(a<i)continue;const o=r.x+(t?r.width:0);if(a>i){s=o,i=a;continue}t?o>s&&(s=o):o<s&&(s=o)}return[t?1-s:s,i]},mE=function(){const e=document.createElement("button");e.className="highlightButton",e.tabIndex=0,e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const t=document.createElement("span");e.append(t),t.className="visuallyHidden",t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const i=x(this,Mu)._signal;e.addEventListener("contextmenu",ll,{signal:i}),e.addEventListener("click",()=>{x(this,Mu).highlightSelection("floating_button")},{signal:i}),x(this,x2).append(e)};function pE(n,e,t){for(const i of t)e.addEventListener(i,n[i].bind(n))}var y5;class YL{constructor(){U(this,y5,0)}get id(){return`${sE}${Fr(this,y5)._++}`}}y5=new WeakMap;var b1,y2,Ar,x1,I9;const Z_=class Z_{constructor(){U(this,x1);U(this,b1,lE());U(this,y2,0);U(this,Ar,null)}static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',i=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),s=new Image;s.src=e;const r=s.decode().then(()=>(i.drawImage(s,0,0,1,1,0,0,1,3),new Uint32Array(i.getImageData(0,0,1,1).data.buffer)[0]===0));return zn(this,"_isSVGFittingCanvas",r)}async getFromFile(e){const{lastModified:t,name:i,size:s,type:r}=e;return F(this,x1,I9).call(this,`${t}_${i}_${s}_${r}`,e)}async getFromUrl(e){return F(this,x1,I9).call(this,e,e)}async getFromBlob(e,t){const i=await t;return F(this,x1,I9).call(this,e,i)}async getFromId(e){x(this,Ar)||O(this,Ar,new Map);const t=x(this,Ar).get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:i}=t;return delete t.blobPromise,this.getFromBlob(t.id,i)}return this.getFromUrl(t.url)}getFromCanvas(e,t){x(this,Ar)||O(this,Ar,new Map);let i=x(this,Ar).get(e);if(i!=null&&i.bitmap)return i.refCounter+=1,i;const s=new OffscreenCanvas(t.width,t.height);return s.getContext("2d").drawImage(t,0,0),i={bitmap:s.transferToImageBitmap(),id:`image_${x(this,b1)}_${Fr(this,y2)._++}`,refCounter:1,isSvg:!1},x(this,Ar).set(e,i),x(this,Ar).set(i.id,i),i}getSvgUrl(e){const t=x(this,Ar).get(e);return t!=null&&t.isSvg?t.svgUrl:null}deleteId(e){var s;x(this,Ar)||O(this,Ar,new Map);const t=x(this,Ar).get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:i}=t;if(!t.url&&!t.file){const r=new OffscreenCanvas(i.width,i.height);r.getContext("bitmaprenderer").transferFromImageBitmap(i),t.blobPromise=r.convertToBlob()}(s=i.close)==null||s.call(i),t.bitmap=null}isValidId(e){return e.startsWith(`image_${x(this,b1)}_`)}};b1=new WeakMap,y2=new WeakMap,Ar=new WeakMap,x1=new WeakSet,I9=async function(e,t){x(this,Ar)||O(this,Ar,new Map);let i=x(this,Ar).get(e);if(i===null)return null;if(i!=null&&i.bitmap)return i.refCounter+=1,i;try{i||(i={bitmap:null,id:`image_${x(this,b1)}_${Fr(this,y2)._++}`,refCounter:0,isSvg:!1});let s;if(typeof t=="string"?(i.url=t,s=await fx(t,"blob")):t instanceof File?s=i.file=t:t instanceof Blob&&(s=t),s.type==="image/svg+xml"){const r=Z_._isSVGFittingCanvas,a=new FileReader,o=new Image,l=new Promise((c,h)=>{o.onload=()=>{i.bitmap=o,i.isSvg=!0,c()},a.onload=async()=>{const u=i.svgUrl=a.result;o.src=await r?`${u}#svgView(preserveAspectRatio(none))`:u},o.onerror=a.onerror=h});a.readAsDataURL(s),await l}else i.bitmap=await createImageBitmap(s);i.refCounter=1}catch(s){vn(s),i=null}return x(this,Ar).set(e,i),i&&x(this,Ar).set(i.id,i),i};let m8=Z_;var as,q0,w2,Xi;class JL{constructor(e=128){U(this,as,[]);U(this,q0,!1);U(this,w2);U(this,Xi,-1);O(this,w2,e)}add({cmd:e,undo:t,post:i,mustExec:s,type:r=NaN,overwriteIfSameType:a=!1,keepUndo:o=!1}){if(s&&e(),x(this,q0))return;const l={cmd:e,undo:t,post:i,type:r};if(x(this,Xi)===-1){x(this,as).length>0&&(x(this,as).length=0),O(this,Xi,0),x(this,as).push(l);return}if(a&&x(this,as)[x(this,Xi)].type===r){o&&(l.undo=x(this,as)[x(this,Xi)].undo),x(this,as)[x(this,Xi)]=l;return}const c=x(this,Xi)+1;c===x(this,w2)?x(this,as).splice(0,1):(O(this,Xi,c),c<x(this,as).length&&x(this,as).splice(c)),x(this,as).push(l)}undo(){if(x(this,Xi)===-1)return;O(this,q0,!0);const{undo:e,post:t}=x(this,as)[x(this,Xi)];e(),t==null||t(),O(this,q0,!1),O(this,Xi,x(this,Xi)-1)}redo(){if(x(this,Xi)<x(this,as).length-1){O(this,Xi,x(this,Xi)+1),O(this,q0,!0);const{cmd:e,post:t}=x(this,as)[x(this,Xi)];e(),t==null||t(),O(this,q0,!1)}}hasSomethingToUndo(){return x(this,Xi)!==-1}hasSomethingToRedo(){return x(this,Xi)<x(this,as).length-1}cleanType(e){if(x(this,Xi)!==-1){for(let t=x(this,Xi);t>=0;t--)if(x(this,as)[t].type!==e){x(this,as).splice(t+1,x(this,Xi)-t),O(this,Xi,t);return}x(this,as).length=0,O(this,Xi,-1)}}destroy(){O(this,as,null)}}as=new WeakMap,q0=new WeakMap,w2=new WeakMap,Xi=new WeakMap;var w5,bE;class mx{constructor(e){U(this,w5);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=br.platform;for(const[i,s,r={}]of e)for(const a of i){const o=a.startsWith("mac+");t&&o?(this.callbacks.set(a.slice(4),{callback:s,options:r}),this.allKeys.add(a.split("+").at(-1))):!t&&!o&&(this.callbacks.set(a,{callback:s,options:r}),this.allKeys.add(a.split("+").at(-1)))}}exec(e,t){if(!this.allKeys.has(t.key))return;const i=this.callbacks.get(F(this,w5,bE).call(this,t));if(!i)return;const{callback:s,options:{bubbles:r=!1,args:a=[],checker:o=null}}=i;o&&!o(e,t)||(s.bind(e,...a,t)(),r||ys(t))}}w5=new WeakSet,bE=function(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t};const _5=class _5{get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return KL(e),zn(this,"_colors",e)}convert(e){const t=x4(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[i,s]of this._colors)if(s.every((r,a)=>r===t[a]))return _5._colorsMapping.get(i);return t}getHexCode(e){const t=this._colors.get(e);return t?sn.makeHexColor(...t):e}};Ue(_5,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let p8=_5;var y1,Ea,Is,rr,w1,Ec,_1,oo,W0,K0,v1,Pu,Pl,Lo,Nu,_2,v2,k1,k2,Nl,X0,C1,Y0,Ol,v5,J0,C2,Z0,Ou,Du,Q0,A2,Os,hi,Tc,$0,Fu,S2,I2,eh,Dl,Rc,E2,T2,lo,Ct,E9,b8,xE,yE,T9,wE,_E,vE,x8,kE,y8,w8,CE,Ur,xc,AE,SE,_8,IE,Jm,v8;const Xf=class Xf{constructor(e,t,i,s,r,a,o,l,c,h,u,d,f,g,m){U(this,Ct);U(this,y1,new AbortController);U(this,Ea,null);U(this,Is,new Map);U(this,rr,new Map);U(this,w1,null);U(this,Ec,null);U(this,_1,null);U(this,oo,new JL);U(this,W0,null);U(this,K0,null);U(this,v1,0);U(this,Pu,new Set);U(this,Pl,null);U(this,Lo,null);U(this,Nu,new Set);Ue(this,"_editorUndoBar",null);U(this,_2,!1);U(this,v2,!1);U(this,k1,!1);U(this,k2,null);U(this,Nl,null);U(this,X0,null);U(this,C1,null);U(this,Y0,!1);U(this,Ol,null);U(this,v5,new YL);U(this,J0,!1);U(this,C2,!1);U(this,Z0,null);U(this,Ou,null);U(this,Du,null);U(this,Q0,null);U(this,A2,null);U(this,Os,_n.NONE);U(this,hi,new Set);U(this,Tc,null);U(this,$0,null);U(this,Fu,null);U(this,S2,null);U(this,I2,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});U(this,eh,[0,0]);U(this,Dl,null);U(this,Rc,null);U(this,E2,null);U(this,T2,null);U(this,lo,null);const b=this._signal=x(this,y1).signal;O(this,Rc,e),O(this,E2,t),O(this,T2,i),O(this,w1,s),O(this,$0,r),this._eventBus=a,a._on("editingaction",this.onEditingAction.bind(this),{signal:b}),a._on("pagechanging",this.onPageChanging.bind(this),{signal:b}),a._on("scalechanging",this.onScaleChanging.bind(this),{signal:b}),a._on("rotationchanging",this.onRotationChanging.bind(this),{signal:b}),a._on("setpreference",this.onSetPreference.bind(this),{signal:b}),a._on("switchannotationeditorparams",p=>this.updateParams(p.type,p.value),{signal:b}),F(this,Ct,wE).call(this),F(this,Ct,CE).call(this),F(this,Ct,x8).call(this),O(this,Ec,o.annotationStorage),O(this,k2,o.filterFactory),O(this,Fu,l),O(this,C1,c||null),O(this,_2,h),O(this,v2,u),O(this,k1,d),O(this,A2,f||null),this.viewParameters={realScale:qh.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=g||null,this._supportsPinchToZoom=m!==!1}static get _keyboardManager(){const e=Xf.prototype,t=a=>x(a,Rc).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&a.hasSomethingToControl(),i=(a,{target:o})=>{if(o instanceof HTMLInputElement){const{type:l}=o;return l!=="text"&&l!=="number"}return!0},s=this.TRANSLATE_SMALL,r=this.TRANSLATE_BIG;return zn(this,"_keyboardManager",new mx([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:i}],[["ctrl+z","mac+meta+z"],e.undo,{checker:i}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:i}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:i}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&x(a,Rc).contains(o)&&!a.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&x(a,Rc).contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-s,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-r,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[s,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[r,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-s],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-r],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,s],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,r],checker:t}]]))}destroy(){var e,t,i,s,r,a,o,l;(e=x(this,lo))==null||e.resolve(),O(this,lo,null),(t=x(this,y1))==null||t.abort(),O(this,y1,null),this._signal=null;for(const c of x(this,rr).values())c.destroy();x(this,rr).clear(),x(this,Is).clear(),x(this,Nu).clear(),(i=x(this,Q0))==null||i.clear(),O(this,Ea,null),x(this,hi).clear(),x(this,oo).destroy(),(s=x(this,w1))==null||s.destroy(),(r=x(this,$0))==null||r.destroy(),(a=x(this,Ol))==null||a.hide(),O(this,Ol,null),(o=x(this,Du))==null||o.destroy(),O(this,Du,null),x(this,Nl)&&(clearTimeout(x(this,Nl)),O(this,Nl,null)),x(this,Dl)&&(clearTimeout(x(this,Dl)),O(this,Dl,null)),(l=this._editorUndoBar)==null||l.destroy()}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return x(this,A2)}get useNewAltTextFlow(){return x(this,v2)}get useNewAltTextWhenAddingImage(){return x(this,k1)}get hcmFilter(){return zn(this,"hcmFilter",x(this,Fu)?x(this,k2).addHCMFilter(x(this,Fu).foreground,x(this,Fu).background):"none")}get direction(){return zn(this,"direction",getComputedStyle(x(this,Rc)).direction)}get highlightColors(){return zn(this,"highlightColors",x(this,C1)?new Map(x(this,C1).split(",").map(e=>(e=e.split("=").map(t=>t.trim()),e[1]=e[1].toUpperCase(),e))):null)}get highlightColorNames(){return zn(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),O(this,K0,e)}setMainHighlightColorPicker(e){O(this,Du,e)}editAltText(e,t=!1){var i;(i=x(this,w1))==null||i.editAltText(this,e,t)}getSignature(e){var t;(t=x(this,$0))==null||t.getSignature({uiManager:this,editor:e})}get signatureManager(){return x(this,$0)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":O(this,k1,t);break}}onPageChanging({pageNumber:e}){O(this,v1,e-1)}focusMainContainer(){x(this,Rc).focus()}findParent(e,t){for(const i of x(this,rr).values()){const{x:s,y:r,width:a,height:o}=i.div.getBoundingClientRect();if(e>=s&&e<=s+a&&t>=r&&t<=r+o)return i}return null}disableUserSelect(e=!1){x(this,E2).classList.toggle("noUserSelect",e)}addShouldRescale(e){x(this,Nu).add(e)}removeShouldRescale(e){x(this,Nu).delete(e)}onScaleChanging({scale:e}){var t;this.commitOrRemove(),this.viewParameters.realScale=e*qh.PDF_TO_CSS_UNITS;for(const i of x(this,Nu))i.onScaleChanging();(t=x(this,K0))==null||t.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}highlightSelection(e=""){const t=document.getSelection();if(!t||t.isCollapsed)return;const{anchorNode:i,anchorOffset:s,focusNode:r,focusOffset:a}=t,o=t.toString(),c=F(this,Ct,E9).call(this,t).closest(".textLayer"),h=this.getSelectionBoxes(c);if(!h)return;t.empty();const u=F(this,Ct,b8).call(this,c),d=x(this,Os)===_n.NONE,f=()=>{u==null||u.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:h,anchorNode:i,anchorOffset:s,focusNode:r,focusOffset:a,text:o}),d&&this.showAllEditors("highlight",!0,!0)};if(d){this.switchToMode(_n.HIGHLIGHT,f);return}f()}addToAnnotationStorage(e){!e.isEmpty()&&x(this,Ec)&&!x(this,Ec).has(e.id)&&x(this,Ec).setValue(e.id,e)}a11yAlert(e,t=null){const i=x(this,T2);i&&(i.setAttribute("data-l10n-id",e),t?i.setAttribute("data-l10n-args",JSON.stringify(t)):i.removeAttribute("data-l10n-args"))}blur(){if(this.isShiftKeyDown=!1,x(this,Y0)&&(O(this,Y0,!1),F(this,Ct,T9).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of x(this,hi))if(t.div.contains(e)){O(this,Ou,[t,e]),t._focusEventsAllowed=!1;break}}focus(){if(!x(this,Ou))return;const[e,t]=x(this,Ou);O(this,Ou,null),t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}addEditListeners(){F(this,Ct,x8).call(this),F(this,Ct,y8).call(this)}removeEditListeners(){F(this,Ct,kE).call(this),F(this,Ct,w8).call(this)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const i of x(this,Lo))if(i.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const i of x(this,Lo))if(i.isHandlingMimeForPasting(t.type)){i.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){var i;if(e.preventDefault(),(i=x(this,Ea))==null||i.commitOrRemove(),!this.hasSelection)return;const t=[];for(const s of x(this,hi)){const r=s.serialize(!0);r&&t.push(r)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const r of t.items)for(const a of x(this,Lo))if(a.isHandlingMimeForPasting(r.type)){a.paste(r,this.currentLayer);return}let i=t.getData("application/pdfjs");if(!i)return;try{i=JSON.parse(i)}catch(r){vn(`paste: "${r.message}".`);return}if(!Array.isArray(i))return;this.unselectAll();const s=this.currentLayer;try{const r=[];for(const l of i){const c=await s.deserialize(l);if(!c)return;r.push(c)}const a=()=>{for(const l of r)F(this,Ct,_8).call(this,l);F(this,Ct,v8).call(this,r)},o=()=>{for(const l of r)l.remove()};this.addCommands({cmd:a,undo:o,mustExec:!0})}catch(r){vn(`paste: "${r.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),x(this,Os)!==_n.NONE&&!this.isEditorHandlingKeyboard&&Xf._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,x(this,Y0)&&(O(this,Y0,!1),F(this,Ct,T9).call(this,"main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}setEditingState(e){e?(F(this,Ct,_E).call(this),F(this,Ct,y8).call(this),F(this,Ct,Ur).call(this,{isEditing:x(this,Os)!==_n.NONE,isEmpty:F(this,Ct,Jm).call(this),hasSomethingToUndo:x(this,oo).hasSomethingToUndo(),hasSomethingToRedo:x(this,oo).hasSomethingToRedo(),hasSelectedEditor:!1})):(F(this,Ct,vE).call(this),F(this,Ct,w8).call(this),F(this,Ct,Ur).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!x(this,Lo)){O(this,Lo,e);for(const t of x(this,Lo))F(this,Ct,xc).call(this,t.defaultPropertiesToUpdate)}}getId(){return x(this,v5).id}get currentLayer(){return x(this,rr).get(x(this,v1))}getLayer(e){return x(this,rr).get(e)}get currentPageIndex(){return x(this,v1)}addLayer(e){x(this,rr).set(e.pageIndex,e),x(this,J0)?e.enable():e.disable()}removeLayer(e){x(this,rr).delete(e.pageIndex)}async updateMode(e,t=null,i=!1,s=!1){var r,a,o;if(x(this,Os)!==e&&!(x(this,lo)&&(await x(this,lo).promise,!x(this,lo)))){if(O(this,lo,Promise.withResolvers()),(r=x(this,K0))==null||r.commitOrRemove(),O(this,Os,e),e===_n.NONE){this.setEditingState(!1),F(this,Ct,SE).call(this),(a=this._editorUndoBar)==null||a.hide(),x(this,lo).resolve();return}e===_n.SIGNATURE&&await((o=x(this,$0))==null?void 0:o.loadSignatures()),this.setEditingState(!0),await F(this,Ct,AE).call(this),this.unselectAll();for(const l of x(this,rr).values())l.updateMode(e);if(!t){i&&this.addNewEditorFromKeyboard(),x(this,lo).resolve();return}for(const l of x(this,Is).values())l.annotationElementId===t||l.id===t?(this.setSelected(l),s&&l.enterInEditMode()):l.unselect();x(this,lo).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e.mode!==x(this,Os)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...e})}updateParams(e,t){var i;if(x(this,Lo)){switch(e){case Vn.CREATE:this.currentLayer.addNewEditor(t);return;case Vn.HIGHLIGHT_DEFAULT_COLOR:(i=x(this,Du))==null||i.updateColor(t);break;case Vn.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(x(this,S2)||O(this,S2,new Map)).set(e,t),this.showAllEditors("highlight",t);break}for(const s of x(this,hi))s.updateParams(e,t);for(const s of x(this,Lo))s.updateDefaultParams(e,t)}}showAllEditors(e,t,i=!1){var r;for(const a of x(this,Is).values())a.editorType===e&&a.show(t);(((r=x(this,S2))==null?void 0:r.get(Vn.HIGHLIGHT_SHOW_ALL))??!0)!==t&&F(this,Ct,xc).call(this,[[Vn.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(x(this,C2)!==e){O(this,C2,e);for(const t of x(this,rr).values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}getEditors(e){const t=[];for(const i of x(this,Is).values())i.pageIndex===e&&t.push(i);return t}getEditor(e){return x(this,Is).get(e)}addEditor(e){x(this,Is).set(e.id,e)}removeEditor(e){var t,i;e.div.contains(document.activeElement)&&(x(this,Nl)&&clearTimeout(x(this,Nl)),O(this,Nl,setTimeout(()=>{this.focusMainContainer(),O(this,Nl,null)},0))),x(this,Is).delete(e.id),e.annotationElementId&&((t=x(this,Q0))==null||t.delete(e.annotationElementId)),this.unselect(e),(!e.annotationElementId||!x(this,Pu).has(e.annotationElementId))&&((i=x(this,Ec))==null||i.remove(e.id))}addDeletedAnnotationElement(e){x(this,Pu).add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return x(this,Pu).has(e)}removeDeletedAnnotationElement(e){x(this,Pu).delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}setActiveEditor(e){x(this,Ea)!==e&&(O(this,Ea,e),e&&F(this,Ct,xc).call(this,e.propertiesToUpdate))}updateUI(e){x(this,Ct,IE)===e&&F(this,Ct,xc).call(this,e.propertiesToUpdate)}updateUIForDefaultProperties(e){F(this,Ct,xc).call(this,e.defaultPropertiesToUpdate)}toggleSelected(e){if(x(this,hi).has(e)){x(this,hi).delete(e),e.unselect(),F(this,Ct,Ur).call(this,{hasSelectedEditor:this.hasSelection});return}x(this,hi).add(e),e.select(),F(this,Ct,xc).call(this,e.propertiesToUpdate),F(this,Ct,Ur).call(this,{hasSelectedEditor:!0})}setSelected(e){var t;this.updateToolbar({mode:e.mode,editId:e.id}),(t=x(this,K0))==null||t.commitOrRemove();for(const i of x(this,hi))i!==e&&i.unselect();x(this,hi).clear(),x(this,hi).add(e),e.select(),F(this,Ct,xc).call(this,e.propertiesToUpdate),F(this,Ct,Ur).call(this,{hasSelectedEditor:!0})}isSelected(e){return x(this,hi).has(e)}get firstSelectedEditor(){return x(this,hi).values().next().value}unselect(e){e.unselect(),x(this,hi).delete(e),F(this,Ct,Ur).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return x(this,hi).size!==0}get isEnterHandled(){return x(this,hi).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){var e;x(this,oo).undo(),F(this,Ct,Ur).call(this,{hasSomethingToUndo:x(this,oo).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:F(this,Ct,Jm).call(this)}),(e=this._editorUndoBar)==null||e.hide()}redo(){x(this,oo).redo(),F(this,Ct,Ur).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:x(this,oo).hasSomethingToRedo(),isEmpty:F(this,Ct,Jm).call(this)})}addCommands(e){x(this,oo).add(e),F(this,Ct,Ur).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:F(this,Ct,Jm).call(this)})}cleanUndoStack(e){x(this,oo).cleanType(e)}delete(){var r;this.commitOrRemove();const e=(r=this.currentLayer)==null?void 0:r.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...x(this,hi)],i=()=>{var a;(a=this._editorUndoBar)==null||a.show(s,t.length===1?t[0].editorType:t.length);for(const o of t)o.remove()},s=()=>{for(const a of t)F(this,Ct,_8).call(this,a)};this.addCommands({cmd:i,undo:s,mustExec:!0})}commitOrRemove(){var e;(e=x(this,Ea))==null||e.commitOrRemove()}hasSomethingToControl(){return x(this,Ea)||this.hasSelection}selectAll(){for(const e of x(this,hi))e.commit();F(this,Ct,v8).call(this,x(this,Is).values())}unselectAll(){var e;if(!(x(this,Ea)&&(x(this,Ea).commitOrRemove(),x(this,Os)!==_n.NONE))&&!((e=x(this,K0))!=null&&e.commitOrRemove())&&this.hasSelection){for(const t of x(this,hi))t.unselect();x(this,hi).clear(),F(this,Ct,Ur).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(e,t,i=!1){if(i||this.commitOrRemove(),!this.hasSelection)return;x(this,eh)[0]+=e,x(this,eh)[1]+=t;const[s,r]=x(this,eh),a=[...x(this,hi)],o=1e3;x(this,Dl)&&clearTimeout(x(this,Dl)),O(this,Dl,setTimeout(()=>{O(this,Dl,null),x(this,eh)[0]=x(this,eh)[1]=0,this.addCommands({cmd:()=>{for(const l of a)x(this,Is).has(l.id)&&(l.translateInPage(s,r),l.translationDone())},undo:()=>{for(const l of a)x(this,Is).has(l.id)&&(l.translateInPage(-s,-r),l.translationDone())},mustExec:!1})},o));for(const l of a)l.translateInPage(e,t),l.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),O(this,Pl,new Map);for(const e of x(this,hi))x(this,Pl).set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!x(this,Pl))return!1;this.disableUserSelect(!1);const e=x(this,Pl);O(this,Pl,null);let t=!1;for(const[{x:s,y:r,pageIndex:a},o]of e)o.newX=s,o.newY=r,o.newPageIndex=a,t||(t=s!==o.savedX||r!==o.savedY||a!==o.savedPageIndex);if(!t)return!1;const i=(s,r,a,o)=>{if(x(this,Is).has(s.id)){const l=x(this,rr).get(o);l?s._setParentAndPosition(l,r,a):(s.pageIndex=o,s.x=r,s.y=a)}};return this.addCommands({cmd:()=>{for(const[s,{newX:r,newY:a,newPageIndex:o}]of e)i(s,r,a,o)},undo:()=>{for(const[s,{savedX:r,savedY:a,savedPageIndex:o}]of e)i(s,r,a,o)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(x(this,Pl))for(const i of x(this,Pl).keys())i.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){var e;return((e=this.getActive())==null?void 0:e.shouldGetKeyboardEvents())||x(this,hi).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return x(this,Ea)===e}getActive(){return x(this,Ea)}getMode(){return x(this,Os)}get imageManager(){return zn(this,"imageManager",new m8)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let c=0,h=t.rangeCount;c<h;c++)if(!e.contains(t.getRangeAt(c).commonAncestorContainer))return null;const{x:i,y:s,width:r,height:a}=e.getBoundingClientRect();let o;switch(e.getAttribute("data-main-rotation")){case"90":o=(c,h,u,d)=>({x:(h-s)/a,y:1-(c+u-i)/r,width:d/a,height:u/r});break;case"180":o=(c,h,u,d)=>({x:1-(c+u-i)/r,y:1-(h+d-s)/a,width:u/r,height:d/a});break;case"270":o=(c,h,u,d)=>({x:1-(h+d-s)/a,y:(c-i)/r,width:d/a,height:u/r});break;default:o=(c,h,u,d)=>({x:(c-i)/r,y:(h-s)/a,width:u/r,height:d/a});break}const l=[];for(let c=0,h=t.rangeCount;c<h;c++){const u=t.getRangeAt(c);if(!u.collapsed)for(const{x:d,y:f,width:g,height:m}of u.getClientRects())g===0||m===0||l.push(o(d,f,g,m))}return l.length===0?null:l}addChangedExistingAnnotation({annotationElementId:e,id:t}){(x(this,_1)||O(this,_1,new Map)).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){var t;(t=x(this,_1))==null||t.delete(e)}renderAnnotationElement(e){var s;const t=(s=x(this,_1))==null?void 0:s.get(e.data.id);if(!t)return;const i=x(this,Ec).getRawValue(t);i&&(x(this,Os)===_n.NONE&&!i.hasBeenModified||i.renderAnnotationElement(e))}setMissingCanvas(e,t,i){var r;const s=(r=x(this,Q0))==null?void 0:r.get(e);s&&(s.setCanvas(t,i),x(this,Q0).delete(e))}addMissingCanvas(e,t){(x(this,Q0)||O(this,Q0,new Map)).set(e,t)}};y1=new WeakMap,Ea=new WeakMap,Is=new WeakMap,rr=new WeakMap,w1=new WeakMap,Ec=new WeakMap,_1=new WeakMap,oo=new WeakMap,W0=new WeakMap,K0=new WeakMap,v1=new WeakMap,Pu=new WeakMap,Pl=new WeakMap,Lo=new WeakMap,Nu=new WeakMap,_2=new WeakMap,v2=new WeakMap,k1=new WeakMap,k2=new WeakMap,Nl=new WeakMap,X0=new WeakMap,C1=new WeakMap,Y0=new WeakMap,Ol=new WeakMap,v5=new WeakMap,J0=new WeakMap,C2=new WeakMap,Z0=new WeakMap,Ou=new WeakMap,Du=new WeakMap,Q0=new WeakMap,A2=new WeakMap,Os=new WeakMap,hi=new WeakMap,Tc=new WeakMap,$0=new WeakMap,Fu=new WeakMap,S2=new WeakMap,I2=new WeakMap,eh=new WeakMap,Dl=new WeakMap,Rc=new WeakMap,E2=new WeakMap,T2=new WeakMap,lo=new WeakMap,Ct=new WeakSet,E9=function({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e},b8=function(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const i of x(this,rr).values())if(i.hasTextLayer(e))return i;return null},xE=function(){const e=document.getSelection();if(!e||e.isCollapsed)return;const i=F(this,Ct,E9).call(this,e).closest(".textLayer"),s=this.getSelectionBoxes(i);s&&(x(this,Ol)||O(this,Ol,new XL(this)),x(this,Ol).show(i,s,this.direction==="ltr"))},yE=function(){var r,a,o;const e=document.getSelection();if(!e||e.isCollapsed){x(this,Tc)&&((r=x(this,Ol))==null||r.hide(),O(this,Tc,null),F(this,Ct,Ur).call(this,{hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===x(this,Tc))return;const s=F(this,Ct,E9).call(this,e).closest(".textLayer");if(!s){x(this,Tc)&&((a=x(this,Ol))==null||a.hide(),O(this,Tc,null),F(this,Ct,Ur).call(this,{hasSelectedText:!1}));return}if((o=x(this,Ol))==null||o.hide(),O(this,Tc,t),F(this,Ct,Ur).call(this,{hasSelectedText:!0}),!(x(this,Os)!==_n.HIGHLIGHT&&x(this,Os)!==_n.NONE)&&(x(this,Os)===_n.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),O(this,Y0,this.isShiftKeyDown),!this.isShiftKeyDown)){const l=x(this,Os)===_n.HIGHLIGHT?F(this,Ct,b8).call(this,s):null;l==null||l.toggleDrawing();const c=new AbortController,h=this.combinedSignal(c),u=d=>{d.type==="pointerup"&&d.button!==0||(c.abort(),l==null||l.toggleDrawing(!0),d.type==="pointerup"&&F(this,Ct,T9).call(this,"main_toolbar"))};window.addEventListener("pointerup",u,{signal:h}),window.addEventListener("blur",u,{signal:h})}},T9=function(e=""){x(this,Os)===_n.HIGHLIGHT?this.highlightSelection(e):x(this,_2)&&F(this,Ct,xE).call(this)},wE=function(){document.addEventListener("selectionchange",F(this,Ct,yE).bind(this),{signal:this._signal})},_E=function(){if(x(this,X0))return;O(this,X0,new AbortController);const e=this.combinedSignal(x(this,X0));window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})},vE=function(){var e;(e=x(this,X0))==null||e.abort(),O(this,X0,null)},x8=function(){if(x(this,Z0))return;O(this,Z0,new AbortController);const e=this.combinedSignal(x(this,Z0));window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})},kE=function(){var e;(e=x(this,Z0))==null||e.abort(),O(this,Z0,null)},y8=function(){if(x(this,W0))return;O(this,W0,new AbortController);const e=this.combinedSignal(x(this,W0));document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})},w8=function(){var e;(e=x(this,W0))==null||e.abort(),O(this,W0,null)},CE=function(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})},Ur=function(e){Object.entries(e).some(([i,s])=>x(this,I2)[i]!==s)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(x(this,I2),e)}),x(this,Os)===_n.HIGHLIGHT&&e.hasSelectedEditor===!1&&F(this,Ct,xc).call(this,[[Vn.HIGHLIGHT_FREE,!0]]))},xc=function(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})},AE=async function(){if(!x(this,J0)){O(this,J0,!0);const e=[];for(const t of x(this,rr).values())e.push(t.enable());await Promise.all(e);for(const t of x(this,Is).values())t.enable()}},SE=function(){if(this.unselectAll(),x(this,J0)){O(this,J0,!1);for(const e of x(this,rr).values())e.disable();for(const e of x(this,Is).values())e.disable()}},_8=function(e){const t=x(this,rr).get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))},IE=function(){let e=null;for(e of x(this,hi));return e},Jm=function(){if(x(this,Is).size===0)return!0;if(x(this,Is).size===1)for(const e of x(this,Is).values())return e.isEmpty();return!1},v8=function(e){for(const t of x(this,hi))t.unselect();x(this,hi).clear();for(const t of e)t.isEmpty()||(x(this,hi).add(t),t.select());F(this,Ct,Ur).call(this,{hasSelectedEditor:this.hasSelection})},Ue(Xf,"TRANSLATE_SMALL",1),Ue(Xf,"TRANSLATE_BIG",10);let Qd=Xf;var Ds,Fl,Bo,A1,Ll,Ta,S1,Bl,la,Mc,Lu,Ul,th,sl,Zm,R9;const Hr=class Hr{constructor(e){U(this,sl);U(this,Ds,null);U(this,Fl,!1);U(this,Bo,null);U(this,A1,null);U(this,Ll,null);U(this,Ta,null);U(this,S1,!1);U(this,Bl,null);U(this,la,null);U(this,Mc,null);U(this,Lu,null);U(this,Ul,!1);O(this,la,e),O(this,Ul,e._uiManager.useNewAltTextFlow),x(Hr,th)||O(Hr,th,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(e){Hr._l10n??(Hr._l10n=e)}async render(){const e=O(this,Bo,document.createElement("button"));e.className="altText",e.tabIndex="0";const t=O(this,A1,document.createElement("span"));e.append(t),x(this,Ul)?(e.classList.add("new"),e.setAttribute("data-l10n-id",x(Hr,th).missing),t.setAttribute("data-l10n-id",x(Hr,th)["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const i=x(this,la)._uiManager._signal;e.addEventListener("contextmenu",ll,{signal:i}),e.addEventListener("pointerdown",r=>r.stopPropagation(),{signal:i});const s=r=>{r.preventDefault(),x(this,la)._uiManager.editAltText(x(this,la)),x(this,Ul)&&x(this,la)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:x(this,sl,Zm)}})};return e.addEventListener("click",s,{capture:!0,signal:i}),e.addEventListener("keydown",r=>{r.target===e&&r.key==="Enter"&&(O(this,S1,!0),s(r))},{signal:i}),await F(this,sl,R9).call(this),e}finish(){x(this,Bo)&&(x(this,Bo).focus({focusVisible:x(this,S1)}),O(this,S1,!1))}isEmpty(){return x(this,Ul)?x(this,Ds)===null:!x(this,Ds)&&!x(this,Fl)}hasData(){return x(this,Ul)?x(this,Ds)!==null||!!x(this,Mc):this.isEmpty()}get guessedText(){return x(this,Mc)}async setGuessedText(e){x(this,Ds)===null&&(O(this,Mc,e),O(this,Lu,await Hr._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e})),F(this,sl,R9).call(this))}toggleAltTextBadge(e=!1){var t;if(!x(this,Ul)||x(this,Ds)){(t=x(this,Bl))==null||t.remove(),O(this,Bl,null);return}if(!x(this,Bl)){const i=O(this,Bl,document.createElement("div"));i.className="noAltTextBadge",x(this,la).div.append(i)}x(this,Bl).classList.toggle("hidden",!e)}serialize(e){let t=x(this,Ds);return!e&&x(this,Mc)===t&&(t=x(this,Lu)),{altText:t,decorative:x(this,Fl),guessedText:x(this,Mc),textWithDisclaimer:x(this,Lu)}}get data(){return{altText:x(this,Ds),decorative:x(this,Fl)}}set data({altText:e,decorative:t,guessedText:i,textWithDisclaimer:s,cancel:r=!1}){i&&(O(this,Mc,i),O(this,Lu,s)),!(x(this,Ds)===e&&x(this,Fl)===t)&&(r||(O(this,Ds,e),O(this,Fl,t)),F(this,sl,R9).call(this))}toggle(e=!1){x(this,Bo)&&(!e&&x(this,Ta)&&(clearTimeout(x(this,Ta)),O(this,Ta,null)),x(this,Bo).disabled=!e)}shown(){x(this,la)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:x(this,sl,Zm)}})}destroy(){var e,t;(e=x(this,Bo))==null||e.remove(),O(this,Bo,null),O(this,A1,null),O(this,Ll,null),(t=x(this,Bl))==null||t.remove(),O(this,Bl,null)}};Ds=new WeakMap,Fl=new WeakMap,Bo=new WeakMap,A1=new WeakMap,Ll=new WeakMap,Ta=new WeakMap,S1=new WeakMap,Bl=new WeakMap,la=new WeakMap,Mc=new WeakMap,Lu=new WeakMap,Ul=new WeakMap,th=new WeakMap,sl=new WeakSet,Zm=function(){return x(this,Ds)&&"added"||x(this,Ds)===null&&this.guessedText&&"review"||"missing"},R9=async function(){var s,r,a;const e=x(this,Bo);if(!e)return;if(x(this,Ul)){if(e.classList.toggle("done",!!x(this,Ds)),e.setAttribute("data-l10n-id",x(Hr,th)[x(this,sl,Zm)]),(s=x(this,A1))==null||s.setAttribute("data-l10n-id",x(Hr,th)[`${x(this,sl,Zm)}-label`]),!x(this,Ds)){(r=x(this,Ll))==null||r.remove();return}}else{if(!x(this,Ds)&&!x(this,Fl)){e.classList.remove("done"),(a=x(this,Ll))==null||a.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=x(this,Ll);if(!t){O(this,Ll,t=document.createElement("span")),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${x(this,la).id}`;const o=100,l=x(this,la)._uiManager._signal;l.addEventListener("abort",()=>{clearTimeout(x(this,Ta)),O(this,Ta,null)},{once:!0}),e.addEventListener("mouseenter",()=>{O(this,Ta,setTimeout(()=>{O(this,Ta,null),x(this,Ll).classList.add("show"),x(this,la)._reportTelemetry({action:"alt_text_tooltip"})},o))},{signal:l}),e.addEventListener("mouseleave",()=>{var c;x(this,Ta)&&(clearTimeout(x(this,Ta)),O(this,Ta,null)),(c=x(this,Ll))==null||c.classList.remove("show")},{signal:l})}x(this,Fl)?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=x(this,Ds)),t.parentNode||e.append(t);const i=x(this,la).getElementForAltText();i==null||i.setAttribute("aria-describedby",t.id)},U(Hr,th,null),Ue(Hr,"_l10n",null);let C3=Hr;var I1,Bu,R2,M2,P2,N2,O2,Pc,Uu,Nc,Hu,Oc,Zh,EE,TE,RE;const Q_=class Q_{constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:i=null,onPinchStart:s=null,onPinching:r=null,onPinchEnd:a=null,signal:o}){U(this,Zh);U(this,I1);U(this,Bu,!1);U(this,R2,null);U(this,M2);U(this,P2);U(this,N2);U(this,O2);U(this,Pc,null);U(this,Uu);U(this,Nc,null);U(this,Hu);U(this,Oc,null);O(this,I1,e),O(this,R2,i),O(this,M2,t),O(this,P2,s),O(this,N2,r),O(this,O2,a),O(this,Hu,new AbortController),O(this,Uu,AbortSignal.any([o,x(this,Hu).signal])),e.addEventListener("touchstart",F(this,Zh,EE).bind(this),{passive:!1,signal:x(this,Uu)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/cc.pixelRatio}destroy(){var e,t;(e=x(this,Hu))==null||e.abort(),O(this,Hu,null),(t=x(this,Pc))==null||t.abort(),O(this,Pc,null)}};I1=new WeakMap,Bu=new WeakMap,R2=new WeakMap,M2=new WeakMap,P2=new WeakMap,N2=new WeakMap,O2=new WeakMap,Pc=new WeakMap,Uu=new WeakMap,Nc=new WeakMap,Hu=new WeakMap,Oc=new WeakMap,Zh=new WeakSet,EE=function(e){var s,r,a;if((s=x(this,M2))!=null&&s.call(this))return;if(e.touches.length===1){if(x(this,Pc))return;const o=O(this,Pc,new AbortController),l=AbortSignal.any([x(this,Uu),o.signal]),c=x(this,I1),h={capture:!0,signal:l,passive:!1},u=d=>{var f;d.pointerType==="touch"&&((f=x(this,Pc))==null||f.abort(),O(this,Pc,null))};c.addEventListener("pointerdown",d=>{d.pointerType==="touch"&&(ys(d),u(d))},h),c.addEventListener("pointerup",u,h),c.addEventListener("pointercancel",u,h);return}if(!x(this,Oc)){O(this,Oc,new AbortController);const o=AbortSignal.any([x(this,Uu),x(this,Oc).signal]),l=x(this,I1),c={signal:o,capture:!1,passive:!1};l.addEventListener("touchmove",F(this,Zh,TE).bind(this),c);const h=F(this,Zh,RE).bind(this);l.addEventListener("touchend",h,c),l.addEventListener("touchcancel",h,c),c.capture=!0,l.addEventListener("pointerdown",ys,c),l.addEventListener("pointermove",ys,c),l.addEventListener("pointercancel",ys,c),l.addEventListener("pointerup",ys,c),(r=x(this,P2))==null||r.call(this)}if(ys(e),e.touches.length!==2||(a=x(this,R2))!=null&&a.call(this)){O(this,Nc,null);return}let[t,i]=e.touches;t.identifier>i.identifier&&([t,i]=[i,t]),O(this,Nc,{touch0X:t.screenX,touch0Y:t.screenY,touch1X:i.screenX,touch1Y:i.screenY})},TE=function(e){var _;if(!x(this,Nc)||e.touches.length!==2)return;ys(e);let[t,i]=e.touches;t.identifier>i.identifier&&([t,i]=[i,t]);const{screenX:s,screenY:r}=t,{screenX:a,screenY:o}=i,l=x(this,Nc),{touch0X:c,touch0Y:h,touch1X:u,touch1Y:d}=l,f=u-c,g=d-h,m=a-s,b=o-r,p=Math.hypot(m,b)||1,y=Math.hypot(f,g)||1;if(!x(this,Bu)&&Math.abs(y-p)<=Q_.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(l.touch0X=s,l.touch0Y=r,l.touch1X=a,l.touch1Y=o,!x(this,Bu)){O(this,Bu,!0);return}const w=[(s+a)/2,(r+o)/2];(_=x(this,N2))==null||_.call(this,w,y,p)},RE=function(e){var t;e.touches.length>=2||(x(this,Oc)&&(x(this,Oc).abort(),O(this,Oc,null),(t=x(this,O2))==null||t.call(this)),x(this,Nc)&&(ys(e),O(this,Nc,null),O(this,Bu,!1)))};let A3=Q_;var zu,Uo,Ni,E1,nh,D2,ju,ar,Gu,Dc,ih,F2,Vu,Ra,L2,qu,Fc,Hl,T1,R1,co,Wu,B2,k5,cn,k8,U2,C8,M9,ME,PE,A8,P9,S8,NE,OE,DE,I8,FE,E8,LE,BE,UE,T8,Qm;const Tn=class Tn{constructor(e){U(this,cn);U(this,zu,null);U(this,Uo,null);U(this,Ni,null);U(this,E1,!1);U(this,nh,null);U(this,D2,"");U(this,ju,!1);U(this,ar,null);U(this,Gu,null);U(this,Dc,null);U(this,ih,null);U(this,F2,"");U(this,Vu,!1);U(this,Ra,null);U(this,L2,!1);U(this,qu,!1);U(this,Fc,!1);U(this,Hl,null);U(this,T1,0);U(this,R1,0);U(this,co,null);U(this,Wu,null);Ue(this,"isSelected",!1);Ue(this,"_isCopy",!1);Ue(this,"_editToolbar",null);Ue(this,"_initialOptions",Object.create(null));Ue(this,"_initialData",null);Ue(this,"_isVisible",!0);Ue(this,"_uiManager",null);Ue(this,"_focusEventsAllowed",!0);U(this,B2,!1);U(this,k5,Tn._zIndex++);this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null,this.annotationElementId=e.annotationElementId||null;const{rotation:t,rawDims:{pageWidth:i,pageHeight:s,pageX:r,pageY:a}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[i,s],this.pageTranslation=[r,a];const[o,l]=this.parentDimensions;this.x=e.x/o,this.y=e.y/l,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const e=Tn.prototype._resizeWithKeyboard,t=Qd.TRANSLATE_SMALL,i=Qd.TRANSLATE_BIG;return zn(this,"_resizerKeyboardManager",new mx([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-i,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[i,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-i]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,i]}],[["Escape","mac+Escape"],Tn.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return zn(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new ZL({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(Tn._l10n??(Tn._l10n=e),Tn._l10nResizer||(Tn._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),Tn._borderLineWidth!==-1)return;const i=getComputedStyle(document.documentElement);Tn._borderLineWidth=parseFloat(i.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){bi("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return x(this,B2)}set _isDraggable(e){var t;O(this,B2,e),(t=this.div)==null||t.classList.toggle("draggable",e)}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=x(this,k5)}setParent(e){e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):F(this,cn,Qm).call(this),this.parent=e}focusin(e){this._focusEventsAllowed&&(x(this,Vu)?O(this,Vu,!1):this.parent.setSelected(this))}focusout(e){var i;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const t=e.relatedTarget;t!=null&&t.closest(`#${this.id}`)||(e.preventDefault(),(i=this.parent)!=null&&i.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,i,s){const[r,a]=this.parentDimensions;[i,s]=this.screenToPageTranslation(i,s),this.x=(e+i)/r,this.y=(t+s)/a,this.fixAndSetPosition()}_moveAfterPaste(e,t){const[i,s]=this.parentDimensions;this.setAt(e*i,t*s,this.width*i,this.height*s),this._onTranslated()}translate(e,t){F(this,cn,k8).call(this,this.parentDimensions,e,t)}translateInPage(e,t){x(this,Ra)||O(this,Ra,[this.x,this.y,this.width,this.height]),F(this,cn,k8).call(this,this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(e,t){x(this,Ra)||O(this,Ra,[this.x,this.y,this.width,this.height]);const{div:i,parentDimensions:[s,r]}=this;if(this.x+=e/s,this.y+=t/r,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:u,y:d}=this.div.getBoundingClientRect();this.parent.findNewParent(this,u,d)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:a,y:o}=this;const[l,c]=this.getBaseTranslation();a+=l,o+=c;const{style:h}=i;h.left=`${(100*a).toFixed(2)}%`,h.top=`${(100*o).toFixed(2)}%`,this._onTranslating(a,o),i.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!x(this,Ra)&&(x(this,Ra)[0]!==this.x||x(this,Ra)[1]!==this.y)}get _hasBeenResized(){return!!x(this,Ra)&&(x(this,Ra)[2]!==this.width||x(this,Ra)[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:i}=Tn,s=i/e,r=i/t;switch(this.rotation){case 90:return[-s,r];case 180:return[s,r];case 270:return[s,-r];default:return[-s,-r]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[i,s]}=this;let{x:r,y:a,width:o,height:l}=this;if(o*=i,l*=s,r*=i,a*=s,this._mustFixPosition)switch(e){case 0:r=qr(r,0,i-o),a=qr(a,0,s-l);break;case 90:r=qr(r,0,i-l),a=qr(a,o,s);break;case 180:r=qr(r,o,i),a=qr(a,l,s);break;case 270:r=qr(r,l,i),a=qr(a,0,s-o);break}this.x=r/=i,this.y=a/=s;const[c,h]=this.getBaseTranslation();r+=c,a+=h,t.left=`${(100*r).toFixed(2)}%`,t.top=`${(100*a).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(e,t){var i;return F(i=Tn,U2,C8).call(i,e,t,this.parentRotation)}pageTranslationToScreen(e,t){var i;return F(i=Tn,U2,C8).call(i,e,t,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,i]}=this;return[t*e,i*e]}setDims(e,t){const[i,s]=this.parentDimensions,{style:r}=this.div;r.width=`${(100*e/i).toFixed(2)}%`,x(this,ju)||(r.height=`${(100*t/s).toFixed(2)}%`)}fixDims(){const{style:e}=this.div,{height:t,width:i}=e,s=i.endsWith("%"),r=!x(this,ju)&&t.endsWith("%");if(s&&r)return;const[a,o]=this.parentDimensions;s||(e.width=`${(100*parseFloat(i)/a).toFixed(2)}%`),!x(this,ju)&&!r&&(e.height=`${(100*parseFloat(t)/o).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}_onResized(){}static _round(e){return Math.round(e*1e4)/1e4}_onResizing(){}altTextFinish(){var e;(e=x(this,Ni))==null||e.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||x(this,qu))return this._editToolbar;this._editToolbar=new g8(this),this.div.append(this._editToolbar.render());const{toolbarButtons:e}=this;if(e)for(const[t,i]of e)await this._editToolbar.addButton(t,i);return this._editToolbar.addButton("delete"),this._editToolbar}removeEditToolbar(){var e;this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,(e=x(this,Ni))==null||e.destroy())}addContainer(e){var i;const t=(i=this._editToolbar)==null?void 0:i.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return x(this,Ni)||(C3.initialize(Tn._l10n),O(this,Ni,new C3(this)),x(this,zu)&&(x(this,Ni).data=x(this,zu),O(this,zu,null))),x(this,Ni)}get altTextData(){var e;return(e=x(this,Ni))==null?void 0:e.data}set altTextData(e){x(this,Ni)&&(x(this,Ni).data=e)}get guessedAltText(){var e;return(e=x(this,Ni))==null?void 0:e.guessedText}async setGuessedAltText(e){var t;await((t=x(this,Ni))==null?void 0:t.setGuessedText(e))}serializeAltText(e){var t;return(t=x(this,Ni))==null?void 0:t.serialize(e)}hasAltText(){return!!x(this,Ni)&&!x(this,Ni).isEmpty()}hasAltTextData(){var e;return((e=x(this,Ni))==null?void 0:e.hasData())??!1}render(){var a;const e=this.div=document.createElement("div");e.setAttribute("data-editor-rotation",(360-this.rotation)%360),e.className=this.name,e.setAttribute("id",this.id),e.tabIndex=x(this,E1)?-1:0,e.setAttribute("role","application"),this.defaultL10nId&&e.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||e.classList.add("hidden"),this.setInForeground(),F(this,cn,E8).call(this);const[t,i]=this.parentDimensions;this.parentRotation%180!==0&&(e.style.maxWidth=`${(100*i/t).toFixed(2)}%`,e.style.maxHeight=`${(100*t/i).toFixed(2)}%`);const[s,r]=this.getInitialTranslation();return this.translate(s,r),pE(this,e,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(x(this,Wu)||O(this,Wu,new A3({container:e,isPinchingDisabled:()=>!this.isSelected,onPinchStart:F(this,cn,NE).bind(this),onPinching:F(this,cn,OE).bind(this),onPinchEnd:F(this,cn,DE).bind(this),signal:this._uiManager._signal}))),(a=this._uiManager._editorUndoBar)==null||a.hide(),e}pointerdown(e){const{isMac:t}=br.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(O(this,Vu,!0),this._isDraggable){F(this,cn,FE).call(this,e);return}F(this,cn,I8).call(this,e)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){x(this,Hl)&&clearTimeout(x(this,Hl)),O(this,Hl,setTimeout(()=>{var e;O(this,Hl,null),(e=this.parent)==null||e.moveEditorInDOM(this)},0))}_setParentAndPosition(e,t,i){e.changeParent(this),this.x=t,this.y=i,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,i=this.rotation){const s=this.parentScale,[r,a]=this.pageDimensions,[o,l]=this.pageTranslation,c=e/s,h=t/s,u=this.x*r,d=this.y*a,f=this.width*r,g=this.height*a;switch(i){case 0:return[u+c+o,a-d-h-g+l,u+c+f+o,a-d-h+l];case 90:return[u+h+o,a-d+c+l,u+h+g+o,a-d+c+f+l];case 180:return[u-c-f+o,a-d+h+l,u-c+o,a-d+h+g+l];case 270:return[u-h-g+o,a-d-c-f+l,u-h+o,a-d-c+l];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[i,s,r,a]=e,o=r-i,l=a-s;switch(this.rotation){case 0:return[i,t-a,o,l];case 90:return[i,t-s,l,o];case 180:return[r,t-s,o,l];case 270:return[r,t-a,l,o];default:throw new Error("Invalid rotation")}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),O(this,qu,!0),!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),O(this,qu,!1),!0):!1}isInEditMode(){return x(this,qu)}shouldGetKeyboardEvents(){return x(this,Fc)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:i,right:s}=this.getClientDimensions(),{innerHeight:r,innerWidth:a}=window;return t<a&&s>0&&e<r&&i>0}rebuild(){F(this,cn,E8).call(this)}rotate(e){}resize(){}serializeDeleted(){var e;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((e=this._initialData)==null?void 0:e.popupRef)||""}}serialize(e=!1,t=null){bi("An editor must be serializable")}static async deserialize(e,t,i){const s=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:i,annotationElementId:e.annotationElementId});s.rotation=e.rotation,O(s,zu,e.accessibilityData),s._isCopy=e.isCopy||!1;const[r,a]=s.pageDimensions,[o,l,c,h]=s.getRectInCurrentCoords(e.rect,a);return s.x=o/r,s.y=l/a,s.width=c/r,s.height=h/a,s}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var e,t;if((e=x(this,ih))==null||e.abort(),O(this,ih,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),x(this,Hl)&&(clearTimeout(x(this,Hl)),O(this,Hl,null)),F(this,cn,Qm).call(this),this.removeEditToolbar(),x(this,co)){for(const i of x(this,co).values())clearTimeout(i);O(this,co,null)}this.parent=null,(t=x(this,Wu))==null||t.destroy(),O(this,Wu,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(F(this,cn,ME).call(this),x(this,ar).classList.remove("hidden"))}get toolbarPosition(){return null}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),O(this,Dc,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const t=x(this,ar).children;if(!x(this,Uo)){O(this,Uo,Array.from(t));const a=F(this,cn,LE).bind(this),o=F(this,cn,BE).bind(this),l=this._uiManager._signal;for(const c of x(this,Uo)){const h=c.getAttribute("data-resizer-name");c.setAttribute("role","spinbutton"),c.addEventListener("keydown",a,{signal:l}),c.addEventListener("blur",o,{signal:l}),c.addEventListener("focus",F(this,cn,UE).bind(this,h),{signal:l}),c.setAttribute("data-l10n-id",Tn._l10nResizer[h])}}const i=x(this,Uo)[0];let s=0;for(const a of t){if(a===i)break;s++}const r=(360-this.rotation+this.parentRotation)%360/90*(x(this,Uo).length/4);if(r!==s){if(r<s)for(let o=0;o<s-r;o++)x(this,ar).append(x(this,ar).firstChild);else if(r>s)for(let o=0;o<r-s;o++)x(this,ar).firstChild.before(x(this,ar).lastChild);let a=0;for(const o of t){const c=x(this,Uo)[a++].getAttribute("data-resizer-name");o.setAttribute("data-l10n-id",Tn._l10nResizer[c])}}F(this,cn,T8).call(this,0),O(this,Fc,!0),x(this,ar).firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}_resizeWithKeyboard(e,t){x(this,Fc)&&F(this,cn,S8).call(this,x(this,F2),{deltaX:e,deltaY:t,fromKeyboard:!0})}_stopResizingWithKeyboard(){F(this,cn,Qm).call(this),this.div.focus()}select(){var e,t,i;if(!(this.isSelected&&this._editToolbar)){if(this.isSelected=!0,this.makeResizable(),(e=this.div)==null||e.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var s,r;(s=this.div)!=null&&s.classList.contains("selectedEditor")&&((r=this._editToolbar)==null||r.show())});return}(t=this._editToolbar)==null||t.show(),(i=x(this,Ni))==null||i.toggleAltTextBadge(!1)}}unselect(){var e,t,i,s,r;this.isSelected&&(this.isSelected=!1,(e=x(this,ar))==null||e.classList.add("hidden"),(t=this.div)==null||t.classList.remove("selectedEditor"),(i=this.div)!=null&&i.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(s=this._editToolbar)==null||s.hide(),(r=x(this,Ni))==null||r.toggleAltTextBadge(!0))}updateParams(e,t){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(e){this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.id})}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return x(this,L2)}set isEditing(e){O(this,L2,e),this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(e,t){O(this,ju,!0);const i=e/t,{style:s}=this.div;s.aspectRatio=i,s.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){x(this,co)||O(this,co,new Map);const{action:i}=e;let s=x(this,co).get(i);s&&clearTimeout(s),s=setTimeout(()=>{this._reportTelemetry(e),x(this,co).delete(i),x(this,co).size===0&&O(this,co,null)},Tn._telemetryTimeout),x(this,co).set(i,s);return}e.type||(e.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),O(this,E1,!1)}disable(){this.div&&(this.div.tabIndex=-1),O(this,E1,!0)}renderAnnotationElement(e){let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const i=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),i.before(t)}return t}resetAnnotationElement(e){const{firstChild:t}=e.container;(t==null?void 0:t.nodeName)==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}};zu=new WeakMap,Uo=new WeakMap,Ni=new WeakMap,E1=new WeakMap,nh=new WeakMap,D2=new WeakMap,ju=new WeakMap,ar=new WeakMap,Gu=new WeakMap,Dc=new WeakMap,ih=new WeakMap,F2=new WeakMap,Vu=new WeakMap,Ra=new WeakMap,L2=new WeakMap,qu=new WeakMap,Fc=new WeakMap,Hl=new WeakMap,T1=new WeakMap,R1=new WeakMap,co=new WeakMap,Wu=new WeakMap,B2=new WeakMap,k5=new WeakMap,cn=new WeakSet,k8=function([e,t],i,s){[i,s]=this.screenToPageTranslation(i,s),this.x+=i/e,this.y+=s/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},U2=new WeakSet,C8=function(e,t,i){switch(i){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}},M9=function(e){switch(e){case 90:{const[t,i]=this.pageDimensions;return[0,-t/i,i/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,i]=this.pageDimensions;return[0,t/i,-i/t,0]}default:return[1,0,0,1]}},ME=function(){if(x(this,ar))return;O(this,ar,document.createElement("div")),x(this,ar).classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const i of e){const s=document.createElement("div");x(this,ar).append(s),s.classList.add("resizer",i),s.setAttribute("data-resizer-name",i),s.addEventListener("pointerdown",F(this,cn,PE).bind(this,i),{signal:t}),s.addEventListener("contextmenu",ll,{signal:t}),s.tabIndex=-1}this.div.prepend(x(this,ar))},PE=function(e,t){var h;t.preventDefault();const{isMac:i}=br.platform;if(t.button!==0||t.ctrlKey&&i)return;(h=x(this,Ni))==null||h.toggle(!1);const s=this._isDraggable;this._isDraggable=!1,O(this,Gu,[t.screenX,t.screenY]);const r=new AbortController,a=this._uiManager.combinedSignal(r);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",F(this,cn,S8).bind(this,e),{passive:!0,capture:!0,signal:a}),window.addEventListener("touchmove",ys,{passive:!1,signal:a}),window.addEventListener("contextmenu",ll,{signal:a}),O(this,Dc,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const o=this.parent.div.style.cursor,l=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const c=()=>{var u;r.abort(),this.parent.togglePointerEvents(!0),(u=x(this,Ni))==null||u.toggle(!0),this._isDraggable=s,this.parent.div.style.cursor=o,this.div.style.cursor=l,F(this,cn,P9).call(this)};window.addEventListener("pointerup",c,{signal:a}),window.addEventListener("blur",c,{signal:a})},A8=function(e,t,i,s){this.width=i,this.height=s,this.x=e,this.y=t;const[r,a]=this.parentDimensions;this.setDims(r*i,a*s),this.fixAndSetPosition(),this._onResized()},P9=function(){if(!x(this,Dc))return;const{savedX:e,savedY:t,savedWidth:i,savedHeight:s}=x(this,Dc);O(this,Dc,null);const r=this.x,a=this.y,o=this.width,l=this.height;r===e&&a===t&&o===i&&l===s||this.addCommands({cmd:F(this,cn,A8).bind(this,r,a,o,l),undo:F(this,cn,A8).bind(this,e,t,i,s),mustExec:!0})},S8=function(e,t){const[i,s]=this.parentDimensions,r=this.x,a=this.y,o=this.width,l=this.height,c=Tn.MIN_SIZE/i,h=Tn.MIN_SIZE/s,u=F(this,cn,M9).call(this,this.rotation),d=(P,B)=>[u[0]*P+u[2]*B,u[1]*P+u[3]*B],f=F(this,cn,M9).call(this,360-this.rotation),g=(P,B)=>[f[0]*P+f[2]*B,f[1]*P+f[3]*B];let m,b,p=!1,y=!1;switch(e){case"topLeft":p=!0,m=(P,B)=>[0,0],b=(P,B)=>[P,B];break;case"topMiddle":m=(P,B)=>[P/2,0],b=(P,B)=>[P/2,B];break;case"topRight":p=!0,m=(P,B)=>[P,0],b=(P,B)=>[0,B];break;case"middleRight":y=!0,m=(P,B)=>[P,B/2],b=(P,B)=>[0,B/2];break;case"bottomRight":p=!0,m=(P,B)=>[P,B],b=(P,B)=>[0,0];break;case"bottomMiddle":m=(P,B)=>[P/2,B],b=(P,B)=>[P/2,0];break;case"bottomLeft":p=!0,m=(P,B)=>[0,B],b=(P,B)=>[P,0];break;case"middleLeft":y=!0,m=(P,B)=>[0,B/2],b=(P,B)=>[P,B/2];break}const w=m(o,l),_=b(o,l);let v=d(..._);const C=Tn._round(r+v[0]),k=Tn._round(a+v[1]);let I=1,E=1,T,M;if(t.fromKeyboard)({deltaX:T,deltaY:M}=t);else{const{screenX:P,screenY:B}=t,[Z,G]=x(this,Gu);[T,M]=this.screenToPageTranslation(P-Z,B-G),x(this,Gu)[0]=P,x(this,Gu)[1]=B}if([T,M]=g(T/i,M/s),p){const P=Math.hypot(o,l);I=E=Math.max(Math.min(Math.hypot(_[0]-w[0]-T,_[1]-w[1]-M)/P,1/o,1/l),c/o,h/l)}else y?I=qr(Math.abs(_[0]-w[0]-T),c,1)/o:E=qr(Math.abs(_[1]-w[1]-M),h,1)/l;const D=Tn._round(o*I),H=Tn._round(l*E);v=d(...b(D,H));const R=C-v[0],z=k-v[1];x(this,Ra)||O(this,Ra,[this.x,this.y,this.width,this.height]),this.width=D,this.height=H,this.x=R,this.y=z,this.setDims(i*D,s*H),this.fixAndSetPosition(),this._onResizing()},NE=function(){var e;O(this,Dc,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),(e=x(this,Ni))==null||e.toggle(!1),this.parent.togglePointerEvents(!1)},OE=function(e,t,i){let r=.7*(i/t)+1-.7;if(r===1)return;const a=F(this,cn,M9).call(this,this.rotation),o=(C,k)=>[a[0]*C+a[2]*k,a[1]*C+a[3]*k],[l,c]=this.parentDimensions,h=this.x,u=this.y,d=this.width,f=this.height,g=Tn.MIN_SIZE/l,m=Tn.MIN_SIZE/c;r=Math.max(Math.min(r,1/d,1/f),g/d,m/f);const b=Tn._round(d*r),p=Tn._round(f*r);if(b===d&&p===f)return;x(this,Ra)||O(this,Ra,[h,u,d,f]);const y=o(d/2,f/2),w=Tn._round(h+y[0]),_=Tn._round(u+y[1]),v=o(b/2,p/2);this.x=w-v[0],this.y=_-v[1],this.width=b,this.height=p,this.setDims(l*b,c*p),this.fixAndSetPosition(),this._onResizing()},DE=function(){var e;(e=x(this,Ni))==null||e.toggle(!0),this.parent.togglePointerEvents(!0),F(this,cn,P9).call(this)},I8=function(e){const{isMac:t}=br.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)},FE=function(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let i=!1;const s=new AbortController,r=this._uiManager.combinedSignal(s),a={capture:!0,passive:!1,signal:r},o=c=>{s.abort(),O(this,nh,null),O(this,Vu,!1),this._uiManager.endDragSession()||F(this,cn,I8).call(this,c),i&&this._onStopDragging()};t&&(O(this,T1,e.clientX),O(this,R1,e.clientY),O(this,nh,e.pointerId),O(this,D2,e.pointerType),window.addEventListener("pointermove",c=>{i||(i=!0,this._onStartDragging());const{clientX:h,clientY:u,pointerId:d}=c;if(d!==x(this,nh)){ys(c);return}const[f,g]=this.screenToPageTranslation(h-x(this,T1),u-x(this,R1));O(this,T1,h),O(this,R1,u),this._uiManager.dragSelectedEditors(f,g)},a),window.addEventListener("touchmove",ys,a),window.addEventListener("pointerdown",c=>{c.pointerType===x(this,D2)&&(x(this,Wu)||c.isPrimary)&&o(c),ys(c)},a));const l=c=>{if(!x(this,nh)||x(this,nh)===c.pointerId){o(c);return}ys(c)};window.addEventListener("pointerup",l,{signal:r}),window.addEventListener("blur",l,{signal:r})},E8=function(){if(x(this,ih)||!this.div)return;O(this,ih,new AbortController);const e=this._uiManager.combinedSignal(x(this,ih));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})},LE=function(e){Tn._resizerKeyboardManager.exec(this,e)},BE=function(e){var t;x(this,Fc)&&((t=e.relatedTarget)==null?void 0:t.parentNode)!==x(this,ar)&&F(this,cn,Qm).call(this)},UE=function(e){O(this,F2,x(this,Fc)?e:"")},T8=function(e){if(x(this,Uo))for(const t of x(this,Uo))t.tabIndex=e},Qm=function(){O(this,Fc,!1),F(this,cn,T8).call(this,-1),F(this,cn,P9).call(this)},U(Tn,U2),Ue(Tn,"_l10n",null),Ue(Tn,"_l10nResizer",null),Ue(Tn,"_borderLineWidth",-1),Ue(Tn,"_colorManager",new p8),Ue(Tn,"_zIndex",1),Ue(Tn,"_telemetryTimeout",1e3);let Ii=Tn;class ZL extends Ii{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const Ev=3285377520,io=4294901760,_l=65535;let HE=class{constructor(e){this.h1=e?e&4294967295:Ev,this.h2=e?e&4294967295:Ev}update(e){let t,i;if(typeof e=="string"){t=new Uint8Array(e.length*2),i=0;for(let m=0,b=e.length;m<b;m++){const p=e.charCodeAt(m);p<=255?t[i++]=p:(t[i++]=p>>>8,t[i++]=p&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),i=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const s=i>>2,r=i-s*4,a=new Uint32Array(t.buffer,0,s);let o=0,l=0,c=this.h1,h=this.h2;const u=3432918353,d=461845907,f=u&_l,g=d&_l;for(let m=0;m<s;m++)m&1?(o=a[m],o=o*u&io|o*f&_l,o=o<<15|o>>>17,o=o*d&io|o*g&_l,c^=o,c=c<<13|c>>>19,c=c*5+3864292196):(l=a[m],l=l*u&io|l*f&_l,l=l<<15|l>>>17,l=l*d&io|l*g&_l,h^=l,h=h<<13|h>>>19,h=h*5+3864292196);switch(o=0,r){case 3:o^=t[s*4+2]<<16;case 2:o^=t[s*4+1]<<8;case 1:o^=t[s*4],o=o*u&io|o*f&_l,o=o<<15|o>>>17,o=o*d&io|o*g&_l,s&1?c^=o:h^=o}this.h1=c,this.h2=h}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&io|e*36045&_l,t=t*4283543511&io|((t<<16|e>>>16)*2950163797&io)>>>16,e^=t>>>1,e=e*444984403&io|e*60499&_l,t=t*3301882366&io|((t<<16|e>>>16)*3120437893&io)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}};const R8=Object.freeze({map:null,hash:"",transfer:void 0});var Ku,Xu,or,C5,zE;class y4{constructor(){U(this,C5);U(this,Ku,!1);U(this,Xu,null);U(this,or,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const i=x(this,or).get(e);return i===void 0?t:Object.assign(t,i)}getRawValue(e){return x(this,or).get(e)}remove(e){if(x(this,or).delete(e),x(this,or).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const t of x(this,or).values())if(t instanceof Ii)return;this.onAnnotationEditor(null)}}setValue(e,t){const i=x(this,or).get(e);let s=!1;if(i!==void 0)for(const[r,a]of Object.entries(t))i[r]!==a&&(s=!0,i[r]=a);else s=!0,x(this,or).set(e,t);s&&F(this,C5,zE).call(this),t instanceof Ii&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type)}has(e){return x(this,or).has(e)}get size(){return x(this,or).size}resetModified(){x(this,Ku)&&(O(this,Ku,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new jE(this)}get serializable(){if(x(this,or).size===0)return R8;const e=new Map,t=new HE,i=[],s=Object.create(null);let r=!1;for(const[a,o]of x(this,or)){const l=o instanceof Ii?o.serialize(!1,s):o;l&&(e.set(a,l),t.update(`${a}:${JSON.stringify(l)}`),r||(r=!!l.bitmap))}if(r)for(const a of e.values())a.bitmap&&i.push(a.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:i}:R8}get editorStats(){let e=null;const t=new Map;for(const i of x(this,or).values()){if(!(i instanceof Ii))continue;const s=i.telemetryFinalData;if(!s)continue;const{type:r}=s;t.has(r)||t.set(r,Object.getPrototypeOf(i).constructor),e||(e=Object.create(null));const a=e[r]||(e[r]=new Map);for(const[o,l]of Object.entries(s)){if(o==="type")continue;let c=a.get(o);c||(c=new Map,a.set(o,c));const h=c.get(l)??0;c.set(l,h+1)}}for(const[i,s]of t)e[i]=s.computeTelemetryFinalData(e[i]);return e}resetModifiedIds(){O(this,Xu,null)}get modifiedIds(){if(x(this,Xu))return x(this,Xu);const e=[];for(const t of x(this,or).values())!(t instanceof Ii)||!t.annotationElementId||!t.serialize()||e.push(t.annotationElementId);return O(this,Xu,{ids:new Set(e),hash:e.join(",")})}[Symbol.iterator](){return x(this,or).entries()}}Ku=new WeakMap,Xu=new WeakMap,or=new WeakMap,C5=new WeakSet,zE=function(){x(this,Ku)||(O(this,Ku,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var H2;class jE extends y4{constructor(t){super();U(this,H2);const{map:i,hash:s,transfer:r}=t.serializable,a=structuredClone(i,r?{transfer:r}:null);O(this,H2,{map:a,hash:s,transfer:r})}get print(){bi("Should not call PrintAnnotationStorage.print")}get serializable(){return x(this,H2)}get modifiedIds(){return zn(this,"modifiedIds",{ids:new Set,hash:""})}}H2=new WeakMap;var M1;class QL{constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){U(this,M1,new Set);this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),x(this,M1).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,disableFontFace:t,_inspectFont:i}){if(!(!e||x(this,M1).has(e.loadedName))){if(ws(!t,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:s,src:r,style:a}=e,o=new FontFace(s,r,a);this.addNativeFontFace(o);try{await o.load(),x(this,M1).add(s),i==null||i(e)}catch{vn(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(o)}return}bi("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const i=e.createNativeFontFace();if(i){this.addNativeFontFace(i);try{await i.loaded}catch(s){throw vn(`Failed to load font '${i.family}': '${s}'.`),e.disableFontFace=!0,s}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(i=>{const s=this._queueLoadingCallback(i);this._prepareFontLoadEvent(e,s)})}}get isFontLoadingAPISupported(){var t;const e=!!((t=this._document)!=null&&t.fonts);return zn(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){return zn(this,"isSyncFontLoadingSupported",Vr||br.platform.isFirefox)}_queueLoadingCallback(e){function t(){for(ws(!s.done,"completeRequest() cannot be called twice."),s.done=!0;i.length>0&&i[0].done;){const r=i.shift();setTimeout(r.callback,0)}}const{loadingRequests:i}=this,s={done:!1,complete:t,callback:e};return i.push(s),s}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return zn(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function i(_,v){return _.charCodeAt(v)<<24|_.charCodeAt(v+1)<<16|_.charCodeAt(v+2)<<8|_.charCodeAt(v+3)&255}function s(_,v,C,k){const I=_.substring(0,v),E=_.substring(v+C);return I+k+E}let r,a;const o=this._document.createElement("canvas");o.width=1,o.height=1;const l=o.getContext("2d");let c=0;function h(_,v){if(++c>30){vn("Load test font never loaded."),v();return}if(l.font="30px "+_,l.fillText(".",0,20),l.getImageData(0,0,1,1).data[3]>0){v();return}setTimeout(h.bind(null,_,v))}const u=`lt${Date.now()}${this.loadTestFontId++}`;let d=this._loadTestFont;d=s(d,976,u.length,u);const g=16,m=1482184792;let b=i(d,g);for(r=0,a=u.length-3;r<a;r+=4)b=b-m+i(u,r)|0;r<u.length&&(b=b-m+i(u+"XXX",r)|0),d=s(d,g,4,FL(b));const p=`url(data:font/opentype;base64,${btoa(d)});`,y=`@font-face {font-family:"${u}";src:${p}}`;this.insertRule(y);const w=this._document.createElement("div");w.style.visibility="hidden",w.style.width=w.style.height="10px",w.style.position="absolute",w.style.top=w.style.left="0px";for(const _ of[e.loadedName,u]){const v=this._document.createElement("span");v.textContent="Hi",v.style.fontFamily=_,w.append(v)}this._document.body.append(w),h(u,()=>{w.remove(),t.complete()})}}M1=new WeakMap;class $L{constructor(e,t=null){this.compiledGlyphs=Object.create(null);for(const i in e)this[i]=e[i];this._inspectFont=t}createNativeFontFace(){var t;if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const i={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(i.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,i)}return(t=this._inspectFont)==null||t.call(this,this),e}createFontFaceRule(){var i;if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${cE(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let s=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(s+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${s}src:${e}}`}return(i=this._inspectFont)==null||i.call(this,this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const i=this.loadedName+"_path_"+t;let s;try{s=e.get(i)}catch(a){vn(`getPathGenerator - ignoring character: "${a}".`)}const r=new Path2D(s||"");return this.fontExtraProperties||e.delete(i),this.compiledGlyphs[t]=r}}function eB(n){if(n instanceof URL)return n.href;if(typeof n=="string"){if(Vr)return n;const e=URL.parse(n,window.location);if(e)return e.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function tB(n){if(Vr&&typeof Buffer<"u"&&n instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength)return n;if(typeof n=="string")return dx(n);if(n instanceof ArrayBuffer||ArrayBuffer.isView(n)||typeof n=="object"&&!isNaN(n==null?void 0:n.length))return new Uint8Array(n);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function Ux(n){if(typeof n!="string")return null;if(n.endsWith("/"))return n;throw new Error(`Invalid factory url: "${n}" must include trailing slash.`)}const M8=n=>typeof n=="object"&&Number.isInteger(n==null?void 0:n.num)&&n.num>=0&&Number.isInteger(n==null?void 0:n.gen)&&n.gen>=0,nB=n=>typeof n=="object"&&typeof(n==null?void 0:n.name)=="string",iB=zL.bind(null,M8,nB);var Lc,A5;class sB{constructor(){U(this,Lc,new Map);U(this,A5,Promise.resolve())}postMessage(e,t){const i={data:structuredClone(e,t?{transfer:t}:null)};x(this,A5).then(()=>{for(const[s]of x(this,Lc))s.call(this,i)})}addEventListener(e,t,i=null){let s=null;if((i==null?void 0:i.signal)instanceof AbortSignal){const{signal:r}=i;if(r.aborted){vn("LoopbackPort - cannot use an `aborted` signal.");return}const a=()=>this.removeEventListener(e,t);s=()=>r.removeEventListener("abort",a),r.addEventListener("abort",a)}x(this,Lc).set(t,s)}removeEventListener(e,t){const i=x(this,Lc).get(t);i==null||i(),x(this,Lc).delete(t)}terminate(){for(const[,e]of x(this,Lc))e==null||e();x(this,Lc).clear()}}Lc=new WeakMap,A5=new WeakMap;const Hx={DATA:1,ERROR:2},gs={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function Tv(){}function aa(n){if(n instanceof Vh||n instanceof u8||n instanceof Av||n instanceof k3||n instanceof fw)return n;switch(n instanceof Error||typeof n=="object"&&n!==null||bi('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),n.name){case"AbortException":return new Vh(n.message);case"InvalidPDFException":return new u8(n.message);case"PasswordException":return new Av(n.message,n.code);case"ResponseException":return new k3(n.message,n.status,n.missing);case"UnknownErrorException":return new fw(n.message,n.details)}return new fw(n.message,n.toString())}var P1,Co,GE,VE,qE,N9,UI;let $m=(UI=class{constructor(e,t,i){U(this,Co);U(this,P1,new AbortController);this.sourceName=e,this.targetName=t,this.comObj=i,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),i.addEventListener("message",F(this,Co,GE).bind(this),{signal:x(this,P1).signal})}on(e,t){const i=this.actionHandler;if(i[e])throw new Error(`There is already an actionName called "${e}"`);i[e]=t}send(e,t,i){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},i)}sendWithPromise(e,t,i){const s=this.callbackId++,r=Promise.withResolvers();this.callbackCapabilities[s]=r;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:s,data:t},i)}catch(a){r.reject(a)}return r.promise}sendWithStream(e,t,i,s){const r=this.streamId++,a=this.sourceName,o=this.targetName,l=this.comObj;return new ReadableStream({start:c=>{const h=Promise.withResolvers();return this.streamControllers[r]={controller:c,startCall:h,pullCall:null,cancelCall:null,isClosed:!1},l.postMessage({sourceName:a,targetName:o,action:e,streamId:r,data:t,desiredSize:c.desiredSize},s),h.promise},pull:c=>{const h=Promise.withResolvers();return this.streamControllers[r].pullCall=h,l.postMessage({sourceName:a,targetName:o,stream:gs.PULL,streamId:r,desiredSize:c.desiredSize}),h.promise},cancel:c=>{ws(c instanceof Error,"cancel must have a valid reason");const h=Promise.withResolvers();return this.streamControllers[r].cancelCall=h,this.streamControllers[r].isClosed=!0,l.postMessage({sourceName:a,targetName:o,stream:gs.CANCEL,streamId:r,reason:aa(c)}),h.promise}},i)}destroy(){var e;(e=x(this,P1))==null||e.abort(),O(this,P1,null)}},P1=new WeakMap,Co=new WeakSet,GE=function({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){F(this,Co,qE).call(this,e);return}if(e.callback){const i=e.callbackId,s=this.callbackCapabilities[i];if(!s)throw new Error(`Cannot resolve callback ${i}`);if(delete this.callbackCapabilities[i],e.callback===Hx.DATA)s.resolve(e.data);else if(e.callback===Hx.ERROR)s.reject(aa(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const i=this.sourceName,s=e.sourceName,r=this.comObj;Promise.try(t,e.data).then(function(a){r.postMessage({sourceName:i,targetName:s,callback:Hx.DATA,callbackId:e.callbackId,data:a})},function(a){r.postMessage({sourceName:i,targetName:s,callback:Hx.ERROR,callbackId:e.callbackId,reason:aa(a)})});return}if(e.streamId){F(this,Co,VE).call(this,e);return}t(e.data)},VE=function(e){const t=e.streamId,i=this.sourceName,s=e.sourceName,r=this.comObj,a=this,o=this.actionHandler[e.action],l={enqueue(c,h=1,u){if(this.isCancelled)return;const d=this.desiredSize;this.desiredSize-=h,d>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),r.postMessage({sourceName:i,targetName:s,stream:gs.ENQUEUE,streamId:t,chunk:c},u)},close(){this.isCancelled||(this.isCancelled=!0,r.postMessage({sourceName:i,targetName:s,stream:gs.CLOSE,streamId:t}),delete a.streamSinks[t])},error(c){ws(c instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,r.postMessage({sourceName:i,targetName:s,stream:gs.ERROR,streamId:t,reason:aa(c)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};l.sinkCapability.resolve(),l.ready=l.sinkCapability.promise,this.streamSinks[t]=l,Promise.try(o,e.data,l).then(function(){r.postMessage({sourceName:i,targetName:s,stream:gs.START_COMPLETE,streamId:t,success:!0})},function(c){r.postMessage({sourceName:i,targetName:s,stream:gs.START_COMPLETE,streamId:t,reason:aa(c)})})},qE=function(e){const t=e.streamId,i=this.sourceName,s=e.sourceName,r=this.comObj,a=this.streamControllers[t],o=this.streamSinks[t];switch(e.stream){case gs.START_COMPLETE:e.success?a.startCall.resolve():a.startCall.reject(aa(e.reason));break;case gs.PULL_COMPLETE:e.success?a.pullCall.resolve():a.pullCall.reject(aa(e.reason));break;case gs.PULL:if(!o){r.postMessage({sourceName:i,targetName:s,stream:gs.PULL_COMPLETE,streamId:t,success:!0});break}o.desiredSize<=0&&e.desiredSize>0&&o.sinkCapability.resolve(),o.desiredSize=e.desiredSize,Promise.try(o.onPull||Tv).then(function(){r.postMessage({sourceName:i,targetName:s,stream:gs.PULL_COMPLETE,streamId:t,success:!0})},function(c){r.postMessage({sourceName:i,targetName:s,stream:gs.PULL_COMPLETE,streamId:t,reason:aa(c)})});break;case gs.ENQUEUE:if(ws(a,"enqueue should have stream controller"),a.isClosed)break;a.controller.enqueue(e.chunk);break;case gs.CLOSE:if(ws(a,"close should have stream controller"),a.isClosed)break;a.isClosed=!0,a.controller.close(),F(this,Co,N9).call(this,a,t);break;case gs.ERROR:ws(a,"error should have stream controller"),a.controller.error(aa(e.reason)),F(this,Co,N9).call(this,a,t);break;case gs.CANCEL_COMPLETE:e.success?a.cancelCall.resolve():a.cancelCall.reject(aa(e.reason)),F(this,Co,N9).call(this,a,t);break;case gs.CANCEL:if(!o)break;const l=aa(e.reason);Promise.try(o.onCancel||Tv,l).then(function(){r.postMessage({sourceName:i,targetName:s,stream:gs.CANCEL_COMPLETE,streamId:t,success:!0})},function(c){r.postMessage({sourceName:i,targetName:s,stream:gs.CANCEL_COMPLETE,streamId:t,reason:aa(c)})}),o.sinkCapability.reject(l),o.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}},N9=async function(e,t){var i,s,r;await Promise.allSettled([(i=e.startCall)==null?void 0:i.promise,(s=e.pullCall)==null?void 0:s.promise,(r=e.cancelCall)==null?void 0:r.promise]),delete this.streamControllers[t]},UI);var z2;class WE{constructor({enableHWA:e=!1}){U(this,z2,!1);O(this,z2,e)}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const i=this._createCanvas(e,t);return{canvas:i,context:i.getContext("2d",{willReadFrequently:!x(this,z2)})}}reset(e,t,i){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||i<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=i}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){bi("Abstract method `_createCanvas` called.")}}z2=new WeakMap;class rB extends WE{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const i=this._document.createElement("canvas");return i.width=e,i.height=t,i}}class KE{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(i=>({cMapData:i,isCompressed:this.isCompressed})).catch(i=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){bi("Abstract method `_fetch` called.")}}class Rv extends KE{async _fetch(e){const t=await fx(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):dx(t)}}class XE{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,i,s,r){return"none"}destroy(e=!1){}}var Yu,N1,Bc,Uc,Sr,Ju,Zu,Dt,Cr,ep,Sf,O9,If,YE,P8,Ef,tp,np,N8,ip;class aB extends XE{constructor({docId:t,ownerDocument:i=globalThis.document}){super();U(this,Dt);U(this,Yu);U(this,N1);U(this,Bc);U(this,Uc);U(this,Sr);U(this,Ju);U(this,Zu,0);O(this,Uc,t),O(this,Sr,i)}addFilter(t){if(!t)return"none";let i=x(this,Dt,Cr).get(t);if(i)return i;const[s,r,a]=F(this,Dt,O9).call(this,t),o=t.length===1?s:`${s}${r}${a}`;if(i=x(this,Dt,Cr).get(o),i)return x(this,Dt,Cr).set(t,i),i;const l=`g_${x(this,Uc)}_transfer_map_${Fr(this,Zu)._++}`,c=F(this,Dt,If).call(this,l);x(this,Dt,Cr).set(t,c),x(this,Dt,Cr).set(o,c);const h=F(this,Dt,Ef).call(this,l);return F(this,Dt,np).call(this,s,r,a,h),c}addHCMFilter(t,i){var g;const s=`${t}-${i}`,r="base";let a=x(this,Dt,ep).get(r);if((a==null?void 0:a.key)===s||(a?((g=a.filter)==null||g.remove(),a.key=s,a.url="none",a.filter=null):(a={key:s,url:"none",filter:null},x(this,Dt,ep).set(r,a)),!t||!i))return a.url;const o=F(this,Dt,ip).call(this,t);t=sn.makeHexColor(...o);const l=F(this,Dt,ip).call(this,i);if(i=sn.makeHexColor(...l),x(this,Dt,Sf).style.color="",t==="#000000"&&i==="#ffffff"||t===i)return a.url;const c=new Array(256);for(let m=0;m<=255;m++){const b=m/255;c[m]=b<=.03928?b/12.92:((b+.055)/1.055)**2.4}const h=c.join(","),u=`g_${x(this,Uc)}_hcm_filter`,d=a.filter=F(this,Dt,Ef).call(this,u);F(this,Dt,np).call(this,h,h,h,d),F(this,Dt,P8).call(this,d);const f=(m,b)=>{const p=o[m]/255,y=l[m]/255,w=new Array(b+1);for(let _=0;_<=b;_++)w[_]=p+_/b*(y-p);return w.join(",")};return F(this,Dt,np).call(this,f(0,5),f(1,5),f(2,5),d),a.url=F(this,Dt,If).call(this,u),a.url}addAlphaFilter(t){let i=x(this,Dt,Cr).get(t);if(i)return i;const[s]=F(this,Dt,O9).call(this,[t]),r=`alpha_${s}`;if(i=x(this,Dt,Cr).get(r),i)return x(this,Dt,Cr).set(t,i),i;const a=`g_${x(this,Uc)}_alpha_map_${Fr(this,Zu)._++}`,o=F(this,Dt,If).call(this,a);x(this,Dt,Cr).set(t,o),x(this,Dt,Cr).set(r,o);const l=F(this,Dt,Ef).call(this,a);return F(this,Dt,N8).call(this,s,l),o}addLuminosityFilter(t){let i=x(this,Dt,Cr).get(t||"luminosity");if(i)return i;let s,r;if(t?([s]=F(this,Dt,O9).call(this,[t]),r=`luminosity_${s}`):r="luminosity",i=x(this,Dt,Cr).get(r),i)return x(this,Dt,Cr).set(t,i),i;const a=`g_${x(this,Uc)}_luminosity_map_${Fr(this,Zu)._++}`,o=F(this,Dt,If).call(this,a);x(this,Dt,Cr).set(t,o),x(this,Dt,Cr).set(r,o);const l=F(this,Dt,Ef).call(this,a);return F(this,Dt,YE).call(this,l),t&&F(this,Dt,N8).call(this,s,l),o}addHighlightHCMFilter(t,i,s,r,a){var y;const o=`${i}-${s}-${r}-${a}`;let l=x(this,Dt,ep).get(t);if((l==null?void 0:l.key)===o||(l?((y=l.filter)==null||y.remove(),l.key=o,l.url="none",l.filter=null):(l={key:o,url:"none",filter:null},x(this,Dt,ep).set(t,l)),!i||!s))return l.url;const[c,h]=[i,s].map(F(this,Dt,ip).bind(this));let u=Math.round(.2126*c[0]+.7152*c[1]+.0722*c[2]),d=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),[f,g]=[r,a].map(F(this,Dt,ip).bind(this));d<u&&([u,d,f,g]=[d,u,g,f]),x(this,Dt,Sf).style.color="";const m=(w,_,v)=>{const C=new Array(256),k=(d-u)/v,I=w/255,E=(_-w)/(255*v);let T=0;for(let M=0;M<=v;M++){const D=Math.round(u+M*k),H=I+M*E;for(let R=T;R<=D;R++)C[R]=H;T=D+1}for(let M=T;M<256;M++)C[M]=C[T-1];return C.join(",")},b=`g_${x(this,Uc)}_hcm_${t}_filter`,p=l.filter=F(this,Dt,Ef).call(this,b);return F(this,Dt,P8).call(this,p),F(this,Dt,np).call(this,m(f[0],g[0],5),m(f[1],g[1],5),m(f[2],g[2],5),p),l.url=F(this,Dt,If).call(this,b),l.url}destroy(t=!1){var i,s,r,a;t&&((i=x(this,Ju))!=null&&i.size)||((s=x(this,Bc))==null||s.parentNode.parentNode.remove(),O(this,Bc,null),(r=x(this,N1))==null||r.clear(),O(this,N1,null),(a=x(this,Ju))==null||a.clear(),O(this,Ju,null),O(this,Zu,0))}}Yu=new WeakMap,N1=new WeakMap,Bc=new WeakMap,Uc=new WeakMap,Sr=new WeakMap,Ju=new WeakMap,Zu=new WeakMap,Dt=new WeakSet,Cr=function(){return x(this,N1)||O(this,N1,new Map)},ep=function(){return x(this,Ju)||O(this,Ju,new Map)},Sf=function(){if(!x(this,Bc)){const t=x(this,Sr).createElement("div"),{style:i}=t;i.visibility="hidden",i.contain="strict",i.width=i.height=0,i.position="absolute",i.top=i.left=0,i.zIndex=-1;const s=x(this,Sr).createElementNS(bc,"svg");s.setAttribute("width",0),s.setAttribute("height",0),O(this,Bc,x(this,Sr).createElementNS(bc,"defs")),t.append(s),s.append(x(this,Bc)),x(this,Sr).body.append(t)}return x(this,Bc)},O9=function(t){if(t.length===1){const c=t[0],h=new Array(256);for(let d=0;d<256;d++)h[d]=c[d]/255;const u=h.join(",");return[u,u,u]}const[i,s,r]=t,a=new Array(256),o=new Array(256),l=new Array(256);for(let c=0;c<256;c++)a[c]=i[c]/255,o[c]=s[c]/255,l[c]=r[c]/255;return[a.join(","),o.join(","),l.join(",")]},If=function(t){if(x(this,Yu)===void 0){O(this,Yu,"");const i=x(this,Sr).URL;i!==x(this,Sr).baseURI&&(iy(i)?vn('#createUrl: ignore "data:"-URL for performance reasons.'):O(this,Yu,aE(i,"")))}return`url(${x(this,Yu)}#${t})`},YE=function(t){const i=x(this,Sr).createElementNS(bc,"feColorMatrix");i.setAttribute("type","matrix"),i.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(i)},P8=function(t){const i=x(this,Sr).createElementNS(bc,"feColorMatrix");i.setAttribute("type","matrix"),i.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(i)},Ef=function(t){const i=x(this,Sr).createElementNS(bc,"filter");return i.setAttribute("color-interpolation-filters","sRGB"),i.setAttribute("id",t),x(this,Dt,Sf).append(i),i},tp=function(t,i,s){const r=x(this,Sr).createElementNS(bc,i);r.setAttribute("type","discrete"),r.setAttribute("tableValues",s),t.append(r)},np=function(t,i,s,r){const a=x(this,Sr).createElementNS(bc,"feComponentTransfer");r.append(a),F(this,Dt,tp).call(this,a,"feFuncR",t),F(this,Dt,tp).call(this,a,"feFuncG",i),F(this,Dt,tp).call(this,a,"feFuncB",s)},N8=function(t,i){const s=x(this,Sr).createElementNS(bc,"feComponentTransfer");i.append(s),F(this,Dt,tp).call(this,s,"feFuncA",t)},ip=function(t){return x(this,Dt,Sf).style.color=t,x4(getComputedStyle(x(this,Dt,Sf)).getPropertyValue("color"))};class JE{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(i=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){bi("Abstract method `_fetch` called.")}}class Mv extends JE{async _fetch(e){const t=await fx(e,"arraybuffer");return new Uint8Array(t)}}class ZE{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!e)throw new Error("Wasm filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(i=>{throw new Error(`Unable to load wasm data at: ${t}`)})}async _fetch(e){bi("Abstract method `_fetch` called.")}}class Pv extends ZE{async _fetch(e){const t=await fx(e,"arraybuffer");return new Uint8Array(t)}}Vr&&vn("Please use the `legacy` build in Node.js environments.");async function w4(n){const t=await process.getBuiltinModule("fs").promises.readFile(n);return new Uint8Array(t)}class oB extends XE{}class lB extends WE{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class cB extends KE{async _fetch(e){return w4(e)}}class hB extends JE{async _fetch(e){return w4(e)}}class uB extends ZE{async _fetch(e){return w4(e)}}const dr={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function O8(n,e){if(!e)return;const t=e[2]-e[0],i=e[3]-e[1],s=new Path2D;s.rect(e[0],e[1],t,i),n.clip(s)}class _4{isModifyingCurrentTransform(){return!1}getPattern(){bi("Abstract method `getPattern` called.")}}class dB extends _4{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const i of this._colorStops)t.addColorStop(i[0],i[1]);return t}getPattern(e,t,i,s){let r;if(s===dr.STROKE||s===dr.FILL){const a=t.current.getClippedPathBoundingBox(s,Yi(e))||[0,0,0,0],o=Math.ceil(a[2]-a[0])||1,l=Math.ceil(a[3]-a[1])||1,c=t.cachedCanvases.getCanvas("pattern",o,l),h=c.context;h.clearRect(0,0,h.canvas.width,h.canvas.height),h.beginPath(),h.rect(0,0,h.canvas.width,h.canvas.height),h.translate(-a[0],-a[1]),i=sn.transform(i,[1,0,0,1,a[0],a[1]]),h.transform(...t.baseTransform),this.matrix&&h.transform(...this.matrix),O8(h,this._bbox),h.fillStyle=this._createGradient(h),h.fill(),r=e.createPattern(c.canvas,"no-repeat");const u=new DOMMatrix(i);r.setTransform(u)}else O8(e,this._bbox),r=this._createGradient(e);return r}}function pw(n,e,t,i,s,r,a,o){const l=e.coords,c=e.colors,h=n.data,u=n.width*4;let d;l[t+1]>l[i+1]&&(d=t,t=i,i=d,d=r,r=a,a=d),l[i+1]>l[s+1]&&(d=i,i=s,s=d,d=a,a=o,o=d),l[t+1]>l[i+1]&&(d=t,t=i,i=d,d=r,r=a,a=d);const f=(l[t]+e.offsetX)*e.scaleX,g=(l[t+1]+e.offsetY)*e.scaleY,m=(l[i]+e.offsetX)*e.scaleX,b=(l[i+1]+e.offsetY)*e.scaleY,p=(l[s]+e.offsetX)*e.scaleX,y=(l[s+1]+e.offsetY)*e.scaleY;if(g>=y)return;const w=c[r],_=c[r+1],v=c[r+2],C=c[a],k=c[a+1],I=c[a+2],E=c[o],T=c[o+1],M=c[o+2],D=Math.round(g),H=Math.round(y);let R,z,P,B,Z,G,Y,J;for(let se=D;se<=H;se++){if(se<b){const N=se<g?0:(g-se)/(g-b);R=f-(f-m)*N,z=w-(w-C)*N,P=_-(_-k)*N,B=v-(v-I)*N}else{let N;se>y?N=1:b===y?N=0:N=(b-se)/(b-y),R=m-(m-p)*N,z=C-(C-E)*N,P=k-(k-T)*N,B=I-(I-M)*N}let fe;se<g?fe=0:se>y?fe=1:fe=(g-se)/(g-y),Z=f-(f-p)*fe,G=w-(w-E)*fe,Y=_-(_-T)*fe,J=v-(v-M)*fe;const he=Math.round(Math.min(R,Z)),de=Math.round(Math.max(R,Z));let ge=u*se+he*4;for(let N=he;N<=de;N++)fe=(R-N)/(R-Z),fe<0?fe=0:fe>1&&(fe=1),h[ge++]=z-(z-G)*fe|0,h[ge++]=P-(P-Y)*fe|0,h[ge++]=B-(B-J)*fe|0,h[ge++]=255}}function fB(n,e,t){const i=e.coords,s=e.colors;let r,a;switch(e.type){case"lattice":const o=e.verticesPerRow,l=Math.floor(i.length/o)-1,c=o-1;for(r=0;r<l;r++){let h=r*o;for(let u=0;u<c;u++,h++)pw(n,t,i[h],i[h+1],i[h+o],s[h],s[h+1],s[h+o]),pw(n,t,i[h+o+1],i[h+1],i[h+o],s[h+o+1],s[h+1],s[h+o])}break;case"triangles":for(r=0,a=i.length;r<a;r+=3)pw(n,t,i[r],i[r+1],i[r+2],s[r],s[r+1],s[r+2]);break;default:throw new Error("illegal figure")}}class gB extends _4{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[6],this._background=e[7],this.matrix=null}_createMeshCanvas(e,t,i){const o=Math.floor(this._bounds[0]),l=Math.floor(this._bounds[1]),c=Math.ceil(this._bounds[2])-o,h=Math.ceil(this._bounds[3])-l,u=Math.min(Math.ceil(Math.abs(c*e[0]*1.1)),3e3),d=Math.min(Math.ceil(Math.abs(h*e[1]*1.1)),3e3),f=c/u,g=h/d,m={coords:this._coords,colors:this._colors,offsetX:-o,offsetY:-l,scaleX:1/f,scaleY:1/g},b=u+2*2,p=d+2*2,y=i.getCanvas("mesh",b,p),w=y.context,_=w.createImageData(u,d);if(t){const C=_.data;for(let k=0,I=C.length;k<I;k+=4)C[k]=t[0],C[k+1]=t[1],C[k+2]=t[2],C[k+3]=255}for(const C of this._figures)fB(_,C,m);return w.putImageData(_,2,2),{canvas:y.canvas,offsetX:o-2*f,offsetY:l-2*g,scaleX:f,scaleY:g}}isModifyingCurrentTransform(){return!0}getPattern(e,t,i,s){O8(e,this._bbox);const r=new Float32Array(2);if(s===dr.SHADING)sn.singularValueDecompose2dScale(Yi(e),r);else if(this.matrix){sn.singularValueDecompose2dScale(this.matrix,r);const[o,l]=r;sn.singularValueDecompose2dScale(t.baseTransform,r),r[0]*=o,r[1]*=l}else sn.singularValueDecompose2dScale(t.baseTransform,r);const a=this._createMeshCanvas(r,s===dr.SHADING?null:this._background,t.cachedCanvases);return s!==dr.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(a.offsetX,a.offsetY),e.scale(a.scaleX,a.scaleY),e.createPattern(a.canvas,"no-repeat")}}class mB extends _4{getPattern(){return"hotpink"}}function pB(n){switch(n[0]){case"RadialAxial":return new dB(n);case"Mesh":return new gB(n);case"Dummy":return new mB}throw new Error(`Unknown IR type: ${n[0]}`)}const Nv={COLORED:1,UNCOLORED:2},S5=class S5{constructor(e,t,i,s){this.color=e[1],this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.ctx=t,this.canvasGraphicsFactory=i,this.baseTransform=s}createPatternCanvas(e){const{bbox:t,operatorList:i,paintType:s,tilingType:r,color:a,canvasGraphicsFactory:o}=this;let{xstep:l,ystep:c}=this;l=Math.abs(l),c=Math.abs(c),ny("TilingType: "+r);const h=t[0],u=t[1],d=t[2],f=t[3],g=d-h,m=f-u,b=new Float32Array(2);sn.singularValueDecompose2dScale(this.matrix,b);const[p,y]=b;sn.singularValueDecompose2dScale(this.baseTransform,b);const w=p*b[0],_=y*b[1];let v=g,C=m,k=!1,I=!1;const E=Math.ceil(l*w),T=Math.ceil(c*_),M=Math.ceil(g*w),D=Math.ceil(m*_);E>=M?v=l:k=!0,T>=D?C=c:I=!0;const H=this.getSizeAndScale(v,this.ctx.canvas.width,w),R=this.getSizeAndScale(C,this.ctx.canvas.height,_),z=e.cachedCanvases.getCanvas("pattern",H.size,R.size),P=z.context,B=o.createCanvasGraphics(P);if(B.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(B,s,a),P.translate(-H.scale*h,-R.scale*u),B.transform(H.scale,0,0,R.scale,0,0),P.save(),this.clipBbox(B,h,u,d,f),B.baseTransform=Yi(B.ctx),B.executeOperatorList(i),B.endDrawing(),P.restore(),k||I){const Z=z.canvas;k&&(v=l),I&&(C=c);const G=this.getSizeAndScale(v,this.ctx.canvas.width,w),Y=this.getSizeAndScale(C,this.ctx.canvas.height,_),J=G.size,se=Y.size,fe=e.cachedCanvases.getCanvas("pattern-workaround",J,se),he=fe.context,de=k?Math.floor(g/l):0,ge=I?Math.floor(m/c):0;for(let N=0;N<=de;N++)for(let K=0;K<=ge;K++)he.drawImage(Z,J*N,se*K,J,se,0,0,J,se);return{canvas:fe.canvas,scaleX:G.scale,scaleY:Y.scale,offsetX:h,offsetY:u}}return{canvas:z.canvas,scaleX:H.scale,scaleY:R.scale,offsetX:h,offsetY:u}}getSizeAndScale(e,t,i){const s=Math.max(S5.MAX_PATTERN_SIZE,t);let r=Math.ceil(e*i);return r>=s?r=s:i=r/e,{scale:i,size:r}}clipBbox(e,t,i,s,r){const a=s-t,o=r-i;e.ctx.rect(t,i,a,o),sn.axialAlignedBoundingBox([t,i,s,r],Yi(e.ctx),e.current.minMax),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,i){const s=e.ctx,r=e.current;switch(t){case Nv.COLORED:const{fillStyle:a,strokeStyle:o}=this.ctx;s.fillStyle=r.fillColor=a,s.strokeStyle=r.strokeColor=o;break;case Nv.UNCOLORED:s.fillStyle=s.strokeStyle=i,r.fillColor=r.strokeColor=i;break;default:throw new DL(`Unsupported paint type: ${t}`)}}isModifyingCurrentTransform(){return!1}getPattern(e,t,i,s){let r=i;s!==dr.SHADING&&(r=sn.transform(r,t.baseTransform),this.matrix&&(r=sn.transform(r,this.matrix)));const a=this.createPatternCanvas(t);let o=new DOMMatrix(r);o=o.translate(a.offsetX,a.offsetY),o=o.scale(1/a.scaleX,1/a.scaleY);const l=e.createPattern(a.canvas,"repeat");return l.setTransform(o),l}};Ue(S5,"MAX_PATTERN_SIZE",3e3);let D8=S5;function bB({src:n,srcPos:e=0,dest:t,width:i,height:s,nonBlackColor:r=4294967295,inverseDecode:a=!1}){const o=br.isLittleEndian?4278190080:255,[l,c]=a?[r,o]:[o,r],h=i>>3,u=i&7,d=n.length;t=new Uint32Array(t.buffer);let f=0;for(let g=0;g<s;g++){for(const b=e+h;e<b;e++){const p=e<d?n[e]:255;t[f++]=p&128?c:l,t[f++]=p&64?c:l,t[f++]=p&32?c:l,t[f++]=p&16?c:l,t[f++]=p&8?c:l,t[f++]=p&4?c:l,t[f++]=p&2?c:l,t[f++]=p&1?c:l}if(u===0)continue;const m=e<d?n[e++]:255;for(let b=0;b<u;b++)t[f++]=m&1<<7-b?c:l}return{srcPos:e,destPos:f}}const Ov=16,Dv=100,xB=15,Fv=10,fa=16,bw=new DOMMatrix,Ga=new Float32Array(2),jf=new Float32Array([1/0,1/0,-1/0,-1/0]);function yB(n,e){if(n._removeMirroring)throw new Error("Context is already forwarding operations.");n.__originalSave=n.save,n.__originalRestore=n.restore,n.__originalRotate=n.rotate,n.__originalScale=n.scale,n.__originalTranslate=n.translate,n.__originalTransform=n.transform,n.__originalSetTransform=n.setTransform,n.__originalResetTransform=n.resetTransform,n.__originalClip=n.clip,n.__originalMoveTo=n.moveTo,n.__originalLineTo=n.lineTo,n.__originalBezierCurveTo=n.bezierCurveTo,n.__originalRect=n.rect,n.__originalClosePath=n.closePath,n.__originalBeginPath=n.beginPath,n._removeMirroring=()=>{n.save=n.__originalSave,n.restore=n.__originalRestore,n.rotate=n.__originalRotate,n.scale=n.__originalScale,n.translate=n.__originalTranslate,n.transform=n.__originalTransform,n.setTransform=n.__originalSetTransform,n.resetTransform=n.__originalResetTransform,n.clip=n.__originalClip,n.moveTo=n.__originalMoveTo,n.lineTo=n.__originalLineTo,n.bezierCurveTo=n.__originalBezierCurveTo,n.rect=n.__originalRect,n.closePath=n.__originalClosePath,n.beginPath=n.__originalBeginPath,delete n._removeMirroring},n.save=function(){e.save(),this.__originalSave()},n.restore=function(){e.restore(),this.__originalRestore()},n.translate=function(t,i){e.translate(t,i),this.__originalTranslate(t,i)},n.scale=function(t,i){e.scale(t,i),this.__originalScale(t,i)},n.transform=function(t,i,s,r,a,o){e.transform(t,i,s,r,a,o),this.__originalTransform(t,i,s,r,a,o)},n.setTransform=function(t,i,s,r,a,o){e.setTransform(t,i,s,r,a,o),this.__originalSetTransform(t,i,s,r,a,o)},n.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},n.rotate=function(t){e.rotate(t),this.__originalRotate(t)},n.clip=function(t){e.clip(t),this.__originalClip(t)},n.moveTo=function(t,i){e.moveTo(t,i),this.__originalMoveTo(t,i)},n.lineTo=function(t,i){e.lineTo(t,i),this.__originalLineTo(t,i)},n.bezierCurveTo=function(t,i,s,r,a,o){e.bezierCurveTo(t,i,s,r,a,o),this.__originalBezierCurveTo(t,i,s,r,a,o)},n.rect=function(t,i,s,r){e.rect(t,i,s,r),this.__originalRect(t,i,s,r)},n.closePath=function(){e.closePath(),this.__originalClosePath()},n.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class wB{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,i){let s;return this.cache[e]!==void 0?(s=this.cache[e],this.canvasFactory.reset(s,t,i)):(s=this.canvasFactory.create(t,i),this.cache[e]=s),s}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function zx(n,e,t,i,s,r,a,o,l,c){const[h,u,d,f,g,m]=Yi(n);if(u===0&&d===0){const y=a*h+g,w=Math.round(y),_=o*f+m,v=Math.round(_),C=(a+l)*h+g,k=Math.abs(Math.round(C)-w)||1,I=(o+c)*f+m,E=Math.abs(Math.round(I)-v)||1;return n.setTransform(Math.sign(h),0,0,Math.sign(f),w,v),n.drawImage(e,t,i,s,r,0,0,k,E),n.setTransform(h,u,d,f,g,m),[k,E]}if(h===0&&f===0){const y=o*d+g,w=Math.round(y),_=a*u+m,v=Math.round(_),C=(o+c)*d+g,k=Math.abs(Math.round(C)-w)||1,I=(a+l)*u+m,E=Math.abs(Math.round(I)-v)||1;return n.setTransform(0,Math.sign(u),Math.sign(d),0,w,v),n.drawImage(e,t,i,s,r,0,0,E,k),n.setTransform(h,u,d,f,g,m),[E,k]}n.drawImage(e,t,i,s,r,a,o,l,c);const b=Math.hypot(h,u),p=Math.hypot(d,f);return[b*l,p*c]}class Lv{constructor(e,t){Ue(this,"alphaIsShape",!1);Ue(this,"fontSize",0);Ue(this,"fontSizeScale",1);Ue(this,"textMatrix",null);Ue(this,"textMatrixScale",1);Ue(this,"fontMatrix",h8);Ue(this,"leading",0);Ue(this,"x",0);Ue(this,"y",0);Ue(this,"lineX",0);Ue(this,"lineY",0);Ue(this,"charSpacing",0);Ue(this,"wordSpacing",0);Ue(this,"textHScale",1);Ue(this,"textRenderingMode",kr.FILL);Ue(this,"textRise",0);Ue(this,"fillColor","#000000");Ue(this,"strokeColor","#000000");Ue(this,"patternFill",!1);Ue(this,"patternStroke",!1);Ue(this,"fillAlpha",1);Ue(this,"strokeAlpha",1);Ue(this,"lineWidth",1);Ue(this,"activeSMask",null);Ue(this,"transferMaps","none");this.clipBox=new Float32Array([0,0,e,t]),this.minMax=jf.slice()}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e.minMax=this.minMax.slice(),e}getPathBoundingBox(e=dr.FILL,t=null){const i=this.minMax.slice();if(e===dr.STROKE){t||bi("Stroke bounding box must include transform."),sn.singularValueDecompose2dScale(t,Ga);const s=Ga[0]*this.lineWidth/2,r=Ga[1]*this.lineWidth/2;i[0]-=s,i[1]-=r,i[2]+=s,i[3]+=r}return i}updateClipFromPath(){const e=sn.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(e){this.clipBox.set(e,0),this.minMax.set(jf,0)}getClippedPathBoundingBox(e=dr.FILL,t=null){return sn.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function Bv(n,e){if(e instanceof ImageData){n.putImageData(e,0,0);return}const t=e.height,i=e.width,s=t%fa,r=(t-s)/fa,a=s===0?r:r+1,o=n.createImageData(i,fa);let l=0,c;const h=e.data,u=o.data;let d,f,g,m;if(e.kind===C9.GRAYSCALE_1BPP){const b=h.byteLength,p=new Uint32Array(u.buffer,0,u.byteLength>>2),y=p.length,w=i+7>>3,_=4294967295,v=br.isLittleEndian?4278190080:255;for(d=0;d<a;d++){for(g=d<r?fa:s,c=0,f=0;f<g;f++){const C=b-l;let k=0;const I=C>w?i:C*8-7,E=I&-8;let T=0,M=0;for(;k<E;k+=8)M=h[l++],p[c++]=M&128?_:v,p[c++]=M&64?_:v,p[c++]=M&32?_:v,p[c++]=M&16?_:v,p[c++]=M&8?_:v,p[c++]=M&4?_:v,p[c++]=M&2?_:v,p[c++]=M&1?_:v;for(;k<I;k++)T===0&&(M=h[l++],T=128),p[c++]=M&T?_:v,T>>=1}for(;c<y;)p[c++]=0;n.putImageData(o,0,d*fa)}}else if(e.kind===C9.RGBA_32BPP){for(f=0,m=i*fa*4,d=0;d<r;d++)u.set(h.subarray(l,l+m)),l+=m,n.putImageData(o,0,f),f+=fa;d<a&&(m=i*s*4,u.set(h.subarray(l,l+m)),n.putImageData(o,0,f))}else if(e.kind===C9.RGB_24BPP)for(g=fa,m=i*g,d=0;d<a;d++){for(d>=r&&(g=s,m=i*g),c=0,f=m;f--;)u[c++]=h[l++],u[c++]=h[l++],u[c++]=h[l++],u[c++]=255;n.putImageData(o,0,d*fa)}else throw new Error(`bad image kind: ${e.kind}`)}function Uv(n,e){if(e.bitmap){n.drawImage(e.bitmap,0,0);return}const t=e.height,i=e.width,s=t%fa,r=(t-s)/fa,a=s===0?r:r+1,o=n.createImageData(i,fa);let l=0;const c=e.data,h=o.data;for(let u=0;u<a;u++){const d=u<r?fa:s;({srcPos:l}=bB({src:c,srcPos:l,dest:h,width:i,height:d,nonBlackColor:0})),n.putImageData(o,0,u*fa)}}function Em(n,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const i of t)n[i]!==void 0&&(e[i]=n[i]);n.setLineDash!==void 0&&(e.setLineDash(n.getLineDash()),e.lineDashOffset=n.lineDashOffset)}function jx(n){n.strokeStyle=n.fillStyle="#000000",n.fillRule="nonzero",n.globalAlpha=1,n.lineWidth=1,n.lineCap="butt",n.lineJoin="miter",n.miterLimit=10,n.globalCompositeOperation="source-over",n.font="10px sans-serif",n.setLineDash!==void 0&&(n.setLineDash([]),n.lineDashOffset=0);const{filter:e}=n;e!=="none"&&e!==""&&(n.filter="none")}function Hv(n,e){if(e)return!0;sn.singularValueDecompose2dScale(n,Ga);const t=Math.fround(cc.pixelRatio*qh.PDF_TO_CSS_UNITS);return Ga[0]<=t&&Ga[1]<=t}const _B=["butt","round","square"],vB=["miter","round","bevel"],kB={},zv={};var dl,F8,L8,B8;const $_=class $_{constructor(e,t,i,s,r,{optionalContentConfig:a,markedContentStack:o=null},l,c){U(this,dl);this.ctx=e,this.current=new Lv(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=i,this.canvasFactory=s,this.filterFactory=r,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=o||[],this.optionalContentConfig=a,this.cachedCanvases=new wB(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=l,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=c,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(e,t=null){return typeof e=="string"?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):t}beginDrawing({transform:e,viewport:t,transparency:i=!1,background:s=null}){const r=this.ctx.canvas.width,a=this.ctx.canvas.height,o=this.ctx.fillStyle;if(this.ctx.fillStyle=s||"#ffffff",this.ctx.fillRect(0,0,r,a),this.ctx.fillStyle=o,i){const l=this.cachedCanvases.getCanvas("transparent",r,a);this.compositeCtx=this.ctx,this.transparentCanvas=l.canvas,this.ctx=l.context,this.ctx.save(),this.ctx.transform(...Yi(this.compositeCtx))}this.ctx.save(),jx(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=Yi(this.ctx)}executeOperatorList(e,t,i,s){const r=e.argsArray,a=e.fnArray;let o=t||0;const l=r.length;if(l===o)return o;const c=l-o>Fv&&typeof i=="function",h=c?Date.now()+xB:0;let u=0;const d=this.commonObjs,f=this.objs;let g;for(;;){if(s!==void 0&&o===s.nextBreakPoint)return s.breakIt(o,i),o;if(g=a[o],g!==v3.dependency)this[g].apply(this,r[o]);else for(const m of r[o]){const b=m.startsWith("g_")?d:f;if(!b.has(m))return b.get(m,i),o}if(o++,o===l)return o;if(c&&++u>Fv){if(Date.now()>h)return i(),o;u=0}}}endDrawing(){F(this,dl,F8).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),F(this,dl,L8).call(this)}_scaleImage(e,t){const i=e.width??e.displayWidth,s=e.height??e.displayHeight;let r=Math.max(Math.hypot(t[0],t[1]),1),a=Math.max(Math.hypot(t[2],t[3]),1),o=i,l=s,c="prescale1",h,u;for(;r>2&&o>1||a>2&&l>1;){let d=o,f=l;r>2&&o>1&&(d=o>=16384?Math.floor(o/2)-1||1:Math.ceil(o/2),r/=o/d),a>2&&l>1&&(f=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l)/2,a/=l/f),h=this.cachedCanvases.getCanvas(c,d,f),u=h.context,u.clearRect(0,0,d,f),u.drawImage(e,0,0,o,l,0,0,d,f),e=h.canvas,o=d,l=f,c=c==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:o,paintHeight:l}}_createMaskCanvas(e){const t=this.ctx,{width:i,height:s}=e,r=this.current.fillColor,a=this.current.patternFill,o=Yi(t);let l,c,h,u;if((e.bitmap||e.data)&&e.count>1){const E=e.bitmap||e.data.buffer;c=JSON.stringify(a?o:[o.slice(0,4),r]),l=this._cachedBitmapsMap.get(E),l||(l=new Map,this._cachedBitmapsMap.set(E,l));const T=l.get(c);if(T&&!a){const M=Math.round(Math.min(o[0],o[2])+o[4]),D=Math.round(Math.min(o[1],o[3])+o[5]);return{canvas:T,offsetX:M,offsetY:D}}h=T}h||(u=this.cachedCanvases.getCanvas("maskCanvas",i,s),Uv(u.context,e));let d=sn.transform(o,[1/i,0,0,-1/s,0,0]);d=sn.transform(d,[1,0,0,1,0,-s]);const f=jf.slice();sn.axialAlignedBoundingBox([0,0,i,s],d,f);const[g,m,b,p]=f,y=Math.round(b-g)||1,w=Math.round(p-m)||1,_=this.cachedCanvases.getCanvas("fillCanvas",y,w),v=_.context,C=g,k=m;v.translate(-C,-k),v.transform(...d),h||(h=this._scaleImage(u.canvas,wl(v)),h=h.img,l&&a&&l.set(c,h)),v.imageSmoothingEnabled=Hv(Yi(v),e.interpolate),zx(v,h,0,0,h.width,h.height,0,0,i,s),v.globalCompositeOperation="source-in";const I=sn.transform(wl(v),[1,0,0,1,-C,-k]);return v.fillStyle=a?r.getPattern(t,this,I,dr.FILL):r,v.fillRect(0,0,i,s),l&&!a&&(this.cachedCanvases.delete("fillCanvas"),l.set(c,_.canvas)),{canvas:_.canvas,offsetX:Math.round(C),offsetY:Math.round(k)}}setLineWidth(e){e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(e){this.ctx.lineCap=_B[e]}setLineJoin(e){this.ctx.lineJoin=vB[e]}setMiterLimit(e){this.ctx.miterLimit=e}setDash(e,t){const i=this.ctx;i.setLineDash!==void 0&&(i.setLineDash(e),i.lineDashOffset=t)}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[t,i]of e)switch(t){case"LW":this.setLineWidth(i);break;case"LC":this.setLineCap(i);break;case"LJ":this.setLineJoin(i);break;case"ML":this.setMiterLimit(i);break;case"D":this.setDash(i[0],i[1]);break;case"RI":this.setRenderingIntent(i);break;case"FL":this.setFlatness(i);break;case"Font":this.setFont(i[0],i[1]);break;case"CA":this.current.strokeAlpha=i;break;case"ca":this.ctx.globalAlpha=this.current.fillAlpha=i;break;case"BM":this.ctx.globalCompositeOperation=i;break;case"SMask":this.current.activeSMask=i?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(i);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,t=this.ctx.canvas.height,i="smaskGroupAt"+this.groupLevel,s=this.cachedCanvases.getCanvas(i,e,t);this.suspendedCtx=this.ctx;const r=this.ctx=s.context;r.setTransform(this.suspendedCtx.getTransform()),Em(this.suspendedCtx,r),yB(r,this.suspendedCtx),this.setGState([["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Em(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,i=this.suspendedCtx;this.composeSMask(i,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,i,s){const r=s[0],a=s[1],o=s[2]-r,l=s[3]-a;o===0||l===0||(this.genericComposeSMask(t.context,i,o,l,t.subtype,t.backdrop,t.transferMap,r,a,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(i.canvas,0,0),e.restore())}genericComposeSMask(e,t,i,s,r,a,o,l,c,h,u){let d=e.canvas,f=l-h,g=c-u;if(a)if(f<0||g<0||f+i>d.width||g+s>d.height){const b=this.cachedCanvases.getCanvas("maskExtension",i,s),p=b.context;p.drawImage(d,-f,-g),p.globalCompositeOperation="destination-atop",p.fillStyle=a,p.fillRect(0,0,i,s),p.globalCompositeOperation="source-over",d=b.canvas,f=g=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const b=new Path2D;b.rect(f,g,i,s),e.clip(b),e.globalCompositeOperation="destination-atop",e.fillStyle=a,e.fillRect(f,g,i,s),e.restore()}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),r==="Alpha"&&o?t.filter=this.filterFactory.addAlphaFilter(o):r==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(o));const m=new Path2D;m.rect(l,c,i,s),t.clip(m),t.globalCompositeOperation="destination-in",t.drawImage(d,f,g,i,s,l,c,i,s),t.restore()}save(){this.inSMaskMode&&Em(this.ctx,this.suspendedCtx),this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone()}restore(){if(this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&Em(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(e,t,i,s,r,a){this.ctx.transform(e,t,i,s,r,a),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,i){let[s]=t;if(!i){s||(s=t[0]=new Path2D),this[e](s);return}if(!(s instanceof Path2D)){const r=t[0]=new Path2D;for(let a=0,o=s.length;a<o;)switch(s[a++]){case Bx.moveTo:r.moveTo(s[a++],s[a++]);break;case Bx.lineTo:r.lineTo(s[a++],s[a++]);break;case Bx.curveTo:r.bezierCurveTo(s[a++],s[a++],s[a++],s[a++],s[a++],s[a++]);break;case Bx.closePath:r.closePath();break;default:vn(`Unrecognized drawing path operator: ${s[a-1]}`);break}s=r}sn.axialAlignedBoundingBox(i,Yi(this.ctx),this.current.minMax),this[e](s)}closePath(){this.ctx.closePath()}stroke(e,t=!0){const i=this.ctx,s=this.current.strokeColor;if(i.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof s=="object"&&(s!=null&&s.getPattern)){const r=s.isModifyingCurrentTransform()?i.getTransform():null;if(i.save(),i.strokeStyle=s.getPattern(i,this,wl(i),dr.STROKE),r){const a=new Path2D;a.addPath(e,i.getTransform().invertSelf().multiplySelf(r)),e=a}this.rescaleAndStroke(e,!1),i.restore()}else this.rescaleAndStroke(e,!0);t&&this.consumePath(e,this.current.getClippedPathBoundingBox(dr.STROKE,Yi(this.ctx))),i.globalAlpha=this.current.fillAlpha}closeStroke(e){this.stroke(e)}fill(e,t=!0){const i=this.ctx,s=this.current.fillColor,r=this.current.patternFill;let a=!1;if(r){const l=s.isModifyingCurrentTransform()?i.getTransform():null;if(i.save(),i.fillStyle=s.getPattern(i,this,wl(i),dr.FILL),l){const c=new Path2D;c.addPath(e,i.getTransform().invertSelf().multiplySelf(l)),e=c}a=!0}const o=this.current.getClippedPathBoundingBox();this.contentVisible&&o!==null&&(this.pendingEOFill?(i.fill(e,"evenodd"),this.pendingEOFill=!1):i.fill(e)),a&&i.restore(),t&&this.consumePath(e,o)}eoFill(e){this.pendingEOFill=!0,this.fill(e)}fillStroke(e){this.fill(e,!1),this.stroke(e,!1),this.consumePath(e)}eoFillStroke(e){this.pendingEOFill=!0,this.fillStroke(e)}closeFillStroke(e){this.fillStroke(e)}closeEOFillStroke(e){this.pendingEOFill=!0,this.fillStroke(e)}endPath(e){this.consumePath(e)}rawFillPath(e){this.ctx.fill(e)}clip(){this.pendingClip=kB}eoClip(){this.pendingClip=zv}beginText(){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const e=this.pendingTextPaths,t=this.ctx;if(e===void 0)return;const i=new Path2D,s=t.getTransform().invertSelf();for(const{transform:r,x:a,y:o,fontSize:l,path:c}of e)i.addPath(c,new DOMMatrix(r).preMultiplySelf(s).translate(a,o).scale(l,-l));t.clip(i),delete this.pendingTextPaths}setCharSpacing(e){this.current.charSpacing=e}setWordSpacing(e){this.current.wordSpacing=e}setHScale(e){this.current.textHScale=e/100}setLeading(e){this.current.leading=-e}setFont(e,t){var h;const i=this.commonObjs.get(e),s=this.current;if(!i)throw new Error(`Can't find font for ${e}`);if(s.fontMatrix=i.fontMatrix||h8,(s.fontMatrix[0]===0||s.fontMatrix[3]===0)&&vn("Invalid font matrix for font "+e),t<0?(t=-t,s.fontDirection=-1):s.fontDirection=1,this.current.font=i,this.current.fontSize=t,i.isType3Font)return;const r=i.loadedName||"sans-serif",a=((h=i.systemFontInfo)==null?void 0:h.css)||`"${r}", ${i.fallbackName}`;let o="normal";i.black?o="900":i.bold&&(o="bold");const l=i.italic?"italic":"normal";let c=t;t<Ov?c=Ov:t>Dv&&(c=Dv),this.current.fontSizeScale=t/c,this.ctx.font=`${l} ${o} ${c}px ${a}`}setTextRenderingMode(e){this.current.textRenderingMode=e}setTextRise(e){this.current.textRise=e}moveText(e,t){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t}setLeadingMoveText(e,t){this.setLeading(-t),this.moveText(e,t)}setTextMatrix(e){const{current:t}=this;t.textMatrix=e,t.textMatrixScale=Math.hypot(e[0],e[1]),t.x=t.lineX=0,t.y=t.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(e,t,i,s,r){const a=this.ctx,o=this.current,l=o.font,c=o.textRenderingMode,h=o.fontSize/o.fontSizeScale,u=c&kr.FILL_STROKE_MASK,d=!!(c&kr.ADD_TO_PATH_FLAG),f=o.patternFill&&!l.missingFile,g=o.patternStroke&&!l.missingFile;let m;if((l.disableFontFace||d||f||g)&&(m=l.getPathGenerator(this.commonObjs,e)),l.disableFontFace||f||g){a.save(),a.translate(t,i),a.scale(h,-h);let b;if((u===kr.FILL||u===kr.FILL_STROKE)&&(s?(b=a.getTransform(),a.setTransform(...s),a.fill(F(this,dl,B8).call(this,m,b,s))):a.fill(m)),u===kr.STROKE||u===kr.FILL_STROKE)if(r){b||(b=a.getTransform()),a.setTransform(...r);const{a:p,b:y,c:w,d:_}=b,v=sn.inverseTransform(r),C=sn.transform([p,y,w,_,0,0],v);sn.singularValueDecompose2dScale(C,Ga),a.lineWidth*=Math.max(Ga[0],Ga[1])/h,a.stroke(F(this,dl,B8).call(this,m,b,r))}else a.lineWidth/=h,a.stroke(m);a.restore()}else(u===kr.FILL||u===kr.FILL_STROKE)&&a.fillText(e,t,i),(u===kr.STROKE||u===kr.FILL_STROKE)&&a.strokeText(e,t,i);d&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:Yi(a),x:t,y:i,fontSize:h,path:m})}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let i=!1;for(let s=3;s<t.length;s+=4)if(t[s]>0&&t[s]<255){i=!0;break}return zn(this,"isFontSubpixelAAEnabled",i)}showText(e){const t=this.current,i=t.font;if(i.isType3Font)return this.showType3Text(e);const s=t.fontSize;if(s===0)return;const r=this.ctx,a=t.fontSizeScale,o=t.charSpacing,l=t.wordSpacing,c=t.fontDirection,h=t.textHScale*c,u=e.length,d=i.vertical,f=d?1:-1,g=i.defaultVMetrics,m=s*t.fontMatrix[0],b=t.textRenderingMode===kr.FILL&&!i.disableFontFace&&!t.patternFill;r.save(),t.textMatrix&&r.transform(...t.textMatrix),r.translate(t.x,t.y+t.textRise),c>0?r.scale(h,-1):r.scale(h,1);let p,y;if(t.patternFill){r.save();const k=t.fillColor.getPattern(r,this,wl(r),dr.FILL);p=Yi(r),r.restore(),r.fillStyle=k}if(t.patternStroke){r.save();const k=t.strokeColor.getPattern(r,this,wl(r),dr.STROKE);y=Yi(r),r.restore(),r.strokeStyle=k}let w=t.lineWidth;const _=t.textMatrixScale;if(_===0||w===0){const k=t.textRenderingMode&kr.FILL_STROKE_MASK;(k===kr.STROKE||k===kr.FILL_STROKE)&&(w=this.getSinglePixelWidth())}else w/=_;if(a!==1&&(r.scale(a,a),w/=a),r.lineWidth=w,i.isInvalidPDFjsFont){const k=[];let I=0;for(const E of e)k.push(E.unicode),I+=E.width;r.fillText(k.join(""),0,0),t.x+=I*m*h,r.restore(),this.compose();return}let v=0,C;for(C=0;C<u;++C){const k=e[C];if(typeof k=="number"){v+=f*k*s/1e3;continue}let I=!1;const E=(k.isSpace?l:0)+o,T=k.fontChar,M=k.accent;let D,H,R=k.width;if(d){const P=k.vmetric||g,B=-(k.vmetric?P[1]:R*.5)*m,Z=P[2]*m;R=P?-P[0]:R,D=B/a,H=(v+Z)/a}else D=v/a,H=0;if(i.remeasure&&R>0){const P=r.measureText(T).width*1e3/s*a;if(R<P&&this.isFontSubpixelAAEnabled){const B=R/P;I=!0,r.save(),r.scale(B,1),D/=B}else R!==P&&(D+=(R-P)/2e3*s/a)}if(this.contentVisible&&(k.isInFont||i.missingFile)){if(b&&!M)r.fillText(T,D,H);else if(this.paintChar(T,D,H,p,y),M){const P=D+s*M.offset.x/a,B=H-s*M.offset.y/a;this.paintChar(M.fontChar,P,B,p,y)}}const z=d?R*m-E*c:R*m+E*c;v+=z,I&&r.restore()}d?t.y-=v:t.x+=v*h,r.restore(),this.compose()}showType3Text(e){const t=this.ctx,i=this.current,s=i.font,r=i.fontSize,a=i.fontDirection,o=s.vertical?1:-1,l=i.charSpacing,c=i.wordSpacing,h=i.textHScale*a,u=i.fontMatrix||h8,d=e.length,f=i.textRenderingMode===kr.INVISIBLE;let g,m,b,p;if(!(f||r===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,t.save(),i.textMatrix&&t.transform(...i.textMatrix),t.translate(i.x,i.y+i.textRise),t.scale(h,a),g=0;g<d;++g){if(m=e[g],typeof m=="number"){p=o*m*r/1e3,this.ctx.translate(p,0),i.x+=p*h;continue}const y=(m.isSpace?c:0)+l,w=s.charProcOperatorList[m.operatorListId];w?this.contentVisible&&(this.save(),t.scale(r,r),t.transform(...u),this.executeOperatorList(w),this.restore()):vn(`Type3 character "${m.operatorListId}" is not available.`);const _=[m.width,0];sn.applyTransform(_,u),b=_[0]*r+y,t.translate(b,0),i.x+=b*h}t.restore()}}setCharWidth(e,t){}setCharWidthAndBounds(e,t,i,s,r,a){const o=new Path2D;o.rect(i,s,r-i,a-s),this.ctx.clip(o),this.endPath()}getColorN_Pattern(e){let t;if(e[0]==="TilingPattern"){const i=this.baseTransform||Yi(this.ctx),s={createCanvasGraphics:r=>new $_(r,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};t=new D8(e,this.ctx,s,i)}else t=this._getPattern(e[1],e[2]);return t}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(e){this.ctx.strokeStyle=this.current.strokeColor=e,this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e){this.ctx.fillStyle=this.current.fillColor=e,this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t=null){let i;return this.cachedPatterns.has(e)?i=this.cachedPatterns.get(e):(i=pB(this.getObject(e)),this.cachedPatterns.set(e,i)),t&&(i.matrix=t),i}shadingFill(e){if(!this.contentVisible)return;const t=this.ctx;this.save();const i=this._getPattern(e);t.fillStyle=i.getPattern(t,this,wl(t),dr.SHADING);const s=wl(t);if(s){const{width:r,height:a}=t.canvas,o=jf.slice();sn.axialAlignedBoundingBox([0,0,r,a],s,o);const[l,c,h,u]=o;this.ctx.fillRect(l,c,h-l,u-c)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){bi("Should not call beginInlineImage")}beginImageData(){bi("Should not call beginImageData")}paintFormXObjectBegin(e,t){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),e&&this.transform(...e),this.baseTransform=Yi(this.ctx),t)){sn.axialAlignedBoundingBox(t,this.baseTransform,this.current.minMax);const[i,s,r,a]=t,o=new Path2D;o.rect(i,s,r-i,a-s),this.ctx.clip(o),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const t=this.ctx;e.isolated||ny("TODO: Support non-isolated groups."),e.knockout&&vn("Knockout groups not supported.");const i=Yi(t);if(e.matrix&&t.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let s=jf.slice();sn.axialAlignedBoundingBox(e.bbox,Yi(t),s);const r=[0,0,t.canvas.width,t.canvas.height];s=sn.intersect(s,r)||[0,0,0,0];const a=Math.floor(s[0]),o=Math.floor(s[1]),l=Math.max(Math.ceil(s[2])-a,1),c=Math.max(Math.ceil(s[3])-o,1);this.current.startNewPathAndClipBox([0,0,l,c]);let h="groupAt"+this.groupLevel;e.smask&&(h+="_smask_"+this.smaskCounter++%2);const u=this.cachedCanvases.getCanvas(h,l,c),d=u.context;d.translate(-a,-o),d.transform(...i);let f=new Path2D;const[g,m,b,p]=e.bbox;if(f.rect(g,m,b-g,p-m),e.matrix){const y=new Path2D;y.addPath(f,new DOMMatrix(e.matrix)),f=y}d.clip(f),e.smask?this.smaskStack.push({canvas:u.canvas,context:d,offsetX:a,offsetY:o,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(t.setTransform(1,0,0,1,0,0),t.translate(a,o),t.save()),Em(t,d),this.ctx=d,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++}endGroup(e){if(!this.contentVisible)return;this.groupLevel--;const t=this.ctx,i=this.groupStack.pop();if(this.ctx=i,this.ctx.imageSmoothingEnabled=!1,e.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const s=Yi(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...s);const r=jf.slice();sn.axialAlignedBoundingBox([0,0,t.canvas.width,t.canvas.height],s,r),this.ctx.drawImage(t.canvas,0,0),this.ctx.restore(),this.compose(r)}}beginAnnotation(e,t,i,s,r){if(F(this,dl,F8).call(this),jx(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),t){const a=t[2]-t[0],o=t[3]-t[1];if(r&&this.annotationCanvasMap){i=i.slice(),i[4]-=t[0],i[5]-=t[1],t=t.slice(),t[0]=t[1]=0,t[2]=a,t[3]=o,sn.singularValueDecompose2dScale(Yi(this.ctx),Ga);const{viewportScale:l}=this,c=Math.ceil(a*this.outputScaleX*l),h=Math.ceil(o*this.outputScaleY*l);this.annotationCanvas=this.canvasFactory.create(c,h);const{canvas:u,context:d}=this.annotationCanvas;this.annotationCanvasMap.set(e,u),this.annotationCanvas.savedCtx=this.ctx,this.ctx=d,this.ctx.save(),this.ctx.setTransform(Ga[0],0,0,-Ga[1],0,o*Ga[1]),jx(this.ctx)}else{jx(this.ctx),this.endPath();const l=new Path2D;l.rect(t[0],t[1],a,o),this.ctx.clip(l)}}this.current=new Lv(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...i),this.transform(...s)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),F(this,dl,L8).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e){if(!this.contentVisible)return;const t=e.count;e=this.getObject(e.data,e),e.count=t;const i=this.ctx,s=this._createMaskCanvas(e),r=s.canvas;i.save(),i.setTransform(1,0,0,1,0,0),i.drawImage(r,s.offsetX,s.offsetY),i.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,i=0,s=0,r,a){if(!this.contentVisible)return;e=this.getObject(e.data,e);const o=this.ctx;o.save();const l=Yi(o);o.transform(t,i,s,r,0,0);const c=this._createMaskCanvas(e);o.setTransform(1,0,0,1,c.offsetX-l[4],c.offsetY-l[5]);for(let h=0,u=a.length;h<u;h+=2){const d=sn.transform(l,[t,i,s,r,a[h],a[h+1]]);o.drawImage(c.canvas,d[4],d[5])}o.restore(),this.compose()}paintImageMaskXObjectGroup(e){if(!this.contentVisible)return;const t=this.ctx,i=this.current.fillColor,s=this.current.patternFill;for(const r of e){const{data:a,width:o,height:l,transform:c}=r,h=this.cachedCanvases.getCanvas("maskCanvas",o,l),u=h.context;u.save();const d=this.getObject(a,r);Uv(u,d),u.globalCompositeOperation="source-in",u.fillStyle=s?i.getPattern(u,this,wl(t),dr.FILL):i,u.fillRect(0,0,o,l),u.restore(),t.save(),t.transform(...c),t.scale(1,-1),zx(t,h.canvas,0,0,o,l,0,-1,1,1),t.restore()}this.compose()}paintImageXObject(e){if(!this.contentVisible)return;const t=this.getObject(e);if(!t){vn("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t)}paintImageXObjectRepeat(e,t,i,s){if(!this.contentVisible)return;const r=this.getObject(e);if(!r){vn("Dependent image isn't ready yet");return}const a=r.width,o=r.height,l=[];for(let c=0,h=s.length;c<h;c+=2)l.push({transform:[t,0,0,i,s[c],s[c+1]],x:0,y:0,w:a,h:o});this.paintInlineImageXObjectGroup(r,l)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:i,height:s}=e,r=this.cachedCanvases.getCanvas("inlineImage",i,s),a=r.context;return a.filter=this.current.transferMaps,a.drawImage(t,0,0),a.filter="none",r.canvas}paintInlineImageXObject(e){if(!this.contentVisible)return;const t=e.width,i=e.height,s=this.ctx;this.save();const{filter:r}=s;r!=="none"&&r!==""&&(s.filter="none"),s.scale(1/t,-1/i);let a;if(e.bitmap)a=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)a=e;else{const c=this.cachedCanvases.getCanvas("inlineImage",t,i).context;Bv(c,e),a=this.applyTransferMapsToCanvas(c)}const o=this._scaleImage(a,wl(s));s.imageSmoothingEnabled=Hv(Yi(s),e.interpolate),zx(s,o.img,0,0,o.paintWidth,o.paintHeight,0,-i,t,i),this.compose(),this.restore()}paintInlineImageXObjectGroup(e,t){if(!this.contentVisible)return;const i=this.ctx;let s;if(e.bitmap)s=e.bitmap;else{const r=e.width,a=e.height,l=this.cachedCanvases.getCanvas("inlineImage",r,a).context;Bv(l,e),s=this.applyTransferMapsToCanvas(l)}for(const r of t)i.save(),i.transform(...r.transform),i.scale(1,-1),zx(i,s,r.x,r.y,r.w,r.h,0,-1,1,1),i.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e){}markPointProps(e,t){}beginMarkedContent(e){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t){e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(t)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(e,t){const i=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(t);const s=this.ctx;this.pendingClip&&(i||(this.pendingClip===zv?s.clip(e,"evenodd"):s.clip(e)),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=Yi(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),i=Math.hypot(e[0],e[2]),s=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(i,s)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:i,c:s,d:r}=this.ctx.getTransform();let a,o;if(i===0&&s===0){const l=Math.abs(t),c=Math.abs(r);if(l===c)if(e===0)a=o=1/l;else{const h=l*e;a=o=h<1?1/h:1}else if(e===0)a=1/l,o=1/c;else{const h=l*e,u=c*e;a=h<1?1/h:1,o=u<1?1/u:1}}else{const l=Math.abs(t*r-i*s),c=Math.hypot(t,i),h=Math.hypot(s,r);if(e===0)a=h/l,o=c/l;else{const u=e*l;a=h>u?h/u:1,o=c>u?c/u:1}}this._cachedScaleForStroking[0]=a,this._cachedScaleForStroking[1]=o}return this._cachedScaleForStroking}rescaleAndStroke(e,t){const{ctx:i,current:{lineWidth:s}}=this,[r,a]=this.getScaleForStroking();if(r===a){i.lineWidth=(s||1)*r,i.stroke(e);return}const o=i.getLineDash();t&&i.save(),i.scale(r,a),bw.a=1/r,bw.d=1/a;const l=new Path2D;if(l.addPath(e,bw),o.length>0){const c=Math.max(r,a);i.setLineDash(o.map(h=>h/c)),i.lineDashOffset/=c}i.lineWidth=s||1,i.stroke(l),t&&i.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}};dl=new WeakSet,F8=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},L8=function(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}},B8=function(e,t,i){const s=new Path2D;return s.addPath(e,new DOMMatrix(i).invertSelf().multiplySelf(t)),s};let r1=$_;for(const n in v3)r1.prototype[n]!==void 0&&(r1.prototype[v3[n]]=r1.prototype[n]);var j2,G2;class Ql{static get workerPort(){return x(this,j2)}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");O(this,j2,e)}static get workerSrc(){return x(this,G2)}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");O(this,G2,e)}}j2=new WeakMap,G2=new WeakMap,U(Ql,j2,null),U(Ql,G2,"");var O1,V2;class CB{constructor({parsedData:e,rawData:t}){U(this,O1);U(this,V2);O(this,O1,e),O(this,V2,t)}getRaw(){return x(this,V2)}get(e){return x(this,O1).get(e)??null}[Symbol.iterator](){return x(this,O1).entries()}}O1=new WeakMap,V2=new WeakMap;const Tf=Symbol("INTERNAL");var q2,W2,K2,D1;class AB{constructor(e,{name:t,intent:i,usage:s,rbGroups:r}){U(this,q2,!1);U(this,W2,!1);U(this,K2,!1);U(this,D1,!0);O(this,q2,!!(e&ja.DISPLAY)),O(this,W2,!!(e&ja.PRINT)),this.name=t,this.intent=i,this.usage=s,this.rbGroups=r}get visible(){if(x(this,K2))return x(this,D1);if(!x(this,D1))return!1;const{print:e,view:t}=this.usage;return x(this,q2)?(t==null?void 0:t.viewState)!=="OFF":x(this,W2)?(e==null?void 0:e.printState)!=="OFF":!0}_setVisible(e,t,i=!1){e!==Tf&&bi("Internal method `_setVisible` called."),O(this,K2,i),O(this,D1,t)}}q2=new WeakMap,W2=new WeakMap,K2=new WeakMap,D1=new WeakMap;var sh,gi,F1,L1,X2,U8;class SB{constructor(e,t=ja.DISPLAY){U(this,X2);U(this,sh,null);U(this,gi,new Map);U(this,F1,null);U(this,L1,null);if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,O(this,L1,e.order);for(const i of e.groups)x(this,gi).set(i.id,new AB(t,i));if(e.baseState==="OFF")for(const i of x(this,gi).values())i._setVisible(Tf,!1);for(const i of e.on)x(this,gi).get(i)._setVisible(Tf,!0);for(const i of e.off)x(this,gi).get(i)._setVisible(Tf,!1);O(this,F1,this.getHash())}}isVisible(e){if(x(this,gi).size===0)return!0;if(!e)return ny("Optional content group not defined."),!0;if(e.type==="OCG")return x(this,gi).has(e.id)?x(this,gi).get(e.id).visible:(vn(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return F(this,X2,U8).call(this,e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!x(this,gi).has(t))return vn(`Optional content group not found: ${t}`),!0;if(x(this,gi).get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!x(this,gi).has(t))return vn(`Optional content group not found: ${t}`),!0;if(!x(this,gi).get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!x(this,gi).has(t))return vn(`Optional content group not found: ${t}`),!0;if(!x(this,gi).get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!x(this,gi).has(t))return vn(`Optional content group not found: ${t}`),!0;if(x(this,gi).get(t).visible)return!1}return!0}return vn(`Unknown optional content policy ${e.policy}.`),!0}return vn(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,i=!0){var r;const s=x(this,gi).get(e);if(!s){vn(`Optional content group not found: ${e}`);return}if(i&&t&&s.rbGroups.length)for(const a of s.rbGroups)for(const o of a)o!==e&&((r=x(this,gi).get(o))==null||r._setVisible(Tf,!1,!0));s._setVisible(Tf,!!t,!0),O(this,sh,null)}setOCGState({state:e,preserveRB:t}){let i;for(const s of e){switch(s){case"ON":case"OFF":case"Toggle":i=s;continue}const r=x(this,gi).get(s);if(r)switch(i){case"ON":this.setVisibility(s,!0,t);break;case"OFF":this.setVisibility(s,!1,t);break;case"Toggle":this.setVisibility(s,!r.visible,t);break}}O(this,sh,null)}get hasInitialVisibility(){return x(this,F1)===null||this.getHash()===x(this,F1)}getOrder(){return x(this,gi).size?x(this,L1)?x(this,L1).slice():[...x(this,gi).keys()]:null}getGroup(e){return x(this,gi).get(e)||null}getHash(){if(x(this,sh)!==null)return x(this,sh);const e=new HE;for(const[t,i]of x(this,gi))e.update(`${t}:${i.visible}`);return O(this,sh,e.hexdigest())}[Symbol.iterator](){return x(this,gi).entries()}}sh=new WeakMap,gi=new WeakMap,F1=new WeakMap,L1=new WeakMap,X2=new WeakSet,U8=function(e){const t=e.length;if(t<2)return!0;const i=e[0];for(let s=1;s<t;s++){const r=e[s];let a;if(Array.isArray(r))a=F(this,X2,U8).call(this,r);else if(x(this,gi).has(r))a=x(this,gi).get(r).visible;else return vn(`Optional content group not found: ${r}`),!0;switch(i){case"And":if(!a)return!1;break;case"Or":if(a)return!0;break;case"Not":return!a;default:return!0}}return i==="And"};class IB{constructor(e,{disableRange:t=!1,disableStream:i=!1}){ws(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:s,initialData:r,progressiveDone:a,contentDispositionFilename:o}=e;if(this._queuedChunks=[],this._progressiveDone=a,this._contentDispositionFilename=o,(r==null?void 0:r.length)>0){const l=r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength?r.buffer:new Uint8Array(r).buffer;this._queuedChunks.push(l)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!i,this._isRangeSupported=!t,this._contentLength=s,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((l,c)=>{this._onReceiveData({begin:l,chunk:c})}),e.addProgressListener((l,c)=>{this._onProgress({loaded:l,total:c})}),e.addProgressiveReadListener(l=>{this._onReceiveData({chunk:l})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const i=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(i):this._queuedChunks.push(i);else{const s=this._rangeReaders.some(function(r){return r._begin!==e?!1:(r._enqueue(i),!0)});ws(s,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}_onProgress(e){var t,i,s,r;e.total===void 0?(i=(t=this._rangeReaders[0])==null?void 0:t.onProgress)==null||i.call(t,{loaded:e.loaded}):(r=(s=this._fullRequestReader)==null?void 0:s.onProgress)==null||r.call(s,{loaded:e.loaded,total:e.total})}_onProgressiveDone(){var e;(e=this._fullRequestReader)==null||e.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){ws(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new EB(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const i=new TB(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(i),i}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const i of this._rangeReaders.slice(0))i.cancel(e);this._pdfDataRangeTransport.abort()}}class EB{constructor(e,t,i=!1,s=null){this._stream=e,this._done=i||!1,this._filename=p4(s)?s:null,this._queuedChunks=t||[],this._loaded=0;for(const r of this._queuedChunks)this._loaded+=r.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class TB{constructor(e,t,i){this._stream=e,this._begin=t,this._end=i,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function RB(n){let e=!0,t=i("filename\\*","i").exec(n);if(t){t=t[1];let h=o(t);return h=unescape(h),h=l(h),h=c(h),r(h)}if(t=a(n),t){const h=c(t);return r(h)}if(t=i("filename","i").exec(n),t){t=t[1];let h=o(t);return h=c(h),r(h)}function i(h,u){return new RegExp("(?:^|;)\\s*"+h+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',u)}function s(h,u){if(h){if(!/^[\x00-\xFF]+$/.test(u))return u;try{const d=new TextDecoder(h,{fatal:!0}),f=dx(u);u=d.decode(f),e=!1}catch{}}return u}function r(h){return e&&/[\x80-\xff]/.test(h)&&(h=s("utf-8",h),e&&(h=s("iso-8859-1",h))),h}function a(h){const u=[];let d;const f=i("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(d=f.exec(h))!==null;){let[,m,b,p]=d;if(m=parseInt(m,10),m in u){if(m===0)break;continue}u[m]=[b,p]}const g=[];for(let m=0;m<u.length&&m in u;++m){let[b,p]=u[m];p=o(p),b&&(p=unescape(p),m===0&&(p=l(p))),g.push(p)}return g.join("")}function o(h){if(h.startsWith('"')){const u=h.slice(1).split('\\"');for(let d=0;d<u.length;++d){const f=u[d].indexOf('"');f!==-1&&(u[d]=u[d].slice(0,f),u.length=d+1),u[d]=u[d].replaceAll(/\\(.)/g,"$1")}h=u.join('"')}return h}function l(h){const u=h.indexOf("'");if(u===-1)return h;const d=h.slice(0,u),g=h.slice(u+1).replace(/^[^']*'/,"");return s(d,g)}function c(h){return!h.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(h)?h:h.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(u,d,f,g){if(f==="q"||f==="Q")return g=g.replaceAll("_"," "),g=g.replaceAll(/=([0-9a-fA-F]{2})/g,function(m,b){return String.fromCharCode(parseInt(b,16))}),s(d,g);try{g=atob(g)}catch{}return s(d,g)})}return""}function QE(n,e){const t=new Headers;if(!n||!e||typeof e!="object")return t;for(const i in e){const s=e[i];s!==void 0&&t.append(i,s)}return t}function sy(n){var e;return((e=URL.parse(n))==null?void 0:e.origin)??null}function $E({responseHeaders:n,isHttp:e,rangeChunkSize:t,disableRange:i}){const s={allowRangeRequests:!1,suggestedLength:void 0},r=parseInt(n.get("Content-Length"),10);return!Number.isInteger(r)||(s.suggestedLength=r,r<=2*t)||i||!e||n.get("Accept-Ranges")!=="bytes"||(n.get("Content-Encoding")||"identity")!=="identity"||(s.allowRangeRequests=!0),s}function eT(n){const e=n.get("Content-Disposition");if(e){let t=RB(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(p4(t))return t}return null}function px(n,e){return new k3(`Unexpected server response (${n}) while retrieving PDF "${e}".`,n,n===404||n===0&&e.startsWith("file:"))}function tT(n){return n===200||n===206}function nT(n,e,t){return{method:"GET",headers:n,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function iT(n){return n instanceof Uint8Array?n.buffer:n instanceof ArrayBuffer?n:(vn(`getArrayBuffer - unexpected data format: ${n}`),new Uint8Array(n).buffer)}class MB{constructor(e){Ue(this,"_responseOrigin",null);this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=QE(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return ws(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new PB(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const i=new NB(this,e,t);return this._rangeRequestReaders.push(i),i}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const i of this._rangeRequestReaders.slice(0))i.cancel(e)}}class PB{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const i=new Headers(e.headers),s=t.url;fetch(s,nT(i,this._withCredentials,this._abortController)).then(r=>{if(e._responseOrigin=sy(r.url),!tT(r.status))throw px(r.status,s);this._reader=r.body.getReader(),this._headersCapability.resolve();const a=r.headers,{allowRangeRequests:o,suggestedLength:l}=$E({responseHeaders:a,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=o,this._contentLength=l||this._contentLength,this._filename=eT(a),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Vh("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var i;await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded,total:this._contentLength}),{value:iT(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}class NB{constructor(e,t,i){this._stream=e,this._reader=null,this._loaded=0;const s=e.source;this._withCredentials=s.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!s.disableStream,this._abortController=new AbortController;const r=new Headers(e.headers);r.append("Range",`bytes=${t}-${i-1}`);const a=s.url;fetch(a,nT(r,this._withCredentials,this._abortController)).then(o=>{const l=sy(o.url);if(l!==e._responseOrigin)throw new Error(`Expected range response-origin "${l}" to match "${e._responseOrigin}".`);if(!tT(o.status))throw px(o.status,a);this._readCapability.resolve(),this._reader=o.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var i;await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded}),{value:iT(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}const xw=200,yw=206;function OB(n){const e=n.response;return typeof e!="string"?e:dx(e).buffer}class DB{constructor({url:e,httpHeaders:t,withCredentials:i}){Ue(this,"_responseOrigin",null);this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=QE(this.isHttp,t),this.withCredentials=i||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,i=this.currXhrId++,s=this.pendingRequests[i]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[r,a]of this.headers)t.setRequestHeader(r,a);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),s.expectedStatus=yw):s.expectedStatus=xw,t.responseType="arraybuffer",ws(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,i),t.onprogress=this.onProgress.bind(this,i),s.onHeadersReceived=e.onHeadersReceived,s.onDone=e.onDone,s.onError=e.onError,s.onProgress=e.onProgress,t.send(null),i}onProgress(e,t){var s;const i=this.pendingRequests[e];i&&((s=i.onProgress)==null||s.call(i,t))}onStateChange(e,t){const i=this.pendingRequests[e];if(!i)return;const s=i.xhr;if(s.readyState>=2&&i.onHeadersReceived&&(i.onHeadersReceived(),delete i.onHeadersReceived),s.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],s.status===0&&this.isHttp){i.onError(s.status);return}const r=s.status||xw;if(!(r===xw&&i.expectedStatus===yw)&&r!==i.expectedStatus){i.onError(s.status);return}const o=OB(s);if(r===yw){const l=s.getResponseHeader("Content-Range"),c=/bytes (\d+)-(\d+)\/(\d+)/.exec(l);c?i.onDone({begin:parseInt(c[1],10),chunk:o}):(vn('Missing or invalid "Content-Range" header.'),i.onError(0))}else o?i.onDone({begin:0,chunk:o}):i.onError(s.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class FB{constructor(e){this._source=e,this._manager=new DB(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return ws(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new LB(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const i=new BB(this._manager,e,t);return i.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(i),i}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const i of this._rangeRequestReaders.slice(0))i.cancel(e)}}class LB{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=sy(t.responseURL);const i=t.getAllResponseHeaders(),s=new Headers(i?i.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(o=>{const[l,...c]=o.split(": ");return[l,c.join(": ")]}):[]),{allowRangeRequests:r,suggestedLength:a}=$E({responseHeaders:s,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});r&&(this._isRangeSupported=!0),this._contentLength=a||this._contentLength,this._filename=eT(s),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=px(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){var t;(t=this.onProgress)==null||t.call(this,{loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class BB{constructor(e,t,i){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:i,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var t;const e=sy((t=this._manager.getRequestXhr(this._requestId))==null?void 0:t.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){var e;(e=this.onClosed)==null||e.call(this,this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??(this._storedError=px(e,this._url));for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){var t;this.isStreamingSupported||(t=this.onProgress)==null||t.call(this,{loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const UB=/^[a-z][a-z0-9\-+.]+:/i;function HB(n){if(UB.test(n))return new URL(n);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(n))}class zB{constructor(e){this.source=e,this.url=HB(e.url),ws(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return ws(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new jB(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const i=new GB(this,e,t);return this._rangeRequestReaders.push(i),i}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const i of this._rangeRequestReaders.slice(0))i.cancel(e)}}class jB{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const i=process.getBuiltinModule("fs");i.promises.lstat(this._url).then(s=>{this._contentLength=s.size,this._setReadableStream(i.createReadStream(this._url)),this._headersCapability.resolve()},s=>{s.code==="ENOENT"&&(s=px(0,this._url.href)),this._storedError=s,this._headersCapability.reject(s)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var i;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Vh("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class GB{constructor(e,t,i){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const s=e.source;this._isStreamingSupported=!s.disableStream;const r=process.getBuiltinModule("fs");this._setReadableStream(r.createReadStream(this._url,{start:t,end:i-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var i;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const Tm=Symbol("INITIAL_DATA");var Ma,Y2,H8;class sT{constructor(){U(this,Y2);U(this,Ma,Object.create(null))}get(e,t=null){if(t){const s=F(this,Y2,H8).call(this,e);return s.promise.then(()=>t(s.data)),null}const i=x(this,Ma)[e];if(!i||i.data===Tm)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return i.data}has(e){const t=x(this,Ma)[e];return!!t&&t.data!==Tm}delete(e){const t=x(this,Ma)[e];return!t||t.data===Tm?!1:(delete x(this,Ma)[e],!0)}resolve(e,t=null){const i=F(this,Y2,H8).call(this,e);i.data=t,i.resolve()}clear(){var e;for(const t in x(this,Ma)){const{data:i}=x(this,Ma)[t];(e=i==null?void 0:i.bitmap)==null||e.close()}O(this,Ma,Object.create(null))}*[Symbol.iterator](){for(const e in x(this,Ma)){const{data:t}=x(this,Ma)[e];t!==Tm&&(yield[e,t])}}}Ma=new WeakMap,Y2=new WeakSet,H8=function(e){var t;return(t=x(this,Ma))[e]||(t[e]={...Promise.withResolvers(),data:Tm})};const VB=1e5,jv=30;var HI,rh,ca,J2,Z2,Qu,Hc,Q2,$2,$u,B1,U1,ah,H1,eb,z1,ed,tb,nb,j1,td,ib,oh,G1,E0,rT,aT,z8,Qa,D9,j8,oT,lT;const As=class As{constructor({textContentSource:e,container:t,viewport:i}){U(this,E0);U(this,rh,Promise.withResolvers());U(this,ca,null);U(this,J2,!1);U(this,Z2,!!((HI=globalThis.FontInspector)!=null&&HI.enabled));U(this,Qu,null);U(this,Hc,null);U(this,Q2,0);U(this,$2,0);U(this,$u,null);U(this,B1,null);U(this,U1,0);U(this,ah,0);U(this,H1,Object.create(null));U(this,eb,[]);U(this,z1,null);U(this,ed,[]);U(this,tb,new WeakMap);U(this,nb,null);var l;if(e instanceof ReadableStream)O(this,z1,e);else if(typeof e=="object")O(this,z1,new ReadableStream({start(c){c.enqueue(e),c.close()}}));else throw new Error('No "textContentSource" parameter specified.');O(this,ca,O(this,B1,t)),O(this,ah,i.scale*cc.pixelRatio),O(this,U1,i.rotation),O(this,Hc,{div:null,properties:null,ctx:null});const{pageWidth:s,pageHeight:r,pageX:a,pageY:o}=i.rawDims;O(this,nb,[1,0,0,-1,-a,o+r]),O(this,$2,s),O(this,Q2,r),F(l=As,Qa,oT).call(l),Zd(t,i),x(this,rh).promise.finally(()=>{x(As,G1).delete(this),O(this,Hc,null),O(this,H1,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=br.platform;return zn(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{x(this,$u).read().then(({value:t,done:i})=>{if(i){x(this,rh).resolve();return}x(this,Qu)??O(this,Qu,t.lang),Object.assign(x(this,H1),t.styles),F(this,E0,rT).call(this,t.items),e()},x(this,rh).reject)};return O(this,$u,x(this,z1).getReader()),x(As,G1).add(this),e(),x(this,rh).promise}update({viewport:e,onBefore:t=null}){var r;const i=e.scale*cc.pixelRatio,s=e.rotation;if(s!==x(this,U1)&&(t==null||t(),O(this,U1,s),Zd(x(this,B1),{rotation:s})),i!==x(this,ah)){t==null||t(),O(this,ah,i);const a={div:null,properties:null,ctx:F(r=As,Qa,D9).call(r,x(this,Qu))};for(const o of x(this,ed))a.properties=x(this,tb).get(o),a.div=o,F(this,E0,z8).call(this,a)}}cancel(){var t;const e=new Vh("TextLayer task cancelled.");(t=x(this,$u))==null||t.cancel(e).catch(()=>{}),O(this,$u,null),x(this,rh).reject(e)}get textDivs(){return x(this,ed)}get textContentItemsStr(){return x(this,eb)}static cleanup(){if(!(x(this,G1).size>0)){x(this,j1).clear();for(const{canvas:e}of x(this,td).values())e.remove();x(this,td).clear()}}};rh=new WeakMap,ca=new WeakMap,J2=new WeakMap,Z2=new WeakMap,Qu=new WeakMap,Hc=new WeakMap,Q2=new WeakMap,$2=new WeakMap,$u=new WeakMap,B1=new WeakMap,U1=new WeakMap,ah=new WeakMap,H1=new WeakMap,eb=new WeakMap,z1=new WeakMap,ed=new WeakMap,tb=new WeakMap,nb=new WeakMap,j1=new WeakMap,td=new WeakMap,ib=new WeakMap,oh=new WeakMap,G1=new WeakMap,E0=new WeakSet,rT=function(e){var s,r;if(x(this,J2))return;(r=x(this,Hc)).ctx??(r.ctx=F(s=As,Qa,D9).call(s,x(this,Qu)));const t=x(this,ed),i=x(this,eb);for(const a of e){if(t.length>VB){vn("Ignoring additional textDivs for performance reasons."),O(this,J2,!0);return}if(a.str===void 0){if(a.type==="beginMarkedContentProps"||a.type==="beginMarkedContent"){const o=x(this,ca);O(this,ca,document.createElement("span")),x(this,ca).classList.add("markedContent"),a.id!==null&&x(this,ca).setAttribute("id",`${a.id}`),o.append(x(this,ca))}else a.type==="endMarkedContent"&&O(this,ca,x(this,ca).parentNode);continue}i.push(a.str),F(this,E0,aT).call(this,a)}},aT=function(e){var m;const t=document.createElement("span"),i={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};x(this,ed).push(t);const s=sn.transform(x(this,nb),e.transform);let r=Math.atan2(s[1],s[0]);const a=x(this,H1)[e.fontName];a.vertical&&(r+=Math.PI/2);let o=x(this,Z2)&&a.fontSubstitution||a.fontFamily;o=As.fontFamilyMap.get(o)||o;const l=Math.hypot(s[2],s[3]),c=l*F(m=As,Qa,lT).call(m,o,a,x(this,Qu));let h,u;r===0?(h=s[4],u=s[5]-c):(h=s[4]+c*Math.sin(r),u=s[5]-c*Math.cos(r));const d="calc(var(--total-scale-factor) *",f=t.style;x(this,ca)===x(this,B1)?(f.left=`${(100*h/x(this,$2)).toFixed(2)}%`,f.top=`${(100*u/x(this,Q2)).toFixed(2)}%`):(f.left=`${d}${h.toFixed(2)}px)`,f.top=`${d}${u.toFixed(2)}px)`),f.fontSize=`${d}${(x(As,oh)*l).toFixed(2)}px)`,f.fontFamily=o,i.fontSize=l,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,x(this,Z2)&&(t.dataset.fontName=a.fontSubstitutionLoadedName||e.fontName),r!==0&&(i.angle=r*(180/Math.PI));let g=!1;if(e.str.length>1)g=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const b=Math.abs(e.transform[0]),p=Math.abs(e.transform[3]);b!==p&&Math.max(b,p)/Math.min(b,p)>1.5&&(g=!0)}if(g&&(i.canvasWidth=a.vertical?e.height:e.width),x(this,tb).set(t,i),x(this,Hc).div=t,x(this,Hc).properties=i,F(this,E0,z8).call(this,x(this,Hc)),i.hasText&&x(this,ca).append(t),i.hasEOL){const b=document.createElement("br");b.setAttribute("role","presentation"),x(this,ca).append(b)}},z8=function(e){var o;const{div:t,properties:i,ctx:s}=e,{style:r}=t;let a="";if(x(As,oh)>1&&(a=`scale(${1/x(As,oh)})`),i.canvasWidth!==0&&i.hasText){const{fontFamily:l}=r,{canvasWidth:c,fontSize:h}=i;F(o=As,Qa,j8).call(o,s,h*x(this,ah),l);const{width:u}=s.measureText(t.textContent);u>0&&(a=`scaleX(${c*x(this,ah)/u}) ${a}`)}i.angle!==0&&(a=`rotate(${i.angle}deg) ${a}`),a.length>0&&(r.transform=a)},Qa=new WeakSet,D9=function(e=null){let t=x(this,td).get(e||(e=""));if(!t){const i=document.createElement("canvas");i.className="hiddenCanvasElement",i.lang=e,document.body.append(i),t=i.getContext("2d",{alpha:!1,willReadFrequently:!0}),x(this,td).set(e,t),x(this,ib).set(t,{size:0,family:""})}return t},j8=function(e,t,i){const s=x(this,ib).get(e);t===s.size&&i===s.family||(e.font=`${t}px ${i}`,s.size=t,s.family=i)},oT=function(){if(x(this,oh)!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),O(this,oh,e.getBoundingClientRect().height),e.remove()},lT=function(e,t,i){const s=x(this,j1).get(e);if(s)return s;const r=F(this,Qa,D9).call(this,i);r.canvas.width=r.canvas.height=jv,F(this,Qa,j8).call(this,r,jv,e);const a=r.measureText(""),o=a.fontBoundingBoxAscent,l=Math.abs(a.fontBoundingBoxDescent);r.canvas.width=r.canvas.height=0;let c=.8;return o?c=o/(o+l):(br.platform.isFirefox&&vn("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),t.ascent?c=t.ascent:t.descent&&(c=1+t.descent)),x(this,j1).set(e,c),c},U(As,Qa),U(As,j1,new Map),U(As,td,new Map),U(As,ib,new WeakMap),U(As,oh,null),U(As,G1,new Set);let Bp=As;class Up{static textContent(e){const t=[],i={items:t,styles:Object.create(null)};function s(r){var l;if(!r)return;let a=null;const o=r.name;if(o==="#text")a=r.value;else if(Up.shouldBuildText(o))(l=r==null?void 0:r.attributes)!=null&&l.textContent?a=r.attributes.textContent:r.value&&(a=r.value);else return;if(a!==null&&t.push({str:a}),!!r.children)for(const c of r.children)s(c)}return s(e),i}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}const qB=100;function WB(n={}){typeof n=="string"||n instanceof URL?n={url:n}:(n instanceof ArrayBuffer||ArrayBuffer.isView(n))&&(n={data:n});const e=new G8,{docId:t}=e,i=n.url?eB(n.url):null,s=n.data?tB(n.data):null,r=n.httpHeaders||null,a=n.withCredentials===!0,o=n.password??null,l=n.range instanceof cT?n.range:null,c=Number.isInteger(n.rangeChunkSize)&&n.rangeChunkSize>0?n.rangeChunkSize:2**16;let h=n.worker instanceof Hp?n.worker:null;const u=n.verbosity,d=typeof n.docBaseUrl=="string"&&!iy(n.docBaseUrl)?n.docBaseUrl:null,f=Ux(n.cMapUrl),g=n.cMapPacked!==!1,m=n.CMapReaderFactory||(Vr?cB:Rv),b=Ux(n.iccUrl),p=Ux(n.standardFontDataUrl),y=n.StandardFontDataFactory||(Vr?hB:Mv),w=Ux(n.wasmUrl),_=n.WasmFactory||(Vr?uB:Pv),v=n.stopAtErrors!==!0,C=Number.isInteger(n.maxImageSize)&&n.maxImageSize>-1?n.maxImageSize:-1,k=n.isEvalSupported!==!1,I=typeof n.isOffscreenCanvasSupported=="boolean"?n.isOffscreenCanvasSupported:!Vr,E=typeof n.isImageDecoderSupported=="boolean"?n.isImageDecoderSupported:!Vr&&(br.platform.isFirefox||!globalThis.chrome),T=Number.isInteger(n.canvasMaxAreaInBytes)?n.canvasMaxAreaInBytes:-1,M=typeof n.disableFontFace=="boolean"?n.disableFontFace:Vr,D=n.fontExtraProperties===!0,H=n.enableXfa===!0,R=n.ownerDocument||globalThis.document,z=n.disableRange===!0,P=n.disableStream===!0,B=n.disableAutoFetch===!0,Z=n.pdfBug===!0,G=n.CanvasFactory||(Vr?lB:rB),Y=n.FilterFactory||(Vr?oB:aB),J=n.enableHWA===!0,se=n.useWasm!==!1,fe=l?l.length:n.length??NaN,he=typeof n.useSystemFonts=="boolean"?n.useSystemFonts:!Vr&&!M,de=typeof n.useWorkerFetch=="boolean"?n.useWorkerFetch:!!(m===Rv&&y===Mv&&_===Pv&&f&&p&&w&&Xm(f,document.baseURI)&&Xm(p,document.baseURI)&&Xm(w,document.baseURI)),ge=null;PL(u);const N={canvasFactory:new G({ownerDocument:R,enableHWA:J}),filterFactory:new Y({docId:t,ownerDocument:R}),cMapReaderFactory:de?null:new m({baseUrl:f,isCompressed:g}),standardFontDataFactory:de?null:new y({baseUrl:p}),wasmFactory:de?null:new _({baseUrl:w})};h||(h=Hp.create({verbosity:u,port:Ql.workerPort}),e._worker=h);const K={docId:t,apiVersion:"5.3.93",data:s,password:o,disableAutoFetch:B,rangeChunkSize:c,length:fe,docBaseUrl:d,enableXfa:H,evaluatorOptions:{maxImageSize:C,disableFontFace:M,ignoreErrors:v,isEvalSupported:k,isOffscreenCanvasSupported:I,isImageDecoderSupported:E,canvasMaxAreaInBytes:T,fontExtraProperties:D,useSystemFonts:he,useWasm:se,useWorkerFetch:de,cMapUrl:f,iccUrl:b,standardFontDataUrl:p,wasmUrl:w}},oe={ownerDocument:R,pdfBug:Z,styleElement:ge,loadingParams:{disableAutoFetch:B,enableXfa:H}};return h.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const W=h.messageHandler.sendWithPromise("GetDocRequest",K,s?[s.buffer]:null);let le;if(l)le=new IB(l,{disableRange:z,disableStream:P});else if(!s){if(!i)throw new Error("getDocument - no `url` parameter provided.");const ce=Xm(i)?MB:Vr?zB:FB;le=new ce({url:i,length:fe,httpHeaders:r,withCredentials:a,rangeChunkSize:c,disableRange:z,disableStream:P})}return W.then(ce=>{if(e.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const Ce=new $m(t,ce,h.port),X=new YB(Ce,e,le,oe,N);e._transport=X,Ce.send("Ready",null)})}).catch(e._capability.reject),e}var I5;const E5=class E5{constructor(){Ue(this,"_capability",Promise.withResolvers());Ue(this,"_transport",null);Ue(this,"_worker",null);Ue(this,"docId",`d${Fr(E5,I5)._++}`);Ue(this,"destroyed",!1);Ue(this,"onPassword",null);Ue(this,"onProgress",null)}get promise(){return this._capability.promise}async destroy(){var e,t,i,s;this.destroyed=!0;try{(e=this._worker)!=null&&e.port&&(this._worker._pendingDestroy=!0),await((t=this._transport)==null?void 0:t.destroy())}catch(r){throw(i=this._worker)!=null&&i.port&&delete this._worker._pendingDestroy,r}this._transport=null,(s=this._worker)==null||s.destroy(),this._worker=null}async getData(){return this._transport.getData()}};I5=new WeakMap,U(E5,I5,0);let G8=E5;var nd,sb,rb,ab,ob;class cT{constructor(e,t,i=!1,s=null){U(this,nd,Promise.withResolvers());U(this,sb,[]);U(this,rb,[]);U(this,ab,[]);U(this,ob,[]);this.length=e,this.initialData=t,this.progressiveDone=i,this.contentDispositionFilename=s}addRangeListener(e){x(this,ob).push(e)}addProgressListener(e){x(this,ab).push(e)}addProgressiveReadListener(e){x(this,rb).push(e)}addProgressiveDoneListener(e){x(this,sb).push(e)}onDataRange(e,t){for(const i of x(this,ob))i(e,t)}onDataProgress(e,t){x(this,nd).promise.then(()=>{for(const i of x(this,ab))i(e,t)})}onDataProgressiveRead(e){x(this,nd).promise.then(()=>{for(const t of x(this,rb))t(e)})}onDataProgressiveDone(){x(this,nd).promise.then(()=>{for(const e of x(this,sb))e()})}transportReady(){x(this,nd).resolve()}requestDataRange(e,t){bi("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}nd=new WeakMap,sb=new WeakMap,rb=new WeakMap,ab=new WeakMap,ob=new WeakMap;class KB{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return zn(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var zc,id,sp;class XB{constructor(e,t,i,s=!1){U(this,id);U(this,zc,!1);this._pageIndex=e,this._pageInfo=t,this._transport=i,this._stats=s?new Iv:null,this._pdfBug=s,this.commonObjs=i.commonObjs,this.objs=new sT,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:i=0,offsetY:s=0,dontFlip:r=!1}={}){return new gx({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:i,offsetY:s,dontFlip:r})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return zn(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var e;return((e=this._transport._htmlForXfa)==null?void 0:e.children[this._pageIndex])||null}render({canvasContext:e,viewport:t,intent:i="display",annotationMode:s=H0.ENABLE,transform:r=null,background:a=null,optionalContentConfigPromise:o=null,annotationCanvasMap:l=null,pageColors:c=null,printAnnotationStorage:h=null,isEditing:u=!1}){var _,v;(_=this._stats)==null||_.time("Overall");const d=this._transport.getRenderingIntent(i,s,h,u),{renderingIntent:f,cacheKey:g}=d;O(this,zc,!1),o||(o=this._transport.getOptionalContentConfig(f));let m=this._intentStates.get(g);m||(m=Object.create(null),this._intentStates.set(g,m)),m.streamReaderCancelTimeout&&(clearTimeout(m.streamReaderCancelTimeout),m.streamReaderCancelTimeout=null);const b=!!(f&ja.PRINT);m.displayReadyCapability||(m.displayReadyCapability=Promise.withResolvers(),m.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(v=this._stats)==null||v.time("Page Request"),this._pumpOperatorList(d));const p=C=>{var k;m.renderTasks.delete(y),b&&O(this,zc,!0),F(this,id,sp).call(this),C?(y.capability.reject(C),this._abortOperatorList({intentState:m,reason:C instanceof Error?C:new Error(C)})):y.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(k=globalThis.Stats)!=null&&k.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},y=new V8({callback:p,params:{canvasContext:e,viewport:t,transform:r,background:a},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:l,operatorList:m.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!b,pdfBug:this._pdfBug,pageColors:c});(m.renderTasks||(m.renderTasks=new Set)).add(y);const w=y.task;return Promise.all([m.displayReadyCapability.promise,o]).then(([C,k])=>{var I;if(this.destroyed){p();return}if((I=this._stats)==null||I.time("Rendering"),!(k.renderingIntent&f))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");y.initializeGraphics({transparency:C,optionalContentConfig:k}),y.operatorListChanged()}).catch(p),w}getOperatorList({intent:e="display",annotationMode:t=H0.ENABLE,printAnnotationStorage:i=null,isEditing:s=!1}={}){var c;function r(){o.operatorList.lastChunk&&(o.opListReadCapability.resolve(o.operatorList),o.renderTasks.delete(l))}const a=this._transport.getRenderingIntent(e,t,i,s,!0);let o=this._intentStates.get(a.cacheKey);o||(o=Object.create(null),this._intentStates.set(a.cacheKey,o));let l;return o.opListReadCapability||(l=Object.create(null),l.operatorListChanged=r,o.opListReadCapability=Promise.withResolvers(),(o.renderTasks||(o.renderTasks=new Set)).add(l),o.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(c=this._stats)==null||c.time("Page Request"),this._pumpOperatorList(a)),o.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(s){return s.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(i=>Up.textContent(i));const t=this.streamTextContent(e);return new Promise(function(i,s){function r(){a.read().then(function({value:l,done:c}){if(c){i(o);return}o.lang??(o.lang=l.lang),Object.assign(o.styles,l.styles),o.items.push(...l.items),r()},s)}const a=t.getReader(),o={items:[],styles:Object.create(null),lang:null};r()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const i of t.renderTasks)e.push(i.completed),i.cancel();return this.objs.clear(),O(this,zc,!1),Promise.all(e)}cleanup(e=!1){O(this,zc,!0);const t=F(this,id,sp).call(this);return e&&t&&this._stats&&(this._stats=new Iv),t}_startRenderPage(e,t){var s,r;const i=this._intentStates.get(t);i&&((s=this._stats)==null||s.timeEnd("Page Request"),(r=i.displayReadyCapability)==null||r.resolve(e))}_renderPageChunk(e,t){for(let i=0,s=e.length;i<s;i++)t.operatorList.fnArray.push(e.fnArray[i]),t.operatorList.argsArray.push(e.argsArray[i]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const i of t.renderTasks)i.operatorListChanged();e.lastChunk&&F(this,id,sp).call(this)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:i,modifiedIds:s}){const{map:r,transfer:a}=i,l=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:r,modifiedIds:s},a).getReader(),c=this._intentStates.get(t);c.streamReader=l;const h=()=>{l.read().then(({value:u,done:d})=>{if(d){c.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(u,c),h())},u=>{if(c.streamReader=null,!this._transport.destroyed){if(c.operatorList){c.operatorList.lastChunk=!0;for(const d of c.renderTasks)d.operatorListChanged();F(this,id,sp).call(this)}if(c.displayReadyCapability)c.displayReadyCapability.reject(u);else if(c.opListReadCapability)c.opListReadCapability.reject(u);else throw u}})};h()}_abortOperatorList({intentState:e,reason:t,force:i=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!i){if(e.renderTasks.size>0)return;if(t instanceof m4){let s=qB;t.extraDelay>0&&t.extraDelay<1e3&&(s+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},s);return}}if(e.streamReader.cancel(new Vh(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[s,r]of this._intentStates)if(r===e){this._intentStates.delete(s);break}this.cleanup()}}}get stats(){return this._stats}}zc=new WeakMap,id=new WeakSet,sp=function(){if(!x(this,zc)||this.destroyed)return!1;for(const{renderTasks:e,operatorList:t}of this._intentStates.values())if(e.size>0||!t.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),O(this,zc,!1),!0};var lh,Ho,jc,sd,T5,rd,ad,Zr,F9,hT,uT,rp,V1,L9;const Mi=class Mi{constructor({name:e=null,port:t=null,verbosity:i=NL()}={}){U(this,Zr);U(this,lh,Promise.withResolvers());U(this,Ho,null);U(this,jc,null);U(this,sd,null);if(this.name=e,this.destroyed=!1,this.verbosity=i,t){if(x(Mi,ad).has(t))throw new Error("Cannot use more than one PDFWorker per port.");x(Mi,ad).set(t,this),F(this,Zr,hT).call(this,t)}else F(this,Zr,uT).call(this)}get promise(){return x(this,lh).promise}get port(){return x(this,jc)}get messageHandler(){return x(this,Ho)}destroy(){var e,t;this.destroyed=!0,(e=x(this,sd))==null||e.terminate(),O(this,sd,null),x(Mi,ad).delete(x(this,jc)),O(this,jc,null),(t=x(this,Ho))==null||t.destroy(),O(this,Ho,null)}static create(e){const t=x(this,ad).get(e==null?void 0:e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new Mi(e)}static get workerSrc(){if(Ql.workerSrc)return Ql.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return zn(this,"_setupFakeWorkerGlobal",(async()=>x(this,V1,L9)?x(this,V1,L9):(await import(this.workerSrc)).WorkerMessageHandler)())}};lh=new WeakMap,Ho=new WeakMap,jc=new WeakMap,sd=new WeakMap,T5=new WeakMap,rd=new WeakMap,ad=new WeakMap,Zr=new WeakSet,F9=function(){x(this,lh).resolve(),x(this,Ho).send("configure",{verbosity:this.verbosity})},hT=function(e){O(this,jc,e),O(this,Ho,new $m("main","worker",e)),x(this,Ho).on("ready",()=>{}),F(this,Zr,F9).call(this)},uT=function(){if(x(Mi,rd)||x(Mi,V1,L9)){F(this,Zr,rp).call(this);return}let{workerSrc:e}=Mi;try{Mi._isSameOrigin(window.location,e)||(e=Mi._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),i=new $m("main","worker",t),s=()=>{r.abort(),i.destroy(),t.terminate(),this.destroyed?x(this,lh).reject(new Error("Worker was destroyed")):F(this,Zr,rp).call(this)},r=new AbortController;t.addEventListener("error",()=>{x(this,sd)||s()},{signal:r.signal}),i.on("test",o=>{if(r.abort(),this.destroyed||!o){s();return}O(this,Ho,i),O(this,jc,t),O(this,sd,t),F(this,Zr,F9).call(this)}),i.on("ready",o=>{if(r.abort(),this.destroyed){s();return}try{a()}catch{F(this,Zr,rp).call(this)}});const a=()=>{const o=new Uint8Array;i.send("test",o,[o.buffer])};a();return}catch{ny("The worker has been disabled.")}F(this,Zr,rp).call(this)},rp=function(){x(Mi,rd)||(vn("Setting up fake worker."),O(Mi,rd,!0)),Mi._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){x(this,lh).reject(new Error("Worker was destroyed"));return}const t=new sB;O(this,jc,t);const i=`fake${Fr(Mi,T5)._++}`,s=new $m(i+"_worker",i,t);e.setup(s,t),O(this,Ho,new $m(i,i+"_worker",t)),F(this,Zr,F9).call(this)}).catch(e=>{x(this,lh).reject(new Error(`Setting up fake worker failed: "${e.message}".`))})},V1=new WeakSet,L9=function(){var e;try{return((e=globalThis.pdfjsWorker)==null?void 0:e.WorkerMessageHandler)||null}catch{return null}},U(Mi,V1),U(Mi,T5,0),U(Mi,rd,!1),U(Mi,ad,new WeakMap),Vr&&(O(Mi,rd,!0),Ql.workerSrc||(Ql.workerSrc="./pdf.worker.mjs")),Mi._isSameOrigin=(e,t)=>{const i=URL.parse(e);if(!(i!=null&&i.origin)||i.origin==="null")return!1;const s=new URL(t,i);return i.origin===s.origin},Mi._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))},Mi.fromPort=e=>{if(qL("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!(e!=null&&e.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return Mi.create(e)};let Hp=Mi;var Gc,zl,q1,W1,Vc,od,ap;class YB{constructor(e,t,i,s,r){U(this,od);U(this,Gc,new Map);U(this,zl,new Map);U(this,q1,new Map);U(this,W1,new Map);U(this,Vc,null);this.messageHandler=e,this.loadingTask=t,this.commonObjs=new sT,this.fontLoader=new QL({ownerDocument:s.ownerDocument,styleElement:s.styleElement}),this.loadingParams=s.loadingParams,this._params=s,this.canvasFactory=r.canvasFactory,this.filterFactory=r.filterFactory,this.cMapReaderFactory=r.cMapReaderFactory,this.standardFontDataFactory=r.standardFontDataFactory,this.wasmFactory=r.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=i,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}get annotationStorage(){return zn(this,"annotationStorage",new y4)}getRenderingIntent(e,t=H0.ENABLE,i=null,s=!1,r=!1){let a=ja.DISPLAY,o=R8;switch(e){case"any":a=ja.ANY;break;case"display":break;case"print":a=ja.PRINT;break;default:vn(`getRenderingIntent - invalid intent: ${e}`)}const l=a&ja.PRINT&&i instanceof jE?i:this.annotationStorage;switch(t){case H0.DISABLE:a+=ja.ANNOTATIONS_DISABLE;break;case H0.ENABLE:break;case H0.ENABLE_FORMS:a+=ja.ANNOTATIONS_FORMS;break;case H0.ENABLE_STORAGE:a+=ja.ANNOTATIONS_STORAGE,o=l.serializable;break;default:vn(`getRenderingIntent - invalid annotationMode: ${t}`)}s&&(a+=ja.IS_EDITING),r&&(a+=ja.OPLIST);const{ids:c,hash:h}=l.modifiedIds,u=[a,o.hash,h];return{renderingIntent:a,cacheKey:u.join("_"),annotationStorageSerializable:o,modifiedIds:c}}destroy(){var i;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(i=x(this,Vc))==null||i.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const s of x(this,zl).values())e.push(s._destroy());x(this,zl).clear(),x(this,q1).clear(),x(this,W1).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{var s,r;this.commonObjs.clear(),this.fontLoader.clear(),x(this,Gc).clear(),this.filterFactory.destroy(),Bp.cleanup(),(s=this._networkStream)==null||s.cancelAllRequests(new Vh("Worker was terminated.")),(r=this.messageHandler)==null||r.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(i,s)=>{ws(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=r=>{this._lastProgress={loaded:r.loaded,total:r.total}},s.onPull=()=>{this._fullReader.read().then(function({value:r,done:a}){if(a){s.close();return}ws(r instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(r),1,[r])}).catch(r=>{s.error(r)})},s.onCancel=r=>{this._fullReader.cancel(r),s.ready.catch(a=>{if(!this.destroyed)throw a})}}),e.on("ReaderHeadersReady",async i=>{var o;await this._fullReader.headersReady;const{isStreamingSupported:s,isRangeSupported:r,contentLength:a}=this._fullReader;return(!s||!r)&&(this._lastProgress&&((o=t.onProgress)==null||o.call(t,this._lastProgress)),this._fullReader.onProgress=l=>{var c;(c=t.onProgress)==null||c.call(t,{loaded:l.loaded,total:l.total})}),{isStreamingSupported:s,isRangeSupported:r,contentLength:a}}),e.on("GetRangeReader",(i,s)=>{ws(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const r=this._networkStream.getRangeReader(i.begin,i.end);if(!r){s.close();return}s.onPull=()=>{r.read().then(function({value:a,done:o}){if(o){s.close();return}ws(a instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{s.error(a)})},s.onCancel=a=>{r.cancel(a),s.ready.catch(o=>{if(!this.destroyed)throw o})}}),e.on("GetDoc",({pdfInfo:i})=>{this._numPages=i.numPages,this._htmlForXfa=i.htmlForXfa,delete i.htmlForXfa,t._capability.resolve(new KB(i,this))}),e.on("DocException",i=>{t._capability.reject(aa(i))}),e.on("PasswordRequest",i=>{O(this,Vc,Promise.withResolvers());try{if(!t.onPassword)throw aa(i);const s=r=>{r instanceof Error?x(this,Vc).reject(r):x(this,Vc).resolve({password:r})};t.onPassword(s,i.code)}catch(s){x(this,Vc).reject(s)}return x(this,Vc).promise}),e.on("DataLoaded",i=>{var s;(s=t.onProgress)==null||s.call(t,{loaded:i.length,total:i.length}),this.downloadInfoCapability.resolve(i)}),e.on("StartRenderPage",i=>{if(this.destroyed)return;x(this,zl).get(i.pageIndex)._startRenderPage(i.transparency,i.cacheKey)}),e.on("commonobj",([i,s,r])=>{var a;if(this.destroyed||this.commonObjs.has(i))return null;switch(s){case"Font":if("error"in r){const h=r.error;vn(`Error during font loading: ${h}`),this.commonObjs.resolve(i,h);break}const o=this._params.pdfBug&&((a=globalThis.FontInspector)!=null&&a.enabled)?(h,u)=>globalThis.FontInspector.fontAdded(h,u):null,l=new $L(r,o);this.fontLoader.bind(l).catch(()=>e.sendWithPromise("FontFallback",{id:i})).finally(()=>{!l.fontExtraProperties&&l.data&&(l.data=null),this.commonObjs.resolve(i,l)});break;case"CopyLocalImage":const{imageRef:c}=r;ws(c,"The imageRef must be defined.");for(const h of x(this,zl).values())for(const[,u]of h.objs)if((u==null?void 0:u.ref)===c)return u.dataLen?(this.commonObjs.resolve(i,structuredClone(u)),u.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(i,r);break;default:throw new Error(`Got unknown common object type ${s}`)}return null}),e.on("obj",([i,s,r,a])=>{var l;if(this.destroyed)return;const o=x(this,zl).get(s);if(!o.objs.has(i)){if(o._intentStates.size===0){(l=a==null?void 0:a.bitmap)==null||l.close();return}switch(r){case"Image":case"Pattern":o.objs.resolve(i,a);break;default:throw new Error(`Got unknown object type ${r}`)}}}),e.on("DocProgress",i=>{var s;this.destroyed||(s=t.onProgress)==null||s.call(t,{loaded:i.loaded,total:i.total})}),e.on("FetchBinaryData",async i=>{if(this.destroyed)throw new Error("Worker was destroyed.");const s=this[i.type];if(!s)throw new Error(`${i.type} not initialized, see the \`useWorkerFetch\` parameter.`);return s.fetch(i)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var i;this.annotationStorage.size<=0&&vn("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:((i=this._fullReader)==null?void 0:i.filename)??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,i=x(this,q1).get(t);if(i)return i;const s=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(r=>{if(this.destroyed)throw new Error("Transport destroyed");r.refStr&&x(this,W1).set(r.refStr,e);const a=new XB(t,r,this,this._params.pdfBug);return x(this,zl).set(t,a),a});return x(this,q1).set(t,s),s}getPageIndex(e){return M8(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return F(this,od,ap).call(this,"GetFieldObjects")}hasJSActions(){return F(this,od,ap).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return F(this,od,ap).call(this,"GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return F(this,od,ap).call(this,"GetOptionalContentConfig").then(t=>new SB(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=x(this,Gc).get(e);if(t)return t;const i=this.messageHandler.sendWithPromise(e,null).then(s=>{var r,a;return{info:s[0],metadata:s[1]?new CB(s[1]):null,contentDispositionFilename:((r=this._fullReader)==null?void 0:r.filename)??null,contentLength:((a=this._fullReader)==null?void 0:a.contentLength)??null}});return x(this,Gc).set(e,i),i}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of x(this,zl).values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),x(this,Gc).clear(),this.filterFactory.destroy(!0),Bp.cleanup()}}cachedPageNumber(e){if(!M8(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return x(this,W1).get(t)??null}}Gc=new WeakMap,zl=new WeakMap,q1=new WeakMap,W1=new WeakMap,Vc=new WeakMap,od=new WeakSet,ap=function(e,t=null){const i=x(this,Gc).get(e);if(i)return i;const s=this.messageHandler.sendWithPromise(e,t);return x(this,Gc).set(e,s),s};var ch;class JB{constructor(e){U(this,ch,null);Ue(this,"onContinue",null);Ue(this,"onError",null);O(this,ch,e)}get promise(){return x(this,ch).capability.promise}cancel(e=0){x(this,ch).cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=x(this,ch).operatorList;if(!e)return!1;const{annotationCanvasMap:t}=x(this,ch);return e.form||e.canvas&&(t==null?void 0:t.size)>0}}ch=new WeakMap;var hh,ld;const ku=class ku{constructor({callback:e,params:t,objs:i,commonObjs:s,annotationCanvasMap:r,operatorList:a,pageIndex:o,canvasFactory:l,filterFactory:c,useRequestAnimationFrame:h=!1,pdfBug:u=!1,pageColors:d=null}){U(this,hh,null);this.callback=e,this.params=t,this.objs=i,this.commonObjs=s,this.annotationCanvasMap=r,this.operatorListIdx=null,this.operatorList=a,this._pageIndex=o,this.canvasFactory=l,this.filterFactory=c,this._pdfBug=u,this.pageColors=d,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=h===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new JB(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){var o,l;if(this.cancelled)return;if(this._canvas){if(x(ku,ld).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");x(ku,ld).add(this._canvas)}this._pdfBug&&((o=globalThis.StepperManager)!=null&&o.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:i,viewport:s,transform:r,background:a}=this.params;this.gfx=new r1(i,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:r,viewport:s,transparency:e,background:a}),this.operatorListIdx=0,this.graphicsReady=!0,(l=this.graphicsReadyCallback)==null||l.call(this)}cancel(e=null,t=0){var i,s,r;this.running=!1,this.cancelled=!0,(i=this.gfx)==null||i.endDrawing(),x(this,hh)&&(window.cancelAnimationFrame(x(this,hh)),O(this,hh,null)),x(ku,ld).delete(this._canvas),e||(e=new m4(`Rendering cancelled, page ${this._pageIndex+1}`,t)),this.callback(e),(r=(s=this.task).onError)==null||r.call(s,e)}operatorListChanged(){var e;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(e=this.stepper)==null||e.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?O(this,hh,window.requestAnimationFrame(()=>{O(this,hh,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),x(ku,ld).delete(this._canvas),this.callback())))}};hh=new WeakMap,ld=new WeakMap,U(ku,ld,new WeakSet);let V8=ku;const ZB="5.3.93",QB="cbeef3233";function Gv(n){return Math.floor(Math.max(0,Math.min(1,n))*255).toString(16).padStart(2,"0")}function Rm(n){return Math.max(0,Math.min(255,255*n))}class Vv{static CMYK_G([e,t,i,s]){return["G",1-Math.min(1,.3*e+.59*i+.11*t+s)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=Rm(e),[e,e,e]}static G_HTML([e]){const t=Gv(e);return`#${t}${t}${t}`}static RGB_G([e,t,i]){return["G",.3*e+.59*t+.11*i]}static RGB_rgb(e){return e.map(Rm)}static RGB_HTML(e){return`#${e.map(Gv).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,i,s]){return["RGB",1-Math.min(1,e+s),1-Math.min(1,i+s),1-Math.min(1,t+s)]}static CMYK_rgb([e,t,i,s]){return[Rm(1-Math.min(1,e+s)),Rm(1-Math.min(1,i+s)),Rm(1-Math.min(1,t+s))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,i]){const s=1-e,r=1-t,a=1-i,o=Math.min(s,r,a);return["CMYK",s,r,a,o]}}class $B{create(e,t,i=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const s=this._createSVG("svg:svg");return s.setAttribute("version","1.1"),i||(s.setAttribute("width",`${e}px`),s.setAttribute("height",`${t}px`)),s.setAttribute("preserveAspectRatio","none"),s.setAttribute("viewBox",`0 0 ${e} ${t}`),s}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){bi("Abstract method `_createSVG` called.")}}class S3 extends $B{_createSVG(e){return document.createElementNS(bc,e)}}class dT{static setupStorage(e,t,i,s,r){const a=s.getValue(t,{value:null});switch(i.name){case"textarea":if(a.value!==null&&(e.textContent=a.value),r==="print")break;e.addEventListener("input",o=>{s.setValue(t,{value:o.target.value})});break;case"input":if(i.attributes.type==="radio"||i.attributes.type==="checkbox"){if(a.value===i.attributes.xfaOn?e.setAttribute("checked",!0):a.value===i.attributes.xfaOff&&e.removeAttribute("checked"),r==="print")break;e.addEventListener("change",o=>{s.setValue(t,{value:o.target.checked?o.target.getAttribute("xfaOn"):o.target.getAttribute("xfaOff")})})}else{if(a.value!==null&&e.setAttribute("value",a.value),r==="print")break;e.addEventListener("input",o=>{s.setValue(t,{value:o.target.value})})}break;case"select":if(a.value!==null){e.setAttribute("value",a.value);for(const o of i.children)o.attributes.value===a.value?o.attributes.selected=!0:o.attributes.hasOwnProperty("selected")&&delete o.attributes.selected}e.addEventListener("input",o=>{const l=o.target.options,c=l.selectedIndex===-1?"":l[l.selectedIndex].value;s.setValue(t,{value:c})});break}}static setAttributes({html:e,element:t,storage:i=null,intent:s,linkService:r}){const{attributes:a}=t,o=e instanceof HTMLAnchorElement;a.type==="radio"&&(a.name=`${a.name}-${s}`);for(const[l,c]of Object.entries(a))if(c!=null)switch(l){case"class":c.length&&e.setAttribute(l,c.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",c);break;case"style":Object.assign(e.style,c);break;case"textContent":e.textContent=c;break;default:(!o||l!=="href"&&l!=="newWindow")&&e.setAttribute(l,c)}o&&r.addLinkAttributes(e,a.href,a.newWindow),i&&a.dataId&&this.setupStorage(e,a.dataId,t,i)}static render(e){var u,d;const t=e.annotationStorage,i=e.linkService,s=e.xfaHtml,r=e.intent||"display",a=document.createElement(s.name);s.attributes&&this.setAttributes({html:a,element:s,intent:r,linkService:i});const o=r!=="richText",l=e.div;if(l.append(a),e.viewport){const f=`matrix(${e.viewport.transform.join(",")})`;l.style.transform=f}o&&l.setAttribute("class","xfaLayer xfaFont");const c=[];if(s.children.length===0){if(s.value){const f=document.createTextNode(s.value);a.append(f),o&&Up.shouldBuildText(s.name)&&c.push(f)}return{textDivs:c}}const h=[[s,-1,a]];for(;h.length>0;){const[f,g,m]=h.at(-1);if(g+1===f.children.length){h.pop();continue}const b=f.children[++h.at(-1)[1]];if(b===null)continue;const{name:p}=b;if(p==="#text"){const w=document.createTextNode(b.value);c.push(w),m.append(w);continue}const y=(u=b==null?void 0:b.attributes)!=null&&u.xmlns?document.createElementNS(b.attributes.xmlns,p):document.createElement(p);if(m.append(y),b.attributes&&this.setAttributes({html:y,element:b,storage:t,intent:r,linkService:i}),((d=b.children)==null?void 0:d.length)>0)h.push([b,-1,y]);else if(b.value){const w=document.createTextNode(b.value);o&&Up.shouldBuildText(p)&&c.push(w),y.append(w)}}for(const f of l.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))f.setAttribute("readOnly",!0);return{textDivs:c}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const eU=9,$d=new WeakSet;class qv{static create(e){switch(e.data.annotationType){case bs.LINK:return new fT(e);case bs.TEXT:return new tU(e);case bs.WIDGET:switch(e.data.fieldType){case"Tx":return new nU(e);case"Btn":return e.data.radioButton?new pT(e):e.data.checkBox?new sU(e):new rU(e);case"Ch":return new aU(e);case"Sig":return new iU(e)}return new gf(e);case bs.POPUP:return new W8(e);case bs.FREETEXT:return new _T(e);case bs.LINE:return new lU(e);case bs.SQUARE:return new cU(e);case bs.CIRCLE:return new hU(e);case bs.POLYLINE:return new vT(e);case bs.CARET:return new dU(e);case bs.INK:return new v4(e);case bs.POLYGON:return new uU(e);case bs.HIGHLIGHT:return new kT(e);case bs.UNDERLINE:return new fU(e);case bs.SQUIGGLY:return new gU(e);case bs.STRIKEOUT:return new mU(e);case bs.STAMP:return new CT(e);case bs.FILEATTACHMENT:return new pU(e);default:return new us(e)}}}var cd,K1,X1,lb,q8;const ev=class ev{constructor(e,{isRenderable:t=!1,ignoreBorder:i=!1,createQuadrilaterals:s=!1}={}){U(this,lb);U(this,cd,null);U(this,K1,!1);U(this,X1,null);this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(i)),s&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:e,richText:t}){return!!(e!=null&&e.str||t!=null&&t.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return ev._hasPopupData(this.data)}updateEdited(e){var i;if(!this.container)return;x(this,cd)||O(this,cd,{rect:this.data.rect.slice(0)});const{rect:t}=e;t&&F(this,lb,q8).call(this,t),(i=x(this,X1))==null||i.popup.updateEdited(e)}resetEdited(){var e;x(this,cd)&&(F(this,lb,q8).call(this,x(this,cd).rect),(e=x(this,X1))==null||e.popup.resetEdited(),O(this,cd,null))}_createContainer(e){const{data:t,parent:{page:i,viewport:s}}=this,r=document.createElement("section");r.setAttribute("data-annotation-id",t.id),this instanceof gf||(r.tabIndex=0);const{style:a}=r;if(a.zIndex=this.parent.zIndex++,t.alternativeText&&(r.title=t.alternativeText),t.noRotate&&r.classList.add("norotate"),!t.rect||this instanceof W8){const{rotation:m}=t;return!t.hasOwnCanvas&&m!==0&&this.setRotation(m,r),r}const{width:o,height:l}=this;if(!e&&t.borderStyle.width>0){a.borderWidth=`${t.borderStyle.width}px`;const m=t.borderStyle.horizontalCornerRadius,b=t.borderStyle.verticalCornerRadius;if(m>0||b>0){const y=`calc(${m}px * var(--total-scale-factor)) / calc(${b}px * var(--total-scale-factor))`;a.borderRadius=y}else if(this instanceof pT){const y=`calc(${o}px * var(--total-scale-factor)) / calc(${l}px * var(--total-scale-factor))`;a.borderRadius=y}switch(t.borderStyle.style){case Af.SOLID:a.borderStyle="solid";break;case Af.DASHED:a.borderStyle="dashed";break;case Af.BEVELED:vn("Unimplemented border style: beveled");break;case Af.INSET:vn("Unimplemented border style: inset");break;case Af.UNDERLINE:a.borderBottomStyle="solid";break}const p=t.borderColor||null;p?(O(this,K1,!0),a.borderColor=sn.makeHexColor(p[0]|0,p[1]|0,p[2]|0)):a.borderWidth=0}const c=sn.normalizeRect([t.rect[0],i.view[3]-t.rect[1]+i.view[1],t.rect[2],i.view[3]-t.rect[3]+i.view[1]]),{pageWidth:h,pageHeight:u,pageX:d,pageY:f}=s.rawDims;a.left=`${100*(c[0]-d)/h}%`,a.top=`${100*(c[1]-f)/u}%`;const{rotation:g}=t;return t.hasOwnCanvas||g===0?(a.width=`${100*o/h}%`,a.height=`${100*l/u}%`):this.setRotation(g,r),r}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:i,pageHeight:s}=this.parent.viewport.rawDims;let{width:r,height:a}=this;e%180!==0&&([r,a]=[a,r]),t.style.width=`${100*r/i}%`,t.style.height=`${100*a/s}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,i,s)=>{const r=s.detail[t],a=r[0],o=r.slice(1);s.target.style[i]=Vv[`${a}_HTML`](o),this.annotationStorage.setValue(this.data.id,{[i]:Vv[`${a}_rgb`](o)})};return zn(this,"_commonActions",{display:t=>{const{display:i}=t.detail,s=i%2===1;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:s,noPrint:i===1||i===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:i}=t.detail;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:i,noView:i})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const i=t.detail.rotation;this.setRotation(i),this.annotationStorage.setValue(this.data.id,{rotation:i})}})}_dispatchEventFromSandbox(e,t){const i=this._commonActions;for(const s of Object.keys(t.detail)){const r=e[s]||i[s];r==null||r(t)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const i=this._commonActions;for(const[s,r]of Object.entries(t)){const a=i[s];if(a){const o={detail:{[s]:r},target:e};a(o),delete t[s]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,i,s,r]=this.data.rect.map(m=>Math.fround(m));if(e.length===8){const[m,b,p,y]=e.subarray(2,6);if(s===m&&r===b&&t===p&&i===y)return}const{style:a}=this.container;let o;if(x(this,K1)){const{borderColor:m,borderWidth:b}=a;a.borderWidth=0,o=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${m}" stroke-width="${b}">`],this.container.classList.add("hasBorder")}const l=s-t,c=r-i,{svgFactory:h}=this,u=h.createElement("svg");u.classList.add("quadrilateralsContainer"),u.setAttribute("width",0),u.setAttribute("height",0),u.role="none";const d=h.createElement("defs");u.append(d);const f=h.createElement("clipPath"),g=`clippath_${this.data.id}`;f.setAttribute("id",g),f.setAttribute("clipPathUnits","objectBoundingBox"),d.append(f);for(let m=2,b=e.length;m<b;m+=8){const p=e[m],y=e[m+1],w=e[m+2],_=e[m+3],v=h.createElement("rect"),C=(w-t)/l,k=(r-y)/c,I=(p-w)/l,E=(y-_)/c;v.setAttribute("x",C),v.setAttribute("y",k),v.setAttribute("width",I),v.setAttribute("height",E),f.append(v),o==null||o.push(`<rect vector-effect="non-scaling-stroke" x="${C}" y="${k}" width="${I}" height="${E}"/>`)}x(this,K1)&&(o.push("</g></svg>')"),a.backgroundImage=o.join("")),this.container.append(u),this.container.style.clipPath=`url(#${g})`}_createPopup(){const{data:e}=this,t=O(this,X1,new W8({data:{color:e.color,titleObj:e.titleObj,modificationDate:e.modificationDate,contentsObj:e.contentsObj,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation,noRotate:!0},parent:this.parent,elements:[this]}));this.parent.div.append(t.render())}render(){bi("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const i=[];if(this._fieldObjects){const s=this._fieldObjects[e];if(s)for(const{page:r,id:a,exportValues:o}of s){if(r===-1||a===t)continue;const l=typeof o=="string"?o:null,c=document.querySelector(`[data-element-id="${a}"]`);if(c&&!$d.has(c)){vn(`_getElementsByName - element not allowed: ${a}`);continue}i.push({id:a,exportValue:l,domElement:c})}return i}for(const s of document.getElementsByName(e)){const{exportValue:r}=s,a=s.getAttribute("data-element-id");a!==t&&$d.has(s)&&i.push({id:a,exportValue:r,domElement:s})}return i}show(){var e;this.container&&(this.container.hidden=!1),(e=this.popup)==null||e.maybeShow()}hide(){var e;this.container&&(this.container.hidden=!0),(e=this.popup)==null||e.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{var i;(i=this.linkService.eventBus)==null||i.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}};cd=new WeakMap,K1=new WeakMap,X1=new WeakMap,lb=new WeakSet,q8=function(e){const{container:{style:t},data:{rect:i,rotation:s},parent:{viewport:{rawDims:{pageWidth:r,pageHeight:a,pageX:o,pageY:l}}}}=this;i==null||i.splice(0,4,...e),t.left=`${100*(e[0]-o)/r}%`,t.top=`${100*(a-e[3]+l)/a}%`,s===0?(t.width=`${100*(e[2]-e[0])/r}%`,t.height=`${100*(e[3]-e[1])/a}%`):this.setRotation(s)};let us=ev;var Xa,uu,gT,mT;class fT extends us{constructor(t,i=null){super(t,{isRenderable:!0,ignoreBorder:!!(i!=null&&i.ignoreBorder),createQuadrilaterals:!0});U(this,Xa);this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:i}=this,s=document.createElement("a");s.setAttribute("data-element-id",t.id);let r=!1;return t.url?(i.addLinkAttributes(s,t.url,t.newWindow),r=!0):t.action?(this._bindNamedAction(s,t.action),r=!0):t.attachment?(F(this,Xa,gT).call(this,s,t.attachment,t.attachmentDest),r=!0):t.setOCGState?(F(this,Xa,mT).call(this,s,t.setOCGState),r=!0):t.dest?(this._bindLink(s,t.dest),r=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(s,t),r=!0),t.resetForm?(this._bindResetFormAction(s,t.resetForm),r=!0):this.isTooltipOnly&&!r&&(this._bindLink(s,""),r=!0)),this.container.classList.add("linkAnnotation"),r&&this.container.append(s),this.container}_bindLink(t,i){t.href=this.linkService.getDestinationHash(i),t.onclick=()=>(i&&this.linkService.goToDestination(i),!1),(i||i==="")&&F(this,Xa,uu).call(this)}_bindNamedAction(t,i){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(i),!1),F(this,Xa,uu).call(this)}_bindJSAction(t,i){t.href=this.linkService.getAnchorUrl("");const s=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const r of Object.keys(i.actions)){const a=s.get(r);a&&(t[a]=()=>{var o;return(o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i.id,name:r}}),!1})}t.onclick||(t.onclick=()=>!1),F(this,Xa,uu).call(this)}_bindResetFormAction(t,i){const s=t.onclick;if(s||(t.href=this.linkService.getAnchorUrl("")),F(this,Xa,uu).call(this),!this._fieldObjects){vn('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),s||(t.onclick=()=>!1);return}t.onclick=()=>{var u;s==null||s();const{fields:r,refs:a,include:o}=i,l=[];if(r.length!==0||a.length!==0){const d=new Set(a);for(const f of r){const g=this._fieldObjects[f]||[];for(const{id:m}of g)d.add(m)}for(const f of Object.values(this._fieldObjects))for(const g of f)d.has(g.id)===o&&l.push(g)}else for(const d of Object.values(this._fieldObjects))l.push(...d);const c=this.annotationStorage,h=[];for(const d of l){const{id:f}=d;switch(h.push(f),d.type){case"text":{const m=d.defaultValue||"";c.setValue(f,{value:m});break}case"checkbox":case"radiobutton":{const m=d.defaultValue===d.exportValues;c.setValue(f,{value:m});break}case"combobox":case"listbox":{const m=d.defaultValue||"";c.setValue(f,{value:m});break}default:continue}const g=document.querySelector(`[data-element-id="${f}"]`);if(g){if(!$d.has(g)){vn(`_bindResetFormAction - element not allowed: ${f}`);continue}}else continue;g.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((u=this.linkService.eventBus)==null||u.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:h,name:"ResetForm"}})),!1}}}Xa=new WeakSet,uu=function(){this.container.setAttribute("data-internal-link","")},gT=function(t,i,s=null){t.href=this.linkService.getAnchorUrl(""),i.description&&(t.title=i.description),t.onclick=()=>{var r;return(r=this.downloadManager)==null||r.openOrDownloadData(i.content,i.filename,s),!1},F(this,Xa,uu).call(this)},mT=function(t,i){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(i),!1),F(this,Xa,uu).call(this)};class tU extends us{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}}class gf extends us{render(){return this.container}showElementAndHideCanvas(e){var t;this.data.hasOwnCanvas&&(((t=e.previousSibling)==null?void 0:t.nodeName)==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return br.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,i,s,r){i.includes("mouse")?e.addEventListener(i,a=>{var o;(o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:r(a),shift:a.shiftKey,modifier:this._getKeyModifier(a)}})}):e.addEventListener(i,a=>{var o;if(i==="blur"){if(!t.focused||!a.relatedTarget)return;t.focused=!1}else if(i==="focus"){if(t.focused)return;t.focused=!0}r&&((o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:r(a)}}))})}_setEventListeners(e,t,i,s){var r,a,o;for(const[l,c]of i)(c==="Action"||(r=this.data.actions)!=null&&r[c])&&((c==="Focus"||c==="Blur")&&(t||(t={focused:!1})),this._setEventListener(e,t,l,c,s),c==="Focus"&&!((a=this.data.actions)!=null&&a.Blur)?this._setEventListener(e,t,"blur","Blur",null):c==="Blur"&&!((o=this.data.actions)!=null&&o.Focus)&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":sn.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:i}=this.data.defaultAppearanceData,s=this.data.defaultAppearanceData.fontSize||eU,r=e.style;let a;const o=2,l=c=>Math.round(10*c)/10;if(this.data.multiLine){const c=Math.abs(this.data.rect[3]-this.data.rect[1]-o),h=Math.round(c/(dw*s))||1,u=c/h;a=Math.min(s,l(u/dw))}else{const c=Math.abs(this.data.rect[3]-this.data.rect[1]-o);a=Math.min(s,l(c/dw))}r.fontSize=`calc(${a}px * var(--total-scale-factor))`,r.color=sn.makeHexColor(i[0],i[1],i[2]),this.data.textAlignment!==null&&(r.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class nU extends gf{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,i,s){const r=this.annotationStorage;for(const a of this._getElementsByName(e.name,e.id))a.domElement&&(a.domElement[t]=i),r.setValue(a.id,{[s]:i})}render(){var s,r;const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let i=null;if(this.renderForms){const a=e.getValue(t,{value:this.data.fieldValue});let o=a.value||"";const l=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;l&&o.length>l&&(o=o.slice(0,l));let c=a.formattedValue||((s=this.data.textContent)==null?void 0:s.join(`
`))||null;c&&this.data.comb&&(c=c.replaceAll(/\s+/g,""));const h={userValue:o,formattedValue:c,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(i=document.createElement("textarea"),i.textContent=c??o,this.data.doNotScroll&&(i.style.overflowY="hidden")):(i=document.createElement("input"),i.type=this.data.password?"password":"text",i.setAttribute("value",c??o),this.data.doNotScroll&&(i.style.overflowX="hidden")),this.data.hasOwnCanvas&&(i.hidden=!0),$d.add(i),i.setAttribute("data-element-id",t),i.disabled=this.data.readOnly,i.name=this.data.fieldName,i.tabIndex=0;const u=this.data.dateFormat||this.data.timeFormat;u&&(i.title=u),this._setRequired(i,this.data.required),l&&(i.maxLength=l),i.addEventListener("input",f=>{e.setValue(t,{value:f.target.value}),this.setPropertyOnSiblings(i,"value",f.target.value,"value"),h.formattedValue=null}),i.addEventListener("resetform",f=>{const g=this.data.defaultFieldValue??"";i.value=h.userValue=g,h.formattedValue=null});let d=f=>{const{formattedValue:g}=h;g!=null&&(f.target.value=g),f.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){i.addEventListener("focus",g=>{var b;if(h.focused)return;const{target:m}=g;h.userValue&&(m.value=h.userValue),h.lastCommittedValue=m.value,h.commitKey=1,(b=this.data.actions)!=null&&b.Focus||(h.focused=!0)}),i.addEventListener("updatefromsandbox",g=>{this.showElementAndHideCanvas(g.target);const m={value(b){h.userValue=b.detail.value??"",e.setValue(t,{value:h.userValue.toString()}),b.target.value=h.userValue},formattedValue(b){const{formattedValue:p}=b.detail;h.formattedValue=p,p!=null&&b.target!==document.activeElement&&(b.target.value=p),e.setValue(t,{formattedValue:p})},selRange(b){b.target.setSelectionRange(...b.detail.selRange)},charLimit:b=>{var _;const{charLimit:p}=b.detail,{target:y}=b;if(p===0){y.removeAttribute("maxLength");return}y.setAttribute("maxLength",p);let w=h.userValue;!w||w.length<=p||(w=w.slice(0,p),y.value=h.userValue=w,e.setValue(t,{value:w}),(_=this.linkService.eventBus)==null||_.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:w,willCommit:!0,commitKey:1,selStart:y.selectionStart,selEnd:y.selectionEnd}}))}};this._dispatchEventFromSandbox(m,g)}),i.addEventListener("keydown",g=>{var p;h.commitKey=1;let m=-1;if(g.key==="Escape"?m=0:g.key==="Enter"&&!this.data.multiLine?m=2:g.key==="Tab"&&(h.commitKey=3),m===-1)return;const{value:b}=g.target;h.lastCommittedValue!==b&&(h.lastCommittedValue=b,h.userValue=b,(p=this.linkService.eventBus)==null||p.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:b,willCommit:!0,commitKey:m,selStart:g.target.selectionStart,selEnd:g.target.selectionEnd}}))});const f=d;d=null,i.addEventListener("blur",g=>{var b,p;if(!h.focused||!g.relatedTarget)return;(b=this.data.actions)!=null&&b.Blur||(h.focused=!1);const{value:m}=g.target;h.userValue=m,h.lastCommittedValue!==m&&((p=this.linkService.eventBus)==null||p.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:m,willCommit:!0,commitKey:h.commitKey,selStart:g.target.selectionStart,selEnd:g.target.selectionEnd}})),f(g)}),(r=this.data.actions)!=null&&r.Keystroke&&i.addEventListener("beforeinput",g=>{var C;h.lastCommittedValue=null;const{data:m,target:b}=g,{value:p,selectionStart:y,selectionEnd:w}=b;let _=y,v=w;switch(g.inputType){case"deleteWordBackward":{const k=p.substring(0,y).match(/\w*[^\w]*$/);k&&(_-=k[0].length);break}case"deleteWordForward":{const k=p.substring(y).match(/^[^\w]*\w*/);k&&(v+=k[0].length);break}case"deleteContentBackward":y===w&&(_-=1);break;case"deleteContentForward":y===w&&(v+=1);break}g.preventDefault(),(C=this.linkService.eventBus)==null||C.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:p,change:m||"",willCommit:!1,selStart:_,selEnd:v}})}),this._setEventListeners(i,h,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],g=>g.target.value)}if(d&&i.addEventListener("blur",d),this.data.comb){const g=(this.data.rect[2]-this.data.rect[0])/l;i.classList.add("comb"),i.style.letterSpacing=`calc(${g}px * var(--total-scale-factor) - 1ch)`}}else i=document.createElement("div"),i.textContent=this.data.fieldValue,i.style.verticalAlign="middle",i.style.display="table-cell",this.data.hasOwnCanvas&&(i.hidden=!0);return this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class iU extends gf{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class sU extends gf{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,i=t.id;let s=e.getValue(i,{value:t.exportValue===t.fieldValue}).value;typeof s=="string"&&(s=s!=="Off",e.setValue(i,{value:s})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const r=document.createElement("input");return $d.add(r),r.setAttribute("data-element-id",i),r.disabled=t.readOnly,this._setRequired(r,this.data.required),r.type="checkbox",r.name=t.fieldName,s&&r.setAttribute("checked",!0),r.setAttribute("exportValue",t.exportValue),r.tabIndex=0,r.addEventListener("change",a=>{const{name:o,checked:l}=a.target;for(const c of this._getElementsByName(o,i)){const h=l&&c.exportValue===t.exportValue;c.domElement&&(c.domElement.checked=h),e.setValue(c.id,{value:h})}e.setValue(i,{value:l})}),r.addEventListener("resetform",a=>{const o=t.defaultFieldValue||"Off";a.target.checked=o===t.exportValue}),this.enableScripting&&this.hasJSActions&&(r.addEventListener("updatefromsandbox",a=>{const o={value(l){l.target.checked=l.detail.value!=="Off",e.setValue(i,{value:l.target.checked})}};this._dispatchEventFromSandbox(o,a)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class pT extends gf{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,i=t.id;let s=e.getValue(i,{value:t.fieldValue===t.buttonValue}).value;if(typeof s=="string"&&(s=s!==t.buttonValue,e.setValue(i,{value:s})),s)for(const a of this._getElementsByName(t.fieldName,i))e.setValue(a.id,{value:!1});const r=document.createElement("input");if($d.add(r),r.setAttribute("data-element-id",i),r.disabled=t.readOnly,this._setRequired(r,this.data.required),r.type="radio",r.name=t.fieldName,s&&r.setAttribute("checked",!0),r.tabIndex=0,r.addEventListener("change",a=>{const{name:o,checked:l}=a.target;for(const c of this._getElementsByName(o,i))e.setValue(c.id,{value:!1});e.setValue(i,{value:l})}),r.addEventListener("resetform",a=>{const o=t.defaultFieldValue;a.target.checked=o!=null&&o===t.buttonValue}),this.enableScripting&&this.hasJSActions){const a=t.buttonValue;r.addEventListener("updatefromsandbox",o=>{const l={value:c=>{const h=a===c.detail.value;for(const u of this._getElementsByName(c.target.name)){const d=h&&u.id===i;u.domElement&&(u.domElement.checked=d),e.setValue(u.id,{value:d})}}};this._dispatchEventFromSandbox(l,o)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)}return this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class rU extends fT{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",i=>{this._dispatchEventFromSandbox({},i)})),e}}class aU extends gf{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,i=e.getValue(t,{value:this.data.fieldValue}),s=document.createElement("select");$d.add(s),s.setAttribute("data-element-id",t),s.disabled=this.data.readOnly,this._setRequired(s,this.data.required),s.name=this.data.fieldName,s.tabIndex=0;let r=this.data.combo&&this.data.options.length>0;this.data.combo||(s.size=this.data.options.length,this.data.multiSelect&&(s.multiple=!0)),s.addEventListener("resetform",h=>{const u=this.data.defaultFieldValue;for(const d of s.options)d.selected=d.value===u});for(const h of this.data.options){const u=document.createElement("option");u.textContent=h.displayValue,u.value=h.exportValue,i.value.includes(h.exportValue)&&(u.setAttribute("selected",!0),r=!1),s.append(u)}let a=null;if(r){const h=document.createElement("option");h.value=" ",h.setAttribute("hidden",!0),h.setAttribute("selected",!0),s.prepend(h),a=()=>{h.remove(),s.removeEventListener("input",a),a=null},s.addEventListener("input",a)}const o=h=>{const u=h?"value":"textContent",{options:d,multiple:f}=s;return f?Array.prototype.filter.call(d,g=>g.selected).map(g=>g[u]):d.selectedIndex===-1?null:d[d.selectedIndex][u]};let l=o(!1);const c=h=>{const u=h.target.options;return Array.prototype.map.call(u,d=>({displayValue:d.textContent,exportValue:d.value}))};return this.enableScripting&&this.hasJSActions?(s.addEventListener("updatefromsandbox",h=>{const u={value(d){a==null||a();const f=d.detail.value,g=new Set(Array.isArray(f)?f:[f]);for(const m of s.options)m.selected=g.has(m.value);e.setValue(t,{value:o(!0)}),l=o(!1)},multipleSelection(d){s.multiple=!0},remove(d){const f=s.options,g=d.detail.remove;f[g].selected=!1,s.remove(g),f.length>0&&Array.prototype.findIndex.call(f,b=>b.selected)===-1&&(f[0].selected=!0),e.setValue(t,{value:o(!0),items:c(d)}),l=o(!1)},clear(d){for(;s.length!==0;)s.remove(0);e.setValue(t,{value:null,items:[]}),l=o(!1)},insert(d){const{index:f,displayValue:g,exportValue:m}=d.detail.insert,b=s.children[f],p=document.createElement("option");p.textContent=g,p.value=m,b?b.before(p):s.append(p),e.setValue(t,{value:o(!0),items:c(d)}),l=o(!1)},items(d){const{items:f}=d.detail;for(;s.length!==0;)s.remove(0);for(const g of f){const{displayValue:m,exportValue:b}=g,p=document.createElement("option");p.textContent=m,p.value=b,s.append(p)}s.options.length>0&&(s.options[0].selected=!0),e.setValue(t,{value:o(!0),items:c(d)}),l=o(!1)},indices(d){const f=new Set(d.detail.indices);for(const g of d.target.options)g.selected=f.has(g.index);e.setValue(t,{value:o(!0)}),l=o(!1)},editable(d){d.target.disabled=!d.detail.editable}};this._dispatchEventFromSandbox(u,h)}),s.addEventListener("input",h=>{var f;const u=o(!0),d=o(!1);e.setValue(t,{value:u}),h.preventDefault(),(f=this.linkService.eventBus)==null||f.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:l,change:d,changeEx:u,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(s,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],h=>h.target.value)):s.addEventListener("input",function(h){e.setValue(t,{value:o(!0)})}),this.data.combo&&this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class W8 extends us{constructor(e){const{data:t,elements:i}=e;super(e,{isRenderable:us._hasPopupData(t)}),this.elements=i,this.popup=null}render(){const{container:e}=this;e.classList.add("popupAnnotation"),e.role="comment";const t=this.popup=new oU({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),i=[];for(const s of this.elements)s.popup=t,s.container.ariaHasPopup="dialog",i.push(s.data.id),s.addHighlightArea();return this.container.setAttribute("aria-controls",i.map(s=>`${g4}${s}`).join(",")),this.container}}var Y1,R5,M5,J1,Z1,Zi,qc,hd,cb,hb,Q1,Wc,zo,Kc,ub,Xc,db,ud,dd,xi,B9,K8,bT,xT,yT,wT,U9,H9,X8;class oU{constructor({container:e,color:t,elements:i,titleObj:s,modificationDate:r,contentsObj:a,richText:o,parent:l,rect:c,parentRect:h,open:u}){U(this,xi);U(this,Y1,F(this,xi,yT).bind(this));U(this,R5,F(this,xi,X8).bind(this));U(this,M5,F(this,xi,H9).bind(this));U(this,J1,F(this,xi,U9).bind(this));U(this,Z1,null);U(this,Zi,null);U(this,qc,null);U(this,hd,null);U(this,cb,null);U(this,hb,null);U(this,Q1,null);U(this,Wc,!1);U(this,zo,null);U(this,Kc,null);U(this,ub,null);U(this,Xc,null);U(this,db,null);U(this,ud,null);U(this,dd,!1);var d;O(this,Zi,e),O(this,db,s),O(this,qc,a),O(this,Xc,o),O(this,hb,l),O(this,Z1,t),O(this,ub,c),O(this,Q1,h),O(this,cb,i),O(this,hd,b4.toDateObject(r)),this.trigger=i.flatMap(f=>f.getElementsToTriggerPopup());for(const f of this.trigger)f.addEventListener("click",x(this,J1)),f.addEventListener("mouseenter",x(this,M5)),f.addEventListener("mouseleave",x(this,R5)),f.classList.add("popupTriggerArea");for(const f of i)(d=f.container)==null||d.addEventListener("keydown",x(this,Y1));x(this,Zi).hidden=!0,u&&F(this,xi,U9).call(this)}render(){if(x(this,zo))return;const e=O(this,zo,document.createElement("div"));if(e.className="popup",x(this,Z1)){const r=e.style.outlineColor=sn.makeHexColor(...x(this,Z1));e.style.backgroundColor=`color-mix(in srgb, ${r} 30%, white)`}const t=document.createElement("span");t.className="header";const i=document.createElement("h1");if(t.append(i),{dir:i.dir,str:i.textContent}=x(this,db),e.append(t),x(this,hd)){const r=document.createElement("time");r.classList.add("popupDate"),r.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),r.setAttribute("data-l10n-args",JSON.stringify({dateObj:x(this,hd).valueOf()})),r.dateTime=x(this,hd).toISOString(),t.append(r)}const s=x(this,xi,B9);if(s)dT.render({xfaHtml:s,intent:"richText",div:e}),e.lastChild.classList.add("richText","popupContent");else{const r=this._formatContents(x(this,qc));e.append(r)}x(this,Zi).append(e)}_formatContents({str:e,dir:t}){const i=document.createElement("p");i.classList.add("popupContent"),i.dir=t;const s=e.split(/(?:\r\n?|\n)/);for(let r=0,a=s.length;r<a;++r){const o=s[r];i.append(document.createTextNode(o)),r<a-1&&i.append(document.createElement("br"))}return i}updateEdited({rect:e,popupContent:t}){var i;x(this,ud)||O(this,ud,{contentsObj:x(this,qc),richText:x(this,Xc)}),e&&O(this,Kc,null),t&&(O(this,Xc,F(this,xi,xT).call(this,t)),O(this,qc,null)),(i=x(this,zo))==null||i.remove(),O(this,zo,null)}resetEdited(){var e;x(this,ud)&&({contentsObj:Fr(this,qc)._,richText:Fr(this,Xc)._}=x(this,ud),O(this,ud,null),(e=x(this,zo))==null||e.remove(),O(this,zo,null),O(this,Kc,null))}forceHide(){O(this,dd,this.isVisible),x(this,dd)&&(x(this,Zi).hidden=!0)}maybeShow(){x(this,dd)&&(x(this,zo)||F(this,xi,H9).call(this),O(this,dd,!1),x(this,Zi).hidden=!1)}get isVisible(){return x(this,Zi).hidden===!1}}Y1=new WeakMap,R5=new WeakMap,M5=new WeakMap,J1=new WeakMap,Z1=new WeakMap,Zi=new WeakMap,qc=new WeakMap,hd=new WeakMap,cb=new WeakMap,hb=new WeakMap,Q1=new WeakMap,Wc=new WeakMap,zo=new WeakMap,Kc=new WeakMap,ub=new WeakMap,Xc=new WeakMap,db=new WeakMap,ud=new WeakMap,dd=new WeakMap,xi=new WeakSet,B9=function(){const e=x(this,Xc),t=x(this,qc);return e!=null&&e.str&&(!(t!=null&&t.str)||t.str===e.str)&&x(this,Xc).html||null},K8=function(){var e,t,i;return((i=(t=(e=x(this,xi,B9))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:i.fontSize)||0},bT=function(){var e,t,i;return((i=(t=(e=x(this,xi,B9))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:i.color)||null},xT=function(e){const t=[],i={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},s={style:{color:x(this,xi,bT),fontSize:x(this,xi,K8)?`calc(${x(this,xi,K8)}px * var(--total-scale-factor))`:""}};for(const r of e.split(`
`))t.push({name:"span",value:r,attributes:s});return i},yT=function(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&x(this,Wc))&&F(this,xi,U9).call(this)},wT=function(){if(x(this,Kc)!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:i,pageX:s,pageY:r}}}=x(this,hb);let a=!!x(this,Q1),o=a?x(this,Q1):x(this,ub);for(const g of x(this,cb))if(!o||sn.intersect(g.data.rect,o)!==null){o=g.data.rect,a=!0;break}const l=sn.normalizeRect([o[0],e[3]-o[1]+e[1],o[2],e[3]-o[3]+e[1]]),h=a?o[2]-o[0]+5:0,u=l[0]+h,d=l[1];O(this,Kc,[100*(u-s)/t,100*(d-r)/i]);const{style:f}=x(this,Zi);f.left=`${x(this,Kc)[0]}%`,f.top=`${x(this,Kc)[1]}%`},U9=function(){O(this,Wc,!x(this,Wc)),x(this,Wc)?(F(this,xi,H9).call(this),x(this,Zi).addEventListener("click",x(this,J1)),x(this,Zi).addEventListener("keydown",x(this,Y1))):(F(this,xi,X8).call(this),x(this,Zi).removeEventListener("click",x(this,J1)),x(this,Zi).removeEventListener("keydown",x(this,Y1)))},H9=function(){x(this,zo)||this.render(),this.isVisible?x(this,Wc)&&x(this,Zi).classList.add("focused"):(F(this,xi,wT).call(this),x(this,Zi).hidden=!1,x(this,Zi).style.zIndex=parseInt(x(this,Zi).style.zIndex)+1e3)},X8=function(){x(this,Zi).classList.remove("focused"),!(x(this,Wc)||!this.isVisible)&&(x(this,Zi).hidden=!0,x(this,Zi).style.zIndex=parseInt(x(this,Zi).style.zIndex)-1e3)};class _T extends us{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=_n.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const i=document.createElement("span");i.textContent=t,e.append(i)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var fb;class lU extends us{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});U(this,fb,null)}render(){this.container.classList.add("lineAnnotation");const{data:t,width:i,height:s}=this,r=this.svgFactory.create(i,s,!0),a=O(this,fb,this.svgFactory.createElement("svg:line"));return a.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),a.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),a.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),a.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),a.setAttribute("stroke-width",t.borderStyle.width||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),r.append(a),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return x(this,fb)}addHighlightArea(){this.container.classList.add("highlightArea")}}fb=new WeakMap;var gb;class cU extends us{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});U(this,gb,null)}render(){this.container.classList.add("squareAnnotation");const{data:t,width:i,height:s}=this,r=this.svgFactory.create(i,s,!0),a=t.borderStyle.width,o=O(this,gb,this.svgFactory.createElement("svg:rect"));return o.setAttribute("x",a/2),o.setAttribute("y",a/2),o.setAttribute("width",i-a),o.setAttribute("height",s-a),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),r.append(o),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return x(this,gb)}addHighlightArea(){this.container.classList.add("highlightArea")}}gb=new WeakMap;var mb;class hU extends us{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});U(this,mb,null)}render(){this.container.classList.add("circleAnnotation");const{data:t,width:i,height:s}=this,r=this.svgFactory.create(i,s,!0),a=t.borderStyle.width,o=O(this,mb,this.svgFactory.createElement("svg:ellipse"));return o.setAttribute("cx",i/2),o.setAttribute("cy",s/2),o.setAttribute("rx",i/2-a/2),o.setAttribute("ry",s/2-a/2),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),r.append(o),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return x(this,mb)}addHighlightArea(){this.container.classList.add("highlightArea")}}mb=new WeakMap;var pb;class vT extends us{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});U(this,pb,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:i,borderStyle:s,popupRef:r},width:a,height:o}=this;if(!i)return this.container;const l=this.svgFactory.create(a,o,!0);let c=[];for(let u=0,d=i.length;u<d;u+=2){const f=i[u]-t[0],g=t[3]-i[u+1];c.push(`${f},${g}`)}c=c.join(" ");const h=O(this,pb,this.svgFactory.createElement(this.svgElementName));return h.setAttribute("points",c),h.setAttribute("stroke-width",s.width||1),h.setAttribute("stroke","transparent"),h.setAttribute("fill","transparent"),l.append(h),this.container.append(l),!r&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return x(this,pb)}addHighlightArea(){this.container.classList.add("highlightArea")}}pb=new WeakMap;class uU extends vT{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class dU extends us{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var bb,fd,xb,Y8;class v4 extends us{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});U(this,xb);U(this,bb,null);U(this,fd,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?_n.HIGHLIGHT:_n.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:i,inkLists:s,borderStyle:r,popupRef:a}}=this,{transform:o,width:l,height:c}=F(this,xb,Y8).call(this,i,t),h=this.svgFactory.create(l,c,!0),u=O(this,bb,this.svgFactory.createElement("svg:g"));h.append(u),u.setAttribute("stroke-width",r.width||1),u.setAttribute("stroke-linecap","round"),u.setAttribute("stroke-linejoin","round"),u.setAttribute("stroke-miterlimit",10),u.setAttribute("stroke","transparent"),u.setAttribute("fill","transparent"),u.setAttribute("transform",o);for(let d=0,f=s.length;d<f;d++){const g=this.svgFactory.createElement(this.svgElementName);x(this,fd).push(g),g.setAttribute("points",s[d].join(",")),u.append(g)}return!a&&this.hasPopupData&&this._createPopup(),this.container.append(h),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:i,points:s,rect:r}=t,a=x(this,bb);if(i>=0&&a.setAttribute("stroke-width",i||1),s)for(let o=0,l=x(this,fd).length;o<l;o++)x(this,fd)[o].setAttribute("points",s[o].join(","));if(r){const{transform:o,width:l,height:c}=F(this,xb,Y8).call(this,this.data.rotation,r);a.parentElement.setAttribute("viewBox",`0 0 ${l} ${c}`),a.setAttribute("transform",o)}}getElementsToTriggerPopup(){return x(this,fd)}addHighlightArea(){this.container.classList.add("highlightArea")}}bb=new WeakMap,fd=new WeakMap,xb=new WeakSet,Y8=function(t,i){switch(t){case 90:return{transform:`rotate(90) translate(${-i[0]},${i[1]}) scale(1,-1)`,width:i[3]-i[1],height:i[2]-i[0]};case 180:return{transform:`rotate(180) translate(${-i[2]},${i[1]}) scale(1,-1)`,width:i[2]-i[0],height:i[3]-i[1]};case 270:return{transform:`rotate(270) translate(${-i[2]},${i[3]}) scale(1,-1)`,width:i[3]-i[1],height:i[2]-i[0]};default:return{transform:`translate(${-i[0]},${i[3]}) scale(1,-1)`,width:i[2]-i[0],height:i[3]-i[1]}}};class kT extends us{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=_n.HIGHLIGHT}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),e){const i=document.createElement("mark");i.classList.add("overlaidText"),i.textContent=e,this.container.append(i)}return this.container}}class fU extends us{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),e){const i=document.createElement("u");i.classList.add("overlaidText"),i.textContent=e,this.container.append(i)}return this.container}}class gU extends us{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),e){const i=document.createElement("u");i.classList.add("overlaidText"),i.textContent=e,this.container.append(i)}return this.container}}class mU extends us{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),e){const i=document.createElement("s");i.classList.add("overlaidText"),i.textContent=e,this.container.append(i)}return this.container}}class CT extends us{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=_n.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var yb,wb,J8;class pU extends us{constructor(t){var s;super(t,{isRenderable:!0});U(this,wb);U(this,yb,null);const{file:i}=this.data;this.filename=i.filename,this.content=i.content,(s=this.linkService.eventBus)==null||s.dispatch("fileattachmentannotation",{source:this,...i})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:i}=this;let s;i.hasAppearance||i.fillAlpha===0?s=document.createElement("div"):(s=document.createElement("img"),s.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(i.name)?"paperclip":"pushpin"}.svg`,i.fillAlpha&&i.fillAlpha<1&&(s.style=`filter: opacity(${Math.round(i.fillAlpha*100)}%);`)),s.addEventListener("dblclick",F(this,wb,J8).bind(this)),O(this,yb,s);const{isMac:r}=br.platform;return t.addEventListener("keydown",a=>{a.key==="Enter"&&(r?a.metaKey:a.ctrlKey)&&F(this,wb,J8).call(this)}),!i.popupRef&&this.hasPopupData?this._createPopup():s.classList.add("popupTriggerArea"),t.append(s),t}getElementsToTriggerPopup(){return x(this,yb)}addHighlightArea(){this.container.classList.add("highlightArea")}}yb=new WeakMap,wb=new WeakSet,J8=function(){var t;(t=this.downloadManager)==null||t.openOrDownloadData(this.content,this.filename)};var _b,gd,uh,vb,Qh,Q8,$8;const tv=class tv{constructor({div:e,accessibilityManager:t,annotationCanvasMap:i,annotationEditorUIManager:s,page:r,viewport:a,structTreeLayer:o}){U(this,Qh);U(this,_b,null);U(this,gd,null);U(this,uh,new Map);U(this,vb,null);this.div=e,O(this,_b,t),O(this,gd,i),O(this,vb,o||null),this.page=r,this.viewport=a,this.zIndex=0,this._annotationEditorUIManager=s}hasEditableAnnotations(){return x(this,uh).size>0}async render(e){var a;const{annotations:t}=e,i=this.div;Zd(i,this.viewport);const s=new Map,r={data:null,layer:i,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new S3,annotationStorage:e.annotationStorage||new y4,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const o of t){if(o.noHTML)continue;const l=o.annotationType===bs.POPUP;if(l){const u=s.get(o.id);if(!u)continue;r.elements=u}else if(o.rect[2]===o.rect[0]||o.rect[3]===o.rect[1])continue;r.data=o;const c=qv.create(r);if(!c.isRenderable)continue;if(!l&&o.popupRef){const u=s.get(o.popupRef);u?u.push(c):s.set(o.popupRef,[c])}const h=c.render();o.hidden&&(h.style.visibility="hidden"),await F(this,Qh,Q8).call(this,h,o.id,r.elements),c._isEditable&&(x(this,uh).set(c.data.id,c),(a=this._annotationEditorUIManager)==null||a.renderAnnotationElement(c))}F(this,Qh,$8).call(this)}async addLinkAnnotations(e,t){const i={data:null,layer:this.div,linkService:t,svgFactory:new S3,parent:this};for(const s of e){s.borderStyle||(s.borderStyle=tv._defaultBorderStyle),i.data=s;const r=qv.create(i);if(!r.isRenderable)continue;const a=r.render();await F(this,Qh,Q8).call(this,a,s.id,null)}}update({viewport:e}){const t=this.div;this.viewport=e,Zd(t,{rotation:e.rotation}),F(this,Qh,$8).call(this),t.hidden=!1}getEditableAnnotations(){return Array.from(x(this,uh).values())}getEditableAnnotation(e){return x(this,uh).get(e)}static get _defaultBorderStyle(){return zn(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:Af.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}};_b=new WeakMap,gd=new WeakMap,uh=new WeakMap,vb=new WeakMap,Qh=new WeakSet,Q8=async function(e,t,i){var o,l;const s=e.firstChild||e,r=s.id=`${g4}${t}`,a=await((o=x(this,vb))==null?void 0:o.getAriaAttributes(r));if(a)for(const[c,h]of a)s.setAttribute(c,h);i?i.at(-1).container.after(e):(this.div.append(e),(l=x(this,_b))==null||l.moveElementInDOM(this.div,e,s,!1))},$8=function(){var t;if(!x(this,gd))return;const e=this.div;for(const[i,s]of x(this,gd)){const r=e.querySelector(`[data-annotation-id="${i}"]`);if(!r)continue;s.className="annotationContent";const{firstChild:a}=r;a?a.nodeName==="CANVAS"?a.replaceWith(s):a.classList.contains("annotationContent")?a.after(s):a.before(s):r.append(s);const o=x(this,uh).get(i);o&&(o._hasNoCanvas?((t=this._annotationEditorUIManager)==null||t.setMissingCanvas(i,r.id,s),o._hasNoCanvas=!1):o.canvas=s)}x(this,gd).clear()};let Z8=tv;const Gx=/\r\n?|\n/g;var jo,Pa,kb,md,Na,vs,AT,ST,IT,z9,_0,j9,G9,ET,t7,TT;const Ai=class Ai extends Ii{constructor(t){super({...t,name:"freeTextEditor"});U(this,vs);U(this,jo);U(this,Pa,"");U(this,kb,`${this.id}-editor`);U(this,md,null);U(this,Na);O(this,jo,t.color||Ai._defaultColor||Ii._defaultLineColor),O(this,Na,t.fontSize||Ai._defaultFontSize),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert")}static get _keyboardManager(){const t=Ai.prototype,i=a=>a.isEmpty(),s=Qd.TRANSLATE_SMALL,r=Qd.TRANSLATE_BIG;return zn(this,"_keyboardManager",new mx([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-s,0],checker:i}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-r,0],checker:i}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[s,0],checker:i}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[r,0],checker:i}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-s],checker:i}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-r],checker:i}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,s],checker:i}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,r],checker:i}]]))}static initialize(t,i){Ii.initialize(t,i);const s=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(s.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,i){switch(t){case Vn.FREETEXT_SIZE:Ai._defaultFontSize=i;break;case Vn.FREETEXT_COLOR:Ai._defaultColor=i;break}}updateParams(t,i){switch(t){case Vn.FREETEXT_SIZE:F(this,vs,AT).call(this,i);break;case Vn.FREETEXT_COLOR:F(this,vs,ST).call(this,i);break}}static get defaultPropertiesToUpdate(){return[[Vn.FREETEXT_SIZE,Ai._defaultFontSize],[Vn.FREETEXT_COLOR,Ai._defaultColor||Ii._defaultLineColor]]}get propertiesToUpdate(){return[[Vn.FREETEXT_SIZE,x(this,Na)],[Vn.FREETEXT_COLOR,x(this,jo)]]}_translateEmpty(t,i){this._uiManager.translateSelectedEditors(t,i,!0)}getInitialTranslation(){const t=this.parentScale;return[-Ai._internalPadding*t,-(Ai._internalPadding+x(this,Na))*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),O(this,md,new AbortController);const t=this._uiManager.combinedSignal(x(this,md));return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){var t;return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",x(this,kb)),this._isDraggable=!0,(t=x(this,md))==null||t.abort(),O(this,md,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){var i;this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),(i=this._initialOptions)!=null&&i.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=x(this,Pa),i=O(this,Pa,F(this,vs,IT).call(this).trimEnd());if(t===i)return;const s=r=>{if(O(this,Pa,r),!r){this.remove();return}F(this,vs,G9).call(this),this._uiManager.rebuild(this),F(this,vs,z9).call(this)};this.addCommands({cmd:()=>{s(i)},undo:()=>{s(t)},mustExec:!1}),F(this,vs,z9).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){Ai._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,i;(this._isCopy||this.annotationElementId)&&(t=this.x,i=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",x(this,kb)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:s}=this.editorDiv;if(s.fontSize=`calc(${x(this,Na)}px * var(--total-scale-factor))`,s.color=x(this,jo),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[r,a]=this.parentDimensions;if(this.annotationElementId){const{position:o}=this._initialData;let[l,c]=this.getInitialTranslation();[l,c]=this.pageTranslationToScreen(l,c);const[h,u]=this.pageDimensions,[d,f]=this.pageTranslation;let g,m;switch(this.rotation){case 0:g=t+(o[0]-d)/h,m=i+this.height-(o[1]-f)/u;break;case 90:g=t+(o[0]-d)/h,m=i-(o[1]-f)/u,[l,c]=[c,-l];break;case 180:g=t-this.width+(o[0]-d)/h,m=i-(o[1]-f)/u,[l,c]=[-l,-c];break;case 270:g=t+(o[0]-d-this.height*u)/h,m=i+(o[1]-f-this.width*h)/u,[l,c]=[-c,l];break}this.setAt(g*r,m*a,l,c)}else this._moveAfterPaste(t,i);F(this,vs,G9).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(t){var g,m,b;const i=t.clipboardData||window.clipboardData,{types:s}=i;if(s.length===1&&s[0]==="text/plain")return;t.preventDefault();const r=F(g=Ai,_0,t7).call(g,i.getData("text")||"").replaceAll(Gx,`
`);if(!r)return;const a=window.getSelection();if(!a.rangeCount)return;this.editorDiv.normalize(),a.deleteFromDocument();const o=a.getRangeAt(0);if(!r.includes(`
`)){o.insertNode(document.createTextNode(r)),this.editorDiv.normalize(),a.collapseToStart();return}const{startContainer:l,startOffset:c}=o,h=[],u=[];if(l.nodeType===Node.TEXT_NODE){const p=l.parentElement;if(u.push(l.nodeValue.slice(c).replaceAll(Gx,"")),p!==this.editorDiv){let y=h;for(const w of this.editorDiv.childNodes){if(w===p){y=u;continue}y.push(F(m=Ai,_0,j9).call(m,w))}}h.push(l.nodeValue.slice(0,c).replaceAll(Gx,""))}else if(l===this.editorDiv){let p=h,y=0;for(const w of this.editorDiv.childNodes)y++===c&&(p=u),p.push(F(b=Ai,_0,j9).call(b,w))}O(this,Pa,`${h.join(`
`)}${r}${u.join(`
`)}`),F(this,vs,G9).call(this);const d=new Range;let f=Math.sumPrecise(h.map(p=>p.length));for(const{firstChild:p}of this.editorDiv.childNodes)if(p.nodeType===Node.TEXT_NODE){const y=p.nodeValue.length;if(f<=y){d.setStart(p,f),d.setEnd(p,f);break}f-=y}a.removeAllRanges(),a.addRange(d)}get contentDiv(){return this.editorDiv}static async deserialize(t,i,s){var o;let r=null;if(t instanceof _T){const{data:{defaultAppearanceData:{fontSize:l,fontColor:c},rect:h,rotation:u,id:d,popupRef:f},textContent:g,textPosition:m,parent:{page:{pageNumber:b}}}=t;if(!g||g.length===0)return null;r=t={annotationType:_n.FREETEXT,color:Array.from(c),fontSize:l,value:g.join(`
`),position:m,pageIndex:b-1,rect:h.slice(0),rotation:u,annotationElementId:d,id:d,deleted:!1,popupRef:f}}const a=await super.deserialize(t,i,s);return O(a,Na,t.fontSize),O(a,jo,sn.makeHexColor(...t.color)),O(a,Pa,F(o=Ai,_0,t7).call(o,t.value)),a._initialData=r,a}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i=Ai._internalPadding*this.parentScale,s=this.getRect(i,i),r=Ii._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:x(this,jo)),a={annotationType:_n.FREETEXT,color:r,fontSize:x(this,Na),value:F(this,vs,ET).call(this),pageIndex:this.pageIndex,rect:s,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?(a.isCopy=!0,a):this.annotationElementId&&!F(this,vs,TT).call(this,a)?null:(a.id=this.annotationElementId,a)}renderAnnotationElement(t){const i=super.renderAnnotationElement(t);if(this.deleted)return i;const{style:s}=i;s.fontSize=`calc(${x(this,Na)}px * var(--total-scale-factor))`,s.color=x(this,jo),i.replaceChildren();for(const a of x(this,Pa).split(`
`)){const o=document.createElement("div");o.append(a?document.createTextNode(a):document.createElement("br")),i.append(o)}const r=Ai._internalPadding*this.parentScale;return t.updateEdited({rect:this.getRect(r,r),popupContent:x(this,Pa)}),i}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}};jo=new WeakMap,Pa=new WeakMap,kb=new WeakMap,md=new WeakMap,Na=new WeakMap,vs=new WeakSet,AT=function(t){const i=r=>{this.editorDiv.style.fontSize=`calc(${r}px * var(--total-scale-factor))`,this.translate(0,-(r-x(this,Na))*this.parentScale),O(this,Na,r),F(this,vs,z9).call(this)},s=x(this,Na);this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Vn.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},ST=function(t){const i=r=>{O(this,jo,this.editorDiv.style.color=r)},s=x(this,jo);this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Vn.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},IT=function(){var s;const t=[];this.editorDiv.normalize();let i=null;for(const r of this.editorDiv.childNodes)(i==null?void 0:i.nodeType)===Node.TEXT_NODE&&r.nodeName==="BR"||(t.push(F(s=Ai,_0,j9).call(s,r)),i=r);return t.join(`
`)},z9=function(){const[t,i]=this.parentDimensions;let s;if(this.isAttachedToDOM)s=this.div.getBoundingClientRect();else{const{currentLayer:r,div:a}=this,o=a.style.display,l=a.classList.contains("hidden");a.classList.remove("hidden"),a.style.display="hidden",r.div.append(this.div),s=a.getBoundingClientRect(),a.remove(),a.style.display=o,a.classList.toggle("hidden",l)}this.rotation%180===this.parentRotation%180?(this.width=s.width/t,this.height=s.height/i):(this.width=s.height/t,this.height=s.width/i),this.fixAndSetPosition()},_0=new WeakSet,j9=function(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(Gx,"")},G9=function(){if(this.editorDiv.replaceChildren(),!!x(this,Pa))for(const t of x(this,Pa).split(`
`)){const i=document.createElement("div");i.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(i)}},ET=function(){return x(this,Pa).replaceAll(" "," ")},t7=function(t){return t.replaceAll(" "," ")},TT=function(t){const{value:i,fontSize:s,color:r,pageIndex:a}=this._initialData;return this._hasBeenMoved||t.value!==i||t.fontSize!==s||t.color.some((o,l)=>o!==r[l])||t.pageIndex!==a},U(Ai,_0),Ue(Ai,"_freeTextDefaultContent",""),Ue(Ai,"_internalPadding",0),Ue(Ai,"_defaultColor",null),Ue(Ai,"_defaultFontSize",10),Ue(Ai,"_type","freetext"),Ue(Ai,"_editorType",_n.FREETEXT);let e7=Ai;class Lt{toSVGPath(){bi("Abstract method `toSVGPath` must be implemented.")}get box(){bi("Abstract getter `box` must be implemented.")}serialize(e,t){bi("Abstract method `serialize` must be implemented.")}static _rescale(e,t,i,s,r,a){a||(a=new Float32Array(e.length));for(let o=0,l=e.length;o<l;o+=2)a[o]=t+e[o]*s,a[o+1]=i+e[o+1]*r;return a}static _rescaleAndSwap(e,t,i,s,r,a){a||(a=new Float32Array(e.length));for(let o=0,l=e.length;o<l;o+=2)a[o]=t+e[o+1]*s,a[o+1]=i+e[o]*r;return a}static _translate(e,t,i,s){s||(s=new Float32Array(e.length));for(let r=0,a=e.length;r<a;r+=2)s[r]=t+e[r],s[r+1]=i+e[r+1];return s}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,i,s,r){switch(r){case 90:return[1-t/i,e/s];case 180:return[1-e/i,1-t/s];case 270:return[t/i,1-e/s];default:return[e/i,t/s]}}static _normalizePagePoint(e,t,i){switch(i){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,i,s,r,a){return[(e+5*i)/6,(t+5*s)/6,(5*i+r)/6,(5*s+a)/6,(i+r)/2,(s+a)/2]}}Ue(Lt,"PRECISION",1e-4);var Oa,Go,$1,eg,jl,Nn,pd,bd,Cb,Ab,tg,ng,dh,Sb,P5,N5,Rs,op,RT,MT,PT,NT,OT,DT;const Cc=class Cc{constructor({x:e,y:t},i,s,r,a,o=0){U(this,Rs);U(this,Oa);U(this,Go,[]);U(this,$1);U(this,eg);U(this,jl,[]);U(this,Nn,new Float32Array(18));U(this,pd);U(this,bd);U(this,Cb);U(this,Ab);U(this,tg);U(this,ng);U(this,dh,[]);O(this,Oa,i),O(this,ng,r*s),O(this,eg,a),x(this,Nn).set([NaN,NaN,NaN,NaN,e,t],6),O(this,$1,o),O(this,Ab,x(Cc,Sb)*s),O(this,Cb,x(Cc,N5)*s),O(this,tg,s),x(this,dh).push(e,t)}isEmpty(){return isNaN(x(this,Nn)[8])}add({x:e,y:t}){var E;O(this,pd,e),O(this,bd,t);const[i,s,r,a]=x(this,Oa);let[o,l,c,h]=x(this,Nn).subarray(8,12);const u=e-c,d=t-h,f=Math.hypot(u,d);if(f<x(this,Cb))return!1;const g=f-x(this,Ab),m=g/f,b=m*u,p=m*d;let y=o,w=l;o=c,l=h,c+=b,h+=p,(E=x(this,dh))==null||E.push(e,t);const _=-p/g,v=b/g,C=_*x(this,ng),k=v*x(this,ng);return x(this,Nn).set(x(this,Nn).subarray(2,8),0),x(this,Nn).set([c+C,h+k],4),x(this,Nn).set(x(this,Nn).subarray(14,18),12),x(this,Nn).set([c-C,h-k],16),isNaN(x(this,Nn)[6])?(x(this,jl).length===0&&(x(this,Nn).set([o+C,l+k],2),x(this,jl).push(NaN,NaN,NaN,NaN,(o+C-i)/r,(l+k-s)/a),x(this,Nn).set([o-C,l-k],14),x(this,Go).push(NaN,NaN,NaN,NaN,(o-C-i)/r,(l-k-s)/a)),x(this,Nn).set([y,w,o,l,c,h],6),!this.isEmpty()):(x(this,Nn).set([y,w,o,l,c,h],6),Math.abs(Math.atan2(w-l,y-o)-Math.atan2(p,b))<Math.PI/2?([o,l,c,h]=x(this,Nn).subarray(2,6),x(this,jl).push(NaN,NaN,NaN,NaN,((o+c)/2-i)/r,((l+h)/2-s)/a),[o,l,y,w]=x(this,Nn).subarray(14,18),x(this,Go).push(NaN,NaN,NaN,NaN,((y+o)/2-i)/r,((w+l)/2-s)/a),!0):([y,w,o,l,c,h]=x(this,Nn).subarray(0,6),x(this,jl).push(((y+5*o)/6-i)/r,((w+5*l)/6-s)/a,((5*o+c)/6-i)/r,((5*l+h)/6-s)/a,((o+c)/2-i)/r,((l+h)/2-s)/a),[c,h,o,l,y,w]=x(this,Nn).subarray(12,18),x(this,Go).push(((y+5*o)/6-i)/r,((w+5*l)/6-s)/a,((5*o+c)/6-i)/r,((5*l+h)/6-s)/a,((o+c)/2-i)/r,((l+h)/2-s)/a),!0))}toSVGPath(){if(this.isEmpty())return"";const e=x(this,jl),t=x(this,Go);if(isNaN(x(this,Nn)[6])&&!this.isEmpty())return F(this,Rs,RT).call(this);const i=[];i.push(`M${e[4]} ${e[5]}`);for(let s=6;s<e.length;s+=6)isNaN(e[s])?i.push(`L${e[s+4]} ${e[s+5]}`):i.push(`C${e[s]} ${e[s+1]} ${e[s+2]} ${e[s+3]} ${e[s+4]} ${e[s+5]}`);F(this,Rs,PT).call(this,i);for(let s=t.length-6;s>=6;s-=6)isNaN(t[s])?i.push(`L${t[s+4]} ${t[s+5]}`):i.push(`C${t[s]} ${t[s+1]} ${t[s+2]} ${t[s+3]} ${t[s+4]} ${t[s+5]}`);return F(this,Rs,MT).call(this,i),i.join(" ")}newFreeDrawOutline(e,t,i,s,r,a){return new FT(e,t,i,s,r,a)}getOutlines(){var u;const e=x(this,jl),t=x(this,Go),i=x(this,Nn),[s,r,a,o]=x(this,Oa),l=new Float32Array((((u=x(this,dh))==null?void 0:u.length)??0)+2);for(let d=0,f=l.length-2;d<f;d+=2)l[d]=(x(this,dh)[d]-s)/a,l[d+1]=(x(this,dh)[d+1]-r)/o;if(l[l.length-2]=(x(this,pd)-s)/a,l[l.length-1]=(x(this,bd)-r)/o,isNaN(i[6])&&!this.isEmpty())return F(this,Rs,NT).call(this,l);const c=new Float32Array(x(this,jl).length+24+x(this,Go).length);let h=e.length;for(let d=0;d<h;d+=2){if(isNaN(e[d])){c[d]=c[d+1]=NaN;continue}c[d]=e[d],c[d+1]=e[d+1]}h=F(this,Rs,DT).call(this,c,h);for(let d=t.length-6;d>=6;d-=6)for(let f=0;f<6;f+=2){if(isNaN(t[d+f])){c[h]=c[h+1]=NaN,h+=2;continue}c[h]=t[d+f],c[h+1]=t[d+f+1],h+=2}return F(this,Rs,OT).call(this,c,h),this.newFreeDrawOutline(c,l,x(this,Oa),x(this,tg),x(this,$1),x(this,eg))}};Oa=new WeakMap,Go=new WeakMap,$1=new WeakMap,eg=new WeakMap,jl=new WeakMap,Nn=new WeakMap,pd=new WeakMap,bd=new WeakMap,Cb=new WeakMap,Ab=new WeakMap,tg=new WeakMap,ng=new WeakMap,dh=new WeakMap,Sb=new WeakMap,P5=new WeakMap,N5=new WeakMap,Rs=new WeakSet,op=function(){const e=x(this,Nn).subarray(4,6),t=x(this,Nn).subarray(16,18),[i,s,r,a]=x(this,Oa);return[(x(this,pd)+(e[0]-t[0])/2-i)/r,(x(this,bd)+(e[1]-t[1])/2-s)/a,(x(this,pd)+(t[0]-e[0])/2-i)/r,(x(this,bd)+(t[1]-e[1])/2-s)/a]},RT=function(){const[e,t,i,s]=x(this,Oa),[r,a,o,l]=F(this,Rs,op).call(this);return`M${(x(this,Nn)[2]-e)/i} ${(x(this,Nn)[3]-t)/s} L${(x(this,Nn)[4]-e)/i} ${(x(this,Nn)[5]-t)/s} L${r} ${a} L${o} ${l} L${(x(this,Nn)[16]-e)/i} ${(x(this,Nn)[17]-t)/s} L${(x(this,Nn)[14]-e)/i} ${(x(this,Nn)[15]-t)/s} Z`},MT=function(e){const t=x(this,Go);e.push(`L${t[4]} ${t[5]} Z`)},PT=function(e){const[t,i,s,r]=x(this,Oa),a=x(this,Nn).subarray(4,6),o=x(this,Nn).subarray(16,18),[l,c,h,u]=F(this,Rs,op).call(this);e.push(`L${(a[0]-t)/s} ${(a[1]-i)/r} L${l} ${c} L${h} ${u} L${(o[0]-t)/s} ${(o[1]-i)/r}`)},NT=function(e){const t=x(this,Nn),[i,s,r,a]=x(this,Oa),[o,l,c,h]=F(this,Rs,op).call(this),u=new Float32Array(36);return u.set([NaN,NaN,NaN,NaN,(t[2]-i)/r,(t[3]-s)/a,NaN,NaN,NaN,NaN,(t[4]-i)/r,(t[5]-s)/a,NaN,NaN,NaN,NaN,o,l,NaN,NaN,NaN,NaN,c,h,NaN,NaN,NaN,NaN,(t[16]-i)/r,(t[17]-s)/a,NaN,NaN,NaN,NaN,(t[14]-i)/r,(t[15]-s)/a],0),this.newFreeDrawOutline(u,e,x(this,Oa),x(this,tg),x(this,$1),x(this,eg))},OT=function(e,t){const i=x(this,Go);return e.set([NaN,NaN,NaN,NaN,i[4],i[5]],t),t+=6},DT=function(e,t){const i=x(this,Nn).subarray(4,6),s=x(this,Nn).subarray(16,18),[r,a,o,l]=x(this,Oa),[c,h,u,d]=F(this,Rs,op).call(this);return e.set([NaN,NaN,NaN,NaN,(i[0]-r)/o,(i[1]-a)/l,NaN,NaN,NaN,NaN,c,h,NaN,NaN,NaN,NaN,u,d,NaN,NaN,NaN,NaN,(s[0]-r)/o,(s[1]-a)/l],t),t+=24},U(Cc,Sb,8),U(Cc,P5,2),U(Cc,N5,x(Cc,Sb)+x(Cc,P5));let I3=Cc;var ig,xd,Yc,Ib,Da,Eb,os,O5,LT;class FT extends Lt{constructor(t,i,s,r,a,o){super();U(this,O5);U(this,ig);U(this,xd,new Float32Array(4));U(this,Yc);U(this,Ib);U(this,Da);U(this,Eb);U(this,os);O(this,os,t),O(this,Da,i),O(this,ig,s),O(this,Eb,r),O(this,Yc,a),O(this,Ib,o),this.lastPoint=[NaN,NaN],F(this,O5,LT).call(this,o);const[l,c,h,u]=x(this,xd);for(let d=0,f=t.length;d<f;d+=2)t[d]=(t[d]-l)/h,t[d+1]=(t[d+1]-c)/u;for(let d=0,f=i.length;d<f;d+=2)i[d]=(i[d]-l)/h,i[d+1]=(i[d+1]-c)/u}toSVGPath(){const t=[`M${x(this,os)[4]} ${x(this,os)[5]}`];for(let i=6,s=x(this,os).length;i<s;i+=6){if(isNaN(x(this,os)[i])){t.push(`L${x(this,os)[i+4]} ${x(this,os)[i+5]}`);continue}t.push(`C${x(this,os)[i]} ${x(this,os)[i+1]} ${x(this,os)[i+2]} ${x(this,os)[i+3]} ${x(this,os)[i+4]} ${x(this,os)[i+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,i,s,r],a){const o=s-t,l=r-i;let c,h;switch(a){case 0:c=Lt._rescale(x(this,os),t,r,o,-l),h=Lt._rescale(x(this,Da),t,r,o,-l);break;case 90:c=Lt._rescaleAndSwap(x(this,os),t,i,o,l),h=Lt._rescaleAndSwap(x(this,Da),t,i,o,l);break;case 180:c=Lt._rescale(x(this,os),s,i,-o,l),h=Lt._rescale(x(this,Da),s,i,-o,l);break;case 270:c=Lt._rescaleAndSwap(x(this,os),s,r,-o,-l),h=Lt._rescaleAndSwap(x(this,Da),s,r,-o,-l);break}return{outline:Array.from(c),points:[Array.from(h)]}}get box(){return x(this,xd)}newOutliner(t,i,s,r,a,o=0){return new I3(t,i,s,r,a,o)}getNewOutline(t,i){const[s,r,a,o]=x(this,xd),[l,c,h,u]=x(this,ig),d=a*h,f=o*u,g=s*h+l,m=r*u+c,b=this.newOutliner({x:x(this,Da)[0]*d+g,y:x(this,Da)[1]*f+m},x(this,ig),x(this,Eb),t,x(this,Ib),i??x(this,Yc));for(let p=2;p<x(this,Da).length;p+=2)b.add({x:x(this,Da)[p]*d+g,y:x(this,Da)[p+1]*f+m});return b.getOutlines()}}ig=new WeakMap,xd=new WeakMap,Yc=new WeakMap,Ib=new WeakMap,Da=new WeakMap,Eb=new WeakMap,os=new WeakMap,O5=new WeakSet,LT=function(t){const i=x(this,os);let s=i[4],r=i[5];const a=[s,r,s,r];let o=s,l=r;const c=t?Math.max:Math.min;for(let u=6,d=i.length;u<d;u+=6){const f=i[u+4],g=i[u+5];if(isNaN(i[u]))sn.pointBoundingBox(f,g,a),l<g?(o=f,l=g):l===g&&(o=c(o,f));else{const m=[1/0,1/0,-1/0,-1/0];sn.bezierBoundingBox(s,r,...i.slice(u,u+6),m),sn.rectBoundingBox(...m,a),l<m[3]?(o=m[2],l=m[3]):l===m[3]&&(o=c(o,m[2]))}s=f,r=g}const h=x(this,xd);h[0]=a[0]-x(this,Yc),h[1]=a[1]-x(this,Yc),h[2]=a[2]-a[0]+2*x(this,Yc),h[3]=a[3]-a[1]+2*x(this,Yc),this.lastPoint=[o,l]};var Tb,Rb,fh,Vo,ea,BT,V9,UT,HT,i7;class n7{constructor(e,t=0,i=0,s=!0){U(this,ea);U(this,Tb);U(this,Rb);U(this,fh,[]);U(this,Vo,[]);const r=[1/0,1/0,-1/0,-1/0],o=10**-4;for(const{x:g,y:m,width:b,height:p}of e){const y=Math.floor((g-t)/o)*o,w=Math.ceil((g+b+t)/o)*o,_=Math.floor((m-t)/o)*o,v=Math.ceil((m+p+t)/o)*o,C=[y,_,v,!0],k=[w,_,v,!1];x(this,fh).push(C,k),sn.rectBoundingBox(y,_,w,v,r)}const l=r[2]-r[0]+2*i,c=r[3]-r[1]+2*i,h=r[0]-i,u=r[1]-i,d=x(this,fh).at(s?-1:-2),f=[d[0],d[2]];for(const g of x(this,fh)){const[m,b,p]=g;g[0]=(m-h)/l,g[1]=(b-u)/c,g[2]=(p-u)/c}O(this,Tb,new Float32Array([h,u,l,c])),O(this,Rb,f)}getOutlines(){x(this,fh).sort((t,i)=>t[0]-i[0]||t[1]-i[1]||t[2]-i[2]);const e=[];for(const t of x(this,fh))t[3]?(e.push(...F(this,ea,i7).call(this,t)),F(this,ea,UT).call(this,t)):(F(this,ea,HT).call(this,t),e.push(...F(this,ea,i7).call(this,t)));return F(this,ea,BT).call(this,e)}}Tb=new WeakMap,Rb=new WeakMap,fh=new WeakMap,Vo=new WeakMap,ea=new WeakSet,BT=function(e){const t=[],i=new Set;for(const a of e){const[o,l,c]=a;t.push([o,l,a],[o,c,a])}t.sort((a,o)=>a[1]-o[1]||a[0]-o[0]);for(let a=0,o=t.length;a<o;a+=2){const l=t[a][2],c=t[a+1][2];l.push(c),c.push(l),i.add(l),i.add(c)}const s=[];let r;for(;i.size>0;){const a=i.values().next().value;let[o,l,c,h,u]=a;i.delete(a);let d=o,f=l;for(r=[o,c],s.push(r);;){let g;if(i.has(h))g=h;else if(i.has(u))g=u;else break;i.delete(g),[o,l,c,h,u]=g,d!==o&&(r.push(d,f,o,f===l?l:c),d=o),f=f===l?c:l}r.push(d,f)}return new bU(s,x(this,Tb),x(this,Rb))},V9=function(e){const t=x(this,Vo);let i=0,s=t.length-1;for(;i<=s;){const r=i+s>>1,a=t[r][0];if(a===e)return r;a<e?i=r+1:s=r-1}return s+1},UT=function([,e,t]){const i=F(this,ea,V9).call(this,e);x(this,Vo).splice(i,0,[e,t])},HT=function([,e,t]){const i=F(this,ea,V9).call(this,e);for(let s=i;s<x(this,Vo).length;s++){const[r,a]=x(this,Vo)[s];if(r!==e)break;if(r===e&&a===t){x(this,Vo).splice(s,1);return}}for(let s=i-1;s>=0;s--){const[r,a]=x(this,Vo)[s];if(r!==e)break;if(r===e&&a===t){x(this,Vo).splice(s,1);return}}},i7=function(e){const[t,i,s]=e,r=[[t,i,s]],a=F(this,ea,V9).call(this,s);for(let o=0;o<a;o++){const[l,c]=x(this,Vo)[o];for(let h=0,u=r.length;h<u;h++){const[,d,f]=r[h];if(!(c<=d||f<=l)){if(d>=l){if(f>c)r[h][1]=c;else{if(u===1)return[];r.splice(h,1),h--,u--}continue}r[h][2]=l,f>c&&r.push([t,c,f])}}}return r};var Mb,sg;class bU extends Lt{constructor(t,i,s){super();U(this,Mb);U(this,sg);O(this,sg,t),O(this,Mb,i),this.lastPoint=s}toSVGPath(){const t=[];for(const i of x(this,sg)){let[s,r]=i;t.push(`M${s} ${r}`);for(let a=2;a<i.length;a+=2){const o=i[a],l=i[a+1];o===s?(t.push(`V${l}`),r=l):l===r&&(t.push(`H${o}`),s=o)}t.push("Z")}return t.join(" ")}serialize([t,i,s,r],a){const o=[],l=s-t,c=r-i;for(const h of x(this,sg)){const u=new Array(h.length);for(let d=0;d<h.length;d+=2)u[d]=t+h[d]*l,u[d+1]=r-h[d+1]*c;o.push(u)}return o}get box(){return x(this,Mb)}get classNamesForOutlining(){return["highlightOutline"]}}Mb=new WeakMap,sg=new WeakMap;class s7 extends I3{newFreeDrawOutline(e,t,i,s,r,a){return new xU(e,t,i,s,r,a)}}class xU extends FT{newOutliner(e,t,i,s,r,a=0){return new s7(e,t,i,s,r,a)}}var Fa,yd,rg,Es,Pb,ag,Jc,Nb,gh,qo,og,Ob,mi,r7,a7,o7,du,zT,O0;const oa=class oa{constructor({editor:e=null,uiManager:t=null}){U(this,mi);U(this,Fa,null);U(this,yd,null);U(this,rg);U(this,Es,null);U(this,Pb,!1);U(this,ag,!1);U(this,Jc,null);U(this,Nb);U(this,gh,null);U(this,qo,null);U(this,og);var i,s;e?(O(this,ag,!1),O(this,og,Vn.HIGHLIGHT_COLOR),O(this,Jc,e)):(O(this,ag,!0),O(this,og,Vn.HIGHLIGHT_DEFAULT_COLOR)),O(this,qo,(e==null?void 0:e._uiManager)||t),O(this,Nb,x(this,qo)._eventBus),O(this,rg,((i=e==null?void 0:e.color)==null?void 0:i.toUpperCase())||((s=x(this,qo))==null?void 0:s.highlightColors.values().next().value)||"#FFFF98"),x(oa,Ob)||O(oa,Ob,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return zn(this,"_keyboardManager",new mx([[["Escape","mac+Escape"],oa.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],oa.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],oa.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],oa.prototype._moveToPrevious],[["Home","mac+Home"],oa.prototype._moveToBeginning],[["End","mac+End"],oa.prototype._moveToEnd]]))}renderButton(){const e=O(this,Fa,document.createElement("button"));e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.ariaHasPopup="true",x(this,Jc)&&(e.ariaControls=`${x(this,Jc).id}_colorpicker_dropdown`);const t=x(this,qo)._signal;e.addEventListener("click",F(this,mi,du).bind(this),{signal:t}),e.addEventListener("keydown",F(this,mi,o7).bind(this),{signal:t});const i=O(this,yd,document.createElement("span"));return i.className="swatch",i.ariaHidden="true",i.style.backgroundColor=x(this,rg),e.append(i),e}renderMainDropdown(){const e=O(this,Es,F(this,mi,r7).call(this));return e.ariaOrientation="horizontal",e.ariaLabelledBy="highlightColorPickerLabel",e}_colorSelectFromKeyboard(e){if(e.target===x(this,Fa)){F(this,mi,du).call(this,e);return}const t=e.target.getAttribute("data-color");t&&F(this,mi,a7).call(this,t,e)}_moveToNext(e){var t,i;if(!x(this,mi,O0)){F(this,mi,du).call(this,e);return}if(e.target===x(this,Fa)){(t=x(this,Es).firstChild)==null||t.focus();return}(i=e.target.nextSibling)==null||i.focus()}_moveToPrevious(e){var t,i;if(e.target===((t=x(this,Es))==null?void 0:t.firstChild)||e.target===x(this,Fa)){x(this,mi,O0)&&this._hideDropdownFromKeyboard();return}x(this,mi,O0)||F(this,mi,du).call(this,e),(i=e.target.previousSibling)==null||i.focus()}_moveToBeginning(e){var t;if(!x(this,mi,O0)){F(this,mi,du).call(this,e);return}(t=x(this,Es).firstChild)==null||t.focus()}_moveToEnd(e){var t;if(!x(this,mi,O0)){F(this,mi,du).call(this,e);return}(t=x(this,Es).lastChild)==null||t.focus()}hideDropdown(){var e,t;(e=x(this,Es))==null||e.classList.add("hidden"),x(this,Fa).ariaExpanded="false",(t=x(this,gh))==null||t.abort(),O(this,gh,null)}_hideDropdownFromKeyboard(){var e;if(!x(this,ag)){if(!x(this,mi,O0)){(e=x(this,Jc))==null||e.unselect();return}this.hideDropdown(),x(this,Fa).focus({preventScroll:!0,focusVisible:x(this,Pb)})}}updateColor(e){if(x(this,yd)&&(x(this,yd).style.backgroundColor=e),!x(this,Es))return;const t=x(this,qo).highlightColors.values();for(const i of x(this,Es).children)i.ariaSelected=t.next().value===e.toUpperCase()}destroy(){var e,t;(e=x(this,Fa))==null||e.remove(),O(this,Fa,null),O(this,yd,null),(t=x(this,Es))==null||t.remove(),O(this,Es,null)}};Fa=new WeakMap,yd=new WeakMap,rg=new WeakMap,Es=new WeakMap,Pb=new WeakMap,ag=new WeakMap,Jc=new WeakMap,Nb=new WeakMap,gh=new WeakMap,qo=new WeakMap,og=new WeakMap,Ob=new WeakMap,mi=new WeakSet,r7=function(){const e=document.createElement("div"),t=x(this,qo)._signal;e.addEventListener("contextmenu",ll,{signal:t}),e.className="dropdown",e.role="listbox",e.ariaMultiSelectable="false",e.ariaOrientation="vertical",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),x(this,Jc)&&(e.id=`${x(this,Jc).id}_colorpicker_dropdown`);for(const[i,s]of x(this,qo).highlightColors){const r=document.createElement("button");r.tabIndex="0",r.role="option",r.setAttribute("data-color",s),r.title=i,r.setAttribute("data-l10n-id",x(oa,Ob)[i]);const a=document.createElement("span");r.append(a),a.className="swatch",a.style.backgroundColor=s,r.ariaSelected=s===x(this,rg),r.addEventListener("click",F(this,mi,a7).bind(this,s),{signal:t}),e.append(r)}return e.addEventListener("keydown",F(this,mi,o7).bind(this),{signal:t}),e},a7=function(e,t){t.stopPropagation(),x(this,Nb).dispatch("switchannotationeditorparams",{source:this,type:x(this,og),value:e})},o7=function(e){oa._keyboardManager.exec(this,e)},du=function(e){if(x(this,mi,O0)){this.hideDropdown();return}if(O(this,Pb,e.detail===0),x(this,gh)||(O(this,gh,new AbortController),window.addEventListener("pointerdown",F(this,mi,zT).bind(this),{signal:x(this,qo).combinedSignal(x(this,gh))})),x(this,Fa).ariaExpanded="true",x(this,Es)){x(this,Es).classList.remove("hidden");return}const t=O(this,Es,F(this,mi,r7).call(this));x(this,Fa).append(t)},zT=function(e){var t;(t=x(this,Es))!=null&&t.contains(e.target)||this.hideDropdown()},O0=function(){return x(this,Es)&&!x(this,Es).classList.contains("hidden")},U(oa,Ob,null);let E3=oa;var lg,Db,Zc,wd,Fb,ha,Lb,Bb,_d,ho,La,lr,cg,Qc,Ir,hg,uo,Ub,Sn,l7,q9,jT,GT,VT,c7,fu,ko,Rf,qT,W9,lp,WT,KT,XT,YT,JT;const si=class si extends Ii{constructor(t){super({...t,name:"highlightEditor"});U(this,Sn);U(this,lg,null);U(this,Db,0);U(this,Zc);U(this,wd,null);U(this,Fb,null);U(this,ha,null);U(this,Lb,null);U(this,Bb,0);U(this,_d,null);U(this,ho,null);U(this,La,null);U(this,lr,!1);U(this,cg,null);U(this,Qc);U(this,Ir,null);U(this,hg,"");U(this,uo);U(this,Ub,"");this.color=t.color||si._defaultColor,O(this,uo,t.thickness||si._defaultThickness),O(this,Qc,t.opacity||si._defaultOpacity),O(this,Zc,t.boxes||null),O(this,Ub,t.methodOfCreation||""),O(this,hg,t.text||""),this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(O(this,lr,!0),F(this,Sn,q9).call(this,t),F(this,Sn,fu).call(this)):x(this,Zc)&&(O(this,lg,t.anchorNode),O(this,Db,t.anchorOffset),O(this,Lb,t.focusNode),O(this,Bb,t.focusOffset),F(this,Sn,l7).call(this),F(this,Sn,fu).call(this),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}static get _keyboardManager(){const t=si.prototype;return zn(this,"_keyboardManager",new mx([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:x(this,lr)?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:x(this,uo),methodOfCreation:x(this,Ub)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}static initialize(t,i){var s;Ii.initialize(t,i),si._defaultColor||(si._defaultColor=((s=i.highlightColors)==null?void 0:s.values().next().value)||"#fff066")}static updateDefaultParams(t,i){switch(t){case Vn.HIGHLIGHT_DEFAULT_COLOR:si._defaultColor=i;break;case Vn.HIGHLIGHT_THICKNESS:si._defaultThickness=i;break}}translateInPage(t,i){}get toolbarPosition(){return x(this,cg)}updateParams(t,i){switch(t){case Vn.HIGHLIGHT_COLOR:F(this,Sn,jT).call(this,i);break;case Vn.HIGHLIGHT_THICKNESS:F(this,Sn,GT).call(this,i);break}}static get defaultPropertiesToUpdate(){return[[Vn.HIGHLIGHT_DEFAULT_COLOR,si._defaultColor],[Vn.HIGHLIGHT_THICKNESS,si._defaultThickness]]}get propertiesToUpdate(){return[[Vn.HIGHLIGHT_COLOR,this.color||si._defaultColor],[Vn.HIGHLIGHT_THICKNESS,x(this,uo)||si._defaultThickness],[Vn.HIGHLIGHT_FREE,x(this,lr)]]}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",O(this,Fb,new E3({editor:this}))]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(F(this,Sn,lp).call(this))}getBaseTranslation(){return[0,0]}getRect(t,i){return super.getRect(t,i,F(this,Sn,lp).call(this))}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){F(this,Sn,c7).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(F(this,Sn,fu).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var s;let i=!1;this.parent&&!t?F(this,Sn,c7).call(this):t&&(F(this,Sn,fu).call(this,t),i=!this.parent&&((s=this.div)==null?void 0:s.classList.contains("selectedEditor"))),super.setParent(t),this.show(this._isVisible),i&&this.select()}rotate(t){var r,a,o;const{drawLayer:i}=this.parent;let s;x(this,lr)?(t=(t-this.rotation+360)%360,s=F(r=si,ko,Rf).call(r,x(this,ho).box,t)):s=F(a=si,ko,Rf).call(a,[this.x,this.y,this.width,this.height],t),i.updateProperties(x(this,La),{bbox:s,root:{"data-main-rotation":t}}),i.updateProperties(x(this,Ir),{bbox:F(o=si,ko,Rf).call(o,x(this,ha).box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();x(this,hg)&&(t.setAttribute("aria-label",x(this,hg)),t.setAttribute("role","mark")),x(this,lr)?t.classList.add("free"):this.div.addEventListener("keydown",F(this,Sn,qT).bind(this),{signal:this._uiManager._signal});const i=O(this,_d,document.createElement("div"));t.append(i),i.setAttribute("aria-hidden","true"),i.className="internal",i.style.clipPath=x(this,wd);const[s,r]=this.parentDimensions;return this.setDims(this.width*s,this.height*r),pE(this,x(this,_d),["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(x(this,Ir),{rootClass:{hovered:!0}})}pointerleave(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(x(this,Ir),{rootClass:{hovered:!1}})}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:F(this,Sn,W9).call(this,!0);break;case 1:case 3:F(this,Sn,W9).call(this,!1);break}}select(){var t;super.select(),x(this,Ir)&&((t=this.parent)==null||t.drawLayer.updateProperties(x(this,Ir),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var t;super.unselect(),x(this,Ir)&&((t=this.parent)==null||t.drawLayer.updateProperties(x(this,Ir),{rootClass:{selected:!1}}),x(this,lr)||F(this,Sn,W9).call(this,!1))}get _mustFixPosition(){return!x(this,lr)}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(x(this,La),{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(x(this,Ir),{rootClass:{hidden:!t}}))}static startHighlighting(t,i,{target:s,x:r,y:a}){const{x:o,y:l,width:c,height:h}=s.getBoundingClientRect(),u=new AbortController,d=t.combinedSignal(u),f=g=>{u.abort(),F(this,ko,YT).call(this,t,g)};window.addEventListener("blur",f,{signal:d}),window.addEventListener("pointerup",f,{signal:d}),window.addEventListener("pointerdown",ys,{capture:!0,passive:!1,signal:d}),window.addEventListener("contextmenu",ll,{signal:d}),s.addEventListener("pointermove",F(this,ko,XT).bind(this,t),{signal:d}),this._freeHighlight=new s7({x:r,y:a},[o,l,c,h],t.scale,this._defaultThickness/2,i,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(t,i,s){var m,b,p,y;let r=null;if(t instanceof kT){const{data:{quadPoints:w,rect:_,rotation:v,id:C,color:k,opacity:I,popupRef:E},parent:{page:{pageNumber:T}}}=t;r=t={annotationType:_n.HIGHLIGHT,color:Array.from(k),opacity:I,quadPoints:w,boxes:null,pageIndex:T-1,rect:_.slice(0),rotation:v,annotationElementId:C,id:C,deleted:!1,popupRef:E}}else if(t instanceof v4){const{data:{inkLists:w,rect:_,rotation:v,id:C,color:k,borderStyle:{rawWidth:I},popupRef:E},parent:{page:{pageNumber:T}}}=t;r=t={annotationType:_n.HIGHLIGHT,color:Array.from(k),thickness:I,inkLists:w,boxes:null,pageIndex:T-1,rect:_.slice(0),rotation:v,annotationElementId:C,id:C,deleted:!1,popupRef:E}}const{color:a,quadPoints:o,inkLists:l,opacity:c}=t,h=await super.deserialize(t,i,s);h.color=sn.makeHexColor(...a),O(h,Qc,c||1),l&&O(h,uo,t.thickness),h._initialData=r;const[u,d]=h.pageDimensions,[f,g]=h.pageTranslation;if(o){const w=O(h,Zc,[]);for(let _=0;_<o.length;_+=8)w.push({x:(o[_]-f)/u,y:1-(o[_+1]-g)/d,width:(o[_+2]-o[_])/u,height:(o[_+1]-o[_+5])/d});F(m=h,Sn,l7).call(m),F(b=h,Sn,fu).call(b),h.rotate(h.rotation)}else if(l){O(h,lr,!0);const w=l[0],_={x:w[0]-f,y:d-(w[1]-g)},v=new s7(_,[0,0,u,d],1,x(h,uo)/2,!0,.001);for(let I=0,E=w.length;I<E;I+=2)_.x=w[I]-f,_.y=d-(w[I+1]-g),v.add(_);const{id:C,clipPathId:k}=i.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:h.color,"fill-opacity":h._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:v.toSVGPath()}},!0,!0);F(p=h,Sn,q9).call(p,{highlightOutlines:v.getOutlines(),highlightId:C,clipPathId:k}),F(y=h,Sn,fu).call(y),h.rotate(h.parentRotation)}return h}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const i=this.getRect(0,0),s=Ii._colorManager.convert(this.color),r={annotationType:_n.HIGHLIGHT,color:s,opacity:x(this,Qc),thickness:x(this,uo),quadPoints:F(this,Sn,WT).call(this),outlines:F(this,Sn,KT).call(this,i),pageIndex:this.pageIndex,rect:i,rotation:F(this,Sn,lp).call(this),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!F(this,Sn,JT).call(this,r)?null:(r.id=this.annotationElementId,r)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};lg=new WeakMap,Db=new WeakMap,Zc=new WeakMap,wd=new WeakMap,Fb=new WeakMap,ha=new WeakMap,Lb=new WeakMap,Bb=new WeakMap,_d=new WeakMap,ho=new WeakMap,La=new WeakMap,lr=new WeakMap,cg=new WeakMap,Qc=new WeakMap,Ir=new WeakMap,hg=new WeakMap,uo=new WeakMap,Ub=new WeakMap,Sn=new WeakSet,l7=function(){const t=new n7(x(this,Zc),.001);O(this,ho,t.getOutlines()),[this.x,this.y,this.width,this.height]=x(this,ho).box;const i=new n7(x(this,Zc),.0025,.001,this._uiManager.direction==="ltr");O(this,ha,i.getOutlines());const{lastPoint:s}=x(this,ha);O(this,cg,[(s[0]-this.x)/this.width,(s[1]-this.y)/this.height])},q9=function({highlightOutlines:t,highlightId:i,clipPathId:s}){var u,d;if(O(this,ho,t),O(this,ha,t.getNewOutline(x(this,uo)/2+1.5,.0025)),i>=0)O(this,La,i),O(this,wd,s),this.parent.drawLayer.finalizeDraw(i,{bbox:t.box,path:{d:t.toSVGPath()}}),O(this,Ir,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:x(this,ha).box,path:{d:x(this,ha).toSVGPath()}},!0));else if(this.parent){const f=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(x(this,La),{bbox:F(u=si,ko,Rf).call(u,x(this,ho).box,(f-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(x(this,Ir),{bbox:F(d=si,ko,Rf).call(d,x(this,ha).box,f),path:{d:x(this,ha).toSVGPath()}})}const[a,o,l,c]=t.box;switch(this.rotation){case 0:this.x=a,this.y=o,this.width=l,this.height=c;break;case 90:{const[f,g]=this.parentDimensions;this.x=o,this.y=1-a,this.width=l*g/f,this.height=c*f/g;break}case 180:this.x=1-a,this.y=1-o,this.width=l,this.height=c;break;case 270:{const[f,g]=this.parentDimensions;this.x=1-o,this.y=a,this.width=l*g/f,this.height=c*f/g;break}}const{lastPoint:h}=x(this,ha);O(this,cg,[(h[0]-a)/l,(h[1]-o)/c])},jT=function(t){const i=(a,o)=>{var l,c;this.color=a,O(this,Qc,o),(l=this.parent)==null||l.drawLayer.updateProperties(x(this,La),{root:{fill:a,"fill-opacity":o}}),(c=x(this,Fb))==null||c.updateColor(a)},s=this.color,r=x(this,Qc);this.addCommands({cmd:i.bind(this,t,si._defaultOpacity),undo:i.bind(this,s,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Vn.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(t)},!0)},GT=function(t){const i=x(this,uo),s=r=>{O(this,uo,r),F(this,Sn,VT).call(this,r)};this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Vn.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)},VT=function(t){if(!x(this,lr))return;F(this,Sn,q9).call(this,{highlightOutlines:x(this,ho).getNewOutline(t/2)}),this.fixAndSetPosition();const[i,s]=this.parentDimensions;this.setDims(this.width*i,this.height*s)},c7=function(){x(this,La)===null||!this.parent||(this.parent.drawLayer.remove(x(this,La)),O(this,La,null),this.parent.drawLayer.remove(x(this,Ir)),O(this,Ir,null))},fu=function(t=this.parent){x(this,La)===null&&({id:Fr(this,La)._,clipPathId:Fr(this,wd)._}=t.drawLayer.draw({bbox:x(this,ho).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":x(this,Qc)},rootClass:{highlight:!0,free:x(this,lr)},path:{d:x(this,ho).toSVGPath()}},!1,!0),O(this,Ir,t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:x(this,lr)},bbox:x(this,ha).box,path:{d:x(this,ha).toSVGPath()}},x(this,lr))),x(this,_d)&&(x(this,_d).style.clipPath=x(this,wd)))},ko=new WeakSet,Rf=function([t,i,s,r],a){switch(a){case 90:return[1-i-r,t,r,s];case 180:return[1-t-s,1-i-r,s,r];case 270:return[i,1-t-s,r,s]}return[t,i,s,r]},qT=function(t){si._keyboardManager.exec(this,t)},W9=function(t){if(!x(this,lg))return;const i=window.getSelection();t?i.setPosition(x(this,lg),x(this,Db)):i.setPosition(x(this,Lb),x(this,Bb))},lp=function(){return x(this,lr)?this.rotation:0},WT=function(){if(x(this,lr))return null;const[t,i]=this.pageDimensions,[s,r]=this.pageTranslation,a=x(this,Zc),o=new Float32Array(a.length*8);let l=0;for(const{x:c,y:h,width:u,height:d}of a){const f=c*t+s,g=(1-h)*i+r;o[l]=o[l+4]=f,o[l+1]=o[l+3]=g,o[l+2]=o[l+6]=f+u*t,o[l+5]=o[l+7]=g-d*i,l+=8}return o},KT=function(t){return x(this,ho).serialize(t,F(this,Sn,lp).call(this))},XT=function(t,i){this._freeHighlight.add(i)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},YT=function(t,i){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(i,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},JT=function(t){const{color:i}=this._initialData;return t.color.some((s,r)=>s!==i[r])},U(si,ko),Ue(si,"_defaultColor",null),Ue(si,"_defaultOpacity",1),Ue(si,"_defaultThickness",12),Ue(si,"_type","highlight"),Ue(si,"_editorType",_n.HIGHLIGHT),Ue(si,"_freeHighlightId",-1),Ue(si,"_freeHighlight",null),Ue(si,"_freeHighlightClipId","");let T3=si;var vd;class ZT{constructor(){U(this,vd,Object.create(null))}updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,i]of Object.entries(e))t.startsWith("_")||this.updateProperty(t,i)}updateSVGProperty(e,t){x(this,vd)[e]=t}toSVGProperties(){const e=x(this,vd);return O(this,vd,Object.create(null)),{root:e}}reset(){O(this,vd,Object.create(null))}updateAll(e=this){this.updateProperties(e)}clone(){bi("Not implemented")}}vd=new WeakMap;var Ba,ug,Fs,kd,Cd,mh,ph,bh,Ad,$n,h7,u7,d7,cp,QT,K9,hp,Mf;const jt=class jt extends Ii{constructor(t){super(t);U(this,$n);U(this,Ba,null);U(this,ug);Ue(this,"_drawId",null);O(this,ug,t.mustBeCommitted||!1),this._addOutlines(t)}_addOutlines(t){t.drawOutlines&&(F(this,$n,h7).call(this,t),F(this,$n,cp).call(this))}static _mergeSVGProperties(t,i){const s=new Set(Object.keys(t));for(const[r,a]of Object.entries(i))s.has(r)?Object.assign(t[r],a):t[r]=a;return t}static getDefaultDrawingOptions(t){bi("Not implemented")}static get typesMap(){bi("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,i){const s=this.typesMap.get(t);s&&this._defaultDrawingOptions.updateProperty(s,i),this._currentParent&&(x(jt,Fs).updateProperty(s,i),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,i){const s=this.constructor.typesMap.get(t);s&&this._updateProperty(t,s,i)}static get defaultPropertiesToUpdate(){const t=[],i=this._defaultDrawingOptions;for(const[s,r]of this.typesMap)t.push([s,i[r]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:i}=this;for(const[s,r]of this.constructor.typesMap)t.push([s,i[r]]);return t}_updateProperty(t,i,s){const r=this._drawingOptions,a=r[i],o=l=>{var h;r.updateProperty(i,l);const c=x(this,Ba).updateProperty(i,l);c&&F(this,$n,hp).call(this,c),(h=this.parent)==null||h.drawLayer.updateProperties(this._drawId,r.toSVGProperties())};this.addCommands({cmd:o.bind(this,s),undo:o.bind(this,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,jt._mergeSVGProperties(x(this,Ba).getPathResizingSVGProperties(F(this,$n,K9).call(this)),{bbox:F(this,$n,Mf).call(this)}))}_onResized(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,jt._mergeSVGProperties(x(this,Ba).getPathResizedSVGProperties(F(this,$n,K9).call(this)),{bbox:F(this,$n,Mf).call(this)}))}_onTranslating(t,i){var s;(s=this.parent)==null||s.drawLayer.updateProperties(this._drawId,{bbox:F(this,$n,Mf).call(this)})}_onTranslated(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,jt._mergeSVGProperties(x(this,Ba).getPathTranslatedSVGProperties(F(this,$n,K9).call(this),this.parentDimensions),{bbox:F(this,$n,Mf).call(this)}))}_onStartDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,x(this,ug)&&(O(this,ug,!1),this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){F(this,$n,d7).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(F(this,$n,cp).call(this),F(this,$n,hp).call(this,x(this,Ba).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var s;let i=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),F(this,$n,d7).call(this)):t&&(this._uiManager.addShouldRescale(this),F(this,$n,cp).call(this,t),i=!this.parent&&((s=this.div)==null?void 0:s.classList.contains("selectedEditor"))),super.setParent(t),i&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,jt._mergeSVGProperties({bbox:F(this,$n,Mf).call(this)},x(this,Ba).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&F(this,$n,hp).call(this,x(this,Ba).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,i;this._isCopy&&(t=this.x,i=this.y);const s=super.render();s.classList.add("draw");const r=document.createElement("div");s.append(r),r.setAttribute("aria-hidden","true"),r.className="internal";const[a,o]=this.parentDimensions;return this.setDims(this.width*a,this.height*o),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,i),s}static createDrawerInstance(t,i,s,r,a){bi("Not implemented")}static startDrawing(t,i,s,r){var b;const{target:a,offsetX:o,offsetY:l,pointerId:c,pointerType:h}=r;if(x(jt,ph)&&x(jt,ph)!==h)return;const{viewport:{rotation:u}}=t,{width:d,height:f}=a.getBoundingClientRect(),g=O(jt,kd,new AbortController),m=t.combinedSignal(g);if(x(jt,mh)||O(jt,mh,c),x(jt,ph)??O(jt,ph,h),window.addEventListener("pointerup",p=>{var y;x(jt,mh)===p.pointerId?this._endDraw(p):(y=x(jt,bh))==null||y.delete(p.pointerId)},{signal:m}),window.addEventListener("pointercancel",p=>{var y;x(jt,mh)===p.pointerId?this._currentParent.endDrawingSession():(y=x(jt,bh))==null||y.delete(p.pointerId)},{signal:m}),window.addEventListener("pointerdown",p=>{x(jt,ph)===p.pointerType&&((x(jt,bh)||O(jt,bh,new Set)).add(p.pointerId),x(jt,Fs).isCancellable()&&(x(jt,Fs).removeLastElement(),x(jt,Fs).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:m}),window.addEventListener("contextmenu",ll,{signal:m}),a.addEventListener("pointermove",this._drawMove.bind(this),{signal:m}),a.addEventListener("touchmove",p=>{p.timeStamp===x(jt,Ad)&&ys(p)},{signal:m}),t.toggleDrawing(),(b=i._editorUndoBar)==null||b.hide(),x(jt,Fs)){t.drawLayer.updateProperties(this._currentDrawId,x(jt,Fs).startNew(o,l,d,f,u));return}i.updateUIForDefaultProperties(this),O(jt,Fs,this.createDrawerInstance(o,l,d,f,u)),O(jt,Cd,this.getDefaultDrawingOptions()),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(x(jt,Cd).toSVGProperties(),x(jt,Fs).defaultSVGProperties),!0,!1)}static _drawMove(t){var a;if(O(jt,Ad,-1),!x(jt,Fs))return;const{offsetX:i,offsetY:s,pointerId:r}=t;if(x(jt,mh)===r){if(((a=x(jt,bh))==null?void 0:a.size)>=1){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,x(jt,Fs).add(i,s)),O(jt,Ad,t.timeStamp),ys(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,O(jt,Fs,null),O(jt,Cd,null),O(jt,ph,null),O(jt,Ad,NaN)),x(jt,kd)&&(x(jt,kd).abort(),O(jt,kd,null),O(jt,mh,NaN),O(jt,bh,null))}static _endDraw(t){const i=this._currentParent;if(i){if(i.toggleDrawing(!0),this._cleanup(!1),(t==null?void 0:t.target)===i.div&&i.drawLayer.updateProperties(this._currentDrawId,x(jt,Fs).end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const s=x(jt,Fs),r=this._currentDrawId,a=s.getLastElement();i.addCommands({cmd:()=>{i.drawLayer.updateProperties(r,s.setLastElement(a))},undo:()=>{i.drawLayer.updateProperties(r,s.removeLastElement())},mustExec:!1,type:Vn.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const i=this._currentParent;if(!i)return null;if(i.toggleDrawing(!0),i.cleanUndoStack(Vn.DRAW_STEP),!x(jt,Fs).isEmpty()){const{pageDimensions:[s,r],scale:a}=i,o=i.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:x(jt,Fs).getOutlines(s*a,r*a,a,this._INNER_MARGIN),drawingOptions:x(jt,Cd),mustBeCommitted:!t});return this._cleanup(!0),o}return i.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,i,s,r,a,o){bi("Not implemented")}static async deserialize(t,i,s){var u,d;const{rawDims:{pageWidth:r,pageHeight:a,pageX:o,pageY:l}}=i.viewport,c=this.deserializeDraw(o,l,r,a,this._INNER_MARGIN,t),h=await super.deserialize(t,i,s);return h.createDrawingOptions(t),F(u=h,$n,h7).call(u,{drawOutlines:c}),F(d=h,$n,cp).call(d),h.onScaleChanging(),h.rotate(),h}serializeDraw(t){const[i,s]=this.pageTranslation,[r,a]=this.pageDimensions;return x(this,Ba).serialize([i,s,r,a],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};Ba=new WeakMap,ug=new WeakMap,Fs=new WeakMap,kd=new WeakMap,Cd=new WeakMap,mh=new WeakMap,ph=new WeakMap,bh=new WeakMap,Ad=new WeakMap,$n=new WeakSet,h7=function({drawOutlines:t,drawId:i,drawingOptions:s}){O(this,Ba,t),this._drawingOptions||(this._drawingOptions=s),this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),i>=0?(this._drawId=i,this.parent.drawLayer.finalizeDraw(i,t.defaultProperties)):this._drawId=F(this,$n,u7).call(this,t,this.parent),F(this,$n,hp).call(this,t.box)},u7=function(t,i){const{id:s}=i.drawLayer.draw(jt._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return s},d7=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},cp=function(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=F(this,$n,u7).call(this,x(this,Ba),t)}},QT=function([t,i,s,r]){const{parentDimensions:[a,o],rotation:l}=this;switch(l){case 90:return[i,1-t,s*(o/a),r*(a/o)];case 180:return[1-t,1-i,s,r];case 270:return[1-i,t,s*(o/a),r*(a/o)];default:return[t,i,s,r]}},K9=function(){const{x:t,y:i,width:s,height:r,parentDimensions:[a,o],rotation:l}=this;switch(l){case 90:return[1-i,t,s*(a/o),r*(o/a)];case 180:return[1-t,1-i,s,r];case 270:return[i,1-t,s*(a/o),r*(o/a)];default:return[t,i,s,r]}},hp=function(t){if([this.x,this.y,this.width,this.height]=F(this,$n,QT).call(this,t),this.div){this.fixAndSetPosition();const[i,s]=this.parentDimensions;this.setDims(this.width*i,this.height*s)}this._onResized()},Mf=function(){const{x:t,y:i,width:s,height:r,rotation:a,parentRotation:o,parentDimensions:[l,c]}=this;switch((a*4+o)/90){case 1:return[1-i-r,t,r,s];case 2:return[1-t-s,1-i-r,s,r];case 3:return[i,1-t-s,r,s];case 4:return[t,i-s*(l/c),r*(c/l),s*(l/c)];case 5:return[1-i,t,s*(l/c),r*(c/l)];case 6:return[1-t-r*(c/l),1-i,r*(c/l),s*(l/c)];case 7:return[i-s*(l/c),1-t-r*(c/l),s*(l/c),r*(c/l)];case 8:return[t-s,i-r,s,r];case 9:return[1-i,t-s,r,s];case 10:return[1-t,1-i,s,r];case 11:return[i-r,1-t,r,s];case 12:return[t-r*(c/l),i,r*(c/l),s*(l/c)];case 13:return[1-i-s*(l/c),t-r*(c/l),s*(l/c),r*(c/l)];case 14:return[1-t,1-i-s*(l/c),r*(c/l),s*(l/c)];case 15:return[i,1-t,s*(l/c),r*(c/l)];default:return[t,i,s,r]}},Ue(jt,"_currentDrawId",-1),Ue(jt,"_currentParent",null),U(jt,Fs,null),U(jt,kd,null),U(jt,Cd,null),U(jt,mh,NaN),U(jt,ph,null),U(jt,bh,null),U(jt,Ad,NaN),Ue(jt,"_INNER_MARGIN",3);let R3=jt;var Gl,Ls,Bs,Sd,dg,zr,cr,fo,Id,Ed,Td,fg,X9;class yU{constructor(e,t,i,s,r,a){U(this,fg);U(this,Gl,new Float64Array(6));U(this,Ls);U(this,Bs);U(this,Sd);U(this,dg);U(this,zr);U(this,cr,"");U(this,fo,0);U(this,Id,new bx);U(this,Ed);U(this,Td);O(this,Ed,i),O(this,Td,s),O(this,Sd,r),O(this,dg,a),[e,t]=F(this,fg,X9).call(this,e,t);const o=O(this,Ls,[NaN,NaN,NaN,NaN,e,t]);O(this,zr,[e,t]),O(this,Bs,[{line:o,points:x(this,zr)}]),x(this,Gl).set(o,0)}updateProperty(e,t){e==="stroke-width"&&O(this,dg,t)}isEmpty(){return!x(this,Bs)||x(this,Bs).length===0}isCancellable(){return x(this,zr).length<=10}add(e,t){[e,t]=F(this,fg,X9).call(this,e,t);const[i,s,r,a]=x(this,Gl).subarray(2,6),o=e-r,l=t-a;return Math.hypot(x(this,Ed)*o,x(this,Td)*l)<=2?null:(x(this,zr).push(e,t),isNaN(i)?(x(this,Gl).set([r,a,e,t],2),x(this,Ls).push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(x(this,Gl)[0])&&x(this,Ls).splice(6,6),x(this,Gl).set([i,s,r,a,e,t],0),x(this,Ls).push(...Lt.createBezierPoints(i,s,r,a,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const i=this.add(e,t);return i||(x(this,zr).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,i,s,r){O(this,Ed,i),O(this,Td,s),O(this,Sd,r),[e,t]=F(this,fg,X9).call(this,e,t);const a=O(this,Ls,[NaN,NaN,NaN,NaN,e,t]);O(this,zr,[e,t]);const o=x(this,Bs).at(-1);return o&&(o.line=new Float32Array(o.line),o.points=new Float32Array(o.points)),x(this,Bs).push({line:a,points:x(this,zr)}),x(this,Gl).set(a,0),O(this,fo,0),this.toSVGPath(),null}getLastElement(){return x(this,Bs).at(-1)}setLastElement(e){return x(this,Bs)?(x(this,Bs).push(e),O(this,Ls,e.line),O(this,zr,e.points),O(this,fo,0),{path:{d:this.toSVGPath()}}):x(this,Id).setLastElement(e)}removeLastElement(){if(!x(this,Bs))return x(this,Id).removeLastElement();x(this,Bs).pop(),O(this,cr,"");for(let e=0,t=x(this,Bs).length;e<t;e++){const{line:i,points:s}=x(this,Bs)[e];O(this,Ls,i),O(this,zr,s),O(this,fo,0),this.toSVGPath()}return{path:{d:x(this,cr)}}}toSVGPath(){const e=Lt.svgRound(x(this,Ls)[4]),t=Lt.svgRound(x(this,Ls)[5]);if(x(this,zr).length===2)return O(this,cr,`${x(this,cr)} M ${e} ${t} Z`),x(this,cr);if(x(this,zr).length<=6){const s=x(this,cr).lastIndexOf("M");O(this,cr,`${x(this,cr).slice(0,s)} M ${e} ${t}`),O(this,fo,6)}if(x(this,zr).length===4){const s=Lt.svgRound(x(this,Ls)[10]),r=Lt.svgRound(x(this,Ls)[11]);return O(this,cr,`${x(this,cr)} L ${s} ${r}`),O(this,fo,12),x(this,cr)}const i=[];x(this,fo)===0&&(i.push(`M ${e} ${t}`),O(this,fo,6));for(let s=x(this,fo),r=x(this,Ls).length;s<r;s+=6){const[a,o,l,c,h,u]=x(this,Ls).slice(s,s+6).map(Lt.svgRound);i.push(`C${a} ${o} ${l} ${c} ${h} ${u}`)}return O(this,cr,x(this,cr)+i.join(" ")),O(this,fo,x(this,Ls).length),x(this,cr)}getOutlines(e,t,i,s){const r=x(this,Bs).at(-1);return r.line=new Float32Array(r.line),r.points=new Float32Array(r.points),x(this,Id).build(x(this,Bs),e,t,i,x(this,Sd),x(this,dg),s),O(this,Gl,null),O(this,Ls,null),O(this,Bs,null),O(this,cr,null),x(this,Id)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}Gl=new WeakMap,Ls=new WeakMap,Bs=new WeakMap,Sd=new WeakMap,dg=new WeakMap,zr=new WeakMap,cr=new WeakMap,fo=new WeakMap,Id=new WeakMap,Ed=new WeakMap,Td=new WeakMap,fg=new WeakSet,X9=function(e,t){return Lt._normalizePoint(e,t,x(this,Ed),x(this,Td),x(this,Sd))};var jr,Hb,zb,Ua,Vl,ql,gg,mg,Rd,fr,yc,$T,eR,tR;class bx extends Lt{constructor(){super(...arguments);U(this,fr);U(this,jr);U(this,Hb,0);U(this,zb);U(this,Ua);U(this,Vl);U(this,ql);U(this,gg);U(this,mg);U(this,Rd)}build(t,i,s,r,a,o,l){O(this,Vl,i),O(this,ql,s),O(this,gg,r),O(this,mg,a),O(this,Rd,o),O(this,zb,l??0),O(this,Ua,t),F(this,fr,eR).call(this)}get thickness(){return x(this,Rd)}setLastElement(t){return x(this,Ua).push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return x(this,Ua).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:i}of x(this,Ua)){if(t.push(`M${Lt.svgRound(i[4])} ${Lt.svgRound(i[5])}`),i.length===6){t.push("Z");continue}if(i.length===12&&isNaN(i[6])){t.push(`L${Lt.svgRound(i[10])} ${Lt.svgRound(i[11])}`);continue}for(let s=6,r=i.length;s<r;s+=6){const[a,o,l,c,h,u]=i.subarray(s,s+6).map(Lt.svgRound);t.push(`C${a} ${o} ${l} ${c} ${h} ${u}`)}}return t.join("")}serialize([t,i,s,r],a){const o=[],l=[],[c,h,u,d]=F(this,fr,$T).call(this);let f,g,m,b,p,y,w,_,v;switch(x(this,mg)){case 0:v=Lt._rescale,f=t,g=i+r,m=s,b=-r,p=t+c*s,y=i+(1-h-d)*r,w=t+(c+u)*s,_=i+(1-h)*r;break;case 90:v=Lt._rescaleAndSwap,f=t,g=i,m=s,b=r,p=t+h*s,y=i+c*r,w=t+(h+d)*s,_=i+(c+u)*r;break;case 180:v=Lt._rescale,f=t+s,g=i,m=-s,b=r,p=t+(1-c-u)*s,y=i+h*r,w=t+(1-c)*s,_=i+(h+d)*r;break;case 270:v=Lt._rescaleAndSwap,f=t+s,g=i+r,m=-s,b=-r,p=t+(1-h-d)*s,y=i+(1-c-u)*r,w=t+(1-h)*s,_=i+(1-c)*r;break}for(const{line:C,points:k}of x(this,Ua))o.push(v(C,f,g,m,b,a?new Array(C.length):null)),l.push(v(k,f,g,m,b,a?new Array(k.length):null));return{lines:o,points:l,rect:[p,y,w,_]}}static deserialize(t,i,s,r,a,{paths:{lines:o,points:l},rotation:c,thickness:h}){const u=[];let d,f,g,m,b;switch(c){case 0:b=Lt._rescale,d=-t/s,f=i/r+1,g=1/s,m=-1/r;break;case 90:b=Lt._rescaleAndSwap,d=-i/r,f=-t/s,g=1/r,m=1/s;break;case 180:b=Lt._rescale,d=t/s+1,f=-i/r,g=-1/s,m=1/r;break;case 270:b=Lt._rescaleAndSwap,d=i/r+1,f=t/s+1,g=-1/r,m=-1/s;break}if(!o){o=[];for(const y of l){const w=y.length;if(w===2){o.push(new Float32Array([NaN,NaN,NaN,NaN,y[0],y[1]]));continue}if(w===4){o.push(new Float32Array([NaN,NaN,NaN,NaN,y[0],y[1],NaN,NaN,NaN,NaN,y[2],y[3]]));continue}const _=new Float32Array(3*(w-2));o.push(_);let[v,C,k,I]=y.subarray(0,4);_.set([NaN,NaN,NaN,NaN,v,C],0);for(let E=4;E<w;E+=2){const T=y[E],M=y[E+1];_.set(Lt.createBezierPoints(v,C,k,I,T,M),(E-2)*3),[v,C,k,I]=[k,I,T,M]}}}for(let y=0,w=o.length;y<w;y++)u.push({line:b(o[y].map(_=>_??NaN),d,f,g,m),points:b(l[y].map(_=>_??NaN),d,f,g,m)});const p=new this.prototype.constructor;return p.build(u,s,r,1,c,h,a),p}get box(){return x(this,jr)}updateProperty(t,i){return t==="stroke-width"?F(this,fr,tR).call(this,i):null}updateParentDimensions([t,i],s){const[r,a]=F(this,fr,yc).call(this);O(this,Vl,t),O(this,ql,i),O(this,gg,s);const[o,l]=F(this,fr,yc).call(this),c=o-r,h=l-a,u=x(this,jr);return u[0]-=c,u[1]-=h,u[2]+=2*c,u[3]+=2*h,u}updateRotation(t){return O(this,Hb,t),{path:{transform:this.rotationTransform}}}get viewBox(){return x(this,jr).map(Lt.svgRound).join(" ")}get defaultProperties(){const[t,i]=x(this,jr);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Lt.svgRound(t)} ${Lt.svgRound(i)}`}}}get rotationTransform(){const[,,t,i]=x(this,jr);let s=0,r=0,a=0,o=0,l=0,c=0;switch(x(this,Hb)){case 90:r=i/t,a=-t/i,l=t;break;case 180:s=-1,o=-1,l=t,c=i;break;case 270:r=-i/t,a=t/i,c=i;break;default:return""}return`matrix(${s} ${r} ${a} ${o} ${Lt.svgRound(l)} ${Lt.svgRound(c)})`}getPathResizingSVGProperties([t,i,s,r]){const[a,o]=F(this,fr,yc).call(this),[l,c,h,u]=x(this,jr);if(Math.abs(h-a)<=Lt.PRECISION||Math.abs(u-o)<=Lt.PRECISION){const b=t+s/2-(l+h/2),p=i+r/2-(c+u/2);return{path:{"transform-origin":`${Lt.svgRound(t)} ${Lt.svgRound(i)}`,transform:`${this.rotationTransform} translate(${b} ${p})`}}}const d=(s-2*a)/(h-2*a),f=(r-2*o)/(u-2*o),g=h/s,m=u/r;return{path:{"transform-origin":`${Lt.svgRound(l)} ${Lt.svgRound(c)}`,transform:`${this.rotationTransform} scale(${g} ${m}) translate(${Lt.svgRound(a)} ${Lt.svgRound(o)}) scale(${d} ${f}) translate(${Lt.svgRound(-a)} ${Lt.svgRound(-o)})`}}}getPathResizedSVGProperties([t,i,s,r]){const[a,o]=F(this,fr,yc).call(this),l=x(this,jr),[c,h,u,d]=l;if(l[0]=t,l[1]=i,l[2]=s,l[3]=r,Math.abs(u-a)<=Lt.PRECISION||Math.abs(d-o)<=Lt.PRECISION){const p=t+s/2-(c+u/2),y=i+r/2-(h+d/2);for(const{line:w,points:_}of x(this,Ua))Lt._translate(w,p,y,w),Lt._translate(_,p,y,_);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Lt.svgRound(t)} ${Lt.svgRound(i)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const f=(s-2*a)/(u-2*a),g=(r-2*o)/(d-2*o),m=-f*(c+a)+t+a,b=-g*(h+o)+i+o;if(f!==1||g!==1||m!==0||b!==0)for(const{line:p,points:y}of x(this,Ua))Lt._rescale(p,m,b,f,g,p),Lt._rescale(y,m,b,f,g,y);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Lt.svgRound(t)} ${Lt.svgRound(i)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,i],s){const[r,a]=s,o=x(this,jr),l=t-o[0],c=i-o[1];if(x(this,Vl)===r&&x(this,ql)===a)for(const{line:h,points:u}of x(this,Ua))Lt._translate(h,l,c,h),Lt._translate(u,l,c,u);else{const h=x(this,Vl)/r,u=x(this,ql)/a;O(this,Vl,r),O(this,ql,a);for(const{line:d,points:f}of x(this,Ua))Lt._rescale(d,l,c,h,u,d),Lt._rescale(f,l,c,h,u,f);o[2]*=h,o[3]*=u}return o[0]=t,o[1]=i,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${Lt.svgRound(t)} ${Lt.svgRound(i)}`}}}get defaultSVGProperties(){const t=x(this,jr);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${Lt.svgRound(t[0])} ${Lt.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}jr=new WeakMap,Hb=new WeakMap,zb=new WeakMap,Ua=new WeakMap,Vl=new WeakMap,ql=new WeakMap,gg=new WeakMap,mg=new WeakMap,Rd=new WeakMap,fr=new WeakSet,yc=function(t=x(this,Rd)){const i=x(this,zb)+t/2*x(this,gg);return x(this,mg)%180===0?[i/x(this,Vl),i/x(this,ql)]:[i/x(this,ql),i/x(this,Vl)]},$T=function(){const[t,i,s,r]=x(this,jr),[a,o]=F(this,fr,yc).call(this,0);return[t+a,i+o,s-2*a,r-2*o]},eR=function(){const t=O(this,jr,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:r}of x(this,Ua)){if(r.length<=12){for(let l=4,c=r.length;l<c;l+=6)sn.pointBoundingBox(r[l],r[l+1],t);continue}let a=r[4],o=r[5];for(let l=6,c=r.length;l<c;l+=6){const[h,u,d,f,g,m]=r.subarray(l,l+6);sn.bezierBoundingBox(a,o,h,u,d,f,g,m,t),a=g,o=m}}const[i,s]=F(this,fr,yc).call(this);t[0]=qr(t[0]-i,0,1),t[1]=qr(t[1]-s,0,1),t[2]=qr(t[2]+i,0,1),t[3]=qr(t[3]+s,0,1),t[2]-=t[0],t[3]-=t[1]},tR=function(t){const[i,s]=F(this,fr,yc).call(this);O(this,Rd,t);const[r,a]=F(this,fr,yc).call(this),[o,l]=[r-i,a-s],c=x(this,jr);return c[0]-=o,c[1]-=l,c[2]+=2*o,c[3]+=2*l,c};class ry extends ZT{constructor(e){super(),this._viewParameters=e,super.updateProperties({fill:"none",stroke:Ii._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,t){e==="stroke-width"&&(t??(t=this["stroke-width"]),t*=this._viewParameters.realScale),super.updateSVGProperty(e,t)}clone(){const e=new ry(this._viewParameters);return e.updateAll(this),e}}var D5,nR;const Yf=class Yf extends R3{constructor(t){super({...t,name:"inkEditor"});U(this,D5);this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,i){Ii.initialize(t,i),this._defaultDrawingOptions=new ry(i.viewParameters)}static getDefaultDrawingOptions(t){const i=this._defaultDrawingOptions.clone();return i.updateProperties(t),i}static get supportMultipleDrawings(){return!0}static get typesMap(){return zn(this,"typesMap",new Map([[Vn.INK_THICKNESS,"stroke-width"],[Vn.INK_COLOR,"stroke"],[Vn.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,i,s,r,a){return new yU(t,i,s,r,a,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,i,s,r,a,o){return bx.deserialize(t,i,s,r,a,o)}static async deserialize(t,i,s){let r=null;if(t instanceof v4){const{data:{inkLists:o,rect:l,rotation:c,id:h,color:u,opacity:d,borderStyle:{rawWidth:f},popupRef:g},parent:{page:{pageNumber:m}}}=t;r=t={annotationType:_n.INK,color:Array.from(u),thickness:f,opacity:d,paths:{points:o},boxes:null,pageIndex:m-1,rect:l.slice(0),rotation:c,annotationElementId:h,id:h,deleted:!1,popupRef:g}}const a=await super.deserialize(t,i,s);return a._initialData=r,a}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:i,parent:s}=this;i.updateSVGProperty("stroke-width"),s.drawLayer.updateProperties(t,i.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:i,opacity:s}){this._drawingOptions=Yf.getDefaultDrawingOptions({stroke:sn.makeHexColor(...t),"stroke-width":i,"stroke-opacity":s})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:i,points:s,rect:r}=this.serializeDraw(t),{_drawingOptions:{stroke:a,"stroke-opacity":o,"stroke-width":l}}=this,c={annotationType:_n.INK,color:Ii._colorManager.convert(a),opacity:o,thickness:l,paths:{lines:i,points:s},pageIndex:this.pageIndex,rect:r,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?(c.isCopy=!0,c):this.annotationElementId&&!F(this,D5,nR).call(this,c)?null:(c.id=this.annotationElementId,c)}renderAnnotationElement(t){const{points:i,rect:s}=this.serializeDraw(!1);return t.updateEdited({rect:s,thickness:this._drawingOptions["stroke-width"],points:i}),null}};D5=new WeakSet,nR=function(t){const{color:i,thickness:s,opacity:r,pageIndex:a}=this._initialData;return this._hasBeenMoved||this._hasBeenResized||t.color.some((o,l)=>o!==i[l])||t.thickness!==s||t.opacity!==r||t.pageIndex!==a},Ue(Yf,"_type","ink"),Ue(Yf,"_editorType",_n.INK),Ue(Yf,"_defaultDrawingOptions",null);let f7=Yf;class g7 extends bx{toSVGPath(){let e=super.toSVGPath();return e.endsWith("Z")||(e+="Z"),e}}const Vx=8,Mm=3;var Md,oi,m7,Wo,iR,sR,p7,Y9,rR,aR,oR,b7,x7,lR;class r0{static extractContoursFromText(e,{fontFamily:t,fontStyle:i,fontWeight:s},r,a,o,l){let c=new OffscreenCanvas(1,1),h=c.getContext("2d",{alpha:!1});const u=200,d=h.font=`${i} ${s} ${u}px ${t}`,{actualBoundingBoxLeft:f,actualBoundingBoxRight:g,actualBoundingBoxAscent:m,actualBoundingBoxDescent:b,fontBoundingBoxAscent:p,fontBoundingBoxDescent:y,width:w}=h.measureText(e),_=1.5,v=Math.ceil(Math.max(Math.abs(f)+Math.abs(g)||0,w)*_),C=Math.ceil(Math.max(Math.abs(m)+Math.abs(b)||u,Math.abs(p)+Math.abs(y)||u)*_);c=new OffscreenCanvas(v,C),h=c.getContext("2d",{alpha:!0,willReadFrequently:!0}),h.font=d,h.filter="grayscale(1)",h.fillStyle="white",h.fillRect(0,0,v,C),h.fillStyle="black",h.fillText(e,v*(_-1)/2,C*(3-_)/2);const k=F(this,oi,b7).call(this,h.getImageData(0,0,v,C).data),I=F(this,oi,oR).call(this,k),E=F(this,oi,x7).call(this,I),T=F(this,oi,p7).call(this,k,v,C,E);return this.processDrawnLines({lines:{curves:T,width:v,height:C},pageWidth:r,pageHeight:a,rotation:o,innerMargin:l,mustSmooth:!0,areContours:!0})}static process(e,t,i,s,r){const[a,o,l]=F(this,oi,lR).call(this,e),[c,h]=F(this,oi,aR).call(this,a,o,l,Math.hypot(o,l)*x(this,Md).sigmaSFactor,x(this,Md).sigmaR,x(this,Md).kernelSize),u=F(this,oi,x7).call(this,h),d=F(this,oi,p7).call(this,c,o,l,u);return this.processDrawnLines({lines:{curves:d,width:o,height:l},pageWidth:t,pageHeight:i,rotation:s,innerMargin:r,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:e,pageWidth:t,pageHeight:i,rotation:s,innerMargin:r,mustSmooth:a,areContours:o}){s%180!==0&&([t,i]=[i,t]);const{curves:l,width:c,height:h}=e,u=e.thickness??0,d=[],f=Math.min(t/c,i/h),g=f/t,m=f/i,b=[];for(const{points:y}of l){const w=a?F(this,oi,rR).call(this,y):y;if(!w)continue;b.push(w);const _=w.length,v=new Float32Array(_),C=new Float32Array(3*(_===2?2:_-2));if(d.push({line:C,points:v}),_===2){v[0]=w[0]*g,v[1]=w[1]*m,C.set([NaN,NaN,NaN,NaN,v[0],v[1]],0);continue}let[k,I,E,T]=w;k*=g,I*=m,E*=g,T*=m,v.set([k,I,E,T],0),C.set([NaN,NaN,NaN,NaN,k,I],0);for(let M=4;M<_;M+=2){const D=v[M]=w[M]*g,H=v[M+1]=w[M+1]*m;C.set(Lt.createBezierPoints(k,I,E,T,D,H),(M-2)*3),[k,I,E,T]=[E,T,D,H]}}if(d.length===0)return null;const p=o?new g7:new bx;return p.build(d,t,i,1,s,o?0:u,r),{outline:p,newCurves:b,areContours:o,thickness:u,width:c,height:h}}static async compressSignature({outlines:e,areContours:t,thickness:i,width:s,height:r}){let a=1/0,o=-1/0,l=0;for(const w of e){l+=w.length;for(let _=2,v=w.length;_<v;_++){const C=w[_]-w[_-2];a=Math.min(a,C),o=Math.max(o,C)}}let c;a>=-128&&o<=127?c=Int8Array:a>=-32768&&o<=32767?c=Int16Array:c=Int32Array;const h=e.length,u=Vx+Mm*h,d=new Uint32Array(u);let f=0;d[f++]=u*Uint32Array.BYTES_PER_ELEMENT+(l-2*h)*c.BYTES_PER_ELEMENT,d[f++]=0,d[f++]=s,d[f++]=r,d[f++]=t?0:1,d[f++]=Math.max(0,Math.floor(i??0)),d[f++]=h,d[f++]=c.BYTES_PER_ELEMENT;for(const w of e)d[f++]=w.length-2,d[f++]=w[0],d[f++]=w[1];const g=new CompressionStream("deflate-raw"),m=g.writable.getWriter();await m.ready,m.write(d);const b=c.prototype.constructor;for(const w of e){const _=new b(w.length-2);for(let v=2,C=w.length;v<C;v++)_[v-2]=w[v]-w[v-2];m.write(_)}m.close();const p=await new Response(g.readable).arrayBuffer(),y=new Uint8Array(p);return cE(y)}static async decompressSignature(e){try{const t=jL(e),{readable:i,writable:s}=new DecompressionStream("deflate-raw"),r=s.getWriter();await r.ready,r.write(t).then(async()=>{await r.ready,await r.close()}).catch(()=>{});let a=null,o=0;for await(const w of i)a||(a=new Uint8Array(new Uint32Array(w.buffer,0,4)[0])),a.set(w,o),o+=w.length;const l=new Uint32Array(a.buffer,0,a.length>>2),c=l[1];if(c!==0)throw new Error(`Invalid version: ${c}`);const h=l[2],u=l[3],d=l[4]===0,f=l[5],g=l[6],m=l[7],b=[],p=(Vx+Mm*g)*Uint32Array.BYTES_PER_ELEMENT;let y;switch(m){case Int8Array.BYTES_PER_ELEMENT:y=new Int8Array(a.buffer,p);break;case Int16Array.BYTES_PER_ELEMENT:y=new Int16Array(a.buffer,p);break;case Int32Array.BYTES_PER_ELEMENT:y=new Int32Array(a.buffer,p);break}o=0;for(let w=0;w<g;w++){const _=l[Mm*w+Vx],v=new Float32Array(_+2);b.push(v);for(let C=0;C<Mm-1;C++)v[C]=l[Mm*w+Vx+C+1];for(let C=0;C<_;C++)v[C+2]=v[C]+y[o++]}return{areContours:d,thickness:f,outlines:b,width:h,height:u}}catch(t){return vn(`decompressSignature: ${t}`),null}}}Md=new WeakMap,oi=new WeakSet,m7=function(e,t,i,s){return i-=e,s-=t,i===0?s>0?0:4:i===1?s+6:2-s},Wo=new WeakMap,iR=function(e,t,i,s,r,a,o){const l=F(this,oi,m7).call(this,i,s,r,a);for(let c=0;c<8;c++){const h=(-c+l-o+16)%8,u=x(this,Wo)[2*h],d=x(this,Wo)[2*h+1];if(e[(i+u)*t+(s+d)]!==0)return h}return-1},sR=function(e,t,i,s,r,a,o){const l=F(this,oi,m7).call(this,i,s,r,a);for(let c=0;c<8;c++){const h=(c+l+o+16)%8,u=x(this,Wo)[2*h],d=x(this,Wo)[2*h+1];if(e[(i+u)*t+(s+d)]!==0)return h}return-1},p7=function(e,t,i,s){const r=e.length,a=new Int32Array(r);for(let h=0;h<r;h++)a[h]=e[h]<=s?1:0;for(let h=1;h<i-1;h++)a[h*t]=a[h*t+t-1]=0;for(let h=0;h<t;h++)a[h]=a[t*i-1-h]=0;let o=1,l;const c=[];for(let h=1;h<i-1;h++){l=1;for(let u=1;u<t-1;u++){const d=h*t+u,f=a[d];if(f===0)continue;let g=h,m=u;if(f===1&&a[d-1]===0)o+=1,m-=1;else if(f>=1&&a[d+1]===0)o+=1,m+=1,f>1&&(l=f);else{f!==1&&(l=Math.abs(f));continue}const b=[u,h],p=m===u+1,y={isHole:p,points:b,id:o,parent:0};c.push(y);let w;for(const M of c)if(M.id===l){w=M;break}w?w.isHole?y.parent=p?w.parent:l:y.parent=p?l:w.parent:y.parent=p?l:0;const _=F(this,oi,iR).call(this,a,t,h,u,g,m,0);if(_===-1){a[d]=-o,a[d]!==1&&(l=Math.abs(a[d]));continue}let v=x(this,Wo)[2*_],C=x(this,Wo)[2*_+1];const k=h+v,I=u+C;g=k,m=I;let E=h,T=u;for(;;){const M=F(this,oi,sR).call(this,a,t,E,T,g,m,1);v=x(this,Wo)[2*M],C=x(this,Wo)[2*M+1];const D=E+v,H=T+C;b.push(H,D);const R=E*t+T;if(a[R+1]===0?a[R]=-o:a[R]===1&&(a[R]=o),D===h&&H===u&&E===k&&T===I){a[d]!==1&&(l=Math.abs(a[d]));break}else g=E,m=T,E=D,T=H}}}return c},Y9=function(e,t,i,s){if(i-t<=4){for(let k=t;k<i-2;k+=2)s.push(e[k],e[k+1]);return}const r=e[t],a=e[t+1],o=e[i-4]-r,l=e[i-3]-a,c=Math.hypot(o,l),h=o/c,u=l/c,d=h*a-u*r,f=l/o,g=1/c,m=Math.atan(f),b=Math.cos(m),p=Math.sin(m),y=g*(Math.abs(b)+Math.abs(p)),w=g*(1-y+y**2),_=Math.max(Math.atan(Math.abs(p+b)*w),Math.atan(Math.abs(p-b)*w));let v=0,C=t;for(let k=t+2;k<i-2;k+=2){const I=Math.abs(d-h*e[k+1]+u*e[k]);I>v&&(C=k,v=I)}v>(c*_)**2?(F(this,oi,Y9).call(this,e,t,C+2,s),F(this,oi,Y9).call(this,e,C,i,s)):s.push(r,a)},rR=function(e){const t=[],i=e.length;return F(this,oi,Y9).call(this,e,0,i,t),t.push(e[i-2],e[i-1]),t.length<=4?null:t},aR=function(e,t,i,s,r,a){const o=new Float32Array(a**2),l=-2*s**2,c=a>>1;for(let m=0;m<a;m++){const b=(m-c)**2;for(let p=0;p<a;p++)o[m*a+p]=Math.exp((b+(p-c)**2)/l)}const h=new Float32Array(256),u=-2*r**2;for(let m=0;m<256;m++)h[m]=Math.exp(m**2/u);const d=e.length,f=new Uint8Array(d),g=new Uint32Array(256);for(let m=0;m<i;m++)for(let b=0;b<t;b++){const p=m*t+b,y=e[p];let w=0,_=0;for(let C=0;C<a;C++){const k=m+C-c;if(!(k<0||k>=i))for(let I=0;I<a;I++){const E=b+I-c;if(E<0||E>=t)continue;const T=e[k*t+E],M=o[C*a+I]*h[Math.abs(T-y)];w+=T*M,_+=M}}const v=f[p]=Math.round(w/_);g[v]++}return[f,g]},oR=function(e){const t=new Uint32Array(256);for(const i of e)t[i]++;return t},b7=function(e){const t=e.length,i=new Uint8ClampedArray(t>>2);let s=-1/0,r=1/0;for(let o=0,l=i.length;o<l;o++){if(e[(o<<2)+3]===0){s=i[o]=255;continue}const h=i[o]=e[o<<2];h>s&&(s=h),h<r&&(r=h)}const a=255/(s-r);for(let o=0;o<t;o++)i[o]=(i[o]-r)*a;return i},x7=function(e){let t,i=-1/0,s=-1/0;const r=e.findIndex(l=>l!==0);let a=r,o=r;for(t=r;t<256;t++){const l=e[t];l>i&&(t-a>s&&(s=t-a,o=t-1),i=l,a=t)}for(t=o-1;t>=0&&!(e[t]>e[t+1]);t--);return t},lR=function(e){const t=e,{width:i,height:s}=e,{maxDim:r}=x(this,Md);let a=i,o=s;if(i>r||s>r){let d=i,f=s,g=Math.log2(Math.max(i,s)/r);const m=Math.floor(g);g=g===m?m-1:m;for(let p=0;p<g;p++){a=Math.ceil(d/2),o=Math.ceil(f/2);const y=new OffscreenCanvas(a,o);y.getContext("2d").drawImage(e,0,0,d,f,0,0,a,o),d=a,f=o,e!==t&&e.close(),e=y.transferToImageBitmap()}const b=Math.min(r/a,r/o);a=Math.round(a*b),o=Math.round(o*b)}const c=new OffscreenCanvas(a,o).getContext("2d",{willReadFrequently:!0});c.filter="grayscale(1)",c.drawImage(e,0,0,e.width,e.height,0,0,a,o);const h=c.getImageData(0,0,a,o).data;return[F(this,oi,b7).call(this,h),a,o]},U(r0,oi),U(r0,Md,{maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16}),U(r0,Wo,new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]));class k4 extends ZT{constructor(){super(),super.updateProperties({fill:Ii._defaultLineColor,"stroke-width":0})}clone(){const e=new k4;return e.updateAll(this),e}}class C4 extends ry{constructor(e){super(e),super.updateProperties({stroke:Ii._defaultLineColor,"stroke-width":1})}clone(){const e=new C4(this._viewParameters);return e.updateAll(this),e}}var xh,Wl,yh,Pd;const Sa=class Sa extends R3{constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"});U(this,xh,!1);U(this,Wl,null);U(this,yh,null);U(this,Pd,null);this._willKeepAspectRatio=!0,O(this,yh,t.signatureData||null),O(this,Wl,null),this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,i){Ii.initialize(t,i),this._defaultDrawingOptions=new k4,this._defaultDrawnSignatureOptions=new C4(i.viewParameters)}static getDefaultDrawingOptions(t){const i=this._defaultDrawingOptions.clone();return i.updateProperties(t),i}static get supportMultipleDrawings(){return!1}static get typesMap(){return zn(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!x(this,Wl)}}static computeTelemetryFinalData(t){const i=t.get("hasDescription");return{hasAltText:i.get(!0)??0,hasNoAltText:i.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,i;const{_isCopy:s}=this;if(s&&(this._isCopy=!1,t=this.x,i=this.y),super.render(),this._drawId===null)if(x(this,yh)){const{lines:r,mustSmooth:a,areContours:o,description:l,uuid:c,heightInPage:h}=x(this,yh),{rawDims:{pageWidth:u,pageHeight:d},rotation:f}=this.parent.viewport,g=r0.processDrawnLines({lines:r,pageWidth:u,pageHeight:d,rotation:f,innerMargin:Sa._INNER_MARGIN,mustSmooth:a,areContours:o});this.addSignature(g,h,l,c)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);return s&&(this._isCopy=!0,this._moveAfterPaste(t,i)),this.div}setUuid(t){O(this,Pd,t),this.addEditToolbar()}getUuid(){return x(this,Pd)}get description(){return x(this,Wl)}set description(t){O(this,Wl,t),super.addEditToolbar().then(i=>{i==null||i.updateEditSignatureButton(t)})}getSignaturePreview(){const{newCurves:t,areContours:i,thickness:s,width:r,height:a}=x(this,yh),o=Math.max(r,a),l=r0.processDrawnLines({lines:{curves:t.map(c=>({points:c})),thickness:s,width:r,height:a},pageWidth:o,pageHeight:o,rotation:0,innerMargin:0,mustSmooth:!1,areContours:i});return{areContours:i,outline:l.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(t,i,s,r){const{x:a,y:o}=this,{outline:l}=O(this,yh,t);O(this,xh,l instanceof g7),this.description=s,this.div.setAttribute("data-l10n-args",JSON.stringify({description:s}));let c;x(this,xh)?c=Sa.getDefaultDrawingOptions():(c=Sa._defaultDrawnSignatureOptions.clone(),c.updateProperties({"stroke-width":l.thickness})),this._addOutlines({drawOutlines:l,drawingOptions:c});const[h,u]=this.parentDimensions,[,d]=this.pageDimensions;let f=i/d;f=f>=1?.5:f,this.width*=f/this.height,this.width>=1&&(f*=.9/this.width,this.width=.9),this.height=f,this.setDims(h*this.width,u*this.height),this.x=a,this.y=o,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(r),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!r,hasDescription:!!s}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:i,pageHeight:s},rotation:r}=this.parent.viewport;return r0.process(t,i,s,r,Sa._INNER_MARGIN)}getFromText(t,i){const{rawDims:{pageWidth:s,pageHeight:r},rotation:a}=this.parent.viewport;return r0.extractContoursFromText(t,i,s,r,a,Sa._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:i,pageHeight:s},rotation:r}=this.parent.viewport;return r0.processDrawnLines({lines:t,pageWidth:i,pageHeight:s,rotation:r,innerMargin:Sa._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:i}){t?this._drawingOptions=Sa.getDefaultDrawingOptions():(this._drawingOptions=Sa._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":i}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:i,points:s,rect:r}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":a}}=this,o={annotationType:_n.SIGNATURE,isSignature:!0,areContours:x(this,xh),color:[0,0,0],thickness:x(this,xh)?0:a,pageIndex:this.pageIndex,rect:r,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?(o.paths={lines:i,points:s},o.uuid=x(this,Pd),o.isCopy=!0):o.lines=i,x(this,Wl)&&(o.accessibilityData={type:"Figure",alt:x(this,Wl)}),o}static deserializeDraw(t,i,s,r,a,o){return o.areContours?g7.deserialize(t,i,s,r,a,o):bx.deserialize(t,i,s,r,a,o)}static async deserialize(t,i,s){var a;const r=await super.deserialize(t,i,s);return O(r,xh,t.areContours),O(r,Wl,((a=t.accessibilityData)==null?void 0:a.alt)||""),O(r,Pd,t.uuid),r}};xh=new WeakMap,Wl=new WeakMap,yh=new WeakMap,Pd=new WeakMap,Ue(Sa,"_type","signature"),Ue(Sa,"_editorType",_n.SIGNATURE),Ue(Sa,"_defaultDrawingOptions",null);let y7=Sa;var Oi,Us,wh,$c,_h,pg,e0,Nd,Kl,Ha,bg,ei,up,dp,J9,Z9,Q9,_7,$9,cR;class w7 extends Ii{constructor(t){super({...t,name:"stampEditor"});U(this,ei);U(this,Oi,null);U(this,Us,null);U(this,wh,null);U(this,$c,null);U(this,_h,null);U(this,pg,"");U(this,e0,null);U(this,Nd,!1);U(this,Kl,null);U(this,Ha,!1);U(this,bg,!1);O(this,$c,t.bitmapUrl),O(this,_h,t.bitmapFile),this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,i){Ii.initialize(t,i)}static isHandlingMimeForPasting(t){return f8.includes(t)}static paste(t,i){i.pasteEditor({mode:_n.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var t;return{type:"stamp",hasAltText:!!((t=this.altTextData)!=null&&t.altText)}}static computeTelemetryFinalData(t){const i=t.get("hasAltText");return{hasAltText:i.get(!0)??0,hasNoAltText:i.get(!1)??0}}async mlGuessAltText(t=null,i=!0){if(this.hasAltTextData())return null;const{mlManager:s}=this._uiManager;if(!s)throw new Error("No ML.");if(!await s.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:r,width:a,height:o}=t||this.copyCanvas(null,null,!0).imageData,l=await s.guess({name:"altText",request:{data:r,width:a,height:o,channels:r.length/(a*o)}});if(!l)throw new Error("No response from the AI service.");if(l.error)throw new Error("Error from the AI service.");if(l.cancel)return null;if(!l.output)throw new Error("No valid response from the AI service.");const c=l.output;return await this.setGuessedAltText(c),i&&!this.hasAltTextData()&&(this.altTextData={alt:c,decorative:!1}),c}remove(){var t;x(this,Us)&&(O(this,Oi,null),this._uiManager.imageManager.deleteId(x(this,Us)),(t=x(this,e0))==null||t.remove(),O(this,e0,null),x(this,Kl)&&(clearTimeout(x(this,Kl)),O(this,Kl,null))),super.remove()}rebuild(){if(!this.parent){x(this,Us)&&F(this,ei,J9).call(this);return}super.rebuild(),this.div!==null&&(x(this,Us)&&x(this,e0)===null&&F(this,ei,J9).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(x(this,wh)||x(this,Oi)||x(this,$c)||x(this,_h)||x(this,Us)||x(this,Nd))}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let t,i;return this._isCopy&&(t=this.x,i=this.y),super.render(),this.div.hidden=!0,this.createAltText(),x(this,Nd)||(x(this,Oi)?F(this,ei,Z9).call(this):F(this,ei,J9).call(this)),this._isCopy&&this._moveAfterPaste(t,i),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,i){const{id:s,bitmap:r}=this._uiManager.imageManager.getFromCanvas(t,i);i.remove(),s&&this._uiManager.imageManager.isValidId(s)&&(O(this,Us,s),r&&O(this,Oi,r),O(this,Nd,!1),F(this,ei,Z9).call(this))}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;x(this,Kl)!==null&&clearTimeout(x(this,Kl)),O(this,Kl,setTimeout(()=>{O(this,Kl,null),F(this,ei,_7).call(this)},200))}copyCanvas(t,i,s=!1){var f;t||(t=224);const{width:r,height:a}=x(this,Oi),o=new cc;let l=x(this,Oi),c=r,h=a,u=null;if(i){if(r>i||a>i){const I=Math.min(i/r,i/a);c=Math.floor(r*I),h=Math.floor(a*I)}u=document.createElement("canvas");const g=u.width=Math.ceil(c*o.sx),m=u.height=Math.ceil(h*o.sy);x(this,Ha)||(l=F(this,ei,Q9).call(this,g,m));const b=u.getContext("2d");b.filter=this._uiManager.hcmFilter;let p="white",y="#cfcfd8";this._uiManager.hcmFilter!=="none"?y="black":(f=window.matchMedia)!=null&&f.call(window,"(prefers-color-scheme: dark)").matches&&(p="#8f8f9d",y="#42414d");const w=15,_=w*o.sx,v=w*o.sy,C=new OffscreenCanvas(_*2,v*2),k=C.getContext("2d");k.fillStyle=p,k.fillRect(0,0,_*2,v*2),k.fillStyle=y,k.fillRect(0,0,_,v),k.fillRect(_,v,_,v),b.fillStyle=b.createPattern(C,"repeat"),b.fillRect(0,0,g,m),b.drawImage(l,0,0,l.width,l.height,0,0,g,m)}let d=null;if(s){let g,m;if(o.symmetric&&l.width<t&&l.height<t)g=l.width,m=l.height;else if(l=x(this,Oi),r>t||a>t){const y=Math.min(t/r,t/a);g=Math.floor(r*y),m=Math.floor(a*y),x(this,Ha)||(l=F(this,ei,Q9).call(this,g,m))}const p=new OffscreenCanvas(g,m).getContext("2d",{willReadFrequently:!0});p.drawImage(l,0,0,l.width,l.height,0,0,g,m),d={width:g,height:m,data:p.getImageData(0,0,g,m).data}}return{canvas:u,width:c,height:h,imageData:d}}static async deserialize(t,i,s){var b;let r=null,a=!1;if(t instanceof CT){const{data:{rect:p,rotation:y,id:w,structParent:_,popupRef:v},container:C,parent:{page:{pageNumber:k}},canvas:I}=t;let E,T;I?(delete t.canvas,{id:E,bitmap:T}=s.imageManager.getFromCanvas(C.id,I),I.remove()):(a=!0,t._hasNoCanvas=!0);const M=((b=await i._structTree.getAriaAttributes(`${g4}${w}`))==null?void 0:b.get("aria-label"))||"";r=t={annotationType:_n.STAMP,bitmapId:E,bitmap:T,pageIndex:k-1,rect:p.slice(0),rotation:y,annotationElementId:w,id:w,deleted:!1,accessibilityData:{decorative:!1,altText:M},isSvg:!1,structParent:_,popupRef:v}}const o=await super.deserialize(t,i,s),{rect:l,bitmap:c,bitmapUrl:h,bitmapId:u,isSvg:d,accessibilityData:f}=t;a?(s.addMissingCanvas(t.id,o),O(o,Nd,!0)):u&&s.imageManager.isValidId(u)?(O(o,Us,u),c&&O(o,Oi,c)):O(o,$c,h),O(o,Ha,d);const[g,m]=o.pageDimensions;return o.width=(l[2]-l[0])/g,o.height=(l[3]-l[1])/m,f&&(o.altTextData=f),o._initialData=r,O(o,bg,!!r),o}serialize(t=!1,i=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s={annotationType:_n.STAMP,bitmapId:x(this,Us),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:x(this,Ha),structTreeParentId:this._structTreeParentId};if(t)return s.bitmapUrl=F(this,ei,$9).call(this,!0),s.accessibilityData=this.serializeAltText(!0),s.isCopy=!0,s;const{decorative:r,altText:a}=this.serializeAltText(!1);if(!r&&a&&(s.accessibilityData={type:"Figure",alt:a}),this.annotationElementId){const l=F(this,ei,cR).call(this,s);if(l.isSame)return null;l.isSameAltText?delete s.accessibilityData:s.accessibilityData.structParent=this._initialData.structParent??-1}if(s.id=this.annotationElementId,i===null)return s;i.stamps||(i.stamps=new Map);const o=x(this,Ha)?(s.rect[2]-s.rect[0])*(s.rect[3]-s.rect[1]):null;if(!i.stamps.has(x(this,Us)))i.stamps.set(x(this,Us),{area:o,serialized:s}),s.bitmap=F(this,ei,$9).call(this,!1);else if(x(this,Ha)){const l=i.stamps.get(x(this,Us));o>l.area&&(l.area=o,l.serialized.bitmap.close(),l.serialized.bitmap=F(this,ei,$9).call(this,!1))}return s}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}}Oi=new WeakMap,Us=new WeakMap,wh=new WeakMap,$c=new WeakMap,_h=new WeakMap,pg=new WeakMap,e0=new WeakMap,Nd=new WeakMap,Kl=new WeakMap,Ha=new WeakMap,bg=new WeakMap,ei=new WeakSet,up=function(t,i=!1){if(!t){this.remove();return}O(this,Oi,t.bitmap),i||(O(this,Us,t.id),O(this,Ha,t.isSvg)),t.file&&O(this,pg,t.file.name),F(this,ei,Z9).call(this)},dp=function(){if(O(this,wh,null),this._uiManager.enableWaiting(!1),!!x(this,e0)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&x(this,Oi)){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&x(this,Oi)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},J9=function(){if(x(this,Us)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(x(this,Us)).then(s=>F(this,ei,up).call(this,s,!0)).finally(()=>F(this,ei,dp).call(this));return}if(x(this,$c)){const s=x(this,$c);O(this,$c,null),this._uiManager.enableWaiting(!0),O(this,wh,this._uiManager.imageManager.getFromUrl(s).then(r=>F(this,ei,up).call(this,r)).finally(()=>F(this,ei,dp).call(this)));return}if(x(this,_h)){const s=x(this,_h);O(this,_h,null),this._uiManager.enableWaiting(!0),O(this,wh,this._uiManager.imageManager.getFromFile(s).then(r=>F(this,ei,up).call(this,r)).finally(()=>F(this,ei,dp).call(this)));return}const t=document.createElement("input");t.type="file",t.accept=f8.join(",");const i=this._uiManager._signal;O(this,wh,new Promise(s=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const r=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),F(this,ei,up).call(this,r)}s()},{signal:i}),t.addEventListener("cancel",()=>{this.remove(),s()},{signal:i})}).finally(()=>F(this,ei,dp).call(this))),t.click()},Z9=function(){var u;const{div:t}=this;let{width:i,height:s}=x(this,Oi);const[r,a]=this.pageDimensions,o=.75;if(this.width)i=this.width*r,s=this.height*a;else if(i>o*r||s>o*a){const d=Math.min(o*r/i,o*a/s);i*=d,s*=d}const[l,c]=this.parentDimensions;this.setDims(i*l/r,s*c/a),this._uiManager.enableWaiting(!1);const h=O(this,e0,document.createElement("canvas"));h.setAttribute("role","img"),this.addContainer(h),this.width=i/r,this.height=s/a,(u=this._initialOptions)!=null&&u.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),F(this,ei,_7).call(this),x(this,bg)||(this.parent.addUndoableEditor(this),O(this,bg,!0)),this._reportTelemetry({action:"inserted_image"}),x(this,pg)&&this.div.setAttribute("aria-description",x(this,pg)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")},Q9=function(t,i){const{width:s,height:r}=x(this,Oi);let a=s,o=r,l=x(this,Oi);for(;a>2*t||o>2*i;){const c=a,h=o;a>2*t&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2)),o>2*i&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2));const u=new OffscreenCanvas(a,o);u.getContext("2d").drawImage(l,0,0,c,h,0,0,a,o),l=u.transferToImageBitmap()}return l},_7=function(){const[t,i]=this.parentDimensions,{width:s,height:r}=this,a=new cc,o=Math.ceil(s*t*a.sx),l=Math.ceil(r*i*a.sy),c=x(this,e0);if(!c||c.width===o&&c.height===l)return;c.width=o,c.height=l;const h=x(this,Ha)?x(this,Oi):F(this,ei,Q9).call(this,o,l),u=c.getContext("2d");u.filter=this._uiManager.hcmFilter,u.drawImage(h,0,0,h.width,h.height,0,0,o,l)},$9=function(t){if(t){if(x(this,Ha)){const r=this._uiManager.imageManager.getSvgUrl(x(this,Us));if(r)return r}const i=document.createElement("canvas");return{width:i.width,height:i.height}=x(this,Oi),i.getContext("2d").drawImage(x(this,Oi),0,0),i.toDataURL()}if(x(this,Ha)){const[i,s]=this.pageDimensions,r=Math.round(this.width*i*qh.PDF_TO_CSS_UNITS),a=Math.round(this.height*s*qh.PDF_TO_CSS_UNITS),o=new OffscreenCanvas(r,a);return o.getContext("2d").drawImage(x(this,Oi),0,0,x(this,Oi).width,x(this,Oi).height,0,0,r,a),o.transferToImageBitmap()}return structuredClone(x(this,Oi))},cR=function(t){var o;const{pageIndex:i,accessibilityData:{altText:s}}=this._initialData,r=t.pageIndex===i,a=(((o=t.accessibilityData)==null?void 0:o.alt)||"")===s;return{isSame:!this._hasBeenMoved&&!this._hasBeenResized&&r&&a,isSameAltText:a}},Ue(w7,"_type","stamp"),Ue(w7,"_editorType",_n.STAMP);var Od,xg,Xl,vh,t0,za,kh,yg,Dd,Ko,n0,Hs,i0,Ch,wg,Yt,Ah,Fi,hR,Sl,k7,C7,e3;const Oo=class Oo{constructor({uiManager:e,pageIndex:t,div:i,structTreeLayer:s,accessibilityManager:r,annotationLayer:a,drawLayer:o,textLayer:l,viewport:c,l10n:h}){U(this,Fi);U(this,Od);U(this,xg,!1);U(this,Xl,null);U(this,vh,null);U(this,t0,null);U(this,za,new Map);U(this,kh,!1);U(this,yg,!1);U(this,Dd,!1);U(this,Ko,null);U(this,n0,null);U(this,Hs,null);U(this,i0,null);U(this,Ch,null);U(this,wg,-1);U(this,Yt);const u=[...x(Oo,Ah).values()];if(!Oo._initialized){Oo._initialized=!0;for(const d of u)d.initialize(h,e)}e.registerEditorTypes(u),O(this,Yt,e),this.pageIndex=t,this.div=i,O(this,Od,r),O(this,Xl,a),this.viewport=c,O(this,Hs,l),this.drawLayer=o,this._structTree=s,x(this,Yt).addLayer(this)}get isEmpty(){return x(this,za).size===0}get isInvisible(){return this.isEmpty&&x(this,Yt).getMode()===_n.NONE}updateToolbar(e){x(this,Yt).updateToolbar(e)}updateMode(e=x(this,Yt).getMode()){switch(F(this,Fi,e3).call(this),e){case _n.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case _n.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case _n.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;for(const i of x(Oo,Ah).values())t.toggle(`${i._type}Editing`,e===i._editorType);this.div.hidden=!1}hasTextLayer(e){var t;return e===((t=x(this,Hs))==null?void 0:t.div)}setEditingState(e){x(this,Yt).setEditingState(e)}addCommands(e){x(this,Yt).addCommands(e)}cleanUndoStack(e){x(this,Yt).cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){var t;(t=x(this,Xl))==null||t.div.classList.toggle("disabled",!e)}async enable(){var i;O(this,Dd,!0),this.div.tabIndex=0,this.togglePointerEvents(!0),(i=x(this,Ch))==null||i.abort(),O(this,Ch,null);const e=new Set;for(const s of x(this,za).values())s.enableEditing(),s.show(!0),s.annotationElementId&&(x(this,Yt).removeChangedExistingAnnotation(s),e.add(s.annotationElementId));if(!x(this,Xl)){O(this,Dd,!1);return}const t=x(this,Xl).getEditableAnnotations();for(const s of t){if(s.hide(),x(this,Yt).isDeletedAnnotationElement(s.data.id)||e.has(s.data.id))continue;const r=await this.deserialize(s);r&&(this.addOrRebuild(r),r.enableEditing())}O(this,Dd,!1)}disable(){var s;if(O(this,yg,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1),x(this,Hs)&&!x(this,Ch)){O(this,Ch,new AbortController);const r=x(this,Yt).combinedSignal(x(this,Ch));x(this,Hs).div.addEventListener("pointerdown",a=>{const{clientX:l,clientY:c,timeStamp:h}=a,u=x(this,wg);if(h-u>500){O(this,wg,h);return}O(this,wg,-1);const{classList:d}=this.div;d.toggle("getElements",!0);const f=document.elementsFromPoint(l,c);if(d.toggle("getElements",!1),!this.div.contains(f[0]))return;let g;const m=new RegExp(`^${sE}[0-9]+$`);for(const p of f)if(m.test(p.id)){g=p.id;break}if(!g)return;const b=x(this,za).get(g);(b==null?void 0:b.annotationElementId)===null&&(a.stopPropagation(),a.preventDefault(),b.dblclick())},{signal:r,capture:!0})}const e=new Map,t=new Map;for(const r of x(this,za).values())if(r.disableEditing(),!!r.annotationElementId){if(r.serialize()!==null){e.set(r.annotationElementId,r);continue}else t.set(r.annotationElementId,r);(s=this.getEditableAnnotation(r.annotationElementId))==null||s.show(),r.remove()}if(x(this,Xl)){const r=x(this,Xl).getEditableAnnotations();for(const a of r){const{id:o}=a.data;if(x(this,Yt).isDeletedAnnotationElement(o))continue;let l=t.get(o);if(l){l.resetAnnotationElement(a),l.show(!1),a.show();continue}l=e.get(o),l&&(x(this,Yt).addChangedExistingAnnotation(l),l.renderAnnotationElement(a)&&l.show(!1)),a.show()}}F(this,Fi,e3).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:i}=this.div;for(const r of x(Oo,Ah).values())i.remove(`${r._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),O(this,yg,!1)}getEditableAnnotation(e){var t;return((t=x(this,Xl))==null?void 0:t.getEditableAnnotation(e))||null}setActiveEditor(e){x(this,Yt).getActive()!==e&&x(this,Yt).setActiveEditor(e)}enableTextSelection(){var e;if(this.div.tabIndex=-1,(e=x(this,Hs))!=null&&e.div&&!x(this,i0)){O(this,i0,new AbortController);const t=x(this,Yt).combinedSignal(x(this,i0));x(this,Hs).div.addEventListener("pointerdown",F(this,Fi,hR).bind(this),{signal:t}),x(this,Hs).div.classList.add("highlighting")}}disableTextSelection(){var e;this.div.tabIndex=0,(e=x(this,Hs))!=null&&e.div&&x(this,i0)&&(x(this,i0).abort(),O(this,i0,null),x(this,Hs).div.classList.remove("highlighting"))}enableClick(){if(x(this,vh))return;O(this,vh,new AbortController);const e=x(this,Yt).combinedSignal(x(this,vh));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){var e;(e=x(this,vh))==null||e.abort(),O(this,vh,null)}attach(e){x(this,za).set(e.id,e);const{annotationElementId:t}=e;t&&x(this,Yt).isDeletedAnnotationElement(t)&&x(this,Yt).removeDeletedAnnotationElement(e)}detach(e){var t;x(this,za).delete(e.id),(t=x(this,Od))==null||t.removePointerInTextLayer(e.contentDiv),!x(this,yg)&&e.annotationElementId&&x(this,Yt).addDeletedAnnotationElement(e)}remove(e){this.detach(e),x(this,Yt).removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){var t;e.parent!==this&&(e.parent&&e.annotationElementId&&(x(this,Yt).addDeletedAnnotationElement(e.annotationElementId),Ii.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),(t=e.parent)==null||t.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),x(this,Yt).addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!x(this,Dd)),x(this,Yt).addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){var i;if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!x(this,t0)&&(e._focusEventsAllowed=!1,O(this,t0,setTimeout(()=>{O(this,t0,null),e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:x(this,Yt)._signal}),t.focus())},0))),e._structTreeParentId=(i=x(this,Od))==null?void 0:i.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||(e.parent=this),e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),i=()=>{e.remove()};this.addCommands({cmd:t,undo:i,mustExec:!1})}getNextId(){return x(this,Yt).getId()}combinedSignal(e){return x(this,Yt).combinedSignal(e)}canCreateNewEmptyEditor(){var e;return(e=x(this,Fi,Sl))==null?void 0:e.canCreateNewEmptyEditor()}async pasteEditor(e,t){this.updateToolbar(e),await x(this,Yt).updateMode(e.mode);const{offsetX:i,offsetY:s}=F(this,Fi,C7).call(this),r=this.getNextId(),a=F(this,Fi,k7).call(this,{parent:this,id:r,x:i,y:s,uiManager:x(this,Yt),isCentered:!0,...t});a&&this.add(a)}async deserialize(e){var t;return await((t=x(Oo,Ah).get(e.annotationType??e.annotationEditorType))==null?void 0:t.deserialize(e,this,x(this,Yt)))||null}createAndAddNewEditor(e,t,i={}){const s=this.getNextId(),r=F(this,Fi,k7).call(this,{parent:this,id:s,x:e.offsetX,y:e.offsetY,uiManager:x(this,Yt),isCentered:t,...i});return r&&this.add(r),r}addNewEditor(e={}){this.createAndAddNewEditor(F(this,Fi,C7).call(this),!0,e)}setSelected(e){x(this,Yt).setSelected(e)}toggleSelected(e){x(this,Yt).toggleSelected(e)}unselect(e){x(this,Yt).unselect(e)}pointerup(e){var s;const{isMac:t}=br.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div||!x(this,kh)||(O(this,kh,!1),(s=x(this,Fi,Sl))!=null&&s.isDrawer&&x(this,Fi,Sl).supportMultipleDrawings))return;if(!x(this,xg)){O(this,xg,!0);return}const i=x(this,Yt).getMode();if(i===_n.STAMP||i===_n.SIGNATURE){x(this,Yt).unselectAll();return}this.createAndAddNewEditor(e,!1)}pointerdown(e){var s;if(x(this,Yt).getMode()===_n.HIGHLIGHT&&this.enableTextSelection(),x(this,kh)){O(this,kh,!1);return}const{isMac:t}=br.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(O(this,kh,!0),(s=x(this,Fi,Sl))!=null&&s.isDrawer){this.startDrawingSession(e);return}const i=x(this,Yt).getActive();O(this,xg,!i||i.isEmpty())}startDrawingSession(e){if(this.div.focus({preventScroll:!0}),x(this,Ko)){x(this,Fi,Sl).startDrawing(this,x(this,Yt),!1,e);return}x(this,Yt).setCurrentDrawingSession(this),O(this,Ko,new AbortController);const t=x(this,Yt).combinedSignal(x(this,Ko));this.div.addEventListener("blur",({relatedTarget:i})=>{i&&!this.div.contains(i)&&(O(this,n0,null),this.commitOrRemove())},{signal:t}),x(this,Fi,Sl).startDrawing(this,x(this,Yt),!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&O(this,n0,t);return}x(this,n0)&&setTimeout(()=>{var t;(t=x(this,n0))==null||t.focus(),O(this,n0,null)},0)}endDrawingSession(e=!1){return x(this,Ko)?(x(this,Yt).setCurrentDrawingSession(null),x(this,Ko).abort(),O(this,Ko,null),O(this,n0,null),x(this,Fi,Sl).endDrawing(e)):null}findNewParent(e,t,i){const s=x(this,Yt).findParent(t,i);return s===null||s===this?!1:(s.changeParent(e),!0)}commitOrRemove(){return x(this,Ko)?(this.endDrawingSession(),!0):!1}onScaleChanging(){x(this,Ko)&&x(this,Fi,Sl).onScaleChangingWhenDrawing(this)}destroy(){var e,t;this.commitOrRemove(),((e=x(this,Yt).getActive())==null?void 0:e.parent)===this&&(x(this,Yt).commitOrRemove(),x(this,Yt).setActiveEditor(null)),x(this,t0)&&(clearTimeout(x(this,t0)),O(this,t0,null));for(const i of x(this,za).values())(t=x(this,Od))==null||t.removePointerInTextLayer(i.contentDiv),i.setParent(null),i.isAttachedToDOM=!1,i.div.remove();this.div=null,x(this,za).clear(),x(this,Yt).removeLayer(this)}render({viewport:e}){this.viewport=e,Zd(this.div,e);for(const t of x(this,Yt).getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){x(this,Yt).commitOrRemove(),F(this,Fi,e3).call(this);const t=this.viewport.rotation,i=e.rotation;if(this.viewport=e,Zd(this.div,{rotation:i}),t!==i)for(const s of x(this,za).values())s.rotate(i)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return x(this,Yt).viewParameters.realScale}};Od=new WeakMap,xg=new WeakMap,Xl=new WeakMap,vh=new WeakMap,t0=new WeakMap,za=new WeakMap,kh=new WeakMap,yg=new WeakMap,Dd=new WeakMap,Ko=new WeakMap,n0=new WeakMap,Hs=new WeakMap,i0=new WeakMap,Ch=new WeakMap,wg=new WeakMap,Yt=new WeakMap,Ah=new WeakMap,Fi=new WeakSet,hR=function(e){x(this,Yt).unselectAll();const{target:t}=e;if(t===x(this,Hs).div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&x(this,Hs).div.contains(t)){const{isMac:i}=br.platform;if(e.button!==0||e.ctrlKey&&i)return;x(this,Yt).showAllEditors("highlight",!0,!0),x(this,Hs).div.classList.add("free"),this.toggleDrawing(),T3.startHighlighting(this,x(this,Yt).direction==="ltr",{target:x(this,Hs).div,x:e.x,y:e.y}),x(this,Hs).div.addEventListener("pointerup",()=>{x(this,Hs).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:x(this,Yt)._signal}),e.preventDefault()}},Sl=function(){return x(Oo,Ah).get(x(this,Yt).getMode())},k7=function(e){const t=x(this,Fi,Sl);return t?new t.prototype.constructor(e):null},C7=function(){const{x:e,y:t,width:i,height:s}=this.div.getBoundingClientRect(),r=Math.max(0,e),a=Math.max(0,t),o=Math.min(window.innerWidth,e+i),l=Math.min(window.innerHeight,t+s),c=(r+o)/2-e,h=(a+l)/2-t,[u,d]=this.viewport.rotation%180===0?[c,h]:[h,c];return{offsetX:u,offsetY:d}},e3=function(){for(const e of x(this,za).values())e.isEmpty()&&e.remove()},Ue(Oo,"_initialized",!1),U(Oo,Ah,new Map([e7,f7,w7,T3,y7].map(e=>[e._editorType,e])));let v7=Oo;var Xo,Gr,Fd,jb,F5,uR,fc,S7,dR,I7;const Ss=class Ss{constructor({pageIndex:e}){U(this,fc);U(this,Xo,null);U(this,Gr,new Map);U(this,Fd,new Map);this.pageIndex=e}setParent(e){if(!x(this,Xo)){O(this,Xo,e);return}if(x(this,Xo)!==e){if(x(this,Gr).size>0)for(const t of x(this,Gr).values())t.remove(),e.append(t);O(this,Xo,e)}}static get _svgFactory(){return zn(this,"_svgFactory",new S3)}draw(e,t=!1,i=!1){const s=Fr(Ss,jb)._++,r=F(this,fc,S7).call(this),a=Ss._svgFactory.createElement("defs");r.append(a);const o=Ss._svgFactory.createElement("path");a.append(o);const l=`path_p${this.pageIndex}_${s}`;o.setAttribute("id",l),o.setAttribute("vector-effect","non-scaling-stroke"),t&&x(this,Fd).set(s,o);const c=i?F(this,fc,dR).call(this,a,l):null,h=Ss._svgFactory.createElement("use");return r.append(h),h.setAttribute("href",`#${l}`),this.updateProperties(r,e),x(this,Gr).set(s,r),{id:s,clipPathId:`url(#${c})`}}drawOutline(e,t){const i=Fr(Ss,jb)._++,s=F(this,fc,S7).call(this),r=Ss._svgFactory.createElement("defs");s.append(r);const a=Ss._svgFactory.createElement("path");r.append(a);const o=`path_p${this.pageIndex}_${i}`;a.setAttribute("id",o),a.setAttribute("vector-effect","non-scaling-stroke");let l;if(t){const u=Ss._svgFactory.createElement("mask");r.append(u),l=`mask_p${this.pageIndex}_${i}`,u.setAttribute("id",l),u.setAttribute("maskUnits","objectBoundingBox");const d=Ss._svgFactory.createElement("rect");u.append(d),d.setAttribute("width","1"),d.setAttribute("height","1"),d.setAttribute("fill","white");const f=Ss._svgFactory.createElement("use");u.append(f),f.setAttribute("href",`#${o}`),f.setAttribute("stroke","none"),f.setAttribute("fill","black"),f.setAttribute("fill-rule","nonzero"),f.classList.add("mask")}const c=Ss._svgFactory.createElement("use");s.append(c),c.setAttribute("href",`#${o}`),l&&c.setAttribute("mask",`url(#${l})`);const h=c.cloneNode();return s.append(h),c.classList.add("mainOutline"),h.classList.add("secondaryOutline"),this.updateProperties(s,e),x(this,Gr).set(i,s),i}finalizeDraw(e,t){x(this,Fd).delete(e),this.updateProperties(e,t)}updateProperties(e,t){var l;if(!t)return;const{root:i,bbox:s,rootClass:r,path:a}=t,o=typeof e=="number"?x(this,Gr).get(e):e;if(o){if(i&&F(this,fc,I7).call(this,o,i),s&&F(l=Ss,F5,uR).call(l,o,s),r){const{classList:c}=o;for(const[h,u]of Object.entries(r))c.toggle(h,u)}if(a){const h=o.firstChild.firstChild;F(this,fc,I7).call(this,h,a)}}}updateParent(e,t){if(t===this)return;const i=x(this,Gr).get(e);i&&(x(t,Xo).append(i),x(this,Gr).delete(e),x(t,Gr).set(e,i))}remove(e){x(this,Fd).delete(e),x(this,Xo)!==null&&(x(this,Gr).get(e).remove(),x(this,Gr).delete(e))}destroy(){O(this,Xo,null);for(const e of x(this,Gr).values())e.remove();x(this,Gr).clear(),x(this,Fd).clear()}};Xo=new WeakMap,Gr=new WeakMap,Fd=new WeakMap,jb=new WeakMap,F5=new WeakSet,uR=function(e,[t,i,s,r]){const{style:a}=e;a.top=`${100*i}%`,a.left=`${100*t}%`,a.width=`${100*s}%`,a.height=`${100*r}%`},fc=new WeakSet,S7=function(){const e=Ss._svgFactory.create(1,1,!0);return x(this,Xo).append(e),e.setAttribute("aria-hidden",!0),e},dR=function(e,t){const i=Ss._svgFactory.createElement("clipPath");e.append(i);const s=`clip_${t}`;i.setAttribute("id",s),i.setAttribute("clipPathUnits","objectBoundingBox");const r=Ss._svgFactory.createElement("use");return i.append(r),r.setAttribute("href",`#${t}`),r.classList.add("clip"),s},I7=function(e,t){for(const[i,s]of Object.entries(t))s===null?e.removeAttribute(i):e.setAttribute(i,s)},U(Ss,F5),U(Ss,jb,0);let A7=Ss;globalThis._pdfjsTestingUtils={HighlightOutliner:n7};globalThis.pdfjsLib={AbortException:Vh,AnnotationEditorLayer:v7,AnnotationEditorParamsType:Vn,AnnotationEditorType:_n,AnnotationEditorUIManager:Qd,AnnotationLayer:Z8,AnnotationMode:H0,AnnotationType:bs,build:QB,ColorPicker:E3,createValidAbsoluteUrl:rE,DOMSVGFactory:S3,DrawLayer:A7,FeatureTest:br,fetchData:fx,getDocument:WB,getFilenameFromUrl:GL,getPdfFilenameFromUrl:VL,getUuid:lE,getXfaPageViewport:WL,GlobalWorkerOptions:Ql,ImageKind:C9,InvalidPDFException:u8,isDataScheme:iy,isPdfFile:p4,isValidExplicitDest:iB,MathClamp:qr,noContextMenu:ll,normalizeUnicode:HL,OPS:v3,OutputScale:cc,PasswordResponses:ML,PDFDataRangeTransport:cT,PDFDateString:b4,PDFWorker:Hp,PermissionFlag:RL,PixelsPerInch:qh,RenderingCancelledException:m4,ResponseException:k3,setLayerDimensions:Zd,shadow:zn,SignatureExtractor:r0,stopEvent:ys,SupportedImageMimeTypes:f8,TextLayer:Bp,TouchManager:A3,updateUrlHash:aE,Util:sn,VerbosityLevel:ey,version:ZB,XfaLayer:dT};const wU=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),Vd=[.001,0,0,.001,0,0],d0=1.35,M3=.35,Wv=M3/d0,Wr={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},fR="pdfjs_internal_editor_",vl={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,SIGNATURE:101},Kv={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},gR={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},zs={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Qs={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},E7={GROUP:"Group",REPLY:"R"},_i={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512},nl={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864},bf={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},mR={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"},_U={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"},vU={O:"PageOpen",C:"PageClose"},zp={ERRORS:0,WARNINGS:1,INFOS:5},ie={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},xs={moveTo:0,lineTo:1,curveTo:2,closePath:3},Xv={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let ay=zp.WARNINGS;function kU(n){Number.isInteger(n)&&(ay=n)}function CU(){return ay}function gn(n){ay>=zp.INFOS&&`${n}`}function ae(n){ay>=zp.WARNINGS&&`${n}`}function Cn(n){throw new Error(n)}function qs(n,e){n||Cn(e)}function AU(n){switch(n==null?void 0:n.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function P3(n,e=null,t=null){if(!n)return null;if(t&&typeof n=="string"){if(t.addDefaultProtocol&&n.startsWith("www.")){const s=n.match(/\./g);(s==null?void 0:s.length)>=2&&(n=`http://${n}`)}if(t.tryConvertEncoding)try{n=Vp(n)}catch{}}const i=e?URL.parse(n,e):URL.parse(n);return AU(i)?i:null}function We(n,e,t,i=!1){return Object.defineProperty(n,e,{value:t,enumerable:!i,configurable:!0,writable:!1}),t}const sa=function(){function e(t,i){this.message=t,this.name=i}return e.prototype=new Error,e.constructor=e,e}();class jp extends sa{constructor(e,t){super(e,"PasswordException"),this.code=t}}class ww extends sa{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class Gp extends sa{constructor(e){super(e,"InvalidPDFException")}}class Yv extends sa{constructor(e,t,i){super(e,"ResponseException"),this.status=t,this.missing=i}}class Te extends sa{constructor(e){super(e,"FormatError")}}class hr extends sa{constructor(e){super(e,"AbortException")}}function xa(n){(typeof n!="object"||(n==null?void 0:n.length)===void 0)&&Cn("Invalid argument for bytesToString");const e=n.length,t=8192;if(e<t)return String.fromCharCode.apply(null,n);const i=[];for(let s=0;s<e;s+=t){const r=Math.min(s+t,e),a=n.subarray(s,r);i.push(String.fromCharCode.apply(null,a))}return i.join("")}function gr(n){typeof n!="string"&&Cn("Invalid argument for stringToBytes");const e=n.length,t=new Uint8Array(e);for(let i=0;i<e;++i)t[i]=n.charCodeAt(i)&255;return t}function ur(n){return String.fromCharCode(n>>24&255,n>>16&255,n>>8&255,n&255)}function A4(n){return Object.keys(n).length}function SU(){const n=new Uint8Array(4);return n[0]=1,new Uint32Array(n.buffer,0,1)[0]===1}function IU(){try{return new Function(""),!0}catch{return!1}}class ya{static get isLittleEndian(){return We(this,"isLittleEndian",SU())}static get isEvalSupported(){return We(this,"isEvalSupported",IU())}static get isOffscreenCanvasSupported(){return We(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return We(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){const{platform:e,userAgent:t}=navigator;return We(this,"platform",{isAndroid:t.includes("Android"),isLinux:e.includes("Linux"),isMac:e.includes("Mac"),isWindows:e.includes("Win"),isFirefox:t.includes("Firefox")})}static get isCSSRoundSupported(){var e,t;return We(this,"isCSSRoundSupported",(t=(e=globalThis.CSS)==null?void 0:e.supports)==null?void 0:t.call(e,"width: round(1.5px, 1px)"))}}const a1=Array.from(Array(256).keys(),n=>n.toString(16).padStart(2,"0"));var v0,t3,T7;class Ln{static makeHexColor(e,t,i){return`#${a1[e]}${a1[t]}${a1[i]}`}static scaleMinMax(e,t){let i;e[0]?(e[0]<0&&(i=t[0],t[0]=t[2],t[2]=i),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(i=t[1],t[1]=t[3],t[3]=i),t[1]*=e[3],t[3]*=e[3]):(i=t[0],t[0]=t[1],t[1]=i,i=t[2],t[2]=t[3],t[3]=i,e[1]<0&&(i=t[1],t[1]=t[3],t[3]=i),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(i=t[0],t[0]=t[2],t[2]=i),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static applyTransform(e,t,i=0){const s=e[i],r=e[i+1];e[i]=s*t[0]+r*t[2]+t[4],e[i+1]=s*t[1]+r*t[3]+t[5]}static applyTransformToBezier(e,t,i=0){const s=t[0],r=t[1],a=t[2],o=t[3],l=t[4],c=t[5];for(let h=0;h<6;h+=2){const u=e[i+h],d=e[i+h+1];e[i+h]=u*s+d*a+l,e[i+h+1]=u*r+d*o+c}}static applyInverseTransform(e,t){const i=e[0],s=e[1],r=t[0]*t[3]-t[1]*t[2];e[0]=(i*t[3]-s*t[2]+t[2]*t[5]-t[4]*t[3])/r,e[1]=(-i*t[1]+s*t[0]+t[4]*t[1]-t[5]*t[0])/r}static axialAlignedBoundingBox(e,t,i){const s=t[0],r=t[1],a=t[2],o=t[3],l=t[4],c=t[5],h=e[0],u=e[1],d=e[2],f=e[3];let g=s*h+l,m=g,b=s*d+l,p=b,y=o*u+c,w=y,_=o*f+c,v=_;if(r!==0||a!==0){const C=r*h,k=r*d,I=a*u,E=a*f;g+=I,p+=I,b+=E,m+=E,y+=C,v+=C,_+=k,w+=k}i[0]=Math.min(i[0],g,b,m,p),i[1]=Math.min(i[1],y,_,w,v),i[2]=Math.max(i[2],g,b,m,p),i[3]=Math.max(i[3],y,_,w,v)}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e,t){const i=e[0],s=e[1],r=e[2],a=e[3],o=i**2+s**2,l=i*r+s*a,c=r**2+a**2,h=(o+c)/2,u=Math.sqrt(h**2-(o*c-l**2));t[0]=Math.sqrt(h+u||1),t[1]=Math.sqrt(h-u||1)}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const i=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),s=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(i>s)return null;const r=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),a=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return r>a?null:[i,r,s,a]}static pointBoundingBox(e,t,i){i[0]=Math.min(i[0],e),i[1]=Math.min(i[1],t),i[2]=Math.max(i[2],e),i[3]=Math.max(i[3],t)}static rectBoundingBox(e,t,i,s,r){r[0]=Math.min(r[0],e,i),r[1]=Math.min(r[1],t,s),r[2]=Math.max(r[2],e,i),r[3]=Math.max(r[3],t,s)}static bezierBoundingBox(e,t,i,s,r,a,o,l,c){c[0]=Math.min(c[0],e,o),c[1]=Math.min(c[1],t,l),c[2]=Math.max(c[2],e,o),c[3]=Math.max(c[3],t,l),F(this,v0,T7).call(this,e,i,r,o,t,s,a,l,3*(-e+3*(i-r)+o),6*(e-2*i+r),3*(i-e),c),F(this,v0,T7).call(this,e,i,r,o,t,s,a,l,3*(-t+3*(s-a)+l),6*(t-2*s+a),3*(s-t),c)}}v0=new WeakSet,t3=function(e,t,i,s,r,a,o,l,c,h){if(c<=0||c>=1)return;const u=1-c,d=c*c,f=d*c,g=u*(u*(u*e+3*c*t)+3*d*i)+f*s,m=u*(u*(u*r+3*c*a)+3*d*o)+f*l;h[0]=Math.min(h[0],g),h[1]=Math.min(h[1],m),h[2]=Math.max(h[2],g),h[3]=Math.max(h[3],m)},T7=function(e,t,i,s,r,a,o,l,c,h,u,d){if(Math.abs(c)<1e-12){Math.abs(h)>=1e-12&&F(this,v0,t3).call(this,e,t,i,s,r,a,o,l,-u/h,d);return}const f=h**2-4*u*c;if(f<0)return;const g=Math.sqrt(f),m=2*c;F(this,v0,t3).call(this,e,t,i,s,r,a,o,l,(-h+g)/m,d),F(this,v0,t3).call(this,e,t,i,s,r,a,o,l,(-h-g)/m,d)},U(Ln,v0);const EU=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function Rn(n,e=!1){if(n[0]>="ï"){let i;if(n[0]==="þ"&&n[1]==="ÿ"?(i="utf-16be",n.length%2===1&&(n=n.slice(0,-1))):n[0]==="ÿ"&&n[1]==="þ"?(i="utf-16le",n.length%2===1&&(n=n.slice(0,-1))):n[0]==="ï"&&n[1]==="»"&&n[2]==="¿"&&(i="utf-8"),i)try{const s=new TextDecoder(i,{fatal:!0}),r=gr(n),a=s.decode(r);return e||!a.includes("\x1B")?a:a.replaceAll(/\x1b[^\x1b]*(?:\x1b|$)/g,"")}catch(s){ae(`stringToPDFString: "${s}".`)}}const t=[];for(let i=0,s=n.length;i<s;i++){const r=n.charCodeAt(i);if(!e&&r===27){for(;++i<s&&n.charCodeAt(i)!==27;);continue}const a=EU[r];t.push(a?String.fromCharCode(a):n.charAt(i))}return t.join("")}function Vp(n){return decodeURIComponent(escape(n))}function R7(n){return unescape(encodeURIComponent(n))}function qp(n,e){if(n.length!==e.length)return!1;for(let t=0,i=n.length;t<i;t++)if(n[t]!==e[t])return!1;return!0}function C0(n=new Date){return[n.getUTCFullYear().toString(),(n.getUTCMonth()+1).toString().padStart(2,"0"),n.getUTCDate().toString().padStart(2,"0"),n.getUTCHours().toString().padStart(2,"0"),n.getUTCMinutes().toString().padStart(2,"0"),n.getUTCSeconds().toString().padStart(2,"0")].join("")}let _w=null,Jv=null;function TU(n){return _w||(_w=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Jv=new Map([["ﬅ","ſt"]])),n.replaceAll(_w,(e,t,i)=>t?t.normalize("NFKC"):Jv.get(i))}const RU="pdfjs_internal_id_";function MU(n,e,t){if(!Array.isArray(t)||t.length<2)return!1;const[i,s,...r]=t;if(!n(i)&&!Number.isInteger(i)||!e(s))return!1;const a=r.length;let o=!0;switch(s.name){case"XYZ":if(a<2||a>3)return!1;break;case"Fit":case"FitB":return a===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(a>1)return!1;break;case"FitR":if(a!==4)return!1;o=!1;break;default:return!1}for(const l of r)if(!(typeof l=="number"||o&&l===null))return!1;return!0}function Ws(n,e,t){return Math.min(Math.max(n,e),t)}function Zv(n){return Uint8Array.prototype.toHex?n.toHex():Array.from(n,e=>a1[e]).join("")}function PU(n){return Uint8Array.fromBase64?Uint8Array.fromBase64(n):gr(atob(n))}typeof Promise.try!="function"&&(Promise.try=function(n,...e){return new Promise(t=>{t(n(...e))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(n){return n.reduce((e,t)=>e+t,0)});const NU=Symbol("CIRCULAR_REF"),Gs=Symbol("EOF");let n3=Object.create(null),i3=Object.create(null),Pf=Object.create(null);function OU(){n3=Object.create(null),i3=Object.create(null),Pf=Object.create(null)}class ve{constructor(e){this.name=e}static get(e){return i3[e]||(i3[e]=new ve(e))}}class ls{constructor(e){this.cmd=e}static get(e){return n3[e]||(n3[e]=new ls(e))}}const pR=function(){return pR};class ue{constructor(e=null){this._map=new Map,this.xref=e,this.objId=null,this.suppressEncryption=!1,this.__nonSerializable__=pR}assignXref(e){this.xref=e}get size(){return this._map.size}get(e,t,i){let s=this._map.get(e);return s===void 0&&t!==void 0&&(s=this._map.get(t),s===void 0&&i!==void 0&&(s=this._map.get(i))),s instanceof tt&&this.xref?this.xref.fetch(s,this.suppressEncryption):s}async getAsync(e,t,i){let s=this._map.get(e);return s===void 0&&t!==void 0&&(s=this._map.get(t),s===void 0&&i!==void 0&&(s=this._map.get(i))),s instanceof tt&&this.xref?this.xref.fetchAsync(s,this.suppressEncryption):s}getArray(e,t,i){let s=this._map.get(e);if(s===void 0&&t!==void 0&&(s=this._map.get(t),s===void 0&&i!==void 0&&(s=this._map.get(i))),s instanceof tt&&this.xref&&(s=this.xref.fetch(s,this.suppressEncryption)),Array.isArray(s)){s=s.slice();for(let r=0,a=s.length;r<a;r++)s[r]instanceof tt&&this.xref&&(s[r]=this.xref.fetch(s[r],this.suppressEncryption))}return s}getRaw(e){return this._map.get(e)}getKeys(){return[...this._map.keys()]}getRawValues(){return[...this._map.values()]}set(e,t){this._map.set(e,t)}has(e){return this._map.has(e)}*[Symbol.iterator](){for(const[e,t]of this._map)yield[e,t instanceof tt&&this.xref?this.xref.fetch(t,this.suppressEncryption):t]}static get empty(){const e=new ue(null);return e.set=(t,i)=>{Cn("Should not call `set` on the empty dictionary.")},We(this,"empty",e)}static merge({xref:e,dictArray:t,mergeSubDicts:i=!1}){const s=new ue(e),r=new Map;for(const a of t)if(a instanceof ue)for(const[o,l]of a._map){let c=r.get(o);if(c===void 0)c=[],r.set(o,c);else if(!i||!(l instanceof ue))continue;c.push(l)}for(const[a,o]of r){if(o.length===1||!(o[0]instanceof ue)){s._map.set(a,o[0]);continue}const l=new ue(e);for(const c of o)for(const[h,u]of c._map)l._map.has(h)||l._map.set(h,u);l.size>0&&s._map.set(a,l)}return r.clear(),s.size>0?s:ue.empty}clone(){const e=new ue(this.xref);for(const t of this.getKeys())e.set(t,this.getRaw(t));return e}delete(e){delete this._map[e]}}class tt{constructor(e,t){this.num=e,this.gen=t}toString(){return this.gen===0?`${this.num}R`:`${this.num}R${this.gen}`}static fromString(e){const t=Pf[e];if(t)return t;const i=/^(\d+)R(\d*)$/.exec(e);return!i||i[1]==="0"?null:Pf[e]=new tt(parseInt(i[1]),i[2]?parseInt(i[2]):0)}static get(e,t){const i=t===0?`${e}R`:`${e}R${t}`;return Pf[i]||(Pf[i]=new tt(e,t))}}class ts{constructor(e=null){this._set=new Set(e==null?void 0:e._set)}has(e){return this._set.has(e.toString())}put(e){this._set.add(e.toString())}remove(e){this._set.delete(e.toString())}[Symbol.iterator](){return this._set.values()}clear(){this._set.clear()}}class ma{constructor(){this._map=new Map}get size(){return this._map.size}get(e){return this._map.get(e.toString())}has(e){return this._map.has(e.toString())}put(e,t){this._map.set(e.toString(),t)}putAlias(e,t){this._map.set(e.toString(),this.get(t))}[Symbol.iterator](){return this._map.values()}clear(){this._map.clear()}*values(){yield*this._map.values()}*items(){for(const[e,t]of this._map)yield[tt.fromString(e),t]}}function Li(n,e){return n instanceof ve&&(e===void 0||n.name===e)}function Ts(n,e){return n instanceof ls&&(e===void 0||n.cmd===e)}function bR(n,e){return n instanceof ue&&(e===void 0||Li(n.get("Type"),e))}function N3(n,e){return n.num===e.num&&n.gen===e.gen}class dn{get length(){Cn("Abstract getter `length` accessed")}get isEmpty(){Cn("Abstract getter `isEmpty` accessed")}get isDataLoaded(){return We(this,"isDataLoaded",!0)}getByte(){Cn("Abstract method `getByte` called")}getBytes(e){Cn("Abstract method `getBytes` called")}async getImageData(e,t){return this.getBytes(e,t)}async asyncGetBytes(){Cn("Abstract method `asyncGetBytes` called")}get isAsync(){return!1}get isAsyncDecoder(){return!1}get canAsyncDecodeImageFromBuffer(){return!1}async getTransferableImage(){return null}peekByte(){const e=this.getByte();return e!==-1&&this.pos--,e}peekBytes(e){const t=this.getBytes(e);return this.pos-=t.length,t}getUint16(){const e=this.getByte(),t=this.getByte();return e===-1||t===-1?-1:(e<<8)+t}getInt32(){const e=this.getByte(),t=this.getByte(),i=this.getByte(),s=this.getByte();return(e<<24)+(t<<16)+(i<<8)+s}getByteRange(e,t){Cn("Abstract method `getByteRange` called")}getString(e){return xa(this.getBytes(e))}skip(e){this.pos+=e||1}reset(){Cn("Abstract method `reset` called")}moveStart(){Cn("Abstract method `moveStart` called")}makeSubStream(e,t,i=null){Cn("Abstract method `makeSubStream` called")}getBaseStreams(){return null}}const xR=/^[1-9]\.\d$/,M7=2**31-1,DU=-(2**31),al=[1,0,0,1,0,0],P7=["ColorSpace","ExtGState","Font","Pattern","Properties","Shading","XObject"],N7=["ExtGState","Font","Properties","XObject"];function Ei(n){let e;return function(){return n&&(e=Object.create(null),n(e),n=null),e}}class vi extends sa{constructor(e,t){super(`Missing data [${e}, ${t})`,"MissingDataException"),this.begin=e,this.end=t}}class O7 extends sa{constructor(e){super(e,"ParserEOFException")}}class Oh extends sa{constructor(e){super(e,"XRefEntryException")}}class o1 extends sa{constructor(e){super(e,"XRefParseException")}}function yR(n){const e=n.length;if(e===0)return new Uint8Array(0);if(e===1)return new Uint8Array(n[0]);let t=0;for(let r=0;r<e;r++)t+=n[r].byteLength;const i=new Uint8Array(t);let s=0;for(let r=0;r<e;r++){const a=new Uint8Array(n[r]);i.set(a,s),s+=a.byteLength}return i}async function D7(n){const e=await fetch(n);if(!e.ok)throw new Error(`Failed to fetch file "${n}" with "${e.statusText}".`);return new Uint8Array(await e.arrayBuffer())}function wo({dict:n,key:e,getArray:t=!1,stopWhenFound:i=!0}){let s;const r=new ts;for(;n instanceof ue&&!(n.objId&&r.has(n.objId));){n.objId&&r.put(n.objId);const a=t?n.getArray(e):n.get(e);if(a!==void 0){if(i)return a;(s||(s=[])).push(a)}n=n.get("Parent")}return s}function FU(n,e,t){const i=new ts,s=n,r={dict:null,ref:null};for(;n instanceof ue&&!i.has(e)&&(i.put(e),!n.has("T"));){if(e=n.getRaw("Parent"),!(e instanceof tt))return r;n=t.fetch(e)}return n instanceof ue&&n!==s&&(r.dict=n,r.ref=e),r}const vw=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"];function LU(n,e=!1){qs(Number.isInteger(n)&&n>0,"The number should be a positive integer.");const t="M".repeat(n/1e3|0)+vw[n%1e3/100|0]+vw[10+(n%100/10|0)]+vw[20+n%10];return e?t.toLowerCase():t}function S4(n){return n>0?Math.ceil(Math.log2(n)):0}function Il(n,e){return n[e]<<24>>24}function a0(n,e){return(n[e]<<24|n[e+1]<<16)>>16}function wn(n,e){return n[e]<<8|n[e+1]}function Jn(n,e){return(n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3])>>>0}function Za(n){return n===32||n===9||n===13||n===10}function BU(n,e){return Array.isArray(n)&&n.length===e&&n.every(t=>typeof t=="boolean")}function Yr(n,e){return Array.isArray(n)?(e===null||n.length===e)&&n.every(t=>typeof t=="number"):ArrayBuffer.isView(n)&&!(n instanceof BigInt64Array||n instanceof BigUint64Array)&&(e===null||n.length===e)}function Dh(n,e){return Yr(n,6)?n:e}function F7(n,e){return Yr(n,4)?n:e}function A0(n,e){return Yr(n,4)?Ln.normalizeRect(n):e}function wR(n){const e=/(.+)\[(\d+)\]$/;return n.split(".").map(t=>{const i=t.match(e);return i?{name:i[1],pos:parseInt(i[2],10)}:{name:t,pos:0}})}function I4(n){const e=[];let t=0;for(let i=0,s=n.length;i<s;i++){const r=n.charCodeAt(i);(r<33||r>126||r===35||r===40||r===41||r===60||r===62||r===91||r===93||r===123||r===125||r===47||r===37)&&(t<i&&e.push(n.substring(t,i)),e.push(`#${r.toString(16)}`),t=i+1)}return e.length===0?n:(t<n.length&&e.push(n.substring(t,n.length)),e.join(""))}function Ng(n){return n.replaceAll(/([()\\\n\r])/g,e=>e===`
`?"\\n":e==="\r"?"\\r":`\\${e}`)}function O3(n,e,t,i){if(!n)return;let s=null;if(n instanceof tt){if(i.has(n))return;s=n,i.put(s),n=e.fetch(n)}if(Array.isArray(n))for(const r of n)O3(r,e,t,i);else if(n instanceof ue){if(Li(n.get("S"),"JavaScript")){const r=n.get("JS");let a;r instanceof dn?a=r.getString():typeof r=="string"&&(a=r),a&&(a=Rn(a,!0).replaceAll("\0","")),a&&t.push(a)}O3(n.getRaw("Next"),e,t,i)}s&&i.remove(s)}function oy(n,e,t){const i=Object.create(null),s=wo({dict:e,key:"AA",stopWhenFound:!1});if(s)for(let r=s.length-1;r>=0;r--){const a=s[r];if(a instanceof ue)for(const o of a.getKeys()){const l=t[o];if(!l)continue;const c=a.getRaw(o),h=new ts,u=[];O3(c,n,u,h),u.length>0&&(i[l]=u)}}if(e.has("A")){const r=e.get("A"),a=new ts,o=[];O3(r,n,o,a),o.length>0&&(i.Action=o)}return A4(i)>0?i:null}const UU={60:"&lt;",62:"&gt;",38:"&amp;",34:"&quot;",39:"&apos;"};function*HU(n){for(let e=0,t=n.length;e<t;e++){const i=n.codePointAt(e);i>55295&&(i<57344||i>65533)&&e++,yield i}}function l1(n){const e=[];let t=0;for(let i=0,s=n.length;i<s;i++){const r=n.codePointAt(i);if(32<=r&&r<=126){const a=UU[r];a&&(t<i&&e.push(n.substring(t,i)),e.push(a),t=i+1)}else t<i&&e.push(n.substring(t,i)),e.push(`&#x${r.toString(16).toUpperCase()};`),r>55295&&(r<57344||r>65533)&&i++,t=i+1}return e.length===0?n:(t<n.length&&e.push(n.substring(t,n.length)),e.join(""))}function L7(n,e=!1){const t=/^("|').*("|')$/.exec(n);if(t&&t[1]===t[2]){if(new RegExp(`[^\\\\]${t[1]}`).test(n.slice(1,-1)))return e&&ae(`FontFamily contains unescaped ${t[1]}: ${n}.`),!1}else for(const i of n.split(/[ \t]+/))if(/^(\d|(-(\d|-)))/.test(i)||!/^[\w-\\]+$/.test(i))return e&&ae(`FontFamily contains invalid <custom-ident>: ${n}.`),!1;return!0}function zU(n){const e="14",t="400",i=new Set(["100","200","300","400","500","600","700","800","900","1000","normal","bold","bolder","lighter"]),{fontFamily:s,fontWeight:r,italicAngle:a}=n;if(!L7(s,!0))return!1;const o=r?r.toString():"";n.fontWeight=i.has(o)?o:t;const l=parseFloat(a);return n.italicAngle=isNaN(l)||l<-90||l>90?e:a.toString(),!0}function _R(n){const e=["app.launchURL","window.open","xfa.host.gotoURL"],i=new RegExp("^\\s*("+e.join("|").replaceAll(".","\\.")+`)\\((?:'|")([^'"]*)(?:'|")(?:,\\s*(\\w+)\\)|\\))`,"i").exec(n);return i!=null&&i[2]?{url:i[2],newWindow:i[1]==="app.launchURL"&&i[3]==="true"}:null}function kn(n){if(Number.isInteger(n))return n.toString();const e=Math.round(n*100);return e%100===0?(e/100).toString():e%10===0?n.toFixed(1):n.toFixed(2)}function vR(n){if(!n)return null;const e=new Map;for(const[t,i]of n){if(!t.startsWith(fR))continue;let s=e.get(i.pageIndex);s||(s=[],e.set(i.pageIndex,s)),s.push(i)}return e.size>0?e:null}function _o(n){return jU(n)?n:kR(n,!0)}function jU(n){return/^[\x00-\x7F]*$/.test(n)}function GU(n){const e=[];for(let t=0,i=n.length;t<i;t++){const s=n.charCodeAt(t);e.push(a1[s>>8&255],a1[s&255])}return e.join("")}function kR(n,e=!1){const t=[];e&&t.push("þÿ");for(let i=0,s=n.length;i<s;i++){const r=n.charCodeAt(i);t.push(String.fromCharCode(r>>8&255),String.fromCharCode(r&255))}return t.join("")}function D3(n,e,t){switch(n){case 90:return[0,1,-1,0,e,0];case 180:return[-1,0,0,-1,e,t];case 270:return[0,-1,1,0,0,t];default:throw new Error("Invalid rotation")}}function Qv(n){return Math.ceil(Math.ceil(Math.log2(1+n))/8)}var Gb;class Si{static get _memoryArray(){const e=x(this,Gb);return e!=null&&e.byteLength?e:O(this,Gb,new Uint8Array(this._memory.buffer))}}Gb=new WeakMap,U(Si,Gb,null),Ue(Si,"_memory",null),Ue(Si,"_mustAddAlpha",!1),Ue(Si,"_destBuffer",null),Ue(Si,"_destOffset",0),Ue(Si,"_destLength",0),Ue(Si,"_cssColor",""),Ue(Si,"_makeHexColor",null);function VU(n,e){const{_mustAddAlpha:t,_destBuffer:i,_destOffset:s,_destLength:r,_memoryArray:a}=Si;if(e===r){i.set(a.subarray(n,n+e),s);return}if(t)for(let o=n,l=n+e,c=s;o<l;o+=3,c+=4)i[c]=a[o],i[c+1]=a[o+1],i[c+2]=a[o+2],i[c+3]=255;else for(let o=n,l=n+e,c=s;o<l;o+=3,c+=4)i[c]=a[o],i[c+1]=a[o+1],i[c+2]=a[o+2]}function qU(n){const{_destBuffer:e,_destOffset:t,_memoryArray:i}=Si;e[t]=i[n],e[t+1]=i[n+1],e[t+2]=i[n+2]}function WU(n){const{_memoryArray:e}=Si;Si._cssColor=Si._makeHexColor(e[n],e[n+1],e[n+2])}let Qr;const CR=typeof TextDecoder<"u"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};typeof TextDecoder<"u"&&CR.decode();let fp=null;function AR(){return(fp===null||fp.byteLength===0)&&(fp=new Uint8Array(Qr.memory.buffer)),fp}function KU(n,e){return n=n>>>0,CR.decode(AR().subarray(n,n+e))}let E4=0;function SR(n,e){const t=e(n.length*1,1)>>>0;return AR().set(n,t/1),E4=n.length,t}function XU(n,e){const t=SR(e,Qr.__wbindgen_malloc),i=E4;Qr.qcms_convert_array(n,t,i)}function YU(n,e,t){Qr.qcms_convert_one(n,e,t)}function JU(n,e,t,i,s){Qr.qcms_convert_three(n,e,t,i,s)}function ZU(n,e,t,i,s,r){Qr.qcms_convert_four(n,e,t,i,s,r)}function QU(n,e,t){const i=SR(n,Qr.__wbindgen_malloc),s=E4;return Qr.qcms_transformer_from_memory(i,s,e,t)>>>0}function $U(n){Qr.qcms_drop_transformer(n)}const kw=Object.freeze({RGB8:0,0:"RGB8",RGBA8:1,1:"RGBA8",BGRA8:2,2:"BGRA8",Gray8:3,3:"Gray8",GrayA8:4,4:"GrayA8",CMYK:5,5:"CMYK"}),eH=Object.freeze({Perceptual:0,0:"Perceptual",RelativeColorimetric:1,1:"RelativeColorimetric",Saturation:2,2:"Saturation",AbsoluteColorimetric:3,3:"AbsoluteColorimetric"});function tH(){const n={};return n.wbg={},n.wbg.__wbg_copyresult_b08ee7d273f295dd=function(e,t){VU(e>>>0,t>>>0)},n.wbg.__wbg_copyrgb_d60ce17bb05d9b67=function(e){qU(e>>>0)},n.wbg.__wbg_makecssRGB_893bf0cd9fdb302d=function(e){WU(e>>>0)},n.wbg.__wbindgen_init_externref_table=function(){const e=Qr.__wbindgen_export_0,t=e.grow(4);e.set(0,void 0),e.set(t+0,void 0),e.set(t+1,null),e.set(t+2,!0),e.set(t+3,!1)},n.wbg.__wbindgen_throw=function(e,t){throw new Error(KU(e,t))},n}function nH(n,e){return Qr=n.exports,fp=null,Qr.__wbindgen_start(),Qr}function iH(n){if(Qr!==void 0)return Qr;typeof n<"u"&&(Object.getPrototypeOf(n)===Object.prototype?{module:n}=n:console.warn("using deprecated parameters for `initSync()`; pass a single object instead"));const e=tH();n instanceof WebAssembly.Module||(n=new WebAssembly.Module(n));const t=new WebAssembly.Instance(n,e);return nH(t)}function sH(n,e,t,i,s,r,a){a=a!==1?0:a;const l=t/s,c=i/r;let h=0,u;const d=new Uint16Array(s),f=t*3;for(let g=0;g<s;g++)d[g]=Math.floor(g*l)*3;for(let g=0;g<r;g++){const m=Math.floor(g*c)*f;for(let b=0;b<s;b++)u=m+d[b],e[h++]=n[u++],e[h++]=n[u++],e[h++]=n[u++],h+=a}}function rH(n,e,t,i,s,r,a){const o=t/s,l=i/r;let c=0;const h=new Uint16Array(s);if(a===1){for(let g=0;g<s;g++)h[g]=Math.floor(g*o);const u=new Uint32Array(n.buffer),d=new Uint32Array(e.buffer),f=ya.isLittleEndian?16777215:4294967040;for(let g=0;g<r;g++){const m=u.subarray(Math.floor(g*l)*t);for(let b=0;b<s;b++)d[c++]|=m[h[b]]&f}}else{const d=t*4;for(let f=0;f<s;f++)h[f]=Math.floor(f*o)*4;for(let f=0;f<r;f++){const g=n.subarray(Math.floor(f*l)*d);for(let m=0;m<s;m++){const b=h[m];e[c++]=g[b],e[c++]=g[b+1],e[c++]=g[b+2]}}}}function aH(n,e,t){if(t===1){const i=new Uint32Array(n.buffer),s=new Uint32Array(e.buffer),r=ya.isLittleEndian?16777215:4294967040;for(let a=0,o=i.length;a<o;a++)s[a]|=i[a]&r}else{let i=0;for(let s=0,r=n.length;s<r;s+=4)e[i++]=n[s],e[i++]=n[s+1],e[i++]=n[s+2]}}var L5;const Np=class Np{constructor(e,t){this.name=e,this.numComps=t}getRgb(e,t,i=new Uint8ClampedArray(3)){return this.getRgbItem(e,t,i,0),i}getRgbHex(e,t){const i=this.getRgb(e,t,x(Np,L5));return Ln.makeHexColor(i[0],i[1],i[2])}getRgbItem(e,t,i,s){Cn("Should not call ColorSpace.getRgbItem")}getRgbBuffer(e,t,i,s,r,a,o){Cn("Should not call ColorSpace.getRgbBuffer")}getOutputLength(e,t){Cn("Should not call ColorSpace.getOutputLength")}isPassthrough(e){return!1}isDefaultDecode(e,t){return Np.isDefaultDecode(e,this.numComps)}fillRgb(e,t,i,s,r,a,o,l,c){const h=t*i;let u=null;const d=1<<o,f=i!==r||t!==s;if(this.isPassthrough(o))u=l;else if(this.numComps===1&&h>d&&this.name!=="DeviceGray"&&this.name!=="DeviceRGB"){const g=o<=8?new Uint8Array(d):new Uint16Array(d);for(let b=0;b<d;b++)g[b]=b;const m=new Uint8ClampedArray(d*3);if(this.getRgbBuffer(g,0,d,m,0,o,0),f){u=new Uint8Array(h*3);let b=0;for(let p=0;p<h;++p){const y=l[p]*3;u[b++]=m[y],u[b++]=m[y+1],u[b++]=m[y+2]}}else{let b=0;for(let p=0;p<h;++p){const y=l[p]*3;e[b++]=m[y],e[b++]=m[y+1],e[b++]=m[y+2],b+=c}}}else f?(u=new Uint8ClampedArray(h*3),this.getRgbBuffer(l,0,h,u,0,o,0)):this.getRgbBuffer(l,0,s*a,e,0,o,c);if(u)if(f)sH(u,e,t,i,s,r,c);else{let g=0,m=0;for(let b=0,p=s*a;b<p;b++)e[g++]=u[m++],e[g++]=u[m++],e[g++]=u[m++],g+=c}}get usesZeroToOneRange(){return We(this,"usesZeroToOneRange",!0)}static isDefaultDecode(e,t){if(!Array.isArray(e))return!0;if(t*2!==e.length)return ae("The decode map is not the correct length"),!0;for(let i=0,s=e.length;i<s;i+=2)if(e[i]!==0||e[i+1]!==1)return!1;return!0}};L5=new WeakMap,U(Np,L5,new Uint8ClampedArray(3));let xr=Np;class oH extends xr{constructor(e,t,i){super("Alternate",e),this.base=t,this.tintFn=i,this.tmpBuf=new Float32Array(t.numComps)}getRgbItem(e,t,i,s){const r=this.tmpBuf;this.tintFn(e,t,r,0),this.base.getRgbItem(r,0,i,s)}getRgbBuffer(e,t,i,s,r,a,o){const l=this.tintFn,c=this.base,h=1/((1<<a)-1),u=c.numComps,d=c.usesZeroToOneRange,f=(c.isPassthrough(8)||!d)&&o===0;let g=f?r:0;const m=f?s:new Uint8ClampedArray(u*i),b=this.numComps,p=new Float32Array(b),y=new Float32Array(u);let w,_;for(w=0;w<i;w++){for(_=0;_<b;_++)p[_]=e[t++]*h;if(l(p,0,y,0),d)for(_=0;_<u;_++)m[g++]=y[_]*255;else c.getRgbItem(y,0,m,g),g+=u}f||c.getRgbBuffer(m,0,i,s,r,8,o)}getOutputLength(e,t){return this.base.getOutputLength(e*this.base.numComps/this.numComps,t)}}class $v extends xr{constructor(e){super("Pattern",null),this.base=e}isDefaultDecode(e,t){Cn("Should not call PatternCS.isDefaultDecode")}}class lH extends xr{constructor(e,t,i){super("Indexed",1),this.base=e,this.highVal=t;const s=e.numComps*(t+1);if(this.lookup=new Uint8Array(s),i instanceof dn){const r=i.getBytes(s);this.lookup.set(r)}else if(typeof i=="string")for(let r=0;r<s;++r)this.lookup[r]=i.charCodeAt(r)&255;else throw new Te(`IndexedCS - unrecognized lookup table: ${i}`)}getRgbItem(e,t,i,s){const{base:r,highVal:a,lookup:o}=this,l=Ws(Math.round(e[t]),0,a)*r.numComps;r.getRgbBuffer(o,l,1,i,s,8,0)}getRgbBuffer(e,t,i,s,r,a,o){const{base:l,highVal:c,lookup:h}=this,{numComps:u}=l,d=l.getOutputLength(u,o);for(let f=0;f<i;++f){const g=Ws(Math.round(e[t++]),0,c)*u;l.getRgbBuffer(h,g,1,s,r,8,o),r+=d}}getOutputLength(e,t){return this.base.getOutputLength(e*this.base.numComps,t)}isDefaultDecode(e,t){return Array.isArray(e)?e.length!==2?(ae("Decode map length is not correct"),!0):!Number.isInteger(t)||t<1?(ae("Bits per component is not correct"),!0):e[0]===0&&e[1]===(1<<t)-1:!0}}class cH extends xr{constructor(){super("DeviceGray",1)}getRgbItem(e,t,i,s){const r=e[t]*255;i[s]=i[s+1]=i[s+2]=r}getRgbBuffer(e,t,i,s,r,a,o){const l=255/((1<<a)-1);let c=t,h=r;for(let u=0;u<i;++u){const d=l*e[c++];s[h++]=d,s[h++]=d,s[h++]=d,h+=o}}getOutputLength(e,t){return e*(3+t)}}class hH extends xr{constructor(){super("DeviceRGB",3)}getRgbItem(e,t,i,s){i[s]=e[t]*255,i[s+1]=e[t+1]*255,i[s+2]=e[t+2]*255}getRgbBuffer(e,t,i,s,r,a,o){if(a===8&&o===0){s.set(e.subarray(t,t+i*3),r);return}const l=255/((1<<a)-1);let c=t,h=r;for(let u=0;u<i;++u)s[h++]=l*e[c++],s[h++]=l*e[c++],s[h++]=l*e[c++],h+=o}getOutputLength(e,t){return e*(3+t)/3|0}isPassthrough(e){return e===8}}class uH extends xr{constructor(){super("DeviceRGBA",4)}getOutputLength(e,t){return e*4}isPassthrough(e){return e===8}fillRgb(e,t,i,s,r,a,o,l,c){i!==r||t!==s?rH(l,e,t,i,s,r,c):aH(l,e,c)}}var Vb,B7;class IR extends xr{constructor(){super("DeviceCMYK",4);U(this,Vb)}getRgbItem(t,i,s,r){F(this,Vb,B7).call(this,t,i,1,s,r)}getRgbBuffer(t,i,s,r,a,o,l){const c=1/((1<<o)-1);for(let h=0;h<s;h++)F(this,Vb,B7).call(this,t,i,c,r,a),i+=4,a+=3+l}getOutputLength(t,i){return t/4*(3+i)|0}}Vb=new WeakSet,B7=function(t,i,s,r,a){const o=t[i]*s,l=t[i+1]*s,c=t[i+2]*s,h=t[i+3]*s;r[a]=255+o*(-4.387332384609988*o+54.48615194189176*l+18.82290502165302*c+212.25662451639585*h+-285.2331026137004)+l*(1.7149763477362134*l-5.6096736904047315*c+-17.873870861415444*h-5.497006427196366)+c*(-2.5217340131683033*c-21.248923337353073*h+17.5119270841813)+h*(-21.86122147463605*h-189.48180835922747),r[a+1]=255+o*(8.841041422036149*o+60.118027045597366*l+6.871425592049007*c+31.159100130055922*h+-79.2970844816548)+l*(-15.310361306967817*l+17.575251261109482*c+131.35250912493976*h-190.9453302588951)+c*(4.444339102852739*c+9.8632861493405*h-24.86741582555878)+h*(-20.737325471181034*h-187.80453709719578),r[a+2]=255+o*(.8842522430003296*o+8.078677503112928*l+30.89978309703729*c-.23883238689178934*h+-14.183576799673286)+l*(10.49593273432072*l+63.02378494754052*c+50.606957656360734*h-112.23884253719248)+c*(.03296041114873217*c+115.60384449646641*h+-193.58209356861505)+h*(-22.33816807309886*h-180.12613974708367)};var qb,U7;class dH extends xr{constructor(t,i,s){super("CalGray",1);U(this,qb);if(!t)throw new Te("WhitePoint missing - required for color space CalGray");if([this.XW,this.YW,this.ZW]=t,[this.XB,this.YB,this.ZB]=i||[0,0,0],this.G=s||1,this.XW<0||this.ZW<0||this.YW!==1)throw new Te(`Invalid WhitePoint components for ${this.name}, no fallback available`);(this.XB<0||this.YB<0||this.ZB<0)&&(gn(`Invalid BlackPoint for ${this.name}, falling back to default.`),this.XB=this.YB=this.ZB=0),(this.XB!==0||this.YB!==0||this.ZB!==0)&&ae(`${this.name}, BlackPoint: XB: ${this.XB}, YB: ${this.YB}, ZB: ${this.ZB}, only default values are supported.`),this.G<1&&(gn(`Invalid Gamma: ${this.G} for ${this.name}, falling back to default.`),this.G=1)}getRgbItem(t,i,s,r){F(this,qb,U7).call(this,t,i,s,r,1)}getRgbBuffer(t,i,s,r,a,o,l){const c=1/((1<<o)-1);for(let h=0;h<s;++h)F(this,qb,U7).call(this,t,i,r,a,c),i+=1,a+=3+l}getOutputLength(t,i){return t*(3+i)}}qb=new WeakSet,U7=function(t,i,s,r,a){const l=(t[i]*a)**this.G,c=this.YW*l,h=Math.max(295.8*c**.3333333333333333-40.8,0);s[r]=h,s[r+1]=h,s[r+2]=h};var Wb,Kb,B5,U5,Xb,_g,Yb,H5,ri,Nf,ER,TR,s3,Of,RR,MR,PR,z7;const Pi=class Pi extends xr{constructor(t,i,s,r){super("CalRGB",3);U(this,ri);if(!t)throw new Te("WhitePoint missing - required for color space CalRGB");const[a,o,l]=this.whitePoint=t,[c,h,u]=this.blackPoint=i||new Float32Array(3);if([this.GR,this.GG,this.GB]=s||new Float32Array([1,1,1]),[this.MXA,this.MYA,this.MZA,this.MXB,this.MYB,this.MZB,this.MXC,this.MYC,this.MZC]=r||new Float32Array([1,0,0,0,1,0,0,0,1]),a<0||l<0||o!==1)throw new Te(`Invalid WhitePoint components for ${this.name}, no fallback available`);(c<0||h<0||u<0)&&(gn(`Invalid BlackPoint for ${this.name} [${c}, ${h}, ${u}], falling back to default.`),this.blackPoint=new Float32Array(3)),(this.GR<0||this.GG<0||this.GB<0)&&(gn(`Invalid Gamma [${this.GR}, ${this.GG}, ${this.GB}] for ${this.name}, falling back to default.`),this.GR=this.GG=this.GB=1)}getRgbItem(t,i,s,r){F(this,ri,z7).call(this,t,i,s,r,1)}getRgbBuffer(t,i,s,r,a,o,l){const c=1/((1<<o)-1);for(let h=0;h<s;++h)F(this,ri,z7).call(this,t,i,r,a,c),i+=3,a+=3+l}getOutputLength(t,i){return t*(3+i)/3|0}};Wb=new WeakMap,Kb=new WeakMap,B5=new WeakMap,U5=new WeakMap,Xb=new WeakMap,_g=new WeakMap,Yb=new WeakMap,H5=new WeakMap,ri=new WeakSet,Nf=function(t,i,s){s[0]=t[0]*i[0]+t[1]*i[1]+t[2]*i[2],s[1]=t[3]*i[0]+t[4]*i[1]+t[5]*i[2],s[2]=t[6]*i[0]+t[7]*i[1]+t[8]*i[2]},ER=function(t,i,s){s[0]=i[0]*1/t[0],s[1]=i[1]*1/t[1],s[2]=i[2]*1/t[2]},TR=function(t,i,s){s[0]=i[0]*.95047/t[0],s[1]=i[1]*1/t[1],s[2]=i[2]*1.08883/t[2]},s3=function(t){return t<=.0031308?Ws(12.92*t,0,1):t>=.99554525?1:Ws((1+.055)*t**(1/2.4)-.055,0,1)},Of=function(t){return t<0?-F(this,ri,Of).call(this,-t):t>8?((t+16)/116)**3:t*x(Pi,H5)},RR=function(t,i,s){if(t[0]===0&&t[1]===0&&t[2]===0){s[0]=i[0],s[1]=i[1],s[2]=i[2];return}const r=F(this,ri,Of).call(this,0),a=r,o=F(this,ri,Of).call(this,t[0]),l=r,c=F(this,ri,Of).call(this,t[1]),h=r,u=F(this,ri,Of).call(this,t[2]),d=(1-a)/(1-o),f=1-d,g=(1-l)/(1-c),m=1-g,b=(1-h)/(1-u),p=1-b;s[0]=i[0]*d+f,s[1]=i[1]*g+m,s[2]=i[2]*b+p},MR=function(t,i,s){if(t[0]===1&&t[2]===1){s[0]=i[0],s[1]=i[1],s[2]=i[2];return}const r=s;F(this,ri,Nf).call(this,x(Pi,Wb),i,r);const a=x(Pi,Xb);F(this,ri,ER).call(this,t,r,a),F(this,ri,Nf).call(this,x(Pi,Kb),a,s)},PR=function(t,i,s){const r=s;F(this,ri,Nf).call(this,x(Pi,Wb),i,r);const a=x(Pi,Xb);F(this,ri,TR).call(this,t,r,a),F(this,ri,Nf).call(this,x(Pi,Kb),a,s)},z7=function(t,i,s,r,a){const o=Ws(t[i]*a,0,1),l=Ws(t[i+1]*a,0,1),c=Ws(t[i+2]*a,0,1),h=o===1?1:o**this.GR,u=l===1?1:l**this.GG,d=c===1?1:c**this.GB,f=this.MXA*h+this.MXB*u+this.MXC*d,g=this.MYA*h+this.MYB*u+this.MYC*d,m=this.MZA*h+this.MZB*u+this.MZC*d,b=x(Pi,_g);b[0]=f,b[1]=g,b[2]=m;const p=x(Pi,Yb);F(this,ri,MR).call(this,this.whitePoint,b,p);const y=x(Pi,_g);F(this,ri,RR).call(this,this.blackPoint,p,y);const w=x(Pi,Yb);F(this,ri,PR).call(this,x(Pi,U5),y,w);const _=x(Pi,_g);F(this,ri,Nf).call(this,x(Pi,B5),w,_),s[r]=F(this,ri,s3).call(this,_[0])*255,s[r+1]=F(this,ri,s3).call(this,_[1])*255,s[r+2]=F(this,ri,s3).call(this,_[2])*255},U(Pi,Wb,new Float32Array([.8951,.2664,-.1614,-.7502,1.7135,.0367,.0389,-.0685,1.0296])),U(Pi,Kb,new Float32Array([.9869929,-.1470543,.1599627,.4323053,.5183603,.0492912,-.0085287,.0400428,.9684867])),U(Pi,B5,new Float32Array([3.2404542,-1.5371385,-.4985314,-.969266,1.8760108,.041556,.0556434,-.2040259,1.0572252])),U(Pi,U5,new Float32Array([1,1,1])),U(Pi,Xb,new Float32Array(3)),U(Pi,_g,new Float32Array(3)),U(Pi,Yb,new Float32Array(3)),U(Pi,H5,(24/116)**3/8);let H7=Pi;var $a,r3,a3,j7;class fH extends xr{constructor(t,i,s){super("Lab",3);U(this,$a);if(!t)throw new Te("WhitePoint missing - required for color space Lab");if([this.XW,this.YW,this.ZW]=t,[this.amin,this.amax,this.bmin,this.bmax]=s||[-100,100,-100,100],[this.XB,this.YB,this.ZB]=i||[0,0,0],this.XW<0||this.ZW<0||this.YW!==1)throw new Te("Invalid WhitePoint components, no fallback available");(this.XB<0||this.YB<0||this.ZB<0)&&(gn("Invalid BlackPoint, falling back to default"),this.XB=this.YB=this.ZB=0),(this.amin>this.amax||this.bmin>this.bmax)&&(gn("Invalid Range, falling back to defaults"),this.amin=-100,this.amax=100,this.bmin=-100,this.bmax=100)}getRgbItem(t,i,s,r){F(this,$a,j7).call(this,t,i,!1,s,r)}getRgbBuffer(t,i,s,r,a,o,l){const c=(1<<o)-1;for(let h=0;h<s;h++)F(this,$a,j7).call(this,t,i,c,r,a),i+=3,a+=3+l}getOutputLength(t,i){return t*(3+i)/3|0}isDefaultDecode(t,i){return!0}get usesZeroToOneRange(){return We(this,"usesZeroToOneRange",!1)}}$a=new WeakSet,r3=function(t){return t>=6/29?t**3:108/841*(t-4/29)},a3=function(t,i,s,r){return s+t*(r-s)/i},j7=function(t,i,s,r,a){let o=t[i],l=t[i+1],c=t[i+2];s!==!1&&(o=F(this,$a,a3).call(this,o,s,0,100),l=F(this,$a,a3).call(this,l,s,this.amin,this.amax),c=F(this,$a,a3).call(this,c,s,this.bmin,this.bmax)),l>this.amax?l=this.amax:l<this.amin&&(l=this.amin),c>this.bmax?c=this.bmax:c<this.bmin&&(c=this.bmin);const h=(o+16)/116,u=h+l/500,d=h-c/200,f=this.XW*F(this,$a,r3).call(this,u),g=this.YW*F(this,$a,r3).call(this,h),m=this.ZW*F(this,$a,r3).call(this,d);let b,p,y;this.ZW<1?(b=f*3.1339+g*-1.617+m*-.4906,p=f*-.9785+g*1.916+m*.0333,y=f*.072+g*-.229+m*1.4057):(b=f*3.2406+g*-1.5372+m*-.4986,p=f*-.9689+g*1.8758+m*.0415,y=f*.0557+g*-.204+m*1.057),r[a]=Math.sqrt(b)*255,r[a+1]=Math.sqrt(p)*255,r[a+2]=Math.sqrt(y)*255};function NR(n){const e=new XMLHttpRequest;return e.open("GET",n,!1),e.responseType="arraybuffer",e.send(null),e.response}var Yl,Sh,vg,kg,z5;const Cu=class Cu extends xr{constructor(t,i,s){if(!Cu.isUsable)throw new Error("No ICC color space support");super(i,s);U(this,Yl);U(this,Sh);let r;switch(s){case 1:r=kw.Gray8,O(this,Sh,(a,o,l)=>YU(x(this,Yl),a[o]*255,l));break;case 3:r=kw.RGB8,O(this,Sh,(a,o,l)=>JU(x(this,Yl),a[o]*255,a[o+1]*255,a[o+2]*255,l));break;case 4:r=kw.CMYK,O(this,Sh,(a,o,l)=>ZU(x(this,Yl),a[o]*255,a[o+1]*255,a[o+2]*255,a[o+3]*255,l));break;default:throw new Error(`Unsupported number of components: ${s}`)}if(O(this,Yl,QU(t,r,eH.Perceptual)),!x(this,Yl))throw new Error("Failed to create ICC color space");x(Cu,z5).register(this,x(this,Yl))}getRgbHex(t,i){return x(this,Sh).call(this,t,i,!0),Si._cssColor}getRgbItem(t,i,s,r){Si._destBuffer=s,Si._destOffset=r,Si._destLength=3,x(this,Sh).call(this,t,i,!1),Si._destBuffer=null}getRgbBuffer(t,i,s,r,a,o,l){if(t=t.subarray(i,i+s*this.numComps),o!==8){const c=255/((1<<o)-1);for(let h=0,u=t.length;h<u;h++)t[h]*=c}Si._mustAddAlpha=l&&r.buffer===t.buffer,Si._destBuffer=r,Si._destOffset=a,Si._destLength=s*(3+l),XU(x(this,Yl),t),Si._mustAddAlpha=!1,Si._destBuffer=null}getOutputLength(t,i){return t/this.numComps*(3+i)|0}static setOptions({useWasm:t,useWorkerFetch:i,wasmUrl:s}){if(!i){O(this,vg,!1);return}O(this,vg,t),O(this,kg,s)}static get isUsable(){let t=!1;if(x(this,vg))if(x(this,kg))try{this._module=iH({module:NR(`${x(this,kg)}qcms_bg.wasm`)}),t=!!this._module,Si._memory=this._module.memory,Si._makeHexColor=Ln.makeHexColor}catch(i){ae(`ICCBased color space: "${i}".`)}else ae("No ICC color space support due to missing `wasmUrl` API option");return We(this,"isUsable",t)}};Yl=new WeakMap,Sh=new WeakMap,vg=new WeakMap,kg=new WeakMap,z5=new WeakMap,U(Cu,vg,!0),U(Cu,kg,null),U(Cu,z5,new FinalizationRegistry(t=>{$U(t)}));let ef=Cu;var Cg;const j5=class j5 extends ef{constructor(){const e=new Uint8Array(NR(`${x(j5,Cg)}CGATS001Compat-v2-micro.icc`));super(e,"DeviceCMYK",4)}static setOptions({iccUrl:e}){O(this,Cg,e)}static get isUsable(){let e=!1;return ef.isUsable&&(x(this,Cg)?e=!0:ae("No CMYK ICC profile support due to missing `iccUrl` API option")),We(this,"isUsable",e)}};Cg=new WeakMap,U(j5,Cg);let Wp=j5;class ji extends dn{constructor(e,t,i,s){super(),this.bytes=e instanceof Uint8Array?e:new Uint8Array(e),this.start=t||0,this.pos=this.start,this.end=t+i||this.bytes.length,this.dict=s}get length(){return this.end-this.start}get isEmpty(){return this.length===0}getByte(){return this.pos>=this.end?-1:this.bytes[this.pos++]}getBytes(e){const t=this.bytes,i=this.pos,s=this.end;if(!e)return t.subarray(i,s);let r=i+e;return r>s&&(r=s),this.pos=r,t.subarray(i,r)}getByteRange(e,t){return e<0&&(e=0),t>this.end&&(t=this.end),this.bytes.subarray(e,t)}reset(){this.pos=this.start}moveStart(){this.start=this.pos}makeSubStream(e,t,i=null){return new ji(this.bytes.buffer,e,t,i)}}class ta extends ji{constructor(e){super(gr(e))}}class G7 extends ji{constructor(){super(new Uint8Array(0))}}class gH extends ji{constructor(e,t,i){super(new Uint8Array(e),0,e,null),this.chunkSize=t,this._loadedChunks=new Set,this.numChunks=Math.ceil(e/t),this.manager=i,this.progressiveDataLength=0,this.lastSuccessfulEnsureByteChunk=-1}getMissingChunks(){const e=[];for(let t=0,i=this.numChunks;t<i;++t)this._loadedChunks.has(t)||e.push(t);return e}get numChunksLoaded(){return this._loadedChunks.size}get isDataLoaded(){return this.numChunksLoaded===this.numChunks}onReceiveData(e,t){const i=this.chunkSize;if(e%i!==0)throw new Error(`Bad begin offset: ${e}`);const s=e+t.byteLength;if(s%i!==0&&s!==this.bytes.length)throw new Error(`Bad end offset: ${s}`);this.bytes.set(new Uint8Array(t),e);const r=Math.floor(e/i),a=Math.floor((s-1)/i)+1;for(let o=r;o<a;++o)this._loadedChunks.add(o)}onReceiveProgressiveData(e){let t=this.progressiveDataLength;const i=Math.floor(t/this.chunkSize);this.bytes.set(new Uint8Array(e),t),t+=e.byteLength,this.progressiveDataLength=t;const s=t>=this.end?this.numChunks:Math.floor(t/this.chunkSize);for(let r=i;r<s;++r)this._loadedChunks.add(r)}ensureByte(e){if(e<this.progressiveDataLength)return;const t=Math.floor(e/this.chunkSize);if(!(t>this.numChunks)&&t!==this.lastSuccessfulEnsureByteChunk){if(!this._loadedChunks.has(t))throw new vi(e,e+1);this.lastSuccessfulEnsureByteChunk=t}}ensureRange(e,t){if(e>=t||t<=this.progressiveDataLength)return;const i=Math.floor(e/this.chunkSize);if(i>this.numChunks)return;const s=Math.min(Math.floor((t-1)/this.chunkSize)+1,this.numChunks);for(let r=i;r<s;++r)if(!this._loadedChunks.has(r))throw new vi(e,t)}nextEmptyChunk(e){const t=this.numChunks;for(let i=0;i<t;++i){const s=(e+i)%t;if(!this._loadedChunks.has(s))return s}return null}hasChunk(e){return this._loadedChunks.has(e)}getByte(){const e=this.pos;return e>=this.end?-1:(e>=this.progressiveDataLength&&this.ensureByte(e),this.bytes[this.pos++])}getBytes(e){const t=this.bytes,i=this.pos,s=this.end;if(!e)return s>this.progressiveDataLength&&this.ensureRange(i,s),t.subarray(i,s);let r=i+e;return r>s&&(r=s),r>this.progressiveDataLength&&this.ensureRange(i,r),this.pos=r,t.subarray(i,r)}getByteRange(e,t){return e<0&&(e=0),t>this.end&&(t=this.end),t>this.progressiveDataLength&&this.ensureRange(e,t),this.bytes.subarray(e,t)}makeSubStream(e,t,i=null){t?e+t>this.progressiveDataLength&&this.ensureRange(e,e+t):e>=this.progressiveDataLength&&this.ensureByte(e);function s(){}s.prototype=Object.create(this),s.prototype.getMissingChunks=function(){const a=this.chunkSize,o=Math.floor(this.start/a),l=Math.floor((this.end-1)/a)+1,c=[];for(let h=o;h<l;++h)this._loadedChunks.has(h)||c.push(h);return c},Object.defineProperty(s.prototype,"isDataLoaded",{get(){return this.numChunksLoaded===this.numChunks?!0:this.getMissingChunks().length===0},configurable:!0});const r=new s;return r.pos=r.start=e,r.end=e+t||this.end,r.dict=i,r}getBaseStreams(){return[this]}}class mH{constructor(e,t){this.length=t.length,this.chunkSize=t.rangeChunkSize,this.stream=new gH(this.length,this.chunkSize,this),this.pdfNetworkStream=e,this.disableAutoFetch=t.disableAutoFetch,this.msgHandler=t.msgHandler,this.currRequestId=0,this._chunksNeededByRequest=new Map,this._requestsByChunk=new Map,this._promisesByRequest=new Map,this.progressiveDataLength=0,this.aborted=!1,this._loadedStreamCapability=Promise.withResolvers()}sendRequest(e,t){const i=this.pdfNetworkStream.getRangeReader(e,t);i.isStreamingSupported||(i.onProgress=this.onProgress.bind(this));let s=[],r=0;return new Promise((a,o)=>{const l=({value:c,done:h})=>{try{if(h){const u=yR(s);s=null,a(u);return}r+=c.byteLength,i.isStreamingSupported&&this.onProgress({loaded:r}),s.push(c),i.read().then(l,o)}catch(u){o(u)}};i.read().then(l,o)}).then(a=>{this.aborted||this.onReceiveData({chunk:a,begin:e})})}requestAllChunks(e=!1){if(!e){const t=this.stream.getMissingChunks();this._requestChunks(t)}return this._loadedStreamCapability.promise}_requestChunks(e){const t=this.currRequestId++,i=new Set;this._chunksNeededByRequest.set(t,i);for(const a of e)this.stream.hasChunk(a)||i.add(a);if(i.size===0)return Promise.resolve();const s=Promise.withResolvers();this._promisesByRequest.set(t,s);const r=[];for(const a of i){let o=this._requestsByChunk.get(a);o||(o=[],this._requestsByChunk.set(a,o),r.push(a)),o.push(t)}if(r.length>0){const a=this.groupChunks(r);for(const o of a){const l=o.beginChunk*this.chunkSize,c=Math.min(o.endChunk*this.chunkSize,this.length);this.sendRequest(l,c).catch(s.reject)}}return s.promise.catch(a=>{if(!this.aborted)throw a})}getStream(){return this.stream}requestRange(e,t){t=Math.min(t,this.length);const i=this.getBeginChunk(e),s=this.getEndChunk(t),r=[];for(let a=i;a<s;++a)r.push(a);return this._requestChunks(r)}requestRanges(e=[]){const t=[];for(const i of e){const s=this.getBeginChunk(i.begin),r=this.getEndChunk(i.end);for(let a=s;a<r;++a)t.includes(a)||t.push(a)}return t.sort((i,s)=>i-s),this._requestChunks(t)}groupChunks(e){const t=[];let i=-1,s=-1;for(let r=0,a=e.length;r<a;++r){const o=e[r];i<0&&(i=o),s>=0&&s+1!==o&&(t.push({beginChunk:i,endChunk:s+1}),i=o),r+1===e.length&&t.push({beginChunk:i,endChunk:o+1}),s=o}return t}onProgress(e){this.msgHandler.send("DocProgress",{loaded:this.stream.numChunksLoaded*this.chunkSize+e.loaded,total:this.length})}onReceiveData(e){const t=e.chunk,i=e.begin===void 0,s=i?this.progressiveDataLength:e.begin,r=s+t.byteLength,a=Math.floor(s/this.chunkSize),o=r<this.length?Math.floor(r/this.chunkSize):Math.ceil(r/this.chunkSize);i?(this.stream.onReceiveProgressiveData(t),this.progressiveDataLength=r):this.stream.onReceiveData(s,t),this.stream.isDataLoaded&&this._loadedStreamCapability.resolve(this.stream);const l=[];for(let c=a;c<o;++c){const h=this._requestsByChunk.get(c);if(h){this._requestsByChunk.delete(c);for(const u of h){const d=this._chunksNeededByRequest.get(u);d.has(c)&&d.delete(c),!(d.size>0)&&l.push(u)}}}if(!this.disableAutoFetch&&this._requestsByChunk.size===0){let c;if(this.stream.numChunksLoaded===1){const h=this.stream.numChunks-1;this.stream.hasChunk(h)||(c=h)}else c=this.stream.nextEmptyChunk(o);Number.isInteger(c)&&this._requestChunks([c])}for(const c of l){const h=this._promisesByRequest.get(c);this._promisesByRequest.delete(c),h.resolve()}this.msgHandler.send("DocProgress",{loaded:this.stream.numChunksLoaded*this.chunkSize,total:this.length})}onError(e){this._loadedStreamCapability.reject(e)}getBeginChunk(e){return Math.floor(e/this.chunkSize)}getEndChunk(e){return Math.floor((e-1)/this.chunkSize)+1}abort(e){var t;this.aborted=!0,(t=this.pdfNetworkStream)==null||t.cancelAllRequests(e);for(const i of this._promisesByRequest.values())i.reject(e)}}function OR(n){switch(n.kind){case zs.GRAYSCALE_1BPP:return V7(n);case zs.RGB_24BPP:return pH(n)}return null}function V7({src:n,srcPos:e=0,dest:t,width:i,height:s,nonBlackColor:r=4294967295,inverseDecode:a=!1}){const o=ya.isLittleEndian?4278190080:255,[l,c]=a?[r,o]:[o,r],h=i>>3,u=i&7,d=n.length;t=new Uint32Array(t.buffer);let f=0;for(let g=0;g<s;g++){for(const b=e+h;e<b;e++){const p=e<d?n[e]:255;t[f++]=p&128?c:l,t[f++]=p&64?c:l,t[f++]=p&32?c:l,t[f++]=p&16?c:l,t[f++]=p&8?c:l,t[f++]=p&4?c:l,t[f++]=p&2?c:l,t[f++]=p&1?c:l}if(u===0)continue;const m=e<d?n[e++]:255;for(let b=0;b<u;b++)t[f++]=m&1<<7-b?c:l}return{srcPos:e,destPos:f}}function pH({src:n,srcPos:e=0,dest:t,destPos:i=0,width:s,height:r}){let a=0;const o=s*r*3,l=o>>2,c=new Uint32Array(n.buffer,e,l);if(ya.isLittleEndian){for(;a<l-2;a+=3,i+=4){const h=c[a],u=c[a+1],d=c[a+2];t[i]=h|4278190080,t[i+1]=h>>>24|u<<8|4278190080,t[i+2]=u>>>16|d<<16|4278190080,t[i+3]=d>>>8|4278190080}for(let h=a*4,u=e+o;h<u;h+=3)t[i++]=n[h]|n[h+1]<<8|n[h+2]<<16|4278190080}else{for(;a<l-2;a+=3,i+=4){const h=c[a],u=c[a+1],d=c[a+2];t[i]=h|255,t[i+1]=h<<24|u>>>8|255,t[i+2]=u<<16|d>>>16|255,t[i+3]=d<<8|255}for(let h=a*4,u=e+o;h<u;h+=3)t[i++]=n[h]<<24|n[h+1]<<16|n[h+2]<<8|255}return{srcPos:e+o,destPos:i}}function bH(n,e){if(ya.isLittleEndian)for(let t=0,i=n.length;t<i;t++)e[t]=n[t]*65793|4278190080;else for(let t=0,i=n.length;t<i;t++)e[t]=n[t]*16843008|255}const ek=2048,xH=65537,tk=128;var go,Jb,G5,DR;const U0=class U0{constructor(e,t){U(this,G5);this._imgData=e,this._isMask=t}static get canUseImageDecoder(){return We(this,"canUseImageDecoder",x(this,Jb)?ImageDecoder.isTypeSupported("image/bmp"):Promise.resolve(!1))}static needsToBeResized(e,t){if(e<=x(this,go)&&t<=x(this,go))return!1;const{MAX_DIM:i}=this;if(e>i||t>i)return!0;const s=e*t;if(this._hasMaxArea)return s>this.MAX_AREA;if(s<x(this,go)**2)return!1;if(this._areGoodDims(e,t))return O(this,go,Math.max(x(this,go),Math.floor(Math.sqrt(e*t)))),!1;O(this,go,this._guessMax(x(this,go),i,tk,0));const r=this.MAX_AREA=x(this,go)**2;return s>r}static getReducePowerForJPX(e,t,i){const s=e*t,r=2**30/(i*4);if(!this.needsToBeResized(e,t))return s>r?Math.ceil(Math.log2(s/r)):0;const{MAX_DIM:a,MAX_AREA:o}=this,l=Math.max(e/a,t/a,Math.sqrt(s/Math.min(r,o)));return Math.ceil(Math.log2(l))}static get MAX_DIM(){return We(this,"MAX_DIM",this._guessMax(ek,xH,0,1))}static get MAX_AREA(){return this._hasMaxArea=!0,We(this,"MAX_AREA",this._guessMax(x(this,go),this.MAX_DIM,tk,0)**2)}static set MAX_AREA(e){e>=0&&(this._hasMaxArea=!0,We(this,"MAX_AREA",e))}static setOptions({canvasMaxAreaInBytes:e=-1,isImageDecoderSupported:t=!1}){this._hasMaxArea||(this.MAX_AREA=e>>2),O(this,Jb,t)}static _areGoodDims(e,t){try{const i=new OffscreenCanvas(e,t),s=i.getContext("2d");s.fillRect(0,0,1,1);const r=s.getImageData(0,0,1,1).data[3];return i.width=i.height=1,r!==0}catch{return!1}}static _guessMax(e,t,i,s){for(;e+i+1<t;){const r=Math.floor((e+t)/2),a=s||r;this._areGoodDims(r,a)?e=r:t=r}return e}static async createImage(e,t=!1){return new U0(e,t)._createImage()}async _createImage(){const{_imgData:e}=this,{width:t,height:i}=e;if(t*i*4>M7){const y=F(this,G5,DR).call(this);if(y)return y}const s=this._encodeBMP();let r,a;await U0.canUseImageDecoder?(r=new ImageDecoder({data:s,type:"image/bmp",preferAnimation:!1,transfer:[s.buffer]}),a=r.decode().catch(y=>(ae(`BMP image decoding failed: ${y}`),createImageBitmap(new Blob([this._encodeBMP().buffer],{type:"image/bmp"})))).finally(()=>{r.close()})):a=createImageBitmap(new Blob([s.buffer],{type:"image/bmp"}));const{MAX_AREA:o,MAX_DIM:l}=U0,c=Math.max(t/l,i/l,Math.sqrt(t*i/o)),h=Math.max(c,2),u=Math.round(10*(c+1.25))/10/h,d=Math.floor(Math.log2(u)),f=new Array(d+2).fill(2);f[0]=h,f.splice(-1,1,u/(1<<d));let g=t,m=i;const b=await a;let p=b.image||b;for(const y of f){const w=g,_=m;g=Math.floor(g/y)-1,m=Math.floor(m/y)-1;const v=new OffscreenCanvas(g,m);v.getContext("2d").drawImage(p,0,0,w,_,0,0,g,m),p.close(),p=v.transferToImageBitmap()}return e.data=null,e.bitmap=p,e.width=g,e.height=m,e}_encodeBMP(){const{width:e,height:t,kind:i}=this._imgData;let s=this._imgData.data,r,a=new Uint8Array(0),o=a,l=0;switch(i){case zs.GRAYSCALE_1BPP:{r=1,a=new Uint8Array(this._isMask?[255,255,255,255,0,0,0,0]:[0,0,0,0,255,255,255,255]);const m=e+7>>3,b=m+3&-4;if(m!==b){const p=new Uint8Array(b*t);let y=0;for(let w=0,_=t*m;w<_;w+=m,y+=b)p.set(s.subarray(w,w+m),y);s=p}break}case zs.RGB_24BPP:{if(r=24,e&3){const m=3*e,b=m+3&-4,p=b-m,y=new Uint8Array(b*t);let w=0;for(let _=0,v=t*m;_<v;_+=m){const C=s.subarray(_,_+m);for(let k=0;k<m;k+=3)y[w++]=C[k+2],y[w++]=C[k+1],y[w++]=C[k];w+=p}s=y}else for(let m=0,b=s.length;m<b;m+=3){const p=s[m];s[m]=s[m+2],s[m+2]=p}break}case zs.RGBA_32BPP:r=32,l=3,o=new Uint8Array(68);const g=new DataView(o.buffer);ya.isLittleEndian?(g.setUint32(0,255,!0),g.setUint32(4,65280,!0),g.setUint32(8,16711680,!0),g.setUint32(12,4278190080,!0)):(g.setUint32(0,4278190080,!0),g.setUint32(4,16711680,!0),g.setUint32(8,65280,!0),g.setUint32(12,255,!0));break;default:throw new Error("invalid format")}let c=0;const h=40+o.length,u=14+h+a.length+s.length,d=new Uint8Array(u),f=new DataView(d.buffer);return f.setUint16(c,19778,!0),c+=2,f.setUint32(c,u,!0),c+=4,f.setUint32(c,0,!0),c+=4,f.setUint32(c,14+h+a.length,!0),c+=4,f.setUint32(c,h,!0),c+=4,f.setInt32(c,e,!0),c+=4,f.setInt32(c,-t,!0),c+=4,f.setUint16(c,1,!0),c+=2,f.setUint16(c,r,!0),c+=2,f.setUint32(c,l,!0),c+=4,f.setUint32(c,0,!0),c+=4,f.setInt32(c,0,!0),c+=4,f.setInt32(c,0,!0),c+=4,f.setUint32(c,a.length/4,!0),c+=4,f.setUint32(c,0,!0),c+=4,d.set(o,c),c+=o.length,d.set(a,c),c+=a.length,d.set(s,c),d}};go=new WeakMap,Jb=new WeakMap,G5=new WeakSet,DR=function(){const{_imgData:e}=this,{data:t,width:i,height:s,kind:r}=e,a=i*s*4,o=Math.ceil(Math.log2(a/M7)),l=i>>o,c=s>>o;let h,u=s;try{h=new Uint8Array(a)}catch{let _=Math.floor(Math.log2(a+1));for(;;)try{h=new Uint8Array(2**_-1);break}catch{_-=1}u=Math.floor((2**_-1)/(i*4));const v=i*u*4;v<h.length&&(h=new Uint8Array(v))}const d=new Uint32Array(h.buffer),f=new Uint32Array(l*c);let g=0,m=0;const b=Math.ceil(s/u),p=s%u===0?s:s%u;for(let _=0;_<b;_++){const v=_<b-1?u:p;({srcPos:g}=OR({kind:r,src:t,dest:d,width:i,height:v,inverseDecode:this._isMask,srcPos:g}));for(let C=0,k=v>>o;C<k;C++){const I=d.subarray((C<<o)*i);for(let E=0;E<l;E++)f[m++]=I[E<<o]}}if(U0.needsToBeResized(l,c))return e.data=f,e.width=l,e.height=c,e.kind=zs.RGBA_32BPP,null;const y=new OffscreenCanvas(l,c);return y.getContext("2d",{willReadFrequently:!0}).putImageData(new ImageData(new Uint8ClampedArray(f.buffer),l,c),0,0),e.data=null,e.bitmap=y.transferToImageBitmap(),e.width=l,e.height=c,e},U(U0,go,ek),U(U0,Jb,ya.isImageDecoderSupported);let Fo=U0;const yH=new Uint8Array(0);class na extends dn{constructor(e){if(super(),this._rawMinBufferLength=e||0,this.pos=0,this.bufferLength=0,this.eof=!1,this.buffer=yH,this.minBufferLength=512,e)for(;this.minBufferLength<e;)this.minBufferLength*=2}get isEmpty(){for(;!this.eof&&this.bufferLength===0;)this.readBlock();return this.bufferLength===0}ensureBuffer(e){const t=this.buffer;if(e<=t.byteLength)return t;let i=this.minBufferLength;for(;i<e;)i*=2;const s=new Uint8Array(i);return s.set(t),this.buffer=s}getByte(){const e=this.pos;for(;this.bufferLength<=e;){if(this.eof)return-1;this.readBlock()}return this.buffer[this.pos++]}getBytes(e,t=null){const i=this.pos;let s;if(e){for(this.ensureBuffer(i+e),s=i+e;!this.eof&&this.bufferLength<s;)this.readBlock(t);const r=this.bufferLength;s>r&&(s=r)}else{for(;!this.eof;)this.readBlock(t);s=this.bufferLength}return this.pos=s,this.buffer.subarray(i,s)}async getImageData(e,t){if(!this.canAsyncDecodeImageFromBuffer)return this.isAsyncDecoder?this.decodeImage(null,t):this.getBytes(e,t);const i=await this.stream.asyncGetBytes();return this.decodeImage(i,t)}reset(){this.pos=0}makeSubStream(e,t,i=null){if(t===void 0)for(;!this.eof;)this.readBlock();else{const s=e+t;for(;this.bufferLength<=s&&!this.eof;)this.readBlock()}return new ji(this.buffer,e,t,i)}getBaseStreams(){return this.str?this.str.getBaseStreams():null}}class wH extends na{constructor(e,t=null){e=e.filter(s=>s instanceof dn);let i=0;for(const s of e)i+=s instanceof na?s._rawMinBufferLength:s.length;super(i),this.streams=e,this._onError=t}readBlock(){var o;const e=this.streams;if(e.length===0){this.eof=!0;return}const t=e.shift();let i;try{i=t.getBytes()}catch(l){if(this._onError){this._onError(l,(o=t.dict)==null?void 0:o.objId);return}throw l}const s=this.bufferLength,r=s+i.length;this.ensureBuffer(r).set(i,s),this.bufferLength=r}getBaseStreams(){const e=[];for(const t of this.streams){const i=t.getBaseStreams();i&&e.push(...i)}return e.length>0?e:null}}var rl,gp,o3;class Dn{static parse({cs:e,xref:t,resources:i=null,pdfFunctionFactory:s,globalColorSpaceCache:r,localColorSpaceCache:a,asyncIfNotCached:o=!1}){const l={xref:t,resources:i,pdfFunctionFactory:s,globalColorSpaceCache:r,localColorSpaceCache:a};let c,h,u;if(e instanceof tt){h=e;const d=r.getByRef(h)||a.getByRef(h);if(d)return d;e=t.fetch(e)}if(e instanceof ve){c=e.name;const d=a.getByName(c);if(d)return d}try{u=F(this,rl,o3).call(this,e,l)}catch(d){if(o&&!(d instanceof vi))return Promise.reject(d);throw d}return(c||h)&&(a.set(c,h,u),h&&r.set(null,h,u)),o?Promise.resolve(u):u}static get gray(){return We(this,"gray",new cH)}static get rgb(){return We(this,"rgb",new hH)}static get rgba(){return We(this,"rgba",new uH)}static get cmyk(){if(Wp.isUsable)try{return We(this,"cmyk",new Wp)}catch{ae("CMYK fallback: DeviceCMYK")}return We(this,"cmyk",new IR)}}rl=new WeakSet,gp=function(e,t){const{globalColorSpaceCache:i}=t;let s;if(e instanceof tt){s=e;const a=i.getByRef(s);if(a)return a}const r=F(this,rl,o3).call(this,e,t);return s&&i.set(null,s,r),r},o3=function(e,t){const{xref:i,resources:s,pdfFunctionFactory:r,globalColorSpaceCache:a}=t;if(e=i.fetchIfRef(e),e instanceof ve)switch(e.name){case"G":case"DeviceGray":return this.gray;case"RGB":case"DeviceRGB":return this.rgb;case"DeviceRGBA":return this.rgba;case"CMYK":case"DeviceCMYK":return this.cmyk;case"Pattern":return new $v(null);default:if(s instanceof ue){const o=s.get("ColorSpace");if(o instanceof ue){const l=o.get(e.name);if(l){if(l instanceof ve)return F(this,rl,o3).call(this,l,t);e=l;break}}}return ae(`Unrecognized ColorSpace: ${e.name}`),this.gray}if(Array.isArray(e)){const o=i.fetchIfRef(e[0]).name;let l,c,h,u,d,f;switch(o){case"G":case"DeviceGray":return this.gray;case"RGB":case"DeviceRGB":return this.rgb;case"CMYK":case"DeviceCMYK":return this.cmyk;case"CalGray":return l=i.fetchIfRef(e[1]),u=l.getArray("WhitePoint"),d=l.getArray("BlackPoint"),f=l.get("Gamma"),new dH(u,d,f);case"CalRGB":l=i.fetchIfRef(e[1]),u=l.getArray("WhitePoint"),d=l.getArray("BlackPoint"),f=l.getArray("Gamma");const g=l.getArray("Matrix");return new H7(u,d,f,g);case"ICCBased":const m=e[1]instanceof tt;if(m){const I=a.getByRef(e[1]);if(I)return I}const b=i.fetchIfRef(e[1]),p=b.dict;if(c=p.get("N"),ef.isUsable)try{const I=new ef(b.getBytes(),"ICCBased",c);return m&&a.set(null,e[1],I),I}catch(I){if(I instanceof vi)throw I;ae(`ICCBased color space (${e[1]}): "${I}".`)}const y=p.getRaw("Alternate");if(y){const I=F(this,rl,gp).call(this,y,t);if(I.numComps===c)return I;ae("ICCBased color space: Ignoring incorrect /Alternate entry.")}if(c===1)return this.gray;if(c===3)return this.rgb;if(c===4)return this.cmyk;break;case"Pattern":return h=e[1]||null,h&&(h=F(this,rl,gp).call(this,h,t)),new $v(h);case"I":case"Indexed":h=F(this,rl,gp).call(this,e[1],t);const w=Ws(i.fetchIfRef(e[2]),0,255),_=i.fetchIfRef(e[3]);return new lH(h,w,_);case"Separation":case"DeviceN":const v=i.fetchIfRef(e[1]);c=Array.isArray(v)?v.length:1,h=F(this,rl,gp).call(this,e[2],t);const C=r.create(e[3]);return new oH(c,h,C);case"Lab":l=i.fetchIfRef(e[1]),u=l.getArray("WhitePoint"),d=l.getArray("BlackPoint");const k=l.getArray("Range");return new fH(u,d,k);default:return ae(`Unimplemented ColorSpace object: ${o}`),this.gray}}return ae(`Unrecognized ColorSpace object: ${e}`),this.gray},U(Dn,rl);class mo extends sa{constructor(e){super(e,"JpegError")}}class q7 extends sa{constructor(e,t){super(e,"DNLMarkerError"),this.scanLines=t}}class FR extends sa{constructor(e){super(e,"EOIMarkerError")}}const _p=new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),qx=4017,Wx=799,Kx=3406,Xx=2276,Yx=1567,Jx=3784,xf=5793,Zx=2896;function _H(n,e){let t=0,i,s,r=16;for(;r>0&&!n[r-1];)r--;const a=[{children:[],index:0}];let o=a[0],l;for(i=0;i<r;i++){for(s=0;s<n[i];s++){for(o=a.pop(),o.children[o.index]=e[t];o.index>0;)o=a.pop();for(o.index++,a.push(o);a.length<=i;)a.push(l={children:[],index:0}),o.children[o.index]=l.children,o=l;t++}i+1<r&&(a.push(l={children:[],index:0}),o.children[o.index]=l.children,o=l)}return a[0].children}function W7(n,e,t){return 64*((n.blocksPerLine+1)*e+t)}function vH(n,e,t,i,s,r,a,o,l,c=!1){const h=t.mcusPerLine,u=t.progressive,d=e;let f=0,g=0;function m(){if(g>0)return g--,f>>g&1;if(f=n[e++],f===255){const ge=n[e++];if(ge){if(ge===220&&c){e+=2;const N=wn(n,e);if(e+=2,N>0&&N!==t.scanLines)throw new q7("Found DNL marker (0xFFDC) while parsing scan data",N)}else if(ge===217){if(c){const N=M*(t.precision===8?8:0);if(N>0&&Math.round(t.scanLines/N)>=5)throw new q7("Found EOI marker (0xFFD9) while parsing scan data, possibly caused by incorrect `scanLines` parameter",N)}throw new FR("Found EOI marker (0xFFD9) while parsing scan data")}throw new mo(`unexpected marker ${(f<<8|ge).toString(16)}`)}}return g=7,f>>>7}function b(ge){let N=ge;for(;;){switch(N=N[m()],typeof N){case"number":return N;case"object":continue}throw new mo("invalid huffman sequence")}}function p(ge){let N=0;for(;ge>0;)N=N<<1|m(),ge--;return N}function y(ge){if(ge===1)return m()===1?1:-1;const N=p(ge);return N>=1<<ge-1?N:N+(-1<<ge)+1}function w(ge,N){const K=b(ge.huffmanTableDC),oe=K===0?0:y(K);ge.blockData[N]=ge.pred+=oe;let W=1;for(;W<64;){const le=b(ge.huffmanTableAC),ce=le&15,Ce=le>>4;if(ce===0){if(Ce<15)break;W+=16;continue}W+=Ce;const X=_p[W];ge.blockData[N+X]=y(ce),W++}}function _(ge,N){const K=b(ge.huffmanTableDC),oe=K===0?0:y(K)<<l;ge.blockData[N]=ge.pred+=oe}function v(ge,N){ge.blockData[N]|=m()<<l}let C=0;function k(ge,N){if(C>0){C--;return}let K=r;const oe=a;for(;K<=oe;){const W=b(ge.huffmanTableAC),le=W&15,ce=W>>4;if(le===0){if(ce<15){C=p(ce)+(1<<ce)-1;break}K+=16;continue}K+=ce;const Ce=_p[K];ge.blockData[N+Ce]=y(le)*(1<<l),K++}}let I=0,E;function T(ge,N){let K=r;const oe=a;let W=0,le,ce;for(;K<=oe;){const Ce=N+_p[K],X=ge.blockData[Ce]<0?-1:1;switch(I){case 0:if(ce=b(ge.huffmanTableAC),le=ce&15,W=ce>>4,le===0)W<15?(C=p(W)+(1<<W),I=4):(W=16,I=1);else{if(le!==1)throw new mo("invalid ACn encoding");E=y(le),I=W?2:3}continue;case 1:case 2:ge.blockData[Ce]?ge.blockData[Ce]+=X*(m()<<l):(W--,W===0&&(I=I===2?3:0));break;case 3:ge.blockData[Ce]?ge.blockData[Ce]+=X*(m()<<l):(ge.blockData[Ce]=E<<l,I=0);break;case 4:ge.blockData[Ce]&&(ge.blockData[Ce]+=X*(m()<<l));break}K++}I===4&&(C--,C===0&&(I=0))}let M=0;function D(ge,N,K,oe,W){const le=K/h|0,ce=K%h;M=le*ge.v+oe;const Ce=ce*ge.h+W,X=W7(ge,M,Ce);N(ge,X)}function H(ge,N,K){M=K/ge.blocksPerLine|0;const oe=K%ge.blocksPerLine,W=W7(ge,M,oe);N(ge,W)}const R=i.length;let z,P,B,Z,G,Y;u?r===0?Y=o===0?_:v:Y=o===0?k:T:Y=w;let J=0,se;const fe=R===1?i[0].blocksPerLine*i[0].blocksPerColumn:h*t.mcusPerColumn;let he,de;for(;J<=fe;){const ge=s?Math.min(fe-J,s):fe;if(ge>0){for(P=0;P<R;P++)i[P].pred=0;if(C=0,R===1)for(z=i[0],G=0;G<ge;G++)H(z,Y,J),J++;else for(G=0;G<ge;G++){for(P=0;P<R;P++)for(z=i[P],he=z.h,de=z.v,B=0;B<de;B++)for(Z=0;Z<he;Z++)D(z,Y,J,B,Z);J++}}if(g=0,se=ly(n,e),!se)break;if(se.invalid){const N=ge>0?"unexpected":"excessive";ae(`decodeScan - ${N} MCU data, current marker is: ${se.invalid}`),e=se.offset}if(se.marker>=65488&&se.marker<=65495)e+=2;else break}return e-d}function kH(n,e,t){const i=n.quantizationTable,s=n.blockData;let r,a,o,l,c,h,u,d,f,g,m,b,p,y,w,_,v;if(!i)throw new mo("missing required Quantization Table.");for(let C=0;C<64;C+=8){if(f=s[e+C],g=s[e+C+1],m=s[e+C+2],b=s[e+C+3],p=s[e+C+4],y=s[e+C+5],w=s[e+C+6],_=s[e+C+7],f*=i[C],!(g|m|b|p|y|w|_)){v=xf*f+512>>10,t[C]=v,t[C+1]=v,t[C+2]=v,t[C+3]=v,t[C+4]=v,t[C+5]=v,t[C+6]=v,t[C+7]=v;continue}g*=i[C+1],m*=i[C+2],b*=i[C+3],p*=i[C+4],y*=i[C+5],w*=i[C+6],_*=i[C+7],r=xf*f+128>>8,a=xf*p+128>>8,o=m,l=w,c=Zx*(g-_)+128>>8,d=Zx*(g+_)+128>>8,h=b<<4,u=y<<4,r=r+a+1>>1,a=r-a,v=o*Jx+l*Yx+128>>8,o=o*Yx-l*Jx+128>>8,l=v,c=c+u+1>>1,u=c-u,d=d+h+1>>1,h=d-h,r=r+l+1>>1,l=r-l,a=a+o+1>>1,o=a-o,v=c*Xx+d*Kx+2048>>12,c=c*Kx-d*Xx+2048>>12,d=v,v=h*Wx+u*qx+2048>>12,h=h*qx-u*Wx+2048>>12,u=v,t[C]=r+d,t[C+7]=r-d,t[C+1]=a+u,t[C+6]=a-u,t[C+2]=o+h,t[C+5]=o-h,t[C+3]=l+c,t[C+4]=l-c}for(let C=0;C<8;++C){if(f=t[C],g=t[C+8],m=t[C+16],b=t[C+24],p=t[C+32],y=t[C+40],w=t[C+48],_=t[C+56],!(g|m|b|p|y|w|_)){v=xf*f+8192>>14,v<-2040?v=0:v>=2024?v=255:v=v+2056>>4,s[e+C]=v,s[e+C+8]=v,s[e+C+16]=v,s[e+C+24]=v,s[e+C+32]=v,s[e+C+40]=v,s[e+C+48]=v,s[e+C+56]=v;continue}r=xf*f+2048>>12,a=xf*p+2048>>12,o=m,l=w,c=Zx*(g-_)+2048>>12,d=Zx*(g+_)+2048>>12,h=b,u=y,r=(r+a+1>>1)+4112,a=r-a,v=o*Jx+l*Yx+2048>>12,o=o*Yx-l*Jx+2048>>12,l=v,c=c+u+1>>1,u=c-u,d=d+h+1>>1,h=d-h,r=r+l+1>>1,l=r-l,a=a+o+1>>1,o=a-o,v=c*Xx+d*Kx+2048>>12,c=c*Kx-d*Xx+2048>>12,d=v,v=h*Wx+u*qx+2048>>12,h=h*qx-u*Wx+2048>>12,u=v,f=r+d,_=r-d,g=a+u,w=a-u,m=o+h,y=o-h,b=l+c,p=l-c,f<16?f=0:f>=4080?f=255:f>>=4,g<16?g=0:g>=4080?g=255:g>>=4,m<16?m=0:m>=4080?m=255:m>>=4,b<16?b=0:b>=4080?b=255:b>>=4,p<16?p=0:p>=4080?p=255:p>>=4,y<16?y=0:y>=4080?y=255:y>>=4,w<16?w=0:w>=4080?w=255:w>>=4,_<16?_=0:_>=4080?_=255:_>>=4,s[e+C]=f,s[e+C+8]=g,s[e+C+16]=m,s[e+C+24]=b,s[e+C+32]=p,s[e+C+40]=y,s[e+C+48]=w,s[e+C+56]=_}}function CH(n,e){const t=e.blocksPerLine,i=e.blocksPerColumn,s=new Int16Array(64);for(let r=0;r<i;r++)for(let a=0;a<t;a++){const o=W7(e,r,a);kH(e,o,s)}return e.blockData}function ly(n,e,t=e){const i=n.length-1;let s=t<e?t:e;if(e>=i)return null;const r=wn(n,e);if(r>=65472&&r<=65534)return{invalid:null,marker:r,offset:e};let a=wn(n,s);for(;!(a>=65472&&a<=65534);){if(++s>=i)return null;a=wn(n,s)}return{invalid:r.toString(16),marker:a,offset:s}}function AH(n){const e=Math.ceil(n.samplesPerLine/8/n.maxH),t=Math.ceil(n.scanLines/8/n.maxV);for(const i of n.components){const s=Math.ceil(Math.ceil(n.samplesPerLine/8)*i.h/n.maxH),r=Math.ceil(Math.ceil(n.scanLines/8)*i.v/n.maxV),a=e*i.h,l=64*(t*i.v)*(a+1);i.blockData=new Int16Array(l),i.blocksPerLine=s,i.blocksPerColumn=r}n.mcusPerLine=e,n.mcusPerColumn=t}function nk(n,e){const t=wn(n,e);e+=2;let i=e+t-2;const s=ly(n,i,e);s!=null&&s.invalid&&(ae("readDataBlock - incorrect length, current marker is: "+s.invalid),i=s.offset);const r=n.subarray(e,i);return{appData:r,oldOffset:e,newOffset:e+r.length}}function SH(n,e){const t=wn(n,e);e+=2;const i=e+t-2,s=ly(n,i,e);return s!=null&&s.invalid?s.offset:i}class ik{constructor({decodeTransform:e=null,colorTransform:t=-1}={}){this._decodeTransform=e,this._colorTransform=t}static canUseImageDecoder(e,t=-1){let i=null,s=0,r=null,a=wn(e,s);if(s+=2,a!==65496)throw new mo("SOI not found");a=wn(e,s),s+=2;e:for(;a!==65497;){switch(a){case 65505:const{appData:o,oldOffset:l,newOffset:c}=nk(e,s);if(s=c,o[0]===69&&o[1]===120&&o[2]===105&&o[3]===102&&o[4]===0&&o[5]===0){if(i)throw new mo("Duplicate EXIF-blocks found.");i={exifStart:l+6,exifEnd:c}}a=wn(e,s),s+=2;continue;case 65472:case 65473:case 65474:r=e[s+7];break e;case 65535:e[s]!==255&&s--;break}s=SH(e,s),a=wn(e,s),s+=2}return r===4||r===3&&t===0?null:i||{}}parse(e,{dnlScanLines:t=null}={}){let i=0,s=null,r=null,a,o,l=0;const c=[],h=[],u=[];let d=wn(e,i);if(i+=2,d!==65496)throw new mo("SOI not found");d=wn(e,i),i+=2;e:for(;d!==65497;){let f,g,m;switch(d){case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:const{appData:b,newOffset:p}=nk(e,i);i=p,d===65504&&b[0]===74&&b[1]===70&&b[2]===73&&b[3]===70&&b[4]===0&&(s={version:{major:b[5],minor:b[6]},densityUnits:b[7],xDensity:b[8]<<8|b[9],yDensity:b[10]<<8|b[11],thumbWidth:b[12],thumbHeight:b[13],thumbData:b.subarray(14,14+3*b[12]*b[13])}),d===65518&&b[0]===65&&b[1]===100&&b[2]===111&&b[3]===98&&b[4]===101&&(r={version:b[5]<<8|b[6],flags0:b[7]<<8|b[8],flags1:b[9]<<8|b[10],transformCode:b[11]});break;case 65499:const y=wn(e,i);i+=2;const w=y+i-2;let _;for(;i<w;){const B=e[i++],Z=new Uint16Array(64);if(B>>4)if(B>>4===1)for(g=0;g<64;g++)_=_p[g],Z[_]=wn(e,i),i+=2;else throw new mo("DQT - invalid table spec");else for(g=0;g<64;g++)_=_p[g],Z[_]=e[i++];c[B&15]=Z}break;case 65472:case 65473:case 65474:if(a)throw new mo("Only single frame JPEGs supported");i+=2,a={},a.extended=d===65473,a.progressive=d===65474,a.precision=e[i++];const v=wn(e,i);i+=2,a.scanLines=t||v,a.samplesPerLine=wn(e,i),i+=2,a.components=[],a.componentIds={};const C=e[i++];let k=0,I=0;for(f=0;f<C;f++){const B=e[i],Z=e[i+1]>>4,G=e[i+1]&15;k<Z&&(k=Z),I<G&&(I=G);const Y=e[i+2];m=a.components.push({h:Z,v:G,quantizationId:Y,quantizationTable:null}),a.componentIds[B]=m-1,i+=3}a.maxH=k,a.maxV=I,AH(a);break;case 65476:const E=wn(e,i);for(i+=2,f=2;f<E;){const B=e[i++],Z=new Uint8Array(16);let G=0;for(g=0;g<16;g++,i++)G+=Z[g]=e[i];const Y=new Uint8Array(G);for(g=0;g<G;g++,i++)Y[g]=e[i];f+=17+G,(B>>4?h:u)[B&15]=_H(Z,Y)}break;case 65501:i+=2,o=wn(e,i),i+=2;break;case 65498:const T=++l===1&&!t;i+=2;const M=e[i++],D=[];for(f=0;f<M;f++){const B=e[i++],Z=a.componentIds[B],G=a.components[Z];G.index=B;const Y=e[i++];G.huffmanTableDC=u[Y>>4],G.huffmanTableAC=h[Y&15],D.push(G)}const H=e[i++],R=e[i++],z=e[i++];try{const B=vH(e,i,a,D,o,H,R,z>>4,z&15,T);i+=B}catch(B){if(B instanceof q7)return ae(`${B.message} -- attempting to re-parse the JPEG image.`),this.parse(e,{dnlScanLines:B.scanLines});if(B instanceof FR){ae(`${B.message} -- ignoring the rest of the image data.`);break e}throw B}break;case 65500:i+=4;break;case 65535:e[i]!==255&&i--;break;default:const P=ly(e,i-2,i-3);if(P!=null&&P.invalid){ae("JpegImage.parse - unexpected data, current marker is: "+P.invalid),i=P.offset;break}if(!P||i>=e.length-1){ae("JpegImage.parse - reached the end of the image data without finding an EOI marker (0xFFD9).");break e}throw new mo("JpegImage.parse - unknown marker: "+d.toString(16))}d=wn(e,i),i+=2}if(!a)throw new mo("JpegImage.parse - no frame data found.");this.width=a.samplesPerLine,this.height=a.scanLines,this.jfif=s,this.adobe=r,this.components=[];for(const f of a.components){const g=c[f.quantizationId];g&&(f.quantizationTable=g),this.components.push({index:f.index,output:CH(a,f),scaleX:f.h/a.maxH,scaleY:f.v/a.maxV,blocksPerLine:f.blocksPerLine,blocksPerColumn:f.blocksPerColumn})}this.numComponents=this.components.length}_getLinearizedBlockData(e,t,i=!1){const s=this.width/e,r=this.height/t;let a,o,l,c,h,u,d,f,g,m,b=0,p;const y=this.components.length,w=e*t*y,_=new Uint8ClampedArray(w),v=new Uint32Array(e),C=4294967288;let k;for(d=0;d<y;d++){if(a=this.components[d],o=a.scaleX*s,l=a.scaleY*r,b=d,p=a.output,c=a.blocksPerLine+1<<3,o!==k){for(h=0;h<e;h++)f=0|h*o,v[h]=(f&C)<<3|f&7;k=o}for(u=0;u<t;u++)for(f=0|u*l,m=c*(f&C)|(f&7)<<3,h=0;h<e;h++)_[b]=p[m+v[h]],b+=y}let I=this._decodeTransform;if(!i&&y===4&&!I&&(I=new Int32Array([-256,255,-256,255,-256,255,-256,255])),I)for(d=0;d<w;)for(f=0,g=0;f<y;f++,d++,g+=2)_[d]=(_[d]*I[g]>>8)+I[g+1];return _}get _isColorConversionNeeded(){return this.adobe?!!this.adobe.transformCode:this.numComponents===3?this._colorTransform===0?!1:!(this.components[0].index===82&&this.components[1].index===71&&this.components[2].index===66):this._colorTransform===1}_convertYccToRgb(e){let t,i,s;for(let r=0,a=e.length;r<a;r+=3)t=e[r],i=e[r+1],s=e[r+2],e[r]=t-179.456+1.402*s,e[r+1]=t+135.459-.344*i-.714*s,e[r+2]=t-226.816+1.772*i;return e}_convertYccToRgba(e,t){for(let i=0,s=0,r=e.length;i<r;i+=3,s+=4){const a=e[i],o=e[i+1],l=e[i+2];t[s]=a-179.456+1.402*l,t[s+1]=a+135.459-.344*o-.714*l,t[s+2]=a-226.816+1.772*o,t[s+3]=255}return t}_convertYcckToRgb(e){return this._convertYcckToCmyk(e),this._convertCmykToRgb(e)}_convertYcckToRgba(e){return this._convertYcckToCmyk(e),this._convertCmykToRgba(e)}_convertYcckToCmyk(e){let t,i,s;for(let r=0,a=e.length;r<a;r+=4)t=e[r],i=e[r+1],s=e[r+2],e[r]=434.456-t-1.402*s,e[r+1]=119.541-t+.344*i+.714*s,e[r+2]=481.816-t-1.772*i;return e}_convertCmykToRgb(e){const t=e.length/4;return Dn.cmyk.getRgbBuffer(e,0,t,e,0,8,0),e.subarray(0,t*3)}_convertCmykToRgba(e){if(Dn.cmyk.getRgbBuffer(e,0,e.length/4,e,0,8,1),Dn.cmyk instanceof IR)for(let t=3,i=e.length;t<i;t+=4)e[t]=255;return e}getData({width:e,height:t,forceRGBA:i=!1,forceRGB:s=!1,isSourcePDF:r=!1}){if(this.numComponents>4)throw new mo("Unsupported color mode");const a=this._getLinearizedBlockData(e,t,r);if(this.numComponents===1&&(i||s)){const o=a.length*(i?4:3),l=new Uint8ClampedArray(o);let c=0;if(i)bH(a,new Uint32Array(l.buffer));else for(const h of a)l[c++]=h,l[c++]=h,l[c++]=h;return l}else if(this.numComponents===3&&this._isColorConversionNeeded){if(i){const o=new Uint8ClampedArray(a.length/3*4);return this._convertYccToRgba(a,o)}return this._convertYccToRgb(a)}else if(this.numComponents===4){if(this._isColorConversionNeeded)return i?this._convertYcckToRgba(a):s?this._convertYcckToRgb(a):this._convertYcckToCmyk(a);if(i)return this._convertCmykToRgba(a);if(s)return this._convertCmykToRgb(a)}return a}}var Zb,Qb,K7;const V5=class V5 extends na{constructor(t,i,s){super(i);U(this,Qb);this.stream=t,this.dict=t.dict,this.maybeLength=i,this.params=s}static get canUseImageDecoder(){return We(this,"canUseImageDecoder",x(this,Zb)?ImageDecoder.isTypeSupported("image/jpeg"):Promise.resolve(!1))}static setOptions({isImageDecoderSupported:t=!1}){O(this,Zb,t)}get bytes(){return We(this,"bytes",this.stream.getBytes(this.maybeLength))}ensureBuffer(t){}readBlock(){this.decodeImage()}get jpegOptions(){const t={decodeTransform:void 0,colorTransform:void 0},i=this.dict.getArray("D","Decode");if((this.forceRGBA||this.forceRGB)&&Array.isArray(i)){const s=this.dict.get("BPC","BitsPerComponent")||8,r=i.length,a=new Int32Array(r);let o=!1;const l=(1<<s)-1;for(let c=0;c<r;c+=2)a[c]=(i[c+1]-i[c])*256|0,a[c+1]=i[c]*l|0,(a[c]!==256||a[c+1]!==0)&&(o=!0);o&&(t.decodeTransform=a)}if(this.params instanceof ue){const s=this.params.get("ColorTransform");Number.isInteger(s)&&(t.colorTransform=s)}return We(this,"jpegOptions",t)}decodeImage(t){if(this.eof)return this.buffer;t=F(this,Qb,K7).call(this,t||this.bytes);const i=new ik(this.jpegOptions);i.parse(t);const s=i.getData({width:this.drawWidth,height:this.drawHeight,forceRGBA:this.forceRGBA,forceRGB:this.forceRGB,isSourcePDF:!0});return this.buffer=s,this.bufferLength=s.length,this.eof=!0,this.buffer}get canAsyncDecodeImageFromBuffer(){return this.stream.isAsync}async getTransferableImage(){if(!await V5.canUseImageDecoder)return null;const t=this.jpegOptions;if(t.decodeTransform)return null;let i;try{const s=this.canAsyncDecodeImageFromBuffer&&await this.stream.asyncGetBytes()||this.bytes;if(!s)return null;let r=F(this,Qb,K7).call(this,s);const a=ik.canUseImageDecoder(r,t.colorTransform);return a?(a.exifStart&&(r=r.slice(),r.fill(0,a.exifStart,a.exifEnd)),i=new ImageDecoder({data:r,type:"image/jpeg",preferAnimation:!1}),(await i.decode()).image):null}catch(s){return ae(`getTransferableImage - failed: "${s}".`),null}finally{i==null||i.close()}}};Zb=new WeakMap,Qb=new WeakSet,K7=function(t){for(let i=0,s=t.length-1;i<s;i++)if(t[i]===255&&t[i+1]===216){i>0&&(t=t.subarray(i));break}return t},U(V5,Zb,ya.isImageDecoderSupported);let Og=V5;var IH=async function(n={}){var e,t=n,i,s,r=new Promise((Oe,je)=>{i=Oe,s=je}),a="./this.program",o=(Oe,je)=>{throw je},l=import.meta.url,c="";try{c=new URL(".",l).href}catch{}var h=console.log.bind(console),u=console.error.bind(console),d,f=!1,g,m,b,p,y;function w(){var Oe=d.buffer;m=new Int8Array(Oe),b=new Uint8Array(Oe),p=new Int32Array(Oe),y=new Uint32Array(Oe),new BigInt64Array(Oe),new BigUint64Array(Oe)}function _(){if(t.preRun)for(typeof t.preRun=="function"&&(t.preRun=[t.preRun]);t.preRun.length;)G(t.preRun.shift());z(Z)}function v(){yi.t()}function C(){if(t.postRun)for(typeof t.postRun=="function"&&(t.postRun=[t.postRun]);t.postRun.length;)B(t.postRun.shift());z(P)}var k=0,I=null;function E(Oe){var je;k++,(je=t.monitorRunDependencies)==null||je.call(t,k)}function T(Oe){var ht;if(k--,(ht=t.monitorRunDependencies)==null||ht.call(t,k),k==0&&I){var je=I;I=null,je()}}function M(Oe){var ht;(ht=t.onAbort)==null||ht.call(t,Oe),Oe="Aborted("+Oe+")",u(Oe),f=!0,Oe+=". Build with -sASSERTIONS for more info.";var je=new WebAssembly.RuntimeError(Oe);throw s(je),je}function D(){return{a:Ki}}async function H(){function Oe(ht,Xt){return yi=ht.exports,d=yi.s,w(),T(),yi}E();var je=D();return new Promise((ht,Xt)=>{t.instantiateWasm(je,(tn,En)=>{ht(Oe(tn))})})}class R{constructor(je){Ue(this,"name","ExitStatus");this.message=`Program terminated with exit(${je})`,this.status=je}}var z=Oe=>{for(;Oe.length>0;)Oe.shift()(t)},P=[],B=Oe=>P.push(Oe),Z=[],G=Oe=>Z.push(Oe),Y=!0,J=()=>M(""),se=0,fe=()=>{Y=!1,se=0},he={},de=Oe=>{if(Oe instanceof R||Oe=="unwind")return g;o(1,Oe)},ge=()=>Y||se>0,N=Oe=>{var je;g=Oe,ge()||((je=t.onExit)==null||je.call(t,Oe),f=!0),o(Oe,new R(Oe))},K=(Oe,je)=>{g=Oe,N(Oe)},oe=K,W=()=>{if(!ge())try{oe(g)}catch(Oe){de(Oe)}},le=Oe=>{if(!f)try{Oe(),W()}catch(je){de(je)}},ce=()=>performance.now(),Ce=(Oe,je)=>{if(he[Oe]&&(clearTimeout(he[Oe].id),delete he[Oe]),!je)return 0;var ht=setTimeout(()=>{delete he[Oe],le(()=>yr(Oe,ce()))},je);return he[Oe]={id:ht,timeout_ms:je},0};function X(Oe,je){Oe>>=2;const ht=t.imageData=new Uint8ClampedArray(je),Xt=p.subarray(Oe,Oe+je);ht.set(Xt)}function Ke(Oe,je,ht,Xt){Oe>>=2,je>>=2,ht>>=2;const tn=t.imageData=new Uint8ClampedArray(Xt*3),En=p.subarray(Oe,Oe+Xt),mn=p.subarray(je,je+Xt),Pn=p.subarray(ht,ht+Xt);for(let Bn=0;Bn<Xt;Bn++)tn[3*Bn]=En[Bn],tn[3*Bn+1]=mn[Bn],tn[3*Bn+2]=Pn[Bn]}function qe(Oe,je,ht,Xt,tn){Oe>>=2,je>>=2,ht>>=2,Xt>>=2;const En=t.imageData=new Uint8ClampedArray(tn*4),mn=p.subarray(Oe,Oe+tn),Pn=p.subarray(je,je+tn),Bn=p.subarray(ht,ht+tn),xl=p.subarray(Xt,Xt+tn);for(let wr=0;wr<tn;wr++)En[4*wr]=mn[wr],En[4*wr+1]=Pn[wr],En[4*wr+2]=Bn[wr],En[4*wr+3]=xl[wr]}var He=()=>2147483648,Me=(Oe,je)=>Math.ceil(Oe/je)*je,Ne=Oe=>{var je=d.buffer,ht=(Oe-je.byteLength+65535)/65536|0;try{return d.grow(ht),w(),1}catch{}},Qe=Oe=>{var je=b.length;Oe>>>=0;var ht=He();if(Oe>ht)return!1;for(var Xt=1;Xt<=4;Xt*=2){var tn=je*(1+.2/Xt);tn=Math.min(tn,Oe+100663296);var En=Math.min(ht,Me(Math.max(Oe,tn),65536)),mn=Ne(En);if(mn)return!0}return!1},gt={},mt=()=>a||"./this.program",Xe=()=>{if(!Xe.strings){var Oe=(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",je={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:Oe,_:mt()};for(var ht in gt)gt[ht]===void 0?delete je[ht]:je[ht]=gt[ht];var Xt=[];for(var ht in je)Xt.push(`${ht}=${je[ht]}`);Xe.strings=Xt}return Xe.strings},rt=(Oe,je,ht,Xt)=>{if(!(Xt>0))return 0;for(var tn=ht,En=ht+Xt-1,mn=0;mn<Oe.length;++mn){var Pn=Oe.charCodeAt(mn);if(Pn>=55296&&Pn<=57343){var Bn=Oe.charCodeAt(++mn);Pn=65536+((Pn&1023)<<10)|Bn&1023}if(Pn<=127){if(ht>=En)break;je[ht++]=Pn}else if(Pn<=2047){if(ht+1>=En)break;je[ht++]=192|Pn>>6,je[ht++]=128|Pn&63}else if(Pn<=65535){if(ht+2>=En)break;je[ht++]=224|Pn>>12,je[ht++]=128|Pn>>6&63,je[ht++]=128|Pn&63}else{if(ht+3>=En)break;je[ht++]=240|Pn>>18,je[ht++]=128|Pn>>12&63,je[ht++]=128|Pn>>6&63,je[ht++]=128|Pn&63}}return je[ht]=0,ht-tn},me=(Oe,je,ht)=>rt(Oe,b,je,ht),Rt=(Oe,je)=>{var ht=0,Xt=0;for(var tn of Xe()){var En=je+ht;y[Oe+Xt>>2]=En,ht+=me(tn,En,1/0)+1,Xt+=4}return 0},ct=Oe=>{for(var je=0,ht=0;ht<Oe.length;++ht){var Xt=Oe.charCodeAt(ht);Xt<=127?je++:Xt<=2047?je+=2:Xt>=55296&&Xt<=57343?(je+=4,++ht):je+=3}return je},at=(Oe,je)=>{var ht=Xe();y[Oe>>2]=ht.length;var Xt=0;for(var tn of ht)Xt+=ct(tn)+1;return y[je>>2]=Xt,0},ze=Oe=>52;function Ht(Oe,je,ht,Xt){return 70}var on=[null,[],[]],Re=typeof TextDecoder<"u"?new TextDecoder:void 0,Mt=(Oe,je=0,ht=NaN)=>{for(var Xt=je+ht,tn=je;Oe[tn]&&!(tn>=Xt);)++tn;if(tn-je>16&&Oe.buffer&&Re)return Re.decode(Oe.subarray(je,tn));for(var En="";je<tn;){var mn=Oe[je++];if(!(mn&128)){En+=String.fromCharCode(mn);continue}var Pn=Oe[je++]&63;if((mn&224)==192){En+=String.fromCharCode((mn&31)<<6|Pn);continue}var Bn=Oe[je++]&63;if((mn&240)==224?mn=(mn&15)<<12|Pn<<6|Bn:mn=(mn&7)<<18|Pn<<12|Bn<<6|Oe[je++]&63,mn<65536)En+=String.fromCharCode(mn);else{var xl=mn-65536;En+=String.fromCharCode(55296|xl>>10,56320|xl&1023)}}return En},yt=(Oe,je)=>{var ht=on[Oe];je===0||je===10?((Oe===1?h:u)(Mt(ht)),ht.length=0):ht.push(je)},Gt=(Oe,je)=>Oe?Mt(b,Oe,je):"",un=(Oe,je,ht,Xt)=>{for(var tn=0,En=0;En<ht;En++){var mn=y[je>>2],Pn=y[je+4>>2];je+=8;for(var Bn=0;Bn<Pn;Bn++)yt(Oe,b[mn+Bn]);tn+=Pn}return y[Xt>>2]=tn,0};function Kn(Oe,je){Oe>>=2;const ht=t.imageData=new Uint8ClampedArray(je*4),Xt=p.subarray(Oe,Oe+je);for(let tn=0;tn<je;tn++)ht[4*tn]=ht[4*tn+1]=ht[4*tn+2]=Xt[tn],ht[4*tn+3]=255}function di(Oe,je,ht){Oe>>=2,je>>=2;const Xt=t.imageData=new Uint8ClampedArray(ht*4),tn=p.subarray(Oe,Oe+ht),En=p.subarray(je,je+ht);for(let mn=0;mn<ht;mn++)Xt[4*mn]=Xt[4*mn+1]=Xt[4*mn+2]=tn[mn],Xt[4*mn+3]=En[mn]}function qi(Oe){const je=Gt(Oe);(t.warn||console.warn)(`OpenJPEG: ${je}`)}function Cs(Oe,je,ht,Xt){Oe>>=2,je>>=2,ht>>=2;const tn=t.imageData=new Uint8ClampedArray(Xt*4),En=p.subarray(Oe,Oe+Xt),mn=p.subarray(je,je+Xt),Pn=p.subarray(ht,ht+Xt);for(let Bn=0;Bn<Xt;Bn++)tn[4*Bn]=En[Bn],tn[4*Bn+1]=mn[Bn],tn[4*Bn+2]=Pn[Bn],tn[4*Bn+3]=255}function Wi(Oe){const je=Gt(Oe);t.errorMessages?t.errorMessages+=`
`+je:t.errorMessages=je}var Ms=(Oe,je)=>{m.set(Oe,je)};t.noExitRuntime&&(Y=t.noExitRuntime),t.print&&(h=t.print),t.printErr&&(u=t.printErr),t.wasmBinary&&t.wasmBinary,t.arguments&&t.arguments,t.thisProgram&&(a=t.thisProgram),t.writeArrayToMemory=Ms;var Ki={l:J,k:fe,m:Ce,g:X,f:Ke,e:qe,n:Qe,p:Rt,q:at,b:ze,o:Ht,c:un,r:Kn,i:di,d:qi,j:N,h:Cs,a:Wi},yi=await H();yi.t,t._malloc=yi.u,t._free=yi.v,t._jp2_decode=yi.w;var yr=yi.x;function Ps(){if(k>0){I=Ps;return}if(_(),k>0){I=Ps;return}function Oe(){var je;t.calledRun=!0,!f&&(v(),i(t),(je=t.onRuntimeInitialized)==null||je.call(t),C())}t.setStatus?(t.setStatus("Running..."),setTimeout(()=>{setTimeout(()=>t.setStatus(""),1),Oe()},1)):Oe()}function Ns(){if(t.preInit)for(typeof t.preInit=="function"&&(t.preInit=[t.preInit]);t.preInit.length>0;)t.preInit.shift()()}return Ns(),Ps(),e=r,e};const EH=IH;class Qx extends sa{constructor(e){super(e,"JpxError")}}var Ld,Ag,Bd,$b,ex,Sg,uf,X7,LR;class Yo{static setOptions({handler:e,useWasm:t,useWorkerFetch:i,wasmUrl:s}){O(this,$b,t),O(this,ex,i),O(this,Sg,s),i||O(this,Ag,e)}static async decode(e,{numComponents:t=4,isIndexedColormap:i=!1,smaskInData:s=!1,reducePower:r=0}={}){if(!x(this,Bd)){const{promise:l,resolve:c}=Promise.withResolvers(),h=[l];x(this,$b)?h.push(EH({warn:ae,instantiateWasm:F(this,uf,LR).bind(this,c)})):F(this,uf,X7).call(this,c),O(this,Bd,Promise.race(h))}const a=await x(this,Bd);if(!a)throw new Qx("OpenJPEG failed to initialize");let o;try{const l=e.length;if(o=a._malloc(l),a.writeArrayToMemory(e,o),a._jp2_decode(o,l,t>0?t:0,!!i,!!s,r)){const{errorMessages:u}=a;throw u?(delete a.errorMessages,new Qx(u)):new Qx("Unknown error")}const{imageData:h}=a;return a.imageData=null,h}finally{o&&a._free(o)}}static cleanup(){O(this,Bd,null)}static parseImageProperties(e){let t=e.getByte();for(;t>=0;){const i=t;if(t=e.getByte(),(i<<8|t)===65361){e.skip(4);const r=e.getInt32()>>>0,a=e.getInt32()>>>0,o=e.getInt32()>>>0,l=e.getInt32()>>>0;e.skip(16);const c=e.getUint16();return{width:r-o,height:a-l,bitsPerComponent:8,componentsCount:c}}}throw new Qx("No size marker found in JPX stream")}}Ld=new WeakMap,Ag=new WeakMap,Bd=new WeakMap,$b=new WeakMap,ex=new WeakMap,Sg=new WeakMap,uf=new WeakSet,X7=async function(e){const t=`${x(this,Sg)}openjpeg_nowasm_fallback.js`;let i=null;try{i=(await import(t)).default()}catch(s){ae(`JpxImage#getJsModule: ${s}`)}e(i)},LR=async function(e,t,i){const s="openjpeg.wasm";try{x(this,Ld)||(x(this,ex)?O(this,Ld,await D7(`${x(this,Sg)}${s}`)):O(this,Ld,await x(this,Ag).sendWithPromise("FetchBinaryData",{type:"wasmFactory",filename:s})));const r=await WebAssembly.instantiate(x(this,Ld),t);return i(r.instance)}catch(r){return ae(`JpxImage#instantiateWasm: ${r}`),F(this,uf,X7).call(this,e),null}finally{O(this,Ag,null)}},U(Yo,uf),U(Yo,Ld,null),U(Yo,Ag,null),U(Yo,Bd,null),U(Yo,$b,!0),U(Yo,ex,!0),U(Yo,Sg,null);function xx(n,e,t,i,s){let r=n;for(let a=0,o=e.length-1;a<o;a++){const l=e[a];r=r[l]||(r[l]=[])}r[e.at(-1)]={checkFn:t,iterateFn:i,processFn:s}}const tf=[];xx(tf,[ie.save,ie.transform,ie.paintInlineImageXObject,ie.restore],null,function(e,t){const i=e.fnArray,s=e.iCurr-3,r=(t-s)%4;switch(r){case 0:return i[t]===ie.save;case 1:return i[t]===ie.transform;case 2:return i[t]===ie.paintInlineImageXObject;case 3:return i[t]===ie.restore}throw new Error(`iterateInlineImageGroup - invalid pos: ${r}`)},function(e,t){const o=e.fnArray,l=e.argsArray,c=e.iCurr,h=c-3,u=c-2,d=c-1,f=Math.min(Math.floor((t-h)/4),200);if(f<10)return t-(t-h)%4;let g=0;const m=[];let b=0,p=1,y=1;for(let I=0;I<f;I++){const E=l[u+(I<<2)],T=l[d+(I<<2)][0];p+T.width>1e3&&(g=Math.max(g,p),y+=b+2*1,p=0,b=0),m.push({transform:E,x:p,y,w:T.width,h:T.height}),p+=T.width+2*1,b=Math.max(b,T.height)}const w=Math.max(g,p)+1,_=y+b+1,v=new Uint8Array(w*_*4),C=w<<2;for(let I=0;I<f;I++){const E=l[d+(I<<2)][0].data,T=m[I].w<<2;let M=0,D=m[I].x+m[I].y*w<<2;v.set(E.subarray(0,T),D-C);for(let H=0,R=m[I].h;H<R;H++)v.set(E.subarray(M,M+T),D),M+=T,D+=C;for(v.set(E.subarray(M-T,M),D);D>=0;)E[D-4]=E[D],E[D-3]=E[D+1],E[D-2]=E[D+2],E[D-1]=E[D+3],E[D+T]=E[D+T-4],E[D+T+1]=E[D+T-3],E[D+T+2]=E[D+T-2],E[D+T+3]=E[D+T-1],D-=C}const k={width:w,height:_};if(e.isOffscreenCanvasSupported){const I=new OffscreenCanvas(w,_);I.getContext("2d").putImageData(new ImageData(new Uint8ClampedArray(v.buffer),w,_),0,0),k.bitmap=I.transferToImageBitmap(),k.data=null}else k.kind=zs.RGBA_32BPP,k.data=v;return o.splice(h,f*4,ie.paintInlineImageXObjectGroup),l.splice(h,f*4,[k,m]),h+1});xx(tf,[ie.save,ie.transform,ie.paintImageMaskXObject,ie.restore],null,function(e,t){const i=e.fnArray,s=e.iCurr-3,r=(t-s)%4;switch(r){case 0:return i[t]===ie.save;case 1:return i[t]===ie.transform;case 2:return i[t]===ie.paintImageMaskXObject;case 3:return i[t]===ie.restore}throw new Error(`iterateImageMaskGroup - invalid pos: ${r}`)},function(e,t){const a=e.fnArray,o=e.argsArray,l=e.iCurr,c=l-3,h=l-2,u=l-1;let d=Math.floor((t-c)/4);if(d<10)return t-(t-c)%4;let f=!1,g,m;const b=o[u][0],p=o[h][0],y=o[h][1],w=o[h][2],_=o[h][3];if(y===w){f=!0,g=h+4;let v=u+4;for(let C=1;C<d;C++,g+=4,v+=4)if(m=o[g],o[v][0]!==b||m[0]!==p||m[1]!==y||m[2]!==w||m[3]!==_){C<10?f=!1:d=C;break}}if(f){d=Math.min(d,1e3);const v=new Float32Array(d*2);g=h;for(let C=0;C<d;C++,g+=4)m=o[g],v[C<<1]=m[4],v[(C<<1)+1]=m[5];a.splice(c,d*4,ie.paintImageMaskXObjectRepeat),o.splice(c,d*4,[b,p,y,w,_,v])}else{d=Math.min(d,100);const v=[];for(let C=0;C<d;C++){m=o[h+(C<<2)];const k=o[u+(C<<2)][0];v.push({data:k.data,width:k.width,height:k.height,interpolate:k.interpolate,count:k.count,transform:m})}a.splice(c,d*4,ie.paintImageMaskXObjectGroup),o.splice(c,d*4,[v])}return c+1});xx(tf,[ie.save,ie.transform,ie.paintImageXObject,ie.restore],function(n){const e=n.argsArray,t=n.iCurr-2;return e[t][1]===0&&e[t][2]===0},function(e,t){const i=e.fnArray,s=e.argsArray,r=e.iCurr-3,a=(t-r)%4;switch(a){case 0:return i[t]===ie.save;case 1:if(i[t]!==ie.transform)return!1;const o=e.iCurr-2,l=s[o][0],c=s[o][3];return!(s[t][0]!==l||s[t][1]!==0||s[t][2]!==0||s[t][3]!==c);case 2:if(i[t]!==ie.paintImageXObject)return!1;const h=e.iCurr-1,u=s[h][0];return s[t][0]===u;case 3:return i[t]===ie.restore}throw new Error(`iterateImageGroup - invalid pos: ${a}`)},function(n,e){const s=n.fnArray,r=n.argsArray,a=n.iCurr,o=a-3,l=a-2,c=a-1,h=r[c][0],u=r[l][0],d=r[l][3],f=Math.min(Math.floor((e-o)/4),1e3);if(f<3)return e-(e-o)%4;const g=new Float32Array(f*2);let m=l;for(let p=0;p<f;p++,m+=4){const y=r[m];g[p<<1]=y[4],g[(p<<1)+1]=y[5]}const b=[h,u,d,g];return s.splice(o,f*4,ie.paintImageXObjectRepeat),r.splice(o,f*4,b),o+1});xx(tf,[ie.beginText,ie.setFont,ie.setTextMatrix,ie.showText,ie.endText],null,function(e,t){const i=e.fnArray,s=e.argsArray,r=e.iCurr-4,a=(t-r)%5;switch(a){case 0:return i[t]===ie.beginText;case 1:return i[t]===ie.setFont;case 2:return i[t]===ie.setTextMatrix;case 3:if(i[t]!==ie.showText)return!1;const o=e.iCurr-3,l=s[o][0],c=s[o][1];return!(s[t][0]!==l||s[t][1]!==c);case 4:return i[t]===ie.endText}throw new Error(`iterateShowTextGroup - invalid pos: ${a}`)},function(n,e){const s=n.fnArray,r=n.argsArray,a=n.iCurr,o=a-4,l=a-3,c=a-2,h=a-1,u=a,d=r[l][0],f=r[l][1];let g=Math.min(Math.floor((e-o)/5),1e3);if(g<3)return e-(e-o)%5;let m=o;o>=4&&s[o-4]===s[l]&&s[o-3]===s[c]&&s[o-2]===s[h]&&s[o-1]===s[u]&&r[o-4][0]===d&&r[o-4][1]===f&&(g++,m-=5);let b=m+4;for(let p=1;p<g;p++)s.splice(b,3),r.splice(b,3),b+=2;return b+1});xx(tf,[ie.save,ie.transform,ie.constructPath,ie.restore],n=>{const e=n.argsArray,t=n.iCurr-1,i=e[t][0];if(i!==ie.stroke&&i!==ie.closeStroke&&i!==ie.fillStroke&&i!==ie.eoFillStroke&&i!==ie.closeFillStroke&&i!==ie.closeEOFillStroke)return!0;const s=n.iCurr-2,r=e[s];return r[0]===1&&r[1]===0&&r[2]===0&&r[3]===1},()=>!1,(n,e)=>{const{fnArray:t,argsArray:i}=n,s=n.iCurr,r=s-3,a=s-2,o=s-1,l=i[o],c=i[a],[,[h],u]=l;if(u){Ln.scaleMinMax(c,u);for(let d=0,f=h.length;d<f;)switch(h[d++]){case xs.moveTo:case xs.lineTo:Ln.applyTransform(h,c,d),d+=2;break;case xs.curveTo:Ln.applyTransformToBezier(h,c,d),d+=6;break}}return t.splice(r,4,ie.constructPath),i.splice(r,4,l),r+1});class BR{constructor(e){this.queue=e}_optimize(){}push(e,t){this.queue.fnArray.push(e),this.queue.argsArray.push(t),this._optimize()}flush(){}reset(){}}class TH extends BR{constructor(e){super(e),this.state=null,this.context={iCurr:0,fnArray:e.fnArray,argsArray:e.argsArray,isOffscreenCanvasSupported:Pr.isOffscreenCanvasSupported},this.match=null,this.lastProcessed=0}_optimize(){const e=this.queue.fnArray;let t=this.lastProcessed,i=e.length,s=this.state,r=this.match;if(!s&&!r&&t+1===i&&!tf[e[t]]){this.lastProcessed=i;return}const a=this.context;for(;t<i;){if(r){if((0,r.iterateFn)(a,t)){t++;continue}if(t=(0,r.processFn)(a,t+1),i=e.length,r=null,s=null,t>=i)break}if(s=(s||tf)[e[t]],!s||Array.isArray(s)){t++;continue}if(a.iCurr=t,t++,s.checkFn&&!(0,s.checkFn)(a)){s=null;continue}r=s,s=null}this.state=s,this.match=r,this.lastProcessed=t}flush(){for(;this.match;){const e=this.queue.fnArray.length;this.lastProcessed=(0,this.match.processFn)(this.context,e),this.match=null,this.state=null,this._optimize()}}reset(){this.state=null,this.match=null,this.lastProcessed=0}}const Ac=class Ac{constructor(e=0,t){this._streamSink=t,this.fnArray=[],this.argsArray=[],this.optimizer=t&&!(e&Wr.OPLIST)?new TH(this):new BR(this),this.dependencies=new Set,this._totalLength=0,this.weight=0,this._resolved=t?null:Promise.resolve()}static setOptions({isOffscreenCanvasSupported:e}){this.isOffscreenCanvasSupported=e}get length(){return this.argsArray.length}get ready(){return this._resolved||this._streamSink.ready}get totalLength(){return this._totalLength+this.length}addOp(e,t){this.optimizer.push(e,t),this.weight++,this._streamSink&&(this.weight>=Ac.CHUNK_SIZE?this.flush():this.weight>=Ac.CHUNK_SIZE_ABOUT&&(e===ie.restore||e===ie.endText)&&this.flush())}addImageOps(e,t,i,s=!1){s&&(this.addOp(ie.save),this.addOp(ie.setGState,[[["SMask",!1]]])),i!==void 0&&this.addOp(ie.beginMarkedContentProps,["OC",i]),this.addOp(e,t),i!==void 0&&this.addOp(ie.endMarkedContent,[]),s&&this.addOp(ie.restore)}addDependency(e){this.dependencies.has(e)||(this.dependencies.add(e),this.addOp(ie.dependency,[e]))}addDependencies(e){for(const t of e)this.addDependency(t)}addOpList(e){if(!(e instanceof Ac)){ae('addOpList - ignoring invalid "opList" parameter.');return}for(const t of e.dependencies)this.dependencies.add(t);for(let t=0,i=e.length;t<i;t++)this.addOp(e.fnArray[t],e.argsArray[t])}getIR(){return{fnArray:this.fnArray,argsArray:this.argsArray,length:this.length}}get _transfers(){const e=[],{fnArray:t,argsArray:i,length:s}=this;for(let r=0;r<s;r++)switch(t[r]){case ie.paintInlineImageXObject:case ie.paintInlineImageXObjectGroup:case ie.paintImageMaskXObject:{const{bitmap:l,data:c}=i[r][0];(l||c!=null&&c.buffer)&&e.push(l||c.buffer);break}case ie.constructPath:{const[,[l],c]=i[r];l&&e.push(l.buffer,c.buffer);break}case ie.paintFormXObjectBegin:const[a,o]=i[r];a&&e.push(a.buffer),o&&e.push(o.buffer);break;case ie.setTextMatrix:e.push(i[r][0].buffer);break}return e}flush(e=!1,t=null){this.optimizer.flush();const i=this.length;this._totalLength+=i,this._streamSink.enqueue({fnArray:this.fnArray,argsArray:this.argsArray,lastChunk:e,separateAnnots:t,length:i},1,this._transfers),this.dependencies.clear(),this.fnArray.length=0,this.argsArray.length=0,this.weight=0,this.optimizer.reset()}};Ue(Ac,"CHUNK_SIZE",1e3),Ue(Ac,"CHUNK_SIZE_ABOUT",Ac.CHUNK_SIZE-5),Ue(Ac,"isOffscreenCanvasSupported",!1);let Pr=Ac;function vr(n,e){let t=0;for(let i=0;i<=e;i++)t=t<<8|n[i];return t>>>0}function $x(n,e){return e===1?String.fromCharCode(n[0],n[1]):e===3?String.fromCharCode(n[0],n[1],n[2],n[3]):String.fromCharCode(...n.subarray(0,e+1))}function Lr(n,e,t){let i=0;for(let s=t;s>=0;s--)i+=n[s]+e[s],n[s]=i&255,i>>=8}function su(n,e){let t=1;for(let i=e;i>=0&&t>0;i--)t+=n[i],n[i]=t&255,t>>=8}const yf=16,RH=19;class MH{constructor(e){this.buffer=e,this.pos=0,this.end=e.length,this.tmpBuf=new Uint8Array(RH)}readByte(){return this.pos>=this.end?-1:this.buffer[this.pos++]}readNumber(){let e=0,t;do{const i=this.readByte();if(i<0)throw new Te("unexpected EOF in bcmap");t=!(i&128),e=e<<7|i&127}while(!t);return e}readSigned(){const e=this.readNumber();return e&1?~(e>>>1):e>>>1}readHex(e,t){e.set(this.buffer.subarray(this.pos,this.pos+t+1)),this.pos+=t+1}readHexNumber(e,t){let i;const s=this.tmpBuf;let r=0;do{const c=this.readByte();if(c<0)throw new Te("unexpected EOF in bcmap");i=!(c&128),s[r++]=c&127}while(!i);let a=t,o=0,l=0;for(;a>=0;){for(;l<8&&s.length>0;)o|=s[--r]<<l,l+=7;e[a]=o&255,a--,o>>=8,l-=8}}readHexSigned(e,t){this.readHexNumber(e,t);const i=e[t]&1?255:0;let s=0;for(let r=0;r<=t;r++)s=(s&1)<<8|e[r],e[r]=s>>1^i}readString(){const e=this.readNumber(),t=new Array(e);for(let i=0;i<e;i++)t[i]=this.readNumber();return String.fromCharCode(...t)}}class PH{async process(e,t,i){const s=new MH(e),r=s.readByte();t.vertical=!!(r&1);let a=null;const o=new Uint8Array(yf),l=new Uint8Array(yf),c=new Uint8Array(yf),h=new Uint8Array(yf),u=new Uint8Array(yf);let d,f;for(;(f=s.readByte())>=0;){const g=f>>5;if(g===7){switch(f&31){case 0:s.readString();break;case 1:a=s.readString();break}continue}const m=!!(f&16),b=f&15;if(b+1>yf)throw new Error("BinaryCMapReader.process: Invalid dataSize.");const p=1,y=s.readNumber();switch(g){case 0:s.readHex(o,b),s.readHexNumber(l,b),Lr(l,o,b),t.addCodespaceRange(b+1,vr(o,b),vr(l,b));for(let w=1;w<y;w++)su(l,b),s.readHexNumber(o,b),Lr(o,l,b),s.readHexNumber(l,b),Lr(l,o,b),t.addCodespaceRange(b+1,vr(o,b),vr(l,b));break;case 1:s.readHex(o,b),s.readHexNumber(l,b),Lr(l,o,b),s.readNumber();for(let w=1;w<y;w++)su(l,b),s.readHexNumber(o,b),Lr(o,l,b),s.readHexNumber(l,b),Lr(l,o,b),s.readNumber();break;case 2:s.readHex(c,b),d=s.readNumber(),t.mapOne(vr(c,b),d);for(let w=1;w<y;w++)su(c,b),m||(s.readHexNumber(u,b),Lr(c,u,b)),d=s.readSigned()+(d+1),t.mapOne(vr(c,b),d);break;case 3:s.readHex(o,b),s.readHexNumber(l,b),Lr(l,o,b),d=s.readNumber(),t.mapCidRange(vr(o,b),vr(l,b),d);for(let w=1;w<y;w++)su(l,b),m?o.set(l):(s.readHexNumber(o,b),Lr(o,l,b)),s.readHexNumber(l,b),Lr(l,o,b),d=s.readNumber(),t.mapCidRange(vr(o,b),vr(l,b),d);break;case 4:s.readHex(c,p),s.readHex(h,b),t.mapOne(vr(c,p),$x(h,b));for(let w=1;w<y;w++)su(c,p),m||(s.readHexNumber(u,p),Lr(c,u,p)),su(h,b),s.readHexSigned(u,b),Lr(h,u,b),t.mapOne(vr(c,p),$x(h,b));break;case 5:s.readHex(o,p),s.readHexNumber(l,p),Lr(l,o,p),s.readHex(h,b),t.mapBfRange(vr(o,p),vr(l,p),$x(h,b));for(let w=1;w<y;w++)su(l,p),m?o.set(l):(s.readHexNumber(o,p),Lr(o,l,p)),s.readHexNumber(l,p),Lr(l,o,p),s.readHex(h,b),t.mapBfRange(vr(o,p),vr(l,p),$x(h,b));break;default:throw new Error(`BinaryCMapReader.process - unknown type: ${g}`)}}return a?i(a):t}}class NH extends na{constructor(e,t){t&&(t*=.8),super(t),this.str=e,this.dict=e.dict,this.input=new Uint8Array(5)}readBlock(){const s=this.str;let r=s.getByte();for(;Za(r);)r=s.getByte();if(r===-1||r===126){this.eof=!0;return}const a=this.bufferLength;let o,l;if(r===122){for(o=this.ensureBuffer(a+4),l=0;l<4;++l)o[a+l]=0;this.bufferLength+=4}else{const c=this.input;for(c[0]=r,l=1;l<5;++l){for(r=s.getByte();Za(r);)r=s.getByte();if(c[l]=r,r===-1||r===126)break}if(o=this.ensureBuffer(a+l-1),this.bufferLength+=l-1,l<5){for(;l<5;++l)c[l]=117;this.eof=!0}let h=0;for(l=0;l<5;++l)h=h*85+(c[l]-33);for(l=3;l>=0;--l)o[a+l]=h&255,h>>=8}}}class OH extends na{constructor(e,t){t&&(t*=.5),super(t),this.str=e,this.dict=e.dict,this.firstDigit=-1}readBlock(){const t=this.str.getBytes(8e3);if(!t.length){this.eof=!0;return}const i=t.length+1>>1,s=this.ensureBuffer(this.bufferLength+i);let r=this.bufferLength,a=this.firstDigit;for(const o of t){let l;if(o>=48&&o<=57)l=o&15;else if(o>=65&&o<=70||o>=97&&o<=102)l=(o&15)+9;else if(o===62){this.eof=!0;break}else continue;a<0?a=l:(s[r++]=a<<4|l,a=-1)}a>=0&&this.eof&&(s[r++]=a<<4,a=-1),this.firstDigit=a,this.bufferLength=r}}const Y7=-2,gc=-1,wc=0,tr=1,zt=2,nr=3,ir=4,J7=5,Z7=6,UR=7,HR=8,sk=[[-1,-1],[-1,-1],[7,HR],[7,UR],[6,Z7],[6,Z7],[6,J7],[6,J7],[4,wc],[4,wc],[4,wc],[4,wc],[4,wc],[4,wc],[4,wc],[4,wc],[3,tr],[3,tr],[3,tr],[3,tr],[3,tr],[3,tr],[3,tr],[3,tr],[3,tr],[3,tr],[3,tr],[3,tr],[3,tr],[3,tr],[3,tr],[3,tr],[3,ir],[3,ir],[3,ir],[3,ir],[3,ir],[3,ir],[3,ir],[3,ir],[3,ir],[3,ir],[3,ir],[3,ir],[3,ir],[3,ir],[3,ir],[3,ir],[3,nr],[3,nr],[3,nr],[3,nr],[3,nr],[3,nr],[3,nr],[3,nr],[3,nr],[3,nr],[3,nr],[3,nr],[3,nr],[3,nr],[3,nr],[3,nr],[1,zt],[1,zt],[1,zt],[1,zt],[1,zt],[1,zt],[1,zt],[1,zt],[1,zt],[1,zt],[1,zt],[1,zt],[1,zt],[1,zt],[1,zt],[1,zt],[1,zt],[1,zt],[1,zt],[1,zt],[1,zt],[1,zt],[1,zt],[1,zt],[1,zt],[1,zt],[1,zt],[1,zt],[1,zt],[1,zt],[1,zt],[1,zt],[1,zt],[1,zt],[1,zt],[1,zt],[1,zt],[1,zt],[1,zt],[1,zt],[1,zt],[1,zt],[1,zt],[1,zt],[1,zt],[1,zt],[1,zt],[1,zt],[1,zt],[1,zt],[1,zt],[1,zt],[1,zt],[1,zt],[1,zt],[1,zt],[1,zt],[1,zt],[1,zt],[1,zt],[1,zt],[1,zt],[1,zt],[1,zt]],rk=[[-1,-1],[12,Y7],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[11,1792],[11,1792],[12,1984],[12,2048],[12,2112],[12,2176],[12,2240],[12,2304],[11,1856],[11,1856],[11,1920],[11,1920],[12,2368],[12,2432],[12,2496],[12,2560]],ak=[[-1,-1],[-1,-1],[-1,-1],[-1,-1],[8,29],[8,29],[8,30],[8,30],[8,45],[8,45],[8,46],[8,46],[7,22],[7,22],[7,22],[7,22],[7,23],[7,23],[7,23],[7,23],[8,47],[8,47],[8,48],[8,48],[6,13],[6,13],[6,13],[6,13],[6,13],[6,13],[6,13],[6,13],[7,20],[7,20],[7,20],[7,20],[8,33],[8,33],[8,34],[8,34],[8,35],[8,35],[8,36],[8,36],[8,37],[8,37],[8,38],[8,38],[7,19],[7,19],[7,19],[7,19],[8,31],[8,31],[8,32],[8,32],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,12],[6,12],[6,12],[6,12],[6,12],[6,12],[6,12],[6,12],[8,53],[8,53],[8,54],[8,54],[7,26],[7,26],[7,26],[7,26],[8,39],[8,39],[8,40],[8,40],[8,41],[8,41],[8,42],[8,42],[8,43],[8,43],[8,44],[8,44],[7,21],[7,21],[7,21],[7,21],[7,28],[7,28],[7,28],[7,28],[8,61],[8,61],[8,62],[8,62],[8,63],[8,63],[8,0],[8,0],[8,320],[8,320],[8,384],[8,384],[5,10],[5,10],[5,10],[5,10],[5,10],[5,10],[5,10],[5,10],[5,10],[5,10],[5,10],[5,10],[5,10],[5,10],[5,10],[5,10],[5,11],[5,11],[5,11],[5,11],[5,11],[5,11],[5,11],[5,11],[5,11],[5,11],[5,11],[5,11],[5,11],[5,11],[5,11],[5,11],[7,27],[7,27],[7,27],[7,27],[8,59],[8,59],[8,60],[8,60],[9,1472],[9,1536],[9,1600],[9,1728],[7,18],[7,18],[7,18],[7,18],[7,24],[7,24],[7,24],[7,24],[8,49],[8,49],[8,50],[8,50],[8,51],[8,51],[8,52],[8,52],[7,25],[7,25],[7,25],[7,25],[8,55],[8,55],[8,56],[8,56],[8,57],[8,57],[8,58],[8,58],[6,192],[6,192],[6,192],[6,192],[6,192],[6,192],[6,192],[6,192],[6,1664],[6,1664],[6,1664],[6,1664],[6,1664],[6,1664],[6,1664],[6,1664],[8,448],[8,448],[8,512],[8,512],[9,704],[9,768],[8,640],[8,640],[8,576],[8,576],[9,832],[9,896],[9,960],[9,1024],[9,1088],[9,1152],[9,1216],[9,1280],[9,1344],[9,1408],[7,256],[7,256],[7,256],[7,256],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[5,128],[5,128],[5,128],[5,128],[5,128],[5,128],[5,128],[5,128],[5,128],[5,128],[5,128],[5,128],[5,128],[5,128],[5,128],[5,128],[5,8],[5,8],[5,8],[5,8],[5,8],[5,8],[5,8],[5,8],[5,8],[5,8],[5,8],[5,8],[5,8],[5,8],[5,8],[5,8],[5,9],[5,9],[5,9],[5,9],[5,9],[5,9],[5,9],[5,9],[5,9],[5,9],[5,9],[5,9],[5,9],[5,9],[5,9],[5,9],[6,16],[6,16],[6,16],[6,16],[6,16],[6,16],[6,16],[6,16],[6,17],[6,17],[6,17],[6,17],[6,17],[6,17],[6,17],[6,17],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[6,14],[6,14],[6,14],[6,14],[6,14],[6,14],[6,14],[6,14],[6,15],[6,15],[6,15],[6,15],[6,15],[6,15],[6,15],[6,15],[5,64],[5,64],[5,64],[5,64],[5,64],[5,64],[5,64],[5,64],[5,64],[5,64],[5,64],[5,64],[5,64],[5,64],[5,64],[5,64],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7]],ok=[[-1,-1],[-1,-1],[12,Y7],[12,Y7],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[11,1792],[11,1792],[11,1792],[11,1792],[12,1984],[12,1984],[12,2048],[12,2048],[12,2112],[12,2112],[12,2176],[12,2176],[12,2240],[12,2240],[12,2304],[12,2304],[11,1856],[11,1856],[11,1856],[11,1856],[11,1920],[11,1920],[11,1920],[11,1920],[12,2368],[12,2368],[12,2432],[12,2432],[12,2496],[12,2496],[12,2560],[12,2560],[10,18],[10,18],[10,18],[10,18],[10,18],[10,18],[10,18],[10,18],[12,52],[12,52],[13,640],[13,704],[13,768],[13,832],[12,55],[12,55],[12,56],[12,56],[13,1280],[13,1344],[13,1408],[13,1472],[12,59],[12,59],[12,60],[12,60],[13,1536],[13,1600],[11,24],[11,24],[11,24],[11,24],[11,25],[11,25],[11,25],[11,25],[13,1664],[13,1728],[12,320],[12,320],[12,384],[12,384],[12,448],[12,448],[13,512],[13,576],[12,53],[12,53],[12,54],[12,54],[13,896],[13,960],[13,1024],[13,1088],[13,1152],[13,1216],[10,64],[10,64],[10,64],[10,64],[10,64],[10,64],[10,64],[10,64]],lk=[[8,13],[8,13],[8,13],[8,13],[8,13],[8,13],[8,13],[8,13],[8,13],[8,13],[8,13],[8,13],[8,13],[8,13],[8,13],[8,13],[11,23],[11,23],[12,50],[12,51],[12,44],[12,45],[12,46],[12,47],[12,57],[12,58],[12,61],[12,256],[10,16],[10,16],[10,16],[10,16],[10,17],[10,17],[10,17],[10,17],[12,48],[12,49],[12,62],[12,63],[12,30],[12,31],[12,32],[12,33],[12,40],[12,41],[11,22],[11,22],[8,14],[8,14],[8,14],[8,14],[8,14],[8,14],[8,14],[8,14],[8,14],[8,14],[8,14],[8,14],[8,14],[8,14],[8,14],[8,14],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[9,15],[9,15],[9,15],[9,15],[9,15],[9,15],[9,15],[9,15],[12,128],[12,192],[12,26],[12,27],[12,28],[12,29],[11,19],[11,19],[11,20],[11,20],[12,34],[12,35],[12,36],[12,37],[12,38],[12,39],[11,21],[11,21],[12,42],[12,43],[10,0],[10,0],[10,0],[10,0],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12]],ck=[[-1,-1],[-1,-1],[-1,-1],[-1,-1],[6,9],[6,8],[5,7],[5,7],[4,6],[4,6],[4,6],[4,6],[4,5],[4,5],[4,5],[4,5],[3,1],[3,1],[3,1],[3,1],[3,1],[3,1],[3,1],[3,1],[3,4],[3,4],[3,4],[3,4],[3,4],[3,4],[3,4],[3,4],[2,3],[2,3],[2,3],[2,3],[2,3],[2,3],[2,3],[2,3],[2,3],[2,3],[2,3],[2,3],[2,3],[2,3],[2,3],[2,3],[2,2],[2,2],[2,2],[2,2],[2,2],[2,2],[2,2],[2,2],[2,2],[2,2],[2,2],[2,2],[2,2],[2,2],[2,2],[2,2]];class zR{constructor(e,t={}){if(typeof(e==null?void 0:e.next)!="function")throw new Error('CCITTFaxDecoder - invalid "source" parameter.');this.source=e,this.eof=!1,this.encoding=t.K||0,this.eoline=t.EndOfLine||!1,this.byteAlign=t.EncodedByteAlign||!1,this.columns=t.Columns||1728,this.rows=t.Rows||0,this.eoblock=t.EndOfBlock??!0,this.black=t.BlackIs1||!1,this.codingLine=new Uint32Array(this.columns+1),this.refLine=new Uint32Array(this.columns+2),this.codingLine[0]=this.columns,this.codingPos=0,this.row=0,this.nextLine2D=this.encoding<0,this.inputBits=0,this.inputBuf=0,this.outputBits=0,this.rowsDone=!1;let i;for(;(i=this._lookBits(12))===0;)this._eatBits(1);i===1&&this._eatBits(12),this.encoding>0&&(this.nextLine2D=!this._lookBits(1),this._eatBits(1))}readNextChar(){if(this.eof)return-1;const e=this.refLine,t=this.codingLine,i=this.columns;let s,r,a,o;if(this.outputBits===0){if(this.rowsDone&&(this.eof=!0),this.eof)return-1;this.err=!1;let c,h,u;if(this.nextLine2D){for(o=0;t[o]<i;++o)e[o]=t[o];for(e[o++]=i,e[o]=i,t[0]=0,this.codingPos=0,s=0,r=0;t[this.codingPos]<i;)switch(c=this._getTwoDimCode(),c){case wc:this._addPixels(e[s+1],r),e[s+1]<i&&(s+=2);break;case tr:if(c=h=0,r){do c+=u=this._getBlackCode();while(u>=64);do h+=u=this._getWhiteCode();while(u>=64)}else{do c+=u=this._getWhiteCode();while(u>=64);do h+=u=this._getBlackCode();while(u>=64)}for(this._addPixels(t[this.codingPos]+c,r),t[this.codingPos]<i&&this._addPixels(t[this.codingPos]+h,r^1);e[s]<=t[this.codingPos]&&e[s]<i;)s+=2;break;case UR:if(this._addPixels(e[s]+3,r),r^=1,t[this.codingPos]<i)for(++s;e[s]<=t[this.codingPos]&&e[s]<i;)s+=2;break;case J7:if(this._addPixels(e[s]+2,r),r^=1,t[this.codingPos]<i)for(++s;e[s]<=t[this.codingPos]&&e[s]<i;)s+=2;break;case nr:if(this._addPixels(e[s]+1,r),r^=1,t[this.codingPos]<i)for(++s;e[s]<=t[this.codingPos]&&e[s]<i;)s+=2;break;case zt:if(this._addPixels(e[s],r),r^=1,t[this.codingPos]<i)for(++s;e[s]<=t[this.codingPos]&&e[s]<i;)s+=2;break;case HR:if(this._addPixelsNeg(e[s]-3,r),r^=1,t[this.codingPos]<i)for(s>0?--s:++s;e[s]<=t[this.codingPos]&&e[s]<i;)s+=2;break;case Z7:if(this._addPixelsNeg(e[s]-2,r),r^=1,t[this.codingPos]<i)for(s>0?--s:++s;e[s]<=t[this.codingPos]&&e[s]<i;)s+=2;break;case ir:if(this._addPixelsNeg(e[s]-1,r),r^=1,t[this.codingPos]<i)for(s>0?--s:++s;e[s]<=t[this.codingPos]&&e[s]<i;)s+=2;break;case gc:this._addPixels(i,0),this.eof=!0;break;default:gn("bad 2d code"),this._addPixels(i,0),this.err=!0}}else for(t[0]=0,this.codingPos=0,r=0;t[this.codingPos]<i;){if(c=0,r)do c+=u=this._getBlackCode();while(u>=64);else do c+=u=this._getWhiteCode();while(u>=64);this._addPixels(t[this.codingPos]+c,r),r^=1}let d=!1;if(this.byteAlign&&(this.inputBits&=-8),!this.eoblock&&this.row===this.rows-1)this.rowsDone=!0;else{if(c=this._lookBits(12),this.eoline)for(;c!==gc&&c!==1;)this._eatBits(1),c=this._lookBits(12);else for(;c===0;)this._eatBits(1),c=this._lookBits(12);c===1?(this._eatBits(12),d=!0):c===gc&&(this.eof=!0)}if(!this.eof&&this.encoding>0&&!this.rowsDone&&(this.nextLine2D=!this._lookBits(1),this._eatBits(1)),this.eoblock&&d&&this.byteAlign){if(c=this._lookBits(12),c===1){if(this._eatBits(12),this.encoding>0&&(this._lookBits(1),this._eatBits(1)),this.encoding>=0)for(o=0;o<4;++o)c=this._lookBits(12),c!==1&&gn("bad rtc code: "+c),this._eatBits(12),this.encoding>0&&(this._lookBits(1),this._eatBits(1));this.eof=!0}}else if(this.err&&this.eoline){for(;;){if(c=this._lookBits(13),c===gc)return this.eof=!0,-1;if(c>>1===1)break;this._eatBits(1)}this._eatBits(12),this.encoding>0&&(this._eatBits(1),this.nextLine2D=!(c&1))}this.outputBits=t[0]>0?t[this.codingPos=0]:t[this.codingPos=1],this.row++}let l;if(this.outputBits>=8)l=this.codingPos&1?0:255,this.outputBits-=8,this.outputBits===0&&t[this.codingPos]<i&&(this.codingPos++,this.outputBits=t[this.codingPos]-t[this.codingPos-1]);else{a=8,l=0;do{if(typeof this.outputBits!="number")throw new Te('Invalid /CCITTFaxDecode data, "outputBits" must be a number.');this.outputBits>a?(l<<=a,this.codingPos&1||(l|=255>>8-a),this.outputBits-=a,a=0):(l<<=this.outputBits,this.codingPos&1||(l|=255>>8-this.outputBits),a-=this.outputBits,this.outputBits=0,t[this.codingPos]<i?(this.codingPos++,this.outputBits=t[this.codingPos]-t[this.codingPos-1]):a>0&&(l<<=a,a=0))}while(a)}return this.black&&(l^=255),l}_addPixels(e,t){const i=this.codingLine;let s=this.codingPos;e>i[s]&&(e>this.columns&&(gn("row is wrong length"),this.err=!0,e=this.columns),s&1^t&&++s,i[s]=e),this.codingPos=s}_addPixelsNeg(e,t){const i=this.codingLine;let s=this.codingPos;if(e>i[s])e>this.columns&&(gn("row is wrong length"),this.err=!0,e=this.columns),s&1^t&&++s,i[s]=e;else if(e<i[s]){for(e<0&&(gn("invalid code"),this.err=!0,e=0);s>0&&e<i[s-1];)--s;i[s]=e}this.codingPos=s}_findTableCode(e,t,i,s){const r=s||0;for(let a=e;a<=t;++a){let o=this._lookBits(a);if(o===gc)return[!0,1,!1];if(a<t&&(o<<=t-a),!r||o>=r){const l=i[o-r];if(l[0]===a)return this._eatBits(a),[!0,l[1],!0]}}return[!1,0,!1]}_getTwoDimCode(){let e=0,t;if(this.eoblock){if(e=this._lookBits(7),t=sk[e],(t==null?void 0:t[0])>0)return this._eatBits(t[0]),t[1]}else{const i=this._findTableCode(1,7,sk);if(i[0]&&i[2])return i[1]}return gn("Bad two dim code"),gc}_getWhiteCode(){let e=0,t;if(this.eoblock){if(e=this._lookBits(12),e===gc)return 1;if(t=e>>5?ak[e>>3]:rk[e],t[0]>0)return this._eatBits(t[0]),t[1]}else{let i=this._findTableCode(1,9,ak);if(i[0]||(i=this._findTableCode(11,12,rk),i[0]))return i[1]}return gn("bad white code"),this._eatBits(1),1}_getBlackCode(){let e,t;if(this.eoblock){if(e=this._lookBits(13),e===gc)return 1;if(e>>7?!(e>>9)&&e>>7?t=lk[(e>>1)-64]:t=ck[e>>7]:t=ok[e],t[0]>0)return this._eatBits(t[0]),t[1]}else{let i=this._findTableCode(2,6,ck);if(i[0]||(i=this._findTableCode(7,12,lk,64),i[0])||(i=this._findTableCode(10,13,ok),i[0]))return i[1]}return gn("bad black code"),this._eatBits(1),1}_lookBits(e){let t;for(;this.inputBits<e;){if((t=this.source.next())===-1)return this.inputBits===0?gc:this.inputBuf<<e-this.inputBits&65535>>16-e;this.inputBuf=this.inputBuf<<8|t,this.inputBits+=8}return this.inputBuf>>this.inputBits-e&65535>>16-e}_eatBits(e){(this.inputBits-=e)<0&&(this.inputBits=0)}}class DH extends na{constructor(e,t,i){super(t),this.str=e,this.dict=e.dict,i instanceof ue||(i=ue.empty);const s={next(){return e.getByte()}};this.ccittFaxDecoder=new zR(s,{K:i.get("K"),EndOfLine:i.get("EndOfLine"),EncodedByteAlign:i.get("EncodedByteAlign"),Columns:i.get("Columns"),Rows:i.get("Rows"),EndOfBlock:i.get("EndOfBlock"),BlackIs1:i.get("BlackIs1")})}readBlock(){for(;!this.eof;){const e=this.ccittFaxDecoder.readNextChar();if(e===-1){this.eof=!0;return}this.ensureBuffer(this.bufferLength+1),this.buffer[this.bufferLength++]=e}}}const hk=new Int32Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),FH=new Int32Array([3,4,5,6,7,8,9,10,65547,65549,65551,65553,131091,131095,131099,131103,196643,196651,196659,196667,262211,262227,262243,262259,327811,327843,327875,327907,258,258,258]),LH=new Int32Array([1,2,3,4,65541,65543,131081,131085,196625,196633,262177,262193,327745,327777,393345,393409,459009,459137,524801,525057,590849,591361,657409,658433,724993,727041,794625,798721,868353,876545]),BH=[new Int32Array([459008,524368,524304,524568,459024,524400,524336,590016,459016,524384,524320,589984,524288,524416,524352,590048,459012,524376,524312,589968,459028,524408,524344,590032,459020,524392,524328,59e4,524296,524424,524360,590064,459010,524372,524308,524572,459026,524404,524340,590024,459018,524388,524324,589992,524292,524420,524356,590056,459014,524380,524316,589976,459030,524412,524348,590040,459022,524396,524332,590008,524300,524428,524364,590072,459009,524370,524306,524570,459025,524402,524338,590020,459017,524386,524322,589988,524290,524418,524354,590052,459013,524378,524314,589972,459029,524410,524346,590036,459021,524394,524330,590004,524298,524426,524362,590068,459011,524374,524310,524574,459027,524406,524342,590028,459019,524390,524326,589996,524294,524422,524358,590060,459015,524382,524318,589980,459031,524414,524350,590044,459023,524398,524334,590012,524302,524430,524366,590076,459008,524369,524305,524569,459024,524401,524337,590018,459016,524385,524321,589986,524289,524417,524353,590050,459012,524377,524313,589970,459028,524409,524345,590034,459020,524393,524329,590002,524297,524425,524361,590066,459010,524373,524309,524573,459026,524405,524341,590026,459018,524389,524325,589994,524293,524421,524357,590058,459014,524381,524317,589978,459030,524413,524349,590042,459022,524397,524333,590010,524301,524429,524365,590074,459009,524371,524307,524571,459025,524403,524339,590022,459017,524387,524323,589990,524291,524419,524355,590054,459013,524379,524315,589974,459029,524411,524347,590038,459021,524395,524331,590006,524299,524427,524363,590070,459011,524375,524311,524575,459027,524407,524343,590030,459019,524391,524327,589998,524295,524423,524359,590062,459015,524383,524319,589982,459031,524415,524351,590046,459023,524399,524335,590014,524303,524431,524367,590078,459008,524368,524304,524568,459024,524400,524336,590017,459016,524384,524320,589985,524288,524416,524352,590049,459012,524376,524312,589969,459028,524408,524344,590033,459020,524392,524328,590001,524296,524424,524360,590065,459010,524372,524308,524572,459026,524404,524340,590025,459018,524388,524324,589993,524292,524420,524356,590057,459014,524380,524316,589977,459030,524412,524348,590041,459022,524396,524332,590009,524300,524428,524364,590073,459009,524370,524306,524570,459025,524402,524338,590021,459017,524386,524322,589989,524290,524418,524354,590053,459013,524378,524314,589973,459029,524410,524346,590037,459021,524394,524330,590005,524298,524426,524362,590069,459011,524374,524310,524574,459027,524406,524342,590029,459019,524390,524326,589997,524294,524422,524358,590061,459015,524382,524318,589981,459031,524414,524350,590045,459023,524398,524334,590013,524302,524430,524366,590077,459008,524369,524305,524569,459024,524401,524337,590019,459016,524385,524321,589987,524289,524417,524353,590051,459012,524377,524313,589971,459028,524409,524345,590035,459020,524393,524329,590003,524297,524425,524361,590067,459010,524373,524309,524573,459026,524405,524341,590027,459018,524389,524325,589995,524293,524421,524357,590059,459014,524381,524317,589979,459030,524413,524349,590043,459022,524397,524333,590011,524301,524429,524365,590075,459009,524371,524307,524571,459025,524403,524339,590023,459017,524387,524323,589991,524291,524419,524355,590055,459013,524379,524315,589975,459029,524411,524347,590039,459021,524395,524331,590007,524299,524427,524363,590071,459011,524375,524311,524575,459027,524407,524343,590031,459019,524391,524327,589999,524295,524423,524359,590063,459015,524383,524319,589983,459031,524415,524351,590047,459023,524399,524335,590015,524303,524431,524367,590079]),9],UH=[new Int32Array([327680,327696,327688,327704,327684,327700,327692,327708,327682,327698,327690,327706,327686,327702,327694,0,327681,327697,327689,327705,327685,327701,327693,327709,327683,327699,327691,327707,327687,327703,327695,0]),5];var Ih,Df;class uk extends na{constructor(t,i){super(i);U(this,Ih);this.str=t,this.dict=t.dict;const s=t.getByte(),r=t.getByte();if(s===-1||r===-1)throw new Te(`Invalid header in flate stream: ${s}, ${r}`);if((s&15)!==8)throw new Te(`Unknown compression method in flate stream: ${s}, ${r}`);if(((s<<8)+r)%31!==0)throw new Te(`Bad FCHECK in flate stream: ${s}, ${r}`);if(r&32)throw new Te(`FDICT bit set in flate stream: ${s}, ${r}`);this.codeSize=0,this.codeBuf=0}async getImageData(t,i){const s=await this.asyncGetBytes();return s?s.length<=t?s:s.subarray(0,t):this.getBytes(t)}async asyncGetBytes(){this.str.reset();const t=this.str.getBytes();try{const{readable:i,writable:s}=new DecompressionStream("deflate"),r=s.getWriter();await r.ready,r.write(t).then(async()=>{await r.ready,await r.close()}).catch(()=>{});const a=[];let o=0;for await(const h of i)a.push(h),o+=h.byteLength;const l=new Uint8Array(o);let c=0;for(const h of a)l.set(h,c),c+=h.byteLength;return l}catch{return this.str=new ji(t,2,t.length,this.str.dict),this.reset(),null}}get isAsync(){return!0}getBits(t){const i=this.str;let s=this.codeSize,r=this.codeBuf,a;for(;s<t;){if((a=i.getByte())===-1)throw new Te("Bad encoding in flate stream");r|=a<<s,s+=8}return a=r&(1<<t)-1,this.codeBuf=r>>t,this.codeSize=s-=t,a}getCode(t){const i=this.str,s=t[0],r=t[1];let a=this.codeSize,o=this.codeBuf,l;for(;a<r&&(l=i.getByte())!==-1;)o|=l<<a,a+=8;const c=s[o&(1<<r)-1],h=c>>16,u=c&65535;if(h<1||a<h)throw new Te("Bad encoding in flate stream");return this.codeBuf=o>>h,this.codeSize=a-h,u}generateHuffmanTable(t){const i=t.length;let s=0,r;for(r=0;r<i;++r)t[r]>s&&(s=t[r]);const a=1<<s,o=new Int32Array(a);for(let l=1,c=0,h=2;l<=s;++l,c<<=1,h<<=1)for(let u=0;u<i;++u)if(t[u]===l){let d=0,f=c;for(r=0;r<l;++r)d=d<<1|f&1,f>>=1;for(r=d;r<a;r+=h)o[r]=l<<16|u;++c}return[o,s]}readBlock(){let t,i,s;const r=this.str;try{i=this.getBits(3)}catch(h){F(this,Ih,Df).call(this,h.message);return}if(i&1&&(this.eof=!0),i>>=1,i===0){let h;if((h=r.getByte())===-1){F(this,Ih,Df).call(this,"Bad block header in flate stream");return}let u=h;if((h=r.getByte())===-1){F(this,Ih,Df).call(this,"Bad block header in flate stream");return}if(u|=h<<8,(h=r.getByte())===-1){F(this,Ih,Df).call(this,"Bad block header in flate stream");return}let d=h;if((h=r.getByte())===-1){F(this,Ih,Df).call(this,"Bad block header in flate stream");return}if(d|=h<<8,d!==(~u&65535)&&(u!==0||d!==0))throw new Te("Bad uncompressed block length in flate stream");this.codeBuf=0,this.codeSize=0;const f=this.bufferLength,g=f+u;if(t=this.ensureBuffer(g),this.bufferLength=g,u===0)r.peekByte()===-1&&(this.eof=!0);else{const m=r.getBytes(u);t.set(m,f),m.length<u&&(this.eof=!0)}return}let a,o;if(i===1)a=BH,o=UH;else if(i===2){const h=this.getBits(5)+257,u=this.getBits(5)+1,d=this.getBits(4)+4,f=new Uint8Array(hk.length);let g;for(g=0;g<d;++g)f[hk[g]]=this.getBits(3);const m=this.generateHuffmanTable(f);s=0,g=0;const b=h+u,p=new Uint8Array(b);let y,w,_;for(;g<b;){const v=this.getCode(m);if(v===16)y=2,w=3,_=s;else if(v===17)y=3,w=3,_=s=0;else if(v===18)y=7,w=11,_=s=0;else{p[g++]=s=v;continue}let C=this.getBits(y)+w;for(;C-- >0;)p[g++]=_}a=this.generateHuffmanTable(p.subarray(0,h)),o=this.generateHuffmanTable(p.subarray(h,b))}else throw new Te("Unknown block type in flate stream");t=this.buffer;let l=t?t.length:0,c=this.bufferLength;for(;;){let h=this.getCode(a);if(h<256){c+1>=l&&(t=this.ensureBuffer(c+1),l=t.length),t[c++]=h;continue}if(h===256){this.bufferLength=c;return}h-=257,h=FH[h];let u=h>>16;u>0&&(u=this.getBits(u)),s=(h&65535)+u,h=this.getCode(o),h=LH[h],u=h>>16,u>0&&(u=this.getBits(u));const d=(h&65535)+u;c+s>=l&&(t=this.ensureBuffer(c+s),l=t.length);for(let f=0;f<s;++f,++c)t[c]=t[c-d]}}}Ih=new WeakSet,Df=function(t){gn(t),this.eof=!0};const HH=[{qe:22017,nmps:1,nlps:1,switchFlag:1},{qe:13313,nmps:2,nlps:6,switchFlag:0},{qe:6145,nmps:3,nlps:9,switchFlag:0},{qe:2753,nmps:4,nlps:12,switchFlag:0},{qe:1313,nmps:5,nlps:29,switchFlag:0},{qe:545,nmps:38,nlps:33,switchFlag:0},{qe:22017,nmps:7,nlps:6,switchFlag:1},{qe:21505,nmps:8,nlps:14,switchFlag:0},{qe:18433,nmps:9,nlps:14,switchFlag:0},{qe:14337,nmps:10,nlps:14,switchFlag:0},{qe:12289,nmps:11,nlps:17,switchFlag:0},{qe:9217,nmps:12,nlps:18,switchFlag:0},{qe:7169,nmps:13,nlps:20,switchFlag:0},{qe:5633,nmps:29,nlps:21,switchFlag:0},{qe:22017,nmps:15,nlps:14,switchFlag:1},{qe:21505,nmps:16,nlps:14,switchFlag:0},{qe:20737,nmps:17,nlps:15,switchFlag:0},{qe:18433,nmps:18,nlps:16,switchFlag:0},{qe:14337,nmps:19,nlps:17,switchFlag:0},{qe:13313,nmps:20,nlps:18,switchFlag:0},{qe:12289,nmps:21,nlps:19,switchFlag:0},{qe:10241,nmps:22,nlps:19,switchFlag:0},{qe:9217,nmps:23,nlps:20,switchFlag:0},{qe:8705,nmps:24,nlps:21,switchFlag:0},{qe:7169,nmps:25,nlps:22,switchFlag:0},{qe:6145,nmps:26,nlps:23,switchFlag:0},{qe:5633,nmps:27,nlps:24,switchFlag:0},{qe:5121,nmps:28,nlps:25,switchFlag:0},{qe:4609,nmps:29,nlps:26,switchFlag:0},{qe:4353,nmps:30,nlps:27,switchFlag:0},{qe:2753,nmps:31,nlps:28,switchFlag:0},{qe:2497,nmps:32,nlps:29,switchFlag:0},{qe:2209,nmps:33,nlps:30,switchFlag:0},{qe:1313,nmps:34,nlps:31,switchFlag:0},{qe:1089,nmps:35,nlps:32,switchFlag:0},{qe:673,nmps:36,nlps:33,switchFlag:0},{qe:545,nmps:37,nlps:34,switchFlag:0},{qe:321,nmps:38,nlps:35,switchFlag:0},{qe:273,nmps:39,nlps:36,switchFlag:0},{qe:133,nmps:40,nlps:37,switchFlag:0},{qe:73,nmps:41,nlps:38,switchFlag:0},{qe:37,nmps:42,nlps:39,switchFlag:0},{qe:21,nmps:43,nlps:40,switchFlag:0},{qe:9,nmps:44,nlps:41,switchFlag:0},{qe:5,nmps:45,nlps:42,switchFlag:0},{qe:1,nmps:45,nlps:43,switchFlag:0},{qe:22017,nmps:46,nlps:46,switchFlag:0}];class zH{constructor(e,t,i){this.data=e,this.bp=t,this.dataEnd=i,this.chigh=e[t],this.clow=0,this.byteIn(),this.chigh=this.chigh<<7&65535|this.clow>>9&127,this.clow=this.clow<<7&65535,this.ct-=7,this.a=32768}byteIn(){const e=this.data;let t=this.bp;e[t]===255?e[t+1]>143?(this.clow+=65280,this.ct=8):(t++,this.clow+=e[t]<<9,this.ct=7,this.bp=t):(t++,this.clow+=t<this.dataEnd?e[t]<<8:65280,this.ct=8,this.bp=t),this.clow>65535&&(this.chigh+=this.clow>>16,this.clow&=65535)}readBit(e,t){let i=e[t]>>1,s=e[t]&1;const r=HH[i],a=r.qe;let o,l=this.a-a;if(this.chigh<a)l<a?(l=a,o=s,i=r.nmps):(l=a,o=1^s,r.switchFlag===1&&(s=o),i=r.nlps);else{if(this.chigh-=a,l&32768)return this.a=l,s;l<a?(o=1^s,r.switchFlag===1&&(s=o),i=r.nlps):(o=s,i=r.nmps)}do this.ct===0&&this.byteIn(),l<<=1,this.chigh=this.chigh<<1&65535|this.clow>>15&1,this.clow=this.clow<<1&65535,this.ct--;while(!(l&32768));return this.a=l,e[t]=i<<1|s,o}}class Bi extends sa{constructor(e){super(e,"Jbig2Error")}}class jH{getContexts(e){return e in this?this[e]:this[e]=new Int8Array(65536)}}class Pm{constructor(e,t,i){this.data=e,this.start=t,this.end=i}get decoder(){const e=new zH(this.data,this.start,this.end);return We(this,"decoder",e)}get contextCache(){const e=new jH;return We(this,"contextCache",e)}}function Er(n,e,t){const i=n.getContexts(e);let s=1;function r(c){let h=0;for(let u=0;u<c;u++){const d=t.readBit(i,s);s=s<256?s<<1|d:(s<<1|d)&511|256,h=h<<1|d}return h>>>0}const a=r(1),o=r(1)?r(1)?r(1)?r(1)?r(1)?r(32)+4436:r(12)+340:r(8)+84:r(6)+20:r(4)+4:r(2);let l;return a===0?l=o:o>0&&(l=-o),l>=DU&&l<=M7?l:null}function jR(n,e,t){const i=n.getContexts("IAID");let s=1;for(let r=0;r<t;r++){const a=e.readBit(i,s);s=s<<1|a}return t<31?s&(1<<t)-1:s&2147483647}const dk=["SymbolDictionary",null,null,null,"IntermediateTextRegion",null,"ImmediateTextRegion","ImmediateLosslessTextRegion",null,null,null,null,null,null,null,null,"PatternDictionary",null,null,null,"IntermediateHalftoneRegion",null,"ImmediateHalftoneRegion","ImmediateLosslessHalftoneRegion",null,null,null,null,null,null,null,null,null,null,null,null,"IntermediateGenericRegion",null,"ImmediateGenericRegion","ImmediateLosslessGenericRegion","IntermediateGenericRefinementRegion",null,"ImmediateGenericRefinementRegion","ImmediateLosslessGenericRefinementRegion",null,null,null,null,"PageInformation","EndOfPage","EndOfStripe","EndOfFile","Profiles","Tables",null,null,null,null,null,null,null,null,"Extension"],GH=[[{x:-1,y:-2},{x:0,y:-2},{x:1,y:-2},{x:-2,y:-1},{x:-1,y:-1},{x:0,y:-1},{x:1,y:-1},{x:2,y:-1},{x:-4,y:0},{x:-3,y:0},{x:-2,y:0},{x:-1,y:0}],[{x:-1,y:-2},{x:0,y:-2},{x:1,y:-2},{x:2,y:-2},{x:-2,y:-1},{x:-1,y:-1},{x:0,y:-1},{x:1,y:-1},{x:2,y:-1},{x:-3,y:0},{x:-2,y:0},{x:-1,y:0}],[{x:-1,y:-2},{x:0,y:-2},{x:1,y:-2},{x:-2,y:-1},{x:-1,y:-1},{x:0,y:-1},{x:1,y:-1},{x:-2,y:0},{x:-1,y:0}],[{x:-3,y:-1},{x:-2,y:-1},{x:-1,y:-1},{x:0,y:-1},{x:1,y:-1},{x:-4,y:0},{x:-3,y:0},{x:-2,y:0},{x:-1,y:0}]],fk=[{coding:[{x:0,y:-1},{x:1,y:-1},{x:-1,y:0}],reference:[{x:0,y:-1},{x:1,y:-1},{x:-1,y:0},{x:0,y:0},{x:1,y:0},{x:-1,y:1},{x:0,y:1},{x:1,y:1}]},{coding:[{x:-1,y:-1},{x:0,y:-1},{x:1,y:-1},{x:-1,y:0}],reference:[{x:0,y:-1},{x:-1,y:0},{x:0,y:0},{x:1,y:0},{x:0,y:1},{x:1,y:1}]}],VH=[39717,1941,229,405];function qH(n,e,t){const i=t.decoder,s=t.contextCache.getContexts("GB"),r=[];let a,o,l,c,h,u,d;const f=31735;for(o=0;o<e;o++)for(h=r[o]=new Uint8Array(n),u=o<1?h:r[o-1],d=o<2?h:r[o-2],a=d[0]<<13|d[1]<<12|d[2]<<11|u[0]<<7|u[1]<<6|u[2]<<5|u[3]<<4,l=0;l<n;l++)h[l]=c=i.readBit(s,a),a=(a&f)<<1|(l+3<n?d[l+3]<<11:0)|(l+4<n?u[l+4]<<4:0)|c;return r}function cy(n,e,t,i,s,r,a,o){if(n){const se=new Kp(o.data,o.start,o.end);return T4(se,e,t,!1)}if(i===0&&!r&&!s&&a.length===4&&a[0].x===3&&a[0].y===-1&&a[1].x===-3&&a[1].y===-1&&a[2].x===2&&a[2].y===-2&&a[3].x===-2&&a[3].y===-2)return qH(e,t,o);const l=GH[i].concat(a);l.sort((se,fe)=>se.y-fe.y||se.x-fe.x);const c=l.length,h=new Int8Array(c),u=new Int8Array(c),d=[];let f=0,g=0,m=0,b=0,p,y;for(y=0;y<c;y++)h[y]=l[y].x,u[y]=l[y].y,g=Math.min(g,l[y].x),m=Math.max(m,l[y].x),b=Math.min(b,l[y].y),y<c-1&&l[y].y===l[y+1].y&&l[y].x===l[y+1].x-1?f|=1<<c-1-y:d.push(y);const w=d.length,_=new Int8Array(w),v=new Int8Array(w),C=new Uint16Array(w);for(p=0;p<w;p++)y=d[p],_[p]=l[y].x,v[p]=l[y].y,C[p]=1<<c-1-y;const k=-g,I=-b,E=e-m,T=VH[i];let M=new Uint8Array(e);const D=[],H=o.decoder,R=o.contextCache.getContexts("GB");let z=0,P,B,Z,G=0,Y,J;for(let se=0;se<t;se++){if(s){const fe=H.readBit(R,T);if(z^=fe,z){D.push(M);continue}}for(M=new Uint8Array(M),D.push(M),P=0;P<e;P++){if(P>=k&&P<E&&se>=I)for(G=G<<1&f,y=0;y<w;y++)B=se+v[y],Z=P+_[y],Y=D[B][Z],Y&&(Y=C[y],G|=Y);else for(G=0,J=c-1,y=0;y<c;y++,J--)Z=P+h[y],Z>=0&&Z<e&&(B=se+u[y],B>=0&&(Y=D[B][Z],Y&&(G|=Y<<J)));const fe=H.readBit(R,G);M[P]=fe}}return D}function GR(n,e,t,i,s,r,a,o,l){let c=fk[t].coding;t===0&&(c=c.concat([o[0]]));const h=c.length,u=new Int32Array(h),d=new Int32Array(h);let f;for(f=0;f<h;f++)u[f]=c[f].x,d[f]=c[f].y;let g=fk[t].reference;t===0&&(g=g.concat([o[1]]));const m=g.length,b=new Int32Array(m),p=new Int32Array(m);for(f=0;f<m;f++)b[f]=g[f].x,p[f]=g[f].y;const y=i[0].length,w=i.length,_=[],v=l.decoder,C=l.contextCache.getContexts("GR");for(let k=0;k<e;k++){const I=new Uint8Array(n);_.push(I);for(let E=0;E<n;E++){let T,M,D=0;for(f=0;f<h;f++)T=k+d[f],M=E+u[f],T<0||M<0||M>=n?D<<=1:D=D<<1|_[T][M];for(f=0;f<m;f++)T=k+p[f]-r,M=E+b[f]-s,T<0||T>=w||M<0||M>=y?D<<=1:D=D<<1|i[T][M];const H=v.readBit(C,D);I[E]=H}}return _}function WH(n,e,t,i,s,r,a,o,l,c,h,u){if(n&&e)throw new Bi("symbol refinement with Huffman is not supported");const d=[];let f=0,g=S4(t.length+i);const m=h.decoder,b=h.contextCache;let p,y;for(n&&(p=Lh(1),y=[],g=Math.max(g,1));d.length<i;){const E=n?r.tableDeltaHeight.decode(u):Er(b,"IADH",m);f+=E;let T=0,M=0;const D=n?y.length:0;for(;;){const H=n?r.tableDeltaWidth.decode(u):Er(b,"IADW",m);if(H===null)break;T+=H,M+=T;let R;if(e){const z=Er(b,"IAAI",m);if(z>1)R=VR(n,e,T,f,0,z,1,t.concat(d),g,0,0,1,0,r,l,c,h,0,u);else{const P=jR(b,m,g),B=Er(b,"IARDX",m),Z=Er(b,"IARDY",m),G=P<t.length?t[P]:d[P-t.length];R=GR(T,f,l,G,B,Z,!1,c,h)}d.push(R)}else n?y.push(T):(R=cy(!1,T,f,a,!1,null,o,h),d.push(R))}if(n&&!e){const H=r.tableBitmapSize.decode(u);u.byteAlign();let R;if(H===0)R=sz(u,M,f);else{const P=u.end,B=u.position+H;u.end=B,R=T4(u,M,f,!1),u.end=P,u.position=B}const z=y.length;if(D===z-1)d.push(R);else{let P,B,Z=0,G,Y,J;for(P=D;P<z;P++){for(Y=y[P],G=Z+Y,J=[],B=0;B<f;B++)J.push(R[B].subarray(Z,G));d.push(J),Z=G}}}}const w=[],_=[];let v=!1,C,k;const I=t.length+i;for(;_.length<I;){let E=n?p.decode(u):Er(b,"IAEX",m);for(;E--;)_.push(v);v=!v}for(C=0,k=t.length;C<k;C++)_[C]&&w.push(t[C]);for(let E=0;E<i;C++,E++)_[C]&&w.push(d[E]);return w}function VR(n,e,t,i,s,r,a,o,l,c,h,u,d,f,g,m,b,p,y){if(n&&e)throw new Bi("refinement with Huffman is not supported");const w=[];let _,v;for(_=0;_<i;_++)v=new Uint8Array(t),s&&v.fill(s),w.push(v);const C=b.decoder,k=b.contextCache;let I=n?-f.tableDeltaT.decode(y):-Er(k,"IADT",C),E=0;for(_=0;_<r;){const T=n?f.tableDeltaT.decode(y):Er(k,"IADT",C);I+=T;const M=n?f.tableFirstS.decode(y):Er(k,"IAFS",C);E+=M;let D=E;do{let H=0;a>1&&(H=n?y.readBits(p):Er(k,"IAIT",C));const R=a*I+H,z=n?f.symbolIDTable.decode(y):jR(k,C,l),P=e&&(n?y.readBit():Er(k,"IARI",C));let B=o[z],Z=B[0].length,G=B.length;if(P){const N=Er(k,"IARDW",C),K=Er(k,"IARDH",C),oe=Er(k,"IARDX",C),W=Er(k,"IARDY",C);Z+=N,G+=K,B=GR(Z,G,g,B,(N>>1)+oe,(K>>1)+W,!1,m,b)}let Y=0;c?u&1?Y=G-1:D+=G-1:u>1?D+=Z-1:Y=Z-1;const J=R-(u&1?0:G-1),se=D-(u&2?Z-1:0);let fe,he,de;if(c)for(fe=0;fe<G;fe++){if(v=w[se+fe],!v)continue;de=B[fe];const N=Math.min(t-J,Z);switch(d){case 0:for(he=0;he<N;he++)v[J+he]|=de[he];break;case 2:for(he=0;he<N;he++)v[J+he]^=de[he];break;default:throw new Bi(`operator ${d} is not supported`)}}else for(he=0;he<G;he++)if(v=w[J+he],!!v)switch(de=B[he],d){case 0:for(fe=0;fe<Z;fe++)v[se+fe]|=de[fe];break;case 2:for(fe=0;fe<Z;fe++)v[se+fe]^=de[fe];break;default:throw new Bi(`operator ${d} is not supported`)}_++;const ge=n?f.tableDeltaS.decode(y):Er(k,"IADS",C);if(ge===null)break;D+=Y+ge+h}while(!0)}return w}function KH(n,e,t,i,s,r){const a=[];n||(a.push({x:-e,y:0}),s===0&&a.push({x:-3,y:-1},{x:2,y:-2},{x:-2,y:-2}));const o=(i+1)*e,l=cy(n,o,t,s,!1,null,a,r),c=[];for(let h=0;h<=i;h++){const u=[],d=e*h,f=d+e;for(let g=0;g<t;g++)u.push(l[g].subarray(d,f));c.push(u)}return c}function XH(n,e,t,i,s,r,a,o,l,c,h,u,d,f,g){if(a)throw new Bi("skip is not supported");if(o!==0)throw new Bi(`operator "${o}" is not supported in halftone region`);const b=[];let p,y,w;for(p=0;p<s;p++)w=new Uint8Array(i),r&&w.fill(r),b.push(w);const _=e.length,v=e[0],C=v[0].length,k=v.length,I=S4(_),E=[];n||(E.push({x:t<=1?3:2,y:-1}),t===0&&E.push({x:-3,y:-1},{x:2,y:-2},{x:-2,y:-2}));const T=[];let M,D;for(n&&(M=new Kp(g.data,g.start,g.end)),p=I-1;p>=0;p--)n?D=T4(M,l,c,!0):D=cy(!1,l,c,t,!1,null,E,g),T[p]=D;let H,R,z,P,B,Z,G,Y,J;for(H=0;H<c;H++)for(R=0;R<l;R++){for(z=0,P=0,y=I-1;y>=0;y--)z^=T[y][H][R],P|=z<<y;if(B=e[P],Z=h+H*f+R*d>>8,G=u+H*d-R*f>>8,Z>=0&&Z+C<=i&&G>=0&&G+k<=s)for(p=0;p<k;p++)for(J=b[G+p],Y=B[p],y=0;y<C;y++)J[Z+y]|=Y[y];else{let se,fe;for(p=0;p<k;p++)if(fe=G+p,!(fe<0||fe>=s))for(J=b[fe],Y=B[p],y=0;y<C;y++)se=Z+y,se>=0&&se<i&&(J[se]|=Y[y])}}return b}function YH(n,e){const t={};t.number=Jn(n,e);const i=n[e+4],s=i&63;if(!dk[s])throw new Bi("invalid segment type: "+s);t.type=s,t.typeName=dk[s],t.deferredNonRetain=!!(i&128);const r=!!(i&64),a=n[e+5];let o=a>>5&7;const l=[a&31];let c=e+6;if(a===7){o=Jn(n,c-1)&536870911,c+=3;let g=o+7>>3;for(l[0]=n[c++];--g>0;)l.push(n[c++])}else if(a===5||a===6)throw new Bi("invalid referred-to flags");t.retainBits=l;let h=4;t.number<=256?h=1:t.number<=65536&&(h=2);const u=[];let d,f;for(d=0;d<o;d++){let g;h===1?g=n[c]:h===2?g=wn(n,c):g=Jn(n,c),u.push(g),c+=h}if(t.referredTo=u,r?(t.pageAssociation=Jn(n,c),c+=4):t.pageAssociation=n[c++],t.length=Jn(n,c),c+=4,t.length===4294967295)if(s===38){const g=l3(n,c),b=!!(n[c+c3]&1),p=6,y=new Uint8Array(p);for(b||(y[0]=255,y[1]=172),y[2]=g.height>>>24&255,y[3]=g.height>>16&255,y[4]=g.height>>8&255,y[5]=g.height&255,d=c,f=n.length;d<f;d++){let w=0;for(;w<p&&y[w]===n[d+w];)w++;if(w===p){t.length=d+p;break}}if(t.length===4294967295)throw new Bi("segment end was not found")}else throw new Bi("invalid unknown segment length");return t.headerEnd=c,t}function JH(n,e,t,i){const s=[];let r=t;for(;r<i;){const a=YH(e,r);r=a.headerEnd;const o={header:a,data:e};if(n.randomAccess||(o.start=r,r+=a.length,o.end=r),s.push(o),a.type===51)break}if(n.randomAccess)for(let a=0,o=s.length;a<o;a++)s[a].start=r,r+=s[a].header.length,s[a].end=r;return s}function l3(n,e){return{width:Jn(n,e),height:Jn(n,e+4),x:Jn(n,e+8),y:Jn(n,e+12),combinationOperator:n[e+16]&7}}const c3=17;function ZH(n,e){const t=n.header,i=n.data,s=n.end;let r=n.start,a,o,l,c;switch(t.type){case 0:const u={},d=wn(i,r);if(u.huffman=!!(d&1),u.refinement=!!(d&2),u.huffmanDHSelector=d>>2&3,u.huffmanDWSelector=d>>4&3,u.bitmapSizeSelector=d>>6&1,u.aggregationInstancesSelector=d>>7&1,u.bitmapCodingContextUsed=!!(d&256),u.bitmapCodingContextRetained=!!(d&512),u.template=d>>10&3,u.refinementTemplate=d>>12&1,r+=2,!u.huffman){for(c=u.template===0?4:1,o=[],l=0;l<c;l++)o.push({x:Il(i,r),y:Il(i,r+1)}),r+=2;u.at=o}if(u.refinement&&!u.refinementTemplate){for(o=[],l=0;l<2;l++)o.push({x:Il(i,r),y:Il(i,r+1)}),r+=2;u.refinementAt=o}u.numberOfExportedSymbols=Jn(i,r),r+=4,u.numberOfNewSymbols=Jn(i,r),r+=4,a=[u,t.number,t.referredTo,i,r,s];break;case 6:case 7:const f={};f.info=l3(i,r),r+=c3;const g=wn(i,r);if(r+=2,f.huffman=!!(g&1),f.refinement=!!(g&2),f.logStripSize=g>>2&3,f.stripSize=1<<f.logStripSize,f.referenceCorner=g>>4&3,f.transposed=!!(g&64),f.combinationOperator=g>>7&3,f.defaultPixelValue=g>>9&1,f.dsOffset=g<<17>>27,f.refinementTemplate=g>>15&1,f.huffman){const k=wn(i,r);r+=2,f.huffmanFS=k&3,f.huffmanDS=k>>2&3,f.huffmanDT=k>>4&3,f.huffmanRefinementDW=k>>6&3,f.huffmanRefinementDH=k>>8&3,f.huffmanRefinementDX=k>>10&3,f.huffmanRefinementDY=k>>12&3,f.huffmanRefinementSizeSelector=!!(k&16384)}if(f.refinement&&!f.refinementTemplate){for(o=[],l=0;l<2;l++)o.push({x:Il(i,r),y:Il(i,r+1)}),r+=2;f.refinementAt=o}f.numberOfSymbolInstances=Jn(i,r),r+=4,a=[f,t.referredTo,i,r,s];break;case 16:const m={},b=i[r++];m.mmr=!!(b&1),m.template=b>>1&3,m.patternWidth=i[r++],m.patternHeight=i[r++],m.maxPatternIndex=Jn(i,r),r+=4,a=[m,t.number,i,r,s];break;case 22:case 23:const p={};p.info=l3(i,r),r+=c3;const y=i[r++];p.mmr=!!(y&1),p.template=y>>1&3,p.enableSkip=!!(y&8),p.combinationOperator=y>>4&7,p.defaultPixelValue=y>>7&1,p.gridWidth=Jn(i,r),r+=4,p.gridHeight=Jn(i,r),r+=4,p.gridOffsetX=Jn(i,r)&4294967295,r+=4,p.gridOffsetY=Jn(i,r)&4294967295,r+=4,p.gridVectorX=wn(i,r),r+=2,p.gridVectorY=wn(i,r),r+=2,a=[p,t.referredTo,i,r,s];break;case 38:case 39:const w={};w.info=l3(i,r),r+=c3;const _=i[r++];if(w.mmr=!!(_&1),w.template=_>>1&3,w.prediction=!!(_&8),!w.mmr){for(c=w.template===0?4:1,o=[],l=0;l<c;l++)o.push({x:Il(i,r),y:Il(i,r+1)}),r+=2;w.at=o}a=[w,i,r,s];break;case 48:const v={width:Jn(i,r),height:Jn(i,r+4),resolutionX:Jn(i,r+8),resolutionY:Jn(i,r+12)};v.height===4294967295&&delete v.height;const C=i[r+16];wn(i,r+17),v.lossless=!!(C&1),v.refinement=!!(C&2),v.defaultPixelValue=C>>2&1,v.combinationOperator=C>>3&3,v.requiresBuffer=!!(C&32),v.combinationOperatorOverride=!!(C&64),a=[v];break;case 49:break;case 50:break;case 51:break;case 53:a=[t.number,i,r,s];break;case 62:break;default:throw new Bi(`segment type ${t.typeName}(${t.type}) is not implemented`)}const h="on"+t.typeName;h in e&&e[h].apply(e,a)}function QH(n,e){for(let t=0,i=n.length;t<i;t++)ZH(n[t],e)}function $H(n){const e=new ez;for(let t=0,i=n.length;t<i;t++){const s=n[t],r=JH({},s.data,s.start,s.end);QH(r,e)}return e.buffer}class ez{onPageInformation(e){this.currentPageInfo=e;const t=e.width+7>>3,i=new Uint8ClampedArray(t*e.height);e.defaultPixelValue&&i.fill(255),this.buffer=i}drawBitmap(e,t){const i=this.currentPageInfo,s=e.width,r=e.height,a=i.width+7>>3,o=i.combinationOperatorOverride?e.combinationOperator:i.combinationOperator,l=this.buffer,c=128>>(e.x&7);let h=e.y*a+(e.x>>3),u,d,f,g;switch(o){case 0:for(u=0;u<r;u++){for(f=c,g=h,d=0;d<s;d++)t[u][d]&&(l[g]|=f),f>>=1,f||(f=128,g++);h+=a}break;case 2:for(u=0;u<r;u++){for(f=c,g=h,d=0;d<s;d++)t[u][d]&&(l[g]^=f),f>>=1,f||(f=128,g++);h+=a}break;default:throw new Bi(`operator ${o} is not supported`)}}onImmediateGenericRegion(e,t,i,s){const r=e.info,a=new Pm(t,i,s),o=cy(e.mmr,r.width,r.height,e.template,e.prediction,null,e.at,a);this.drawBitmap(r,o)}onImmediateLosslessGenericRegion(){this.onImmediateGenericRegion(...arguments)}onSymbolDictionary(e,t,i,s,r,a){let o,l;e.huffman&&(o=iz(e,i,this.customTables),l=new Kp(s,r,a));let c=this.symbols;c||(this.symbols=c={});const h=[];for(const d of i){const f=c[d];f&&h.push(...f)}const u=new Pm(s,r,a);c[t]=WH(e.huffman,e.refinement,h,e.numberOfNewSymbols,e.numberOfExportedSymbols,o,e.template,e.at,e.refinementTemplate,e.refinementAt,u,l)}onImmediateTextRegion(e,t,i,s,r){const a=e.info;let o,l;const c=this.symbols,h=[];for(const g of t){const m=c[g];m&&h.push(...m)}const u=S4(h.length);e.huffman&&(l=new Kp(i,s,r),o=nz(e,t,this.customTables,h.length,l));const d=new Pm(i,s,r),f=VR(e.huffman,e.refinement,a.width,a.height,e.defaultPixelValue,e.numberOfSymbolInstances,e.stripSize,h,u,e.transposed,e.dsOffset,e.referenceCorner,e.combinationOperator,o,e.refinementTemplate,e.refinementAt,d,e.logStripSize,l);this.drawBitmap(a,f)}onImmediateLosslessTextRegion(){this.onImmediateTextRegion(...arguments)}onPatternDictionary(e,t,i,s,r){let a=this.patterns;a||(this.patterns=a={});const o=new Pm(i,s,r);a[t]=KH(e.mmr,e.patternWidth,e.patternHeight,e.maxPatternIndex,e.template,o)}onImmediateHalftoneRegion(e,t,i,s,r){const a=this.patterns[t[0]],o=e.info,l=new Pm(i,s,r),c=XH(e.mmr,a,e.template,o.width,o.height,e.defaultPixelValue,e.enableSkip,e.combinationOperator,e.gridWidth,e.gridHeight,e.gridOffsetX,e.gridOffsetY,e.gridVectorX,e.gridVectorY,l);this.drawBitmap(o,c)}onImmediateLosslessHalftoneRegion(){this.onImmediateHalftoneRegion(...arguments)}onTables(e,t,i,s){let r=this.customTables;r||(this.customTables=r={}),r[e]=tz(t,i,s)}}class Fh{constructor(e){e.length===2?(this.isOOB=!0,this.rangeLow=0,this.prefixLength=e[0],this.rangeLength=0,this.prefixCode=e[1],this.isLowerRange=!1):(this.isOOB=!1,this.rangeLow=e[0],this.prefixLength=e[1],this.rangeLength=e[2],this.prefixCode=e[3],this.isLowerRange=e[4]==="lower")}}class F3{constructor(e){this.children=[],e?(this.isLeaf=!0,this.rangeLength=e.rangeLength,this.rangeLow=e.rangeLow,this.isLowerRange=e.isLowerRange,this.isOOB=e.isOOB):this.isLeaf=!1}buildTree(e,t){const i=e.prefixCode>>t&1;if(t<=0)this.children[i]=new F3(e);else{let s=this.children[i];s||(this.children[i]=s=new F3(null)),s.buildTree(e,t-1)}}decodeNode(e){if(this.isLeaf){if(this.isOOB)return null;const i=e.readBits(this.rangeLength);return this.rangeLow+(this.isLowerRange?-i:i)}const t=this.children[e.readBit()];if(!t)throw new Bi("invalid Huffman data");return t.decodeNode(e)}}class L3{constructor(e,t){t||this.assignPrefixCodes(e),this.rootNode=new F3(null);for(let i=0,s=e.length;i<s;i++){const r=e[i];r.prefixLength>0&&this.rootNode.buildTree(r,r.prefixLength-1)}}decode(e){return this.rootNode.decodeNode(e)}assignPrefixCodes(e){const t=e.length;let i=0;for(let h=0;h<t;h++)i=Math.max(i,e[h].prefixLength);const s=new Uint32Array(i+1);for(let h=0;h<t;h++)s[e[h].prefixLength]++;let r=1,a=0,o,l,c;for(s[0]=0;r<=i;){for(a=a+s[r-1]<<1,o=a,l=0;l<t;)c=e[l],c.prefixLength===r&&(c.prefixCode=o,o++),l++;r++}}}function tz(n,e,t){const i=n[e],s=Jn(n,e+1)&4294967295,r=Jn(n,e+5)&4294967295,a=new Kp(n,e+9,t),o=(i>>1&7)+1,l=(i>>4&7)+1,c=[];let h,u,d=s;do h=a.readBits(o),u=a.readBits(l),c.push(new Fh([d,h,u,0])),d+=1<<u;while(d<r);return h=a.readBits(o),c.push(new Fh([s-1,h,32,0,"lower"])),h=a.readBits(o),c.push(new Fh([r,h,32,0])),i&1&&(h=a.readBits(o),c.push(new Fh([h,0]))),new L3(c,!1)}const gk={};function Lh(n){let e=gk[n];if(e)return e;let t;switch(n){case 1:t=[[0,1,4,0],[16,2,8,2],[272,3,16,6],[65808,3,32,7]];break;case 2:t=[[0,1,0,0],[1,2,0,2],[2,3,0,6],[3,4,3,14],[11,5,6,30],[75,6,32,62],[6,63]];break;case 3:t=[[-256,8,8,254],[0,1,0,0],[1,2,0,2],[2,3,0,6],[3,4,3,14],[11,5,6,30],[-257,8,32,255,"lower"],[75,7,32,126],[6,62]];break;case 4:t=[[1,1,0,0],[2,2,0,2],[3,3,0,6],[4,4,3,14],[12,5,6,30],[76,5,32,31]];break;case 5:t=[[-255,7,8,126],[1,1,0,0],[2,2,0,2],[3,3,0,6],[4,4,3,14],[12,5,6,30],[-256,7,32,127,"lower"],[76,6,32,62]];break;case 6:t=[[-2048,5,10,28],[-1024,4,9,8],[-512,4,8,9],[-256,4,7,10],[-128,5,6,29],[-64,5,5,30],[-32,4,5,11],[0,2,7,0],[128,3,7,2],[256,3,8,3],[512,4,9,12],[1024,4,10,13],[-2049,6,32,62,"lower"],[2048,6,32,63]];break;case 7:t=[[-1024,4,9,8],[-512,3,8,0],[-256,4,7,9],[-128,5,6,26],[-64,5,5,27],[-32,4,5,10],[0,4,5,11],[32,5,5,28],[64,5,6,29],[128,4,7,12],[256,3,8,1],[512,3,9,2],[1024,3,10,3],[-1025,5,32,30,"lower"],[2048,5,32,31]];break;case 8:t=[[-15,8,3,252],[-7,9,1,508],[-5,8,1,253],[-3,9,0,509],[-2,7,0,124],[-1,4,0,10],[0,2,1,0],[2,5,0,26],[3,6,0,58],[4,3,4,4],[20,6,1,59],[22,4,4,11],[38,4,5,12],[70,5,6,27],[134,5,7,28],[262,6,7,60],[390,7,8,125],[646,6,10,61],[-16,9,32,510,"lower"],[1670,9,32,511],[2,1]];break;case 9:t=[[-31,8,4,252],[-15,9,2,508],[-11,8,2,253],[-7,9,1,509],[-5,7,1,124],[-3,4,1,10],[-1,3,1,2],[1,3,1,3],[3,5,1,26],[5,6,1,58],[7,3,5,4],[39,6,2,59],[43,4,5,11],[75,4,6,12],[139,5,7,27],[267,5,8,28],[523,6,8,60],[779,7,9,125],[1291,6,11,61],[-32,9,32,510,"lower"],[3339,9,32,511],[2,0]];break;case 10:t=[[-21,7,4,122],[-5,8,0,252],[-4,7,0,123],[-3,5,0,24],[-2,2,2,0],[2,5,0,25],[3,6,0,54],[4,7,0,124],[5,8,0,253],[6,2,6,1],[70,5,5,26],[102,6,5,55],[134,6,6,56],[198,6,7,57],[326,6,8,58],[582,6,9,59],[1094,6,10,60],[2118,7,11,125],[-22,8,32,254,"lower"],[4166,8,32,255],[2,2]];break;case 11:t=[[1,1,0,0],[2,2,1,2],[4,4,0,12],[5,4,1,13],[7,5,1,28],[9,5,2,29],[13,6,2,60],[17,7,2,122],[21,7,3,123],[29,7,4,124],[45,7,5,125],[77,7,6,126],[141,7,32,127]];break;case 12:t=[[1,1,0,0],[2,2,0,2],[3,3,1,6],[5,5,0,28],[6,5,1,29],[8,6,1,60],[10,7,0,122],[11,7,1,123],[13,7,2,124],[17,7,3,125],[25,7,4,126],[41,8,5,254],[73,8,32,255]];break;case 13:t=[[1,1,0,0],[2,3,0,4],[3,4,0,12],[4,5,0,28],[5,4,1,13],[7,3,3,5],[15,6,1,58],[17,6,2,59],[21,6,3,60],[29,6,4,61],[45,6,5,62],[77,7,6,126],[141,7,32,127]];break;case 14:t=[[-2,3,0,4],[-1,3,0,5],[0,1,0,0],[1,3,0,6],[2,3,0,7]];break;case 15:t=[[-24,7,4,124],[-8,6,2,60],[-4,5,1,28],[-2,4,0,12],[-1,3,0,4],[0,1,0,0],[1,3,0,5],[2,4,0,13],[3,5,1,29],[5,6,2,61],[9,7,4,125],[-25,7,32,126,"lower"],[25,7,32,127]];break;default:throw new Bi(`standard table B.${n} does not exist`)}for(let i=0,s=t.length;i<s;i++)t[i]=new Fh(t[i]);return e=new L3(t,!0),gk[n]=e,e}class Kp{constructor(e,t,i){this.data=e,this.start=t,this.end=i,this.position=t,this.shift=-1,this.currentByte=0}readBit(){if(this.shift<0){if(this.position>=this.end)throw new Bi("end of data while reading bit");this.currentByte=this.data[this.position++],this.shift=7}const e=this.currentByte>>this.shift&1;return this.shift--,e}readBits(e){let t=0,i;for(i=e-1;i>=0;i--)t|=this.readBit()<<i;return t}byteAlign(){this.shift=-1}next(){return this.position>=this.end?-1:this.data[this.position++]}}function Iu(n,e,t){let i=0;for(let s=0,r=e.length;s<r;s++){const a=t[e[s]];if(a){if(n===i)return a;i++}}throw new Bi("can't find custom Huffman table")}function nz(n,e,t,i,s){const r=[];for(let d=0;d<=34;d++){const f=s.readBits(4);r.push(new Fh([d,f,0,0]))}const a=new L3(r,!1);r.length=0;for(let d=0;d<i;){const f=a.decode(s);if(f>=32){let g,m,b;switch(f){case 32:if(d===0)throw new Bi("no previous value in symbol ID table");m=s.readBits(2)+3,g=r[d-1].prefixLength;break;case 33:m=s.readBits(3)+3,g=0;break;case 34:m=s.readBits(7)+11,g=0;break;default:throw new Bi("invalid code length in symbol ID table")}for(b=0;b<m;b++)r.push(new Fh([d,g,0,0])),d++}else r.push(new Fh([d,f,0,0])),d++}s.byteAlign();const o=new L3(r,!1);let l=0,c,h,u;switch(n.huffmanFS){case 0:case 1:c=Lh(n.huffmanFS+6);break;case 3:c=Iu(l,e,t),l++;break;default:throw new Bi("invalid Huffman FS selector")}switch(n.huffmanDS){case 0:case 1:case 2:h=Lh(n.huffmanDS+8);break;case 3:h=Iu(l,e,t),l++;break;default:throw new Bi("invalid Huffman DS selector")}switch(n.huffmanDT){case 0:case 1:case 2:u=Lh(n.huffmanDT+11);break;case 3:u=Iu(l,e,t),l++;break;default:throw new Bi("invalid Huffman DT selector")}if(n.refinement)throw new Bi("refinement with Huffman is not supported");return{symbolIDTable:o,tableFirstS:c,tableDeltaS:h,tableDeltaT:u}}function iz(n,e,t){let i=0,s,r;switch(n.huffmanDHSelector){case 0:case 1:s=Lh(n.huffmanDHSelector+4);break;case 3:s=Iu(i,e,t),i++;break;default:throw new Bi("invalid Huffman DH selector")}switch(n.huffmanDWSelector){case 0:case 1:r=Lh(n.huffmanDWSelector+2);break;case 3:r=Iu(i,e,t),i++;break;default:throw new Bi("invalid Huffman DW selector")}let a,o;return n.bitmapSizeSelector?(a=Iu(i,e,t),i++):a=Lh(1),n.aggregationInstancesSelector?o=Iu(i,e,t):o=Lh(1),{tableDeltaHeight:s,tableDeltaWidth:r,tableBitmapSize:a,tableAggregateInstances:o}}function sz(n,e,t){const i=[];for(let s=0;s<t;s++){const r=new Uint8Array(e);i.push(r);for(let a=0;a<e;a++)r[a]=n.readBit();n.byteAlign()}return i}function T4(n,e,t,i){const s={K:-1,Columns:e,Rows:t,BlackIs1:!0,EndOfBlock:i},r=new zR(n,s),a=[];let o,l=!1;for(let c=0;c<t;c++){const h=new Uint8Array(e);a.push(h);let u=-1;for(let d=0;d<e;d++)u<0&&(o=r.readNextChar(),o===-1&&(o=0,l=!0),u=7),h[d]=o>>u&1,u--}if(i&&!l)for(let h=0;h<5&&r.readNextChar()!==-1;h++);return a}class rz{parseChunks(e){return $H(e)}parse(e){throw new Error("Not implemented: Jbig2Image.parse")}}class az extends na{constructor(e,t,i){super(t),this.stream=e,this.dict=e.dict,this.maybeLength=t,this.params=i}get bytes(){return We(this,"bytes",this.stream.getBytes(this.maybeLength))}ensureBuffer(e){}readBlock(){this.decodeImage()}decodeImage(e){if(this.eof)return this.buffer;e||(e=this.bytes);const t=new rz,i=[];if(this.params instanceof ue){const a=this.params.get("JBIG2Globals");if(a instanceof dn){const o=a.getBytes();i.push({data:o,start:0,end:o.length})}}i.push({data:e,start:0,end:e.length});const s=t.parseChunks(i),r=s.length;for(let a=0;a<r;a++)s[a]^=255;return this.buffer=s,this.bufferLength=r,this.eof=!0,this.buffer}get canAsyncDecodeImageFromBuffer(){return this.stream.isAsync}}class oz extends na{constructor(e,t,i){super(t),this.stream=e,this.dict=e.dict,this.maybeLength=t,this.params=i}get bytes(){return We(this,"bytes",this.stream.getBytes(this.maybeLength))}ensureBuffer(e){}readBlock(e){Cn("JpxStream.readBlock")}get isAsyncDecoder(){return!0}async decodeImage(e,t){return this.eof?this.buffer:(e||(e=this.bytes),this.buffer=await Yo.decode(e,t),this.bufferLength=this.buffer.length,this.eof=!0,this.buffer)}get canAsyncDecodeImageFromBuffer(){return this.stream.isAsync}}class mk extends na{constructor(e,t,i){super(t),this.str=e,this.dict=e.dict,this.cachedData=0,this.bitsCached=0;const s=4096,r={earlyChange:i,codeLength:9,nextCode:258,dictionaryValues:new Uint8Array(s),dictionaryLengths:new Uint16Array(s),dictionaryPrevCodes:new Uint16Array(s),currentSequence:new Uint8Array(s),currentSequenceLength:0};for(let a=0;a<256;++a)r.dictionaryValues[a]=a,r.dictionaryLengths[a]=1;this.lzwState=r}readBits(e){let t=this.bitsCached,i=this.cachedData;for(;t<e;){const s=this.str.getByte();if(s===-1)return this.eof=!0,null;i=i<<8|s,t+=8}return this.bitsCached=t-=e,this.cachedData=i,this.lastCode=null,i>>>t&(1<<e)-1}readBlock(){let i=1024,s,r,a;const o=this.lzwState;if(!o)return;const l=o.earlyChange;let c=o.nextCode;const h=o.dictionaryValues,u=o.dictionaryLengths,d=o.dictionaryPrevCodes;let f=o.codeLength,g=o.prevCode;const m=o.currentSequence;let b=o.currentSequenceLength,p=0,y=this.bufferLength,w=this.ensureBuffer(this.bufferLength+i);for(s=0;s<512;s++){const _=this.readBits(f),v=b>0;if(_<256)m[0]=_,b=1;else if(_>=258)if(_<c)for(b=u[_],r=b-1,a=_;r>=0;r--)m[r]=h[a],a=d[a];else m[b++]=m[0];else if(_===256){f=9,c=258,b=0;continue}else{this.eof=!0,delete this.lzwState;break}if(v&&(d[c]=g,u[c]=u[g]+1,h[c]=m[0],c++,f=c+l&c+l-1?f:Math.min(Math.log(c+l)/.6931471805599453+1,12)|0),g=_,p+=b,i<p){do i+=512;while(i<p);w=this.ensureBuffer(this.bufferLength+i)}for(r=0;r<b;r++)w[y++]=m[r]}o.nextCode=c,o.codeLength=f,o.prevCode=g,o.currentSequenceLength=b,this.bufferLength=y}}class pk extends na{constructor(e,t,i){if(super(t),!(i instanceof ue))return e;const s=this.predictor=i.get("Predictor")||1;if(s<=1)return e;if(s!==2&&(s<10||s>15))throw new Te(`Unsupported predictor: ${s}`);this.readBlock=s===2?this.readBlockTiff:this.readBlockPng,this.str=e,this.dict=e.dict;const r=this.colors=i.get("Colors")||1,a=this.bits=i.get("BPC","BitsPerComponent")||8,o=this.columns=i.get("Columns")||1;return this.pixBytes=r*a+7>>3,this.rowBytes=o*r*a+7>>3,this}readBlockTiff(){const e=this.rowBytes,t=this.bufferLength,i=this.ensureBuffer(t+e),s=this.bits,r=this.colors,a=this.str.getBytes(e);if(this.eof=!a.length,this.eof)return;let o=0,l=0,c=0,h=0,u=t,d;if(s===1&&r===1)for(d=0;d<e;++d){let f=a[d]^o;f^=f>>1,f^=f>>2,f^=f>>4,o=(f&1)<<7,i[u++]=f}else if(s===8){for(d=0;d<r;++d)i[u++]=a[d];for(;d<e;++d)i[u]=i[u-r]+a[d],u++}else if(s===16){const f=r*2;for(d=0;d<f;++d)i[u++]=a[d];for(;d<e;d+=2){const g=((a[d]&255)<<8)+(a[d+1]&255)+((i[u-f]&255)<<8)+(i[u-f+1]&255);i[u++]=g>>8&255,i[u++]=g&255}}else{const f=new Uint8Array(r+1),g=(1<<s)-1;let m=0,b=t;const p=this.columns;for(d=0;d<p;++d)for(let y=0;y<r;++y)c<s&&(o=o<<8|a[m++]&255,c+=8),f[y]=f[y]+(o>>c-s)&g,c-=s,l=l<<s|f[y],h+=s,h>=8&&(i[b++]=l>>h-8&255,h-=8);h>0&&(i[b++]=(l<<8-h)+(o&(1<<8-h)-1))}this.bufferLength+=e}readBlockPng(){const e=this.rowBytes,t=this.pixBytes,i=this.str.getByte(),s=this.str.getBytes(e);if(this.eof=!s.length,this.eof)return;const r=this.bufferLength,a=this.ensureBuffer(r+e);let o=a.subarray(r-e,r);o.length===0&&(o=new Uint8Array(e));let l,c=r,h,u;switch(i){case 0:for(l=0;l<e;++l)a[c++]=s[l];break;case 1:for(l=0;l<t;++l)a[c++]=s[l];for(;l<e;++l)a[c]=a[c-t]+s[l]&255,c++;break;case 2:for(l=0;l<e;++l)a[c++]=o[l]+s[l]&255;break;case 3:for(l=0;l<t;++l)a[c++]=(o[l]>>1)+s[l];for(;l<e;++l)a[c]=(o[l]+a[c-t]>>1)+s[l]&255,c++;break;case 4:for(l=0;l<t;++l)h=o[l],u=s[l],a[c++]=h+u;for(;l<e;++l){h=o[l];const d=o[l-t],f=a[c-t],g=f+h-d;let m=g-f;m<0&&(m=-m);let b=g-h;b<0&&(b=-b);let p=g-d;p<0&&(p=-p),u=s[l],m<=b&&m<=p?a[c++]=f+u:b<=p?a[c++]=h+u:a[c++]=d+u}break;default:throw new Te(`Unsupported predictor: ${i}`)}this.bufferLength+=e}}class lz extends na{constructor(e,t){super(t),this.str=e,this.dict=e.dict}readBlock(){const e=this.str.getBytes(2);if(!e||e.length<2||e[0]===128){this.eof=!0;return}let t,i=this.bufferLength,s=e[0];if(s<128){if(t=this.ensureBuffer(i+s+1),t[i++]=e[1],s>0){const r=this.str.getBytes(s);t.set(r,i),i+=s}}else s=257-s,t=this.ensureBuffer(i+s+1),t.fill(e[1],i,i+s),i+=s;this.bufferLength=i}}const cz=1e3;function hz(n){const e=[],t=n.length;let i=0;for(;i<t-1;)e.push(n[i++]<<8|n[i++]);return i<t&&e.push(n[i]),t+"_"+String.fromCharCode.apply(null,e)}var q5,qR;class F0{constructor({lexer:e,xref:t,allowStreams:i=!1,recoveryMode:s=!1}){U(this,q5);this.lexer=e,this.xref=t,this.allowStreams=i,this.recoveryMode=s,this.imageCache=Object.create(null),this._imageId=0,this.refill()}refill(){this.buf1=this.lexer.getObj(),this.buf2=this.lexer.getObj()}shift(){this.buf2 instanceof ls&&this.buf2.cmd==="ID"?(this.buf1=this.buf2,this.buf2=null):(this.buf1=this.buf2,this.buf2=this.lexer.getObj())}tryShift(){try{return this.shift(),!0}catch(e){if(e instanceof vi)throw e;return!1}}getObj(e=null){const t=this.buf1;if(this.shift(),t instanceof ls)switch(t.cmd){case"BI":return this.makeInlineImage(e);case"[":const i=[];for(;!Ts(this.buf1,"]")&&this.buf1!==Gs;)i.push(this.getObj(e));if(this.buf1===Gs){if(this.recoveryMode)return i;throw new O7("End of file inside array.")}return this.shift(),i;case"<<":const s=new ue(this.xref);for(;!Ts(this.buf1,">>")&&this.buf1!==Gs;){if(!(this.buf1 instanceof ve)){gn("Malformed dictionary: key must be a name object"),this.shift();continue}const r=this.buf1.name;if(this.shift(),this.buf1===Gs)break;s.set(r,this.getObj(e))}if(this.buf1===Gs){if(this.recoveryMode)return s;throw new O7("End of file inside dictionary.")}return Ts(this.buf2,"stream")?this.allowStreams?this.makeStream(s,e):s:(this.shift(),s);default:return t}if(Number.isInteger(t)){if(Number.isInteger(this.buf1)&&Ts(this.buf2,"R")){const i=tt.get(t,this.buf1);return this.shift(),this.shift(),i}return t}return typeof t=="string"&&e?e.decryptString(t):t}findDefaultInlineStreamEnd(e){const{knownCommands:l}=this.lexer,c=e.pos,h=15;let u=0,d,f;for(;(d=e.getByte())!==-1;)if(u===0)u=d===69?1:0;else if(u===1)u=d===73?2:0;else if(d===32||d===10||d===13){f=e.pos;const m=e.peekBytes(h),b=m.length;if(b===0)break;for(let w=0;w<b;w++)if(d=m[w],!(d===0&&m[w+1]!==0)&&d!==10&&d!==13&&(d<32||d>127)){u=0;break}if(u!==2)continue;if(!l){ae("findDefaultInlineStreamEnd - `lexer.knownCommands` is undefined.");continue}const p=new Qo(new ji(e.peekBytes(5*h)),l);p._hexStringWarn=()=>{};let y=0;for(;;){const w=p.getObj();if(w===Gs){u=0;break}if(w instanceof ls){const _=l[w.cmd];if(_){if(_.variableArgs?y<=_.numArgs:y===_.numArgs)break}else{u=0;break}y=0;continue}y++}if(u===2)break}else u=0;d===-1&&(ae("findDefaultInlineStreamEnd: Reached the end of the stream without finding a valid EI marker"),f&&(ae('... trying to recover by using the last "EI" occurrence.'),e.skip(-(e.pos-f))));let g=4;return e.skip(-g),d=e.peekByte(),e.skip(g),Za(d)||g--,e.pos-g-c}findDCTDecodeInlineStreamEnd(e){const t=e.pos;let i=!1,s,r;for(;(s=e.getByte())!==-1;)if(s===255){switch(e.getByte()){case 0:break;case 255:e.skip(-1);break;case 217:i=!0;break;case 192:case 193:case 194:case 195:case 197:case 198:case 199:case 201:case 202:case 203:case 205:case 206:case 207:case 196:case 204:case 218:case 219:case 220:case 221:case 222:case 223:case 224:case 225:case 226:case 227:case 228:case 229:case 230:case 231:case 232:case 233:case 234:case 235:case 236:case 237:case 238:case 239:case 254:r=e.getUint16(),r>2?e.skip(r-2):e.skip(-2);break}if(i)break}const a=e.pos-t;return s===-1?(ae("Inline DCTDecode image stream: EOI marker not found, searching for /EI/ instead."),e.skip(-a),this.findDefaultInlineStreamEnd(e)):(this.inlineStreamSkipEI(e),a)}findASCII85DecodeInlineStreamEnd(e){const s=e.pos;let r;for(;(r=e.getByte())!==-1;)if(r===126){const o=e.pos;for(r=e.peekByte();Za(r);)e.skip(),r=e.peekByte();if(r===62){e.skip();break}if(e.pos>o){const l=e.peekBytes(2);if(l[0]===69&&l[1]===73)break}}const a=e.pos-s;return r===-1?(ae("Inline ASCII85Decode image stream: EOD marker not found, searching for /EI/ instead."),e.skip(-a),this.findDefaultInlineStreamEnd(e)):(this.inlineStreamSkipEI(e),a)}findASCIIHexDecodeInlineStreamEnd(e){const i=e.pos;let s;for(;(s=e.getByte())!==-1&&s!==62;);const r=e.pos-i;return s===-1?(ae("Inline ASCIIHexDecode image stream: EOD marker not found, searching for /EI/ instead."),e.skip(-r),this.findDefaultInlineStreamEnd(e)):(this.inlineStreamSkipEI(e),r)}inlineStreamSkipEI(e){let s=0,r;for(;(r=e.getByte())!==-1;)if(s===0)s=r===69?1:0;else if(s===1)s=r===73?2:0;else if(s===2)break}makeInlineImage(e){const t=this.lexer,i=t.stream,s=Object.create(null);let r;for(;!Ts(this.buf1,"ID")&&this.buf1!==Gs;){if(!(this.buf1 instanceof ve))throw new Te("Dictionary key must be a name object");const f=this.buf1.name;if(this.shift(),this.buf1===Gs)break;s[f]=this.getObj(e)}t.beginInlineImagePos!==-1&&(r=i.pos-t.beginInlineImagePos);const a=this.xref.fetchIfRef(s.F||s.Filter);let o;if(a instanceof ve)o=a.name;else if(Array.isArray(a)){const f=this.xref.fetchIfRef(a[0]);f instanceof ve&&(o=f.name)}const l=i.pos;let c;switch(o){case"DCT":case"DCTDecode":c=this.findDCTDecodeInlineStreamEnd(i);break;case"A85":case"ASCII85Decode":c=this.findASCII85DecodeInlineStreamEnd(i);break;case"AHx":case"ASCIIHexDecode":c=this.findASCIIHexDecodeInlineStreamEnd(i);break;default:c=this.findDefaultInlineStreamEnd(i)}let h;if(c<cz&&r>0){const f=i.pos;i.pos=t.beginInlineImagePos,h=hz(i.getBytes(r+c)),i.pos=f;const g=this.imageCache[h];if(g!==void 0)return this.buf2=ls.get("EI"),this.shift(),g.reset(),g}const u=new ue(this.xref);for(const f in s)u.set(f,s[f]);let d=i.makeSubStream(l,c,u);return e&&(d=e.createStream(d,c)),d=this.filter(d,u,c),d.dict=u,h!==void 0&&(d.cacheKey=`inline_img_${++this._imageId}`,this.imageCache[h]=d),this.buf2=ls.get("EI"),this.shift(),d}makeStream(e,t){const i=this.lexer;let s=i.stream;i.skipToNextLine();const r=s.pos-1;let a=e.get("Length");if(Number.isInteger(a)||(gn(`Bad length "${a&&a.toString()}" in stream.`),a=0),s.pos=r+a,i.nextChar(),this.tryShift()&&Ts(this.buf2,"endstream"))this.shift();else{if(a=F(this,q5,qR).call(this,r),a<0)throw new Te("Missing endstream command.");i.nextChar(),this.shift(),this.shift()}return this.shift(),s=s.makeSubStream(r,a,e),t&&(s=t.createStream(s,a)),s=this.filter(s,e,a),s.dict=e,s}filter(e,t,i){let s=t.get("F","Filter"),r=t.get("DP","DecodeParms");if(s instanceof ve)return Array.isArray(r)&&ae("/DecodeParms should not be an Array, when /Filter is a Name."),this.makeFilter(e,s.name,i,r);let a=i;if(Array.isArray(s)){const o=s,l=r;for(let c=0,h=o.length;c<h;++c){if(s=this.xref.fetchIfRef(o[c]),!(s instanceof ve))throw new Te(`Bad filter name "${s}"`);r=null,Array.isArray(l)&&c in l&&(r=this.xref.fetchIfRef(l[c])),e=this.makeFilter(e,s.name,a,r),a=null}}return e}makeFilter(e,t,i,s){if(i===0)return ae(`Empty "${t}" stream.`),new G7;try{switch(t){case"Fl":case"FlateDecode":return s?new pk(new uk(e,i),i,s):new uk(e,i);case"LZW":case"LZWDecode":let r=1;return s?(s.has("EarlyChange")&&(r=s.get("EarlyChange")),new pk(new mk(e,i,r),i,s)):new mk(e,i,r);case"DCT":case"DCTDecode":return new Og(e,i,s);case"JPX":case"JPXDecode":return new oz(e,i,s);case"A85":case"ASCII85Decode":return new NH(e,i);case"AHx":case"ASCIIHexDecode":return new OH(e,i);case"CCF":case"CCITTFaxDecode":return new DH(e,i,s);case"RL":case"RunLengthDecode":return new lz(e,i);case"JBIG2Decode":return new az(e,i,s)}return ae(`Filter "${t}" is not supported.`),e}catch(r){if(r instanceof vi)throw r;return ae(`Invalid stream: "${r}"`),new G7}}}q5=new WeakSet,qR=function(e){const{stream:t}=this.lexer;t.pos=e;const i=2048,s=9,r=new Uint8Array([101,110,100]),a=r.length,o=[new Uint8Array([115,116,114,101,97,109]),new Uint8Array([115,116,101,97,109]),new Uint8Array([115,116,114,101,97])],l=s-a;for(;t.pos<t.end;){const c=t.peekBytes(i),h=c.length-s;if(h<=0)break;let u=0;for(;u<h;){let d=0;for(;d<a&&c[u+d]===r[d];)d++;if(d>=a){let f=!1;for(const g of o){const m=g.length;let b=0;for(;b<m&&c[u+d+b]===g[b];)b++;if(b>=l){f=!0;break}if(b>=m){const p=c[u+d+b];Za(p)&&(gn(`Found "${xa([...r,...g])}" when searching for endstream command.`),f=!0);break}}if(f)return t.pos+=u,t.pos-e}u++}t.pos+=h}return-1};const wf=[1,0,0,0,0,0,0,0,0,1,1,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,2,0,0,2,2,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,2,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];function Cw(n){return n>=48&&n<=57?n&15:n>=65&&n<=70||n>=97&&n<=102?(n&15)+9:-1}class Qo{constructor(e,t=null){this.stream=e,this.nextChar(),this.strBuf=[],this.knownCommands=t,this._hexStringNumWarn=0,this.beginInlineImagePos=-1}nextChar(){return this.currentChar=this.stream.getByte()}peekChar(){return this.stream.peekByte()}getNumber(){let e=this.currentChar,t=!1,i=0,s=1;if(e===45?(s=-1,e=this.nextChar(),e===45&&(e=this.nextChar())):e===43&&(e=this.nextChar()),e===10||e===13)do e=this.nextChar();while(e===10||e===13);if(e===46&&(i=10,e=this.nextChar()),e<48||e>57){const l=`Invalid number: ${String.fromCharCode(e)} (charCode ${e})`;if(Za(e)||e===40||e===60||e===-1)return gn(`Lexer.getNumber - "${l}".`),0;throw new Te(l)}let r=e-48,a=0,o=1;for(;(e=this.nextChar())>=0;)if(e>=48&&e<=57){const l=e-48;t?a=a*10+l:(i!==0&&(i*=10),r=r*10+l)}else if(e===46)if(i===0)i=1;else break;else if(e===45)ae("Badly formatted number: minus sign in the middle");else if(e===69||e===101){if(e=this.peekChar(),e===43||e===45)o=e===45?-1:1,this.nextChar();else if(e<48||e>57)break;t=!0}else break;return i!==0&&(r/=i),t&&(r*=10**(o*a)),s*r}getString(){let e=1,t=!1;const i=this.strBuf;i.length=0;let s=this.nextChar();for(;;){let r=!1;switch(s|0){case-1:ae("Unterminated string"),t=!0;break;case 40:++e,i.push("(");break;case 41:--e===0?(this.nextChar(),t=!0):i.push(")");break;case 92:switch(s=this.nextChar(),s){case-1:ae("Unterminated string"),t=!0;break;case 110:i.push(`
`);break;case 114:i.push("\r");break;case 116:i.push("	");break;case 98:i.push("\b");break;case 102:i.push("\f");break;case 92:case 40:case 41:i.push(String.fromCharCode(s));break;case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:let a=s&15;s=this.nextChar(),r=!0,s>=48&&s<=55&&(a=(a<<3)+(s&15),s=this.nextChar(),s>=48&&s<=55&&(r=!1,a=(a<<3)+(s&15))),i.push(String.fromCharCode(a));break;case 13:this.peekChar()===10&&this.nextChar();break;case 10:break;default:i.push(String.fromCharCode(s));break}break;default:i.push(String.fromCharCode(s));break}if(t)break;r||(s=this.nextChar())}return i.join("")}getName(){let e,t;const i=this.strBuf;for(i.length=0;(e=this.nextChar())>=0&&!wf[e];)if(e===35){if(e=this.nextChar(),wf[e]){ae("Lexer_getName: NUMBER SIGN (#) should be followed by a hexadecimal number."),i.push("#");break}const s=Cw(e);if(s!==-1){t=e,e=this.nextChar();const r=Cw(e);if(r===-1){if(ae(`Lexer_getName: Illegal digit (${String.fromCharCode(e)}) in hexadecimal number.`),i.push("#",String.fromCharCode(t)),wf[e])break;i.push(String.fromCharCode(e));continue}i.push(String.fromCharCode(s<<4|r))}else i.push("#",String.fromCharCode(e))}else i.push(String.fromCharCode(e));return i.length>127&&ae(`Name token is longer than allowed by the spec: ${i.length}`),ve.get(i.join(""))}_hexStringWarn(e){if(this._hexStringNumWarn++===5){ae("getHexString - ignoring additional invalid characters.");return}this._hexStringNumWarn>5||ae(`getHexString - ignoring invalid character: ${e}`)}getHexString(){const e=this.strBuf;e.length=0;let t=this.currentChar,i=-1,s=-1;for(this._hexStringNumWarn=0;;)if(t<0){ae("Unterminated hex string");break}else if(t===62){this.nextChar();break}else if(wf[t]===1){t=this.nextChar();continue}else s=Cw(t),s===-1?this._hexStringWarn(t):i===-1?i=s:(e.push(String.fromCharCode(i<<4|s)),i=-1),t=this.nextChar();return i!==-1&&e.push(String.fromCharCode(i<<4)),e.join("")}getObj(){let e=!1,t=this.currentChar;for(;;){if(t<0)return Gs;if(e)(t===10||t===13)&&(e=!1);else if(t===37)e=!0;else if(wf[t]!==1)break;t=this.nextChar()}switch(t|0){case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:case 43:case 45:case 46:return this.getNumber();case 40:return this.getString();case 47:return this.getName();case 91:return this.nextChar(),ls.get("[");case 93:return this.nextChar(),ls.get("]");case 60:return t=this.nextChar(),t===60?(this.nextChar(),ls.get("<<")):this.getHexString();case 62:return t=this.nextChar(),t===62?(this.nextChar(),ls.get(">>")):ls.get(">");case 123:return this.nextChar(),ls.get("{");case 125:return this.nextChar(),ls.get("}");case 41:throw this.nextChar(),new Te(`Illegal character: ${t}`)}let i=String.fromCharCode(t);if(t<32||t>127){const a=this.peekChar();if(a>=32&&a<=127)return this.nextChar(),ls.get(i)}const s=this.knownCommands;let r=(s==null?void 0:s[i])!==void 0;for(;(t=this.nextChar())>=0&&!wf[t];){const a=i+String.fromCharCode(t);if(r&&s[a]===void 0)break;if(i.length===128)throw new Te(`Command token too long: ${i.length}`);i=a,r=(s==null?void 0:s[i])!==void 0}return i==="true"?!0:i==="false"?!1:i==="null"?null:(i==="BI"&&(this.beginInlineImagePos=this.stream.pos),ls.get(i))}skipToNextLine(){let e=this.currentChar;for(;e>=0;){if(e===13){e=this.nextChar(),e===10&&this.nextChar();break}else if(e===10){this.nextChar();break}e=this.nextChar()}}}class uz{static create(e){function t(u,d,f=!1){const g=u.get(d);if(Number.isInteger(g)&&(f?g>=0:g>0))return g;throw new Error(`The "${d}" parameter in the linearization dictionary is invalid.`)}function i(u){const d=u.get("H");let f;if(Array.isArray(d)&&((f=d.length)===2||f===4)){for(let g=0;g<f;g++){const m=d[g];if(!(Number.isInteger(m)&&m>0))throw new Error(`Hint (${g}) in the linearization dictionary is invalid.`)}return d}throw new Error("Hint array in the linearization dictionary is invalid.")}const s=new F0({lexer:new Qo(e),xref:null}),r=s.getObj(),a=s.getObj(),o=s.getObj(),l=s.getObj();let c,h;if(Number.isInteger(r)&&Number.isInteger(a)&&Ts(o,"obj")&&l instanceof ue&&typeof(c=l.get("Linearized"))=="number"&&c>0){if((h=t(l,"L"))!==e.length)throw new Error('The "L" parameter in the linearization dictionary does not equal the stream length.')}else return null;return{length:h,hints:i(l),objectNumberFirst:t(l,"O"),endFirst:t(l,"E"),numPages:t(l,"N"),mainXRefEntriesOffset:t(l,"T"),pageFirst:l.has("P")?t(l,"P",!0):0}}}const dz=["Adobe-GB1-UCS2","Adobe-CNS1-UCS2","Adobe-Japan1-UCS2","Adobe-Korea1-UCS2","78-EUC-H","78-EUC-V","78-H","78-RKSJ-H","78-RKSJ-V","78-V","78ms-RKSJ-H","78ms-RKSJ-V","83pv-RKSJ-H","90ms-RKSJ-H","90ms-RKSJ-V","90msp-RKSJ-H","90msp-RKSJ-V","90pv-RKSJ-H","90pv-RKSJ-V","Add-H","Add-RKSJ-H","Add-RKSJ-V","Add-V","Adobe-CNS1-0","Adobe-CNS1-1","Adobe-CNS1-2","Adobe-CNS1-3","Adobe-CNS1-4","Adobe-CNS1-5","Adobe-CNS1-6","Adobe-GB1-0","Adobe-GB1-1","Adobe-GB1-2","Adobe-GB1-3","Adobe-GB1-4","Adobe-GB1-5","Adobe-Japan1-0","Adobe-Japan1-1","Adobe-Japan1-2","Adobe-Japan1-3","Adobe-Japan1-4","Adobe-Japan1-5","Adobe-Japan1-6","Adobe-Korea1-0","Adobe-Korea1-1","Adobe-Korea1-2","B5-H","B5-V","B5pc-H","B5pc-V","CNS-EUC-H","CNS-EUC-V","CNS1-H","CNS1-V","CNS2-H","CNS2-V","ETHK-B5-H","ETHK-B5-V","ETen-B5-H","ETen-B5-V","ETenms-B5-H","ETenms-B5-V","EUC-H","EUC-V","Ext-H","Ext-RKSJ-H","Ext-RKSJ-V","Ext-V","GB-EUC-H","GB-EUC-V","GB-H","GB-V","GBK-EUC-H","GBK-EUC-V","GBK2K-H","GBK2K-V","GBKp-EUC-H","GBKp-EUC-V","GBT-EUC-H","GBT-EUC-V","GBT-H","GBT-V","GBTpc-EUC-H","GBTpc-EUC-V","GBpc-EUC-H","GBpc-EUC-V","H","HKdla-B5-H","HKdla-B5-V","HKdlb-B5-H","HKdlb-B5-V","HKgccs-B5-H","HKgccs-B5-V","HKm314-B5-H","HKm314-B5-V","HKm471-B5-H","HKm471-B5-V","HKscs-B5-H","HKscs-B5-V","Hankaku","Hiragana","KSC-EUC-H","KSC-EUC-V","KSC-H","KSC-Johab-H","KSC-Johab-V","KSC-V","KSCms-UHC-H","KSCms-UHC-HW-H","KSCms-UHC-HW-V","KSCms-UHC-V","KSCpc-EUC-H","KSCpc-EUC-V","Katakana","NWP-H","NWP-V","RKSJ-H","RKSJ-V","Roman","UniCNS-UCS2-H","UniCNS-UCS2-V","UniCNS-UTF16-H","UniCNS-UTF16-V","UniCNS-UTF32-H","UniCNS-UTF32-V","UniCNS-UTF8-H","UniCNS-UTF8-V","UniGB-UCS2-H","UniGB-UCS2-V","UniGB-UTF16-H","UniGB-UTF16-V","UniGB-UTF32-H","UniGB-UTF32-V","UniGB-UTF8-H","UniGB-UTF8-V","UniJIS-UCS2-H","UniJIS-UCS2-HW-H","UniJIS-UCS2-HW-V","UniJIS-UCS2-V","UniJIS-UTF16-H","UniJIS-UTF16-V","UniJIS-UTF32-H","UniJIS-UTF32-V","UniJIS-UTF8-H","UniJIS-UTF8-V","UniJIS2004-UTF16-H","UniJIS2004-UTF16-V","UniJIS2004-UTF32-H","UniJIS2004-UTF32-V","UniJIS2004-UTF8-H","UniJIS2004-UTF8-V","UniJISPro-UCS2-HW-V","UniJISPro-UCS2-V","UniJISPro-UTF8-V","UniJISX0213-UTF32-H","UniJISX0213-UTF32-V","UniJISX02132004-UTF32-H","UniJISX02132004-UTF32-V","UniKS-UCS2-H","UniKS-UCS2-V","UniKS-UTF16-H","UniKS-UTF16-V","UniKS-UTF32-H","UniKS-UTF32-V","UniKS-UTF8-H","UniKS-UTF8-V","V","WP-Symbol"],Aw=2**24-1;class R4{constructor(e=!1){this.codespaceRanges=[[],[],[],[]],this.numCodespaceRanges=0,this._map=[],this.name="",this.vertical=!1,this.useCMap=null,this.builtInCMap=e}addCodespaceRange(e,t,i){this.codespaceRanges[e-1].push(t,i),this.numCodespaceRanges++}mapCidRange(e,t,i){if(t-e>Aw)throw new Error("mapCidRange - ignoring data above MAX_MAP_RANGE.");for(;e<=t;)this._map[e++]=i++}mapBfRange(e,t,i){if(t-e>Aw)throw new Error("mapBfRange - ignoring data above MAX_MAP_RANGE.");const s=i.length-1;for(;e<=t;){this._map[e++]=i;const r=i.charCodeAt(s)+1;if(r>255){i=i.substring(0,s-1)+String.fromCharCode(i.charCodeAt(s-1)+1)+"\0";continue}i=i.substring(0,s)+String.fromCharCode(r)}}mapBfRangeToArray(e,t,i){if(t-e>Aw)throw new Error("mapBfRangeToArray - ignoring data above MAX_MAP_RANGE.");const s=i.length;let r=0;for(;e<=t&&r<s;)this._map[e]=i[r++],++e}mapOne(e,t){this._map[e]=t}lookup(e){return this._map[e]}contains(e){return this._map[e]!==void 0}forEach(e){const t=this._map,i=t.length;if(i<=65536)for(let s=0;s<i;s++)t[s]!==void 0&&e(s,t[s]);else for(const s in t)e(s,t[s])}charCodeOf(e){const t=this._map;if(t.length<=65536)return t.indexOf(e);for(const i in t)if(t[i]===e)return i|0;return-1}getMap(){return this._map}readCharCode(e,t,i){let s=0;const r=this.codespaceRanges;for(let a=0,o=r.length;a<o;a++){s=(s<<8|e.charCodeAt(t+a))>>>0;const l=r[a];for(let c=0,h=l.length;c<h;){const u=l[c++],d=l[c++];if(s>=u&&s<=d){i.charcode=s,i.length=a+1;return}}}i.charcode=0,i.length=1}getCharCodeLength(e){const t=this.codespaceRanges;for(let i=0,s=t.length;i<s;i++){const r=t[i];for(let a=0,o=r.length;a<o;){const l=r[a++],c=r[a++];if(e>=l&&e<=c)return i+1}}return 1}get length(){return this._map.length}get isIdentityCMap(){if(!(this.name==="Identity-H"||this.name==="Identity-V")||this._map.length!==65536)return!1;for(let e=0;e<65536;e++)if(this._map[e]!==e)return!1;return!0}}class c1 extends R4{constructor(e,t){super(),this.vertical=e,this.addCodespaceRange(t,0,65535)}mapCidRange(e,t,i){Cn("should not call mapCidRange")}mapBfRange(e,t,i){Cn("should not call mapBfRange")}mapBfRangeToArray(e,t,i){Cn("should not call mapBfRangeToArray")}mapOne(e,t){Cn("should not call mapCidOne")}lookup(e){return Number.isInteger(e)&&e<=65535?e:void 0}contains(e){return Number.isInteger(e)&&e<=65535}forEach(e){for(let t=0;t<=65535;t++)e(t,t)}charCodeOf(e){return Number.isInteger(e)&&e<=65535?e:-1}getMap(){const e=new Array(65536);for(let t=0;t<=65535;t++)e[t]=t;return e}get length(){return 65536}get isIdentityCMap(){Cn("should not access .isIdentityCMap")}}function Wh(n){let e=0;for(let t=0;t<n.length;t++)e=e<<8|n.charCodeAt(t);return e>>>0}function nf(n){if(typeof n!="string")throw new Te("Malformed CMap: expected string.")}function WR(n){if(!Number.isInteger(n))throw new Te("Malformed CMap: expected int.")}function fz(n,e){for(;;){let t=e.getObj();if(t===Gs)break;if(Ts(t,"endbfchar"))return;nf(t);const i=Wh(t);t=e.getObj(),nf(t);const s=t;n.mapOne(i,s)}}function gz(n,e){for(;;){let t=e.getObj();if(t===Gs)break;if(Ts(t,"endbfrange"))return;nf(t);const i=Wh(t);t=e.getObj(),nf(t);const s=Wh(t);if(t=e.getObj(),Number.isInteger(t)||typeof t=="string"){const r=Number.isInteger(t)?String.fromCharCode(t):t;n.mapBfRange(i,s,r)}else if(Ts(t,"[")){t=e.getObj();const r=[];for(;!Ts(t,"]")&&t!==Gs;)r.push(t),t=e.getObj();n.mapBfRangeToArray(i,s,r)}else break}throw new Te("Invalid bf range.")}function mz(n,e){for(;;){let t=e.getObj();if(t===Gs)break;if(Ts(t,"endcidchar"))return;nf(t);const i=Wh(t);t=e.getObj(),WR(t);const s=t;n.mapOne(i,s)}}function pz(n,e){for(;;){let t=e.getObj();if(t===Gs)break;if(Ts(t,"endcidrange"))return;nf(t);const i=Wh(t);t=e.getObj(),nf(t);const s=Wh(t);t=e.getObj(),WR(t);const r=t;n.mapCidRange(i,s,r)}}function bz(n,e){for(;;){let t=e.getObj();if(t===Gs)break;if(Ts(t,"endcodespacerange"))return;if(typeof t!="string")break;const i=Wh(t);if(t=e.getObj(),typeof t!="string")break;const s=Wh(t);n.addCodespaceRange(t.length,i,s)}throw new Te("Invalid codespace range.")}function xz(n,e){const t=e.getObj();Number.isInteger(t)&&(n.vertical=!!t)}function yz(n,e){const t=e.getObj();t instanceof ve&&(n.name=t.name)}async function KR(n,e,t,i){let s,r;e:for(;;)try{const a=e.getObj();if(a===Gs)break;if(a instanceof ve)a.name==="WMode"?xz(n,e):a.name==="CMapName"&&yz(n,e),s=a;else if(a instanceof ls)switch(a.cmd){case"endcmap":break e;case"usecmap":s instanceof ve&&(r=s.name);break;case"begincodespacerange":bz(n,e);break;case"beginbfchar":fz(n,e);break;case"begincidchar":mz(n,e);break;case"beginbfrange":gz(n,e);break;case"begincidrange":pz(n,e);break}}catch(a){if(a instanceof vi)throw a;ae("Invalid cMap data: "+a);continue}return!i&&r&&(i=r),i?XR(n,t,i):n}async function XR(n,e,t){if(n.useCMap=await Q7(t,e),n.numCodespaceRanges===0){const i=n.useCMap.codespaceRanges;for(let s=0;s<i.length;s++)n.codespaceRanges[s]=i[s].slice();n.numCodespaceRanges=n.useCMap.numCodespaceRanges}return n.useCMap.forEach(function(i,s){n.contains(i)||n.mapOne(i,s)}),n}async function Q7(n,e){if(n==="Identity-H")return new c1(!1,2);if(n==="Identity-V")return new c1(!0,2);if(!dz.includes(n))throw new Error("Unknown CMap name: "+n);if(!e)throw new Error("Built-in CMap parameters are not provided.");const{cMapData:t,isCompressed:i}=await e(n),s=new R4(!0);if(i)return new PH().process(t,s,a=>XR(s,e,a));const r=new Qo(new ji(t));return KR(s,r,e,null)}class e9{static async create({encoding:e,fetchBuiltInCMap:t,useCMap:i}){if(e instanceof ve)return Q7(e.name,t);if(e instanceof dn){const s=await KR(new R4,new Qo(e),t,i);return s.isIdentityCMap?Q7(s.name,t):s}throw new Error("Encoding required.")}}const YR=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclamsmall","Hungarumlautsmall","","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","twodotenleader","onedotenleader","comma","hyphen","period","fraction","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","colon","semicolon","commasuperior","threequartersemdash","periodsuperior","questionsmall","","asuperior","bsuperior","centsuperior","dsuperior","esuperior","","","","isuperior","","","lsuperior","msuperior","nsuperior","osuperior","","","rsuperior","ssuperior","tsuperior","","ff","fi","fl","ffi","ffl","parenleftinferior","","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdownsmall","centoldstyle","Lslashsmall","","","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","","Dotaccentsmall","","","Macronsmall","","","figuredash","hypheninferior","","","Ogoneksmall","Ringsmall","Cedillasmall","","","","onequarter","onehalf","threequarters","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","","","zerosuperior","onesuperior","twosuperior","threesuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall"],wz=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclamsmall","Hungarumlautsmall","centoldstyle","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","twodotenleader","onedotenleader","comma","hyphen","period","fraction","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","colon","semicolon","","threequartersemdash","","questionsmall","","","","","Ethsmall","","","onequarter","onehalf","threequarters","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","","","","","","","ff","fi","fl","ffi","ffl","parenleftinferior","","parenrightinferior","Circumflexsmall","hypheninferior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","","","asuperior","centsuperior","","","","","Aacutesmall","Agravesmall","Acircumflexsmall","Adieresissmall","Atildesmall","Aringsmall","Ccedillasmall","Eacutesmall","Egravesmall","Ecircumflexsmall","Edieresissmall","Iacutesmall","Igravesmall","Icircumflexsmall","Idieresissmall","Ntildesmall","Oacutesmall","Ogravesmall","Ocircumflexsmall","Odieresissmall","Otildesmall","Uacutesmall","Ugravesmall","Ucircumflexsmall","Udieresissmall","","eightsuperior","fourinferior","threeinferior","sixinferior","eightinferior","seveninferior","Scaronsmall","","centinferior","twoinferior","","Dieresissmall","","Caronsmall","osuperior","fiveinferior","","commainferior","periodinferior","Yacutesmall","","dollarinferior","","","Thornsmall","","nineinferior","zeroinferior","Zcaronsmall","AEsmall","Oslashsmall","questiondownsmall","oneinferior","Lslashsmall","","","","","","","Cedillasmall","","","","","","OEsmall","figuredash","hyphensuperior","","","","","exclamdownsmall","","Ydieresissmall","","onesuperior","twosuperior","threesuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","ninesuperior","zerosuperior","","esuperior","rsuperior","tsuperior","","","isuperior","ssuperior","dsuperior","","","","","","lsuperior","Ogoneksmall","Brevesmall","Macronsmall","bsuperior","nsuperior","msuperior","commasuperior","periodsuperior","Dotaccentsmall","Ringsmall","","","",""],M4=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quotesingle","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","grave","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","","Adieresis","Aring","Ccedilla","Eacute","Ntilde","Odieresis","Udieresis","aacute","agrave","acircumflex","adieresis","atilde","aring","ccedilla","eacute","egrave","ecircumflex","edieresis","iacute","igrave","icircumflex","idieresis","ntilde","oacute","ograve","ocircumflex","odieresis","otilde","uacute","ugrave","ucircumflex","udieresis","dagger","degree","cent","sterling","section","bullet","paragraph","germandbls","registered","copyright","trademark","acute","dieresis","notequal","AE","Oslash","infinity","plusminus","lessequal","greaterequal","yen","mu","partialdiff","summation","product","pi","integral","ordfeminine","ordmasculine","Omega","ae","oslash","questiondown","exclamdown","logicalnot","radical","florin","approxequal","Delta","guillemotleft","guillemotright","ellipsis","space","Agrave","Atilde","Otilde","OE","oe","endash","emdash","quotedblleft","quotedblright","quoteleft","quoteright","divide","lozenge","ydieresis","Ydieresis","fraction","currency","guilsinglleft","guilsinglright","fi","fl","daggerdbl","periodcentered","quotesinglbase","quotedblbase","perthousand","Acircumflex","Ecircumflex","Aacute","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Oacute","Ocircumflex","apple","Ograve","Uacute","Ucircumflex","Ugrave","dotlessi","circumflex","tilde","macron","breve","dotaccent","ring","cedilla","hungarumlaut","ogonek","caron"],f0=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","","endash","dagger","daggerdbl","periodcentered","","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","","questiondown","","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","","ring","cedilla","","hungarumlaut","ogonek","caron","emdash","","","","","","","","","","","","","","","","","AE","","ordfeminine","","","","","Lslash","Oslash","OE","ordmasculine","","","","","","ae","","","","dotlessi","","","lslash","oslash","oe","germandbls","","","",""],Xp=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quotesingle","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","grave","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","bullet","Euro","bullet","quotesinglbase","florin","quotedblbase","ellipsis","dagger","daggerdbl","circumflex","perthousand","Scaron","guilsinglleft","OE","bullet","Zcaron","bullet","bullet","quoteleft","quoteright","quotedblleft","quotedblright","bullet","endash","emdash","tilde","trademark","scaron","guilsinglright","oe","bullet","zcaron","Ydieresis","space","exclamdown","cent","sterling","currency","yen","brokenbar","section","dieresis","copyright","ordfeminine","guillemotleft","logicalnot","hyphen","registered","macron","degree","plusminus","twosuperior","threesuperior","acute","mu","paragraph","periodcentered","cedilla","onesuperior","ordmasculine","guillemotright","onequarter","onehalf","threequarters","questiondown","Agrave","Aacute","Acircumflex","Atilde","Adieresis","Aring","AE","Ccedilla","Egrave","Eacute","Ecircumflex","Edieresis","Igrave","Iacute","Icircumflex","Idieresis","Eth","Ntilde","Ograve","Oacute","Ocircumflex","Otilde","Odieresis","multiply","Oslash","Ugrave","Uacute","Ucircumflex","Udieresis","Yacute","Thorn","germandbls","agrave","aacute","acircumflex","atilde","adieresis","aring","ae","ccedilla","egrave","eacute","ecircumflex","edieresis","igrave","iacute","icircumflex","idieresis","eth","ntilde","ograve","oacute","ocircumflex","otilde","odieresis","divide","oslash","ugrave","uacute","ucircumflex","udieresis","yacute","thorn","ydieresis"],P4=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclam","universal","numbersign","existential","percent","ampersand","suchthat","parenleft","parenright","asteriskmath","plus","comma","minus","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","congruent","Alpha","Beta","Chi","Delta","Epsilon","Phi","Gamma","Eta","Iota","theta1","Kappa","Lambda","Mu","Nu","Omicron","Pi","Theta","Rho","Sigma","Tau","Upsilon","sigma1","Omega","Xi","Psi","Zeta","bracketleft","therefore","bracketright","perpendicular","underscore","radicalex","alpha","beta","chi","delta","epsilon","phi","gamma","eta","iota","phi1","kappa","lambda","mu","nu","omicron","pi","theta","rho","sigma","tau","upsilon","omega1","omega","xi","psi","zeta","braceleft","bar","braceright","similar","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","Euro","Upsilon1","minute","lessequal","fraction","infinity","florin","club","diamond","heart","spade","arrowboth","arrowleft","arrowup","arrowright","arrowdown","degree","plusminus","second","greaterequal","multiply","proportional","partialdiff","bullet","divide","notequal","equivalence","approxequal","ellipsis","arrowvertex","arrowhorizex","carriagereturn","aleph","Ifraktur","Rfraktur","weierstrass","circlemultiply","circleplus","emptyset","intersection","union","propersuperset","reflexsuperset","notsubset","propersubset","reflexsubset","element","notelement","angle","gradient","registerserif","copyrightserif","trademarkserif","product","radical","dotmath","logicalnot","logicaland","logicalor","arrowdblboth","arrowdblleft","arrowdblup","arrowdblright","arrowdbldown","lozenge","angleleft","registersans","copyrightsans","trademarksans","summation","parenlefttp","parenleftex","parenleftbt","bracketlefttp","bracketleftex","bracketleftbt","bracelefttp","braceleftmid","braceleftbt","braceex","","angleright","integral","integraltp","integralex","integralbt","parenrighttp","parenrightex","parenrightbt","bracketrighttp","bracketrightex","bracketrightbt","bracerighttp","bracerightmid","bracerightbt",""],N4=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","a1","a2","a202","a3","a4","a5","a119","a118","a117","a11","a12","a13","a14","a15","a16","a105","a17","a18","a19","a20","a21","a22","a23","a24","a25","a26","a27","a28","a6","a7","a8","a9","a10","a29","a30","a31","a32","a33","a34","a35","a36","a37","a38","a39","a40","a41","a42","a43","a44","a45","a46","a47","a48","a49","a50","a51","a52","a53","a54","a55","a56","a57","a58","a59","a60","a61","a62","a63","a64","a65","a66","a67","a68","a69","a70","a71","a72","a73","a74","a203","a75","a204","a76","a77","a78","a79","a81","a82","a83","a84","a97","a98","a99","a100","","a89","a90","a93","a94","a91","a92","a205","a85","a206","a86","a87","a88","a95","a96","","","","","","","","","","","","","","","","","","","","a101","a102","a103","a104","a106","a107","a108","a112","a111","a110","a109","a120","a121","a122","a123","a124","a125","a126","a127","a128","a129","a130","a131","a132","a133","a134","a135","a136","a137","a138","a139","a140","a141","a142","a143","a144","a145","a146","a147","a148","a149","a150","a151","a152","a153","a154","a155","a156","a157","a158","a159","a160","a161","a163","a164","a196","a165","a192","a166","a167","a168","a169","a170","a171","a172","a173","a162","a174","a175","a176","a177","a178","a179","a193","a180","a199","a181","a200","a182","","a201","a183","a184","a197","a185","a194","a198","a186","a195","a187","a188","a189","a190","a191",""];function Yp(n){switch(n){case"WinAnsiEncoding":return Xp;case"StandardEncoding":return f0;case"MacRomanEncoding":return M4;case"SymbolSetEncoding":return P4;case"ZapfDingbatsEncoding":return N4;case"ExpertEncoding":return YR;case"MacExpertEncoding":return wz;default:return null}}const $l=Ei(function(n){n.A=65,n.AE=198,n.AEacute=508,n.AEmacron=482,n.AEsmall=63462,n.Aacute=193,n.Aacutesmall=63457,n.Abreve=258,n.Abreveacute=7854,n.Abrevecyrillic=1232,n.Abrevedotbelow=7862,n.Abrevegrave=7856,n.Abrevehookabove=7858,n.Abrevetilde=7860,n.Acaron=461,n.Acircle=9398,n.Acircumflex=194,n.Acircumflexacute=7844,n.Acircumflexdotbelow=7852,n.Acircumflexgrave=7846,n.Acircumflexhookabove=7848,n.Acircumflexsmall=63458,n.Acircumflextilde=7850,n.Acute=63177,n.Acutesmall=63412,n.Acyrillic=1040,n.Adblgrave=512,n.Adieresis=196,n.Adieresiscyrillic=1234,n.Adieresismacron=478,n.Adieresissmall=63460,n.Adotbelow=7840,n.Adotmacron=480,n.Agrave=192,n.Agravesmall=63456,n.Ahookabove=7842,n.Aiecyrillic=1236,n.Ainvertedbreve=514,n.Alpha=913,n.Alphatonos=902,n.Amacron=256,n.Amonospace=65313,n.Aogonek=260,n.Aring=197,n.Aringacute=506,n.Aringbelow=7680,n.Aringsmall=63461,n.Asmall=63329,n.Atilde=195,n.Atildesmall=63459,n.Aybarmenian=1329,n.B=66,n.Bcircle=9399,n.Bdotaccent=7682,n.Bdotbelow=7684,n.Becyrillic=1041,n.Benarmenian=1330,n.Beta=914,n.Bhook=385,n.Blinebelow=7686,n.Bmonospace=65314,n.Brevesmall=63220,n.Bsmall=63330,n.Btopbar=386,n.C=67,n.Caarmenian=1342,n.Cacute=262,n.Caron=63178,n.Caronsmall=63221,n.Ccaron=268,n.Ccedilla=199,n.Ccedillaacute=7688,n.Ccedillasmall=63463,n.Ccircle=9400,n.Ccircumflex=264,n.Cdot=266,n.Cdotaccent=266,n.Cedillasmall=63416,n.Chaarmenian=1353,n.Cheabkhasiancyrillic=1212,n.Checyrillic=1063,n.Chedescenderabkhasiancyrillic=1214,n.Chedescendercyrillic=1206,n.Chedieresiscyrillic=1268,n.Cheharmenian=1347,n.Chekhakassiancyrillic=1227,n.Cheverticalstrokecyrillic=1208,n.Chi=935,n.Chook=391,n.Circumflexsmall=63222,n.Cmonospace=65315,n.Coarmenian=1361,n.Csmall=63331,n.D=68,n.DZ=497,n.DZcaron=452,n.Daarmenian=1332,n.Dafrican=393,n.Dcaron=270,n.Dcedilla=7696,n.Dcircle=9401,n.Dcircumflexbelow=7698,n.Dcroat=272,n.Ddotaccent=7690,n.Ddotbelow=7692,n.Decyrillic=1044,n.Deicoptic=1006,n.Delta=8710,n.Deltagreek=916,n.Dhook=394,n.Dieresis=63179,n.DieresisAcute=63180,n.DieresisGrave=63181,n.Dieresissmall=63400,n.Digammagreek=988,n.Djecyrillic=1026,n.Dlinebelow=7694,n.Dmonospace=65316,n.Dotaccentsmall=63223,n.Dslash=272,n.Dsmall=63332,n.Dtopbar=395,n.Dz=498,n.Dzcaron=453,n.Dzeabkhasiancyrillic=1248,n.Dzecyrillic=1029,n.Dzhecyrillic=1039,n.E=69,n.Eacute=201,n.Eacutesmall=63465,n.Ebreve=276,n.Ecaron=282,n.Ecedillabreve=7708,n.Echarmenian=1333,n.Ecircle=9402,n.Ecircumflex=202,n.Ecircumflexacute=7870,n.Ecircumflexbelow=7704,n.Ecircumflexdotbelow=7878,n.Ecircumflexgrave=7872,n.Ecircumflexhookabove=7874,n.Ecircumflexsmall=63466,n.Ecircumflextilde=7876,n.Ecyrillic=1028,n.Edblgrave=516,n.Edieresis=203,n.Edieresissmall=63467,n.Edot=278,n.Edotaccent=278,n.Edotbelow=7864,n.Efcyrillic=1060,n.Egrave=200,n.Egravesmall=63464,n.Eharmenian=1335,n.Ehookabove=7866,n.Eightroman=8551,n.Einvertedbreve=518,n.Eiotifiedcyrillic=1124,n.Elcyrillic=1051,n.Elevenroman=8554,n.Emacron=274,n.Emacronacute=7702,n.Emacrongrave=7700,n.Emcyrillic=1052,n.Emonospace=65317,n.Encyrillic=1053,n.Endescendercyrillic=1186,n.Eng=330,n.Enghecyrillic=1188,n.Enhookcyrillic=1223,n.Eogonek=280,n.Eopen=400,n.Epsilon=917,n.Epsilontonos=904,n.Ercyrillic=1056,n.Ereversed=398,n.Ereversedcyrillic=1069,n.Escyrillic=1057,n.Esdescendercyrillic=1194,n.Esh=425,n.Esmall=63333,n.Eta=919,n.Etarmenian=1336,n.Etatonos=905,n.Eth=208,n.Ethsmall=63472,n.Etilde=7868,n.Etildebelow=7706,n.Euro=8364,n.Ezh=439,n.Ezhcaron=494,n.Ezhreversed=440,n.F=70,n.Fcircle=9403,n.Fdotaccent=7710,n.Feharmenian=1366,n.Feicoptic=996,n.Fhook=401,n.Fitacyrillic=1138,n.Fiveroman=8548,n.Fmonospace=65318,n.Fourroman=8547,n.Fsmall=63334,n.G=71,n.GBsquare=13191,n.Gacute=500,n.Gamma=915,n.Gammaafrican=404,n.Gangiacoptic=1002,n.Gbreve=286,n.Gcaron=486,n.Gcedilla=290,n.Gcircle=9404,n.Gcircumflex=284,n.Gcommaaccent=290,n.Gdot=288,n.Gdotaccent=288,n.Gecyrillic=1043,n.Ghadarmenian=1346,n.Ghemiddlehookcyrillic=1172,n.Ghestrokecyrillic=1170,n.Gheupturncyrillic=1168,n.Ghook=403,n.Gimarmenian=1331,n.Gjecyrillic=1027,n.Gmacron=7712,n.Gmonospace=65319,n.Grave=63182,n.Gravesmall=63328,n.Gsmall=63335,n.Gsmallhook=667,n.Gstroke=484,n.H=72,n.H18533=9679,n.H18543=9642,n.H18551=9643,n.H22073=9633,n.HPsquare=13259,n.Haabkhasiancyrillic=1192,n.Hadescendercyrillic=1202,n.Hardsigncyrillic=1066,n.Hbar=294,n.Hbrevebelow=7722,n.Hcedilla=7720,n.Hcircle=9405,n.Hcircumflex=292,n.Hdieresis=7718,n.Hdotaccent=7714,n.Hdotbelow=7716,n.Hmonospace=65320,n.Hoarmenian=1344,n.Horicoptic=1e3,n.Hsmall=63336,n.Hungarumlaut=63183,n.Hungarumlautsmall=63224,n.Hzsquare=13200,n.I=73,n.IAcyrillic=1071,n.IJ=306,n.IUcyrillic=1070,n.Iacute=205,n.Iacutesmall=63469,n.Ibreve=300,n.Icaron=463,n.Icircle=9406,n.Icircumflex=206,n.Icircumflexsmall=63470,n.Icyrillic=1030,n.Idblgrave=520,n.Idieresis=207,n.Idieresisacute=7726,n.Idieresiscyrillic=1252,n.Idieresissmall=63471,n.Idot=304,n.Idotaccent=304,n.Idotbelow=7882,n.Iebrevecyrillic=1238,n.Iecyrillic=1045,n.Ifraktur=8465,n.Igrave=204,n.Igravesmall=63468,n.Ihookabove=7880,n.Iicyrillic=1048,n.Iinvertedbreve=522,n.Iishortcyrillic=1049,n.Imacron=298,n.Imacroncyrillic=1250,n.Imonospace=65321,n.Iniarmenian=1339,n.Iocyrillic=1025,n.Iogonek=302,n.Iota=921,n.Iotaafrican=406,n.Iotadieresis=938,n.Iotatonos=906,n.Ismall=63337,n.Istroke=407,n.Itilde=296,n.Itildebelow=7724,n.Izhitsacyrillic=1140,n.Izhitsadblgravecyrillic=1142,n.J=74,n.Jaarmenian=1345,n.Jcircle=9407,n.Jcircumflex=308,n.Jecyrillic=1032,n.Jheharmenian=1355,n.Jmonospace=65322,n.Jsmall=63338,n.K=75,n.KBsquare=13189,n.KKsquare=13261,n.Kabashkircyrillic=1184,n.Kacute=7728,n.Kacyrillic=1050,n.Kadescendercyrillic=1178,n.Kahookcyrillic=1219,n.Kappa=922,n.Kastrokecyrillic=1182,n.Kaverticalstrokecyrillic=1180,n.Kcaron=488,n.Kcedilla=310,n.Kcircle=9408,n.Kcommaaccent=310,n.Kdotbelow=7730,n.Keharmenian=1364,n.Kenarmenian=1343,n.Khacyrillic=1061,n.Kheicoptic=998,n.Khook=408,n.Kjecyrillic=1036,n.Klinebelow=7732,n.Kmonospace=65323,n.Koppacyrillic=1152,n.Koppagreek=990,n.Ksicyrillic=1134,n.Ksmall=63339,n.L=76,n.LJ=455,n.LL=63167,n.Lacute=313,n.Lambda=923,n.Lcaron=317,n.Lcedilla=315,n.Lcircle=9409,n.Lcircumflexbelow=7740,n.Lcommaaccent=315,n.Ldot=319,n.Ldotaccent=319,n.Ldotbelow=7734,n.Ldotbelowmacron=7736,n.Liwnarmenian=1340,n.Lj=456,n.Ljecyrillic=1033,n.Llinebelow=7738,n.Lmonospace=65324,n.Lslash=321,n.Lslashsmall=63225,n.Lsmall=63340,n.M=77,n.MBsquare=13190,n.Macron=63184,n.Macronsmall=63407,n.Macute=7742,n.Mcircle=9410,n.Mdotaccent=7744,n.Mdotbelow=7746,n.Menarmenian=1348,n.Mmonospace=65325,n.Msmall=63341,n.Mturned=412,n.Mu=924,n.N=78,n.NJ=458,n.Nacute=323,n.Ncaron=327,n.Ncedilla=325,n.Ncircle=9411,n.Ncircumflexbelow=7754,n.Ncommaaccent=325,n.Ndotaccent=7748,n.Ndotbelow=7750,n.Nhookleft=413,n.Nineroman=8552,n.Nj=459,n.Njecyrillic=1034,n.Nlinebelow=7752,n.Nmonospace=65326,n.Nowarmenian=1350,n.Nsmall=63342,n.Ntilde=209,n.Ntildesmall=63473,n.Nu=925,n.O=79,n.OE=338,n.OEsmall=63226,n.Oacute=211,n.Oacutesmall=63475,n.Obarredcyrillic=1256,n.Obarreddieresiscyrillic=1258,n.Obreve=334,n.Ocaron=465,n.Ocenteredtilde=415,n.Ocircle=9412,n.Ocircumflex=212,n.Ocircumflexacute=7888,n.Ocircumflexdotbelow=7896,n.Ocircumflexgrave=7890,n.Ocircumflexhookabove=7892,n.Ocircumflexsmall=63476,n.Ocircumflextilde=7894,n.Ocyrillic=1054,n.Odblacute=336,n.Odblgrave=524,n.Odieresis=214,n.Odieresiscyrillic=1254,n.Odieresissmall=63478,n.Odotbelow=7884,n.Ogoneksmall=63227,n.Ograve=210,n.Ogravesmall=63474,n.Oharmenian=1365,n.Ohm=8486,n.Ohookabove=7886,n.Ohorn=416,n.Ohornacute=7898,n.Ohorndotbelow=7906,n.Ohorngrave=7900,n.Ohornhookabove=7902,n.Ohorntilde=7904,n.Ohungarumlaut=336,n.Oi=418,n.Oinvertedbreve=526,n.Omacron=332,n.Omacronacute=7762,n.Omacrongrave=7760,n.Omega=8486,n.Omegacyrillic=1120,n.Omegagreek=937,n.Omegaroundcyrillic=1146,n.Omegatitlocyrillic=1148,n.Omegatonos=911,n.Omicron=927,n.Omicrontonos=908,n.Omonospace=65327,n.Oneroman=8544,n.Oogonek=490,n.Oogonekmacron=492,n.Oopen=390,n.Oslash=216,n.Oslashacute=510,n.Oslashsmall=63480,n.Osmall=63343,n.Ostrokeacute=510,n.Otcyrillic=1150,n.Otilde=213,n.Otildeacute=7756,n.Otildedieresis=7758,n.Otildesmall=63477,n.P=80,n.Pacute=7764,n.Pcircle=9413,n.Pdotaccent=7766,n.Pecyrillic=1055,n.Peharmenian=1354,n.Pemiddlehookcyrillic=1190,n.Phi=934,n.Phook=420,n.Pi=928,n.Piwrarmenian=1363,n.Pmonospace=65328,n.Psi=936,n.Psicyrillic=1136,n.Psmall=63344,n.Q=81,n.Qcircle=9414,n.Qmonospace=65329,n.Qsmall=63345,n.R=82,n.Raarmenian=1356,n.Racute=340,n.Rcaron=344,n.Rcedilla=342,n.Rcircle=9415,n.Rcommaaccent=342,n.Rdblgrave=528,n.Rdotaccent=7768,n.Rdotbelow=7770,n.Rdotbelowmacron=7772,n.Reharmenian=1360,n.Rfraktur=8476,n.Rho=929,n.Ringsmall=63228,n.Rinvertedbreve=530,n.Rlinebelow=7774,n.Rmonospace=65330,n.Rsmall=63346,n.Rsmallinverted=641,n.Rsmallinvertedsuperior=694,n.S=83,n.SF010000=9484,n.SF020000=9492,n.SF030000=9488,n.SF040000=9496,n.SF050000=9532,n.SF060000=9516,n.SF070000=9524,n.SF080000=9500,n.SF090000=9508,n.SF100000=9472,n.SF110000=9474,n.SF190000=9569,n.SF200000=9570,n.SF210000=9558,n.SF220000=9557,n.SF230000=9571,n.SF240000=9553,n.SF250000=9559,n.SF260000=9565,n.SF270000=9564,n.SF280000=9563,n.SF360000=9566,n.SF370000=9567,n.SF380000=9562,n.SF390000=9556,n.SF400000=9577,n.SF410000=9574,n.SF420000=9568,n.SF430000=9552,n.SF440000=9580,n.SF450000=9575,n.SF460000=9576,n.SF470000=9572,n.SF480000=9573,n.SF490000=9561,n.SF500000=9560,n.SF510000=9554,n.SF520000=9555,n.SF530000=9579,n.SF540000=9578,n.Sacute=346,n.Sacutedotaccent=7780,n.Sampigreek=992,n.Scaron=352,n.Scarondotaccent=7782,n.Scaronsmall=63229,n.Scedilla=350,n.Schwa=399,n.Schwacyrillic=1240,n.Schwadieresiscyrillic=1242,n.Scircle=9416,n.Scircumflex=348,n.Scommaaccent=536,n.Sdotaccent=7776,n.Sdotbelow=7778,n.Sdotbelowdotaccent=7784,n.Seharmenian=1357,n.Sevenroman=8550,n.Shaarmenian=1351,n.Shacyrillic=1064,n.Shchacyrillic=1065,n.Sheicoptic=994,n.Shhacyrillic=1210,n.Shimacoptic=1004,n.Sigma=931,n.Sixroman=8549,n.Smonospace=65331,n.Softsigncyrillic=1068,n.Ssmall=63347,n.Stigmagreek=986,n.T=84,n.Tau=932,n.Tbar=358,n.Tcaron=356,n.Tcedilla=354,n.Tcircle=9417,n.Tcircumflexbelow=7792,n.Tcommaaccent=354,n.Tdotaccent=7786,n.Tdotbelow=7788,n.Tecyrillic=1058,n.Tedescendercyrillic=1196,n.Tenroman=8553,n.Tetsecyrillic=1204,n.Theta=920,n.Thook=428,n.Thorn=222,n.Thornsmall=63486,n.Threeroman=8546,n.Tildesmall=63230,n.Tiwnarmenian=1359,n.Tlinebelow=7790,n.Tmonospace=65332,n.Toarmenian=1337,n.Tonefive=444,n.Tonesix=388,n.Tonetwo=423,n.Tretroflexhook=430,n.Tsecyrillic=1062,n.Tshecyrillic=1035,n.Tsmall=63348,n.Twelveroman=8555,n.Tworoman=8545,n.U=85,n.Uacute=218,n.Uacutesmall=63482,n.Ubreve=364,n.Ucaron=467,n.Ucircle=9418,n.Ucircumflex=219,n.Ucircumflexbelow=7798,n.Ucircumflexsmall=63483,n.Ucyrillic=1059,n.Udblacute=368,n.Udblgrave=532,n.Udieresis=220,n.Udieresisacute=471,n.Udieresisbelow=7794,n.Udieresiscaron=473,n.Udieresiscyrillic=1264,n.Udieresisgrave=475,n.Udieresismacron=469,n.Udieresissmall=63484,n.Udotbelow=7908,n.Ugrave=217,n.Ugravesmall=63481,n.Uhookabove=7910,n.Uhorn=431,n.Uhornacute=7912,n.Uhorndotbelow=7920,n.Uhorngrave=7914,n.Uhornhookabove=7916,n.Uhorntilde=7918,n.Uhungarumlaut=368,n.Uhungarumlautcyrillic=1266,n.Uinvertedbreve=534,n.Ukcyrillic=1144,n.Umacron=362,n.Umacroncyrillic=1262,n.Umacrondieresis=7802,n.Umonospace=65333,n.Uogonek=370,n.Upsilon=933,n.Upsilon1=978,n.Upsilonacutehooksymbolgreek=979,n.Upsilonafrican=433,n.Upsilondieresis=939,n.Upsilondieresishooksymbolgreek=980,n.Upsilonhooksymbol=978,n.Upsilontonos=910,n.Uring=366,n.Ushortcyrillic=1038,n.Usmall=63349,n.Ustraightcyrillic=1198,n.Ustraightstrokecyrillic=1200,n.Utilde=360,n.Utildeacute=7800,n.Utildebelow=7796,n.V=86,n.Vcircle=9419,n.Vdotbelow=7806,n.Vecyrillic=1042,n.Vewarmenian=1358,n.Vhook=434,n.Vmonospace=65334,n.Voarmenian=1352,n.Vsmall=63350,n.Vtilde=7804,n.W=87,n.Wacute=7810,n.Wcircle=9420,n.Wcircumflex=372,n.Wdieresis=7812,n.Wdotaccent=7814,n.Wdotbelow=7816,n.Wgrave=7808,n.Wmonospace=65335,n.Wsmall=63351,n.X=88,n.Xcircle=9421,n.Xdieresis=7820,n.Xdotaccent=7818,n.Xeharmenian=1341,n.Xi=926,n.Xmonospace=65336,n.Xsmall=63352,n.Y=89,n.Yacute=221,n.Yacutesmall=63485,n.Yatcyrillic=1122,n.Ycircle=9422,n.Ycircumflex=374,n.Ydieresis=376,n.Ydieresissmall=63487,n.Ydotaccent=7822,n.Ydotbelow=7924,n.Yericyrillic=1067,n.Yerudieresiscyrillic=1272,n.Ygrave=7922,n.Yhook=435,n.Yhookabove=7926,n.Yiarmenian=1349,n.Yicyrillic=1031,n.Yiwnarmenian=1362,n.Ymonospace=65337,n.Ysmall=63353,n.Ytilde=7928,n.Yusbigcyrillic=1130,n.Yusbigiotifiedcyrillic=1132,n.Yuslittlecyrillic=1126,n.Yuslittleiotifiedcyrillic=1128,n.Z=90,n.Zaarmenian=1334,n.Zacute=377,n.Zcaron=381,n.Zcaronsmall=63231,n.Zcircle=9423,n.Zcircumflex=7824,n.Zdot=379,n.Zdotaccent=379,n.Zdotbelow=7826,n.Zecyrillic=1047,n.Zedescendercyrillic=1176,n.Zedieresiscyrillic=1246,n.Zeta=918,n.Zhearmenian=1338,n.Zhebrevecyrillic=1217,n.Zhecyrillic=1046,n.Zhedescendercyrillic=1174,n.Zhedieresiscyrillic=1244,n.Zlinebelow=7828,n.Zmonospace=65338,n.Zsmall=63354,n.Zstroke=437,n.a=97,n.aabengali=2438,n.aacute=225,n.aadeva=2310,n.aagujarati=2694,n.aagurmukhi=2566,n.aamatragurmukhi=2622,n.aarusquare=13059,n.aavowelsignbengali=2494,n.aavowelsigndeva=2366,n.aavowelsigngujarati=2750,n.abbreviationmarkarmenian=1375,n.abbreviationsigndeva=2416,n.abengali=2437,n.abopomofo=12570,n.abreve=259,n.abreveacute=7855,n.abrevecyrillic=1233,n.abrevedotbelow=7863,n.abrevegrave=7857,n.abrevehookabove=7859,n.abrevetilde=7861,n.acaron=462,n.acircle=9424,n.acircumflex=226,n.acircumflexacute=7845,n.acircumflexdotbelow=7853,n.acircumflexgrave=7847,n.acircumflexhookabove=7849,n.acircumflextilde=7851,n.acute=180,n.acutebelowcmb=791,n.acutecmb=769,n.acutecomb=769,n.acutedeva=2388,n.acutelowmod=719,n.acutetonecmb=833,n.acyrillic=1072,n.adblgrave=513,n.addakgurmukhi=2673,n.adeva=2309,n.adieresis=228,n.adieresiscyrillic=1235,n.adieresismacron=479,n.adotbelow=7841,n.adotmacron=481,n.ae=230,n.aeacute=509,n.aekorean=12624,n.aemacron=483,n.afii00208=8213,n.afii08941=8356,n.afii10017=1040,n.afii10018=1041,n.afii10019=1042,n.afii10020=1043,n.afii10021=1044,n.afii10022=1045,n.afii10023=1025,n.afii10024=1046,n.afii10025=1047,n.afii10026=1048,n.afii10027=1049,n.afii10028=1050,n.afii10029=1051,n.afii10030=1052,n.afii10031=1053,n.afii10032=1054,n.afii10033=1055,n.afii10034=1056,n.afii10035=1057,n.afii10036=1058,n.afii10037=1059,n.afii10038=1060,n.afii10039=1061,n.afii10040=1062,n.afii10041=1063,n.afii10042=1064,n.afii10043=1065,n.afii10044=1066,n.afii10045=1067,n.afii10046=1068,n.afii10047=1069,n.afii10048=1070,n.afii10049=1071,n.afii10050=1168,n.afii10051=1026,n.afii10052=1027,n.afii10053=1028,n.afii10054=1029,n.afii10055=1030,n.afii10056=1031,n.afii10057=1032,n.afii10058=1033,n.afii10059=1034,n.afii10060=1035,n.afii10061=1036,n.afii10062=1038,n.afii10063=63172,n.afii10064=63173,n.afii10065=1072,n.afii10066=1073,n.afii10067=1074,n.afii10068=1075,n.afii10069=1076,n.afii10070=1077,n.afii10071=1105,n.afii10072=1078,n.afii10073=1079,n.afii10074=1080,n.afii10075=1081,n.afii10076=1082,n.afii10077=1083,n.afii10078=1084,n.afii10079=1085,n.afii10080=1086,n.afii10081=1087,n.afii10082=1088,n.afii10083=1089,n.afii10084=1090,n.afii10085=1091,n.afii10086=1092,n.afii10087=1093,n.afii10088=1094,n.afii10089=1095,n.afii10090=1096,n.afii10091=1097,n.afii10092=1098,n.afii10093=1099,n.afii10094=1100,n.afii10095=1101,n.afii10096=1102,n.afii10097=1103,n.afii10098=1169,n.afii10099=1106,n.afii10100=1107,n.afii10101=1108,n.afii10102=1109,n.afii10103=1110,n.afii10104=1111,n.afii10105=1112,n.afii10106=1113,n.afii10107=1114,n.afii10108=1115,n.afii10109=1116,n.afii10110=1118,n.afii10145=1039,n.afii10146=1122,n.afii10147=1138,n.afii10148=1140,n.afii10192=63174,n.afii10193=1119,n.afii10194=1123,n.afii10195=1139,n.afii10196=1141,n.afii10831=63175,n.afii10832=63176,n.afii10846=1241,n.afii299=8206,n.afii300=8207,n.afii301=8205,n.afii57381=1642,n.afii57388=1548,n.afii57392=1632,n.afii57393=1633,n.afii57394=1634,n.afii57395=1635,n.afii57396=1636,n.afii57397=1637,n.afii57398=1638,n.afii57399=1639,n.afii57400=1640,n.afii57401=1641,n.afii57403=1563,n.afii57407=1567,n.afii57409=1569,n.afii57410=1570,n.afii57411=1571,n.afii57412=1572,n.afii57413=1573,n.afii57414=1574,n.afii57415=1575,n.afii57416=1576,n.afii57417=1577,n.afii57418=1578,n.afii57419=1579,n.afii57420=1580,n.afii57421=1581,n.afii57422=1582,n.afii57423=1583,n.afii57424=1584,n.afii57425=1585,n.afii57426=1586,n.afii57427=1587,n.afii57428=1588,n.afii57429=1589,n.afii57430=1590,n.afii57431=1591,n.afii57432=1592,n.afii57433=1593,n.afii57434=1594,n.afii57440=1600,n.afii57441=1601,n.afii57442=1602,n.afii57443=1603,n.afii57444=1604,n.afii57445=1605,n.afii57446=1606,n.afii57448=1608,n.afii57449=1609,n.afii57450=1610,n.afii57451=1611,n.afii57452=1612,n.afii57453=1613,n.afii57454=1614,n.afii57455=1615,n.afii57456=1616,n.afii57457=1617,n.afii57458=1618,n.afii57470=1607,n.afii57505=1700,n.afii57506=1662,n.afii57507=1670,n.afii57508=1688,n.afii57509=1711,n.afii57511=1657,n.afii57512=1672,n.afii57513=1681,n.afii57514=1722,n.afii57519=1746,n.afii57534=1749,n.afii57636=8362,n.afii57645=1470,n.afii57658=1475,n.afii57664=1488,n.afii57665=1489,n.afii57666=1490,n.afii57667=1491,n.afii57668=1492,n.afii57669=1493,n.afii57670=1494,n.afii57671=1495,n.afii57672=1496,n.afii57673=1497,n.afii57674=1498,n.afii57675=1499,n.afii57676=1500,n.afii57677=1501,n.afii57678=1502,n.afii57679=1503,n.afii57680=1504,n.afii57681=1505,n.afii57682=1506,n.afii57683=1507,n.afii57684=1508,n.afii57685=1509,n.afii57686=1510,n.afii57687=1511,n.afii57688=1512,n.afii57689=1513,n.afii57690=1514,n.afii57694=64298,n.afii57695=64299,n.afii57700=64331,n.afii57705=64287,n.afii57716=1520,n.afii57717=1521,n.afii57718=1522,n.afii57723=64309,n.afii57793=1460,n.afii57794=1461,n.afii57795=1462,n.afii57796=1467,n.afii57797=1464,n.afii57798=1463,n.afii57799=1456,n.afii57800=1458,n.afii57801=1457,n.afii57802=1459,n.afii57803=1474,n.afii57804=1473,n.afii57806=1465,n.afii57807=1468,n.afii57839=1469,n.afii57841=1471,n.afii57842=1472,n.afii57929=700,n.afii61248=8453,n.afii61289=8467,n.afii61352=8470,n.afii61573=8236,n.afii61574=8237,n.afii61575=8238,n.afii61664=8204,n.afii63167=1645,n.afii64937=701,n.agrave=224,n.agujarati=2693,n.agurmukhi=2565,n.ahiragana=12354,n.ahookabove=7843,n.aibengali=2448,n.aibopomofo=12574,n.aideva=2320,n.aiecyrillic=1237,n.aigujarati=2704,n.aigurmukhi=2576,n.aimatragurmukhi=2632,n.ainarabic=1593,n.ainfinalarabic=65226,n.aininitialarabic=65227,n.ainmedialarabic=65228,n.ainvertedbreve=515,n.aivowelsignbengali=2504,n.aivowelsigndeva=2376,n.aivowelsigngujarati=2760,n.akatakana=12450,n.akatakanahalfwidth=65393,n.akorean=12623,n.alef=1488,n.alefarabic=1575,n.alefdageshhebrew=64304,n.aleffinalarabic=65166,n.alefhamzaabovearabic=1571,n.alefhamzaabovefinalarabic=65156,n.alefhamzabelowarabic=1573,n.alefhamzabelowfinalarabic=65160,n.alefhebrew=1488,n.aleflamedhebrew=64335,n.alefmaddaabovearabic=1570,n.alefmaddaabovefinalarabic=65154,n.alefmaksuraarabic=1609,n.alefmaksurafinalarabic=65264,n.alefmaksurainitialarabic=65267,n.alefmaksuramedialarabic=65268,n.alefpatahhebrew=64302,n.alefqamatshebrew=64303,n.aleph=8501,n.allequal=8780,n.alpha=945,n.alphatonos=940,n.amacron=257,n.amonospace=65345,n.ampersand=38,n.ampersandmonospace=65286,n.ampersandsmall=63270,n.amsquare=13250,n.anbopomofo=12578,n.angbopomofo=12580,n.angbracketleft=12296,n.angbracketright=12297,n.angkhankhuthai=3674,n.angle=8736,n.anglebracketleft=12296,n.anglebracketleftvertical=65087,n.anglebracketright=12297,n.anglebracketrightvertical=65088,n.angleleft=9001,n.angleright=9002,n.angstrom=8491,n.anoteleia=903,n.anudattadeva=2386,n.anusvarabengali=2434,n.anusvaradeva=2306,n.anusvaragujarati=2690,n.aogonek=261,n.apaatosquare=13056,n.aparen=9372,n.apostrophearmenian=1370,n.apostrophemod=700,n.apple=63743,n.approaches=8784,n.approxequal=8776,n.approxequalorimage=8786,n.approximatelyequal=8773,n.araeaekorean=12686,n.araeakorean=12685,n.arc=8978,n.arighthalfring=7834,n.aring=229,n.aringacute=507,n.aringbelow=7681,n.arrowboth=8596,n.arrowdashdown=8675,n.arrowdashleft=8672,n.arrowdashright=8674,n.arrowdashup=8673,n.arrowdblboth=8660,n.arrowdbldown=8659,n.arrowdblleft=8656,n.arrowdblright=8658,n.arrowdblup=8657,n.arrowdown=8595,n.arrowdownleft=8601,n.arrowdownright=8600,n.arrowdownwhite=8681,n.arrowheaddownmod=709,n.arrowheadleftmod=706,n.arrowheadrightmod=707,n.arrowheadupmod=708,n.arrowhorizex=63719,n.arrowleft=8592,n.arrowleftdbl=8656,n.arrowleftdblstroke=8653,n.arrowleftoverright=8646,n.arrowleftwhite=8678,n.arrowright=8594,n.arrowrightdblstroke=8655,n.arrowrightheavy=10142,n.arrowrightoverleft=8644,n.arrowrightwhite=8680,n.arrowtableft=8676,n.arrowtabright=8677,n.arrowup=8593,n.arrowupdn=8597,n.arrowupdnbse=8616,n.arrowupdownbase=8616,n.arrowupleft=8598,n.arrowupleftofdown=8645,n.arrowupright=8599,n.arrowupwhite=8679,n.arrowvertex=63718,n.asciicircum=94,n.asciicircummonospace=65342,n.asciitilde=126,n.asciitildemonospace=65374,n.ascript=593,n.ascriptturned=594,n.asmallhiragana=12353,n.asmallkatakana=12449,n.asmallkatakanahalfwidth=65383,n.asterisk=42,n.asteriskaltonearabic=1645,n.asteriskarabic=1645,n.asteriskmath=8727,n.asteriskmonospace=65290,n.asterisksmall=65121,n.asterism=8258,n.asuperior=63209,n.asymptoticallyequal=8771,n.at=64,n.atilde=227,n.atmonospace=65312,n.atsmall=65131,n.aturned=592,n.aubengali=2452,n.aubopomofo=12576,n.audeva=2324,n.augujarati=2708,n.augurmukhi=2580,n.aulengthmarkbengali=2519,n.aumatragurmukhi=2636,n.auvowelsignbengali=2508,n.auvowelsigndeva=2380,n.auvowelsigngujarati=2764,n.avagrahadeva=2365,n.aybarmenian=1377,n.ayin=1506,n.ayinaltonehebrew=64288,n.ayinhebrew=1506,n.b=98,n.babengali=2476,n.backslash=92,n.backslashmonospace=65340,n.badeva=2348,n.bagujarati=2732,n.bagurmukhi=2604,n.bahiragana=12400,n.bahtthai=3647,n.bakatakana=12496,n.bar=124,n.barmonospace=65372,n.bbopomofo=12549,n.bcircle=9425,n.bdotaccent=7683,n.bdotbelow=7685,n.beamedsixteenthnotes=9836,n.because=8757,n.becyrillic=1073,n.beharabic=1576,n.behfinalarabic=65168,n.behinitialarabic=65169,n.behiragana=12409,n.behmedialarabic=65170,n.behmeeminitialarabic=64671,n.behmeemisolatedarabic=64520,n.behnoonfinalarabic=64621,n.bekatakana=12505,n.benarmenian=1378,n.bet=1489,n.beta=946,n.betasymbolgreek=976,n.betdagesh=64305,n.betdageshhebrew=64305,n.bethebrew=1489,n.betrafehebrew=64332,n.bhabengali=2477,n.bhadeva=2349,n.bhagujarati=2733,n.bhagurmukhi=2605,n.bhook=595,n.bihiragana=12403,n.bikatakana=12499,n.bilabialclick=664,n.bindigurmukhi=2562,n.birusquare=13105,n.blackcircle=9679,n.blackdiamond=9670,n.blackdownpointingtriangle=9660,n.blackleftpointingpointer=9668,n.blackleftpointingtriangle=9664,n.blacklenticularbracketleft=12304,n.blacklenticularbracketleftvertical=65083,n.blacklenticularbracketright=12305,n.blacklenticularbracketrightvertical=65084,n.blacklowerlefttriangle=9699,n.blacklowerrighttriangle=9698,n.blackrectangle=9644,n.blackrightpointingpointer=9658,n.blackrightpointingtriangle=9654,n.blacksmallsquare=9642,n.blacksmilingface=9787,n.blacksquare=9632,n.blackstar=9733,n.blackupperlefttriangle=9700,n.blackupperrighttriangle=9701,n.blackuppointingsmalltriangle=9652,n.blackuppointingtriangle=9650,n.blank=9251,n.blinebelow=7687,n.block=9608,n.bmonospace=65346,n.bobaimaithai=3610,n.bohiragana=12412,n.bokatakana=12508,n.bparen=9373,n.bqsquare=13251,n.braceex=63732,n.braceleft=123,n.braceleftbt=63731,n.braceleftmid=63730,n.braceleftmonospace=65371,n.braceleftsmall=65115,n.bracelefttp=63729,n.braceleftvertical=65079,n.braceright=125,n.bracerightbt=63742,n.bracerightmid=63741,n.bracerightmonospace=65373,n.bracerightsmall=65116,n.bracerighttp=63740,n.bracerightvertical=65080,n.bracketleft=91,n.bracketleftbt=63728,n.bracketleftex=63727,n.bracketleftmonospace=65339,n.bracketlefttp=63726,n.bracketright=93,n.bracketrightbt=63739,n.bracketrightex=63738,n.bracketrightmonospace=65341,n.bracketrighttp=63737,n.breve=728,n.brevebelowcmb=814,n.brevecmb=774,n.breveinvertedbelowcmb=815,n.breveinvertedcmb=785,n.breveinverteddoublecmb=865,n.bridgebelowcmb=810,n.bridgeinvertedbelowcmb=826,n.brokenbar=166,n.bstroke=384,n.bsuperior=63210,n.btopbar=387,n.buhiragana=12406,n.bukatakana=12502,n.bullet=8226,n.bulletinverse=9688,n.bulletoperator=8729,n.bullseye=9678,n.c=99,n.caarmenian=1390,n.cabengali=2458,n.cacute=263,n.cadeva=2330,n.cagujarati=2714,n.cagurmukhi=2586,n.calsquare=13192,n.candrabindubengali=2433,n.candrabinducmb=784,n.candrabindudeva=2305,n.candrabindugujarati=2689,n.capslock=8682,n.careof=8453,n.caron=711,n.caronbelowcmb=812,n.caroncmb=780,n.carriagereturn=8629,n.cbopomofo=12568,n.ccaron=269,n.ccedilla=231,n.ccedillaacute=7689,n.ccircle=9426,n.ccircumflex=265,n.ccurl=597,n.cdot=267,n.cdotaccent=267,n.cdsquare=13253,n.cedilla=184,n.cedillacmb=807,n.cent=162,n.centigrade=8451,n.centinferior=63199,n.centmonospace=65504,n.centoldstyle=63394,n.centsuperior=63200,n.chaarmenian=1401,n.chabengali=2459,n.chadeva=2331,n.chagujarati=2715,n.chagurmukhi=2587,n.chbopomofo=12564,n.cheabkhasiancyrillic=1213,n.checkmark=10003,n.checyrillic=1095,n.chedescenderabkhasiancyrillic=1215,n.chedescendercyrillic=1207,n.chedieresiscyrillic=1269,n.cheharmenian=1395,n.chekhakassiancyrillic=1228,n.cheverticalstrokecyrillic=1209,n.chi=967,n.chieuchacirclekorean=12919,n.chieuchaparenkorean=12823,n.chieuchcirclekorean=12905,n.chieuchkorean=12618,n.chieuchparenkorean=12809,n.chochangthai=3594,n.chochanthai=3592,n.chochingthai=3593,n.chochoethai=3596,n.chook=392,n.cieucacirclekorean=12918,n.cieucaparenkorean=12822,n.cieuccirclekorean=12904,n.cieuckorean=12616,n.cieucparenkorean=12808,n.cieucuparenkorean=12828,n.circle=9675,n.circlecopyrt=169,n.circlemultiply=8855,n.circleot=8857,n.circleplus=8853,n.circlepostalmark=12342,n.circlewithlefthalfblack=9680,n.circlewithrighthalfblack=9681,n.circumflex=710,n.circumflexbelowcmb=813,n.circumflexcmb=770,n.clear=8999,n.clickalveolar=450,n.clickdental=448,n.clicklateral=449,n.clickretroflex=451,n.club=9827,n.clubsuitblack=9827,n.clubsuitwhite=9831,n.cmcubedsquare=13220,n.cmonospace=65347,n.cmsquaredsquare=13216,n.coarmenian=1409,n.colon=58,n.colonmonetary=8353,n.colonmonospace=65306,n.colonsign=8353,n.colonsmall=65109,n.colontriangularhalfmod=721,n.colontriangularmod=720,n.comma=44,n.commaabovecmb=787,n.commaaboverightcmb=789,n.commaaccent=63171,n.commaarabic=1548,n.commaarmenian=1373,n.commainferior=63201,n.commamonospace=65292,n.commareversedabovecmb=788,n.commareversedmod=701,n.commasmall=65104,n.commasuperior=63202,n.commaturnedabovecmb=786,n.commaturnedmod=699,n.compass=9788,n.congruent=8773,n.contourintegral=8750,n.control=8963,n.controlACK=6,n.controlBEL=7,n.controlBS=8,n.controlCAN=24,n.controlCR=13,n.controlDC1=17,n.controlDC2=18,n.controlDC3=19,n.controlDC4=20,n.controlDEL=127,n.controlDLE=16,n.controlEM=25,n.controlENQ=5,n.controlEOT=4,n.controlESC=27,n.controlETB=23,n.controlETX=3,n.controlFF=12,n.controlFS=28,n.controlGS=29,n.controlHT=9,n.controlLF=10,n.controlNAK=21,n.controlNULL=0,n.controlRS=30,n.controlSI=15,n.controlSO=14,n.controlSOT=2,n.controlSTX=1,n.controlSUB=26,n.controlSYN=22,n.controlUS=31,n.controlVT=11,n.copyright=169,n.copyrightsans=63721,n.copyrightserif=63193,n.cornerbracketleft=12300,n.cornerbracketlefthalfwidth=65378,n.cornerbracketleftvertical=65089,n.cornerbracketright=12301,n.cornerbracketrighthalfwidth=65379,n.cornerbracketrightvertical=65090,n.corporationsquare=13183,n.cosquare=13255,n.coverkgsquare=13254,n.cparen=9374,n.cruzeiro=8354,n.cstretched=663,n.curlyand=8911,n.curlyor=8910,n.currency=164,n.cyrBreve=63185,n.cyrFlex=63186,n.cyrbreve=63188,n.cyrflex=63189,n.d=100,n.daarmenian=1380,n.dabengali=2470,n.dadarabic=1590,n.dadeva=2342,n.dadfinalarabic=65214,n.dadinitialarabic=65215,n.dadmedialarabic=65216,n.dagesh=1468,n.dageshhebrew=1468,n.dagger=8224,n.daggerdbl=8225,n.dagujarati=2726,n.dagurmukhi=2598,n.dahiragana=12384,n.dakatakana=12480,n.dalarabic=1583,n.dalet=1491,n.daletdagesh=64307,n.daletdageshhebrew=64307,n.dalethebrew=1491,n.dalfinalarabic=65194,n.dammaarabic=1615,n.dammalowarabic=1615,n.dammatanaltonearabic=1612,n.dammatanarabic=1612,n.danda=2404,n.dargahebrew=1447,n.dargalefthebrew=1447,n.dasiapneumatacyrilliccmb=1157,n.dblGrave=63187,n.dblanglebracketleft=12298,n.dblanglebracketleftvertical=65085,n.dblanglebracketright=12299,n.dblanglebracketrightvertical=65086,n.dblarchinvertedbelowcmb=811,n.dblarrowleft=8660,n.dblarrowright=8658,n.dbldanda=2405,n.dblgrave=63190,n.dblgravecmb=783,n.dblintegral=8748,n.dbllowline=8215,n.dbllowlinecmb=819,n.dbloverlinecmb=831,n.dblprimemod=698,n.dblverticalbar=8214,n.dblverticallineabovecmb=782,n.dbopomofo=12553,n.dbsquare=13256,n.dcaron=271,n.dcedilla=7697,n.dcircle=9427,n.dcircumflexbelow=7699,n.dcroat=273,n.ddabengali=2465,n.ddadeva=2337,n.ddagujarati=2721,n.ddagurmukhi=2593,n.ddalarabic=1672,n.ddalfinalarabic=64393,n.dddhadeva=2396,n.ddhabengali=2466,n.ddhadeva=2338,n.ddhagujarati=2722,n.ddhagurmukhi=2594,n.ddotaccent=7691,n.ddotbelow=7693,n.decimalseparatorarabic=1643,n.decimalseparatorpersian=1643,n.decyrillic=1076,n.degree=176,n.dehihebrew=1453,n.dehiragana=12391,n.deicoptic=1007,n.dekatakana=12487,n.deleteleft=9003,n.deleteright=8998,n.delta=948,n.deltaturned=397,n.denominatorminusonenumeratorbengali=2552,n.dezh=676,n.dhabengali=2471,n.dhadeva=2343,n.dhagujarati=2727,n.dhagurmukhi=2599,n.dhook=599,n.dialytikatonos=901,n.dialytikatonoscmb=836,n.diamond=9830,n.diamondsuitwhite=9826,n.dieresis=168,n.dieresisacute=63191,n.dieresisbelowcmb=804,n.dieresiscmb=776,n.dieresisgrave=63192,n.dieresistonos=901,n.dihiragana=12386,n.dikatakana=12482,n.dittomark=12291,n.divide=247,n.divides=8739,n.divisionslash=8725,n.djecyrillic=1106,n.dkshade=9619,n.dlinebelow=7695,n.dlsquare=13207,n.dmacron=273,n.dmonospace=65348,n.dnblock=9604,n.dochadathai=3598,n.dodekthai=3604,n.dohiragana=12393,n.dokatakana=12489,n.dollar=36,n.dollarinferior=63203,n.dollarmonospace=65284,n.dollaroldstyle=63268,n.dollarsmall=65129,n.dollarsuperior=63204,n.dong=8363,n.dorusquare=13094,n.dotaccent=729,n.dotaccentcmb=775,n.dotbelowcmb=803,n.dotbelowcomb=803,n.dotkatakana=12539,n.dotlessi=305,n.dotlessj=63166,n.dotlessjstrokehook=644,n.dotmath=8901,n.dottedcircle=9676,n.doubleyodpatah=64287,n.doubleyodpatahhebrew=64287,n.downtackbelowcmb=798,n.downtackmod=725,n.dparen=9375,n.dsuperior=63211,n.dtail=598,n.dtopbar=396,n.duhiragana=12389,n.dukatakana=12485,n.dz=499,n.dzaltone=675,n.dzcaron=454,n.dzcurl=677,n.dzeabkhasiancyrillic=1249,n.dzecyrillic=1109,n.dzhecyrillic=1119,n.e=101,n.eacute=233,n.earth=9793,n.ebengali=2447,n.ebopomofo=12572,n.ebreve=277,n.ecandradeva=2317,n.ecandragujarati=2701,n.ecandravowelsigndeva=2373,n.ecandravowelsigngujarati=2757,n.ecaron=283,n.ecedillabreve=7709,n.echarmenian=1381,n.echyiwnarmenian=1415,n.ecircle=9428,n.ecircumflex=234,n.ecircumflexacute=7871,n.ecircumflexbelow=7705,n.ecircumflexdotbelow=7879,n.ecircumflexgrave=7873,n.ecircumflexhookabove=7875,n.ecircumflextilde=7877,n.ecyrillic=1108,n.edblgrave=517,n.edeva=2319,n.edieresis=235,n.edot=279,n.edotaccent=279,n.edotbelow=7865,n.eegurmukhi=2575,n.eematragurmukhi=2631,n.efcyrillic=1092,n.egrave=232,n.egujarati=2703,n.eharmenian=1383,n.ehbopomofo=12573,n.ehiragana=12360,n.ehookabove=7867,n.eibopomofo=12575,n.eight=56,n.eightarabic=1640,n.eightbengali=2542,n.eightcircle=9319,n.eightcircleinversesansserif=10129,n.eightdeva=2414,n.eighteencircle=9329,n.eighteenparen=9349,n.eighteenperiod=9369,n.eightgujarati=2798,n.eightgurmukhi=2670,n.eighthackarabic=1640,n.eighthangzhou=12328,n.eighthnotebeamed=9835,n.eightideographicparen=12839,n.eightinferior=8328,n.eightmonospace=65304,n.eightoldstyle=63288,n.eightparen=9339,n.eightperiod=9359,n.eightpersian=1784,n.eightroman=8567,n.eightsuperior=8312,n.eightthai=3672,n.einvertedbreve=519,n.eiotifiedcyrillic=1125,n.ekatakana=12456,n.ekatakanahalfwidth=65396,n.ekonkargurmukhi=2676,n.ekorean=12628,n.elcyrillic=1083,n.element=8712,n.elevencircle=9322,n.elevenparen=9342,n.elevenperiod=9362,n.elevenroman=8570,n.ellipsis=8230,n.ellipsisvertical=8942,n.emacron=275,n.emacronacute=7703,n.emacrongrave=7701,n.emcyrillic=1084,n.emdash=8212,n.emdashvertical=65073,n.emonospace=65349,n.emphasismarkarmenian=1371,n.emptyset=8709,n.enbopomofo=12579,n.encyrillic=1085,n.endash=8211,n.endashvertical=65074,n.endescendercyrillic=1187,n.eng=331,n.engbopomofo=12581,n.enghecyrillic=1189,n.enhookcyrillic=1224,n.enspace=8194,n.eogonek=281,n.eokorean=12627,n.eopen=603,n.eopenclosed=666,n.eopenreversed=604,n.eopenreversedclosed=606,n.eopenreversedhook=605,n.eparen=9376,n.epsilon=949,n.epsilontonos=941,n.equal=61,n.equalmonospace=65309,n.equalsmall=65126,n.equalsuperior=8316,n.equivalence=8801,n.erbopomofo=12582,n.ercyrillic=1088,n.ereversed=600,n.ereversedcyrillic=1101,n.escyrillic=1089,n.esdescendercyrillic=1195,n.esh=643,n.eshcurl=646,n.eshortdeva=2318,n.eshortvowelsigndeva=2374,n.eshreversedloop=426,n.eshsquatreversed=645,n.esmallhiragana=12359,n.esmallkatakana=12455,n.esmallkatakanahalfwidth=65386,n.estimated=8494,n.esuperior=63212,n.eta=951,n.etarmenian=1384,n.etatonos=942,n.eth=240,n.etilde=7869,n.etildebelow=7707,n.etnahtafoukhhebrew=1425,n.etnahtafoukhlefthebrew=1425,n.etnahtahebrew=1425,n.etnahtalefthebrew=1425,n.eturned=477,n.eukorean=12641,n.euro=8364,n.evowelsignbengali=2503,n.evowelsigndeva=2375,n.evowelsigngujarati=2759,n.exclam=33,n.exclamarmenian=1372,n.exclamdbl=8252,n.exclamdown=161,n.exclamdownsmall=63393,n.exclammonospace=65281,n.exclamsmall=63265,n.existential=8707,n.ezh=658,n.ezhcaron=495,n.ezhcurl=659,n.ezhreversed=441,n.ezhtail=442,n.f=102,n.fadeva=2398,n.fagurmukhi=2654,n.fahrenheit=8457,n.fathaarabic=1614,n.fathalowarabic=1614,n.fathatanarabic=1611,n.fbopomofo=12552,n.fcircle=9429,n.fdotaccent=7711,n.feharabic=1601,n.feharmenian=1414,n.fehfinalarabic=65234,n.fehinitialarabic=65235,n.fehmedialarabic=65236,n.feicoptic=997,n.female=9792,n.ff=64256,n.f_f=64256,n.ffi=64259,n.f_f_i=64259,n.ffl=64260,n.f_f_l=64260,n.fi=64257,n.f_i=64257,n.fifteencircle=9326,n.fifteenparen=9346,n.fifteenperiod=9366,n.figuredash=8210,n.filledbox=9632,n.filledrect=9644,n.finalkaf=1498,n.finalkafdagesh=64314,n.finalkafdageshhebrew=64314,n.finalkafhebrew=1498,n.finalmem=1501,n.finalmemhebrew=1501,n.finalnun=1503,n.finalnunhebrew=1503,n.finalpe=1507,n.finalpehebrew=1507,n.finaltsadi=1509,n.finaltsadihebrew=1509,n.firsttonechinese=713,n.fisheye=9673,n.fitacyrillic=1139,n.five=53,n.fivearabic=1637,n.fivebengali=2539,n.fivecircle=9316,n.fivecircleinversesansserif=10126,n.fivedeva=2411,n.fiveeighths=8541,n.fivegujarati=2795,n.fivegurmukhi=2667,n.fivehackarabic=1637,n.fivehangzhou=12325,n.fiveideographicparen=12836,n.fiveinferior=8325,n.fivemonospace=65301,n.fiveoldstyle=63285,n.fiveparen=9336,n.fiveperiod=9356,n.fivepersian=1781,n.fiveroman=8564,n.fivesuperior=8309,n.fivethai=3669,n.fl=64258,n.f_l=64258,n.florin=402,n.fmonospace=65350,n.fmsquare=13209,n.fofanthai=3615,n.fofathai=3613,n.fongmanthai=3663,n.forall=8704,n.four=52,n.fourarabic=1636,n.fourbengali=2538,n.fourcircle=9315,n.fourcircleinversesansserif=10125,n.fourdeva=2410,n.fourgujarati=2794,n.fourgurmukhi=2666,n.fourhackarabic=1636,n.fourhangzhou=12324,n.fourideographicparen=12835,n.fourinferior=8324,n.fourmonospace=65300,n.fournumeratorbengali=2551,n.fouroldstyle=63284,n.fourparen=9335,n.fourperiod=9355,n.fourpersian=1780,n.fourroman=8563,n.foursuperior=8308,n.fourteencircle=9325,n.fourteenparen=9345,n.fourteenperiod=9365,n.fourthai=3668,n.fourthtonechinese=715,n.fparen=9377,n.fraction=8260,n.franc=8355,n.g=103,n.gabengali=2455,n.gacute=501,n.gadeva=2327,n.gafarabic=1711,n.gaffinalarabic=64403,n.gafinitialarabic=64404,n.gafmedialarabic=64405,n.gagujarati=2711,n.gagurmukhi=2583,n.gahiragana=12364,n.gakatakana=12460,n.gamma=947,n.gammalatinsmall=611,n.gammasuperior=736,n.gangiacoptic=1003,n.gbopomofo=12557,n.gbreve=287,n.gcaron=487,n.gcedilla=291,n.gcircle=9430,n.gcircumflex=285,n.gcommaaccent=291,n.gdot=289,n.gdotaccent=289,n.gecyrillic=1075,n.gehiragana=12370,n.gekatakana=12466,n.geometricallyequal=8785,n.gereshaccenthebrew=1436,n.gereshhebrew=1523,n.gereshmuqdamhebrew=1437,n.germandbls=223,n.gershayimaccenthebrew=1438,n.gershayimhebrew=1524,n.getamark=12307,n.ghabengali=2456,n.ghadarmenian=1394,n.ghadeva=2328,n.ghagujarati=2712,n.ghagurmukhi=2584,n.ghainarabic=1594,n.ghainfinalarabic=65230,n.ghaininitialarabic=65231,n.ghainmedialarabic=65232,n.ghemiddlehookcyrillic=1173,n.ghestrokecyrillic=1171,n.gheupturncyrillic=1169,n.ghhadeva=2394,n.ghhagurmukhi=2650,n.ghook=608,n.ghzsquare=13203,n.gihiragana=12366,n.gikatakana=12462,n.gimarmenian=1379,n.gimel=1490,n.gimeldagesh=64306,n.gimeldageshhebrew=64306,n.gimelhebrew=1490,n.gjecyrillic=1107,n.glottalinvertedstroke=446,n.glottalstop=660,n.glottalstopinverted=662,n.glottalstopmod=704,n.glottalstopreversed=661,n.glottalstopreversedmod=705,n.glottalstopreversedsuperior=740,n.glottalstopstroke=673,n.glottalstopstrokereversed=674,n.gmacron=7713,n.gmonospace=65351,n.gohiragana=12372,n.gokatakana=12468,n.gparen=9378,n.gpasquare=13228,n.gradient=8711,n.grave=96,n.gravebelowcmb=790,n.gravecmb=768,n.gravecomb=768,n.gravedeva=2387,n.gravelowmod=718,n.gravemonospace=65344,n.gravetonecmb=832,n.greater=62,n.greaterequal=8805,n.greaterequalorless=8923,n.greatermonospace=65310,n.greaterorequivalent=8819,n.greaterorless=8823,n.greateroverequal=8807,n.greatersmall=65125,n.gscript=609,n.gstroke=485,n.guhiragana=12368,n.guillemotleft=171,n.guillemotright=187,n.guilsinglleft=8249,n.guilsinglright=8250,n.gukatakana=12464,n.guramusquare=13080,n.gysquare=13257,n.h=104,n.haabkhasiancyrillic=1193,n.haaltonearabic=1729,n.habengali=2489,n.hadescendercyrillic=1203,n.hadeva=2361,n.hagujarati=2745,n.hagurmukhi=2617,n.haharabic=1581,n.hahfinalarabic=65186,n.hahinitialarabic=65187,n.hahiragana=12399,n.hahmedialarabic=65188,n.haitusquare=13098,n.hakatakana=12495,n.hakatakanahalfwidth=65418,n.halantgurmukhi=2637,n.hamzaarabic=1569,n.hamzalowarabic=1569,n.hangulfiller=12644,n.hardsigncyrillic=1098,n.harpoonleftbarbup=8636,n.harpoonrightbarbup=8640,n.hasquare=13258,n.hatafpatah=1458,n.hatafpatah16=1458,n.hatafpatah23=1458,n.hatafpatah2f=1458,n.hatafpatahhebrew=1458,n.hatafpatahnarrowhebrew=1458,n.hatafpatahquarterhebrew=1458,n.hatafpatahwidehebrew=1458,n.hatafqamats=1459,n.hatafqamats1b=1459,n.hatafqamats28=1459,n.hatafqamats34=1459,n.hatafqamatshebrew=1459,n.hatafqamatsnarrowhebrew=1459,n.hatafqamatsquarterhebrew=1459,n.hatafqamatswidehebrew=1459,n.hatafsegol=1457,n.hatafsegol17=1457,n.hatafsegol24=1457,n.hatafsegol30=1457,n.hatafsegolhebrew=1457,n.hatafsegolnarrowhebrew=1457,n.hatafsegolquarterhebrew=1457,n.hatafsegolwidehebrew=1457,n.hbar=295,n.hbopomofo=12559,n.hbrevebelow=7723,n.hcedilla=7721,n.hcircle=9431,n.hcircumflex=293,n.hdieresis=7719,n.hdotaccent=7715,n.hdotbelow=7717,n.he=1492,n.heart=9829,n.heartsuitblack=9829,n.heartsuitwhite=9825,n.hedagesh=64308,n.hedageshhebrew=64308,n.hehaltonearabic=1729,n.heharabic=1607,n.hehebrew=1492,n.hehfinalaltonearabic=64423,n.hehfinalalttwoarabic=65258,n.hehfinalarabic=65258,n.hehhamzaabovefinalarabic=64421,n.hehhamzaaboveisolatedarabic=64420,n.hehinitialaltonearabic=64424,n.hehinitialarabic=65259,n.hehiragana=12408,n.hehmedialaltonearabic=64425,n.hehmedialarabic=65260,n.heiseierasquare=13179,n.hekatakana=12504,n.hekatakanahalfwidth=65421,n.hekutaarusquare=13110,n.henghook=615,n.herutusquare=13113,n.het=1495,n.hethebrew=1495,n.hhook=614,n.hhooksuperior=689,n.hieuhacirclekorean=12923,n.hieuhaparenkorean=12827,n.hieuhcirclekorean=12909,n.hieuhkorean=12622,n.hieuhparenkorean=12813,n.hihiragana=12402,n.hikatakana=12498,n.hikatakanahalfwidth=65419,n.hiriq=1460,n.hiriq14=1460,n.hiriq21=1460,n.hiriq2d=1460,n.hiriqhebrew=1460,n.hiriqnarrowhebrew=1460,n.hiriqquarterhebrew=1460,n.hiriqwidehebrew=1460,n.hlinebelow=7830,n.hmonospace=65352,n.hoarmenian=1392,n.hohipthai=3627,n.hohiragana=12411,n.hokatakana=12507,n.hokatakanahalfwidth=65422,n.holam=1465,n.holam19=1465,n.holam26=1465,n.holam32=1465,n.holamhebrew=1465,n.holamnarrowhebrew=1465,n.holamquarterhebrew=1465,n.holamwidehebrew=1465,n.honokhukthai=3630,n.hookabovecomb=777,n.hookcmb=777,n.hookpalatalizedbelowcmb=801,n.hookretroflexbelowcmb=802,n.hoonsquare=13122,n.horicoptic=1001,n.horizontalbar=8213,n.horncmb=795,n.hotsprings=9832,n.house=8962,n.hparen=9379,n.hsuperior=688,n.hturned=613,n.huhiragana=12405,n.huiitosquare=13107,n.hukatakana=12501,n.hukatakanahalfwidth=65420,n.hungarumlaut=733,n.hungarumlautcmb=779,n.hv=405,n.hyphen=45,n.hypheninferior=63205,n.hyphenmonospace=65293,n.hyphensmall=65123,n.hyphensuperior=63206,n.hyphentwo=8208,n.i=105,n.iacute=237,n.iacyrillic=1103,n.ibengali=2439,n.ibopomofo=12583,n.ibreve=301,n.icaron=464,n.icircle=9432,n.icircumflex=238,n.icyrillic=1110,n.idblgrave=521,n.ideographearthcircle=12943,n.ideographfirecircle=12939,n.ideographicallianceparen=12863,n.ideographiccallparen=12858,n.ideographiccentrecircle=12965,n.ideographicclose=12294,n.ideographiccomma=12289,n.ideographiccommaleft=65380,n.ideographiccongratulationparen=12855,n.ideographiccorrectcircle=12963,n.ideographicearthparen=12847,n.ideographicenterpriseparen=12861,n.ideographicexcellentcircle=12957,n.ideographicfestivalparen=12864,n.ideographicfinancialcircle=12950,n.ideographicfinancialparen=12854,n.ideographicfireparen=12843,n.ideographichaveparen=12850,n.ideographichighcircle=12964,n.ideographiciterationmark=12293,n.ideographiclaborcircle=12952,n.ideographiclaborparen=12856,n.ideographicleftcircle=12967,n.ideographiclowcircle=12966,n.ideographicmedicinecircle=12969,n.ideographicmetalparen=12846,n.ideographicmoonparen=12842,n.ideographicnameparen=12852,n.ideographicperiod=12290,n.ideographicprintcircle=12958,n.ideographicreachparen=12867,n.ideographicrepresentparen=12857,n.ideographicresourceparen=12862,n.ideographicrightcircle=12968,n.ideographicsecretcircle=12953,n.ideographicselfparen=12866,n.ideographicsocietyparen=12851,n.ideographicspace=12288,n.ideographicspecialparen=12853,n.ideographicstockparen=12849,n.ideographicstudyparen=12859,n.ideographicsunparen=12848,n.ideographicsuperviseparen=12860,n.ideographicwaterparen=12844,n.ideographicwoodparen=12845,n.ideographiczero=12295,n.ideographmetalcircle=12942,n.ideographmooncircle=12938,n.ideographnamecircle=12948,n.ideographsuncircle=12944,n.ideographwatercircle=12940,n.ideographwoodcircle=12941,n.ideva=2311,n.idieresis=239,n.idieresisacute=7727,n.idieresiscyrillic=1253,n.idotbelow=7883,n.iebrevecyrillic=1239,n.iecyrillic=1077,n.ieungacirclekorean=12917,n.ieungaparenkorean=12821,n.ieungcirclekorean=12903,n.ieungkorean=12615,n.ieungparenkorean=12807,n.igrave=236,n.igujarati=2695,n.igurmukhi=2567,n.ihiragana=12356,n.ihookabove=7881,n.iibengali=2440,n.iicyrillic=1080,n.iideva=2312,n.iigujarati=2696,n.iigurmukhi=2568,n.iimatragurmukhi=2624,n.iinvertedbreve=523,n.iishortcyrillic=1081,n.iivowelsignbengali=2496,n.iivowelsigndeva=2368,n.iivowelsigngujarati=2752,n.ij=307,n.ikatakana=12452,n.ikatakanahalfwidth=65394,n.ikorean=12643,n.ilde=732,n.iluyhebrew=1452,n.imacron=299,n.imacroncyrillic=1251,n.imageorapproximatelyequal=8787,n.imatragurmukhi=2623,n.imonospace=65353,n.increment=8710,n.infinity=8734,n.iniarmenian=1387,n.integral=8747,n.integralbottom=8993,n.integralbt=8993,n.integralex=63733,n.integraltop=8992,n.integraltp=8992,n.intersection=8745,n.intisquare=13061,n.invbullet=9688,n.invcircle=9689,n.invsmileface=9787,n.iocyrillic=1105,n.iogonek=303,n.iota=953,n.iotadieresis=970,n.iotadieresistonos=912,n.iotalatin=617,n.iotatonos=943,n.iparen=9380,n.irigurmukhi=2674,n.ismallhiragana=12355,n.ismallkatakana=12451,n.ismallkatakanahalfwidth=65384,n.issharbengali=2554,n.istroke=616,n.isuperior=63213,n.iterationhiragana=12445,n.iterationkatakana=12541,n.itilde=297,n.itildebelow=7725,n.iubopomofo=12585,n.iucyrillic=1102,n.ivowelsignbengali=2495,n.ivowelsigndeva=2367,n.ivowelsigngujarati=2751,n.izhitsacyrillic=1141,n.izhitsadblgravecyrillic=1143,n.j=106,n.jaarmenian=1393,n.jabengali=2460,n.jadeva=2332,n.jagujarati=2716,n.jagurmukhi=2588,n.jbopomofo=12560,n.jcaron=496,n.jcircle=9433,n.jcircumflex=309,n.jcrossedtail=669,n.jdotlessstroke=607,n.jecyrillic=1112,n.jeemarabic=1580,n.jeemfinalarabic=65182,n.jeeminitialarabic=65183,n.jeemmedialarabic=65184,n.jeharabic=1688,n.jehfinalarabic=64395,n.jhabengali=2461,n.jhadeva=2333,n.jhagujarati=2717,n.jhagurmukhi=2589,n.jheharmenian=1403,n.jis=12292,n.jmonospace=65354,n.jparen=9381,n.jsuperior=690,n.k=107,n.kabashkircyrillic=1185,n.kabengali=2453,n.kacute=7729,n.kacyrillic=1082,n.kadescendercyrillic=1179,n.kadeva=2325,n.kaf=1499,n.kafarabic=1603,n.kafdagesh=64315,n.kafdageshhebrew=64315,n.kaffinalarabic=65242,n.kafhebrew=1499,n.kafinitialarabic=65243,n.kafmedialarabic=65244,n.kafrafehebrew=64333,n.kagujarati=2709,n.kagurmukhi=2581,n.kahiragana=12363,n.kahookcyrillic=1220,n.kakatakana=12459,n.kakatakanahalfwidth=65398,n.kappa=954,n.kappasymbolgreek=1008,n.kapyeounmieumkorean=12657,n.kapyeounphieuphkorean=12676,n.kapyeounpieupkorean=12664,n.kapyeounssangpieupkorean=12665,n.karoriisquare=13069,n.kashidaautoarabic=1600,n.kashidaautonosidebearingarabic=1600,n.kasmallkatakana=12533,n.kasquare=13188,n.kasraarabic=1616,n.kasratanarabic=1613,n.kastrokecyrillic=1183,n.katahiraprolongmarkhalfwidth=65392,n.kaverticalstrokecyrillic=1181,n.kbopomofo=12558,n.kcalsquare=13193,n.kcaron=489,n.kcedilla=311,n.kcircle=9434,n.kcommaaccent=311,n.kdotbelow=7731,n.keharmenian=1412,n.kehiragana=12369,n.kekatakana=12465,n.kekatakanahalfwidth=65401,n.kenarmenian=1391,n.kesmallkatakana=12534,n.kgreenlandic=312,n.khabengali=2454,n.khacyrillic=1093,n.khadeva=2326,n.khagujarati=2710,n.khagurmukhi=2582,n.khaharabic=1582,n.khahfinalarabic=65190,n.khahinitialarabic=65191,n.khahmedialarabic=65192,n.kheicoptic=999,n.khhadeva=2393,n.khhagurmukhi=2649,n.khieukhacirclekorean=12920,n.khieukhaparenkorean=12824,n.khieukhcirclekorean=12906,n.khieukhkorean=12619,n.khieukhparenkorean=12810,n.khokhaithai=3586,n.khokhonthai=3589,n.khokhuatthai=3587,n.khokhwaithai=3588,n.khomutthai=3675,n.khook=409,n.khorakhangthai=3590,n.khzsquare=13201,n.kihiragana=12365,n.kikatakana=12461,n.kikatakanahalfwidth=65399,n.kiroguramusquare=13077,n.kiromeetorusquare=13078,n.kirosquare=13076,n.kiyeokacirclekorean=12910,n.kiyeokaparenkorean=12814,n.kiyeokcirclekorean=12896,n.kiyeokkorean=12593,n.kiyeokparenkorean=12800,n.kiyeoksioskorean=12595,n.kjecyrillic=1116,n.klinebelow=7733,n.klsquare=13208,n.kmcubedsquare=13222,n.kmonospace=65355,n.kmsquaredsquare=13218,n.kohiragana=12371,n.kohmsquare=13248,n.kokaithai=3585,n.kokatakana=12467,n.kokatakanahalfwidth=65402,n.kooposquare=13086,n.koppacyrillic=1153,n.koreanstandardsymbol=12927,n.koroniscmb=835,n.kparen=9382,n.kpasquare=13226,n.ksicyrillic=1135,n.ktsquare=13263,n.kturned=670,n.kuhiragana=12367,n.kukatakana=12463,n.kukatakanahalfwidth=65400,n.kvsquare=13240,n.kwsquare=13246,n.l=108,n.labengali=2482,n.lacute=314,n.ladeva=2354,n.lagujarati=2738,n.lagurmukhi=2610,n.lakkhangyaothai=3653,n.lamaleffinalarabic=65276,n.lamalefhamzaabovefinalarabic=65272,n.lamalefhamzaaboveisolatedarabic=65271,n.lamalefhamzabelowfinalarabic=65274,n.lamalefhamzabelowisolatedarabic=65273,n.lamalefisolatedarabic=65275,n.lamalefmaddaabovefinalarabic=65270,n.lamalefmaddaaboveisolatedarabic=65269,n.lamarabic=1604,n.lambda=955,n.lambdastroke=411,n.lamed=1500,n.lameddagesh=64316,n.lameddageshhebrew=64316,n.lamedhebrew=1500,n.lamfinalarabic=65246,n.lamhahinitialarabic=64714,n.laminitialarabic=65247,n.lamjeeminitialarabic=64713,n.lamkhahinitialarabic=64715,n.lamlamhehisolatedarabic=65010,n.lammedialarabic=65248,n.lammeemhahinitialarabic=64904,n.lammeeminitialarabic=64716,n.largecircle=9711,n.lbar=410,n.lbelt=620,n.lbopomofo=12556,n.lcaron=318,n.lcedilla=316,n.lcircle=9435,n.lcircumflexbelow=7741,n.lcommaaccent=316,n.ldot=320,n.ldotaccent=320,n.ldotbelow=7735,n.ldotbelowmacron=7737,n.leftangleabovecmb=794,n.lefttackbelowcmb=792,n.less=60,n.lessequal=8804,n.lessequalorgreater=8922,n.lessmonospace=65308,n.lessorequivalent=8818,n.lessorgreater=8822,n.lessoverequal=8806,n.lesssmall=65124,n.lezh=622,n.lfblock=9612,n.lhookretroflex=621,n.lira=8356,n.liwnarmenian=1388,n.lj=457,n.ljecyrillic=1113,n.ll=63168,n.lladeva=2355,n.llagujarati=2739,n.llinebelow=7739,n.llladeva=2356,n.llvocalicbengali=2529,n.llvocalicdeva=2401,n.llvocalicvowelsignbengali=2531,n.llvocalicvowelsigndeva=2403,n.lmiddletilde=619,n.lmonospace=65356,n.lmsquare=13264,n.lochulathai=3628,n.logicaland=8743,n.logicalnot=172,n.logicalnotreversed=8976,n.logicalor=8744,n.lolingthai=3621,n.longs=383,n.lowlinecenterline=65102,n.lowlinecmb=818,n.lowlinedashed=65101,n.lozenge=9674,n.lparen=9383,n.lslash=322,n.lsquare=8467,n.lsuperior=63214,n.ltshade=9617,n.luthai=3622,n.lvocalicbengali=2444,n.lvocalicdeva=2316,n.lvocalicvowelsignbengali=2530,n.lvocalicvowelsigndeva=2402,n.lxsquare=13267,n.m=109,n.mabengali=2478,n.macron=175,n.macronbelowcmb=817,n.macroncmb=772,n.macronlowmod=717,n.macronmonospace=65507,n.macute=7743,n.madeva=2350,n.magujarati=2734,n.magurmukhi=2606,n.mahapakhhebrew=1444,n.mahapakhlefthebrew=1444,n.mahiragana=12414,n.maichattawalowleftthai=63637,n.maichattawalowrightthai=63636,n.maichattawathai=3659,n.maichattawaupperleftthai=63635,n.maieklowleftthai=63628,n.maieklowrightthai=63627,n.maiekthai=3656,n.maiekupperleftthai=63626,n.maihanakatleftthai=63620,n.maihanakatthai=3633,n.maitaikhuleftthai=63625,n.maitaikhuthai=3655,n.maitholowleftthai=63631,n.maitholowrightthai=63630,n.maithothai=3657,n.maithoupperleftthai=63629,n.maitrilowleftthai=63634,n.maitrilowrightthai=63633,n.maitrithai=3658,n.maitriupperleftthai=63632,n.maiyamokthai=3654,n.makatakana=12510,n.makatakanahalfwidth=65423,n.male=9794,n.mansyonsquare=13127,n.maqafhebrew=1470,n.mars=9794,n.masoracirclehebrew=1455,n.masquare=13187,n.mbopomofo=12551,n.mbsquare=13268,n.mcircle=9436,n.mcubedsquare=13221,n.mdotaccent=7745,n.mdotbelow=7747,n.meemarabic=1605,n.meemfinalarabic=65250,n.meeminitialarabic=65251,n.meemmedialarabic=65252,n.meemmeeminitialarabic=64721,n.meemmeemisolatedarabic=64584,n.meetorusquare=13133,n.mehiragana=12417,n.meizierasquare=13182,n.mekatakana=12513,n.mekatakanahalfwidth=65426,n.mem=1502,n.memdagesh=64318,n.memdageshhebrew=64318,n.memhebrew=1502,n.menarmenian=1396,n.merkhahebrew=1445,n.merkhakefulahebrew=1446,n.merkhakefulalefthebrew=1446,n.merkhalefthebrew=1445,n.mhook=625,n.mhzsquare=13202,n.middledotkatakanahalfwidth=65381,n.middot=183,n.mieumacirclekorean=12914,n.mieumaparenkorean=12818,n.mieumcirclekorean=12900,n.mieumkorean=12609,n.mieumpansioskorean=12656,n.mieumparenkorean=12804,n.mieumpieupkorean=12654,n.mieumsioskorean=12655,n.mihiragana=12415,n.mikatakana=12511,n.mikatakanahalfwidth=65424,n.minus=8722,n.minusbelowcmb=800,n.minuscircle=8854,n.minusmod=727,n.minusplus=8723,n.minute=8242,n.miribaarusquare=13130,n.mirisquare=13129,n.mlonglegturned=624,n.mlsquare=13206,n.mmcubedsquare=13219,n.mmonospace=65357,n.mmsquaredsquare=13215,n.mohiragana=12418,n.mohmsquare=13249,n.mokatakana=12514,n.mokatakanahalfwidth=65427,n.molsquare=13270,n.momathai=3617,n.moverssquare=13223,n.moverssquaredsquare=13224,n.mparen=9384,n.mpasquare=13227,n.mssquare=13235,n.msuperior=63215,n.mturned=623,n.mu=181,n.mu1=181,n.muasquare=13186,n.muchgreater=8811,n.muchless=8810,n.mufsquare=13196,n.mugreek=956,n.mugsquare=13197,n.muhiragana=12416,n.mukatakana=12512,n.mukatakanahalfwidth=65425,n.mulsquare=13205,n.multiply=215,n.mumsquare=13211,n.munahhebrew=1443,n.munahlefthebrew=1443,n.musicalnote=9834,n.musicalnotedbl=9835,n.musicflatsign=9837,n.musicsharpsign=9839,n.mussquare=13234,n.muvsquare=13238,n.muwsquare=13244,n.mvmegasquare=13241,n.mvsquare=13239,n.mwmegasquare=13247,n.mwsquare=13245,n.n=110,n.nabengali=2472,n.nabla=8711,n.nacute=324,n.nadeva=2344,n.nagujarati=2728,n.nagurmukhi=2600,n.nahiragana=12394,n.nakatakana=12490,n.nakatakanahalfwidth=65413,n.napostrophe=329,n.nasquare=13185,n.nbopomofo=12555,n.nbspace=160,n.ncaron=328,n.ncedilla=326,n.ncircle=9437,n.ncircumflexbelow=7755,n.ncommaaccent=326,n.ndotaccent=7749,n.ndotbelow=7751,n.nehiragana=12397,n.nekatakana=12493,n.nekatakanahalfwidth=65416,n.newsheqelsign=8362,n.nfsquare=13195,n.ngabengali=2457,n.ngadeva=2329,n.ngagujarati=2713,n.ngagurmukhi=2585,n.ngonguthai=3591,n.nhiragana=12435,n.nhookleft=626,n.nhookretroflex=627,n.nieunacirclekorean=12911,n.nieunaparenkorean=12815,n.nieuncieuckorean=12597,n.nieuncirclekorean=12897,n.nieunhieuhkorean=12598,n.nieunkorean=12596,n.nieunpansioskorean=12648,n.nieunparenkorean=12801,n.nieunsioskorean=12647,n.nieuntikeutkorean=12646,n.nihiragana=12395,n.nikatakana=12491,n.nikatakanahalfwidth=65414,n.nikhahitleftthai=63641,n.nikhahitthai=3661,n.nine=57,n.ninearabic=1641,n.ninebengali=2543,n.ninecircle=9320,n.ninecircleinversesansserif=10130,n.ninedeva=2415,n.ninegujarati=2799,n.ninegurmukhi=2671,n.ninehackarabic=1641,n.ninehangzhou=12329,n.nineideographicparen=12840,n.nineinferior=8329,n.ninemonospace=65305,n.nineoldstyle=63289,n.nineparen=9340,n.nineperiod=9360,n.ninepersian=1785,n.nineroman=8568,n.ninesuperior=8313,n.nineteencircle=9330,n.nineteenparen=9350,n.nineteenperiod=9370,n.ninethai=3673,n.nj=460,n.njecyrillic=1114,n.nkatakana=12531,n.nkatakanahalfwidth=65437,n.nlegrightlong=414,n.nlinebelow=7753,n.nmonospace=65358,n.nmsquare=13210,n.nnabengali=2467,n.nnadeva=2339,n.nnagujarati=2723,n.nnagurmukhi=2595,n.nnnadeva=2345,n.nohiragana=12398,n.nokatakana=12494,n.nokatakanahalfwidth=65417,n.nonbreakingspace=160,n.nonenthai=3603,n.nonuthai=3609,n.noonarabic=1606,n.noonfinalarabic=65254,n.noonghunnaarabic=1722,n.noonghunnafinalarabic=64415,n.nooninitialarabic=65255,n.noonjeeminitialarabic=64722,n.noonjeemisolatedarabic=64587,n.noonmedialarabic=65256,n.noonmeeminitialarabic=64725,n.noonmeemisolatedarabic=64590,n.noonnoonfinalarabic=64653,n.notcontains=8716,n.notelement=8713,n.notelementof=8713,n.notequal=8800,n.notgreater=8815,n.notgreaternorequal=8817,n.notgreaternorless=8825,n.notidentical=8802,n.notless=8814,n.notlessnorequal=8816,n.notparallel=8742,n.notprecedes=8832,n.notsubset=8836,n.notsucceeds=8833,n.notsuperset=8837,n.nowarmenian=1398,n.nparen=9385,n.nssquare=13233,n.nsuperior=8319,n.ntilde=241,n.nu=957,n.nuhiragana=12396,n.nukatakana=12492,n.nukatakanahalfwidth=65415,n.nuktabengali=2492,n.nuktadeva=2364,n.nuktagujarati=2748,n.nuktagurmukhi=2620,n.numbersign=35,n.numbersignmonospace=65283,n.numbersignsmall=65119,n.numeralsigngreek=884,n.numeralsignlowergreek=885,n.numero=8470,n.nun=1504,n.nundagesh=64320,n.nundageshhebrew=64320,n.nunhebrew=1504,n.nvsquare=13237,n.nwsquare=13243,n.nyabengali=2462,n.nyadeva=2334,n.nyagujarati=2718,n.nyagurmukhi=2590,n.o=111,n.oacute=243,n.oangthai=3629,n.obarred=629,n.obarredcyrillic=1257,n.obarreddieresiscyrillic=1259,n.obengali=2451,n.obopomofo=12571,n.obreve=335,n.ocandradeva=2321,n.ocandragujarati=2705,n.ocandravowelsigndeva=2377,n.ocandravowelsigngujarati=2761,n.ocaron=466,n.ocircle=9438,n.ocircumflex=244,n.ocircumflexacute=7889,n.ocircumflexdotbelow=7897,n.ocircumflexgrave=7891,n.ocircumflexhookabove=7893,n.ocircumflextilde=7895,n.ocyrillic=1086,n.odblacute=337,n.odblgrave=525,n.odeva=2323,n.odieresis=246,n.odieresiscyrillic=1255,n.odotbelow=7885,n.oe=339,n.oekorean=12634,n.ogonek=731,n.ogonekcmb=808,n.ograve=242,n.ogujarati=2707,n.oharmenian=1413,n.ohiragana=12362,n.ohookabove=7887,n.ohorn=417,n.ohornacute=7899,n.ohorndotbelow=7907,n.ohorngrave=7901,n.ohornhookabove=7903,n.ohorntilde=7905,n.ohungarumlaut=337,n.oi=419,n.oinvertedbreve=527,n.okatakana=12458,n.okatakanahalfwidth=65397,n.okorean=12631,n.olehebrew=1451,n.omacron=333,n.omacronacute=7763,n.omacrongrave=7761,n.omdeva=2384,n.omega=969,n.omega1=982,n.omegacyrillic=1121,n.omegalatinclosed=631,n.omegaroundcyrillic=1147,n.omegatitlocyrillic=1149,n.omegatonos=974,n.omgujarati=2768,n.omicron=959,n.omicrontonos=972,n.omonospace=65359,n.one=49,n.onearabic=1633,n.onebengali=2535,n.onecircle=9312,n.onecircleinversesansserif=10122,n.onedeva=2407,n.onedotenleader=8228,n.oneeighth=8539,n.onefitted=63196,n.onegujarati=2791,n.onegurmukhi=2663,n.onehackarabic=1633,n.onehalf=189,n.onehangzhou=12321,n.oneideographicparen=12832,n.oneinferior=8321,n.onemonospace=65297,n.onenumeratorbengali=2548,n.oneoldstyle=63281,n.oneparen=9332,n.oneperiod=9352,n.onepersian=1777,n.onequarter=188,n.oneroman=8560,n.onesuperior=185,n.onethai=3665,n.onethird=8531,n.oogonek=491,n.oogonekmacron=493,n.oogurmukhi=2579,n.oomatragurmukhi=2635,n.oopen=596,n.oparen=9386,n.openbullet=9702,n.option=8997,n.ordfeminine=170,n.ordmasculine=186,n.orthogonal=8735,n.oshortdeva=2322,n.oshortvowelsigndeva=2378,n.oslash=248,n.oslashacute=511,n.osmallhiragana=12361,n.osmallkatakana=12457,n.osmallkatakanahalfwidth=65387,n.ostrokeacute=511,n.osuperior=63216,n.otcyrillic=1151,n.otilde=245,n.otildeacute=7757,n.otildedieresis=7759,n.oubopomofo=12577,n.overline=8254,n.overlinecenterline=65098,n.overlinecmb=773,n.overlinedashed=65097,n.overlinedblwavy=65100,n.overlinewavy=65099,n.overscore=175,n.ovowelsignbengali=2507,n.ovowelsigndeva=2379,n.ovowelsigngujarati=2763,n.p=112,n.paampssquare=13184,n.paasentosquare=13099,n.pabengali=2474,n.pacute=7765,n.padeva=2346,n.pagedown=8671,n.pageup=8670,n.pagujarati=2730,n.pagurmukhi=2602,n.pahiragana=12401,n.paiyannoithai=3631,n.pakatakana=12497,n.palatalizationcyrilliccmb=1156,n.palochkacyrillic=1216,n.pansioskorean=12671,n.paragraph=182,n.parallel=8741,n.parenleft=40,n.parenleftaltonearabic=64830,n.parenleftbt=63725,n.parenleftex=63724,n.parenleftinferior=8333,n.parenleftmonospace=65288,n.parenleftsmall=65113,n.parenleftsuperior=8317,n.parenlefttp=63723,n.parenleftvertical=65077,n.parenright=41,n.parenrightaltonearabic=64831,n.parenrightbt=63736,n.parenrightex=63735,n.parenrightinferior=8334,n.parenrightmonospace=65289,n.parenrightsmall=65114,n.parenrightsuperior=8318,n.parenrighttp=63734,n.parenrightvertical=65078,n.partialdiff=8706,n.paseqhebrew=1472,n.pashtahebrew=1433,n.pasquare=13225,n.patah=1463,n.patah11=1463,n.patah1d=1463,n.patah2a=1463,n.patahhebrew=1463,n.patahnarrowhebrew=1463,n.patahquarterhebrew=1463,n.patahwidehebrew=1463,n.pazerhebrew=1441,n.pbopomofo=12550,n.pcircle=9439,n.pdotaccent=7767,n.pe=1508,n.pecyrillic=1087,n.pedagesh=64324,n.pedageshhebrew=64324,n.peezisquare=13115,n.pefinaldageshhebrew=64323,n.peharabic=1662,n.peharmenian=1402,n.pehebrew=1508,n.pehfinalarabic=64343,n.pehinitialarabic=64344,n.pehiragana=12410,n.pehmedialarabic=64345,n.pekatakana=12506,n.pemiddlehookcyrillic=1191,n.perafehebrew=64334,n.percent=37,n.percentarabic=1642,n.percentmonospace=65285,n.percentsmall=65130,n.period=46,n.periodarmenian=1417,n.periodcentered=183,n.periodhalfwidth=65377,n.periodinferior=63207,n.periodmonospace=65294,n.periodsmall=65106,n.periodsuperior=63208,n.perispomenigreekcmb=834,n.perpendicular=8869,n.perthousand=8240,n.peseta=8359,n.pfsquare=13194,n.phabengali=2475,n.phadeva=2347,n.phagujarati=2731,n.phagurmukhi=2603,n.phi=966,n.phi1=981,n.phieuphacirclekorean=12922,n.phieuphaparenkorean=12826,n.phieuphcirclekorean=12908,n.phieuphkorean=12621,n.phieuphparenkorean=12812,n.philatin=632,n.phinthuthai=3642,n.phisymbolgreek=981,n.phook=421,n.phophanthai=3614,n.phophungthai=3612,n.phosamphaothai=3616,n.pi=960,n.pieupacirclekorean=12915,n.pieupaparenkorean=12819,n.pieupcieuckorean=12662,n.pieupcirclekorean=12901,n.pieupkiyeokkorean=12658,n.pieupkorean=12610,n.pieupparenkorean=12805,n.pieupsioskiyeokkorean=12660,n.pieupsioskorean=12612,n.pieupsiostikeutkorean=12661,n.pieupthieuthkorean=12663,n.pieuptikeutkorean=12659,n.pihiragana=12404,n.pikatakana=12500,n.pisymbolgreek=982,n.piwrarmenian=1411,n.planckover2pi=8463,n.planckover2pi1=8463,n.plus=43,n.plusbelowcmb=799,n.pluscircle=8853,n.plusminus=177,n.plusmod=726,n.plusmonospace=65291,n.plussmall=65122,n.plussuperior=8314,n.pmonospace=65360,n.pmsquare=13272,n.pohiragana=12413,n.pointingindexdownwhite=9759,n.pointingindexleftwhite=9756,n.pointingindexrightwhite=9758,n.pointingindexupwhite=9757,n.pokatakana=12509,n.poplathai=3611,n.postalmark=12306,n.postalmarkface=12320,n.pparen=9387,n.precedes=8826,n.prescription=8478,n.primemod=697,n.primereversed=8245,n.product=8719,n.projective=8965,n.prolongedkana=12540,n.propellor=8984,n.propersubset=8834,n.propersuperset=8835,n.proportion=8759,n.proportional=8733,n.psi=968,n.psicyrillic=1137,n.psilipneumatacyrilliccmb=1158,n.pssquare=13232,n.puhiragana=12407,n.pukatakana=12503,n.pvsquare=13236,n.pwsquare=13242,n.q=113,n.qadeva=2392,n.qadmahebrew=1448,n.qafarabic=1602,n.qaffinalarabic=65238,n.qafinitialarabic=65239,n.qafmedialarabic=65240,n.qamats=1464,n.qamats10=1464,n.qamats1a=1464,n.qamats1c=1464,n.qamats27=1464,n.qamats29=1464,n.qamats33=1464,n.qamatsde=1464,n.qamatshebrew=1464,n.qamatsnarrowhebrew=1464,n.qamatsqatanhebrew=1464,n.qamatsqatannarrowhebrew=1464,n.qamatsqatanquarterhebrew=1464,n.qamatsqatanwidehebrew=1464,n.qamatsquarterhebrew=1464,n.qamatswidehebrew=1464,n.qarneyparahebrew=1439,n.qbopomofo=12561,n.qcircle=9440,n.qhook=672,n.qmonospace=65361,n.qof=1511,n.qofdagesh=64327,n.qofdageshhebrew=64327,n.qofhebrew=1511,n.qparen=9388,n.quarternote=9833,n.qubuts=1467,n.qubuts18=1467,n.qubuts25=1467,n.qubuts31=1467,n.qubutshebrew=1467,n.qubutsnarrowhebrew=1467,n.qubutsquarterhebrew=1467,n.qubutswidehebrew=1467,n.question=63,n.questionarabic=1567,n.questionarmenian=1374,n.questiondown=191,n.questiondownsmall=63423,n.questiongreek=894,n.questionmonospace=65311,n.questionsmall=63295,n.quotedbl=34,n.quotedblbase=8222,n.quotedblleft=8220,n.quotedblmonospace=65282,n.quotedblprime=12318,n.quotedblprimereversed=12317,n.quotedblright=8221,n.quoteleft=8216,n.quoteleftreversed=8219,n.quotereversed=8219,n.quoteright=8217,n.quoterightn=329,n.quotesinglbase=8218,n.quotesingle=39,n.quotesinglemonospace=65287,n.r=114,n.raarmenian=1404,n.rabengali=2480,n.racute=341,n.radeva=2352,n.radical=8730,n.radicalex=63717,n.radoverssquare=13230,n.radoverssquaredsquare=13231,n.radsquare=13229,n.rafe=1471,n.rafehebrew=1471,n.ragujarati=2736,n.ragurmukhi=2608,n.rahiragana=12425,n.rakatakana=12521,n.rakatakanahalfwidth=65431,n.ralowerdiagonalbengali=2545,n.ramiddlediagonalbengali=2544,n.ramshorn=612,n.ratio=8758,n.rbopomofo=12566,n.rcaron=345,n.rcedilla=343,n.rcircle=9441,n.rcommaaccent=343,n.rdblgrave=529,n.rdotaccent=7769,n.rdotbelow=7771,n.rdotbelowmacron=7773,n.referencemark=8251,n.reflexsubset=8838,n.reflexsuperset=8839,n.registered=174,n.registersans=63720,n.registerserif=63194,n.reharabic=1585,n.reharmenian=1408,n.rehfinalarabic=65198,n.rehiragana=12428,n.rekatakana=12524,n.rekatakanahalfwidth=65434,n.resh=1512,n.reshdageshhebrew=64328,n.reshhebrew=1512,n.reversedtilde=8765,n.reviahebrew=1431,n.reviamugrashhebrew=1431,n.revlogicalnot=8976,n.rfishhook=638,n.rfishhookreversed=639,n.rhabengali=2525,n.rhadeva=2397,n.rho=961,n.rhook=637,n.rhookturned=635,n.rhookturnedsuperior=693,n.rhosymbolgreek=1009,n.rhotichookmod=734,n.rieulacirclekorean=12913,n.rieulaparenkorean=12817,n.rieulcirclekorean=12899,n.rieulhieuhkorean=12608,n.rieulkiyeokkorean=12602,n.rieulkiyeoksioskorean=12649,n.rieulkorean=12601,n.rieulmieumkorean=12603,n.rieulpansioskorean=12652,n.rieulparenkorean=12803,n.rieulphieuphkorean=12607,n.rieulpieupkorean=12604,n.rieulpieupsioskorean=12651,n.rieulsioskorean=12605,n.rieulthieuthkorean=12606,n.rieultikeutkorean=12650,n.rieulyeorinhieuhkorean=12653,n.rightangle=8735,n.righttackbelowcmb=793,n.righttriangle=8895,n.rihiragana=12426,n.rikatakana=12522,n.rikatakanahalfwidth=65432,n.ring=730,n.ringbelowcmb=805,n.ringcmb=778,n.ringhalfleft=703,n.ringhalfleftarmenian=1369,n.ringhalfleftbelowcmb=796,n.ringhalfleftcentered=723,n.ringhalfright=702,n.ringhalfrightbelowcmb=825,n.ringhalfrightcentered=722,n.rinvertedbreve=531,n.rittorusquare=13137,n.rlinebelow=7775,n.rlongleg=636,n.rlonglegturned=634,n.rmonospace=65362,n.rohiragana=12429,n.rokatakana=12525,n.rokatakanahalfwidth=65435,n.roruathai=3619,n.rparen=9389,n.rrabengali=2524,n.rradeva=2353,n.rragurmukhi=2652,n.rreharabic=1681,n.rrehfinalarabic=64397,n.rrvocalicbengali=2528,n.rrvocalicdeva=2400,n.rrvocalicgujarati=2784,n.rrvocalicvowelsignbengali=2500,n.rrvocalicvowelsigndeva=2372,n.rrvocalicvowelsigngujarati=2756,n.rsuperior=63217,n.rtblock=9616,n.rturned=633,n.rturnedsuperior=692,n.ruhiragana=12427,n.rukatakana=12523,n.rukatakanahalfwidth=65433,n.rupeemarkbengali=2546,n.rupeesignbengali=2547,n.rupiah=63197,n.ruthai=3620,n.rvocalicbengali=2443,n.rvocalicdeva=2315,n.rvocalicgujarati=2699,n.rvocalicvowelsignbengali=2499,n.rvocalicvowelsigndeva=2371,n.rvocalicvowelsigngujarati=2755,n.s=115,n.sabengali=2488,n.sacute=347,n.sacutedotaccent=7781,n.sadarabic=1589,n.sadeva=2360,n.sadfinalarabic=65210,n.sadinitialarabic=65211,n.sadmedialarabic=65212,n.sagujarati=2744,n.sagurmukhi=2616,n.sahiragana=12373,n.sakatakana=12469,n.sakatakanahalfwidth=65403,n.sallallahoualayhewasallamarabic=65018,n.samekh=1505,n.samekhdagesh=64321,n.samekhdageshhebrew=64321,n.samekhhebrew=1505,n.saraaathai=3634,n.saraaethai=3649,n.saraaimaimalaithai=3652,n.saraaimaimuanthai=3651,n.saraamthai=3635,n.saraathai=3632,n.saraethai=3648,n.saraiileftthai=63622,n.saraiithai=3637,n.saraileftthai=63621,n.saraithai=3636,n.saraothai=3650,n.saraueeleftthai=63624,n.saraueethai=3639,n.saraueleftthai=63623,n.sarauethai=3638,n.sarauthai=3640,n.sarauuthai=3641,n.sbopomofo=12569,n.scaron=353,n.scarondotaccent=7783,n.scedilla=351,n.schwa=601,n.schwacyrillic=1241,n.schwadieresiscyrillic=1243,n.schwahook=602,n.scircle=9442,n.scircumflex=349,n.scommaaccent=537,n.sdotaccent=7777,n.sdotbelow=7779,n.sdotbelowdotaccent=7785,n.seagullbelowcmb=828,n.second=8243,n.secondtonechinese=714,n.section=167,n.seenarabic=1587,n.seenfinalarabic=65202,n.seeninitialarabic=65203,n.seenmedialarabic=65204,n.segol=1462,n.segol13=1462,n.segol1f=1462,n.segol2c=1462,n.segolhebrew=1462,n.segolnarrowhebrew=1462,n.segolquarterhebrew=1462,n.segoltahebrew=1426,n.segolwidehebrew=1462,n.seharmenian=1405,n.sehiragana=12379,n.sekatakana=12475,n.sekatakanahalfwidth=65406,n.semicolon=59,n.semicolonarabic=1563,n.semicolonmonospace=65307,n.semicolonsmall=65108,n.semivoicedmarkkana=12444,n.semivoicedmarkkanahalfwidth=65439,n.sentisquare=13090,n.sentosquare=13091,n.seven=55,n.sevenarabic=1639,n.sevenbengali=2541,n.sevencircle=9318,n.sevencircleinversesansserif=10128,n.sevendeva=2413,n.seveneighths=8542,n.sevengujarati=2797,n.sevengurmukhi=2669,n.sevenhackarabic=1639,n.sevenhangzhou=12327,n.sevenideographicparen=12838,n.seveninferior=8327,n.sevenmonospace=65303,n.sevenoldstyle=63287,n.sevenparen=9338,n.sevenperiod=9358,n.sevenpersian=1783,n.sevenroman=8566,n.sevensuperior=8311,n.seventeencircle=9328,n.seventeenparen=9348,n.seventeenperiod=9368,n.seventhai=3671,n.sfthyphen=173,n.shaarmenian=1399,n.shabengali=2486,n.shacyrillic=1096,n.shaddaarabic=1617,n.shaddadammaarabic=64609,n.shaddadammatanarabic=64606,n.shaddafathaarabic=64608,n.shaddakasraarabic=64610,n.shaddakasratanarabic=64607,n.shade=9618,n.shadedark=9619,n.shadelight=9617,n.shademedium=9618,n.shadeva=2358,n.shagujarati=2742,n.shagurmukhi=2614,n.shalshelethebrew=1427,n.shbopomofo=12565,n.shchacyrillic=1097,n.sheenarabic=1588,n.sheenfinalarabic=65206,n.sheeninitialarabic=65207,n.sheenmedialarabic=65208,n.sheicoptic=995,n.sheqel=8362,n.sheqelhebrew=8362,n.sheva=1456,n.sheva115=1456,n.sheva15=1456,n.sheva22=1456,n.sheva2e=1456,n.shevahebrew=1456,n.shevanarrowhebrew=1456,n.shevaquarterhebrew=1456,n.shevawidehebrew=1456,n.shhacyrillic=1211,n.shimacoptic=1005,n.shin=1513,n.shindagesh=64329,n.shindageshhebrew=64329,n.shindageshshindot=64300,n.shindageshshindothebrew=64300,n.shindageshsindot=64301,n.shindageshsindothebrew=64301,n.shindothebrew=1473,n.shinhebrew=1513,n.shinshindot=64298,n.shinshindothebrew=64298,n.shinsindot=64299,n.shinsindothebrew=64299,n.shook=642,n.sigma=963,n.sigma1=962,n.sigmafinal=962,n.sigmalunatesymbolgreek=1010,n.sihiragana=12375,n.sikatakana=12471,n.sikatakanahalfwidth=65404,n.siluqhebrew=1469,n.siluqlefthebrew=1469,n.similar=8764,n.sindothebrew=1474,n.siosacirclekorean=12916,n.siosaparenkorean=12820,n.sioscieuckorean=12670,n.sioscirclekorean=12902,n.sioskiyeokkorean=12666,n.sioskorean=12613,n.siosnieunkorean=12667,n.siosparenkorean=12806,n.siospieupkorean=12669,n.siostikeutkorean=12668,n.six=54,n.sixarabic=1638,n.sixbengali=2540,n.sixcircle=9317,n.sixcircleinversesansserif=10127,n.sixdeva=2412,n.sixgujarati=2796,n.sixgurmukhi=2668,n.sixhackarabic=1638,n.sixhangzhou=12326,n.sixideographicparen=12837,n.sixinferior=8326,n.sixmonospace=65302,n.sixoldstyle=63286,n.sixparen=9337,n.sixperiod=9357,n.sixpersian=1782,n.sixroman=8565,n.sixsuperior=8310,n.sixteencircle=9327,n.sixteencurrencydenominatorbengali=2553,n.sixteenparen=9347,n.sixteenperiod=9367,n.sixthai=3670,n.slash=47,n.slashmonospace=65295,n.slong=383,n.slongdotaccent=7835,n.smileface=9786,n.smonospace=65363,n.sofpasuqhebrew=1475,n.softhyphen=173,n.softsigncyrillic=1100,n.sohiragana=12381,n.sokatakana=12477,n.sokatakanahalfwidth=65407,n.soliduslongoverlaycmb=824,n.solidusshortoverlaycmb=823,n.sorusithai=3625,n.sosalathai=3624,n.sosothai=3595,n.sosuathai=3626,n.space=32,n.spacehackarabic=32,n.spade=9824,n.spadesuitblack=9824,n.spadesuitwhite=9828,n.sparen=9390,n.squarebelowcmb=827,n.squarecc=13252,n.squarecm=13213,n.squarediagonalcrosshatchfill=9641,n.squarehorizontalfill=9636,n.squarekg=13199,n.squarekm=13214,n.squarekmcapital=13262,n.squareln=13265,n.squarelog=13266,n.squaremg=13198,n.squaremil=13269,n.squaremm=13212,n.squaremsquared=13217,n.squareorthogonalcrosshatchfill=9638,n.squareupperlefttolowerrightfill=9639,n.squareupperrighttolowerleftfill=9640,n.squareverticalfill=9637,n.squarewhitewithsmallblack=9635,n.srsquare=13275,n.ssabengali=2487,n.ssadeva=2359,n.ssagujarati=2743,n.ssangcieuckorean=12617,n.ssanghieuhkorean=12677,n.ssangieungkorean=12672,n.ssangkiyeokkorean=12594,n.ssangnieunkorean=12645,n.ssangpieupkorean=12611,n.ssangsioskorean=12614,n.ssangtikeutkorean=12600,n.ssuperior=63218,n.sterling=163,n.sterlingmonospace=65505,n.strokelongoverlaycmb=822,n.strokeshortoverlaycmb=821,n.subset=8834,n.subsetnotequal=8842,n.subsetorequal=8838,n.succeeds=8827,n.suchthat=8715,n.suhiragana=12377,n.sukatakana=12473,n.sukatakanahalfwidth=65405,n.sukunarabic=1618,n.summation=8721,n.sun=9788,n.superset=8835,n.supersetnotequal=8843,n.supersetorequal=8839,n.svsquare=13276,n.syouwaerasquare=13180,n.t=116,n.tabengali=2468,n.tackdown=8868,n.tackleft=8867,n.tadeva=2340,n.tagujarati=2724,n.tagurmukhi=2596,n.taharabic=1591,n.tahfinalarabic=65218,n.tahinitialarabic=65219,n.tahiragana=12383,n.tahmedialarabic=65220,n.taisyouerasquare=13181,n.takatakana=12479,n.takatakanahalfwidth=65408,n.tatweelarabic=1600,n.tau=964,n.tav=1514,n.tavdages=64330,n.tavdagesh=64330,n.tavdageshhebrew=64330,n.tavhebrew=1514,n.tbar=359,n.tbopomofo=12554,n.tcaron=357,n.tccurl=680,n.tcedilla=355,n.tcheharabic=1670,n.tchehfinalarabic=64379,n.tchehinitialarabic=64380,n.tchehmedialarabic=64381,n.tcircle=9443,n.tcircumflexbelow=7793,n.tcommaaccent=355,n.tdieresis=7831,n.tdotaccent=7787,n.tdotbelow=7789,n.tecyrillic=1090,n.tedescendercyrillic=1197,n.teharabic=1578,n.tehfinalarabic=65174,n.tehhahinitialarabic=64674,n.tehhahisolatedarabic=64524,n.tehinitialarabic=65175,n.tehiragana=12390,n.tehjeeminitialarabic=64673,n.tehjeemisolatedarabic=64523,n.tehmarbutaarabic=1577,n.tehmarbutafinalarabic=65172,n.tehmedialarabic=65176,n.tehmeeminitialarabic=64676,n.tehmeemisolatedarabic=64526,n.tehnoonfinalarabic=64627,n.tekatakana=12486,n.tekatakanahalfwidth=65411,n.telephone=8481,n.telephoneblack=9742,n.telishagedolahebrew=1440,n.telishaqetanahebrew=1449,n.tencircle=9321,n.tenideographicparen=12841,n.tenparen=9341,n.tenperiod=9361,n.tenroman=8569,n.tesh=679,n.tet=1496,n.tetdagesh=64312,n.tetdageshhebrew=64312,n.tethebrew=1496,n.tetsecyrillic=1205,n.tevirhebrew=1435,n.tevirlefthebrew=1435,n.thabengali=2469,n.thadeva=2341,n.thagujarati=2725,n.thagurmukhi=2597,n.thalarabic=1584,n.thalfinalarabic=65196,n.thanthakhatlowleftthai=63640,n.thanthakhatlowrightthai=63639,n.thanthakhatthai=3660,n.thanthakhatupperleftthai=63638,n.theharabic=1579,n.thehfinalarabic=65178,n.thehinitialarabic=65179,n.thehmedialarabic=65180,n.thereexists=8707,n.therefore=8756,n.theta=952,n.theta1=977,n.thetasymbolgreek=977,n.thieuthacirclekorean=12921,n.thieuthaparenkorean=12825,n.thieuthcirclekorean=12907,n.thieuthkorean=12620,n.thieuthparenkorean=12811,n.thirteencircle=9324,n.thirteenparen=9344,n.thirteenperiod=9364,n.thonangmonthothai=3601,n.thook=429,n.thophuthaothai=3602,n.thorn=254,n.thothahanthai=3607,n.thothanthai=3600,n.thothongthai=3608,n.thothungthai=3606,n.thousandcyrillic=1154,n.thousandsseparatorarabic=1644,n.thousandsseparatorpersian=1644,n.three=51,n.threearabic=1635,n.threebengali=2537,n.threecircle=9314,n.threecircleinversesansserif=10124,n.threedeva=2409,n.threeeighths=8540,n.threegujarati=2793,n.threegurmukhi=2665,n.threehackarabic=1635,n.threehangzhou=12323,n.threeideographicparen=12834,n.threeinferior=8323,n.threemonospace=65299,n.threenumeratorbengali=2550,n.threeoldstyle=63283,n.threeparen=9334,n.threeperiod=9354,n.threepersian=1779,n.threequarters=190,n.threequartersemdash=63198,n.threeroman=8562,n.threesuperior=179,n.threethai=3667,n.thzsquare=13204,n.tihiragana=12385,n.tikatakana=12481,n.tikatakanahalfwidth=65409,n.tikeutacirclekorean=12912,n.tikeutaparenkorean=12816,n.tikeutcirclekorean=12898,n.tikeutkorean=12599,n.tikeutparenkorean=12802,n.tilde=732,n.tildebelowcmb=816,n.tildecmb=771,n.tildecomb=771,n.tildedoublecmb=864,n.tildeoperator=8764,n.tildeoverlaycmb=820,n.tildeverticalcmb=830,n.timescircle=8855,n.tipehahebrew=1430,n.tipehalefthebrew=1430,n.tippigurmukhi=2672,n.titlocyrilliccmb=1155,n.tiwnarmenian=1407,n.tlinebelow=7791,n.tmonospace=65364,n.toarmenian=1385,n.tohiragana=12392,n.tokatakana=12488,n.tokatakanahalfwidth=65412,n.tonebarextrahighmod=741,n.tonebarextralowmod=745,n.tonebarhighmod=742,n.tonebarlowmod=744,n.tonebarmidmod=743,n.tonefive=445,n.tonesix=389,n.tonetwo=424,n.tonos=900,n.tonsquare=13095,n.topatakthai=3599,n.tortoiseshellbracketleft=12308,n.tortoiseshellbracketleftsmall=65117,n.tortoiseshellbracketleftvertical=65081,n.tortoiseshellbracketright=12309,n.tortoiseshellbracketrightsmall=65118,n.tortoiseshellbracketrightvertical=65082,n.totaothai=3605,n.tpalatalhook=427,n.tparen=9391,n.trademark=8482,n.trademarksans=63722,n.trademarkserif=63195,n.tretroflexhook=648,n.triagdn=9660,n.triaglf=9668,n.triagrt=9658,n.triagup=9650,n.ts=678,n.tsadi=1510,n.tsadidagesh=64326,n.tsadidageshhebrew=64326,n.tsadihebrew=1510,n.tsecyrillic=1094,n.tsere=1461,n.tsere12=1461,n.tsere1e=1461,n.tsere2b=1461,n.tserehebrew=1461,n.tserenarrowhebrew=1461,n.tserequarterhebrew=1461,n.tserewidehebrew=1461,n.tshecyrillic=1115,n.tsuperior=63219,n.ttabengali=2463,n.ttadeva=2335,n.ttagujarati=2719,n.ttagurmukhi=2591,n.tteharabic=1657,n.ttehfinalarabic=64359,n.ttehinitialarabic=64360,n.ttehmedialarabic=64361,n.tthabengali=2464,n.tthadeva=2336,n.tthagujarati=2720,n.tthagurmukhi=2592,n.tturned=647,n.tuhiragana=12388,n.tukatakana=12484,n.tukatakanahalfwidth=65410,n.tusmallhiragana=12387,n.tusmallkatakana=12483,n.tusmallkatakanahalfwidth=65391,n.twelvecircle=9323,n.twelveparen=9343,n.twelveperiod=9363,n.twelveroman=8571,n.twentycircle=9331,n.twentyhangzhou=21316,n.twentyparen=9351,n.twentyperiod=9371,n.two=50,n.twoarabic=1634,n.twobengali=2536,n.twocircle=9313,n.twocircleinversesansserif=10123,n.twodeva=2408,n.twodotenleader=8229,n.twodotleader=8229,n.twodotleadervertical=65072,n.twogujarati=2792,n.twogurmukhi=2664,n.twohackarabic=1634,n.twohangzhou=12322,n.twoideographicparen=12833,n.twoinferior=8322,n.twomonospace=65298,n.twonumeratorbengali=2549,n.twooldstyle=63282,n.twoparen=9333,n.twoperiod=9353,n.twopersian=1778,n.tworoman=8561,n.twostroke=443,n.twosuperior=178,n.twothai=3666,n.twothirds=8532,n.u=117,n.uacute=250,n.ubar=649,n.ubengali=2441,n.ubopomofo=12584,n.ubreve=365,n.ucaron=468,n.ucircle=9444,n.ucircumflex=251,n.ucircumflexbelow=7799,n.ucyrillic=1091,n.udattadeva=2385,n.udblacute=369,n.udblgrave=533,n.udeva=2313,n.udieresis=252,n.udieresisacute=472,n.udieresisbelow=7795,n.udieresiscaron=474,n.udieresiscyrillic=1265,n.udieresisgrave=476,n.udieresismacron=470,n.udotbelow=7909,n.ugrave=249,n.ugujarati=2697,n.ugurmukhi=2569,n.uhiragana=12358,n.uhookabove=7911,n.uhorn=432,n.uhornacute=7913,n.uhorndotbelow=7921,n.uhorngrave=7915,n.uhornhookabove=7917,n.uhorntilde=7919,n.uhungarumlaut=369,n.uhungarumlautcyrillic=1267,n.uinvertedbreve=535,n.ukatakana=12454,n.ukatakanahalfwidth=65395,n.ukcyrillic=1145,n.ukorean=12636,n.umacron=363,n.umacroncyrillic=1263,n.umacrondieresis=7803,n.umatragurmukhi=2625,n.umonospace=65365,n.underscore=95,n.underscoredbl=8215,n.underscoremonospace=65343,n.underscorevertical=65075,n.underscorewavy=65103,n.union=8746,n.universal=8704,n.uogonek=371,n.uparen=9392,n.upblock=9600,n.upperdothebrew=1476,n.upsilon=965,n.upsilondieresis=971,n.upsilondieresistonos=944,n.upsilonlatin=650,n.upsilontonos=973,n.uptackbelowcmb=797,n.uptackmod=724,n.uragurmukhi=2675,n.uring=367,n.ushortcyrillic=1118,n.usmallhiragana=12357,n.usmallkatakana=12453,n.usmallkatakanahalfwidth=65385,n.ustraightcyrillic=1199,n.ustraightstrokecyrillic=1201,n.utilde=361,n.utildeacute=7801,n.utildebelow=7797,n.uubengali=2442,n.uudeva=2314,n.uugujarati=2698,n.uugurmukhi=2570,n.uumatragurmukhi=2626,n.uuvowelsignbengali=2498,n.uuvowelsigndeva=2370,n.uuvowelsigngujarati=2754,n.uvowelsignbengali=2497,n.uvowelsigndeva=2369,n.uvowelsigngujarati=2753,n.v=118,n.vadeva=2357,n.vagujarati=2741,n.vagurmukhi=2613,n.vakatakana=12535,n.vav=1493,n.vavdagesh=64309,n.vavdagesh65=64309,n.vavdageshhebrew=64309,n.vavhebrew=1493,n.vavholam=64331,n.vavholamhebrew=64331,n.vavvavhebrew=1520,n.vavyodhebrew=1521,n.vcircle=9445,n.vdotbelow=7807,n.vecyrillic=1074,n.veharabic=1700,n.vehfinalarabic=64363,n.vehinitialarabic=64364,n.vehmedialarabic=64365,n.vekatakana=12537,n.venus=9792,n.verticalbar=124,n.verticallineabovecmb=781,n.verticallinebelowcmb=809,n.verticallinelowmod=716,n.verticallinemod=712,n.vewarmenian=1406,n.vhook=651,n.vikatakana=12536,n.viramabengali=2509,n.viramadeva=2381,n.viramagujarati=2765,n.visargabengali=2435,n.visargadeva=2307,n.visargagujarati=2691,n.vmonospace=65366,n.voarmenian=1400,n.voicediterationhiragana=12446,n.voicediterationkatakana=12542,n.voicedmarkkana=12443,n.voicedmarkkanahalfwidth=65438,n.vokatakana=12538,n.vparen=9393,n.vtilde=7805,n.vturned=652,n.vuhiragana=12436,n.vukatakana=12532,n.w=119,n.wacute=7811,n.waekorean=12633,n.wahiragana=12431,n.wakatakana=12527,n.wakatakanahalfwidth=65436,n.wakorean=12632,n.wasmallhiragana=12430,n.wasmallkatakana=12526,n.wattosquare=13143,n.wavedash=12316,n.wavyunderscorevertical=65076,n.wawarabic=1608,n.wawfinalarabic=65262,n.wawhamzaabovearabic=1572,n.wawhamzaabovefinalarabic=65158,n.wbsquare=13277,n.wcircle=9446,n.wcircumflex=373,n.wdieresis=7813,n.wdotaccent=7815,n.wdotbelow=7817,n.wehiragana=12433,n.weierstrass=8472,n.wekatakana=12529,n.wekorean=12638,n.weokorean=12637,n.wgrave=7809,n.whitebullet=9702,n.whitecircle=9675,n.whitecircleinverse=9689,n.whitecornerbracketleft=12302,n.whitecornerbracketleftvertical=65091,n.whitecornerbracketright=12303,n.whitecornerbracketrightvertical=65092,n.whitediamond=9671,n.whitediamondcontainingblacksmalldiamond=9672,n.whitedownpointingsmalltriangle=9663,n.whitedownpointingtriangle=9661,n.whiteleftpointingsmalltriangle=9667,n.whiteleftpointingtriangle=9665,n.whitelenticularbracketleft=12310,n.whitelenticularbracketright=12311,n.whiterightpointingsmalltriangle=9657,n.whiterightpointingtriangle=9655,n.whitesmallsquare=9643,n.whitesmilingface=9786,n.whitesquare=9633,n.whitestar=9734,n.whitetelephone=9743,n.whitetortoiseshellbracketleft=12312,n.whitetortoiseshellbracketright=12313,n.whiteuppointingsmalltriangle=9653,n.whiteuppointingtriangle=9651,n.wihiragana=12432,n.wikatakana=12528,n.wikorean=12639,n.wmonospace=65367,n.wohiragana=12434,n.wokatakana=12530,n.wokatakanahalfwidth=65382,n.won=8361,n.wonmonospace=65510,n.wowaenthai=3623,n.wparen=9394,n.wring=7832,n.wsuperior=695,n.wturned=653,n.wynn=447,n.x=120,n.xabovecmb=829,n.xbopomofo=12562,n.xcircle=9447,n.xdieresis=7821,n.xdotaccent=7819,n.xeharmenian=1389,n.xi=958,n.xmonospace=65368,n.xparen=9395,n.xsuperior=739,n.y=121,n.yaadosquare=13134,n.yabengali=2479,n.yacute=253,n.yadeva=2351,n.yaekorean=12626,n.yagujarati=2735,n.yagurmukhi=2607,n.yahiragana=12420,n.yakatakana=12516,n.yakatakanahalfwidth=65428,n.yakorean=12625,n.yamakkanthai=3662,n.yasmallhiragana=12419,n.yasmallkatakana=12515,n.yasmallkatakanahalfwidth=65388,n.yatcyrillic=1123,n.ycircle=9448,n.ycircumflex=375,n.ydieresis=255,n.ydotaccent=7823,n.ydotbelow=7925,n.yeharabic=1610,n.yehbarreearabic=1746,n.yehbarreefinalarabic=64431,n.yehfinalarabic=65266,n.yehhamzaabovearabic=1574,n.yehhamzaabovefinalarabic=65162,n.yehhamzaaboveinitialarabic=65163,n.yehhamzaabovemedialarabic=65164,n.yehinitialarabic=65267,n.yehmedialarabic=65268,n.yehmeeminitialarabic=64733,n.yehmeemisolatedarabic=64600,n.yehnoonfinalarabic=64660,n.yehthreedotsbelowarabic=1745,n.yekorean=12630,n.yen=165,n.yenmonospace=65509,n.yeokorean=12629,n.yeorinhieuhkorean=12678,n.yerahbenyomohebrew=1450,n.yerahbenyomolefthebrew=1450,n.yericyrillic=1099,n.yerudieresiscyrillic=1273,n.yesieungkorean=12673,n.yesieungpansioskorean=12675,n.yesieungsioskorean=12674,n.yetivhebrew=1434,n.ygrave=7923,n.yhook=436,n.yhookabove=7927,n.yiarmenian=1397,n.yicyrillic=1111,n.yikorean=12642,n.yinyang=9775,n.yiwnarmenian=1410,n.ymonospace=65369,n.yod=1497,n.yoddagesh=64313,n.yoddageshhebrew=64313,n.yodhebrew=1497,n.yodyodhebrew=1522,n.yodyodpatahhebrew=64287,n.yohiragana=12424,n.yoikorean=12681,n.yokatakana=12520,n.yokatakanahalfwidth=65430,n.yokorean=12635,n.yosmallhiragana=12423,n.yosmallkatakana=12519,n.yosmallkatakanahalfwidth=65390,n.yotgreek=1011,n.yoyaekorean=12680,n.yoyakorean=12679,n.yoyakthai=3618,n.yoyingthai=3597,n.yparen=9396,n.ypogegrammeni=890,n.ypogegrammenigreekcmb=837,n.yr=422,n.yring=7833,n.ysuperior=696,n.ytilde=7929,n.yturned=654,n.yuhiragana=12422,n.yuikorean=12684,n.yukatakana=12518,n.yukatakanahalfwidth=65429,n.yukorean=12640,n.yusbigcyrillic=1131,n.yusbigiotifiedcyrillic=1133,n.yuslittlecyrillic=1127,n.yuslittleiotifiedcyrillic=1129,n.yusmallhiragana=12421,n.yusmallkatakana=12517,n.yusmallkatakanahalfwidth=65389,n.yuyekorean=12683,n.yuyeokorean=12682,n.yyabengali=2527,n.yyadeva=2399,n.z=122,n.zaarmenian=1382,n.zacute=378,n.zadeva=2395,n.zagurmukhi=2651,n.zaharabic=1592,n.zahfinalarabic=65222,n.zahinitialarabic=65223,n.zahiragana=12374,n.zahmedialarabic=65224,n.zainarabic=1586,n.zainfinalarabic=65200,n.zakatakana=12470,n.zaqefgadolhebrew=1429,n.zaqefqatanhebrew=1428,n.zarqahebrew=1432,n.zayin=1494,n.zayindagesh=64310,n.zayindageshhebrew=64310,n.zayinhebrew=1494,n.zbopomofo=12567,n.zcaron=382,n.zcircle=9449,n.zcircumflex=7825,n.zcurl=657,n.zdot=380,n.zdotaccent=380,n.zdotbelow=7827,n.zecyrillic=1079,n.zedescendercyrillic=1177,n.zedieresiscyrillic=1247,n.zehiragana=12380,n.zekatakana=12476,n.zero=48,n.zeroarabic=1632,n.zerobengali=2534,n.zerodeva=2406,n.zerogujarati=2790,n.zerogurmukhi=2662,n.zerohackarabic=1632,n.zeroinferior=8320,n.zeromonospace=65296,n.zerooldstyle=63280,n.zeropersian=1776,n.zerosuperior=8304,n.zerothai=3664,n.zerowidthjoiner=65279,n.zerowidthnonjoiner=8204,n.zerowidthspace=8203,n.zeta=950,n.zhbopomofo=12563,n.zhearmenian=1386,n.zhebrevecyrillic=1218,n.zhecyrillic=1078,n.zhedescendercyrillic=1175,n.zhedieresiscyrillic=1245,n.zihiragana=12376,n.zikatakana=12472,n.zinorhebrew=1454,n.zlinebelow=7829,n.zmonospace=65370,n.zohiragana=12382,n.zokatakana=12478,n.zparen=9397,n.zretroflexhook=656,n.zstroke=438,n.zuhiragana=12378,n.zukatakana=12474,n[".notdef"]=0,n.angbracketleftbig=9001,n.angbracketleftBig=9001,n.angbracketleftbigg=9001,n.angbracketleftBigg=9001,n.angbracketrightBig=9002,n.angbracketrightbig=9002,n.angbracketrightBigg=9002,n.angbracketrightbigg=9002,n.arrowhookleft=8618,n.arrowhookright=8617,n.arrowlefttophalf=8636,n.arrowleftbothalf=8637,n.arrownortheast=8599,n.arrownorthwest=8598,n.arrowrighttophalf=8640,n.arrowrightbothalf=8641,n.arrowsoutheast=8600,n.arrowsouthwest=8601,n.backslashbig=8726,n.backslashBig=8726,n.backslashBigg=8726,n.backslashbigg=8726,n.bardbl=8214,n.bracehtipdownleft=65079,n.bracehtipdownright=65079,n.bracehtipupleft=65080,n.bracehtipupright=65080,n.braceleftBig=123,n.braceleftbig=123,n.braceleftbigg=123,n.braceleftBigg=123,n.bracerightBig=125,n.bracerightbig=125,n.bracerightbigg=125,n.bracerightBigg=125,n.bracketleftbig=91,n.bracketleftBig=91,n.bracketleftbigg=91,n.bracketleftBigg=91,n.bracketrightBig=93,n.bracketrightbig=93,n.bracketrightbigg=93,n.bracketrightBigg=93,n.ceilingleftbig=8968,n.ceilingleftBig=8968,n.ceilingleftBigg=8968,n.ceilingleftbigg=8968,n.ceilingrightbig=8969,n.ceilingrightBig=8969,n.ceilingrightbigg=8969,n.ceilingrightBigg=8969,n.circledotdisplay=8857,n.circledottext=8857,n.circlemultiplydisplay=8855,n.circlemultiplytext=8855,n.circleplusdisplay=8853,n.circleplustext=8853,n.contintegraldisplay=8750,n.contintegraltext=8750,n.coproductdisplay=8720,n.coproducttext=8720,n.floorleftBig=8970,n.floorleftbig=8970,n.floorleftbigg=8970,n.floorleftBigg=8970,n.floorrightbig=8971,n.floorrightBig=8971,n.floorrightBigg=8971,n.floorrightbigg=8971,n.hatwide=770,n.hatwider=770,n.hatwidest=770,n.intercal=7488,n.integraldisplay=8747,n.integraltext=8747,n.intersectiondisplay=8898,n.intersectiontext=8898,n.logicalanddisplay=8743,n.logicalandtext=8743,n.logicalordisplay=8744,n.logicalortext=8744,n.parenleftBig=40,n.parenleftbig=40,n.parenleftBigg=40,n.parenleftbigg=40,n.parenrightBig=41,n.parenrightbig=41,n.parenrightBigg=41,n.parenrightbigg=41,n.prime=8242,n.productdisplay=8719,n.producttext=8719,n.radicalbig=8730,n.radicalBig=8730,n.radicalBigg=8730,n.radicalbigg=8730,n.radicalbt=8730,n.radicaltp=8730,n.radicalvertex=8730,n.slashbig=47,n.slashBig=47,n.slashBigg=47,n.slashbigg=47,n.summationdisplay=8721,n.summationtext=8721,n.tildewide=732,n.tildewider=732,n.tildewidest=732,n.uniondisplay=8899,n.unionmultidisplay=8846,n.unionmultitext=8846,n.unionsqdisplay=8852,n.unionsqtext=8852,n.uniontext=8899,n.vextenddouble=8741,n.vextendsingle=8739}),_z=Ei(function(n){n.space=32,n.a1=9985,n.a2=9986,n.a202=9987,n.a3=9988,n.a4=9742,n.a5=9990,n.a119=9991,n.a118=9992,n.a117=9993,n.a11=9755,n.a12=9758,n.a13=9996,n.a14=9997,n.a15=9998,n.a16=9999,n.a105=1e4,n.a17=10001,n.a18=10002,n.a19=10003,n.a20=10004,n.a21=10005,n.a22=10006,n.a23=10007,n.a24=10008,n.a25=10009,n.a26=10010,n.a27=10011,n.a28=10012,n.a6=10013,n.a7=10014,n.a8=10015,n.a9=10016,n.a10=10017,n.a29=10018,n.a30=10019,n.a31=10020,n.a32=10021,n.a33=10022,n.a34=10023,n.a35=9733,n.a36=10025,n.a37=10026,n.a38=10027,n.a39=10028,n.a40=10029,n.a41=10030,n.a42=10031,n.a43=10032,n.a44=10033,n.a45=10034,n.a46=10035,n.a47=10036,n.a48=10037,n.a49=10038,n.a50=10039,n.a51=10040,n.a52=10041,n.a53=10042,n.a54=10043,n.a55=10044,n.a56=10045,n.a57=10046,n.a58=10047,n.a59=10048,n.a60=10049,n.a61=10050,n.a62=10051,n.a63=10052,n.a64=10053,n.a65=10054,n.a66=10055,n.a67=10056,n.a68=10057,n.a69=10058,n.a70=10059,n.a71=9679,n.a72=10061,n.a73=9632,n.a74=10063,n.a203=10064,n.a75=10065,n.a204=10066,n.a76=9650,n.a77=9660,n.a78=9670,n.a79=10070,n.a81=9687,n.a82=10072,n.a83=10073,n.a84=10074,n.a97=10075,n.a98=10076,n.a99=10077,n.a100=10078,n.a101=10081,n.a102=10082,n.a103=10083,n.a104=10084,n.a106=10085,n.a107=10086,n.a108=10087,n.a112=9827,n.a111=9830,n.a110=9829,n.a109=9824,n.a120=9312,n.a121=9313,n.a122=9314,n.a123=9315,n.a124=9316,n.a125=9317,n.a126=9318,n.a127=9319,n.a128=9320,n.a129=9321,n.a130=10102,n.a131=10103,n.a132=10104,n.a133=10105,n.a134=10106,n.a135=10107,n.a136=10108,n.a137=10109,n.a138=10110,n.a139=10111,n.a140=10112,n.a141=10113,n.a142=10114,n.a143=10115,n.a144=10116,n.a145=10117,n.a146=10118,n.a147=10119,n.a148=10120,n.a149=10121,n.a150=10122,n.a151=10123,n.a152=10124,n.a153=10125,n.a154=10126,n.a155=10127,n.a156=10128,n.a157=10129,n.a158=10130,n.a159=10131,n.a160=10132,n.a161=8594,n.a163=8596,n.a164=8597,n.a196=10136,n.a165=10137,n.a192=10138,n.a166=10139,n.a167=10140,n.a168=10141,n.a169=10142,n.a170=10143,n.a171=10144,n.a172=10145,n.a173=10146,n.a162=10147,n.a174=10148,n.a175=10149,n.a176=10150,n.a177=10151,n.a178=10152,n.a179=10153,n.a193=10154,n.a180=10155,n.a199=10156,n.a181=10157,n.a200=10158,n.a182=10159,n.a201=10161,n.a183=10162,n.a184=10163,n.a197=10164,n.a185=10165,n.a194=10166,n.a198=10167,n.a186=10168,n.a195=10169,n.a187=10170,n.a188=10171,n.a189=10172,n.a190=10173,n.a191=10174,n.a89=10088,n.a90=10089,n.a93=10090,n.a94=10091,n.a91=10092,n.a92=10093,n.a205=10094,n.a85=10095,n.a206=10096,n.a86=10097,n.a87=10098,n.a88=10099,n.a95=10100,n.a96=10101,n[".notdef"]=0}),vz=Ei(function(n){n[63721]=169,n[63193]=169,n[63720]=174,n[63194]=174,n[63722]=8482,n[63195]=8482,n[63729]=9127,n[63730]=9128,n[63731]=9129,n[63740]=9131,n[63741]=9132,n[63742]=9133,n[63726]=9121,n[63727]=9122,n[63728]=9123,n[63737]=9124,n[63738]=9125,n[63739]=9126,n[63723]=9115,n[63724]=9116,n[63725]=9117,n[63734]=9118,n[63735]=9119,n[63736]=9120});function kz(n){return n>=65520&&n<=65535?0:n>=62976&&n<=63743?vz()[n]||n:n===173?45:n}function Dg(n,e){let t=e[n];if(t!==void 0)return t;if(!n)return-1;if(n[0]==="u"){const i=n.length;let s;if(i===7&&n[1]==="n"&&n[2]==="i")s=n.substring(3);else if(i>=5&&i<=7)s=n.substring(1);else return-1;if(s===s.toUpperCase()&&(t=parseInt(s,16),t>=0))return t}return-1}const Sw=[[0,127],[128,255],[256,383],[384,591],[592,687,7424,7551,7552,7615],[688,767,42752,42783],[768,879,7616,7679],[880,1023],[11392,11519],[1024,1279,1280,1327,11744,11775,42560,42655],[1328,1423],[1424,1535],[42240,42559],[1536,1791,1872,1919],[1984,2047],[2304,2431],[2432,2559],[2560,2687],[2688,2815],[2816,2943],[2944,3071],[3072,3199],[3200,3327],[3328,3455],[3584,3711],[3712,3839],[4256,4351,11520,11567],[6912,7039],[4352,4607],[7680,7935,11360,11391,42784,43007],[7936,8191],[8192,8303,11776,11903],[8304,8351],[8352,8399],[8400,8447],[8448,8527],[8528,8591],[8592,8703,10224,10239,10496,10623,11008,11263],[8704,8959,10752,11007,10176,10223,10624,10751],[8960,9215],[9216,9279],[9280,9311],[9312,9471],[9472,9599],[9600,9631],[9632,9727],[9728,9983],[9984,10175],[12288,12351],[12352,12447],[12448,12543,12784,12799],[12544,12591,12704,12735],[12592,12687],[43072,43135],[12800,13055],[13056,13311],[44032,55215],[55296,57343],[67840,67871],[19968,40959,11904,12031,12032,12255,12272,12287,13312,19903,131072,173791,12688,12703],[57344,63743],[12736,12783,63744,64255,194560,195103],[64256,64335],[64336,65023],[65056,65071],[65040,65055],[65104,65135],[65136,65279],[65280,65519],[65520,65535],[3840,4095],[1792,1871],[1920,1983],[3456,3583],[4096,4255],[4608,4991,4992,5023,11648,11743],[5024,5119],[5120,5759],[5760,5791],[5792,5887],[6016,6143],[6144,6319],[10240,10495],[40960,42127],[5888,5919,5920,5951,5952,5983,5984,6015],[66304,66351],[66352,66383],[66560,66639],[118784,119039,119040,119295,119296,119375],[119808,120831],[1044480,1048573],[65024,65039,917760,917999],[917504,917631],[6400,6479],[6480,6527],[6528,6623],[6656,6687],[11264,11359],[11568,11647],[19904,19967],[43008,43055],[65536,65663,65664,65791,65792,65855],[65856,65935],[66432,66463],[66464,66527],[66640,66687],[66688,66735],[67584,67647],[68096,68191],[119552,119647],[73728,74751,74752,74879],[119648,119679],[7040,7103],[7168,7247],[7248,7295],[43136,43231],[43264,43311],[43312,43359],[43520,43615],[65936,65999],[66e3,66047],[66208,66271,66176,66207,67872,67903],[127024,127135,126976,127023]];function Cz(n,e=-1){if(e!==-1){const t=Sw[e];for(let i=0,s=t.length;i<s;i+=2)if(n>=t[i]&&n<=t[i+1])return e}for(let t=0,i=Sw.length;t<i;t++){const s=Sw[t];for(let r=0,a=s.length;r<a;r+=2)if(n>=s[r]&&n<=s[r+1])return t}return-1}const Az=new RegExp("^(\\s)|(\\p{Mn})|(\\p{Cf})$","u"),$7=new Map;function Sz(n){const e=$7.get(n);if(e)return e;const t=n.match(Az),i={isWhitespace:!!(t!=null&&t[1]),isZeroWidthDiacritic:!!(t!=null&&t[2]),isInvisibleFormatMark:!!(t!=null&&t[3])};return $7.set(n,i),i}function Iz(){$7.clear()}const h1=!0,po={FixedPitch:1,Serif:2,Symbolic:4,Script:8,Nonsymbolic:32,Italic:64,AllCap:65536,SmallCap:131072,ForceBold:262144},bk=[".notdef",".null","nonmarkingreturn","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quotesingle","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","grave","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","Adieresis","Aring","Ccedilla","Eacute","Ntilde","Odieresis","Udieresis","aacute","agrave","acircumflex","adieresis","atilde","aring","ccedilla","eacute","egrave","ecircumflex","edieresis","iacute","igrave","icircumflex","idieresis","ntilde","oacute","ograve","ocircumflex","odieresis","otilde","uacute","ugrave","ucircumflex","udieresis","dagger","degree","cent","sterling","section","bullet","paragraph","germandbls","registered","copyright","trademark","acute","dieresis","notequal","AE","Oslash","infinity","plusminus","lessequal","greaterequal","yen","mu","partialdiff","summation","product","pi","integral","ordfeminine","ordmasculine","Omega","ae","oslash","questiondown","exclamdown","logicalnot","radical","florin","approxequal","Delta","guillemotleft","guillemotright","ellipsis","nonbreakingspace","Agrave","Atilde","Otilde","OE","oe","endash","emdash","quotedblleft","quotedblright","quoteleft","quoteright","divide","lozenge","ydieresis","Ydieresis","fraction","currency","guilsinglleft","guilsinglright","fi","fl","daggerdbl","periodcentered","quotesinglbase","quotedblbase","perthousand","Acircumflex","Ecircumflex","Aacute","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Oacute","Ocircumflex","apple","Ograve","Uacute","Ucircumflex","Ugrave","dotlessi","circumflex","tilde","macron","breve","dotaccent","ring","cedilla","hungarumlaut","ogonek","caron","Lslash","lslash","Scaron","scaron","Zcaron","zcaron","brokenbar","Eth","eth","Yacute","yacute","Thorn","thorn","minus","multiply","onesuperior","twosuperior","threesuperior","onehalf","onequarter","threequarters","franc","Gbreve","gbreve","Idotaccent","Scedilla","scedilla","Cacute","cacute","Ccaron","ccaron","dcroat"];function JR(n,e){if(e[n]!==void 0)return n;const t=Dg(n,e);if(t!==-1){for(const i in e)if(e[i]===t)return i}return gn("Unable to recover a standard glyph name for: "+n),n}function ZR(n,e,t){const i=Object.create(null);let s,r,a;const o=!!(n.flags&po.Symbolic);if(n.isInternalFont)for(a=e,r=0;r<a.length;r++)s=t.indexOf(a[r]),i[r]=s>=0?s:0;else if(n.baseEncodingName)for(a=Yp(n.baseEncodingName),r=0;r<a.length;r++)s=t.indexOf(a[r]),i[r]=s>=0?s:0;else if(o)for(r in e)i[r]=e[r];else for(a=f0,r=0;r<a.length;r++)s=t.indexOf(a[r]),i[r]=s>=0?s:0;const l=n.differences;let c;if(l)for(r in l){const h=l[r];if(s=t.indexOf(h),s===-1){c||(c=$l());const u=JR(h,c);u!==h&&(s=t.indexOf(u))}i[r]=s>=0?s:0}return i}function yx(n){return n.replaceAll(/[,_]/g,"-").replaceAll(/\s/g,"")}const Ez=Ei(n=>{n[8211]=65074,n[8212]=65073,n[8229]=65072,n[8230]=65049,n[12289]=65041,n[12290]=65042,n[12296]=65087,n[12297]=65088,n[12298]=65085,n[12299]=65086,n[12300]=65089,n[12301]=65090,n[12302]=65091,n[12303]=65092,n[12304]=65083,n[12305]=65084,n[12308]=65081,n[12309]=65082,n[12310]=65047,n[12311]=65048,n[65103]=65076,n[65281]=65045,n[65288]=65077,n[65289]=65078,n[65292]=65040,n[65306]=65043,n[65307]=65044,n[65311]=65046,n[65339]=65095,n[65341]=65096,n[65343]=65075,n[65371]=65079,n[65373]=65080}),xk=1e3;function Tz({data:n,width:e,height:t}){if(e>xk||t>xk)return null;const i=1e3,s=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),r=e+1,a=new Uint8Array(r*(t+1));let o,l,c;const h=e+7&-8,u=new Uint8Array(h*t);let d=0;for(const C of n){let k=128;for(;k>0;)u[d++]=C&k?0:255,k>>=1}let f=0;for(d=0,u[d]!==0&&(a[0]=1,++f),l=1;l<e;l++)u[d]!==u[d+1]&&(a[l]=u[d]?2:1,++f),d++;for(u[d]!==0&&(a[l]=2,++f),o=1;o<t;o++){d=o*h,c=o*r,u[d-h]!==u[d]&&(a[c]=u[d]?1:8,++f);let C=(u[d]?4:0)+(u[d-h]?8:0);for(l=1;l<e;l++)C=(C>>2)+(u[d+1]?4:0)+(u[d-h+1]?8:0),s[C]&&(a[c+l]=s[C],++f),d++;if(u[d-h]!==u[d]&&(a[c+l]=u[d]?2:4,++f),f>i)return null}for(d=h*(t-1),c=o*r,u[d]!==0&&(a[c]=8,++f),l=1;l<e;l++)u[d]!==u[d+1]&&(a[c+l]=u[d]?4:8,++f),d++;if(u[d]!==0&&(a[c+l]=4,++f),f>i)return null;const g=new Int32Array([0,r,-1,0,-r,0,0,0,1]),m=[],{a:b,b:p,c:y,d:w,e:_,f:v}=new DOMMatrix().scaleSelf(1/e,-1/t).translateSelf(0,-t);for(o=0;f&&o<=t;o++){let C=o*r;const k=C+e;for(;C<k&&!a[C];)C++;if(C===k)continue;let I=C%r,E=o;m.push(xs.moveTo,b*I+y*E+_,p*I+w*E+v);const T=C;let M=a[C];do{const D=g[M];do C+=D;while(!a[C]);const H=a[C];H!==5&&H!==10?(M=H,a[C]=0):(M=H&51*M>>4,a[C]&=M>>2|M<<2),I=C%r,E=C/r|0,m.push(xs.lineTo,b*I+y*E+_,p*I+w*E+v),a[C]||--f}while(T!==C);--o}return[ie.rawFillPath,[new Float32Array(m)],new Float32Array([0,0,e,t])]}const Rz=[".notdef","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","endash","dagger","daggerdbl","periodcentered","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","questiondown","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","ring","cedilla","hungarumlaut","ogonek","caron","emdash","AE","ordfeminine","Lslash","Oslash","OE","ordmasculine","ae","dotlessi","lslash","oslash","oe","germandbls","onesuperior","logicalnot","mu","trademark","Eth","onehalf","plusminus","Thorn","onequarter","divide","brokenbar","degree","thorn","threequarters","twosuperior","registered","minus","eth","multiply","threesuperior","copyright","Aacute","Acircumflex","Adieresis","Agrave","Aring","Atilde","Ccedilla","Eacute","Ecircumflex","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Ntilde","Oacute","Ocircumflex","Odieresis","Ograve","Otilde","Scaron","Uacute","Ucircumflex","Udieresis","Ugrave","Yacute","Ydieresis","Zcaron","aacute","acircumflex","adieresis","agrave","aring","atilde","ccedilla","eacute","ecircumflex","edieresis","egrave","iacute","icircumflex","idieresis","igrave","ntilde","oacute","ocircumflex","odieresis","ograve","otilde","scaron","uacute","ucircumflex","udieresis","ugrave","yacute","ydieresis","zcaron"],Mz=[".notdef","space","exclamsmall","Hungarumlautsmall","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","twodotenleader","onedotenleader","comma","hyphen","period","fraction","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","colon","semicolon","commasuperior","threequartersemdash","periodsuperior","questionsmall","asuperior","bsuperior","centsuperior","dsuperior","esuperior","isuperior","lsuperior","msuperior","nsuperior","osuperior","rsuperior","ssuperior","tsuperior","ff","fi","fl","ffi","ffl","parenleftinferior","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","exclamdownsmall","centoldstyle","Lslashsmall","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","Dotaccentsmall","Macronsmall","figuredash","hypheninferior","Ogoneksmall","Ringsmall","Cedillasmall","onequarter","onehalf","threequarters","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","zerosuperior","onesuperior","twosuperior","threesuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall"],Pz=[".notdef","space","dollaroldstyle","dollarsuperior","parenleftsuperior","parenrightsuperior","twodotenleader","onedotenleader","comma","hyphen","period","fraction","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","colon","semicolon","commasuperior","threequartersemdash","periodsuperior","asuperior","bsuperior","centsuperior","dsuperior","esuperior","isuperior","lsuperior","msuperior","nsuperior","osuperior","rsuperior","ssuperior","tsuperior","ff","fi","fl","ffi","ffl","parenleftinferior","parenrightinferior","hyphensuperior","colonmonetary","onefitted","rupiah","centoldstyle","figuredash","hypheninferior","onequarter","onehalf","threequarters","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","zerosuperior","onesuperior","twosuperior","threesuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior"],Nz=10,h3=[".notdef","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","endash","dagger","daggerdbl","periodcentered","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","questiondown","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","ring","cedilla","hungarumlaut","ogonek","caron","emdash","AE","ordfeminine","Lslash","Oslash","OE","ordmasculine","ae","dotlessi","lslash","oslash","oe","germandbls","onesuperior","logicalnot","mu","trademark","Eth","onehalf","plusminus","Thorn","onequarter","divide","brokenbar","degree","thorn","threequarters","twosuperior","registered","minus","eth","multiply","threesuperior","copyright","Aacute","Acircumflex","Adieresis","Agrave","Aring","Atilde","Ccedilla","Eacute","Ecircumflex","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Ntilde","Oacute","Ocircumflex","Odieresis","Ograve","Otilde","Scaron","Uacute","Ucircumflex","Udieresis","Ugrave","Yacute","Ydieresis","Zcaron","aacute","acircumflex","adieresis","agrave","aring","atilde","ccedilla","eacute","ecircumflex","edieresis","egrave","iacute","icircumflex","idieresis","igrave","ntilde","oacute","ocircumflex","odieresis","ograve","otilde","scaron","uacute","ucircumflex","udieresis","ugrave","yacute","ydieresis","zcaron","exclamsmall","Hungarumlautsmall","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","twodotenleader","onedotenleader","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","commasuperior","threequartersemdash","periodsuperior","questionsmall","asuperior","bsuperior","centsuperior","dsuperior","esuperior","isuperior","lsuperior","msuperior","nsuperior","osuperior","rsuperior","ssuperior","tsuperior","ff","ffi","ffl","parenleftinferior","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","exclamdownsmall","centoldstyle","Lslashsmall","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","Dotaccentsmall","Macronsmall","figuredash","hypheninferior","Ogoneksmall","Ringsmall","Cedillasmall","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","zerosuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall","001.000","001.001","001.002","001.003","Black","Bold","Book","Light","Medium","Regular","Roman","Semibold"],t9=391,_f=[null,{id:"hstem",min:2,stackClearing:!0,stem:!0},null,{id:"vstem",min:2,stackClearing:!0,stem:!0},{id:"vmoveto",min:1,stackClearing:!0},{id:"rlineto",min:2,resetStack:!0},{id:"hlineto",min:1,resetStack:!0},{id:"vlineto",min:1,resetStack:!0},{id:"rrcurveto",min:6,resetStack:!0},null,{id:"callsubr",min:1,undefStack:!0},{id:"return",min:0,undefStack:!0},null,null,{id:"endchar",min:0,stackClearing:!0},null,null,null,{id:"hstemhm",min:2,stackClearing:!0,stem:!0},{id:"hintmask",min:0,stackClearing:!0},{id:"cntrmask",min:0,stackClearing:!0},{id:"rmoveto",min:2,stackClearing:!0},{id:"hmoveto",min:1,stackClearing:!0},{id:"vstemhm",min:2,stackClearing:!0,stem:!0},{id:"rcurveline",min:8,resetStack:!0},{id:"rlinecurve",min:8,resetStack:!0},{id:"vvcurveto",min:4,resetStack:!0},{id:"hhcurveto",min:4,resetStack:!0},null,{id:"callgsubr",min:1,undefStack:!0},{id:"vhcurveto",min:4,resetStack:!0},{id:"hvcurveto",min:4,resetStack:!0}],Oz=[null,null,null,{id:"and",min:2,stackDelta:-1},{id:"or",min:2,stackDelta:-1},{id:"not",min:1,stackDelta:0},null,null,null,{id:"abs",min:1,stackDelta:0},{id:"add",min:2,stackDelta:-1,stackFn(n,e){n[e-2]=n[e-2]+n[e-1]}},{id:"sub",min:2,stackDelta:-1,stackFn(n,e){n[e-2]=n[e-2]-n[e-1]}},{id:"div",min:2,stackDelta:-1,stackFn(n,e){n[e-2]=n[e-2]/n[e-1]}},null,{id:"neg",min:1,stackDelta:0,stackFn(n,e){n[e-1]=-n[e-1]}},{id:"eq",min:2,stackDelta:-1},null,null,{id:"drop",min:1,stackDelta:-1},null,{id:"put",min:2,stackDelta:-2},{id:"get",min:1,stackDelta:0},{id:"ifelse",min:4,stackDelta:-3},{id:"random",min:0,stackDelta:1},{id:"mul",min:2,stackDelta:-1,stackFn(n,e){n[e-2]=n[e-2]*n[e-1]}},null,{id:"sqrt",min:1,stackDelta:0},{id:"dup",min:1,stackDelta:1},{id:"exch",min:2,stackDelta:0},{id:"index",min:2,stackDelta:0},{id:"roll",min:3,stackDelta:-2},null,null,null,{id:"hflex",min:7,resetStack:!0},{id:"flex",min:13,resetStack:!0},{id:"hflex1",min:9,resetStack:!0},{id:"flex1",min:11,resetStack:!0}];class O4{constructor(e,t,i){this.bytes=e.getBytes(),this.properties=t,this.seacAnalysisEnabled=!!i}parse(){const e=this.properties,t=new QR;this.cff=t;const i=this.parseHeader(),s=this.parseIndex(i.endPos),r=this.parseIndex(s.endPos),a=this.parseIndex(r.endPos),o=this.parseIndex(a.endPos),l=this.parseDict(r.obj.get(0)),c=this.createDict(Jp,l,t.strings);t.header=i.obj,t.names=this.parseNameIndex(s.obj),t.strings=this.parseStringIndex(a.obj),t.topDict=c,t.globalSubrIndex=o.obj,this.parsePrivateDict(t.topDict),t.isCIDFont=c.hasName("ROS");const h=c.getByName("CharStrings"),u=this.parseIndex(h).obj,d=c.getByName("FontMatrix");d&&(e.fontMatrix=d);const f=c.getByName("FontBBox");f&&(e.ascent=Math.max(f[3],f[1]),e.descent=Math.min(f[1],f[3]),e.ascentScaled=!0);let g,m;if(t.isCIDFont){const p=this.parseIndex(c.getByName("FDArray")).obj;for(let y=0,w=p.count;y<w;++y){const _=p.get(y),v=this.createDict(Jp,this.parseDict(_),t.strings);this.parsePrivateDict(v),t.fdArray.push(v)}m=null,g=this.parseCharsets(c.getByName("charset"),u.count,t.strings,!0),t.fdSelect=this.parseFDSelect(c.getByName("FDSelect"),u.count)}else g=this.parseCharsets(c.getByName("charset"),u.count,t.strings,!1),m=this.parseEncoding(c.getByName("Encoding"),e,t.strings,g.charset);t.charset=g,t.encoding=m;const b=this.parseCharStrings({charStrings:u,localSubrIndex:c.privateDict.subrsIndex,globalSubrIndex:o.obj,fdSelect:t.fdSelect,fdArray:t.fdArray,privateDict:c.privateDict});return t.charStrings=b.charStrings,t.seacs=b.seacs,t.widths=b.widths,t}parseHeader(){let e=this.bytes;const t=e.length;let i=0;for(;i<t&&e[i]!==1;)++i;if(i>=t)throw new Te("Invalid CFF header");i!==0&&(gn("cff data is shifted"),e=e.subarray(i),this.bytes=e);const s=e[0],r=e[1],a=e[2],o=e[3];return{obj:new $R(s,r,a,o),endPos:a}}parseDict(e){let t=0;function i(){let l=e[t++];return l===30?s():l===28?(l=a0(e,t),t+=2,l):l===29?(l=e[t++],l=l<<8|e[t++],l=l<<8|e[t++],l=l<<8|e[t++],l):l>=32&&l<=246?l-139:l>=247&&l<=250?(l-247)*256+e[t++]+108:l>=251&&l<=254?-((l-251)*256)-e[t++]-108:(ae('CFFParser_parseDict: "'+l+'" is a reserved command.'),NaN)}function s(){let l="";const h=["0","1","2","3","4","5","6","7","8","9",".","E","E-",null,"-"],u=e.length;for(;t<u;){const d=e[t++],f=d>>4,g=d&15;if(f===15||(l+=h[f],g===15))break;l+=h[g]}return parseFloat(l)}let r=[];const a=[];t=0;const o=e.length;for(;t<o;){let l=e[t];l<=21?(l===12&&(l=l<<8|e[++t]),a.push([l,r]),r=[],++t):r.push(i())}return a}parseIndex(e){const t=new Bh,i=this.bytes,s=i[e++]<<8|i[e++],r=[];let a=e,o,l;if(s!==0){const c=i[e++],h=e+(s+1)*c-1;for(o=0,l=s+1;o<l;++o){let u=0;for(let d=0;d<c;++d)u<<=8,u+=i[e++];r.push(h+u)}a=r[s]}for(o=0,l=r.length-1;o<l;++o){const c=r[o],h=r[o+1];t.add(i.subarray(c,h))}return{obj:t,endPos:a}}parseNameIndex(e){const t=[];for(let i=0,s=e.count;i<s;++i){const r=e.get(i);t.push(xa(r))}return t}parseStringIndex(e){const t=new D4;for(let i=0,s=e.count;i<s;++i){const r=e.get(i);t.add(xa(r))}return t}createDict(e,t,i){const s=new e(i);for(const[r,a]of t)s.setByKey(r,a);return s}parseCharString(e,t,i,s){if(!t||e.callDepth>Nz)return!1;let r=e.stackSize;const a=e.stack;let o=t.length;for(let l=0;l<o;){const c=t[l++];let h=null;if(c===12){const u=t[l++];u===0?(t[l-2]=139,t[l-1]=22,r=0):h=Oz[u]}else if(c===28)a[r]=a0(t,l),l+=2,r++;else if(c===14){if(r>=4&&(r-=4,this.seacAnalysisEnabled))return e.seac=a.slice(r,r+4),!1;h=_f[c]}else if(c>=32&&c<=246)a[r]=c-139,r++;else if(c>=247&&c<=254)a[r]=c<251?(c-247<<8)+t[l]+108:-(c-251<<8)-t[l]-108,l++,r++;else if(c===255)a[r]=(t[l]<<24|t[l+1]<<16|t[l+2]<<8|t[l+3])/65536,l+=4,r++;else if(c===19||c===20){if(e.hints+=r>>1,e.hints===0){t.copyWithin(l-1,l,-1),l-=1,o-=1;continue}l+=e.hints+7>>3,r%=2,h=_f[c]}else if(c===10||c===29){const u=c===10?i:s;if(!u)return h=_f[c],ae("Missing subrsIndex for "+h.id),!1;let d=32768;u.count<1240?d=107:u.count<33900&&(d=1131);const f=a[--r]+d;if(f<0||f>=u.count||isNaN(f))return h=_f[c],ae("Out of bounds subrIndex for "+h.id),!1;if(e.stackSize=r,e.callDepth++,!this.parseCharString(e,u.get(f),i,s))return!1;e.callDepth--,r=e.stackSize;continue}else{if(c===11)return e.stackSize=r,!0;if(c===0&&l===t.length)t[l-1]=14,h=_f[14];else if(c===9){t.copyWithin(l-1,l,-1),l-=1,o-=1;continue}else h=_f[c]}if(h){if(h.stem&&(e.hints+=r>>1,c===3||c===23?e.hasVStems=!0:e.hasVStems&&(c===1||c===18)&&(ae("CFF stem hints are in wrong order"),t[l-1]=c===1?3:23)),"min"in h&&!e.undefStack&&r<h.min)return ae("Not enough parameters for "+h.id+"; actual: "+r+", expected: "+h.min),r===0?(t[l-1]=14,!0):!1;e.firstStackClearing&&h.stackClearing&&(e.firstStackClearing=!1,r-=h.min,r>=2&&h.stem?r%=2:r>1&&ae("Found too many parameters for stack-clearing command"),r>0&&(e.width=a[r-1])),"stackDelta"in h?("stackFn"in h&&h.stackFn(a,r),r+=h.stackDelta):h.stackClearing?r=0:h.resetStack?(r=0,e.undefStack=!1):h.undefStack&&(r=0,e.undefStack=!0,e.firstStackClearing=!1)}}return o<t.length&&t.fill(14,o),e.stackSize=r,!0}parseCharStrings({charStrings:e,localSubrIndex:t,globalSubrIndex:i,fdSelect:s,fdArray:r,privateDict:a}){const o=[],l=[],c=e.count;for(let h=0;h<c;h++){const u=e.get(h),d={callDepth:0,stackSize:0,stack:[],undefStack:!0,hints:0,firstStackClearing:!0,seac:null,width:null,hasVStems:!1};let f=!0,g=null,m=a;if(s&&r.length){const b=s.getFDIndex(h);b===-1&&(ae("Glyph index is not in fd select."),f=!1),b>=r.length&&(ae("Invalid fd index for glyph index."),f=!1),f&&(m=r[b].privateDict,g=m.subrsIndex)}else t&&(g=t);if(f&&(f=this.parseCharString(d,u,g,i)),d.width!==null){const b=m.getByName("nominalWidthX");l[h]=b+d.width}else{const b=m.getByName("defaultWidthX");l[h]=b}d.seac!==null&&(o[h]=d.seac),f||e.set(h,new Uint8Array([14]))}return{charStrings:e,seacs:o,widths:l}}emptyPrivateDictionary(e){const t=this.createDict(Zp,[],e.strings);e.setByKey(18,[0,0]),e.privateDict=t}parsePrivateDict(e){if(!e.hasName("Private")){this.emptyPrivateDictionary(e);return}const t=e.getByName("Private");if(!Array.isArray(t)||t.length!==2){e.removeByName("Private");return}const i=t[0],s=t[1];if(i===0||s>=this.bytes.length){this.emptyPrivateDictionary(e);return}const r=s+i,a=this.bytes.subarray(s,r),o=this.parseDict(a),l=this.createDict(Zp,o,e.strings);if(e.privateDict=l,l.getByName("ExpansionFactor")===0&&l.setByName("ExpansionFactor",.06),!l.getByName("Subrs"))return;const c=l.getByName("Subrs"),h=s+c;if(c===0||h>=this.bytes.length){this.emptyPrivateDictionary(e);return}const u=this.parseIndex(h);l.subrsIndex=u.obj}parseCharsets(e,t,i,s){if(e===0)return new mp(!0,Iw.ISO_ADOBE,Rz);if(e===1)return new mp(!0,Iw.EXPERT,Mz);if(e===2)return new mp(!0,Iw.EXPERT_SUBSET,Pz);const r=this.bytes,a=e,o=r[e++],l=[s?0:".notdef"];let c,h,u;switch(t-=1,o){case 0:for(u=0;u<t;u++)c=r[e++]<<8|r[e++],l.push(s?c:i.get(c));break;case 1:for(;l.length<=t;)for(c=r[e++]<<8|r[e++],h=r[e++],u=0;u<=h;u++)l.push(s?c++:i.get(c++));break;case 2:for(;l.length<=t;)for(c=r[e++]<<8|r[e++],h=r[e++]<<8|r[e++],u=0;u<=h;u++)l.push(s?c++:i.get(c++));break;default:throw new Te("Unknown charset format")}const d=e,f=r.subarray(a,d);return new mp(!1,o,l,f)}parseEncoding(e,t,i,s){const r=Object.create(null),a=this.bytes;let o=!1,l,c,h,u=null;function d(){const f=a[e++];for(c=0;c<f;c++){const g=a[e++],m=(a[e++]<<8)+(a[e++]&255);r[g]=s.indexOf(i.get(m))}}if(e===0||e===1){o=!0,l=e;const f=e?YR:f0;for(c=0,h=s.length;c<h;c++){const g=f.indexOf(s[c]);g!==-1&&(r[g]=c)}}else{const f=e;switch(l=a[e++],l&127){case 0:const m=a[e++];for(c=1;c<=m;c++)r[a[e++]]=c;break;case 1:const b=a[e++];let p=1;for(c=0;c<b;c++){const y=a[e++],w=a[e++];for(let _=y;_<=y+w;_++)r[_]=p++}break;default:throw new Te(`Unknown encoding format: ${l} in CFF`)}const g=e;l&128&&(a[f]&=127,d()),u=a.subarray(f,g)}return l&=127,new Lz(o,l,r,u)}parseFDSelect(e,t){const i=this.bytes,s=i[e++],r=[];let a;switch(s){case 0:for(a=0;a<t;++a){const l=i[e++];r.push(l)}break;case 3:const o=i[e++]<<8|i[e++];for(a=0;a<o;++a){let l=i[e++]<<8|i[e++];a===0&&l!==0&&(ae("parseFDSelect: The first range must have a first GID of 0 -- trying to recover."),l=0);const c=i[e++],h=i[e]<<8|i[e+1];for(let u=l;u<h;++u)r.push(c)}e+=2;break;default:throw new Te(`parseFDSelect: Unknown format "${s}".`)}if(r.length!==t)throw new Te("parseFDSelect: Invalid font data.");return new Bz(s,r)}}class QR{constructor(){this.header=null,this.names=[],this.topDict=null,this.strings=new D4,this.globalSubrIndex=null,this.encoding=null,this.charset=null,this.charStrings=null,this.fdArray=[],this.fdSelect=null,this.isCIDFont=!1}duplicateFirstGlyph(){if(this.charStrings.count>=65535){ae("Not enough space in charstrings to duplicate first glyph.");return}const e=this.charStrings.get(0);this.charStrings.add(e),this.isCIDFont&&this.fdSelect.fdSelect.push(this.fdSelect.fdSelect[0])}hasGlyphId(e){return e<0||e>=this.charStrings.count?!1:this.charStrings.get(e).length>0}}class $R{constructor(e,t,i,s){this.major=e,this.minor=t,this.hdrSize=i,this.offSize=s}}class D4{constructor(){this.strings=[]}get(e){return e>=0&&e<=t9-1?h3[e]:e-t9<=this.strings.length?this.strings[e-t9]:h3[0]}getSID(e){let t=h3.indexOf(e);return t!==-1?t:(t=this.strings.indexOf(e),t!==-1?t+t9:-1)}add(e){this.strings.push(e)}get count(){return this.strings.length}}class Bh{constructor(){this.objects=[],this.length=0}add(e){this.length+=e.length,this.objects.push(e)}set(e,t){this.length+=t.length-this.objects[e].length,this.objects[e]=t}get(e){return this.objects[e]}get count(){return this.objects.length}}class eM{constructor(e,t){this.keyToNameMap=e.keyToNameMap,this.nameToKeyMap=e.nameToKeyMap,this.defaults=e.defaults,this.types=e.types,this.opcodes=e.opcodes,this.order=e.order,this.strings=t,this.values=Object.create(null)}setByKey(e,t){if(!(e in this.keyToNameMap))return!1;if(t.length===0)return!0;for(const s of t)if(isNaN(s))return ae(`Invalid CFFDict value: "${t}" for key "${e}".`),!0;const i=this.types[e];return(i==="num"||i==="sid"||i==="offset")&&(t=t[0]),this.values[e]=t,!0}setByName(e,t){if(!(e in this.nameToKeyMap))throw new Te(`Invalid dictionary name "${e}"`);this.values[this.nameToKeyMap[e]]=t}hasName(e){return this.nameToKeyMap[e]in this.values}getByName(e){if(!(e in this.nameToKeyMap))throw new Te(`Invalid dictionary name ${e}"`);const t=this.nameToKeyMap[e];return t in this.values?this.values[t]:this.defaults[t]}removeByName(e){delete this.values[this.nameToKeyMap[e]]}static createTables(e){const t={keyToNameMap:{},nameToKeyMap:{},defaults:{},types:{},opcodes:{},order:[]};for(const i of e){const s=Array.isArray(i[0])?(i[0][0]<<8)+i[0][1]:i[0];t.keyToNameMap[s]=i[1],t.nameToKeyMap[i[1]]=s,t.types[s]=i[2],t.defaults[s]=i[3],t.opcodes[s]=Array.isArray(i[0])?i[0]:[i[0]],t.order.push(s)}return t}}const Dz=[[[12,30],"ROS",["sid","sid","num"],null],[[12,20],"SyntheticBase","num",null],[0,"version","sid",null],[1,"Notice","sid",null],[[12,0],"Copyright","sid",null],[2,"FullName","sid",null],[3,"FamilyName","sid",null],[4,"Weight","sid",null],[[12,1],"isFixedPitch","num",0],[[12,2],"ItalicAngle","num",0],[[12,3],"UnderlinePosition","num",-100],[[12,4],"UnderlineThickness","num",50],[[12,5],"PaintType","num",0],[[12,6],"CharstringType","num",2],[[12,7],"FontMatrix",["num","num","num","num","num","num"],[.001,0,0,.001,0,0]],[13,"UniqueID","num",null],[5,"FontBBox",["num","num","num","num"],[0,0,0,0]],[[12,8],"StrokeWidth","num",0],[14,"XUID","array",null],[15,"charset","offset",0],[16,"Encoding","offset",0],[17,"CharStrings","offset",0],[18,"Private",["offset","offset"],null],[[12,21],"PostScript","sid",null],[[12,22],"BaseFontName","sid",null],[[12,23],"BaseFontBlend","delta",null],[[12,31],"CIDFontVersion","num",0],[[12,32],"CIDFontRevision","num",0],[[12,33],"CIDFontType","num",0],[[12,34],"CIDCount","num",8720],[[12,35],"UIDBase","num",null],[[12,37],"FDSelect","offset",null],[[12,36],"FDArray","offset",null],[[12,38],"FontName","sid",null]];class Jp extends eM{static get tables(){return We(this,"tables",this.createTables(Dz))}constructor(e){super(Jp.tables,e),this.privateDict=null}}const Fz=[[6,"BlueValues","delta",null],[7,"OtherBlues","delta",null],[8,"FamilyBlues","delta",null],[9,"FamilyOtherBlues","delta",null],[[12,9],"BlueScale","num",.039625],[[12,10],"BlueShift","num",7],[[12,11],"BlueFuzz","num",1],[10,"StdHW","num",null],[11,"StdVW","num",null],[[12,12],"StemSnapH","delta",null],[[12,13],"StemSnapV","delta",null],[[12,14],"ForceBold","num",0],[[12,17],"LanguageGroup","num",0],[[12,18],"ExpansionFactor","num",.06],[[12,19],"initialRandomSeed","num",0],[20,"defaultWidthX","num",0],[21,"nominalWidthX","num",0],[19,"Subrs","offset",null]];class Zp extends eM{static get tables(){return We(this,"tables",this.createTables(Fz))}constructor(e){super(Zp.tables,e),this.subrsIndex=null}}const Iw={ISO_ADOBE:0,EXPERT:1,EXPERT_SUBSET:2};class mp{constructor(e,t,i,s){this.predefined=e,this.format=t,this.charset=i,this.raw=s}}class Lz{constructor(e,t,i,s){this.predefined=e,this.format=t,this.encoding=i,this.raw=s}}class Bz{constructor(e,t){this.format=e,this.fdSelect=t}getFDIndex(e){return e<0||e>=this.fdSelect.length?-1:this.fdSelect[e]}}class yk{constructor(){this.offsets=Object.create(null)}isTracking(e){return e in this.offsets}track(e,t){if(e in this.offsets)throw new Te(`Already tracking location of ${e}`);this.offsets[e]=t}offset(e){for(const t in this.offsets)this.offsets[t]+=e}setEntryLocation(e,t,i){if(!(e in this.offsets))throw new Te(`Not tracking location of ${e}`);const s=i.data,r=this.offsets[e],a=5;for(let o=0,l=t.length;o<l;++o){const c=o*a+r,h=c+1,u=c+2,d=c+3,f=c+4;if(s[c]!==29||s[h]!==0||s[u]!==0||s[d]!==0||s[f]!==0)throw new Te("writing to an offset that is not empty");const g=t[o];s[c]=29,s[h]=g>>24&255,s[u]=g>>16&255,s[d]=g>>8&255,s[f]=g&255}}}class wx{constructor(e){this.cff=e}compile(){const e=this.cff,t={data:[],length:0,add(d){try{this.data.push(...d)}catch{this.data=this.data.concat(d)}this.length=this.data.length}},i=this.compileHeader(e.header);t.add(i);const s=this.compileNameIndex(e.names);if(t.add(s),e.isCIDFont&&e.topDict.hasName("FontMatrix")){const d=e.topDict.getByName("FontMatrix");e.topDict.removeByName("FontMatrix");for(const f of e.fdArray){let g=d.slice(0);f.hasName("FontMatrix")&&(g=Ln.transform(g,f.getByName("FontMatrix"))),f.setByName("FontMatrix",g)}}const r=e.topDict.getByName("XUID");(r==null?void 0:r.length)>16&&e.topDict.removeByName("XUID"),e.topDict.setByName("charset",0);let a=this.compileTopDicts([e.topDict],t.length,e.isCIDFont);t.add(a.output);const o=a.trackers[0],l=this.compileStringIndex(e.strings.strings);t.add(l);const c=this.compileIndex(e.globalSubrIndex);if(t.add(c),e.encoding&&e.topDict.hasName("Encoding"))if(e.encoding.predefined)o.setEntryLocation("Encoding",[e.encoding.format],t);else{const d=this.compileEncoding(e.encoding);o.setEntryLocation("Encoding",[t.length],t),t.add(d)}const h=this.compileCharset(e.charset,e.charStrings.count,e.strings,e.isCIDFont);o.setEntryLocation("charset",[t.length],t),t.add(h);const u=this.compileCharStrings(e.charStrings);if(o.setEntryLocation("CharStrings",[t.length],t),t.add(u),e.isCIDFont){o.setEntryLocation("FDSelect",[t.length],t);const d=this.compileFDSelect(e.fdSelect);t.add(d),a=this.compileTopDicts(e.fdArray,t.length,!0),o.setEntryLocation("FDArray",[t.length],t),t.add(a.output);const f=a.trackers;this.compilePrivateDicts(e.fdArray,f,t)}return this.compilePrivateDicts([e.topDict],[o],t),t.add([0]),t.data}encodeNumber(e){return Number.isInteger(e)?this.encodeInteger(e):this.encodeFloat(e)}static get EncodeFloatRegExp(){return We(this,"EncodeFloatRegExp",/\.(\d*?)(?:9{5,20}|0{5,20})\d{0,2}(?:e(.+)|$)/)}encodeFloat(e){let t=e.toString();const i=wx.EncodeFloatRegExp.exec(t);if(i){const l=parseFloat("1e"+((i[2]?+i[2]:0)+i[1].length));t=(Math.round(e*l)/l).toString()}let s="",r,a;for(r=0,a=t.length;r<a;++r){const l=t[r];l==="e"?s+=t[++r]==="-"?"c":"b":l==="."?s+="a":l==="-"?s+="e":s+=l}s+=s.length&1?"f":"ff";const o=[30];for(r=0,a=s.length;r<a;r+=2)o.push(parseInt(s.substring(r,r+2),16));return o}encodeInteger(e){let t;return e>=-107&&e<=107?t=[e+139]:e>=108&&e<=1131?(e-=108,t=[(e>>8)+247,e&255]):e>=-1131&&e<=-108?(e=-e-108,t=[(e>>8)+251,e&255]):e>=-32768&&e<=32767?t=[28,e>>8&255,e&255]:t=[29,e>>24&255,e>>16&255,e>>8&255,e&255],t}compileHeader(e){return[e.major,e.minor,4,e.offSize]}compileNameIndex(e){const t=new Bh;for(const i of e){const s=Math.min(i.length,127);let r=new Array(s);for(let a=0;a<s;a++){let o=i[a];(o<"!"||o>"~"||o==="["||o==="]"||o==="("||o===")"||o==="{"||o==="}"||o==="<"||o===">"||o==="/"||o==="%")&&(o="_"),r[a]=o}r=r.join(""),r===""&&(r="Bad_Font_Name"),t.add(gr(r))}return this.compileIndex(t)}compileTopDicts(e,t,i){const s=[];let r=new Bh;for(const a of e){i&&(a.removeByName("CIDFontVersion"),a.removeByName("CIDFontRevision"),a.removeByName("CIDFontType"),a.removeByName("CIDCount"),a.removeByName("UIDBase"));const o=new yk,l=this.compileDict(a,o);s.push(o),r.add(l),o.offset(t)}return r=this.compileIndex(r,s),{trackers:s,output:r}}compilePrivateDicts(e,t,i){for(let s=0,r=e.length;s<r;++s){const a=e[s],o=a.privateDict;if(!o||!a.hasName("Private"))throw new Te("There must be a private dictionary.");const l=new yk,c=this.compileDict(o,l);let h=i.length;if(l.offset(h),c.length||(h=0),t[s].setEntryLocation("Private",[c.length,h],i),i.add(c),o.subrsIndex&&o.hasName("Subrs")){const u=this.compileIndex(o.subrsIndex);l.setEntryLocation("Subrs",[c.length],i),i.add(u)}}}compileDict(e,t){const i=[];for(const s of e.order){if(!(s in e.values))continue;let r=e.values[s],a=e.types[s];if(Array.isArray(a)||(a=[a]),Array.isArray(r)||(r=[r]),r.length!==0){for(let o=0,l=a.length;o<l;++o){const c=a[o],h=r[o];switch(c){case"num":case"sid":i.push(...this.encodeNumber(h));break;case"offset":const u=e.keyToNameMap[s];t.isTracking(u)||t.track(u,i.length),i.push(29,0,0,0,0);break;case"array":case"delta":i.push(...this.encodeNumber(h));for(let d=1,f=r.length;d<f;++d)i.push(...this.encodeNumber(r[d]));break;default:throw new Te(`Unknown data type of ${c}`)}}i.push(...e.opcodes[s])}}return i}compileStringIndex(e){const t=new Bh;for(const i of e)t.add(gr(i));return this.compileIndex(t)}compileCharStrings(e){const t=new Bh;for(let i=0;i<e.count;i++){const s=e.get(i);if(s.length===0){t.add(new Uint8Array([139,14]));continue}t.add(s)}return this.compileIndex(t)}compileCharset(e,t,i,s){let r;const a=t-1;if(s){const o=a-1;r=new Uint8Array([2,0,1,o>>8&255,o&255])}else{const o=1+a*2;r=new Uint8Array(o),r[0]=0;let l=0;const c=e.charset.length;let h=!1;for(let u=1;u<r.length;u+=2){let d=0;if(l<c){const f=e.charset[l++];d=i.getSID(f),d===-1&&(d=0,h||(h=!0,ae(`Couldn't find ${f} in CFF strings`)))}r[u]=d>>8&255,r[u+1]=d&255}}return this.compileTypedArray(r)}compileEncoding(e){return this.compileTypedArray(e.raw)}compileFDSelect(e){const t=e.format;let i,s;switch(t){case 0:for(i=new Uint8Array(1+e.fdSelect.length),i[0]=t,s=0;s<e.fdSelect.length;s++)i[s+1]=e.fdSelect[s];break;case 3:const r=0;let a=e.fdSelect[0];const o=[t,0,0,r>>8&255,r&255,a];for(s=1;s<e.fdSelect.length;s++){const c=e.fdSelect[s];c!==a&&(o.push(s>>8&255,s&255,c),a=c)}const l=(o.length-3)/3;o[1]=l>>8&255,o[2]=l&255,o.push(s>>8&255,s&255),i=new Uint8Array(o);break}return this.compileTypedArray(i)}compileTypedArray(e){return Array.from(e)}compileIndex(e,t=[]){const i=e.objects,s=i.length;if(s===0)return[0,0];const r=[s>>8&255,s&255];let a=1,o;for(o=0;o<s;++o)a+=i[o].length;let l;a<256?l=1:a<65536?l=2:a<16777216?l=3:l=4,r.push(l);let c=1;for(o=0;o<s+1;o++)l===1?r.push(c&255):l===2?r.push(c>>8&255,c&255):l===3?r.push(c>>16&255,c>>8&255,c&255):r.push(c>>>24&255,c>>16&255,c>>8&255,c&255),i[o]&&(c+=i[o].length);for(o=0;o<s;o++)t[o]&&t[o].offset(r.length),r.push(...i[o]);return r}}const hy=Ei(function(n){n["Times-Roman"]="Times-Roman",n.Helvetica="Helvetica",n.Courier="Courier",n.Symbol="Symbol",n["Times-Bold"]="Times-Bold",n["Helvetica-Bold"]="Helvetica-Bold",n["Courier-Bold"]="Courier-Bold",n.ZapfDingbats="ZapfDingbats",n["Times-Italic"]="Times-Italic",n["Helvetica-Oblique"]="Helvetica-Oblique",n["Courier-Oblique"]="Courier-Oblique",n["Times-BoldItalic"]="Times-BoldItalic",n["Helvetica-BoldOblique"]="Helvetica-BoldOblique",n["Courier-BoldOblique"]="Courier-BoldOblique",n.ArialNarrow="Helvetica",n["ArialNarrow-Bold"]="Helvetica-Bold",n["ArialNarrow-BoldItalic"]="Helvetica-BoldOblique",n["ArialNarrow-Italic"]="Helvetica-Oblique",n.ArialBlack="Helvetica",n["ArialBlack-Bold"]="Helvetica-Bold",n["ArialBlack-BoldItalic"]="Helvetica-BoldOblique",n["ArialBlack-Italic"]="Helvetica-Oblique",n["Arial-Black"]="Helvetica",n["Arial-Black-Bold"]="Helvetica-Bold",n["Arial-Black-BoldItalic"]="Helvetica-BoldOblique",n["Arial-Black-Italic"]="Helvetica-Oblique",n.Arial="Helvetica",n["Arial-Bold"]="Helvetica-Bold",n["Arial-BoldItalic"]="Helvetica-BoldOblique",n["Arial-Italic"]="Helvetica-Oblique",n.ArialMT="Helvetica",n["Arial-BoldItalicMT"]="Helvetica-BoldOblique",n["Arial-BoldMT"]="Helvetica-Bold",n["Arial-ItalicMT"]="Helvetica-Oblique",n["Arial-BoldItalicMT-BoldItalic"]="Helvetica-BoldOblique",n["Arial-BoldMT-Bold"]="Helvetica-Bold",n["Arial-ItalicMT-Italic"]="Helvetica-Oblique",n.ArialUnicodeMS="Helvetica",n["ArialUnicodeMS-Bold"]="Helvetica-Bold",n["ArialUnicodeMS-BoldItalic"]="Helvetica-BoldOblique",n["ArialUnicodeMS-Italic"]="Helvetica-Oblique",n["Courier-BoldItalic"]="Courier-BoldOblique",n["Courier-Italic"]="Courier-Oblique",n.CourierNew="Courier",n["CourierNew-Bold"]="Courier-Bold",n["CourierNew-BoldItalic"]="Courier-BoldOblique",n["CourierNew-Italic"]="Courier-Oblique",n["CourierNewPS-BoldItalicMT"]="Courier-BoldOblique",n["CourierNewPS-BoldMT"]="Courier-Bold",n["CourierNewPS-ItalicMT"]="Courier-Oblique",n.CourierNewPSMT="Courier",n["Helvetica-BoldItalic"]="Helvetica-BoldOblique",n["Helvetica-Italic"]="Helvetica-Oblique",n["HelveticaLTStd-Bold"]="Helvetica-Bold",n["Symbol-Bold"]="Symbol",n["Symbol-BoldItalic"]="Symbol",n["Symbol-Italic"]="Symbol",n.TimesNewRoman="Times-Roman",n["TimesNewRoman-Bold"]="Times-Bold",n["TimesNewRoman-BoldItalic"]="Times-BoldItalic",n["TimesNewRoman-Italic"]="Times-Italic",n.TimesNewRomanPS="Times-Roman",n["TimesNewRomanPS-Bold"]="Times-Bold",n["TimesNewRomanPS-BoldItalic"]="Times-BoldItalic",n["TimesNewRomanPS-BoldItalicMT"]="Times-BoldItalic",n["TimesNewRomanPS-BoldMT"]="Times-Bold",n["TimesNewRomanPS-Italic"]="Times-Italic",n["TimesNewRomanPS-ItalicMT"]="Times-Italic",n.TimesNewRomanPSMT="Times-Roman",n["TimesNewRomanPSMT-Bold"]="Times-Bold",n["TimesNewRomanPSMT-BoldItalic"]="Times-BoldItalic",n["TimesNewRomanPSMT-Italic"]="Times-Italic"}),Uz=Ei(function(n){n.Courier="FoxitFixed.pfb",n["Courier-Bold"]="FoxitFixedBold.pfb",n["Courier-BoldOblique"]="FoxitFixedBoldItalic.pfb",n["Courier-Oblique"]="FoxitFixedItalic.pfb",n.Helvetica="LiberationSans-Regular.ttf",n["Helvetica-Bold"]="LiberationSans-Bold.ttf",n["Helvetica-BoldOblique"]="LiberationSans-BoldItalic.ttf",n["Helvetica-Oblique"]="LiberationSans-Italic.ttf",n["Times-Roman"]="FoxitSerif.pfb",n["Times-Bold"]="FoxitSerifBold.pfb",n["Times-BoldItalic"]="FoxitSerifBoldItalic.pfb",n["Times-Italic"]="FoxitSerifItalic.pfb",n.Symbol="FoxitSymbol.pfb",n.ZapfDingbats="FoxitDingbats.pfb",n["LiberationSans-Regular"]="LiberationSans-Regular.ttf",n["LiberationSans-Bold"]="LiberationSans-Bold.ttf",n["LiberationSans-Italic"]="LiberationSans-Italic.ttf",n["LiberationSans-BoldItalic"]="LiberationSans-BoldItalic.ttf"}),tM=Ei(function(n){n.Calibri="Helvetica",n["Calibri-Bold"]="Helvetica-Bold",n["Calibri-BoldItalic"]="Helvetica-BoldOblique",n["Calibri-Italic"]="Helvetica-Oblique",n.CenturyGothic="Helvetica",n["CenturyGothic-Bold"]="Helvetica-Bold",n["CenturyGothic-BoldItalic"]="Helvetica-BoldOblique",n["CenturyGothic-Italic"]="Helvetica-Oblique",n.ComicSansMS="Comic Sans MS",n["ComicSansMS-Bold"]="Comic Sans MS-Bold",n["ComicSansMS-BoldItalic"]="Comic Sans MS-BoldItalic",n["ComicSansMS-Italic"]="Comic Sans MS-Italic",n.GillSansMT="Helvetica",n["GillSansMT-Bold"]="Helvetica-Bold",n["GillSansMT-BoldItalic"]="Helvetica-BoldOblique",n["GillSansMT-Italic"]="Helvetica-Oblique",n.Impact="Helvetica",n["ItcSymbol-Bold"]="Helvetica-Bold",n["ItcSymbol-BoldItalic"]="Helvetica-BoldOblique",n["ItcSymbol-Book"]="Helvetica",n["ItcSymbol-BookItalic"]="Helvetica-Oblique",n["ItcSymbol-Medium"]="Helvetica",n["ItcSymbol-MediumItalic"]="Helvetica-Oblique",n.LucidaConsole="Courier",n["LucidaConsole-Bold"]="Courier-Bold",n["LucidaConsole-BoldItalic"]="Courier-BoldOblique",n["LucidaConsole-Italic"]="Courier-Oblique",n["LucidaSans-Demi"]="Helvetica-Bold",n["MS-Gothic"]="MS Gothic",n["MS-Gothic-Bold"]="MS Gothic-Bold",n["MS-Gothic-BoldItalic"]="MS Gothic-BoldItalic",n["MS-Gothic-Italic"]="MS Gothic-Italic",n["MS-Mincho"]="MS Mincho",n["MS-Mincho-Bold"]="MS Mincho-Bold",n["MS-Mincho-BoldItalic"]="MS Mincho-BoldItalic",n["MS-Mincho-Italic"]="MS Mincho-Italic",n["MS-PGothic"]="MS PGothic",n["MS-PGothic-Bold"]="MS PGothic-Bold",n["MS-PGothic-BoldItalic"]="MS PGothic-BoldItalic",n["MS-PGothic-Italic"]="MS PGothic-Italic",n["MS-PMincho"]="MS PMincho",n["MS-PMincho-Bold"]="MS PMincho-Bold",n["MS-PMincho-BoldItalic"]="MS PMincho-BoldItalic",n["MS-PMincho-Italic"]="MS PMincho-Italic",n.NuptialScript="Times-Italic",n.SegoeUISymbol="Helvetica"}),F4=Ei(function(n){n["Adobe Jenson"]=!0,n["Adobe Text"]=!0,n.Albertus=!0,n.Aldus=!0,n.Alexandria=!0,n.Algerian=!0,n["American Typewriter"]=!0,n.Antiqua=!0,n.Apex=!0,n.Arno=!0,n.Aster=!0,n.Aurora=!0,n.Baskerville=!0,n.Bell=!0,n.Bembo=!0,n["Bembo Schoolbook"]=!0,n.Benguiat=!0,n["Berkeley Old Style"]=!0,n["Bernhard Modern"]=!0,n["Berthold City"]=!0,n.Bodoni=!0,n["Bauer Bodoni"]=!0,n["Book Antiqua"]=!0,n.Bookman=!0,n["Bordeaux Roman"]=!0,n["Californian FB"]=!0,n.Calisto=!0,n.Calvert=!0,n.Capitals=!0,n.Cambria=!0,n.Cartier=!0,n.Caslon=!0,n.Catull=!0,n.Centaur=!0,n["Century Old Style"]=!0,n["Century Schoolbook"]=!0,n.Chaparral=!0,n["Charis SIL"]=!0,n.Cheltenham=!0,n["Cholla Slab"]=!0,n.Clarendon=!0,n.Clearface=!0,n.Cochin=!0,n.Colonna=!0,n["Computer Modern"]=!0,n["Concrete Roman"]=!0,n.Constantia=!0,n["Cooper Black"]=!0,n.Corona=!0,n.Ecotype=!0,n.Egyptienne=!0,n.Elephant=!0,n.Excelsior=!0,n.Fairfield=!0,n["FF Scala"]=!0,n.Folkard=!0,n.Footlight=!0,n.FreeSerif=!0,n["Friz Quadrata"]=!0,n.Garamond=!0,n.Gentium=!0,n.Georgia=!0,n.Gloucester=!0,n["Goudy Old Style"]=!0,n["Goudy Schoolbook"]=!0,n["Goudy Pro Font"]=!0,n.Granjon=!0,n["Guardian Egyptian"]=!0,n.Heather=!0,n.Hercules=!0,n["High Tower Text"]=!0,n.Hiroshige=!0,n["Hoefler Text"]=!0,n["Humana Serif"]=!0,n.Imprint=!0,n["Ionic No. 5"]=!0,n.Janson=!0,n.Joanna=!0,n.Korinna=!0,n.Lexicon=!0,n.LiberationSerif=!0,n["Liberation Serif"]=!0,n["Linux Libertine"]=!0,n.Literaturnaya=!0,n.Lucida=!0,n["Lucida Bright"]=!0,n.Melior=!0,n.Memphis=!0,n.Miller=!0,n.Minion=!0,n.Modern=!0,n["Mona Lisa"]=!0,n["Mrs Eaves"]=!0,n["MS Serif"]=!0,n["Museo Slab"]=!0,n["New York"]=!0,n["Nimbus Roman"]=!0,n["NPS Rawlinson Roadway"]=!0,n.NuptialScript=!0,n.Palatino=!0,n.Perpetua=!0,n.Plantin=!0,n["Plantin Schoolbook"]=!0,n.Playbill=!0,n["Poor Richard"]=!0,n["Rawlinson Roadway"]=!0,n.Renault=!0,n.Requiem=!0,n.Rockwell=!0,n.Roman=!0,n["Rotis Serif"]=!0,n.Sabon=!0,n.Scala=!0,n.Seagull=!0,n.Sistina=!0,n.Souvenir=!0,n.STIX=!0,n["Stone Informal"]=!0,n["Stone Serif"]=!0,n.Sylfaen=!0,n.Times=!0,n.Trajan=!0,n.Trinité=!0,n["Trump Mediaeval"]=!0,n.Utopia=!0,n["Vale Type"]=!0,n["Bitstream Vera"]=!0,n["Vera Serif"]=!0,n.Versailles=!0,n.Wanted=!0,n.Weiss=!0,n["Wide Latin"]=!0,n.Windsor=!0,n.XITS=!0}),e6=Ei(function(n){n.Dingbats=!0,n.Symbol=!0,n.ZapfDingbats=!0,n.Wingdings=!0,n["Wingdings-Bold"]=!0,n["Wingdings-Regular"]=!0}),wk=Ei(function(n){n[2]=10,n[3]=32,n[4]=33,n[5]=34,n[6]=35,n[7]=36,n[8]=37,n[9]=38,n[10]=39,n[11]=40,n[12]=41,n[13]=42,n[14]=43,n[15]=44,n[16]=45,n[17]=46,n[18]=47,n[19]=48,n[20]=49,n[21]=50,n[22]=51,n[23]=52,n[24]=53,n[25]=54,n[26]=55,n[27]=56,n[28]=57,n[29]=58,n[30]=894,n[31]=60,n[32]=61,n[33]=62,n[34]=63,n[35]=64,n[36]=65,n[37]=66,n[38]=67,n[39]=68,n[40]=69,n[41]=70,n[42]=71,n[43]=72,n[44]=73,n[45]=74,n[46]=75,n[47]=76,n[48]=77,n[49]=78,n[50]=79,n[51]=80,n[52]=81,n[53]=82,n[54]=83,n[55]=84,n[56]=85,n[57]=86,n[58]=87,n[59]=88,n[60]=89,n[61]=90,n[62]=91,n[63]=92,n[64]=93,n[65]=94,n[66]=95,n[67]=96,n[68]=97,n[69]=98,n[70]=99,n[71]=100,n[72]=101,n[73]=102,n[74]=103,n[75]=104,n[76]=105,n[77]=106,n[78]=107,n[79]=108,n[80]=109,n[81]=110,n[82]=111,n[83]=112,n[84]=113,n[85]=114,n[86]=115,n[87]=116,n[88]=117,n[89]=118,n[90]=119,n[91]=120,n[92]=121,n[93]=122,n[94]=123,n[95]=124,n[96]=125,n[97]=126,n[98]=196,n[99]=197,n[100]=199,n[101]=201,n[102]=209,n[103]=214,n[104]=220,n[105]=225,n[106]=224,n[107]=226,n[108]=228,n[109]=227,n[110]=229,n[111]=231,n[112]=233,n[113]=232,n[114]=234,n[115]=235,n[116]=237,n[117]=236,n[118]=238,n[119]=239,n[120]=241,n[121]=243,n[122]=242,n[123]=244,n[124]=246,n[125]=245,n[126]=250,n[127]=249,n[128]=251,n[129]=252,n[130]=8224,n[131]=176,n[132]=162,n[133]=163,n[134]=167,n[135]=8226,n[136]=182,n[137]=223,n[138]=174,n[139]=169,n[140]=8482,n[141]=180,n[142]=168,n[143]=8800,n[144]=198,n[145]=216,n[146]=8734,n[147]=177,n[148]=8804,n[149]=8805,n[150]=165,n[151]=181,n[152]=8706,n[153]=8721,n[154]=8719,n[156]=8747,n[157]=170,n[158]=186,n[159]=8486,n[160]=230,n[161]=248,n[162]=191,n[163]=161,n[164]=172,n[165]=8730,n[166]=402,n[167]=8776,n[168]=8710,n[169]=171,n[170]=187,n[171]=8230,n[179]=8220,n[180]=8221,n[181]=8216,n[182]=8217,n[200]=193,n[203]=205,n[207]=211,n[210]=218,n[223]=711,n[224]=321,n[225]=322,n[226]=352,n[227]=353,n[228]=381,n[229]=382,n[233]=221,n[234]=253,n[252]=263,n[253]=268,n[254]=269,n[258]=258,n[260]=260,n[261]=261,n[265]=280,n[266]=281,n[267]=282,n[268]=283,n[269]=313,n[275]=323,n[276]=324,n[278]=328,n[283]=344,n[284]=345,n[285]=346,n[286]=347,n[292]=367,n[295]=377,n[296]=378,n[298]=380,n[305]=963,n[306]=964,n[307]=966,n[308]=8215,n[309]=8252,n[310]=8319,n[311]=8359,n[312]=8592,n[313]=8593,n[337]=9552,n[493]=1039,n[494]=1040,n[570]=1040,n[571]=1041,n[572]=1042,n[573]=1043,n[574]=1044,n[575]=1045,n[576]=1046,n[577]=1047,n[578]=1048,n[579]=1049,n[580]=1050,n[581]=1051,n[582]=1052,n[583]=1053,n[584]=1054,n[585]=1055,n[586]=1056,n[587]=1057,n[588]=1058,n[589]=1059,n[590]=1060,n[591]=1061,n[592]=1062,n[593]=1063,n[594]=1064,n[595]=1065,n[596]=1066,n[597]=1067,n[598]=1068,n[599]=1069,n[600]=1070,n[672]=1488,n[673]=1489,n[674]=1490,n[675]=1491,n[676]=1492,n[677]=1493,n[678]=1494,n[679]=1495,n[680]=1496,n[681]=1497,n[682]=1498,n[683]=1499,n[684]=1500,n[685]=1501,n[686]=1502,n[687]=1503,n[688]=1504,n[689]=1505,n[690]=1506,n[691]=1507,n[692]=1508,n[693]=1509,n[694]=1510,n[695]=1511,n[696]=1512,n[697]=1513,n[698]=1514,n[705]=1524,n[706]=8362,n[710]=64288,n[711]=64298,n[759]=1617,n[761]=1776,n[763]=1778,n[775]=1652,n[777]=1764,n[778]=1780,n[779]=1781,n[780]=1782,n[782]=771,n[783]=64726,n[786]=8363,n[788]=8532,n[790]=768,n[791]=769,n[792]=768,n[795]=803,n[797]=64336,n[798]=64337,n[799]=64342,n[800]=64343,n[801]=64344,n[802]=64345,n[803]=64362,n[804]=64363,n[805]=64364,n[2424]=7821,n[2425]=7822,n[2426]=7823,n[2427]=7824,n[2428]=7825,n[2429]=7826,n[2430]=7827,n[2433]=7682,n[2678]=8045,n[2679]=8046,n[2830]=1552,n[2838]=686,n[2840]=751,n[2842]=753,n[2843]=754,n[2844]=755,n[2846]=757,n[2856]=767,n[2857]=848,n[2858]=849,n[2862]=853,n[2863]=854,n[2864]=855,n[2865]=861,n[2866]=862,n[2906]=7460,n[2908]=7462,n[2909]=7463,n[2910]=7464,n[2912]=7466,n[2913]=7467,n[2914]=7468,n[2916]=7470,n[2917]=7471,n[2918]=7472,n[2920]=7474,n[2921]=7475,n[2922]=7476,n[2924]=7478,n[2925]=7479,n[2926]=7480,n[2928]=7482,n[2929]=7483,n[2930]=7484,n[2932]=7486,n[2933]=7487,n[2934]=7488,n[2936]=7490,n[2937]=7491,n[2938]=7492,n[2940]=7494,n[2941]=7495,n[2942]=7496,n[2944]=7498,n[2946]=7500,n[2948]=7502,n[2950]=7504,n[2951]=7505,n[2952]=7506,n[2954]=7508,n[2955]=7509,n[2956]=7510,n[2958]=7512,n[2959]=7513,n[2960]=7514,n[2962]=7516,n[2963]=7517,n[2964]=7518,n[2966]=7520,n[2967]=7521,n[2968]=7522,n[2970]=7524,n[2971]=7525,n[2972]=7526,n[2974]=7528,n[2975]=7529,n[2976]=7530,n[2978]=1537,n[2979]=1538,n[2980]=1539,n[2982]=1549,n[2983]=1551,n[2984]=1552,n[2986]=1554,n[2987]=1555,n[2988]=1556,n[2990]=1623,n[2991]=1624,n[2995]=1775,n[2999]=1791,n[3002]=64290,n[3003]=64291,n[3004]=64292,n[3006]=64294,n[3007]=64295,n[3008]=64296,n[3011]=1900,n[3014]=8223,n[3015]=8244,n[3017]=7532,n[3018]=7533,n[3019]=7534,n[3075]=7590,n[3076]=7591,n[3079]=7594,n[3080]=7595,n[3083]=7598,n[3084]=7599,n[3087]=7602,n[3088]=7603,n[3091]=7606,n[3092]=7607,n[3095]=7610,n[3096]=7611,n[3099]=7614,n[3100]=7615,n[3103]=7618,n[3104]=7619,n[3107]=8337,n[3108]=8338,n[3116]=1884,n[3119]=1885,n[3120]=1885,n[3123]=1886,n[3124]=1886,n[3127]=1887,n[3128]=1887,n[3131]=1888,n[3132]=1888,n[3135]=1889,n[3136]=1889,n[3139]=1890,n[3140]=1890,n[3143]=1891,n[3144]=1891,n[3147]=1892,n[3148]=1892,n[3153]=580,n[3154]=581,n[3157]=584,n[3158]=585,n[3161]=588,n[3162]=589,n[3165]=891,n[3166]=892,n[3169]=1274,n[3170]=1275,n[3173]=1278,n[3174]=1279,n[3181]=7622,n[3182]=7623,n[3282]=11799,n[3316]=578,n[3379]=42785,n[3393]=1159,n[3416]=8377}),Hz=Ei(function(n){n[227]=322,n[264]=261,n[291]=346}),zz=Ei(function(n){n[1]=32,n[4]=65,n[5]=192,n[6]=193,n[9]=196,n[17]=66,n[18]=67,n[21]=268,n[24]=68,n[28]=69,n[29]=200,n[30]=201,n[32]=282,n[38]=70,n[39]=71,n[44]=72,n[47]=73,n[48]=204,n[49]=205,n[58]=74,n[60]=75,n[62]=76,n[68]=77,n[69]=78,n[75]=79,n[76]=210,n[80]=214,n[87]=80,n[89]=81,n[90]=82,n[92]=344,n[94]=83,n[97]=352,n[100]=84,n[104]=85,n[109]=220,n[115]=86,n[116]=87,n[121]=88,n[122]=89,n[124]=221,n[127]=90,n[129]=381,n[258]=97,n[259]=224,n[260]=225,n[263]=228,n[268]=261,n[271]=98,n[272]=99,n[273]=263,n[275]=269,n[282]=100,n[286]=101,n[287]=232,n[288]=233,n[290]=283,n[295]=281,n[296]=102,n[336]=103,n[346]=104,n[349]=105,n[350]=236,n[351]=237,n[361]=106,n[364]=107,n[367]=108,n[371]=322,n[373]=109,n[374]=110,n[381]=111,n[382]=242,n[383]=243,n[386]=246,n[393]=112,n[395]=113,n[396]=114,n[398]=345,n[400]=115,n[401]=347,n[403]=353,n[410]=116,n[437]=117,n[442]=252,n[448]=118,n[449]=119,n[454]=120,n[455]=121,n[457]=253,n[460]=122,n[462]=382,n[463]=380,n[853]=44,n[855]=58,n[856]=46,n[876]=47,n[878]=45,n[882]=45,n[894]=40,n[895]=41,n[896]=91,n[897]=93,n[923]=64,n[940]=163,n[1004]=48,n[1005]=49,n[1006]=50,n[1007]=51,n[1008]=52,n[1009]=53,n[1010]=54,n[1011]=55,n[1012]=56,n[1013]=57,n[1081]=37,n[1085]=43,n[1086]=45});function _k(n){const e=yx(n);return hy()[e]}function vk(n){const e=yx(n);return!!(hy()[e]||tM()[e]||F4()[e]||e6()[e])}class pp{constructor(e=[]){this._map=e}get length(){return this._map.length}forEach(e){for(const t in this._map)e(t,this._map[t].codePointAt(0))}has(e){return this._map[e]!==void 0}get(e){return this._map[e]}charCodeOf(e){const t=this._map;if(t.length<=65536)return t.indexOf(e);for(const i in t)if(t[i]===e)return i|0;return-1}amend(e){for(const t in e)this._map[t]=e[t]}}class yo{constructor(e,t){this.firstChar=e,this.lastChar=t}get length(){return this.lastChar+1-this.firstChar}forEach(e){for(let t=this.firstChar,i=this.lastChar;t<=i;t++)e(t,t)}has(e){return this.firstChar<=e&&e<=this.lastChar}get(e){if(this.firstChar<=e&&e<=this.lastChar)return String.fromCharCode(e)}charCodeOf(e){return Number.isInteger(e)&&e>=this.firstChar&&e<=this.lastChar?e:-1}amend(e){Cn("Should not call amend()")}}class Ew{constructor(e,t){this.properties=t;const i=new O4(e,t,h1);this.cff=i.parse(),this.cff.duplicateFirstGlyph();const s=new wx(this.cff);this.seacs=this.cff.seacs;try{this.data=s.compile()}catch{ae("Failed to compile font "+t.loadedName),this.data=e}this._createBuiltInEncoding()}get numGlyphs(){return this.cff.charStrings.count}getCharset(){return this.cff.charset.charset}getGlyphMapping(){const e=this.cff,t=this.properties,{cidToGidMap:i,cMap:s}=t,r=e.charset.charset;let a,o;if(t.composite){let c;if((i==null?void 0:i.length)>0){c=Object.create(null);for(let u=0,d=i.length;u<d;u++){const f=i[u];f!==void 0&&(c[f]=u)}}a=Object.create(null);let h;if(e.isCIDFont)for(o=0;o<r.length;o++){const u=r[o];h=s.charCodeOf(u),(c==null?void 0:c[h])!==void 0&&(h=c[h]),a[h]=o}else for(o=0;o<e.charStrings.count;o++)h=s.charCodeOf(o),a[h]=o;return a}let l=e.encoding?e.encoding.encoding:null;return t.isInternalFont&&(l=t.defaultEncoding),a=ZR(t,l,r),a}hasGlyphId(e){return this.cff.hasGlyphId(e)}_createBuiltInEncoding(){const{charset:e,encoding:t}=this.cff;if(!e||!t)return;const i=e.charset,s=t.encoding,r=[];for(const a in s){const o=s[a];if(o>=0){const l=i[o];l&&(r[a]=l)}}r.length>0&&(this.properties.builtInEncoding=r)}}function ru(n,e){return a0(n,e)/16384}function t6(n){const e=n.length;let t=32768;return e<1240?t=107:e<33900&&(t=1131),t}function jz(n,e,t){const i=wn(n,e+2)===1?Jn(n,e+8):Jn(n,e+16),s=wn(n,e+i);let r,a,o;if(s===4){wn(n,e+i+2);const l=wn(n,e+i+6)>>1;for(a=e+i+14,r=[],o=0;o<l;o++,a+=2)r[o]={end:wn(n,a)};for(a+=2,o=0;o<l;o++,a+=2)r[o].start=wn(n,a);for(o=0;o<l;o++,a+=2)r[o].idDelta=wn(n,a);for(o=0;o<l;o++,a+=2){let c=wn(n,a);if(c!==0){r[o].ids=[];for(let h=0,u=r[o].end-r[o].start+1;h<u;h++)r[o].ids[h]=wn(n,a+c),c+=2}}return r}else if(s===12){const l=Jn(n,e+i+12);for(a=e+i+16,r=[],o=0;o<l;o++)e=Jn(n,a),r.push({start:e,end:Jn(n,a+4),idDelta:Jn(n,a+8)-e}),a+=12;return r}throw new Te(`unsupported cmap: ${s}`)}function Gz(n,e,t,i){var o,l,c;const s={},a=new O4(new ji(n,e,t-e),s,i).parse();return{glyphs:a.charStrings.objects,subrs:(l=(o=a.topDict.privateDict)==null?void 0:o.subrsIndex)==null?void 0:l.objects,gsubrs:(c=a.globalSubrIndex)==null?void 0:c.objects,isCFFCIDFont:a.isCIDFont,fdSelect:a.fdSelect,fdArray:a.fdArray}}function Vz(n,e,t){let i,s;t?(i=4,s=Jn):(i=2,s=(o,l)=>2*wn(o,l));const r=[];let a=s(e,0);for(let o=i;o<e.length;o+=i){const l=s(e,o);r.push(n.subarray(a,l)),a=l}return r}function B3(n,e){const t=e.codePointAt(0);let i=0,s=0,r=n.length-1;for(;s<r;){const a=s+r+1>>1;t<n[a].start?r=a-1:s=a}return n[s].start<=t&&t<=n[s].end&&(i=n[s].idDelta+(n[s].ids?n[s].ids[t-n[s].start]:t)&65535),{charCode:t,glyphId:i}}function nM(n,e,t){function i(d,f){c&&e.add("L",c),c=[d,f],e.add("M",[d,f])}function s(d,f){e.add("L",[d,f])}function r(d,f,g,m){e.add("Q",[d,f,g,m])}let a=0;const o=a0(n,a);let l,c=null,h=0,u=0;if(a+=10,o<0)do{l=wn(n,a);const d=wn(n,a+2);a+=4;let f,g;l&1?(l&2?(f=a0(n,a),g=a0(n,a+2)):(f=wn(n,a),g=wn(n,a+2)),a+=4):l&2?(f=Il(n,a++),g=Il(n,a++)):(f=n[a++],g=n[a++]),l&2?(h=f,u=g):(h=0,u=0);let m=1,b=1,p=0,y=0;l&8?(m=b=ru(n,a),a+=2):l&64?(m=ru(n,a),b=ru(n,a+2),a+=4):l&128&&(m=ru(n,a),p=ru(n,a+2),y=ru(n,a+4),b=ru(n,a+6),a+=8);const w=t.glyphs[d];w&&(e.save(),e.transform([m,p,y,b,h,u]),nM(w,e,t),e.restore())}while(l&32);else{const d=[];let f,g;for(f=0;f<o;f++)d.push(wn(n,a)),a+=2;const m=wn(n,a);a+=2+m;const b=d.at(-1)+1,p=[];for(;p.length<b;){l=n[a++];let w=1;for(l&8&&(w+=n[a++]);w-- >0;)p.push({flags:l})}for(f=0;f<b;f++){switch(p[f].flags&18){case 0:h+=a0(n,a),a+=2;break;case 2:h-=n[a++];break;case 18:h+=n[a++];break}p[f].x=h}for(f=0;f<b;f++){switch(p[f].flags&36){case 0:u+=a0(n,a),a+=2;break;case 4:u-=n[a++];break;case 36:u+=n[a++];break}p[f].y=u}let y=0;for(a=0;a<o;a++){const w=d[a],_=p.slice(y,w+1);if(_[0].flags&1)_.push(_[0]);else if(_.at(-1).flags&1)_.unshift(_.at(-1));else{const v={flags:1,x:(_[0].x+_.at(-1).x)/2,y:(_[0].y+_.at(-1).y)/2};_.unshift(v),_.push(v)}for(i(_[0].x,_[0].y),f=1,g=_.length;f<g;f++)_[f].flags&1?s(_[f].x,_[f].y):_[f+1].flags&1?(r(_[f].x,_[f].y,_[f+1].x,_[f+1].y),f++):r(_[f].x,_[f].y,(_[f].x+_[f+1].x)/2,(_[f].y+_[f+1].y)/2);y=w+1}}}function n6(n,e,t,i){function s(f,g){u&&e.add("L",u),u=[f,g],e.add("M",[f,g])}function r(f,g){e.add("L",[f,g])}function a(f,g,m,b,p,y){e.add("C",[f,g,m,b,p,y])}const o=[];let l=0,c=0,h=0,u=null;function d(f){var m;let g=0;for(;g<f.length;){let b=!1,p=f[g++],y,w,_,v,C,k,I,E,T;switch(p){case 1:h+=o.length>>1,b=!0;break;case 3:h+=o.length>>1,b=!0;break;case 4:c+=o.pop(),s(l,c),b=!0;break;case 5:for(;o.length>0;)l+=o.shift(),c+=o.shift(),r(l,c);break;case 6:for(;o.length>0&&(l+=o.shift(),r(l,c),o.length!==0);)c+=o.shift(),r(l,c);break;case 7:for(;o.length>0&&(c+=o.shift(),r(l,c),o.length!==0);)l+=o.shift(),r(l,c);break;case 8:for(;o.length>0;)y=l+o.shift(),_=c+o.shift(),w=y+o.shift(),v=_+o.shift(),l=w+o.shift(),c=v+o.shift(),a(y,_,w,v,l,c);break;case 10:if(E=o.pop(),T=null,t.isCFFCIDFont){const M=t.fdSelect.getFDIndex(i);if(M>=0&&M<t.fdArray.length){const D=t.fdArray[M];let H;(m=D.privateDict)!=null&&m.subrsIndex&&(H=D.privateDict.subrsIndex.objects),H&&(E+=t6(H),T=H[E])}else ae("Invalid fd index for glyph index.")}else T=t.subrs[E+t.subrsBias];T&&d(T);break;case 11:return;case 12:switch(p=f[g++],p){case 34:y=l+o.shift(),w=y+o.shift(),C=c+o.shift(),l=w+o.shift(),a(y,c,w,C,l,C),y=l+o.shift(),w=y+o.shift(),l=w+o.shift(),a(y,C,w,c,l,c);break;case 35:y=l+o.shift(),_=c+o.shift(),w=y+o.shift(),v=_+o.shift(),l=w+o.shift(),c=v+o.shift(),a(y,_,w,v,l,c),y=l+o.shift(),_=c+o.shift(),w=y+o.shift(),v=_+o.shift(),l=w+o.shift(),c=v+o.shift(),a(y,_,w,v,l,c),o.pop();break;case 36:y=l+o.shift(),C=c+o.shift(),w=y+o.shift(),k=C+o.shift(),l=w+o.shift(),a(y,C,w,k,l,k),y=l+o.shift(),w=y+o.shift(),I=k+o.shift(),l=w+o.shift(),a(y,k,w,I,l,c);break;case 37:const M=l,D=c;y=l+o.shift(),_=c+o.shift(),w=y+o.shift(),v=_+o.shift(),l=w+o.shift(),c=v+o.shift(),a(y,_,w,v,l,c),y=l+o.shift(),_=c+o.shift(),w=y+o.shift(),v=_+o.shift(),l=w,c=v,Math.abs(l-M)>Math.abs(c-D)?l+=o.shift():c+=o.shift(),a(y,_,w,v,l,c);break;default:throw new Te(`unknown operator: 12 ${p}`)}break;case 14:if(o.length>=4){const M=o.pop(),D=o.pop();c=o.pop(),l=o.pop(),e.save(),e.translate(l,c);let H=B3(t.cmap,String.fromCharCode(t.glyphNameMap[f0[M]]));n6(t.glyphs[H.glyphId],e,t,H.glyphId),e.restore(),H=B3(t.cmap,String.fromCharCode(t.glyphNameMap[f0[D]])),n6(t.glyphs[H.glyphId],e,t,H.glyphId)}return;case 18:h+=o.length>>1,b=!0;break;case 19:h+=o.length>>1,g+=h+7>>3,b=!0;break;case 20:h+=o.length>>1,g+=h+7>>3,b=!0;break;case 21:c+=o.pop(),l+=o.pop(),s(l,c),b=!0;break;case 22:l+=o.pop(),s(l,c),b=!0;break;case 23:h+=o.length>>1,b=!0;break;case 24:for(;o.length>2;)y=l+o.shift(),_=c+o.shift(),w=y+o.shift(),v=_+o.shift(),l=w+o.shift(),c=v+o.shift(),a(y,_,w,v,l,c);l+=o.shift(),c+=o.shift(),r(l,c);break;case 25:for(;o.length>6;)l+=o.shift(),c+=o.shift(),r(l,c);y=l+o.shift(),_=c+o.shift(),w=y+o.shift(),v=_+o.shift(),l=w+o.shift(),c=v+o.shift(),a(y,_,w,v,l,c);break;case 26:for(o.length%2&&(l+=o.shift());o.length>0;)y=l,_=c+o.shift(),w=y+o.shift(),v=_+o.shift(),l=w,c=v+o.shift(),a(y,_,w,v,l,c);break;case 27:for(o.length%2&&(c+=o.shift());o.length>0;)y=l+o.shift(),_=c,w=y+o.shift(),v=_+o.shift(),l=w+o.shift(),c=v,a(y,_,w,v,l,c);break;case 28:o.push(a0(f,g)),g+=2;break;case 29:E=o.pop()+t.gsubrsBias,T=t.gsubrs[E],T&&d(T);break;case 30:for(;o.length>0&&(y=l,_=c+o.shift(),w=y+o.shift(),v=_+o.shift(),l=w+o.shift(),c=v+(o.length===1?o.shift():0),a(y,_,w,v,l,c),o.length!==0);)y=l+o.shift(),_=c,w=y+o.shift(),v=_+o.shift(),c=v+o.shift(),l=w+(o.length===1?o.shift():0),a(y,_,w,v,l,c);break;case 31:for(;o.length>0&&(y=l+o.shift(),_=c,w=y+o.shift(),v=_+o.shift(),c=v+o.shift(),l=w+(o.length===1?o.shift():0),a(y,_,w,v,l,c),o.length!==0);)y=l,_=c+o.shift(),w=y+o.shift(),v=_+o.shift(),l=w+o.shift(),c=v+(o.length===1?o.shift():0),a(y,_,w,v,l,c);break;default:if(p<32)throw new Te(`unknown operator: ${p}`);p<247?o.push(p-139):p<251?o.push((p-247)*256+f[g++]+108):p<255?o.push(-(p-251)*256-f[g++]-108):(o.push((f[g]<<24|f[g+1]<<16|f[g+2]<<8|f[g+3])/65536),g+=4);break}b&&(o.length=0)}}d(n)}const kk="";class qz{constructor(){Ue(this,"cmds",[]);Ue(this,"transformStack",[]);Ue(this,"currentTransform",[1,0,0,1,0,0])}add(e,t){if(t){const{currentTransform:i}=this;for(let s=0,r=t.length;s<r;s+=2)Ln.applyTransform(t,i,s);this.cmds.push(`${e}${t.join(" ")}`)}else this.cmds.push(e)}transform(e){this.currentTransform=Ln.transform(this.currentTransform,e)}translate(e,t){this.transform([1,0,0,1,e,t])}save(){this.transformStack.push(this.currentTransform.slice())}restore(){this.currentTransform=this.transformStack.pop()||[1,0,0,1,0,0]}getSVG(){return this.cmds.join("")}}class iM{constructor(e){this.fontMatrix=e,this.compiledGlyphs=Object.create(null),this.compiledCharCodeToGlyphId=Object.create(null)}getPathJs(e){var a;const{charCode:t,glyphId:i}=B3(this.cmap,e);let s=this.compiledGlyphs[i],r;if(s===void 0){try{s=this.compileGlyph(this.glyphs[i],i)}catch(o){s=kk,r=o}this.compiledGlyphs[i]=s}if((a=this.compiledCharCodeToGlyphId)[t]??(a[t]=i),r)throw r;return s}compileGlyph(e,t){if(!(e!=null&&e.length)||e[0]===14)return kk;let i=this.fontMatrix;if(this.isCFFCIDFont){const r=this.fdSelect.getFDIndex(t);r>=0&&r<this.fdArray.length?i=this.fdArray[r].getByName("FontMatrix")||Vd:ae("Invalid fd index for glyph index.")}qs(Yr(i,6),"Expected a valid fontMatrix.");const s=new qz;return s.transform(i.slice()),this.compileGlyphImpl(e,s,t),s.add("Z"),s.getSVG()}compileGlyphImpl(){Cn("Children classes should implement this.")}hasBuiltPath(e){const{charCode:t,glyphId:i}=B3(this.cmap,e);return this.compiledGlyphs[i]!==void 0&&this.compiledCharCodeToGlyphId[t]!==void 0}}class Wz extends iM{constructor(e,t,i){super(i||[488e-6,0,0,488e-6,0,0]),this.glyphs=e,this.cmap=t}compileGlyphImpl(e,t){nM(e,t,this)}}class Kz extends iM{constructor(e,t,i){super(i||[.001,0,0,.001,0,0]),this.glyphs=e.glyphs,this.gsubrs=e.gsubrs||[],this.subrs=e.subrs||[],this.cmap=t,this.glyphNameMap=$l(),this.gsubrsBias=t6(this.gsubrs),this.subrsBias=t6(this.subrs),this.isCFFCIDFont=e.isCFFCIDFont,this.fdSelect=e.fdSelect,this.fdArray=e.fdArray}compileGlyphImpl(e,t,i){n6(e,t,this,i)}}class Xz{static create(e,t){const i=new Uint8Array(e.data);let s,r,a,o,l,c;const h=wn(i,4);for(let u=0,d=12;u<h;u++,d+=16){const f=xa(i.subarray(d,d+4)),g=Jn(i,d+8),m=Jn(i,d+12);switch(f){case"cmap":s=jz(i,g);break;case"glyf":r=i.subarray(g,g+m);break;case"loca":a=i.subarray(g,g+m);break;case"head":c=wn(i,g+18),l=wn(i,g+50);break;case"CFF ":o=Gz(i,g,g+m,t);break}}if(r){const u=c?[1/c,0,0,1/c,0,0]:e.fontMatrix;return new Wz(Vz(r,a,l),s,u)}return new Kz(o,s,e.fontMatrix)}}const Yz=Ei(function(n){n.Courier=600,n["Courier-Bold"]=600,n["Courier-BoldOblique"]=600,n["Courier-Oblique"]=600,n.Helvetica=Ei(function(e){e.space=278,e.exclam=278,e.quotedbl=355,e.numbersign=556,e.dollar=556,e.percent=889,e.ampersand=667,e.quoteright=222,e.parenleft=333,e.parenright=333,e.asterisk=389,e.plus=584,e.comma=278,e.hyphen=333,e.period=278,e.slash=278,e.zero=556,e.one=556,e.two=556,e.three=556,e.four=556,e.five=556,e.six=556,e.seven=556,e.eight=556,e.nine=556,e.colon=278,e.semicolon=278,e.less=584,e.equal=584,e.greater=584,e.question=556,e.at=1015,e.A=667,e.B=667,e.C=722,e.D=722,e.E=667,e.F=611,e.G=778,e.H=722,e.I=278,e.J=500,e.K=667,e.L=556,e.M=833,e.N=722,e.O=778,e.P=667,e.Q=778,e.R=722,e.S=667,e.T=611,e.U=722,e.V=667,e.W=944,e.X=667,e.Y=667,e.Z=611,e.bracketleft=278,e.backslash=278,e.bracketright=278,e.asciicircum=469,e.underscore=556,e.quoteleft=222,e.a=556,e.b=556,e.c=500,e.d=556,e.e=556,e.f=278,e.g=556,e.h=556,e.i=222,e.j=222,e.k=500,e.l=222,e.m=833,e.n=556,e.o=556,e.p=556,e.q=556,e.r=333,e.s=500,e.t=278,e.u=556,e.v=500,e.w=722,e.x=500,e.y=500,e.z=500,e.braceleft=334,e.bar=260,e.braceright=334,e.asciitilde=584,e.exclamdown=333,e.cent=556,e.sterling=556,e.fraction=167,e.yen=556,e.florin=556,e.section=556,e.currency=556,e.quotesingle=191,e.quotedblleft=333,e.guillemotleft=556,e.guilsinglleft=333,e.guilsinglright=333,e.fi=500,e.fl=500,e.endash=556,e.dagger=556,e.daggerdbl=556,e.periodcentered=278,e.paragraph=537,e.bullet=350,e.quotesinglbase=222,e.quotedblbase=333,e.quotedblright=333,e.guillemotright=556,e.ellipsis=1e3,e.perthousand=1e3,e.questiondown=611,e.grave=333,e.acute=333,e.circumflex=333,e.tilde=333,e.macron=333,e.breve=333,e.dotaccent=333,e.dieresis=333,e.ring=333,e.cedilla=333,e.hungarumlaut=333,e.ogonek=333,e.caron=333,e.emdash=1e3,e.AE=1e3,e.ordfeminine=370,e.Lslash=556,e.Oslash=778,e.OE=1e3,e.ordmasculine=365,e.ae=889,e.dotlessi=278,e.lslash=222,e.oslash=611,e.oe=944,e.germandbls=611,e.Idieresis=278,e.eacute=556,e.abreve=556,e.uhungarumlaut=556,e.ecaron=556,e.Ydieresis=667,e.divide=584,e.Yacute=667,e.Acircumflex=667,e.aacute=556,e.Ucircumflex=722,e.yacute=500,e.scommaaccent=500,e.ecircumflex=556,e.Uring=722,e.Udieresis=722,e.aogonek=556,e.Uacute=722,e.uogonek=556,e.Edieresis=667,e.Dcroat=722,e.commaaccent=250,e.copyright=737,e.Emacron=667,e.ccaron=500,e.aring=556,e.Ncommaaccent=722,e.lacute=222,e.agrave=556,e.Tcommaaccent=611,e.Cacute=722,e.atilde=556,e.Edotaccent=667,e.scaron=500,e.scedilla=500,e.iacute=278,e.lozenge=471,e.Rcaron=722,e.Gcommaaccent=778,e.ucircumflex=556,e.acircumflex=556,e.Amacron=667,e.rcaron=333,e.ccedilla=500,e.Zdotaccent=611,e.Thorn=667,e.Omacron=778,e.Racute=722,e.Sacute=667,e.dcaron=643,e.Umacron=722,e.uring=556,e.threesuperior=333,e.Ograve=778,e.Agrave=667,e.Abreve=667,e.multiply=584,e.uacute=556,e.Tcaron=611,e.partialdiff=476,e.ydieresis=500,e.Nacute=722,e.icircumflex=278,e.Ecircumflex=667,e.adieresis=556,e.edieresis=556,e.cacute=500,e.nacute=556,e.umacron=556,e.Ncaron=722,e.Iacute=278,e.plusminus=584,e.brokenbar=260,e.registered=737,e.Gbreve=778,e.Idotaccent=278,e.summation=600,e.Egrave=667,e.racute=333,e.omacron=556,e.Zacute=611,e.Zcaron=611,e.greaterequal=549,e.Eth=722,e.Ccedilla=722,e.lcommaaccent=222,e.tcaron=317,e.eogonek=556,e.Uogonek=722,e.Aacute=667,e.Adieresis=667,e.egrave=556,e.zacute=500,e.iogonek=222,e.Oacute=778,e.oacute=556,e.amacron=556,e.sacute=500,e.idieresis=278,e.Ocircumflex=778,e.Ugrave=722,e.Delta=612,e.thorn=556,e.twosuperior=333,e.Odieresis=778,e.mu=556,e.igrave=278,e.ohungarumlaut=556,e.Eogonek=667,e.dcroat=556,e.threequarters=834,e.Scedilla=667,e.lcaron=299,e.Kcommaaccent=667,e.Lacute=556,e.trademark=1e3,e.edotaccent=556,e.Igrave=278,e.Imacron=278,e.Lcaron=556,e.onehalf=834,e.lessequal=549,e.ocircumflex=556,e.ntilde=556,e.Uhungarumlaut=722,e.Eacute=667,e.emacron=556,e.gbreve=556,e.onequarter=834,e.Scaron=667,e.Scommaaccent=667,e.Ohungarumlaut=778,e.degree=400,e.ograve=556,e.Ccaron=722,e.ugrave=556,e.radical=453,e.Dcaron=722,e.rcommaaccent=333,e.Ntilde=722,e.otilde=556,e.Rcommaaccent=722,e.Lcommaaccent=556,e.Atilde=667,e.Aogonek=667,e.Aring=667,e.Otilde=778,e.zdotaccent=500,e.Ecaron=667,e.Iogonek=278,e.kcommaaccent=500,e.minus=584,e.Icircumflex=278,e.ncaron=556,e.tcommaaccent=278,e.logicalnot=584,e.odieresis=556,e.udieresis=556,e.notequal=549,e.gcommaaccent=556,e.eth=556,e.zcaron=500,e.ncommaaccent=556,e.onesuperior=333,e.imacron=278,e.Euro=556}),n["Helvetica-Bold"]=Ei(function(e){e.space=278,e.exclam=333,e.quotedbl=474,e.numbersign=556,e.dollar=556,e.percent=889,e.ampersand=722,e.quoteright=278,e.parenleft=333,e.parenright=333,e.asterisk=389,e.plus=584,e.comma=278,e.hyphen=333,e.period=278,e.slash=278,e.zero=556,e.one=556,e.two=556,e.three=556,e.four=556,e.five=556,e.six=556,e.seven=556,e.eight=556,e.nine=556,e.colon=333,e.semicolon=333,e.less=584,e.equal=584,e.greater=584,e.question=611,e.at=975,e.A=722,e.B=722,e.C=722,e.D=722,e.E=667,e.F=611,e.G=778,e.H=722,e.I=278,e.J=556,e.K=722,e.L=611,e.M=833,e.N=722,e.O=778,e.P=667,e.Q=778,e.R=722,e.S=667,e.T=611,e.U=722,e.V=667,e.W=944,e.X=667,e.Y=667,e.Z=611,e.bracketleft=333,e.backslash=278,e.bracketright=333,e.asciicircum=584,e.underscore=556,e.quoteleft=278,e.a=556,e.b=611,e.c=556,e.d=611,e.e=556,e.f=333,e.g=611,e.h=611,e.i=278,e.j=278,e.k=556,e.l=278,e.m=889,e.n=611,e.o=611,e.p=611,e.q=611,e.r=389,e.s=556,e.t=333,e.u=611,e.v=556,e.w=778,e.x=556,e.y=556,e.z=500,e.braceleft=389,e.bar=280,e.braceright=389,e.asciitilde=584,e.exclamdown=333,e.cent=556,e.sterling=556,e.fraction=167,e.yen=556,e.florin=556,e.section=556,e.currency=556,e.quotesingle=238,e.quotedblleft=500,e.guillemotleft=556,e.guilsinglleft=333,e.guilsinglright=333,e.fi=611,e.fl=611,e.endash=556,e.dagger=556,e.daggerdbl=556,e.periodcentered=278,e.paragraph=556,e.bullet=350,e.quotesinglbase=278,e.quotedblbase=500,e.quotedblright=500,e.guillemotright=556,e.ellipsis=1e3,e.perthousand=1e3,e.questiondown=611,e.grave=333,e.acute=333,e.circumflex=333,e.tilde=333,e.macron=333,e.breve=333,e.dotaccent=333,e.dieresis=333,e.ring=333,e.cedilla=333,e.hungarumlaut=333,e.ogonek=333,e.caron=333,e.emdash=1e3,e.AE=1e3,e.ordfeminine=370,e.Lslash=611,e.Oslash=778,e.OE=1e3,e.ordmasculine=365,e.ae=889,e.dotlessi=278,e.lslash=278,e.oslash=611,e.oe=944,e.germandbls=611,e.Idieresis=278,e.eacute=556,e.abreve=556,e.uhungarumlaut=611,e.ecaron=556,e.Ydieresis=667,e.divide=584,e.Yacute=667,e.Acircumflex=722,e.aacute=556,e.Ucircumflex=722,e.yacute=556,e.scommaaccent=556,e.ecircumflex=556,e.Uring=722,e.Udieresis=722,e.aogonek=556,e.Uacute=722,e.uogonek=611,e.Edieresis=667,e.Dcroat=722,e.commaaccent=250,e.copyright=737,e.Emacron=667,e.ccaron=556,e.aring=556,e.Ncommaaccent=722,e.lacute=278,e.agrave=556,e.Tcommaaccent=611,e.Cacute=722,e.atilde=556,e.Edotaccent=667,e.scaron=556,e.scedilla=556,e.iacute=278,e.lozenge=494,e.Rcaron=722,e.Gcommaaccent=778,e.ucircumflex=611,e.acircumflex=556,e.Amacron=722,e.rcaron=389,e.ccedilla=556,e.Zdotaccent=611,e.Thorn=667,e.Omacron=778,e.Racute=722,e.Sacute=667,e.dcaron=743,e.Umacron=722,e.uring=611,e.threesuperior=333,e.Ograve=778,e.Agrave=722,e.Abreve=722,e.multiply=584,e.uacute=611,e.Tcaron=611,e.partialdiff=494,e.ydieresis=556,e.Nacute=722,e.icircumflex=278,e.Ecircumflex=667,e.adieresis=556,e.edieresis=556,e.cacute=556,e.nacute=611,e.umacron=611,e.Ncaron=722,e.Iacute=278,e.plusminus=584,e.brokenbar=280,e.registered=737,e.Gbreve=778,e.Idotaccent=278,e.summation=600,e.Egrave=667,e.racute=389,e.omacron=611,e.Zacute=611,e.Zcaron=611,e.greaterequal=549,e.Eth=722,e.Ccedilla=722,e.lcommaaccent=278,e.tcaron=389,e.eogonek=556,e.Uogonek=722,e.Aacute=722,e.Adieresis=722,e.egrave=556,e.zacute=500,e.iogonek=278,e.Oacute=778,e.oacute=611,e.amacron=556,e.sacute=556,e.idieresis=278,e.Ocircumflex=778,e.Ugrave=722,e.Delta=612,e.thorn=611,e.twosuperior=333,e.Odieresis=778,e.mu=611,e.igrave=278,e.ohungarumlaut=611,e.Eogonek=667,e.dcroat=611,e.threequarters=834,e.Scedilla=667,e.lcaron=400,e.Kcommaaccent=722,e.Lacute=611,e.trademark=1e3,e.edotaccent=556,e.Igrave=278,e.Imacron=278,e.Lcaron=611,e.onehalf=834,e.lessequal=549,e.ocircumflex=611,e.ntilde=611,e.Uhungarumlaut=722,e.Eacute=667,e.emacron=556,e.gbreve=611,e.onequarter=834,e.Scaron=667,e.Scommaaccent=667,e.Ohungarumlaut=778,e.degree=400,e.ograve=611,e.Ccaron=722,e.ugrave=611,e.radical=549,e.Dcaron=722,e.rcommaaccent=389,e.Ntilde=722,e.otilde=611,e.Rcommaaccent=722,e.Lcommaaccent=611,e.Atilde=722,e.Aogonek=722,e.Aring=722,e.Otilde=778,e.zdotaccent=500,e.Ecaron=667,e.Iogonek=278,e.kcommaaccent=556,e.minus=584,e.Icircumflex=278,e.ncaron=611,e.tcommaaccent=333,e.logicalnot=584,e.odieresis=611,e.udieresis=611,e.notequal=549,e.gcommaaccent=611,e.eth=611,e.zcaron=500,e.ncommaaccent=611,e.onesuperior=333,e.imacron=278,e.Euro=556}),n["Helvetica-BoldOblique"]=Ei(function(e){e.space=278,e.exclam=333,e.quotedbl=474,e.numbersign=556,e.dollar=556,e.percent=889,e.ampersand=722,e.quoteright=278,e.parenleft=333,e.parenright=333,e.asterisk=389,e.plus=584,e.comma=278,e.hyphen=333,e.period=278,e.slash=278,e.zero=556,e.one=556,e.two=556,e.three=556,e.four=556,e.five=556,e.six=556,e.seven=556,e.eight=556,e.nine=556,e.colon=333,e.semicolon=333,e.less=584,e.equal=584,e.greater=584,e.question=611,e.at=975,e.A=722,e.B=722,e.C=722,e.D=722,e.E=667,e.F=611,e.G=778,e.H=722,e.I=278,e.J=556,e.K=722,e.L=611,e.M=833,e.N=722,e.O=778,e.P=667,e.Q=778,e.R=722,e.S=667,e.T=611,e.U=722,e.V=667,e.W=944,e.X=667,e.Y=667,e.Z=611,e.bracketleft=333,e.backslash=278,e.bracketright=333,e.asciicircum=584,e.underscore=556,e.quoteleft=278,e.a=556,e.b=611,e.c=556,e.d=611,e.e=556,e.f=333,e.g=611,e.h=611,e.i=278,e.j=278,e.k=556,e.l=278,e.m=889,e.n=611,e.o=611,e.p=611,e.q=611,e.r=389,e.s=556,e.t=333,e.u=611,e.v=556,e.w=778,e.x=556,e.y=556,e.z=500,e.braceleft=389,e.bar=280,e.braceright=389,e.asciitilde=584,e.exclamdown=333,e.cent=556,e.sterling=556,e.fraction=167,e.yen=556,e.florin=556,e.section=556,e.currency=556,e.quotesingle=238,e.quotedblleft=500,e.guillemotleft=556,e.guilsinglleft=333,e.guilsinglright=333,e.fi=611,e.fl=611,e.endash=556,e.dagger=556,e.daggerdbl=556,e.periodcentered=278,e.paragraph=556,e.bullet=350,e.quotesinglbase=278,e.quotedblbase=500,e.quotedblright=500,e.guillemotright=556,e.ellipsis=1e3,e.perthousand=1e3,e.questiondown=611,e.grave=333,e.acute=333,e.circumflex=333,e.tilde=333,e.macron=333,e.breve=333,e.dotaccent=333,e.dieresis=333,e.ring=333,e.cedilla=333,e.hungarumlaut=333,e.ogonek=333,e.caron=333,e.emdash=1e3,e.AE=1e3,e.ordfeminine=370,e.Lslash=611,e.Oslash=778,e.OE=1e3,e.ordmasculine=365,e.ae=889,e.dotlessi=278,e.lslash=278,e.oslash=611,e.oe=944,e.germandbls=611,e.Idieresis=278,e.eacute=556,e.abreve=556,e.uhungarumlaut=611,e.ecaron=556,e.Ydieresis=667,e.divide=584,e.Yacute=667,e.Acircumflex=722,e.aacute=556,e.Ucircumflex=722,e.yacute=556,e.scommaaccent=556,e.ecircumflex=556,e.Uring=722,e.Udieresis=722,e.aogonek=556,e.Uacute=722,e.uogonek=611,e.Edieresis=667,e.Dcroat=722,e.commaaccent=250,e.copyright=737,e.Emacron=667,e.ccaron=556,e.aring=556,e.Ncommaaccent=722,e.lacute=278,e.agrave=556,e.Tcommaaccent=611,e.Cacute=722,e.atilde=556,e.Edotaccent=667,e.scaron=556,e.scedilla=556,e.iacute=278,e.lozenge=494,e.Rcaron=722,e.Gcommaaccent=778,e.ucircumflex=611,e.acircumflex=556,e.Amacron=722,e.rcaron=389,e.ccedilla=556,e.Zdotaccent=611,e.Thorn=667,e.Omacron=778,e.Racute=722,e.Sacute=667,e.dcaron=743,e.Umacron=722,e.uring=611,e.threesuperior=333,e.Ograve=778,e.Agrave=722,e.Abreve=722,e.multiply=584,e.uacute=611,e.Tcaron=611,e.partialdiff=494,e.ydieresis=556,e.Nacute=722,e.icircumflex=278,e.Ecircumflex=667,e.adieresis=556,e.edieresis=556,e.cacute=556,e.nacute=611,e.umacron=611,e.Ncaron=722,e.Iacute=278,e.plusminus=584,e.brokenbar=280,e.registered=737,e.Gbreve=778,e.Idotaccent=278,e.summation=600,e.Egrave=667,e.racute=389,e.omacron=611,e.Zacute=611,e.Zcaron=611,e.greaterequal=549,e.Eth=722,e.Ccedilla=722,e.lcommaaccent=278,e.tcaron=389,e.eogonek=556,e.Uogonek=722,e.Aacute=722,e.Adieresis=722,e.egrave=556,e.zacute=500,e.iogonek=278,e.Oacute=778,e.oacute=611,e.amacron=556,e.sacute=556,e.idieresis=278,e.Ocircumflex=778,e.Ugrave=722,e.Delta=612,e.thorn=611,e.twosuperior=333,e.Odieresis=778,e.mu=611,e.igrave=278,e.ohungarumlaut=611,e.Eogonek=667,e.dcroat=611,e.threequarters=834,e.Scedilla=667,e.lcaron=400,e.Kcommaaccent=722,e.Lacute=611,e.trademark=1e3,e.edotaccent=556,e.Igrave=278,e.Imacron=278,e.Lcaron=611,e.onehalf=834,e.lessequal=549,e.ocircumflex=611,e.ntilde=611,e.Uhungarumlaut=722,e.Eacute=667,e.emacron=556,e.gbreve=611,e.onequarter=834,e.Scaron=667,e.Scommaaccent=667,e.Ohungarumlaut=778,e.degree=400,e.ograve=611,e.Ccaron=722,e.ugrave=611,e.radical=549,e.Dcaron=722,e.rcommaaccent=389,e.Ntilde=722,e.otilde=611,e.Rcommaaccent=722,e.Lcommaaccent=611,e.Atilde=722,e.Aogonek=722,e.Aring=722,e.Otilde=778,e.zdotaccent=500,e.Ecaron=667,e.Iogonek=278,e.kcommaaccent=556,e.minus=584,e.Icircumflex=278,e.ncaron=611,e.tcommaaccent=333,e.logicalnot=584,e.odieresis=611,e.udieresis=611,e.notequal=549,e.gcommaaccent=611,e.eth=611,e.zcaron=500,e.ncommaaccent=611,e.onesuperior=333,e.imacron=278,e.Euro=556}),n["Helvetica-Oblique"]=Ei(function(e){e.space=278,e.exclam=278,e.quotedbl=355,e.numbersign=556,e.dollar=556,e.percent=889,e.ampersand=667,e.quoteright=222,e.parenleft=333,e.parenright=333,e.asterisk=389,e.plus=584,e.comma=278,e.hyphen=333,e.period=278,e.slash=278,e.zero=556,e.one=556,e.two=556,e.three=556,e.four=556,e.five=556,e.six=556,e.seven=556,e.eight=556,e.nine=556,e.colon=278,e.semicolon=278,e.less=584,e.equal=584,e.greater=584,e.question=556,e.at=1015,e.A=667,e.B=667,e.C=722,e.D=722,e.E=667,e.F=611,e.G=778,e.H=722,e.I=278,e.J=500,e.K=667,e.L=556,e.M=833,e.N=722,e.O=778,e.P=667,e.Q=778,e.R=722,e.S=667,e.T=611,e.U=722,e.V=667,e.W=944,e.X=667,e.Y=667,e.Z=611,e.bracketleft=278,e.backslash=278,e.bracketright=278,e.asciicircum=469,e.underscore=556,e.quoteleft=222,e.a=556,e.b=556,e.c=500,e.d=556,e.e=556,e.f=278,e.g=556,e.h=556,e.i=222,e.j=222,e.k=500,e.l=222,e.m=833,e.n=556,e.o=556,e.p=556,e.q=556,e.r=333,e.s=500,e.t=278,e.u=556,e.v=500,e.w=722,e.x=500,e.y=500,e.z=500,e.braceleft=334,e.bar=260,e.braceright=334,e.asciitilde=584,e.exclamdown=333,e.cent=556,e.sterling=556,e.fraction=167,e.yen=556,e.florin=556,e.section=556,e.currency=556,e.quotesingle=191,e.quotedblleft=333,e.guillemotleft=556,e.guilsinglleft=333,e.guilsinglright=333,e.fi=500,e.fl=500,e.endash=556,e.dagger=556,e.daggerdbl=556,e.periodcentered=278,e.paragraph=537,e.bullet=350,e.quotesinglbase=222,e.quotedblbase=333,e.quotedblright=333,e.guillemotright=556,e.ellipsis=1e3,e.perthousand=1e3,e.questiondown=611,e.grave=333,e.acute=333,e.circumflex=333,e.tilde=333,e.macron=333,e.breve=333,e.dotaccent=333,e.dieresis=333,e.ring=333,e.cedilla=333,e.hungarumlaut=333,e.ogonek=333,e.caron=333,e.emdash=1e3,e.AE=1e3,e.ordfeminine=370,e.Lslash=556,e.Oslash=778,e.OE=1e3,e.ordmasculine=365,e.ae=889,e.dotlessi=278,e.lslash=222,e.oslash=611,e.oe=944,e.germandbls=611,e.Idieresis=278,e.eacute=556,e.abreve=556,e.uhungarumlaut=556,e.ecaron=556,e.Ydieresis=667,e.divide=584,e.Yacute=667,e.Acircumflex=667,e.aacute=556,e.Ucircumflex=722,e.yacute=500,e.scommaaccent=500,e.ecircumflex=556,e.Uring=722,e.Udieresis=722,e.aogonek=556,e.Uacute=722,e.uogonek=556,e.Edieresis=667,e.Dcroat=722,e.commaaccent=250,e.copyright=737,e.Emacron=667,e.ccaron=500,e.aring=556,e.Ncommaaccent=722,e.lacute=222,e.agrave=556,e.Tcommaaccent=611,e.Cacute=722,e.atilde=556,e.Edotaccent=667,e.scaron=500,e.scedilla=500,e.iacute=278,e.lozenge=471,e.Rcaron=722,e.Gcommaaccent=778,e.ucircumflex=556,e.acircumflex=556,e.Amacron=667,e.rcaron=333,e.ccedilla=500,e.Zdotaccent=611,e.Thorn=667,e.Omacron=778,e.Racute=722,e.Sacute=667,e.dcaron=643,e.Umacron=722,e.uring=556,e.threesuperior=333,e.Ograve=778,e.Agrave=667,e.Abreve=667,e.multiply=584,e.uacute=556,e.Tcaron=611,e.partialdiff=476,e.ydieresis=500,e.Nacute=722,e.icircumflex=278,e.Ecircumflex=667,e.adieresis=556,e.edieresis=556,e.cacute=500,e.nacute=556,e.umacron=556,e.Ncaron=722,e.Iacute=278,e.plusminus=584,e.brokenbar=260,e.registered=737,e.Gbreve=778,e.Idotaccent=278,e.summation=600,e.Egrave=667,e.racute=333,e.omacron=556,e.Zacute=611,e.Zcaron=611,e.greaterequal=549,e.Eth=722,e.Ccedilla=722,e.lcommaaccent=222,e.tcaron=317,e.eogonek=556,e.Uogonek=722,e.Aacute=667,e.Adieresis=667,e.egrave=556,e.zacute=500,e.iogonek=222,e.Oacute=778,e.oacute=556,e.amacron=556,e.sacute=500,e.idieresis=278,e.Ocircumflex=778,e.Ugrave=722,e.Delta=612,e.thorn=556,e.twosuperior=333,e.Odieresis=778,e.mu=556,e.igrave=278,e.ohungarumlaut=556,e.Eogonek=667,e.dcroat=556,e.threequarters=834,e.Scedilla=667,e.lcaron=299,e.Kcommaaccent=667,e.Lacute=556,e.trademark=1e3,e.edotaccent=556,e.Igrave=278,e.Imacron=278,e.Lcaron=556,e.onehalf=834,e.lessequal=549,e.ocircumflex=556,e.ntilde=556,e.Uhungarumlaut=722,e.Eacute=667,e.emacron=556,e.gbreve=556,e.onequarter=834,e.Scaron=667,e.Scommaaccent=667,e.Ohungarumlaut=778,e.degree=400,e.ograve=556,e.Ccaron=722,e.ugrave=556,e.radical=453,e.Dcaron=722,e.rcommaaccent=333,e.Ntilde=722,e.otilde=556,e.Rcommaaccent=722,e.Lcommaaccent=556,e.Atilde=667,e.Aogonek=667,e.Aring=667,e.Otilde=778,e.zdotaccent=500,e.Ecaron=667,e.Iogonek=278,e.kcommaaccent=500,e.minus=584,e.Icircumflex=278,e.ncaron=556,e.tcommaaccent=278,e.logicalnot=584,e.odieresis=556,e.udieresis=556,e.notequal=549,e.gcommaaccent=556,e.eth=556,e.zcaron=500,e.ncommaaccent=556,e.onesuperior=333,e.imacron=278,e.Euro=556}),n.Symbol=Ei(function(e){e.space=250,e.exclam=333,e.universal=713,e.numbersign=500,e.existential=549,e.percent=833,e.ampersand=778,e.suchthat=439,e.parenleft=333,e.parenright=333,e.asteriskmath=500,e.plus=549,e.comma=250,e.minus=549,e.period=250,e.slash=278,e.zero=500,e.one=500,e.two=500,e.three=500,e.four=500,e.five=500,e.six=500,e.seven=500,e.eight=500,e.nine=500,e.colon=278,e.semicolon=278,e.less=549,e.equal=549,e.greater=549,e.question=444,e.congruent=549,e.Alpha=722,e.Beta=667,e.Chi=722,e.Delta=612,e.Epsilon=611,e.Phi=763,e.Gamma=603,e.Eta=722,e.Iota=333,e.theta1=631,e.Kappa=722,e.Lambda=686,e.Mu=889,e.Nu=722,e.Omicron=722,e.Pi=768,e.Theta=741,e.Rho=556,e.Sigma=592,e.Tau=611,e.Upsilon=690,e.sigma1=439,e.Omega=768,e.Xi=645,e.Psi=795,e.Zeta=611,e.bracketleft=333,e.therefore=863,e.bracketright=333,e.perpendicular=658,e.underscore=500,e.radicalex=500,e.alpha=631,e.beta=549,e.chi=549,e.delta=494,e.epsilon=439,e.phi=521,e.gamma=411,e.eta=603,e.iota=329,e.phi1=603,e.kappa=549,e.lambda=549,e.mu=576,e.nu=521,e.omicron=549,e.pi=549,e.theta=521,e.rho=549,e.sigma=603,e.tau=439,e.upsilon=576,e.omega1=713,e.omega=686,e.xi=493,e.psi=686,e.zeta=494,e.braceleft=480,e.bar=200,e.braceright=480,e.similar=549,e.Euro=750,e.Upsilon1=620,e.minute=247,e.lessequal=549,e.fraction=167,e.infinity=713,e.florin=500,e.club=753,e.diamond=753,e.heart=753,e.spade=753,e.arrowboth=1042,e.arrowleft=987,e.arrowup=603,e.arrowright=987,e.arrowdown=603,e.degree=400,e.plusminus=549,e.second=411,e.greaterequal=549,e.multiply=549,e.proportional=713,e.partialdiff=494,e.bullet=460,e.divide=549,e.notequal=549,e.equivalence=549,e.approxequal=549,e.ellipsis=1e3,e.arrowvertex=603,e.arrowhorizex=1e3,e.carriagereturn=658,e.aleph=823,e.Ifraktur=686,e.Rfraktur=795,e.weierstrass=987,e.circlemultiply=768,e.circleplus=768,e.emptyset=823,e.intersection=768,e.union=768,e.propersuperset=713,e.reflexsuperset=713,e.notsubset=713,e.propersubset=713,e.reflexsubset=713,e.element=713,e.notelement=713,e.angle=768,e.gradient=713,e.registerserif=790,e.copyrightserif=790,e.trademarkserif=890,e.product=823,e.radical=549,e.dotmath=250,e.logicalnot=713,e.logicaland=603,e.logicalor=603,e.arrowdblboth=1042,e.arrowdblleft=987,e.arrowdblup=603,e.arrowdblright=987,e.arrowdbldown=603,e.lozenge=494,e.angleleft=329,e.registersans=790,e.copyrightsans=790,e.trademarksans=786,e.summation=713,e.parenlefttp=384,e.parenleftex=384,e.parenleftbt=384,e.bracketlefttp=384,e.bracketleftex=384,e.bracketleftbt=384,e.bracelefttp=494,e.braceleftmid=494,e.braceleftbt=494,e.braceex=494,e.angleright=329,e.integral=274,e.integraltp=686,e.integralex=686,e.integralbt=686,e.parenrighttp=384,e.parenrightex=384,e.parenrightbt=384,e.bracketrighttp=384,e.bracketrightex=384,e.bracketrightbt=384,e.bracerighttp=494,e.bracerightmid=494,e.bracerightbt=494,e.apple=790}),n["Times-Roman"]=Ei(function(e){e.space=250,e.exclam=333,e.quotedbl=408,e.numbersign=500,e.dollar=500,e.percent=833,e.ampersand=778,e.quoteright=333,e.parenleft=333,e.parenright=333,e.asterisk=500,e.plus=564,e.comma=250,e.hyphen=333,e.period=250,e.slash=278,e.zero=500,e.one=500,e.two=500,e.three=500,e.four=500,e.five=500,e.six=500,e.seven=500,e.eight=500,e.nine=500,e.colon=278,e.semicolon=278,e.less=564,e.equal=564,e.greater=564,e.question=444,e.at=921,e.A=722,e.B=667,e.C=667,e.D=722,e.E=611,e.F=556,e.G=722,e.H=722,e.I=333,e.J=389,e.K=722,e.L=611,e.M=889,e.N=722,e.O=722,e.P=556,e.Q=722,e.R=667,e.S=556,e.T=611,e.U=722,e.V=722,e.W=944,e.X=722,e.Y=722,e.Z=611,e.bracketleft=333,e.backslash=278,e.bracketright=333,e.asciicircum=469,e.underscore=500,e.quoteleft=333,e.a=444,e.b=500,e.c=444,e.d=500,e.e=444,e.f=333,e.g=500,e.h=500,e.i=278,e.j=278,e.k=500,e.l=278,e.m=778,e.n=500,e.o=500,e.p=500,e.q=500,e.r=333,e.s=389,e.t=278,e.u=500,e.v=500,e.w=722,e.x=500,e.y=500,e.z=444,e.braceleft=480,e.bar=200,e.braceright=480,e.asciitilde=541,e.exclamdown=333,e.cent=500,e.sterling=500,e.fraction=167,e.yen=500,e.florin=500,e.section=500,e.currency=500,e.quotesingle=180,e.quotedblleft=444,e.guillemotleft=500,e.guilsinglleft=333,e.guilsinglright=333,e.fi=556,e.fl=556,e.endash=500,e.dagger=500,e.daggerdbl=500,e.periodcentered=250,e.paragraph=453,e.bullet=350,e.quotesinglbase=333,e.quotedblbase=444,e.quotedblright=444,e.guillemotright=500,e.ellipsis=1e3,e.perthousand=1e3,e.questiondown=444,e.grave=333,e.acute=333,e.circumflex=333,e.tilde=333,e.macron=333,e.breve=333,e.dotaccent=333,e.dieresis=333,e.ring=333,e.cedilla=333,e.hungarumlaut=333,e.ogonek=333,e.caron=333,e.emdash=1e3,e.AE=889,e.ordfeminine=276,e.Lslash=611,e.Oslash=722,e.OE=889,e.ordmasculine=310,e.ae=667,e.dotlessi=278,e.lslash=278,e.oslash=500,e.oe=722,e.germandbls=500,e.Idieresis=333,e.eacute=444,e.abreve=444,e.uhungarumlaut=500,e.ecaron=444,e.Ydieresis=722,e.divide=564,e.Yacute=722,e.Acircumflex=722,e.aacute=444,e.Ucircumflex=722,e.yacute=500,e.scommaaccent=389,e.ecircumflex=444,e.Uring=722,e.Udieresis=722,e.aogonek=444,e.Uacute=722,e.uogonek=500,e.Edieresis=611,e.Dcroat=722,e.commaaccent=250,e.copyright=760,e.Emacron=611,e.ccaron=444,e.aring=444,e.Ncommaaccent=722,e.lacute=278,e.agrave=444,e.Tcommaaccent=611,e.Cacute=667,e.atilde=444,e.Edotaccent=611,e.scaron=389,e.scedilla=389,e.iacute=278,e.lozenge=471,e.Rcaron=667,e.Gcommaaccent=722,e.ucircumflex=500,e.acircumflex=444,e.Amacron=722,e.rcaron=333,e.ccedilla=444,e.Zdotaccent=611,e.Thorn=556,e.Omacron=722,e.Racute=667,e.Sacute=556,e.dcaron=588,e.Umacron=722,e.uring=500,e.threesuperior=300,e.Ograve=722,e.Agrave=722,e.Abreve=722,e.multiply=564,e.uacute=500,e.Tcaron=611,e.partialdiff=476,e.ydieresis=500,e.Nacute=722,e.icircumflex=278,e.Ecircumflex=611,e.adieresis=444,e.edieresis=444,e.cacute=444,e.nacute=500,e.umacron=500,e.Ncaron=722,e.Iacute=333,e.plusminus=564,e.brokenbar=200,e.registered=760,e.Gbreve=722,e.Idotaccent=333,e.summation=600,e.Egrave=611,e.racute=333,e.omacron=500,e.Zacute=611,e.Zcaron=611,e.greaterequal=549,e.Eth=722,e.Ccedilla=667,e.lcommaaccent=278,e.tcaron=326,e.eogonek=444,e.Uogonek=722,e.Aacute=722,e.Adieresis=722,e.egrave=444,e.zacute=444,e.iogonek=278,e.Oacute=722,e.oacute=500,e.amacron=444,e.sacute=389,e.idieresis=278,e.Ocircumflex=722,e.Ugrave=722,e.Delta=612,e.thorn=500,e.twosuperior=300,e.Odieresis=722,e.mu=500,e.igrave=278,e.ohungarumlaut=500,e.Eogonek=611,e.dcroat=500,e.threequarters=750,e.Scedilla=556,e.lcaron=344,e.Kcommaaccent=722,e.Lacute=611,e.trademark=980,e.edotaccent=444,e.Igrave=333,e.Imacron=333,e.Lcaron=611,e.onehalf=750,e.lessequal=549,e.ocircumflex=500,e.ntilde=500,e.Uhungarumlaut=722,e.Eacute=611,e.emacron=444,e.gbreve=500,e.onequarter=750,e.Scaron=556,e.Scommaaccent=556,e.Ohungarumlaut=722,e.degree=400,e.ograve=500,e.Ccaron=667,e.ugrave=500,e.radical=453,e.Dcaron=722,e.rcommaaccent=333,e.Ntilde=722,e.otilde=500,e.Rcommaaccent=667,e.Lcommaaccent=611,e.Atilde=722,e.Aogonek=722,e.Aring=722,e.Otilde=722,e.zdotaccent=444,e.Ecaron=611,e.Iogonek=333,e.kcommaaccent=500,e.minus=564,e.Icircumflex=333,e.ncaron=500,e.tcommaaccent=278,e.logicalnot=564,e.odieresis=500,e.udieresis=500,e.notequal=549,e.gcommaaccent=500,e.eth=500,e.zcaron=444,e.ncommaaccent=500,e.onesuperior=300,e.imacron=278,e.Euro=500}),n["Times-Bold"]=Ei(function(e){e.space=250,e.exclam=333,e.quotedbl=555,e.numbersign=500,e.dollar=500,e.percent=1e3,e.ampersand=833,e.quoteright=333,e.parenleft=333,e.parenright=333,e.asterisk=500,e.plus=570,e.comma=250,e.hyphen=333,e.period=250,e.slash=278,e.zero=500,e.one=500,e.two=500,e.three=500,e.four=500,e.five=500,e.six=500,e.seven=500,e.eight=500,e.nine=500,e.colon=333,e.semicolon=333,e.less=570,e.equal=570,e.greater=570,e.question=500,e.at=930,e.A=722,e.B=667,e.C=722,e.D=722,e.E=667,e.F=611,e.G=778,e.H=778,e.I=389,e.J=500,e.K=778,e.L=667,e.M=944,e.N=722,e.O=778,e.P=611,e.Q=778,e.R=722,e.S=556,e.T=667,e.U=722,e.V=722,e.W=1e3,e.X=722,e.Y=722,e.Z=667,e.bracketleft=333,e.backslash=278,e.bracketright=333,e.asciicircum=581,e.underscore=500,e.quoteleft=333,e.a=500,e.b=556,e.c=444,e.d=556,e.e=444,e.f=333,e.g=500,e.h=556,e.i=278,e.j=333,e.k=556,e.l=278,e.m=833,e.n=556,e.o=500,e.p=556,e.q=556,e.r=444,e.s=389,e.t=333,e.u=556,e.v=500,e.w=722,e.x=500,e.y=500,e.z=444,e.braceleft=394,e.bar=220,e.braceright=394,e.asciitilde=520,e.exclamdown=333,e.cent=500,e.sterling=500,e.fraction=167,e.yen=500,e.florin=500,e.section=500,e.currency=500,e.quotesingle=278,e.quotedblleft=500,e.guillemotleft=500,e.guilsinglleft=333,e.guilsinglright=333,e.fi=556,e.fl=556,e.endash=500,e.dagger=500,e.daggerdbl=500,e.periodcentered=250,e.paragraph=540,e.bullet=350,e.quotesinglbase=333,e.quotedblbase=500,e.quotedblright=500,e.guillemotright=500,e.ellipsis=1e3,e.perthousand=1e3,e.questiondown=500,e.grave=333,e.acute=333,e.circumflex=333,e.tilde=333,e.macron=333,e.breve=333,e.dotaccent=333,e.dieresis=333,e.ring=333,e.cedilla=333,e.hungarumlaut=333,e.ogonek=333,e.caron=333,e.emdash=1e3,e.AE=1e3,e.ordfeminine=300,e.Lslash=667,e.Oslash=778,e.OE=1e3,e.ordmasculine=330,e.ae=722,e.dotlessi=278,e.lslash=278,e.oslash=500,e.oe=722,e.germandbls=556,e.Idieresis=389,e.eacute=444,e.abreve=500,e.uhungarumlaut=556,e.ecaron=444,e.Ydieresis=722,e.divide=570,e.Yacute=722,e.Acircumflex=722,e.aacute=500,e.Ucircumflex=722,e.yacute=500,e.scommaaccent=389,e.ecircumflex=444,e.Uring=722,e.Udieresis=722,e.aogonek=500,e.Uacute=722,e.uogonek=556,e.Edieresis=667,e.Dcroat=722,e.commaaccent=250,e.copyright=747,e.Emacron=667,e.ccaron=444,e.aring=500,e.Ncommaaccent=722,e.lacute=278,e.agrave=500,e.Tcommaaccent=667,e.Cacute=722,e.atilde=500,e.Edotaccent=667,e.scaron=389,e.scedilla=389,e.iacute=278,e.lozenge=494,e.Rcaron=722,e.Gcommaaccent=778,e.ucircumflex=556,e.acircumflex=500,e.Amacron=722,e.rcaron=444,e.ccedilla=444,e.Zdotaccent=667,e.Thorn=611,e.Omacron=778,e.Racute=722,e.Sacute=556,e.dcaron=672,e.Umacron=722,e.uring=556,e.threesuperior=300,e.Ograve=778,e.Agrave=722,e.Abreve=722,e.multiply=570,e.uacute=556,e.Tcaron=667,e.partialdiff=494,e.ydieresis=500,e.Nacute=722,e.icircumflex=278,e.Ecircumflex=667,e.adieresis=500,e.edieresis=444,e.cacute=444,e.nacute=556,e.umacron=556,e.Ncaron=722,e.Iacute=389,e.plusminus=570,e.brokenbar=220,e.registered=747,e.Gbreve=778,e.Idotaccent=389,e.summation=600,e.Egrave=667,e.racute=444,e.omacron=500,e.Zacute=667,e.Zcaron=667,e.greaterequal=549,e.Eth=722,e.Ccedilla=722,e.lcommaaccent=278,e.tcaron=416,e.eogonek=444,e.Uogonek=722,e.Aacute=722,e.Adieresis=722,e.egrave=444,e.zacute=444,e.iogonek=278,e.Oacute=778,e.oacute=500,e.amacron=500,e.sacute=389,e.idieresis=278,e.Ocircumflex=778,e.Ugrave=722,e.Delta=612,e.thorn=556,e.twosuperior=300,e.Odieresis=778,e.mu=556,e.igrave=278,e.ohungarumlaut=500,e.Eogonek=667,e.dcroat=556,e.threequarters=750,e.Scedilla=556,e.lcaron=394,e.Kcommaaccent=778,e.Lacute=667,e.trademark=1e3,e.edotaccent=444,e.Igrave=389,e.Imacron=389,e.Lcaron=667,e.onehalf=750,e.lessequal=549,e.ocircumflex=500,e.ntilde=556,e.Uhungarumlaut=722,e.Eacute=667,e.emacron=444,e.gbreve=500,e.onequarter=750,e.Scaron=556,e.Scommaaccent=556,e.Ohungarumlaut=778,e.degree=400,e.ograve=500,e.Ccaron=722,e.ugrave=556,e.radical=549,e.Dcaron=722,e.rcommaaccent=444,e.Ntilde=722,e.otilde=500,e.Rcommaaccent=722,e.Lcommaaccent=667,e.Atilde=722,e.Aogonek=722,e.Aring=722,e.Otilde=778,e.zdotaccent=444,e.Ecaron=667,e.Iogonek=389,e.kcommaaccent=556,e.minus=570,e.Icircumflex=389,e.ncaron=556,e.tcommaaccent=333,e.logicalnot=570,e.odieresis=500,e.udieresis=556,e.notequal=549,e.gcommaaccent=500,e.eth=500,e.zcaron=444,e.ncommaaccent=556,e.onesuperior=300,e.imacron=278,e.Euro=500}),n["Times-BoldItalic"]=Ei(function(e){e.space=250,e.exclam=389,e.quotedbl=555,e.numbersign=500,e.dollar=500,e.percent=833,e.ampersand=778,e.quoteright=333,e.parenleft=333,e.parenright=333,e.asterisk=500,e.plus=570,e.comma=250,e.hyphen=333,e.period=250,e.slash=278,e.zero=500,e.one=500,e.two=500,e.three=500,e.four=500,e.five=500,e.six=500,e.seven=500,e.eight=500,e.nine=500,e.colon=333,e.semicolon=333,e.less=570,e.equal=570,e.greater=570,e.question=500,e.at=832,e.A=667,e.B=667,e.C=667,e.D=722,e.E=667,e.F=667,e.G=722,e.H=778,e.I=389,e.J=500,e.K=667,e.L=611,e.M=889,e.N=722,e.O=722,e.P=611,e.Q=722,e.R=667,e.S=556,e.T=611,e.U=722,e.V=667,e.W=889,e.X=667,e.Y=611,e.Z=611,e.bracketleft=333,e.backslash=278,e.bracketright=333,e.asciicircum=570,e.underscore=500,e.quoteleft=333,e.a=500,e.b=500,e.c=444,e.d=500,e.e=444,e.f=333,e.g=500,e.h=556,e.i=278,e.j=278,e.k=500,e.l=278,e.m=778,e.n=556,e.o=500,e.p=500,e.q=500,e.r=389,e.s=389,e.t=278,e.u=556,e.v=444,e.w=667,e.x=500,e.y=444,e.z=389,e.braceleft=348,e.bar=220,e.braceright=348,e.asciitilde=570,e.exclamdown=389,e.cent=500,e.sterling=500,e.fraction=167,e.yen=500,e.florin=500,e.section=500,e.currency=500,e.quotesingle=278,e.quotedblleft=500,e.guillemotleft=500,e.guilsinglleft=333,e.guilsinglright=333,e.fi=556,e.fl=556,e.endash=500,e.dagger=500,e.daggerdbl=500,e.periodcentered=250,e.paragraph=500,e.bullet=350,e.quotesinglbase=333,e.quotedblbase=500,e.quotedblright=500,e.guillemotright=500,e.ellipsis=1e3,e.perthousand=1e3,e.questiondown=500,e.grave=333,e.acute=333,e.circumflex=333,e.tilde=333,e.macron=333,e.breve=333,e.dotaccent=333,e.dieresis=333,e.ring=333,e.cedilla=333,e.hungarumlaut=333,e.ogonek=333,e.caron=333,e.emdash=1e3,e.AE=944,e.ordfeminine=266,e.Lslash=611,e.Oslash=722,e.OE=944,e.ordmasculine=300,e.ae=722,e.dotlessi=278,e.lslash=278,e.oslash=500,e.oe=722,e.germandbls=500,e.Idieresis=389,e.eacute=444,e.abreve=500,e.uhungarumlaut=556,e.ecaron=444,e.Ydieresis=611,e.divide=570,e.Yacute=611,e.Acircumflex=667,e.aacute=500,e.Ucircumflex=722,e.yacute=444,e.scommaaccent=389,e.ecircumflex=444,e.Uring=722,e.Udieresis=722,e.aogonek=500,e.Uacute=722,e.uogonek=556,e.Edieresis=667,e.Dcroat=722,e.commaaccent=250,e.copyright=747,e.Emacron=667,e.ccaron=444,e.aring=500,e.Ncommaaccent=722,e.lacute=278,e.agrave=500,e.Tcommaaccent=611,e.Cacute=667,e.atilde=500,e.Edotaccent=667,e.scaron=389,e.scedilla=389,e.iacute=278,e.lozenge=494,e.Rcaron=667,e.Gcommaaccent=722,e.ucircumflex=556,e.acircumflex=500,e.Amacron=667,e.rcaron=389,e.ccedilla=444,e.Zdotaccent=611,e.Thorn=611,e.Omacron=722,e.Racute=667,e.Sacute=556,e.dcaron=608,e.Umacron=722,e.uring=556,e.threesuperior=300,e.Ograve=722,e.Agrave=667,e.Abreve=667,e.multiply=570,e.uacute=556,e.Tcaron=611,e.partialdiff=494,e.ydieresis=444,e.Nacute=722,e.icircumflex=278,e.Ecircumflex=667,e.adieresis=500,e.edieresis=444,e.cacute=444,e.nacute=556,e.umacron=556,e.Ncaron=722,e.Iacute=389,e.plusminus=570,e.brokenbar=220,e.registered=747,e.Gbreve=722,e.Idotaccent=389,e.summation=600,e.Egrave=667,e.racute=389,e.omacron=500,e.Zacute=611,e.Zcaron=611,e.greaterequal=549,e.Eth=722,e.Ccedilla=667,e.lcommaaccent=278,e.tcaron=366,e.eogonek=444,e.Uogonek=722,e.Aacute=667,e.Adieresis=667,e.egrave=444,e.zacute=389,e.iogonek=278,e.Oacute=722,e.oacute=500,e.amacron=500,e.sacute=389,e.idieresis=278,e.Ocircumflex=722,e.Ugrave=722,e.Delta=612,e.thorn=500,e.twosuperior=300,e.Odieresis=722,e.mu=576,e.igrave=278,e.ohungarumlaut=500,e.Eogonek=667,e.dcroat=500,e.threequarters=750,e.Scedilla=556,e.lcaron=382,e.Kcommaaccent=667,e.Lacute=611,e.trademark=1e3,e.edotaccent=444,e.Igrave=389,e.Imacron=389,e.Lcaron=611,e.onehalf=750,e.lessequal=549,e.ocircumflex=500,e.ntilde=556,e.Uhungarumlaut=722,e.Eacute=667,e.emacron=444,e.gbreve=500,e.onequarter=750,e.Scaron=556,e.Scommaaccent=556,e.Ohungarumlaut=722,e.degree=400,e.ograve=500,e.Ccaron=667,e.ugrave=556,e.radical=549,e.Dcaron=722,e.rcommaaccent=389,e.Ntilde=722,e.otilde=500,e.Rcommaaccent=667,e.Lcommaaccent=611,e.Atilde=667,e.Aogonek=667,e.Aring=667,e.Otilde=722,e.zdotaccent=389,e.Ecaron=667,e.Iogonek=389,e.kcommaaccent=500,e.minus=606,e.Icircumflex=389,e.ncaron=556,e.tcommaaccent=278,e.logicalnot=606,e.odieresis=500,e.udieresis=556,e.notequal=549,e.gcommaaccent=500,e.eth=500,e.zcaron=389,e.ncommaaccent=556,e.onesuperior=300,e.imacron=278,e.Euro=500}),n["Times-Italic"]=Ei(function(e){e.space=250,e.exclam=333,e.quotedbl=420,e.numbersign=500,e.dollar=500,e.percent=833,e.ampersand=778,e.quoteright=333,e.parenleft=333,e.parenright=333,e.asterisk=500,e.plus=675,e.comma=250,e.hyphen=333,e.period=250,e.slash=278,e.zero=500,e.one=500,e.two=500,e.three=500,e.four=500,e.five=500,e.six=500,e.seven=500,e.eight=500,e.nine=500,e.colon=333,e.semicolon=333,e.less=675,e.equal=675,e.greater=675,e.question=500,e.at=920,e.A=611,e.B=611,e.C=667,e.D=722,e.E=611,e.F=611,e.G=722,e.H=722,e.I=333,e.J=444,e.K=667,e.L=556,e.M=833,e.N=667,e.O=722,e.P=611,e.Q=722,e.R=611,e.S=500,e.T=556,e.U=722,e.V=611,e.W=833,e.X=611,e.Y=556,e.Z=556,e.bracketleft=389,e.backslash=278,e.bracketright=389,e.asciicircum=422,e.underscore=500,e.quoteleft=333,e.a=500,e.b=500,e.c=444,e.d=500,e.e=444,e.f=278,e.g=500,e.h=500,e.i=278,e.j=278,e.k=444,e.l=278,e.m=722,e.n=500,e.o=500,e.p=500,e.q=500,e.r=389,e.s=389,e.t=278,e.u=500,e.v=444,e.w=667,e.x=444,e.y=444,e.z=389,e.braceleft=400,e.bar=275,e.braceright=400,e.asciitilde=541,e.exclamdown=389,e.cent=500,e.sterling=500,e.fraction=167,e.yen=500,e.florin=500,e.section=500,e.currency=500,e.quotesingle=214,e.quotedblleft=556,e.guillemotleft=500,e.guilsinglleft=333,e.guilsinglright=333,e.fi=500,e.fl=500,e.endash=500,e.dagger=500,e.daggerdbl=500,e.periodcentered=250,e.paragraph=523,e.bullet=350,e.quotesinglbase=333,e.quotedblbase=556,e.quotedblright=556,e.guillemotright=500,e.ellipsis=889,e.perthousand=1e3,e.questiondown=500,e.grave=333,e.acute=333,e.circumflex=333,e.tilde=333,e.macron=333,e.breve=333,e.dotaccent=333,e.dieresis=333,e.ring=333,e.cedilla=333,e.hungarumlaut=333,e.ogonek=333,e.caron=333,e.emdash=889,e.AE=889,e.ordfeminine=276,e.Lslash=556,e.Oslash=722,e.OE=944,e.ordmasculine=310,e.ae=667,e.dotlessi=278,e.lslash=278,e.oslash=500,e.oe=667,e.germandbls=500,e.Idieresis=333,e.eacute=444,e.abreve=500,e.uhungarumlaut=500,e.ecaron=444,e.Ydieresis=556,e.divide=675,e.Yacute=556,e.Acircumflex=611,e.aacute=500,e.Ucircumflex=722,e.yacute=444,e.scommaaccent=389,e.ecircumflex=444,e.Uring=722,e.Udieresis=722,e.aogonek=500,e.Uacute=722,e.uogonek=500,e.Edieresis=611,e.Dcroat=722,e.commaaccent=250,e.copyright=760,e.Emacron=611,e.ccaron=444,e.aring=500,e.Ncommaaccent=667,e.lacute=278,e.agrave=500,e.Tcommaaccent=556,e.Cacute=667,e.atilde=500,e.Edotaccent=611,e.scaron=389,e.scedilla=389,e.iacute=278,e.lozenge=471,e.Rcaron=611,e.Gcommaaccent=722,e.ucircumflex=500,e.acircumflex=500,e.Amacron=611,e.rcaron=389,e.ccedilla=444,e.Zdotaccent=556,e.Thorn=611,e.Omacron=722,e.Racute=611,e.Sacute=500,e.dcaron=544,e.Umacron=722,e.uring=500,e.threesuperior=300,e.Ograve=722,e.Agrave=611,e.Abreve=611,e.multiply=675,e.uacute=500,e.Tcaron=556,e.partialdiff=476,e.ydieresis=444,e.Nacute=667,e.icircumflex=278,e.Ecircumflex=611,e.adieresis=500,e.edieresis=444,e.cacute=444,e.nacute=500,e.umacron=500,e.Ncaron=667,e.Iacute=333,e.plusminus=675,e.brokenbar=275,e.registered=760,e.Gbreve=722,e.Idotaccent=333,e.summation=600,e.Egrave=611,e.racute=389,e.omacron=500,e.Zacute=556,e.Zcaron=556,e.greaterequal=549,e.Eth=722,e.Ccedilla=667,e.lcommaaccent=278,e.tcaron=300,e.eogonek=444,e.Uogonek=722,e.Aacute=611,e.Adieresis=611,e.egrave=444,e.zacute=389,e.iogonek=278,e.Oacute=722,e.oacute=500,e.amacron=500,e.sacute=389,e.idieresis=278,e.Ocircumflex=722,e.Ugrave=722,e.Delta=612,e.thorn=500,e.twosuperior=300,e.Odieresis=722,e.mu=500,e.igrave=278,e.ohungarumlaut=500,e.Eogonek=611,e.dcroat=500,e.threequarters=750,e.Scedilla=500,e.lcaron=300,e.Kcommaaccent=667,e.Lacute=556,e.trademark=980,e.edotaccent=444,e.Igrave=333,e.Imacron=333,e.Lcaron=611,e.onehalf=750,e.lessequal=549,e.ocircumflex=500,e.ntilde=500,e.Uhungarumlaut=722,e.Eacute=611,e.emacron=444,e.gbreve=500,e.onequarter=750,e.Scaron=500,e.Scommaaccent=500,e.Ohungarumlaut=722,e.degree=400,e.ograve=500,e.Ccaron=667,e.ugrave=500,e.radical=453,e.Dcaron=722,e.rcommaaccent=389,e.Ntilde=667,e.otilde=500,e.Rcommaaccent=611,e.Lcommaaccent=556,e.Atilde=611,e.Aogonek=611,e.Aring=611,e.Otilde=722,e.zdotaccent=389,e.Ecaron=611,e.Iogonek=333,e.kcommaaccent=444,e.minus=675,e.Icircumflex=333,e.ncaron=500,e.tcommaaccent=278,e.logicalnot=675,e.odieresis=500,e.udieresis=500,e.notequal=549,e.gcommaaccent=500,e.eth=500,e.zcaron=389,e.ncommaaccent=500,e.onesuperior=300,e.imacron=278,e.Euro=500}),n.ZapfDingbats=Ei(function(e){e.space=278,e.a1=974,e.a2=961,e.a202=974,e.a3=980,e.a4=719,e.a5=789,e.a119=790,e.a118=791,e.a117=690,e.a11=960,e.a12=939,e.a13=549,e.a14=855,e.a15=911,e.a16=933,e.a105=911,e.a17=945,e.a18=974,e.a19=755,e.a20=846,e.a21=762,e.a22=761,e.a23=571,e.a24=677,e.a25=763,e.a26=760,e.a27=759,e.a28=754,e.a6=494,e.a7=552,e.a8=537,e.a9=577,e.a10=692,e.a29=786,e.a30=788,e.a31=788,e.a32=790,e.a33=793,e.a34=794,e.a35=816,e.a36=823,e.a37=789,e.a38=841,e.a39=823,e.a40=833,e.a41=816,e.a42=831,e.a43=923,e.a44=744,e.a45=723,e.a46=749,e.a47=790,e.a48=792,e.a49=695,e.a50=776,e.a51=768,e.a52=792,e.a53=759,e.a54=707,e.a55=708,e.a56=682,e.a57=701,e.a58=826,e.a59=815,e.a60=789,e.a61=789,e.a62=707,e.a63=687,e.a64=696,e.a65=689,e.a66=786,e.a67=787,e.a68=713,e.a69=791,e.a70=785,e.a71=791,e.a72=873,e.a73=761,e.a74=762,e.a203=762,e.a75=759,e.a204=759,e.a76=892,e.a77=892,e.a78=788,e.a79=784,e.a81=438,e.a82=138,e.a83=277,e.a84=415,e.a97=392,e.a98=392,e.a99=668,e.a100=668,e.a89=390,e.a90=390,e.a93=317,e.a94=317,e.a91=276,e.a92=276,e.a205=509,e.a85=509,e.a206=410,e.a86=410,e.a87=234,e.a88=234,e.a95=334,e.a96=334,e.a101=732,e.a102=544,e.a103=544,e.a104=910,e.a106=667,e.a107=760,e.a108=760,e.a112=776,e.a111=595,e.a110=694,e.a109=626,e.a120=788,e.a121=788,e.a122=788,e.a123=788,e.a124=788,e.a125=788,e.a126=788,e.a127=788,e.a128=788,e.a129=788,e.a130=788,e.a131=788,e.a132=788,e.a133=788,e.a134=788,e.a135=788,e.a136=788,e.a137=788,e.a138=788,e.a139=788,e.a140=788,e.a141=788,e.a142=788,e.a143=788,e.a144=788,e.a145=788,e.a146=788,e.a147=788,e.a148=788,e.a149=788,e.a150=788,e.a151=788,e.a152=788,e.a153=788,e.a154=788,e.a155=788,e.a156=788,e.a157=788,e.a158=788,e.a159=788,e.a160=894,e.a161=838,e.a163=1016,e.a164=458,e.a196=748,e.a165=924,e.a192=748,e.a166=918,e.a167=927,e.a168=928,e.a169=928,e.a170=834,e.a171=873,e.a172=828,e.a173=924,e.a162=924,e.a174=917,e.a175=930,e.a176=931,e.a177=463,e.a178=883,e.a179=836,e.a193=836,e.a180=867,e.a199=867,e.a181=696,e.a200=696,e.a182=874,e.a201=874,e.a183=760,e.a184=946,e.a197=771,e.a185=865,e.a194=771,e.a198=888,e.a186=967,e.a195=888,e.a187=831,e.a188=873,e.a189=927,e.a190=970,e.a191=918})}),Jz=Ei(function(n){n.Courier={ascent:629,descent:-157,capHeight:562,xHeight:-426},n["Courier-Bold"]={ascent:629,descent:-157,capHeight:562,xHeight:439},n["Courier-Oblique"]={ascent:629,descent:-157,capHeight:562,xHeight:426},n["Courier-BoldOblique"]={ascent:629,descent:-157,capHeight:562,xHeight:426},n.Helvetica={ascent:718,descent:-207,capHeight:718,xHeight:523},n["Helvetica-Bold"]={ascent:718,descent:-207,capHeight:718,xHeight:532},n["Helvetica-Oblique"]={ascent:718,descent:-207,capHeight:718,xHeight:523},n["Helvetica-BoldOblique"]={ascent:718,descent:-207,capHeight:718,xHeight:532},n["Times-Roman"]={ascent:683,descent:-217,capHeight:662,xHeight:450},n["Times-Bold"]={ascent:683,descent:-217,capHeight:676,xHeight:461},n["Times-Italic"]={ascent:683,descent:-217,capHeight:653,xHeight:441},n["Times-BoldItalic"]={ascent:683,descent:-217,capHeight:669,xHeight:462},n.Symbol={ascent:Math.NaN,descent:Math.NaN,capHeight:Math.NaN,xHeight:Math.NaN},n.ZapfDingbats={ascent:Math.NaN,descent:Math.NaN,capHeight:Math.NaN,xHeight:Math.NaN}}),Zz=1,n9=2,i9=4,Ck=8,Nm=16,Om=32,Qz=64,Dm=1,s9=2,$z=8,ej=32,tj=64,nj=128,Tw=256;class ij{constructor({glyfTable:e,isGlyphLocationsLong:t,locaTable:i,numGlyphs:s}){this.glyphs=[];const r=new DataView(i.buffer,i.byteOffset,i.byteLength),a=new DataView(e.buffer,e.byteOffset,e.byteLength),o=t?4:2;let l=t?r.getUint32(0):2*r.getUint16(0),c=0;for(let h=0;h<s;h++){c+=o;const u=t?r.getUint32(c):2*r.getUint16(c);if(u===l){this.glyphs.push(new Qp({}));continue}const d=Qp.parse(l,a);this.glyphs.push(d),l=u}}getSize(){return Math.sumPrecise(this.glyphs.map(e=>e.getSize()+3&-4))}write(){const e=this.getSize(),t=new DataView(new ArrayBuffer(e)),i=e>131070,s=i?4:2,r=new DataView(new ArrayBuffer((this.glyphs.length+1)*s));i?r.setUint32(0,0):r.setUint16(0,0);let a=0,o=0;for(const l of this.glyphs)a+=l.write(a,t),a=a+3&-4,o+=s,i?r.setUint32(o,a):r.setUint16(o,a>>1);return{isLocationLong:i,loca:new Uint8Array(r.buffer),glyf:new Uint8Array(t.buffer)}}scale(e){for(let t=0,i=this.glyphs.length;t<i;t++)this.glyphs[t].scale(e[t])}}class Qp{constructor({header:e=null,simple:t=null,composites:i=null}){this.header=e,this.simple=t,this.composites=i}static parse(e,t){const[i,s]=L4.parse(e,t);if(e+=i,s.numberOfContours<0){const a=[];for(;;){const[o,l]=U4.parse(e,t);if(e+=o,a.push(l),!(l.flags&ej))break}return new Qp({header:s,composites:a})}const r=B4.parse(e,t,s.numberOfContours);return new Qp({header:s,simple:r})}getSize(){if(!this.header)return 0;const e=this.simple?this.simple.getSize():Math.sumPrecise(this.composites.map(t=>t.getSize()));return this.header.getSize()+e}write(e,t){if(!this.header)return 0;const i=e;if(e+=this.header.write(e,t),this.simple)e+=this.simple.write(e,t);else for(const s of this.composites)e+=s.write(e,t);return e-i}scale(e){if(!this.header)return;const t=(this.header.xMin+this.header.xMax)/2;if(this.header.scale(t,e),this.simple)this.simple.scale(t,e);else for(const i of this.composites)i.scale(t,e)}}class L4{constructor({numberOfContours:e,xMin:t,yMin:i,xMax:s,yMax:r}){this.numberOfContours=e,this.xMin=t,this.yMin=i,this.xMax=s,this.yMax=r}static parse(e,t){return[10,new L4({numberOfContours:t.getInt16(e),xMin:t.getInt16(e+2),yMin:t.getInt16(e+4),xMax:t.getInt16(e+6),yMax:t.getInt16(e+8)})]}getSize(){return 10}write(e,t){return t.setInt16(e,this.numberOfContours),t.setInt16(e+2,this.xMin),t.setInt16(e+4,this.yMin),t.setInt16(e+6,this.xMax),t.setInt16(e+8,this.yMax),10}scale(e,t){this.xMin=Math.round(e+(this.xMin-e)*t),this.xMax=Math.round(e+(this.xMax-e)*t)}}class sj{constructor({flags:e,xCoordinates:t,yCoordinates:i}){this.xCoordinates=t,this.yCoordinates=i,this.flags=e}}class B4{constructor({contours:e,instructions:t}){this.contours=e,this.instructions=t}static parse(e,t,i){const s=[];for(let b=0;b<i;b++){const p=t.getUint16(e);e+=2,s.push(p)}const r=s[i-1]+1,a=t.getUint16(e);e+=2;const o=new Uint8Array(t).slice(e,e+a);e+=a;const l=[];for(let b=0;b<r;e++,b++){let p=t.getUint8(e);if(l.push(p),p&Ck){const y=t.getUint8(++e);p^=Ck;for(let w=0;w<y;w++)l.push(p);b+=y}}const c=[];let h=[],u=[],d=[];const f=[];let g=0,m=0;for(let b=0;b<r;b++){const p=l[b];if(p&n9){const y=t.getUint8(e++);m+=p&Nm?y:-y,h.push(m)}else p&Nm||(m+=t.getInt16(e),e+=2),h.push(m);s[g]===b&&(g++,c.push(h),h=[])}m=0,g=0;for(let b=0;b<r;b++){const p=l[b];if(p&i9){const y=t.getUint8(e++);m+=p&Om?y:-y,u.push(m)}else p&Om||(m+=t.getInt16(e),e+=2),u.push(m);d.push(p&Zz|p&Qz),s[g]===b&&(h=c[g],g++,f.push(new sj({flags:d,xCoordinates:h,yCoordinates:u})),u=[],d=[])}return new B4({contours:f,instructions:o})}getSize(){let e=this.contours.length*2+2+this.instructions.length,t=0,i=0;for(const s of this.contours){e+=s.flags.length;for(let r=0,a=s.xCoordinates.length;r<a;r++){const o=s.xCoordinates[r],l=s.yCoordinates[r];let c=Math.abs(o-t);c>255?e+=2:c>0&&(e+=1),t=o,c=Math.abs(l-i),c>255?e+=2:c>0&&(e+=1),i=l}}return e}write(e,t){const i=e,s=[],r=[],a=[];let o=0,l=0;for(const c of this.contours){for(let h=0,u=c.xCoordinates.length;h<u;h++){let d=c.flags[h];const f=c.xCoordinates[h];let g=f-o;if(g===0)d|=Nm,s.push(0);else{const b=Math.abs(g);b<=255?(d|=g>=0?n9|Nm:n9,s.push(b)):s.push(g)}o=f;const m=c.yCoordinates[h];if(g=m-l,g===0)d|=Om,r.push(0);else{const b=Math.abs(g);b<=255?(d|=g>=0?i9|Om:i9,r.push(b)):r.push(g)}l=m,a.push(d)}t.setUint16(e,s.length-1),e+=2}t.setUint16(e,this.instructions.length),e+=2,this.instructions.length&&(new Uint8Array(t.buffer,0,t.buffer.byteLength).set(this.instructions,e),e+=this.instructions.length);for(const c of a)t.setUint8(e++,c);for(let c=0,h=s.length;c<h;c++){const u=s[c],d=a[c];d&n9?t.setUint8(e++,u):d&Nm||(t.setInt16(e,u),e+=2)}for(let c=0,h=r.length;c<h;c++){const u=r[c],d=a[c];d&i9?t.setUint8(e++,u):d&Om||(t.setInt16(e,u),e+=2)}return e-i}scale(e,t){for(const i of this.contours)if(i.xCoordinates.length!==0)for(let s=0,r=i.xCoordinates.length;s<r;s++)i.xCoordinates[s]=Math.round(e+(i.xCoordinates[s]-e)*t)}}class U4{constructor({flags:e,glyphIndex:t,argument1:i,argument2:s,transf:r,instructions:a}){this.flags=e,this.glyphIndex=t,this.argument1=i,this.argument2=s,this.transf=r,this.instructions=a}static parse(e,t){const i=e,s=[];let r=t.getUint16(e);const a=t.getUint16(e+2);e+=4;let o,l;r&Dm?(r&s9?(o=t.getInt16(e),l=t.getInt16(e+2)):(o=t.getUint16(e),l=t.getUint16(e+2)),e+=4,r^=Dm):(r&s9?(o=t.getInt8(e),l=t.getInt8(e+1)):(o=t.getUint8(e),l=t.getUint8(e+1)),e+=2),r&$z?(s.push(t.getUint16(e)),e+=2):r&tj?(s.push(t.getUint16(e),t.getUint16(e+2)),e+=4):r&nj&&(s.push(t.getUint16(e),t.getUint16(e+2),t.getUint16(e+4),t.getUint16(e+6)),e+=8);let c=null;if(r&Tw){const h=t.getUint16(e);e+=2,c=new Uint8Array(t).slice(e,e+h),e+=h}return[e-i,new U4({flags:r,glyphIndex:a,argument1:o,argument2:l,transf:s,instructions:c})]}getSize(){let e=4+this.transf.length*2;return this.flags&Tw&&(e+=2+this.instructions.length),e+=2,this.flags&2?this.argument1>=-128&&this.argument1<=127&&this.argument2>=-128&&this.argument2<=127||(e+=2):this.argument1>=0&&this.argument1<=255&&this.argument2>=0&&this.argument2<=255||(e+=2),e}write(e,t){const i=e;return this.flags&s9?this.argument1>=-128&&this.argument1<=127&&this.argument2>=-128&&this.argument2<=127||(this.flags|=Dm):this.argument1>=0&&this.argument1<=255&&this.argument2>=0&&this.argument2<=255||(this.flags|=Dm),t.setUint16(e,this.flags),t.setUint16(e+2,this.glyphIndex),e+=4,this.flags&Dm?(this.flags&s9?(t.setInt16(e,this.argument1),t.setInt16(e+2,this.argument2)):(t.setUint16(e,this.argument1),t.setUint16(e+2,this.argument2)),e+=4):(t.setUint8(e,this.argument1),t.setUint8(e+1,this.argument2),e+=2),this.flags&Tw&&(t.setUint16(e,this.instructions.length),e+=2,this.instructions.length&&(new Uint8Array(t.buffer,0,t.buffer.byteLength).set(this.instructions,e),e+=this.instructions.length)),e-i}scale(e,t){}}function r9(n,e,t){n[e]=t>>8&255,n[e+1]=t&255}function Rw(n,e,t){n[e]=t>>24&255,n[e+1]=t>>16&255,n[e+2]=t>>8&255,n[e+3]=t&255}function rj(n,e,t){if(t instanceof Uint8Array)n.set(t,e);else if(typeof t=="string")for(let i=0,s=t.length;i<s;i++)n[e++]=t.charCodeAt(i)&255;else for(const i of t)n[e++]=i&255}const Ak=12,Sk=16;class $p{constructor(e){this.sfnt=e,this.tables=Object.create(null)}static getSearchParams(e,t){let i=1,s=0;for(;(i^e)>i;)i<<=1,s++;const r=i*t;return{range:r,entry:s,rangeShift:t*e-r}}toArray(){let e=this.sfnt;const t=this.tables,i=Object.keys(t);i.sort();const s=i.length;let r,a,o,l,c,h=Ak+s*Sk;const u=[h];for(r=0;r<s;r++){l=t[i[r]];const g=(l.length+3&-4)>>>0;h+=g,u.push(h)}const d=new Uint8Array(h);for(r=0;r<s;r++)l=t[i[r]],rj(d,u[r],l);e==="true"&&(e=ur(65536)),d[0]=e.charCodeAt(0)&255,d[1]=e.charCodeAt(1)&255,d[2]=e.charCodeAt(2)&255,d[3]=e.charCodeAt(3)&255,r9(d,4,s);const f=$p.getSearchParams(s,16);for(r9(d,6,f.range),r9(d,8,f.entry),r9(d,10,f.rangeShift),h=Ak,r=0;r<s;r++){c=i[r],d[h]=c.charCodeAt(0)&255,d[h+1]=c.charCodeAt(1)&255,d[h+2]=c.charCodeAt(2)&255,d[h+3]=c.charCodeAt(3)&255;let g=0;for(a=u[r],o=u[r+1];a<o;a+=4){const m=Jn(d,a);g=g+m>>>0}Rw(d,h+4,g),Rw(d,h+8,u[r]),Rw(d,h+12,t[c].length),h+=Sk}return d}addTable(e,t){if(e in this.tables)throw new Error("Table "+e+" already exists");this.tables[e]=t}}const aj=!1,Br={hstem:[1],vstem:[3],vmoveto:[4],rlineto:[5],hlineto:[6],vlineto:[7],rrcurveto:[8],callsubr:[10],flex:[12,35],drop:[12,18],endchar:[14],rmoveto:[21],hmoveto:[22],vhcurveto:[30],hvcurveto:[31]};class oj{constructor(){this.width=0,this.lsb=0,this.flexing=!1,this.output=[],this.stack=[]}convert(e,t,i){const s=e.length;let r=!1,a,o,l;for(let c=0;c<s;c++){let h=e[c];if(h<32){switch(h===12&&(h=(h<<8)+e[++c]),h){case 1:{this.stack=[];break}case 3:{this.stack=[];break}case 4:if(this.flexing){if(this.stack.length<1){r=!0;break}const m=this.stack.pop();this.stack.push(0,m);break}r=this.executeCommand(1,Br.vmoveto);break;case 5:r=this.executeCommand(2,Br.rlineto);break;case 6:r=this.executeCommand(1,Br.hlineto);break;case 7:r=this.executeCommand(1,Br.vlineto);break;case 8:r=this.executeCommand(6,Br.rrcurveto);break;case 9:this.stack=[];break;case 10:if(this.stack.length<1){r=!0;break}if(l=this.stack.pop(),!t[l]){r=!0;break}r=this.convert(t[l],t,i);break;case 11:return r;case 13:if(this.stack.length<2){r=!0;break}a=this.stack.pop(),o=this.stack.pop(),this.lsb=o,this.width=a,this.stack.push(a,o),r=this.executeCommand(2,Br.hmoveto);break;case 14:this.output.push(Br.endchar[0]);break;case 21:if(this.flexing)break;r=this.executeCommand(2,Br.rmoveto);break;case 22:if(this.flexing){this.stack.push(0);break}r=this.executeCommand(1,Br.hmoveto);break;case 30:r=this.executeCommand(4,Br.vhcurveto);break;case 31:r=this.executeCommand(4,Br.hvcurveto);break;case 3072:this.stack=[];break;case 3073:{this.stack=[];break}case 3074:{this.stack=[];break}case 3078:if(i){const m=this.stack.at(-5);this.seac=this.stack.splice(-4,4),this.seac[0]+=this.lsb-m,r=this.executeCommand(0,Br.endchar)}else r=this.executeCommand(4,Br.endchar);break;case 3079:if(this.stack.length<4){r=!0;break}this.stack.pop(),a=this.stack.pop();const u=this.stack.pop();o=this.stack.pop(),this.lsb=o,this.width=a,this.stack.push(a,o,u),r=this.executeCommand(3,Br.rmoveto);break;case 3084:if(this.stack.length<2){r=!0;break}const d=this.stack.pop(),f=this.stack.pop();this.stack.push(f/d);break;case 3088:if(this.stack.length<2){r=!0;break}l=this.stack.pop();const g=this.stack.pop();if(l===0&&g===3){const m=this.stack.splice(-17,17);this.stack.push(m[2]+m[0],m[3]+m[1],m[4],m[5],m[6],m[7],m[8],m[9],m[10],m[11],m[12],m[13],m[14]),r=this.executeCommand(13,Br.flex,!0),this.flexing=!1,this.stack.push(m[15],m[16])}else l===1&&g===0&&(this.flexing=!0);break;case 3089:break;case 3105:this.stack=[];break;default:ae('Unknown type 1 charstring command of "'+h+'"');break}if(r)break;continue}else h<=246?h-=139:h<=250?h=(h-247)*256+e[++c]+108:h<=254?h=-((h-251)*256)-e[++c]-108:h=(e[++c]&255)<<24|(e[++c]&255)<<16|(e[++c]&255)<<8|(e[++c]&255)<<0;this.stack.push(h)}return r}executeCommand(e,t,i){const s=this.stack.length;if(e>s)return!0;const r=s-e;for(let a=r;a<s;a++){let o=this.stack[a];Number.isInteger(o)?this.output.push(28,o>>8&255,o&255):(o=65536*o|0,this.output.push(255,o>>24&255,o>>16&255,o>>8&255,o&255))}return this.output.push(...t),i?this.stack.splice(r,e):this.stack.length=0,!1}}const Ik=55665,lj=4330;function El(n){return n>=48&&n<=57||n>=65&&n<=70||n>=97&&n<=102}function Ek(n,e,t){if(t>=n.length)return new Uint8Array(0);const i=52845,s=22719;let r=e|0,a,o;for(a=0;a<t;a++)r=(n[a]+r)*i+s&65535;const l=n.length-t,c=new Uint8Array(l);for(a=t,o=0;o<l;a++,o++){const h=n[a];c[o]=h^r>>8,r=(h+r)*i+s&65535}return c}function cj(n,e,t){let r=e|0;const a=n.length,o=a>>>1,l=new Uint8Array(o);let c,h;for(c=0,h=0;c<a;c++){const u=n[c];if(!El(u))continue;c++;let d;for(;c<a&&!El(d=n[c]);)c++;if(c<a){const f=parseInt(String.fromCharCode(u,d),16);l[h++]=f^r>>8,r=(f+r)*52845+22719&65535}}return l.slice(t,h)}function Tk(n){return n===47||n===91||n===93||n===123||n===125||n===40||n===41}class Rk{constructor(e,t,i){if(t){const s=e.getBytes(),r=!((El(s[0])||Za(s[0]))&&El(s[1])&&El(s[2])&&El(s[3])&&El(s[4])&&El(s[5])&&El(s[6])&&El(s[7]));e=new ji(r?Ek(s,Ik,4):cj(s,Ik,4))}this.seacAnalysisEnabled=!!i,this.stream=e,this.nextChar()}readNumberArray(){this.getToken();const e=[];for(;;){const t=this.getToken();if(t===null||t==="]"||t==="}")break;e.push(parseFloat(t||0))}return e}readNumber(){const e=this.getToken();return parseFloat(e||0)}readInt(){const e=this.getToken();return parseInt(e||0,10)|0}readBoolean(){return this.getToken()==="true"?1:0}nextChar(){return this.currentChar=this.stream.getByte()}prevChar(){return this.stream.skip(-2),this.currentChar=this.stream.getByte()}getToken(){let e=!1,t=this.currentChar;for(;;){if(t===-1)return null;if(e)(t===10||t===13)&&(e=!1);else if(t===37)e=!0;else if(!Za(t))break;t=this.nextChar()}if(Tk(t))return this.nextChar(),String.fromCharCode(t);let i="";do i+=String.fromCharCode(t),t=this.nextChar();while(t>=0&&!Za(t)&&!Tk(t));return i}readCharStrings(e,t){return t===-1?e:Ek(e,lj,t)}extractFontProgram(e){const t=this.stream,i=[],s=[],r=Object.create(null);r.lenIV=4;const a={subrs:[],charstrings:[],properties:{privateData:r}};let o,l,c,h;for(;(o=this.getToken())!==null;)if(o==="/")switch(o=this.getToken(),o){case"CharStrings":for(this.getToken(),this.getToken(),this.getToken(),this.getToken();o=this.getToken(),!(o===null||o==="end");){if(o!=="/")continue;const d=this.getToken();l=this.readInt(),this.getToken(),c=l>0?t.getBytes(l):new Uint8Array(0),h=a.properties.privateData.lenIV;const f=this.readCharStrings(c,h);this.nextChar(),o=this.getToken(),o==="noaccess"?this.getToken():o==="/"&&this.prevChar(),s.push({glyph:d,encoded:f})}break;case"Subrs":for(this.readInt(),this.getToken();this.getToken()==="dup";){const d=this.readInt();l=this.readInt(),this.getToken(),c=l>0?t.getBytes(l):new Uint8Array(0),h=a.properties.privateData.lenIV;const f=this.readCharStrings(c,h);this.nextChar(),o=this.getToken(),o==="noaccess"&&this.getToken(),i[d]=f}break;case"BlueValues":case"OtherBlues":case"FamilyBlues":case"FamilyOtherBlues":const u=this.readNumberArray();u.length>0&&u.length%2===0&&aj&&(a.properties.privateData[o]=u);break;case"StemSnapH":case"StemSnapV":a.properties.privateData[o]=this.readNumberArray();break;case"StdHW":case"StdVW":a.properties.privateData[o]=this.readNumberArray()[0];break;case"BlueShift":case"lenIV":case"BlueFuzz":case"BlueScale":case"LanguageGroup":a.properties.privateData[o]=this.readNumber();break;case"ExpansionFactor":a.properties.privateData[o]=this.readNumber()||.06;break;case"ForceBold":a.properties.privateData[o]=this.readBoolean();break}for(const{encoded:u,glyph:d}of s){const f=new oj,g=f.convert(u,i,this.seacAnalysisEnabled);let m=f.output;g&&(m=[14]);const b={glyphName:d,charstring:m,width:f.width,lsb:f.lsb,seac:f.seac};if(d===".notdef"?a.charstrings.unshift(b):a.charstrings.push(b),e.builtInEncoding){const p=e.builtInEncoding.indexOf(d);p>-1&&e.widths[p]===void 0&&p>=e.firstChar&&p<=e.lastChar&&(e.widths[p]=f.width)}}return a}extractFontHeader(e){let t;for(;(t=this.getToken())!==null;)if(t==="/")switch(t=this.getToken(),t){case"FontMatrix":const i=this.readNumberArray();e.fontMatrix=i;break;case"Encoding":const s=this.getToken();let r;if(!/^\d+$/.test(s))r=Yp(s);else{r=[];const o=parseInt(s,10)|0;this.getToken();for(let l=0;l<o;l++){for(t=this.getToken();t!=="dup"&&t!=="def";)if(t=this.getToken(),t===null)return;if(t==="def")break;const c=this.readInt();this.getToken();const h=this.getToken();r[c]=h,this.getToken()}}e.builtInEncoding=r;break;case"FontBBox":const a=this.readNumberArray();e.ascent=Math.max(a[3],a[1]),e.descent=Math.min(a[1],a[3]),e.ascentScaled=!0;break}}}function Mk(n,e,t){const i=n.length,s=e.length,r=i-s;let a=t,o=!1;for(;a<r;){let l=0;for(;l<s&&n[a+l]===e[l];)l++;if(l>=s){for(a+=l;a<i&&Za(n[a]);)a++;o=!0;break}a++}return{found:o,length:a}}function hj(n,e){const t=[101,101,120,101,99],i=n.pos;let s,r,a;try{s=n.getBytes(e),r=s.length}catch{}if(r===e&&(a=Mk(s,t,e-2*t.length),a.found&&a.length===e))return{stream:new ji(s),length:e};ae('Invalid "Length1" property in Type1 font -- trying to recover.'),n.pos=i;const o=2048;let l;for(;;){const c=n.peekBytes(o);if(a=Mk(c,t,0),a.length===0)break;if(n.pos+=a.length,a.found){l=n.pos-i;break}}return n.pos=i,l?{stream:new ji(n.getBytes(l)),length:l}:(ae('Unable to recover "Length1" property in Type1 font -- using as is.'),{stream:new ji(n.getBytes(e)),length:e})}function uj(n,e){const t=n.getBytes();if(t.length===0)throw new Te("getEexecBlock - no font program found.");return{stream:new ji(t),length:t.length}}class dj{constructor(e,t,i){let r=i.length1;i.length2;let a=t.peekBytes(6);const o=a[0]===128&&a[1]===1;o&&(t.skip(6),r=a[5]<<24|a[4]<<16|a[3]<<8|a[2]);const l=hj(t,r);new Rk(l.stream,!1,h1).extractFontHeader(i),o&&(a=t.getBytes(6),a[5]<<24|a[4]<<16|a[3]<<8|a[2]);const h=uj(t),d=new Rk(h.stream,!0,h1).extractFontProgram(i);for(const b in d.properties)i[b]=d.properties[b];const f=d.charstrings,g=this.getType2Charstrings(f),m=this.getType2Subrs(d.subrs);this.charstrings=f,this.data=this.wrap(e,g,this.charstrings,m,i),this.seacs=this.getSeacs(d.charstrings)}get numGlyphs(){return this.charstrings.length+1}getCharset(){const e=[".notdef"];for(const{glyphName:t}of this.charstrings)e.push(t);return e}getGlyphMapping(e){const t=this.charstrings;if(e.composite){const o=Object.create(null);for(let l=0,c=t.length;l<c;l++){const h=e.cMap.charCodeOf(l);o[h]=l+1}return o}const i=[".notdef"];let s,r;for(r=0;r<t.length;r++)i.push(t[r].glyphName);const a=e.builtInEncoding;if(a){s=Object.create(null);for(const o in a)r=i.indexOf(a[o]),r>=0&&(s[o]=r)}return ZR(e,s,i)}hasGlyphId(e){return e<0||e>=this.numGlyphs?!1:e===0?!0:this.charstrings[e-1].charstring.length>0}getSeacs(e){const t=[];for(let i=0,s=e.length;i<s;i++){const r=e[i];r.seac&&(t[i+1]=r.seac)}return t}getType2Charstrings(e){const t=[];for(const i of e)t.push(i.charstring);return t}getType2Subrs(e){let t=0;const i=e.length;i<1133?t=107:i<33769?t=1131:t=32768;const s=[];let r;for(r=0;r<t;r++)s.push([11]);for(r=0;r<i;r++)s.push(e[r]);return s}wrap(e,t,i,s,r){const a=new QR;a.header=new $R(1,0,4,4),a.names=[e];const o=new Jp;o.setByName("version",391),o.setByName("Notice",392),o.setByName("FullName",393),o.setByName("FamilyName",394),o.setByName("Weight",395),o.setByName("Encoding",null),o.setByName("FontMatrix",r.fontMatrix),o.setByName("FontBBox",r.bbox),o.setByName("charset",null),o.setByName("CharStrings",null),o.setByName("Private",null),a.topDict=o;const l=new D4;l.add("Version 0.11"),l.add("See original notice"),l.add(e),l.add(e),l.add("Medium"),a.strings=l,a.globalSubrIndex=new Bh;const c=t.length,h=[".notdef"];let u,d;for(u=0;u<c;u++){const y=i[u].glyphName;h3.indexOf(y)===-1&&l.add(y),h.push(y)}a.charset=new mp(!1,0,h);const f=new Bh;for(f.add([139,14]),u=0;u<c;u++)f.add(t[u]);a.charStrings=f;const g=new Zp;g.setByName("Subrs",null);const m=["BlueValues","OtherBlues","FamilyBlues","FamilyOtherBlues","StemSnapH","StemSnapV","BlueShift","BlueFuzz","BlueScale","LanguageGroup","ExpansionFactor","ForceBold","StdHW","StdVW"];for(u=0,d=m.length;u<d;u++){const y=m[u];if(!(y in r.privateData))continue;const w=r.privateData[y];if(Array.isArray(w))for(let _=w.length-1;_>0;_--)w[_]-=w[_-1];g.setByName(y,w)}a.topDict.privateDict=g;const b=new Bh;for(u=0,d=s.length;u<d;u++)b.add(s[u]);return g.subrsIndex=b,new wx(a).compile()}}const mc=[[57344,63743],[1048576,1114109]],gu=1e3,Pk=["ascent","bbox","black","bold","charProcOperatorList","cssFontInfo","data","defaultVMetrics","defaultWidth","descent","disableFontFace","fallbackName","fontExtraProperties","fontMatrix","isInvalidPDFjsFont","isType3Font","italic","loadedName","mimetype","missingFile","name","remeasure","systemFontInfo","vertical"],fj=["cMap","composite","defaultEncoding","differences","isMonospace","isSerifFont","isSymbolicFont","seacMap","subtype","toFontChar","toUnicode","type","vmetrics","widths"];function Nk(n){if(!n.fontMatrix||n.fontMatrix[0]===Vd[0])return;const e=.001/n.fontMatrix[0],t=n.widths;for(const i in t)t[i]*=e;n.defaultWidth*=e}function gj(n,e,t){if(n.isInternalFont||n.hasIncludedToUnicodeMap||n.hasEncoding||n.toUnicode instanceof yo||!e||t.length===0||n.defaultEncoding===Xp)return;for(const a of t)if(!rM(a))return;const i=Xp,s=[],r=$l();for(const a in i){const o=i[a];if(o==="")continue;const l=r[o];l!==void 0&&(s[a]=String.fromCharCode(l))}s.length>0&&n.toUnicode.amend(s)}function mj(n,e){if(n.isInternalFont||n.hasIncludedToUnicodeMap||e===n.defaultEncoding||n.toUnicode instanceof yo)return;const t=[],i=$l();for(const s in e){if(n.hasEncoding&&(n.baseEncodingName||n.differences[s]!==void 0))continue;const r=e[s],a=Dg(r,i);a!==-1&&(t[s]=String.fromCharCode(a))}t.length>0&&n.toUnicode.amend(t)}function Ok(n){if(!n.fallbackToUnicode||n.toUnicode instanceof yo)return;const e=[];for(const t in n.fallbackToUnicode)n.toUnicode.has(t)||(e[t]=n.fallbackToUnicode[t]);e.length>0&&n.toUnicode.amend(e)}class pj{constructor(e,t,i,s,r,a,o,l,c){this.originalCharCode=e,this.fontChar=t,this.unicode=i,this.accent=s,this.width=r,this.vmetric=a,this.operatorListId=o,this.isSpace=l,this.isInFont=c}get category(){return We(this,"category",Sz(this.unicode),!0)}}function au(n,e){return(n<<8)+e}function Fm(n,e,t){n[e+1]=t,n[e]=t>>>8}function ka(n,e){const t=(n<<8)+e;return t&32768?t-65536:t}function bj(n,e,t){n[e+3]=t&255,n[e+2]=t>>>8,n[e+1]=t>>>16,n[e]=t>>>24}function xj(n,e,t,i){return(n<<24)+(e<<16)+(t<<8)+i}function Gn(n){return String.fromCharCode(n>>8&255,n&255)}function ou(n){return n>32767?n=32767:n<-32768&&(n=-32768),String.fromCharCode(n>>8&255,n&255)}function yj(n){const e=n.peekBytes(4);return Jn(e,0)===65536||xa(e)==="true"}function sM(n){const e=n.peekBytes(4);return xa(e)==="ttcf"}function wj(n){const e=n.peekBytes(4);return xa(e)==="OTTO"}function _j(n){const e=n.peekBytes(2);return e[0]===37&&e[1]===33||e[0]===128&&e[1]===1}function vj(n){const e=n.peekBytes(4);return e[0]>=1&&e[3]>=1&&e[3]<=4}function kj(n,{type:e,subtype:t,composite:i}){let s,r;return yj(n)||sM(n)?s=i?"CIDFontType2":"TrueType":wj(n)?s=i?"CIDFontType2":"OpenType":_j(n)?i?s="CIDFontType0":s=e==="MMType1"?"MMType1":"Type1":vj(n)?i?(s="CIDFontType0",r="CIDFontType0C"):(s=e==="MMType1"?"MMType1":"Type1",r="Type1C"):(ae("getFontFileType: Unable to detect correct font file Type/Subtype."),s=e,r=t),[s,r]}function a9(n,e){for(const t in e)n[+t]=e[t]}function Mw(n,e,t){const i=[];let s;for(let r=0,a=n.length;r<a;r++)s=Dg(n[r],e),s!==-1&&(i[r]=s);for(const r in t)s=Dg(t[r],e),s!==-1&&(i[+r]=s);return i}function Cj(n){return n.platform===1&&n.encoding===0&&n.language===0}function rM(n){return n.platform===3&&n.encoding===1&&n.language===1033}function Pw(n,e,t=!1){switch(e.length){case 1:return e.charCodeAt(0);case 2:return e.charCodeAt(0)<<8|e.charCodeAt(1)}const i=`Unsupported CID string (charCode ${n}): "${e}".`;if(t)throw new Te(i);return ae(i),e}function Dk(n,e,t,i){const s=Object.create(null),r=new Map,a=[],o=new Set;let l=0,h=mc[l][0],u=mc[l][1];const d=g=>mc[0][0]<=g&&g<=mc[0][1]||mc[1][0]<=g&&g<=mc[1][1];let f=null;for(const g in n){let m=n[g];if(!e(m))continue;if(h>u){if(l++,l>=mc.length){ae("Ran out of space in font private use area.");break}h=mc[l][0],u=mc[l][1]}const b=h++;m===0&&(m=t);let p=i.get(g);if(typeof p=="string")if(p.length===1)p=p.codePointAt(0);else{if(!f){f=new Map;for(let y=64256;y<=64335;y++){const w=String.fromCharCode(y).normalize("NFKD");w.length>1&&f.set(w,y)}}p=f.get(p)||p.codePointAt(0)}p&&!d(p)&&!o.has(m)&&(r.set(p,m),o.add(m)),s[b]=m,a[g]=b}return{toFontChar:a,charCodeToGlyphId:s,toUnicodeExtraMap:r,nextAvailableFontCharCode:h}}function Aj(n,e,t){const i=[];for(const a in n)n[a]>=t||i.push({fontCharCode:a|0,glyphId:n[a]});if(e)for(const[a,o]of e)o>=t||i.push({fontCharCode:a,glyphId:o});i.length===0&&i.push({fontCharCode:0,glyphId:0}),i.sort((a,o)=>a.fontCharCode-o.fontCharCode);const s=[],r=i.length;for(let a=0;a<r;){const o=i[a].fontCharCode,l=[i[a].glyphId];++a;let c=o;for(;a<r&&c+1===i[a].fontCharCode&&(l.push(i[a].glyphId),++c,++a,c!==65535););s.push([o,c,l])}return s}function Fk(n,e,t){const i=Aj(n,e,t),s=i.at(-1)[1]>65535?2:1;let r="\0\0"+Gn(s)+"\0\0"+ur(4+s*8),a,o,l,c;for(a=i.length-1;a>=0&&!(i[a][0]<=65535);--a);const h=a+1;i[a][0]<65535&&i[a][1]===65535&&(i[a][1]=65534);const u=i[a][1]<65535?1:0,d=h+u,f=$p.getSearchParams(d,2);let g="",m="",b="",p="",y="",w=0,_,v,C,k;for(a=0,o=h;a<o;a++){_=i[a],v=_[0],C=_[1],g+=Gn(v),m+=Gn(C),k=_[2];let M=!0;for(l=1,c=k.length;l<c;++l)if(k[l]!==k[l-1]+1){M=!1;break}if(M){const D=k[0];b+=Gn(D-v&65535),p+=Gn(0)}else{const D=(d-a)*2+w*2;for(w+=C-v+1,b+=Gn(0),p+=Gn(D),l=0,c=k.length;l<c;++l)y+=Gn(k[l])}}u>0&&(m+="ÿÿ",g+="ÿÿ",b+="\0",p+="\0\0");const I="\0\0"+Gn(2*d)+Gn(f.range)+Gn(f.entry)+Gn(f.rangeShift)+m+"\0\0"+g+b+p+y;let E="",T="";if(s>1){for(r+=`\0\0
`+ur(4+s*8+4+I.length),E="",a=0,o=i.length;a<o;a++){_=i[a],v=_[0],k=_[2];let M=k[0];for(l=1,c=k.length;l<c;++l)k[l]!==k[l-1]+1&&(C=_[0]+l-1,E+=ur(v)+ur(C)+ur(M),v=C+1,M=k[l]);E+=ur(v)+ur(_[1])+ur(M)}T="\0\f\0\0"+ur(E.length+16)+"\0\0\0\0"+ur(E.length/12)}return r+"\0"+Gn(I.length+4)+I+T+E}function Sj(n,e){e.pos=(e.start||0)+n.offset;const t=e.getUint16();e.skip(60);const i=e.getUint16();if(t<4&&i&768)return!1;const s=e.getUint16(),r=e.getUint16();return s>r||(e.skip(6),e.getUint16()===0)?!1:(n.data[8]=n.data[9]=0,!0)}function Lk(n,e,t){t||(t={unitsPerEm:0,yMax:0,yMin:0,ascent:0,descent:0});let i=0,s=0,r=0,a=0,o=null,l=0,c=-1;if(e){for(let p in e)if(p|=0,(o>p||!o)&&(o=p),l<p&&(l=p),c=Cz(p,c),c<32)i|=1<<c;else if(c<64)s|=1<<c-32;else if(c<96)r|=1<<c-64;else if(c<123)a|=1<<c-96;else throw new Te("Unicode ranges Bits > 123 are reserved for internal usage");l>65535&&(l=65535)}else o=0,l=255;const h=n.bbox||[0,0,0,0],u=t.unitsPerEm||(n.fontMatrix?1/Math.max(...n.fontMatrix.slice(0,4).map(Math.abs)):1e3),d=n.ascentScaled?1:u/gu,f=t.ascent||Math.round(d*(n.ascent||h[3]));let g=t.descent||Math.round(d*(n.descent||h[1]));g>0&&n.descent>0&&h[1]<0&&(g=-g);const m=t.yMax||f,b=-t.yMin||-g;return"\0$ô\0\0\0»\0\0\0»\0\0ß\x001\0\0\0\0"+String.fromCharCode(n.fixedPitch?9:0)+"\0\0\0\0\0\0"+ur(i)+ur(s)+ur(r)+ur(a)+"*21*"+Gn(n.italicAngle?1:0)+Gn(o||n.firstChar)+Gn(l||n.lastChar)+Gn(f)+Gn(g)+"\0d"+Gn(m)+Gn(b)+"\0\0\0\0\0\0\0\0"+Gn(n.xHeight)+Gn(n.capHeight)+Gn(0)+Gn(o||n.firstChar)+"\0"}function Bk(n){const e=Math.floor(n.italicAngle*65536);return"\0\0\0"+ur(e)+"\0\0\0\0"+ur(n.fixedPitch?1:0)+"\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0"}function Ij(n){return n.replaceAll(/[^\x21-\x7E]|[[\](){}<>/%]/g,"").slice(0,63)}function Nw(n,e){e||(e=[[],[]]);const t=[e[0][0]||"Original licence",e[0][1]||n,e[0][2]||"Unknown",e[0][3]||"uniqueID",e[0][4]||n,e[0][5]||"Version 0.11",e[0][6]||Ij(n),e[0][7]||"Unknown",e[0][8]||"Unknown",e[0][9]||"Unknown"],i=[];let s,r,a,o,l;for(s=0,r=t.length;s<r;s++){l=e[1][s]||t[s];const b=[];for(a=0,o=l.length;a<o;a++)b.push(Gn(l.charCodeAt(a)));i.push(b.join(""))}const c=[t,i],h=["\0","\0"],u=["\0\0","\0"],d=["\0\0","	"],f=t.length*h.length;let g="\0\0"+Gn(f)+Gn(f*12+6),m=0;for(s=0,r=h.length;s<r;s++){const b=c[s];for(a=0,o=b.length;a<o;a++){l=b[a];const p=h[s]+u[s]+d[s]+Gn(a)+Gn(l.length)+Gn(m);g+=p,m+=l.length}}return g+=t.join("")+i.join(""),g}class Uk{constructor(e,t,i,s){var h;this.name=e,this.psName=null,this.mimetype=null,this.disableFontFace=s.disableFontFace,this.fontExtraProperties=s.fontExtraProperties,this.loadedName=i.loadedName,this.isType3Font=i.isType3Font,this.missingFile=!1,this.cssFontInfo=i.cssFontInfo,this._charsCache=Object.create(null),this._glyphCache=Object.create(null);let r=!!(i.flags&po.Serif);if(!r&&!i.isSimulatedFlags){const u=e.replaceAll(/[,_]/g,"-").split("-",1)[0],d=F4();for(const f of u.split("+"))if(d[f]){r=!0;break}}this.isSerifFont=r,this.isSymbolicFont=!!(i.flags&po.Symbolic),this.isMonospace=!!(i.flags&po.FixedPitch);let{type:a,subtype:o}=i;this.type=a,this.subtype=o,this.systemFontInfo=i.systemFontInfo;const l=e.match(/^InvalidPDFjsFont_(.*)_\d+$/);if(this.isInvalidPDFjsFont=!!l,this.isInvalidPDFjsFont?this.fallbackName=l[1]:this.isMonospace?this.fallbackName="monospace":this.isSerifFont?this.fallbackName="serif":this.fallbackName="sans-serif",(h=this.systemFontInfo)!=null&&h.guessFallback&&(this.systemFontInfo.guessFallback=!1,this.systemFontInfo.css+=`,${this.fallbackName}`),this.differences=i.differences,this.widths=i.widths,this.defaultWidth=i.defaultWidth,this.composite=i.composite,this.cMap=i.cMap,this.capHeight=i.capHeight/gu,this.ascent=i.ascent/gu,this.descent=i.descent/gu,this.lineHeight=this.ascent-this.descent,this.fontMatrix=i.fontMatrix,this.bbox=i.bbox,this.defaultEncoding=i.defaultEncoding,this.toUnicode=i.toUnicode,this.toFontChar=[],i.type==="Type3"){for(let u=0;u<256;u++)this.toFontChar[u]=this.differences[u]||i.defaultEncoding[u];return}if(this.cidEncoding=i.cidEncoding||"",this.vertical=!!i.vertical,this.vertical&&(this.vmetrics=i.vmetrics,this.defaultVMetrics=i.defaultVMetrics),!t||t.isEmpty){t&&ae('Font file is empty in "'+e+'" ('+this.loadedName+")"),this.fallbackToSystemFont(i);return}[a,o]=kj(t,i),(a!==this.type||o!==this.subtype)&&gn(`Inconsistent font file Type/SubType, expected: ${this.type}/${this.subtype} but found: ${a}/${o}.`);let c;try{switch(a){case"MMType1":gn("MMType1 font ("+e+"), falling back to Type1.");case"Type1":case"CIDFontType0":this.mimetype="font/opentype";const u=o==="Type1C"||o==="CIDFontType0C"?new Ew(t,i):new dj(e,t,i);Nk(i),c=this.convert(e,u,i);break;case"OpenType":case"TrueType":case"CIDFontType2":this.mimetype="font/opentype",c=this.checkAndRepair(e,t,i),Nk(i),this.isOpenType&&(a="OpenType");break;default:throw new Te(`Font ${a} is not supported`)}}catch(u){ae(u),this.fallbackToSystemFont(i);return}Ok(i),this.data=c,this.type=a,this.subtype=o,this.fontMatrix=i.fontMatrix,this.widths=i.widths,this.defaultWidth=i.defaultWidth,this.toUnicode=i.toUnicode,this.seacMap=i.seacMap}get renderer(){const e=Xz.create(this,h1);return We(this,"renderer",e)}exportData(){const e=this.fontExtraProperties?[...Pk,...fj]:Pk,t=Object.create(null);for(const i of e){const s=this[i];s!==void 0&&(t[i]=s)}return t}fallbackToSystemFont(e){this.missingFile=!0;const{name:t,type:i}=this;let s=yx(t);const r=hy(),a=tM(),o=!!r[s],l=!!(a[s]&&r[a[s]]);s=r[s]||a[s]||s;const h=Jz()[s];h&&(isNaN(this.ascent)&&(this.ascent=h.ascent/gu),isNaN(this.descent)&&(this.descent=h.descent/gu),isNaN(this.capHeight)&&(this.capHeight=h.capHeight/gu)),this.bold=/bold/gi.test(s),this.italic=/oblique|italic/gi.test(s),this.black=/Black/g.test(t);const u=/Narrow/g.test(t);if(this.remeasure=(!o||u)&&Object.keys(this.widths).length>0,(o||l)&&i==="CIDFontType2"&&this.cidEncoding.startsWith("Identity-")){const d=e.cidToGidMap,f=[];if(a9(f,wk()),/Arial-?Black/i.test(t)?a9(f,Hz()):/Calibri/i.test(t)&&a9(f,zz()),d){for(const g in f){const m=f[g];d[m]!==void 0&&(f[+g]=d[m])}d.length!==this.toUnicode.length&&e.hasIncludedToUnicodeMap&&this.toUnicode instanceof yo&&this.toUnicode.forEach(function(g,m){const b=f[g];d[b]===void 0&&(f[+g]=m)})}this.toUnicode instanceof yo||this.toUnicode.forEach(function(g,m){f[+g]=m}),this.toFontChar=f,this.toUnicode=new pp(f)}else if(/Symbol/i.test(s))this.toFontChar=Mw(P4,$l(),this.differences);else if(/Dingbats/i.test(s))this.toFontChar=Mw(N4,_z(),this.differences);else if(o||l){const d=Mw(this.defaultEncoding,$l(),this.differences);i==="CIDFontType2"&&!this.cidEncoding.startsWith("Identity-")&&!(this.toUnicode instanceof yo)&&this.toUnicode.forEach(function(f,g){d[+f]=g}),this.toFontChar=d}else{const d=$l(),f=[];this.toUnicode.forEach((g,m)=>{if(!this.composite){const b=this.differences[g]||this.defaultEncoding[g],p=Dg(b,d);p!==-1&&(m=p)}f[+g]=m}),this.composite&&this.toUnicode instanceof yo&&/Tahoma|Verdana/i.test(t)&&a9(f,wk()),this.toFontChar=f}Ok(e),this.loadedName=s.split("-",1)[0]}checkAndRepair(e,t,i){var he,de,ge;const s=["OS/2","cmap","head","hhea","hmtx","maxp","name","post","loca","glyf","fpgm","prep","cvt ","CFF "];function r(N,K){const oe=Object.create(null);oe["OS/2"]=null,oe.cmap=null,oe.head=null,oe.hhea=null,oe.hmtx=null,oe.maxp=null,oe.name=null,oe.post=null;for(let W=0;W<K;W++){const le=a(N);s.includes(le.tag)&&le.length!==0&&(oe[le.tag]=le)}return oe}function a(N){const K=N.getString(4),oe=N.getInt32()>>>0,W=N.getInt32()>>>0,le=N.getInt32()>>>0,ce=N.pos;N.pos=N.start||0,N.skip(W);const Ce=N.getBytes(le);return N.pos=ce,K==="head"&&(Ce[8]=Ce[9]=Ce[10]=Ce[11]=0,Ce[17]|=32),{tag:K,checksum:oe,length:le,offset:W,data:Ce}}function o(N){return{version:N.getString(4),numTables:N.getUint16(),searchRange:N.getUint16(),entrySelector:N.getUint16(),rangeShift:N.getUint16()}}function l(N){const K=N.getString(4);qs(K==="ttcf","Must be a TrueType Collection font.");const oe=N.getUint16(),W=N.getUint16(),le=N.getInt32()>>>0,ce=[];for(let X=0;X<le;X++)ce.push(N.getInt32()>>>0);const Ce={ttcTag:K,majorVersion:oe,minorVersion:W,numFonts:le,offsetTable:ce};switch(oe){case 1:return Ce;case 2:return Ce.dsigTag=N.getInt32()>>>0,Ce.dsigLength=N.getInt32()>>>0,Ce.dsigOffset=N.getInt32()>>>0,Ce}throw new Te(`Invalid TrueType Collection majorVersion: ${oe}.`)}function c(N,K){var Ce;const{numFonts:oe,offsetTable:W}=l(N),le=K.split("+");let ce;for(let X=0;X<oe;X++){N.pos=(N.start||0)+W[X];const Ke=o(N),qe=r(N,Ke.numTables);if(!qe.name)throw new Te('TrueType Collection font must contain a "name" table.');const[He]=b(qe.name);for(let Me=0,Ne=He.length;Me<Ne;Me++)for(let Qe=0,gt=He[Me].length;Qe<gt;Qe++){const mt=(Ce=He[Me][Qe])==null?void 0:Ce.replaceAll(/\s/g,"");if(mt){if(mt===K)return{header:Ke,tables:qe};if(!(le.length<2))for(const Xe of le)mt===Xe&&(ce={name:Xe,header:Ke,tables:qe})}}}if(ce)return ae(`TrueType Collection does not contain "${K}" font, falling back to "${ce.name}" font instead.`),{header:ce.header,tables:ce.tables};throw new Te(`TrueType Collection does not contain "${K}" font.`)}function h(N,K,oe,W){if(!N)return ae("No cmap table available."),{platformId:-1,encodingId:-1,mappings:[],hasShortCmap:!1};let le,ce=(K.start||0)+N.offset;K.pos=ce,K.skip(2);const Ce=K.getUint16();let X,Ke=!1;for(let Xe=0;Xe<Ce;Xe++){const rt=K.getUint16(),me=K.getUint16(),Rt=K.getInt32()>>>0;let ct=!1;if(!((X==null?void 0:X.platformId)===rt&&(X==null?void 0:X.encodingId)===me)){if(rt===0&&(me===0||me===1||me===3))ct=!0;else if(rt===1&&me===0)ct=!0;else if(rt===3&&me===1&&(W||!X))ct=!0,oe||(Ke=!0);else if(oe&&rt===3&&me===0){ct=!0;let at=!0;if(Xe<Ce-1){const ze=K.peekBytes(2);au(ze[0],ze[1])<rt&&(at=!1)}at&&(Ke=!0)}if(ct&&(X={platformId:rt,encodingId:me,offset:Rt}),Ke)break}}if(X&&(K.pos=ce+X.offset),!X||K.peekByte()===-1)return ae("Could not find a preferred cmap table."),{platformId:-1,encodingId:-1,mappings:[],hasShortCmap:!1};const qe=K.getUint16();let He=!1;const Me=[];let Ne,Qe;if(qe===0){for(K.skip(4),Ne=0;Ne<256;Ne++){const Xe=K.getByte();Xe&&Me.push({charCode:Ne,glyphId:Xe})}He=!0}else if(qe===2){K.skip(4);const Xe=[];let rt=0;for(let Rt=0;Rt<256;Rt++){const ct=K.getUint16()>>3;Xe.push(ct),rt=Math.max(ct,rt)}const me=[];for(let Rt=0;Rt<=rt;Rt++)me.push({firstCode:K.getUint16(),entryCount:K.getUint16(),idDelta:ka(K.getByte(),K.getByte()),idRangePos:K.pos+K.getUint16()});for(let Rt=0;Rt<256;Rt++)if(Xe[Rt]===0)K.pos=me[0].idRangePos+2*Rt,Qe=K.getUint16(),Me.push({charCode:Rt,glyphId:Qe});else{const ct=me[Xe[Rt]];for(Ne=0;Ne<ct.entryCount;Ne++){const at=(Rt<<8)+Ne+ct.firstCode;K.pos=ct.idRangePos+2*Ne,Qe=K.getUint16(),Qe!==0&&(Qe=(Qe+ct.idDelta)%65536),Me.push({charCode:at,glyphId:Qe})}}}else if(qe===4){K.skip(4);const Xe=K.getUint16()>>1;K.skip(6);const rt=[];let me;for(me=0;me<Xe;me++)rt.push({end:K.getUint16()});for(K.skip(2),me=0;me<Xe;me++)rt[me].start=K.getUint16();for(me=0;me<Xe;me++)rt[me].delta=K.getUint16();let Rt=0,ct;for(me=0;me<Xe;me++){le=rt[me];const ze=K.getUint16();if(!ze){le.offsetIndex=-1;continue}ct=(ze>>1)-(Xe-me),le.offsetIndex=ct,Rt=Math.max(Rt,ct+le.end-le.start+1)}const at=[];for(Ne=0;Ne<Rt;Ne++)at.push(K.getUint16());for(me=0;me<Xe;me++){le=rt[me],ce=le.start;const ze=le.end,Ht=le.delta;for(ct=le.offsetIndex,Ne=ce;Ne<=ze;Ne++)Ne!==65535&&(Qe=ct<0?Ne:at[ct+Ne-ce],Qe=Qe+Ht&65535,Me.push({charCode:Ne,glyphId:Qe}))}}else if(qe===6){K.skip(4);const Xe=K.getUint16(),rt=K.getUint16();for(Ne=0;Ne<rt;Ne++){Qe=K.getUint16();const me=Xe+Ne;Me.push({charCode:me,glyphId:Qe})}}else if(qe===12){K.skip(10);const Xe=K.getInt32()>>>0;for(Ne=0;Ne<Xe;Ne++){const rt=K.getInt32()>>>0,me=K.getInt32()>>>0;let Rt=K.getInt32()>>>0;for(let ct=rt;ct<=me;ct++)Me.push({charCode:ct,glyphId:Rt++})}}else return ae("cmap table has unsupported format: "+qe),{platformId:-1,encodingId:-1,mappings:[],hasShortCmap:!1};Me.sort((Xe,rt)=>Xe.charCode-rt.charCode);const gt=[],mt=new Set;for(const Xe of Me){const{charCode:rt}=Xe;mt.has(rt)||(mt.add(rt),gt.push(Xe))}return{platformId:X.platformId,encodingId:X.encodingId,mappings:gt,hasShortCmap:He}}function u(N,K,oe,W,le,ce){if(!K){oe&&(oe.data=null);return}N.pos=(N.start||0)+K.offset,N.pos+=4,N.pos+=2,N.pos+=2,N.pos+=2,N.pos+=2,N.pos+=2,N.pos+=2,N.pos+=2,N.pos+=2,N.pos+=2;const Ce=N.getUint16();N.pos+=8,N.pos+=2;let X=N.getUint16();Ce!==0&&(au(W.data[44],W.data[45])&2||(K.data[22]=0,K.data[23]=0)),X>le&&(gn(`The numOfMetrics (${X}) should not be greater than the numGlyphs (${le}).`),X=le,K.data[34]=(X&65280)>>8,K.data[35]=X&255);const qe=le-X-(oe.length-X*4>>1);if(qe>0){const He=new Uint8Array(oe.length+qe*2);He.set(oe.data),ce&&(He[oe.length]=oe.data[2],He[oe.length+1]=oe.data[3]),oe.data=He}}function d(N,K,oe,W,le,ce){const Ce={length:0,sizeOfInstructions:0};if(K<0||K>=N.length||oe>N.length||oe-K<=12)return Ce;const X=N.subarray(K,oe),Ke=ka(X[2],X[3]),qe=ka(X[4],X[5]),He=ka(X[6],X[7]),Me=ka(X[8],X[9]);Ke>He&&(Fm(X,2,He),Fm(X,6,Ke)),qe>Me&&(Fm(X,4,Me),Fm(X,8,qe));const Ne=ka(X[0],X[1]);if(Ne<0)return Ne<-1||(W.set(X,le),Ce.length=X.length),Ce;let Qe,gt=10,mt=0;for(Qe=0;Qe<Ne;Qe++)mt=(X[gt]<<8|X[gt+1])+1,gt+=2;const Xe=gt,rt=X[gt]<<8|X[gt+1];Ce.sizeOfInstructions=rt,gt+=2+rt;const me=gt;let Rt=0;for(Qe=0;Qe<mt;Qe++){const at=X[gt++];at&192&&(X[gt-1]=at&63);let ze=2;at&2?ze=1:at&16&&(ze=0);let Ht=2;at&4?Ht=1:at&32&&(Ht=0);const on=ze+Ht;if(Rt+=on,at&8){const Re=X[gt++];Re===0&&(X[gt-1]^=8),Qe+=Re,Rt+=Re*on}}if(Rt===0)return Ce;let ct=gt+Rt;return ct>X.length?Ce:!ce&&rt>0?(W.set(X.subarray(0,Xe),le),W.set([0,0],le+Xe),W.set(X.subarray(me,ct),le+Xe+2),ct-=rt,X.length-ct>3&&(ct=ct+3&-4),Ce.length=ct,Ce):X.length-ct>3?(ct=ct+3&-4,W.set(X.subarray(0,ct),le),Ce.length=ct,Ce):(W.set(X,le),Ce.length=X.length,Ce)}function f(N,K,oe){const W=N.data,le=xj(W[0],W[1],W[2],W[3]);le>>16!==1&&(gn("Attempting to fix invalid version in head table: "+le),W[0]=0,W[1]=1,W[2]=0,W[3]=0);const ce=au(W[50],W[51]);if(ce<0||ce>1){gn("Attempting to fix invalid indexToLocFormat in head table: "+ce);const Ce=K+1;if(oe===Ce<<1)W[50]=0,W[51]=0;else if(oe===Ce<<2)W[50]=0,W[51]=1;else throw new Te("Could not fix indexToLocFormat: "+ce)}}function g(N,K,oe,W,le,ce,Ce){let X,Ke,qe;W?(X=4,Ke=function(Ht,on){return Ht[on]<<24|Ht[on+1]<<16|Ht[on+2]<<8|Ht[on+3]},qe=function(Ht,on,Re){Ht[on]=Re>>>24&255,Ht[on+1]=Re>>16&255,Ht[on+2]=Re>>8&255,Ht[on+3]=Re&255}):(X=2,Ke=function(Ht,on){return Ht[on]<<9|Ht[on+1]<<1},qe=function(Ht,on,Re){Ht[on]=Re>>9&255,Ht[on+1]=Re>>1&255});const He=ce?oe+1:oe,Me=X*(1+He),Ne=new Uint8Array(Me);Ne.set(N.data.subarray(0,Me)),N.data=Ne;const Qe=K.data,gt=Qe.length,mt=new Uint8Array(gt);let Xe,rt;const me=[];for(Xe=0,rt=0;Xe<oe+1;Xe++,rt+=X){let ze=Ke(Ne,rt);ze>gt&&(ze=gt),me.push({index:Xe,offset:ze,endOffset:0})}for(me.sort((ze,Ht)=>ze.offset-Ht.offset),Xe=0;Xe<oe;Xe++)me[Xe].endOffset=me[Xe+1].offset;for(me.sort((ze,Ht)=>ze.index-Ht.index),Xe=0;Xe<oe;Xe++){const{offset:ze,endOffset:Ht}=me[Xe];if(ze!==0||Ht!==0)break;const on=me[Xe+1].offset;if(on!==0){me[Xe].endOffset=on;break}}const Rt=me.at(-2);Rt.offset!==0&&Rt.endOffset===0&&(Rt.endOffset=gt);const ct=Object.create(null);let at=0;for(qe(Ne,0,at),Xe=0,rt=X;Xe<oe;Xe++,rt+=X){const ze=d(Qe,me[Xe].offset,me[Xe].endOffset,mt,at,le),Ht=ze.length;Ht===0&&(ct[Xe]=!0),ze.sizeOfInstructions>Ce&&(Ce=ze.sizeOfInstructions),at+=Ht,qe(Ne,rt,at)}if(at===0){const ze=new Uint8Array([0,1,0,0,0,0,0,0,0,0,0,0,0,0,49,0]);for(Xe=0,rt=X;Xe<He;Xe++,rt+=X)qe(Ne,rt,ze.length);K.data=ze}else if(ce){const ze=Ke(Ne,X);mt.length>ze+at?K.data=mt.subarray(0,ze+at):(K.data=new Uint8Array(ze+at),K.data.set(mt.subarray(0,at))),K.data.set(mt.subarray(0,ze),at),qe(N.data,Ne.length-X,at+ze)}else K.data=mt.subarray(0,at);return{missingGlyphs:ct,maxSizeOfInstructions:Ce}}function m(N,K,oe){const W=(t.start||0)+N.offset;t.pos=W;const le=N.length,ce=W+le,Ce=t.getInt32();t.skip(28);let X,Ke=!0,qe;switch(Ce){case 65536:X=bk;break;case 131072:const He=t.getUint16();if(He!==oe){Ke=!1;break}const Me=[];for(qe=0;qe<He;++qe){const gt=t.getUint16();if(gt>=32768){Ke=!1;break}Me.push(gt)}if(!Ke)break;const Ne=[],Qe=[];for(;t.pos<ce;){const gt=t.getByte();for(Qe.length=gt,qe=0;qe<gt;++qe)Qe[qe]=String.fromCharCode(t.getByte());Ne.push(Qe.join(""))}for(X=[],qe=0;qe<He;++qe){const gt=Me[qe];if(gt<258){X.push(bk[gt]);continue}X.push(Ne[gt-258])}break;case 196608:break;default:ae("Unknown/unsupported post table version "+Ce),Ke=!1,K.defaultEncoding&&(X=K.defaultEncoding);break}return K.glyphNames=X,Ke}function b(N){const K=(t.start||0)+N.offset;t.pos=K;const oe=[[],[]],W=[],le=N.length,ce=K+le;if(t.getUint16()!==0||le<6)return[oe,W];const Ke=t.getUint16(),qe=t.getUint16(),He=12;let Me,Ne;for(Me=0;Me<Ke&&t.pos+He<=ce;Me++){const Qe={platform:t.getUint16(),encoding:t.getUint16(),language:t.getUint16(),name:t.getUint16(),length:t.getUint16(),offset:t.getUint16()};(Cj(Qe)||rM(Qe))&&W.push(Qe)}for(Me=0,Ne=W.length;Me<Ne;Me++){const Qe=W[Me];if(Qe.length<=0)continue;const gt=K+qe+Qe.offset;if(gt+Qe.length>ce)continue;t.pos=gt;const mt=Qe.name;if(Qe.encoding){let Xe="";for(let rt=0,me=Qe.length;rt<me;rt+=2)Xe+=String.fromCharCode(t.getUint16());oe[1][mt]=Xe}else oe[0][mt]=t.getString(Qe.length)}return[oe,W]}const p=[0,0,0,0,0,0,0,0,-2,-2,-2,-2,0,0,-2,-5,-1,-1,-1,-1,-1,-1,-1,-1,0,0,-1,0,-1,-1,-1,-1,1,-1,-999,0,1,0,-1,-2,0,-1,-2,-1,-1,0,-1,-1,0,0,-999,-999,-1,-1,-1,-1,-2,-999,-2,-2,-999,0,-2,-2,0,0,-2,0,-2,0,0,0,-2,-1,-1,1,1,0,0,-1,-1,-1,-1,-1,-1,-1,0,0,-1,0,-1,-1,0,-999,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,0,0,0,0,0,0,-2,-999,-999,-999,-999,-999,-1,-1,-2,-2,0,0,0,0,-1,-1,-999,-2,-2,0,0,-1,-2,-2,0,0,0,-1,-1,-1,-2];function y(N,K){let oe=N.data,W=0,le,ce,Ce,X,Ke,qe=0,He=0;const Me=[],Ne=[],Qe=[];let gt=K.tooComplexToFollowFunctions,mt=!1,Xe=0,rt=0;for(let Rt=oe.length;W<Rt;){const ct=oe[W++];if(ct===64)if(ce=oe[W++],mt||rt)W+=ce;else for(le=0;le<ce;le++)Me.push(oe[W++]);else if(ct===65)if(ce=oe[W++],mt||rt)W+=ce*2;else for(le=0;le<ce;le++)Ce=oe[W++],Me.push(Ce<<8|oe[W++]);else if((ct&248)===176)if(ce=ct-176+1,mt||rt)W+=ce;else for(le=0;le<ce;le++)Me.push(oe[W++]);else if((ct&248)===184)if(ce=ct-184+1,mt||rt)W+=ce*2;else for(le=0;le<ce;le++)Ce=oe[W++],Me.push(ka(Ce,oe[W++]));else if(ct===43&&!gt){if(!mt&&!rt){if(X=Me.at(-1),isNaN(X))gn("TT: CALL empty stack (or invalid entry).");else if(K.functionsUsed[X]=!0,X in K.functionsStackDeltas){const at=Me.length+K.functionsStackDeltas[X];if(at<0){ae("TT: CALL invalid functions stack delta."),K.hintsValid=!1;return}Me.length=at}else if(X in K.functionsDefined&&!Qe.includes(X)){if(Ne.push({data:oe,i:W,stackTop:Me.length-1}),Qe.push(X),Ke=K.functionsDefined[X],!Ke){ae("TT: CALL non-existent function"),K.hintsValid=!1;return}oe=Ke.data,W=Ke.i}}}else if(ct===44&&!gt)(mt||rt)&&(ae("TT: nested FDEFs not allowed"),gt=!0),mt=!0,He=W,X=Me.pop(),K.functionsDefined[X]={data:oe,i:W};else if(ct===45)if(mt)mt=!1,qe=W;else{if(Ke=Ne.pop(),!Ke){ae("TT: ENDF bad stack"),K.hintsValid=!1;return}X=Qe.pop(),oe=Ke.data,W=Ke.i,K.functionsStackDeltas[X]=Me.length-Ke.stackTop}else if(ct===137)(mt||rt)&&(ae("TT: nested IDEFs not allowed"),gt=!0),mt=!0,He=W;else if(ct===88)++Xe;else if(ct===27)rt=Xe;else if(ct===89)rt===Xe&&(rt=0),--Xe;else if(ct===28&&!mt&&!rt){const at=Me.at(-1);at>0&&(W+=at-1)}if(!mt&&!rt){let at=0;for(ct<=142?at=p[ct]:ct>=192&&ct<=223?at=-1:ct>=224&&(at=-2),ct>=113&&ct<=117&&(ce=Me.pop(),isNaN(ce)||(at=-ce*2));at<0&&Me.length>0;)Me.pop(),at++;for(;at>0;)Me.push(NaN),at--}}K.tooComplexToFollowFunctions=gt;const me=[oe];W>oe.length&&me.push(new Uint8Array(W-oe.length)),He>qe&&(ae("TT: complementing a missing function tail"),me.push(new Uint8Array([34,45]))),_(N,me)}function w(N,K){if(!N.tooComplexToFollowFunctions){if(N.functionsDefined.length>K){ae("TT: more functions defined than expected"),N.hintsValid=!1;return}for(let oe=0,W=N.functionsUsed.length;oe<W;oe++){if(oe>K){ae("TT: invalid function id: "+oe),N.hintsValid=!1;return}if(N.functionsUsed[oe]&&!N.functionsDefined[oe]){ae("TT: undefined function: "+oe),N.hintsValid=!1;return}}}}function _(N,K){if(K.length>1){let oe=0,W,le;for(W=0,le=K.length;W<le;W++)oe+=K[W].length;oe=oe+3&-4;const ce=new Uint8Array(oe);let Ce=0;for(W=0,le=K.length;W<le;W++)ce.set(K[W],Ce),Ce+=K[W].length;N.data=ce,N.length=oe}}function v(N,K,oe,W){const le={functionsDefined:[],functionsUsed:[],functionsStackDeltas:[],tooComplexToFollowFunctions:!1,hintsValid:!0};if(N&&y(N,le),K&&y(K,le),N&&w(le,W),oe&&oe.length&1){const ce=new Uint8Array(oe.length+1);ce.set(oe.data),oe.data=ce}return le.hintsValid}t=new ji(new Uint8Array(t.getBytes()));let C,k;if(sM(t)){const N=c(t,this.name);C=N.header,k=N.tables}else C=o(t),k=r(t,C.numTables);let I,E;const T=!k["CFF "];if(T){if(!k.loca)throw new Te('Required "loca" table is not found');k.glyf||(ae('Required "glyf" table is not found -- trying to recover.'),k.glyf={tag:"glyf",data:new Uint8Array(0)}),this.isOpenType=!1}else{const N=i.composite&&(((he=i.cidToGidMap)==null?void 0:he.length)>0||!(i.cMap instanceof c1));if(C.version==="OTTO"&&!N||!k.head||!k.hhea||!k.maxp||!k.post)return E=new ji(k["CFF "].data),I=new Ew(E,i),this.convert(e,I,i);delete k.glyf,delete k.loca,delete k.fpgm,delete k.prep,delete k["cvt "],this.isOpenType=!0}if(!k.maxp)throw new Te('Required "maxp" table is not found');t.pos=(t.start||0)+k.maxp.offset;let M=t.getInt32();const D=t.getUint16();if(M!==65536&&M!==20480){if(k.maxp.length===6)M=20480;else if(k.maxp.length>=32)M=65536;else throw new Te('"maxp" table has a wrong version number');bj(k.maxp.data,0,M)}if(((de=i.scaleFactors)==null?void 0:de.length)===D&&T){const{scaleFactors:N}=i,K=au(k.head.data[50],k.head.data[51]),oe=new ij({glyfTable:k.glyf.data,isGlyphLocationsLong:K,locaTable:k.loca.data,numGlyphs:D});oe.scale(N);const{glyf:W,loca:le,isLocationLong:ce}=oe.write();k.glyf.data=W,k.loca.data=le,ce!==!!K&&(k.head.data[50]=0,k.head.data[51]=ce?1:0);const Ce=k.hmtx.data;for(let X=0;X<D;X++){const Ke=4*X,qe=Math.round(N[X]*au(Ce[Ke],Ce[Ke+1]));Ce[Ke]=qe>>8&255,Ce[Ke+1]=qe&255;const He=Math.round(N[X]*ka(Ce[Ke+2],Ce[Ke+3]));Fm(Ce,Ke+2,He)}}let H=D+1,R=!0;H>65535&&(R=!1,H=D,ae("Not enough space in glyfs to duplicate first glyph."));let z=0,P=0;M>=65536&&k.maxp.length>=32&&(t.pos+=8,t.getUint16()>2&&(k.maxp.data[14]=0,k.maxp.data[15]=2),t.pos+=4,z=t.getUint16(),t.pos+=4,P=t.getUint16()),k.maxp.data[4]=H>>8,k.maxp.data[5]=H&255;const B=v(k.fpgm,k.prep,k["cvt "],z);if(B||(delete k.fpgm,delete k.prep,delete k["cvt "]),u(t,k.hhea,k.hmtx,k.head,H,R),!k.head)throw new Te('Required "head" table is not found');f(k.head,D,T?k.loca.length:0);let Z=Object.create(null);if(T){const N=au(k.head.data[50],k.head.data[51]),K=g(k.loca,k.glyf,D,N,B,R,P);Z=K.missingGlyphs,M>=65536&&k.maxp.length>=32&&(k.maxp.data[26]=K.maxSizeOfInstructions>>8,k.maxp.data[27]=K.maxSizeOfInstructions&255)}if(!k.hhea)throw new Te('Required "hhea" table is not found');k.hhea.data[10]===0&&k.hhea.data[11]===0&&(k.hhea.data[10]=255,k.hhea.data[11]=255);const G={unitsPerEm:au(k.head.data[18],k.head.data[19]),yMax:ka(k.head.data[42],k.head.data[43]),yMin:ka(k.head.data[38],k.head.data[39]),ascent:ka(k.hhea.data[4],k.hhea.data[5]),descent:ka(k.hhea.data[6],k.hhea.data[7]),lineGap:ka(k.hhea.data[8],k.hhea.data[9])};this.ascent=G.ascent/G.unitsPerEm,this.descent=G.descent/G.unitsPerEm,this.lineGap=G.lineGap/G.unitsPerEm,(ge=this.cssFontInfo)!=null&&ge.lineHeight?(this.lineHeight=this.cssFontInfo.metrics.lineHeight,this.lineGap=this.cssFontInfo.metrics.lineGap):this.lineHeight=this.ascent-this.descent+this.lineGap,k.post&&m(k.post,i,D),k.post={tag:"post",data:Bk(i)};const Y=Object.create(null);function J(N){return!Z[N]}if(i.composite){const N=i.cidToGidMap||[],K=N.length===0;i.cMap.forEach(function(oe,W){if(typeof W=="string"&&(W=Pw(oe,W,!0)),W>65535)throw new Te("Max size of CID is 65,535");let le=-1;K?le=W:N[W]!==void 0&&(le=N[W]),le>=0&&le<D&&J(le)&&(Y[oe]=le)})}else{const N=h(k.cmap,t,this.isSymbolicFont,i.hasEncoding),K=N.platformId,oe=N.encodingId,W=N.mappings;let le=[],ce=!1;if(i.hasEncoding&&(i.baseEncodingName==="MacRomanEncoding"||i.baseEncodingName==="WinAnsiEncoding")&&(le=Yp(i.baseEncodingName)),i.hasEncoding&&!this.isSymbolicFont&&(K===3&&oe===1||K===1&&oe===0)){const Ce=$l();for(let X=0;X<256;X++){let Ke;if(this.differences[X]!==void 0?Ke=this.differences[X]:le.length&&le[X]!==""?Ke=le[X]:Ke=f0[X],!Ke)continue;const qe=JR(Ke,Ce);let He;if(K===3&&oe===1?He=Ce[qe]:K===1&&oe===0&&(He=M4.indexOf(qe)),He===void 0){if(!i.glyphNames&&i.hasIncludedToUnicodeMap&&!(this.toUnicode instanceof yo)){const Me=this.toUnicode.get(X);Me&&(He=Me.codePointAt(0))}if(He===void 0)continue}for(const Me of W)if(Me.charCode===He){Y[X]=Me.glyphId;break}}}else if(K===0){for(const Ce of W)Y[Ce.charCode]=Ce.glyphId;ce=!0}else if(K===3&&oe===0)for(const Ce of W){let X=Ce.charCode;X>=61440&&X<=61695&&(X&=255),Y[X]=Ce.glyphId}else for(const Ce of W)Y[Ce.charCode]=Ce.glyphId;if(i.glyphNames&&(le.length||this.differences.length))for(let Ce=0;Ce<256;++Ce){if(!ce&&Y[Ce]!==void 0)continue;const X=this.differences[Ce]||le[Ce];if(!X)continue;const Ke=i.glyphNames.indexOf(X);Ke>0&&J(Ke)&&(Y[Ce]=Ke)}}Y.length===0&&(Y[0]=0);let se=H-1;if(R||(se=0),!i.cssFontInfo){const N=Dk(Y,J,se,this.toUnicode);this.toFontChar=N.toFontChar,k.cmap={tag:"cmap",data:Fk(N.charCodeToGlyphId,N.toUnicodeExtraMap,H)},(!k["OS/2"]||!Sj(k["OS/2"],t))&&(k["OS/2"]={tag:"OS/2",data:Lk(i,N.charCodeToGlyphId,G)})}if(!T)try{E=new ji(k["CFF "].data),I=new O4(E,i,h1).parse(),I.duplicateFirstGlyph();const K=new wx(I);k["CFF "].data=K.compile()}catch{ae("Failed to compile font "+i.loadedName)}if(!k.name)k.name={tag:"name",data:Nw(this.name)};else{const[N,K]=b(k.name);k.name.data=Nw(e,N),this.psName=N[0][6]||null,i.composite||gj(i,this.isSymbolicFont,K)}const fe=new $p(C.version);for(const N in k)fe.addTable(N,k[N].data);return fe.toArray()}convert(e,t,i){i.fixedPitch=!1,i.builtInEncoding&&mj(i,i.builtInEncoding);let s=1;t instanceof Ew&&(s=t.numGlyphs-1);const r=t.getGlyphMapping(i);let a=null,o=r,l=null;i.cssFontInfo||(a=Dk(r,t.hasGlyphId.bind(t),s,this.toUnicode),this.toFontChar=a.toFontChar,o=a.charCodeToGlyphId,l=a.toUnicodeExtraMap);const c=t.numGlyphs;function h(m,b){let p=null;for(const y in m)b===m[y]&&(p||(p=[])).push(y|0);return p}function u(m,b){for(const p in m)if(b===m[p])return p|0;return a.charCodeToGlyphId[a.nextAvailableFontCharCode]=b,a.nextAvailableFontCharCode++}const d=t.seacs;if(a&&h1&&(d!=null&&d.length)){const m=i.fontMatrix||Vd,b=t.getCharset(),p=Object.create(null);for(let y in d){y|=0;const w=d[y],_=f0[w[2]],v=f0[w[3]],C=b.indexOf(_),k=b.indexOf(v);if(C<0||k<0)continue;const I={x:w[0]*m[0]+w[1]*m[2]+m[4],y:w[0]*m[1]+w[1]*m[3]+m[5]},E=h(r,y);if(E)for(const T of E){const M=a.charCodeToGlyphId,D=u(M,C),H=u(M,k);p[T]={baseFontCharCode:D,accentFontCharCode:H,accentOffset:I}}}i.seacMap=p}const f=i.fontMatrix?1/Math.max(...i.fontMatrix.slice(0,4).map(Math.abs)):1e3,g=new $p("OTTO");return g.addTable("CFF ",t.data),g.addTable("OS/2",Lk(i,o)),g.addTable("cmap",Fk(o,l,c)),g.addTable("head","\0\0\0\0\0\0\0\0\0\0_<õ\0\0"+ou(f)+"\0\0\0\0\v~'\0\0\0\0\v~'\0\0"+ou(i.descent)+"ÿ"+ou(i.ascent)+Gn(i.italicAngle?2:0)+"\0\0\0\0\0\0\0"),g.addTable("hhea","\0\0\0"+ou(i.ascent)+ou(i.descent)+"\0\0ÿÿ\0\0\0\0\0\0"+ou(i.capHeight)+ou(Math.tan(i.italicAngle)*i.xHeight)+"\0\0\0\0\0\0\0\0\0\0\0\0"+Gn(c)),g.addTable("hmtx",function(){const b=t.charstrings,p=t.cff?t.cff.widths:null;let y="\0\0\0\0";for(let w=1,_=c;w<_;w++){let v=0;if(b){const C=b[w-1];v="width"in C?C.width:0}else p&&(v=Math.ceil(p[w]||0));y+=Gn(v)+Gn(0)}return y}()),g.addTable("maxp","\0\0P\0"+Gn(c)),g.addTable("name",Nw(e)),g.addTable("post",Bk(i)),g.toArray()}get _spaceWidth(){const e=["space","minus","one","i","I"];let t;for(const i of e){if(i in this.widths){t=this.widths[i];break}const r=$l()[i];let a=0;if(this.composite&&this.cMap.contains(r)&&(a=this.cMap.lookup(r),typeof a=="string"&&(a=Pw(r,a))),!a&&this.toUnicode&&(a=this.toUnicode.charCodeOf(r)),a<=0&&(a=r),t=this.widths[a],t)break}return We(this,"_spaceWidth",t||this.defaultWidth)}_charToGlyph(e,t=!1){var f,g,m;let i=this._glyphCache[e];if((i==null?void 0:i.isSpace)===t)return i;let s,r,a,o=e;(f=this.cMap)!=null&&f.contains(e)&&(o=this.cMap.lookup(e),typeof o=="string"&&(o=Pw(e,o))),r=this.widths[o],typeof r!="number"&&(r=this.defaultWidth);const l=(g=this.vmetrics)==null?void 0:g[o];let c=this.toUnicode.get(e)||e;typeof c=="number"&&(c=String.fromCharCode(c));let h=this.toFontChar[e]!==void 0;if(s=this.toFontChar[e]||e,this.missingFile){const b=this.differences[e]||this.defaultEncoding[e];(b===".notdef"||b==="")&&this.type==="Type1"&&(s=32,b===""&&(r||(r=this._spaceWidth),c=String.fromCharCode(s))),s=kz(s)}this.isType3Font&&(a=s);let u=null;if((m=this.seacMap)!=null&&m[e]){h=!0;const b=this.seacMap[e];s=b.baseFontCharCode,u={fontChar:String.fromCodePoint(b.accentFontCharCode),offset:b.accentOffset}}let d="";if(typeof s=="number"&&(s<=1114111?d=String.fromCodePoint(s):ae(`charToGlyph - invalid fontCharCode: ${s}`)),this.missingFile&&this.vertical&&d.length===1){const b=Ez()[d.charCodeAt(0)];b&&(d=c=String.fromCharCode(b))}return i=new pj(e,d,c,u,r,l,a,t,h),this._glyphCache[e]=i}charsToGlyphs(e){let t=this._charsCache[e];if(t)return t;if(t=[],this.cMap){const i=Object.create(null),s=e.length;let r=0;for(;r<s;){this.cMap.readCharCode(e,r,i);const{charcode:a,length:o}=i;r+=o;const l=this._charToGlyph(a,o===1&&e.charCodeAt(r-1)===32);t.push(l)}}else for(let i=0,s=e.length;i<s;++i){const r=e.charCodeAt(i),a=this._charToGlyph(r,r===32);t.push(a)}return this._charsCache[e]=t}getCharPositions(e){const t=[];if(this.cMap){const i=Object.create(null);let s=0;for(;s<e.length;){this.cMap.readCharCode(e,s,i);const r=i.length;t.push([s,s+r]),s+=r}}else for(let i=0,s=e.length;i<s;++i)t.push([i,i+1]);return t}get glyphCacheValues(){return Object.values(this._glyphCache)}encodeString(e){const t=[],i=[],s=()=>t.length%2===1,r=this.toUnicode instanceof yo?a=>this.toUnicode.charCodeOf(a):a=>this.toUnicode.charCodeOf(String.fromCodePoint(a));for(let a=0,o=e.length;a<o;a++){const l=e.codePointAt(a);if(l>55295&&(l<57344||l>65533)&&a++,this.toUnicode){const c=r(l);if(c!==-1){s()&&(t.push(i.join("")),i.length=0);const h=this.cMap?this.cMap.getCharCodeLength(c):1;for(let u=h-1;u>=0;u--)i.push(String.fromCharCode(c>>8*u&255));continue}}s()||(t.push(i.join("")),i.length=0),i.push(String.fromCodePoint(l))}return t.push(i.join("")),t}}class Hk{constructor(e){this.error=e,this.loadedName="g_font_error",this.missingFile=!0}charsToGlyphs(){return[]}encodeString(e){return[e]}exportData(){return{error:this.error}}}const Xr={FUNCTION_BASED:1,AXIAL:2,RADIAL:3,FREE_FORM_MESH:4,LATTICE_FORM_MESH:5,COONS_PATCH_MESH:6,TENSOR_PATCH_MESH:7};class Ej{constructor(){Cn("Cannot initialize Pattern.")}static parseShading(e,t,i,s,r,a){const o=e instanceof dn?e.dict:e,l=o.get("ShadingType");try{switch(l){case Xr.AXIAL:case Xr.RADIAL:return new Tj(o,t,i,s,r,a);case Xr.FREE_FORM_MESH:case Xr.LATTICE_FORM_MESH:case Xr.COONS_PATCH_MESH:case Xr.TENSOR_PATCH_MESH:return new i6(e,t,i,s,r,a);default:throw new Te("Unsupported ShadingType: "+l)}}catch(c){if(c instanceof vi)throw c;return ae(c),new Nj}}}class u1{getIR(){Cn("Abstract method `getIR` called.")}}Ue(u1,"SMALL_NUMBER",1e-6);class Tj extends u1{constructor(e,t,i,s,r,a){super(),this.shadingType=e.get("ShadingType");let o=0;if(this.shadingType===Xr.AXIAL?o=4:this.shadingType===Xr.RADIAL&&(o=6),this.coordsArr=e.getArray("Coords"),!Yr(this.coordsArr,o))throw new Te("RadialAxialShading: Invalid /Coords array.");const l=Dn.parse({cs:e.getRaw("CS")||e.getRaw("ColorSpace"),xref:t,resources:i,pdfFunctionFactory:s,globalColorSpaceCache:r,localColorSpaceCache:a});this.bbox=A0(e.getArray("BBox"),null);let c=0,h=1;const u=e.getArray("Domain");Yr(u,2)&&([c,h]=u);let d=!1,f=!1;const g=e.getArray("Extend");if(BU(g,2)&&([d,f]=g),this.shadingType===Xr.RADIAL&&(!d||!f)){const[se,fe,he,de,ge,N]=this.coordsArr,K=Math.hypot(se-de,fe-ge);he<=N+K&&N<=he+K&&ae("Unsupported radial gradient.")}this.extendStart=d,this.extendEnd=f;const m=e.getRaw("Function"),b=s.create(m,!0),p=840,y=(h-c)/p,w=this.colorStops=[];if(c>=h||y<=0){gn("Bad shading domain.");return}const _=new Float32Array(l.numComps),v=new Float32Array(1);let C=0;v[0]=c,b(v,0,_,0);const k=new Uint8ClampedArray(3);l.getRgb(_,0,k);let[I,E,T]=k;w.push([0,Ln.makeHexColor(I,E,T)]);let M=1;v[0]=c+y,b(v,0,_,0),l.getRgb(_,0,k);let[D,H,R]=k,z=D-I+1,P=H-E+1,B=R-T+1,Z=D-I-1,G=H-E-1,Y=R-T-1;for(let se=2;se<p;se++){v[0]=c+se*y,b(v,0,_,0),l.getRgb(_,0,k);const[fe,he,de]=k,ge=se-C;if(z=Math.min(z,(fe-I+1)/ge),P=Math.min(P,(he-E+1)/ge),B=Math.min(B,(de-T+1)/ge),Z=Math.max(Z,(fe-I-1)/ge),G=Math.max(G,(he-E-1)/ge),Y=Math.max(Y,(de-T-1)/ge),!(Z<=z&&G<=P&&Y<=B)){const K=Ln.makeHexColor(D,H,R);w.push([M/p,K]),z=fe-D+1,P=he-H+1,B=de-R+1,Z=fe-D-1,G=he-H-1,Y=de-R-1,C=M,I=D,E=H,T=R}M=se,D=fe,H=he,R=de}w.push([1,Ln.makeHexColor(D,H,R)]);let J="transparent";e.has("Background")&&(J=l.getRgbHex(e.get("Background"),0)),d||(w.unshift([0,J]),w[1][0]+=u1.SMALL_NUMBER),f||(w.at(-1)[0]-=u1.SMALL_NUMBER,w.push([1,J])),this.colorStops=w}getIR(){const{coordsArr:e,shadingType:t}=this;let i,s,r,a,o;return t===Xr.AXIAL?(s=[e[0],e[1]],r=[e[2],e[3]],a=null,o=null,i="axial"):t===Xr.RADIAL?(s=[e[0],e[1]],r=[e[3],e[4]],a=e[2],o=e[5],i="radial"):Cn(`getPattern type unknown: ${t}`),["RadialAxial",i,this.bbox,this.colorStops,s,r,a,o]}}class Rj{constructor(e,t){this.stream=e,this.context=t,this.buffer=0,this.bufferLength=0;const i=t.numComps;this.tmpCompsBuf=new Float32Array(i);const s=t.colorSpace.numComps;this.tmpCsCompsBuf=t.colorFn?new Float32Array(s):this.tmpCompsBuf}get hasData(){if(this.stream.end)return this.stream.pos<this.stream.end;if(this.bufferLength>0)return!0;const e=this.stream.getByte();return e<0?!1:(this.buffer=e,this.bufferLength=8,!0)}readBits(e){const{stream:t}=this;let{buffer:i,bufferLength:s}=this;if(e===32){if(s===0)return t.getInt32()>>>0;i=i<<24|t.getByte()<<16|t.getByte()<<8|t.getByte();const r=t.getByte();return this.buffer=r&(1<<s)-1,(i<<8-s|(r&255)>>s)>>>0}if(e===8&&s===0)return t.getByte();for(;s<e;)i=i<<8|t.getByte(),s+=8;return s-=e,this.bufferLength=s,this.buffer=i&(1<<s)-1,i>>s}align(){this.buffer=0,this.bufferLength=0}readFlag(){return this.readBits(this.context.bitsPerFlag)}readCoordinate(){const{bitsPerCoordinate:e,decode:t}=this.context,i=this.readBits(e),s=this.readBits(e),r=e<32?1/((1<<e)-1):23283064365386963e-26;return[i*r*(t[1]-t[0])+t[0],s*r*(t[3]-t[2])+t[2]]}readComponents(){const{bitsPerComponent:e,colorFn:t,colorSpace:i,decode:s,numComps:r}=this.context,a=e<32?1/((1<<e)-1):23283064365386963e-26,o=this.tmpCompsBuf;for(let c=0,h=4;c<r;c++,h+=2){const u=this.readBits(e);o[c]=u*a*(s[h+1]-s[h])+s[h]}const l=this.tmpCsCompsBuf;return t==null||t(o,0,l,0),i.getRgb(l,0)}}let u3=Object.create(null);function Mj(n){const e=[];for(let t=0;t<=n;t++){const i=t/n,s=1-i;e.push(new Float32Array([s**3,3*i*s**2,3*i**2*s,i**3]))}return e}function zk(n){return u3[n]||(u3[n]=Mj(n))}function Pj(){u3=Object.create(null)}const Do=class Do extends u1{constructor(e,t,i,s,r,a){if(super(),!(e instanceof dn))throw new Te("Mesh data is not a stream");const o=e.dict;this.shadingType=o.get("ShadingType"),this.bbox=A0(o.getArray("BBox"),null);const l=Dn.parse({cs:o.getRaw("CS")||o.getRaw("ColorSpace"),xref:t,resources:i,pdfFunctionFactory:s,globalColorSpaceCache:r,localColorSpaceCache:a});this.background=o.has("Background")?l.getRgb(o.get("Background"),0):null;const c=o.getRaw("Function"),h=c?s.create(c,!0):null;this.coords=[],this.colors=[],this.figures=[];const u={bitsPerCoordinate:o.get("BitsPerCoordinate"),bitsPerComponent:o.get("BitsPerComponent"),bitsPerFlag:o.get("BitsPerFlag"),decode:o.getArray("Decode"),colorFn:h,colorSpace:l,numComps:h?1:l.numComps},d=new Rj(e,u);let f=!1;switch(this.shadingType){case Xr.FREE_FORM_MESH:this._decodeType4Shading(d);break;case Xr.LATTICE_FORM_MESH:const g=o.get("VerticesPerRow")|0;if(g<2)throw new Te("Invalid VerticesPerRow");this._decodeType5Shading(d,g);break;case Xr.COONS_PATCH_MESH:this._decodeType6Shading(d),f=!0;break;case Xr.TENSOR_PATCH_MESH:this._decodeType7Shading(d),f=!0;break;default:Cn("Unsupported mesh type.");break}if(f){this._updateBounds();for(let g=0,m=this.figures.length;g<m;g++)this._buildFigureFromPatch(g)}this._updateBounds(),this._packData()}_decodeType4Shading(e){const t=this.coords,i=this.colors,s=[];let r=0;for(;e.hasData;){const a=e.readFlag(),o=e.readCoordinate(),l=e.readComponents();if(r===0){if(!(0<=a&&a<=2))throw new Te("Unknown type4 flag");switch(a){case 0:r=3;break;case 1:s.push(s.at(-2),s.at(-1)),r=1;break;case 2:s.push(s.at(-3),s.at(-1)),r=1;break}}s.push(t.length),t.push(o),i.push(l),r--,e.align()}this.figures.push({type:"triangles",coords:new Int32Array(s),colors:new Int32Array(s)})}_decodeType5Shading(e,t){const i=this.coords,s=this.colors,r=[];for(;e.hasData;){const a=e.readCoordinate(),o=e.readComponents();r.push(i.length),i.push(a),s.push(o)}this.figures.push({type:"lattice",coords:new Int32Array(r),colors:new Int32Array(r),verticesPerRow:t})}_decodeType6Shading(e){const t=this.coords,i=this.colors,s=new Int32Array(16),r=new Int32Array(4);for(;e.hasData;){const a=e.readFlag();if(!(0<=a&&a<=3))throw new Te("Unknown type6 flag");const o=t.length;for(let f=0,g=a!==0?8:12;f<g;f++)t.push(e.readCoordinate());const l=i.length;for(let f=0,g=a!==0?2:4;f<g;f++)i.push(e.readComponents());let c,h,u,d;switch(a){case 0:s[12]=o+3,s[13]=o+4,s[14]=o+5,s[15]=o+6,s[8]=o+2,s[11]=o+7,s[4]=o+1,s[7]=o+8,s[0]=o,s[1]=o+11,s[2]=o+10,s[3]=o+9,r[2]=l+1,r[3]=l+2,r[0]=l,r[1]=l+3;break;case 1:c=s[12],h=s[13],u=s[14],d=s[15],s[12]=d,s[13]=o+0,s[14]=o+1,s[15]=o+2,s[8]=u,s[11]=o+3,s[4]=h,s[7]=o+4,s[0]=c,s[1]=o+7,s[2]=o+6,s[3]=o+5,c=r[2],h=r[3],r[2]=h,r[3]=l,r[0]=c,r[1]=l+1;break;case 2:c=s[15],h=s[11],s[12]=s[3],s[13]=o+0,s[14]=o+1,s[15]=o+2,s[8]=s[7],s[11]=o+3,s[4]=h,s[7]=o+4,s[0]=c,s[1]=o+7,s[2]=o+6,s[3]=o+5,c=r[3],r[2]=r[1],r[3]=l,r[0]=c,r[1]=l+1;break;case 3:s[12]=s[0],s[13]=o+0,s[14]=o+1,s[15]=o+2,s[8]=s[1],s[11]=o+3,s[4]=s[2],s[7]=o+4,s[0]=s[3],s[1]=o+7,s[2]=o+6,s[3]=o+5,r[2]=r[0],r[3]=l,r[0]=r[1],r[1]=l+1;break}s[5]=t.length,t.push([(-4*t[s[0]][0]-t[s[15]][0]+6*(t[s[4]][0]+t[s[1]][0])-2*(t[s[12]][0]+t[s[3]][0])+3*(t[s[13]][0]+t[s[7]][0]))/9,(-4*t[s[0]][1]-t[s[15]][1]+6*(t[s[4]][1]+t[s[1]][1])-2*(t[s[12]][1]+t[s[3]][1])+3*(t[s[13]][1]+t[s[7]][1]))/9]),s[6]=t.length,t.push([(-4*t[s[3]][0]-t[s[12]][0]+6*(t[s[2]][0]+t[s[7]][0])-2*(t[s[0]][0]+t[s[15]][0])+3*(t[s[4]][0]+t[s[14]][0]))/9,(-4*t[s[3]][1]-t[s[12]][1]+6*(t[s[2]][1]+t[s[7]][1])-2*(t[s[0]][1]+t[s[15]][1])+3*(t[s[4]][1]+t[s[14]][1]))/9]),s[9]=t.length,t.push([(-4*t[s[12]][0]-t[s[3]][0]+6*(t[s[8]][0]+t[s[13]][0])-2*(t[s[0]][0]+t[s[15]][0])+3*(t[s[11]][0]+t[s[1]][0]))/9,(-4*t[s[12]][1]-t[s[3]][1]+6*(t[s[8]][1]+t[s[13]][1])-2*(t[s[0]][1]+t[s[15]][1])+3*(t[s[11]][1]+t[s[1]][1]))/9]),s[10]=t.length,t.push([(-4*t[s[15]][0]-t[s[0]][0]+6*(t[s[11]][0]+t[s[14]][0])-2*(t[s[12]][0]+t[s[3]][0])+3*(t[s[2]][0]+t[s[8]][0]))/9,(-4*t[s[15]][1]-t[s[0]][1]+6*(t[s[11]][1]+t[s[14]][1])-2*(t[s[12]][1]+t[s[3]][1])+3*(t[s[2]][1]+t[s[8]][1]))/9]),this.figures.push({type:"patch",coords:new Int32Array(s),colors:new Int32Array(r)})}}_decodeType7Shading(e){const t=this.coords,i=this.colors,s=new Int32Array(16),r=new Int32Array(4);for(;e.hasData;){const a=e.readFlag();if(!(0<=a&&a<=3))throw new Te("Unknown type7 flag");const o=t.length;for(let f=0,g=a!==0?12:16;f<g;f++)t.push(e.readCoordinate());const l=i.length;for(let f=0,g=a!==0?2:4;f<g;f++)i.push(e.readComponents());let c,h,u,d;switch(a){case 0:s[12]=o+3,s[13]=o+4,s[14]=o+5,s[15]=o+6,s[8]=o+2,s[9]=o+13,s[10]=o+14,s[11]=o+7,s[4]=o+1,s[5]=o+12,s[6]=o+15,s[7]=o+8,s[0]=o,s[1]=o+11,s[2]=o+10,s[3]=o+9,r[2]=l+1,r[3]=l+2,r[0]=l,r[1]=l+3;break;case 1:c=s[12],h=s[13],u=s[14],d=s[15],s[12]=d,s[13]=o+0,s[14]=o+1,s[15]=o+2,s[8]=u,s[9]=o+9,s[10]=o+10,s[11]=o+3,s[4]=h,s[5]=o+8,s[6]=o+11,s[7]=o+4,s[0]=c,s[1]=o+7,s[2]=o+6,s[3]=o+5,c=r[2],h=r[3],r[2]=h,r[3]=l,r[0]=c,r[1]=l+1;break;case 2:c=s[15],h=s[11],s[12]=s[3],s[13]=o+0,s[14]=o+1,s[15]=o+2,s[8]=s[7],s[9]=o+9,s[10]=o+10,s[11]=o+3,s[4]=h,s[5]=o+8,s[6]=o+11,s[7]=o+4,s[0]=c,s[1]=o+7,s[2]=o+6,s[3]=o+5,c=r[3],r[2]=r[1],r[3]=l,r[0]=c,r[1]=l+1;break;case 3:s[12]=s[0],s[13]=o+0,s[14]=o+1,s[15]=o+2,s[8]=s[1],s[9]=o+9,s[10]=o+10,s[11]=o+3,s[4]=s[2],s[5]=o+8,s[6]=o+11,s[7]=o+4,s[0]=s[3],s[1]=o+7,s[2]=o+6,s[3]=o+5,r[2]=r[0],r[3]=l,r[0]=r[1],r[1]=l+1;break}this.figures.push({type:"patch",coords:new Int32Array(s),colors:new Int32Array(r)})}}_buildFigureFromPatch(e){const t=this.figures[e];qs(t.type==="patch","Unexpected patch mesh figure");const i=this.coords,s=this.colors,r=t.coords,a=t.colors,o=Math.min(i[r[0]][0],i[r[3]][0],i[r[12]][0],i[r[15]][0]),l=Math.min(i[r[0]][1],i[r[3]][1],i[r[12]][1],i[r[15]][1]),c=Math.max(i[r[0]][0],i[r[3]][0],i[r[12]][0],i[r[15]][0]),h=Math.max(i[r[0]][1],i[r[3]][1],i[r[12]][1],i[r[15]][1]);let u=Math.ceil((c-o)*Do.TRIANGLE_DENSITY/(this.bounds[2]-this.bounds[0]));u=Ws(u,Do.MIN_SPLIT_PATCH_CHUNKS_AMOUNT,Do.MAX_SPLIT_PATCH_CHUNKS_AMOUNT);let d=Math.ceil((h-l)*Do.TRIANGLE_DENSITY/(this.bounds[3]-this.bounds[1]));d=Ws(d,Do.MIN_SPLIT_PATCH_CHUNKS_AMOUNT,Do.MAX_SPLIT_PATCH_CHUNKS_AMOUNT);const f=u+1,g=new Int32Array((d+1)*f),m=new Int32Array((d+1)*f);let b=0;const p=new Uint8Array(3),y=new Uint8Array(3),w=s[a[0]],_=s[a[1]],v=s[a[2]],C=s[a[3]],k=zk(d),I=zk(u);for(let E=0;E<=d;E++){p[0]=(w[0]*(d-E)+v[0]*E)/d|0,p[1]=(w[1]*(d-E)+v[1]*E)/d|0,p[2]=(w[2]*(d-E)+v[2]*E)/d|0,y[0]=(_[0]*(d-E)+C[0]*E)/d|0,y[1]=(_[1]*(d-E)+C[1]*E)/d|0,y[2]=(_[2]*(d-E)+C[2]*E)/d|0;for(let T=0;T<=u;T++,b++){if((E===0||E===d)&&(T===0||T===u))continue;let M=0,D=0,H=0;for(let z=0;z<=3;z++)for(let P=0;P<=3;P++,H++){const B=k[E][z]*I[T][P];M+=i[r[H]][0]*B,D+=i[r[H]][1]*B}g[b]=i.length,i.push([M,D]),m[b]=s.length;const R=new Uint8Array(3);R[0]=(p[0]*(u-T)+y[0]*T)/u|0,R[1]=(p[1]*(u-T)+y[1]*T)/u|0,R[2]=(p[2]*(u-T)+y[2]*T)/u|0,s.push(R)}}g[0]=r[0],m[0]=a[0],g[u]=r[3],m[u]=a[1],g[f*d]=r[12],m[f*d]=a[2],g[f*d+u]=r[15],m[f*d+u]=a[3],this.figures[e]={type:"lattice",coords:g,colors:m,verticesPerRow:f}}_updateBounds(){let e=this.coords[0][0],t=this.coords[0][1],i=e,s=t;for(let r=1,a=this.coords.length;r<a;r++){const o=this.coords[r][0],l=this.coords[r][1];e=e>o?o:e,t=t>l?l:t,i=i<o?o:i,s=s<l?l:s}this.bounds=[e,t,i,s]}_packData(){let e,t,i,s;const r=this.coords,a=new Float32Array(r.length*2);for(e=0,i=0,t=r.length;e<t;e++){const h=r[e];a[i++]=h[0],a[i++]=h[1]}this.coords=a;const o=this.colors,l=new Uint8Array(o.length*3);for(e=0,i=0,t=o.length;e<t;e++){const h=o[e];l[i++]=h[0],l[i++]=h[1],l[i++]=h[2]}this.colors=l;const c=this.figures;for(e=0,t=c.length;e<t;e++){const h=c[e],u=h.coords,d=h.colors;for(i=0,s=u.length;i<s;i++)u[i]*=2,d[i]*=3}}getIR(){const{bounds:e}=this;if(e[2]-e[0]===0||e[3]-e[1]===0)throw new Te(`Invalid MeshShading bounds: [${e}].`);return["Mesh",this.shadingType,this.coords,this.colors,this.figures,e,this.bbox,this.background]}};Ue(Do,"MIN_SPLIT_PATCH_CHUNKS_AMOUNT",3),Ue(Do,"MAX_SPLIT_PATCH_CHUNKS_AMOUNT",20),Ue(Do,"TRIANGLE_DENSITY",20);let i6=Do;class Nj extends u1{getIR(){return["Dummy"]}}function jk(n,e,t){const i=Dh(e.getArray("Matrix"),al),s=A0(e.getArray("BBox"),null);if(!s||s[2]-s[0]===0||s[3]-s[1]===0)throw new Te("Invalid getTilingPatternIR /BBox array.");const r=e.get("XStep");if(typeof r!="number")throw new Te("Invalid getTilingPatternIR /XStep value.");const a=e.get("YStep");if(typeof a!="number")throw new Te("Invalid getTilingPatternIR /YStep value.");const o=e.get("PaintType");if(!Number.isInteger(o))throw new Te("Invalid getTilingPatternIR /PaintType value.");const l=e.get("TilingType");if(!Number.isInteger(l))throw new Te("Invalid getTilingPatternIR /TilingType value.");return["TilingPattern",t,n,i,s,r,a,o,l]}const Oj=[1.3877,1,1,1,.97801,.92482,.89552,.91133,.81988,.97566,.98152,.93548,.93548,1.2798,.85284,.92794,1,.96134,1.54657,.91133,.91133,.91133,.91133,.91133,.91133,.91133,.91133,.91133,.91133,.82845,.82845,.85284,.85284,.85284,.75859,.92138,.83908,.7762,.73293,.87289,.73133,.7514,.81921,.87356,.95958,.59526,.75727,.69225,1.04924,.9121,.86943,.79795,.88198,.77958,.70864,.81055,.90399,.88653,.96017,.82577,.77892,.78257,.97507,1.54657,.97507,.85284,.89552,.90176,.88762,.8785,.75241,.8785,.90518,.95015,.77618,.8785,.88401,.91916,.86304,.88401,.91488,.8785,.8801,.8785,.8785,.91343,.7173,1.04106,.8785,.85075,.95794,.82616,.85162,.79492,.88331,1.69808,.88331,.85284,.97801,.89552,.91133,.89552,.91133,1.7801,.89552,1.24487,1.13254,1.12401,.96839,.85284,.68787,.70645,.85592,.90747,1.01466,1.0088,.90323,1,1.07463,1,.91056,.75806,1.19118,.96839,.78864,.82845,.84133,.75859,.83908,.83908,.83908,.83908,.83908,.83908,.77539,.73293,.73133,.73133,.73133,.73133,.95958,.95958,.95958,.95958,.88506,.9121,.86943,.86943,.86943,.86943,.86943,.85284,.87508,.90399,.90399,.90399,.90399,.77892,.79795,.90807,.88762,.88762,.88762,.88762,.88762,.88762,.8715,.75241,.90518,.90518,.90518,.90518,.88401,.88401,.88401,.88401,.8785,.8785,.8801,.8801,.8801,.8801,.8801,.90747,.89049,.8785,.8785,.8785,.8785,.85162,.8785,.85162,.83908,.88762,.83908,.88762,.83908,.88762,.73293,.75241,.73293,.75241,.73293,.75241,.73293,.75241,.87289,.83016,.88506,.93125,.73133,.90518,.73133,.90518,.73133,.90518,.73133,.90518,.73133,.90518,.81921,.77618,.81921,.77618,.81921,.77618,1,1,.87356,.8785,.91075,.89608,.95958,.88401,.95958,.88401,.95958,.88401,.95958,.88401,.95958,.88401,.76229,.90167,.59526,.91916,1,1,.86304,.69225,.88401,1,1,.70424,.79468,.91926,.88175,.70823,.94903,.9121,.8785,1,1,.9121,.8785,.87802,.88656,.8785,.86943,.8801,.86943,.8801,.86943,.8801,.87402,.89291,.77958,.91343,1,1,.77958,.91343,.70864,.7173,.70864,.7173,.70864,.7173,.70864,.7173,1,1,.81055,.75841,.81055,1.06452,.90399,.8785,.90399,.8785,.90399,.8785,.90399,.8785,.90399,.8785,.90399,.8785,.96017,.95794,.77892,.85162,.77892,.78257,.79492,.78257,.79492,.78257,.79492,.9297,.56892,.83908,.88762,.77539,.8715,.87508,.89049,1,1,.81055,1.04106,1.20528,1.20528,1,1.15543,.70674,.98387,.94721,1.33431,1.45894,.95161,1.06303,.83908,.80352,.57184,.6965,.56289,.82001,.56029,.81235,1.02988,.83908,.7762,.68156,.80367,.73133,.78257,.87356,.86943,.95958,.75727,.89019,1.04924,.9121,.7648,.86943,.87356,.79795,.78275,.81055,.77892,.9762,.82577,.99819,.84896,.95958,.77892,.96108,1.01407,.89049,1.02988,.94211,.96108,.8936,.84021,.87842,.96399,.79109,.89049,1.00813,1.02988,.86077,.87445,.92099,.84723,.86513,.8801,.75638,.85714,.78216,.79586,.87965,.94211,.97747,.78287,.97926,.84971,1.02988,.94211,.8801,.94211,.84971,.73133,1,1,1,1,1,1,1,1,1,1,1,1,.90264,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,.90518,1,1,1,1,1,1,1,1,1,1,1,1,.90548,1,1,1,1,1,1,.96017,.95794,.96017,.95794,.96017,.95794,.77892,.85162,1,1,.89552,.90527,1,.90363,.92794,.92794,.92794,.92794,.87012,.87012,.87012,.89552,.89552,1.42259,.71143,1.06152,1,1,1.03372,1.03372,.97171,1.4956,2.2807,.93835,.83406,.91133,.84107,.91133,1,1,1,.72021,1,1.23108,.83489,.88525,.88525,.81499,.90527,1.81055,.90527,1.81055,1.31006,1.53711,.94434,1.08696,1,.95018,.77192,.85284,.90747,1.17534,.69825,.9716,1.37077,.90747,.90747,.85356,.90747,.90747,1.44947,.85284,.8941,.8941,.70572,.8,.70572,.70572,.70572,.70572,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,.99862,.99862,1,1,1,1,1,1.08004,.91027,1,1,1,.99862,1,1,1,1,1,1,1,1,1,1,1,1,.90727,.90727,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],Dj={lineHeight:1.2207,lineGap:.2207},Fj=[1.3877,1,1,1,.97801,.92482,.89552,.91133,.81988,.97566,.98152,.93548,.93548,1.2798,.85284,.92794,1,.96134,1.56239,.91133,.91133,.91133,.91133,.91133,.91133,.91133,.91133,.91133,.91133,.82845,.82845,.85284,.85284,.85284,.75859,.92138,.83908,.7762,.71805,.87289,.73133,.7514,.81921,.87356,.95958,.59526,.75727,.69225,1.04924,.90872,.85938,.79795,.87068,.77958,.69766,.81055,.90399,.88653,.96068,.82577,.77892,.78257,.97507,1.529,.97507,.85284,.89552,.90176,.94908,.86411,.74012,.86411,.88323,.95015,.86411,.86331,.88401,.91916,.86304,.88401,.9039,.86331,.86331,.86411,.86411,.90464,.70852,1.04106,.86331,.84372,.95794,.82616,.84548,.79492,.88331,1.69808,.88331,.85284,.97801,.89552,.91133,.89552,.91133,1.7801,.89552,1.24487,1.13254,1.19129,.96839,.85284,.68787,.70645,.85592,.90747,1.01466,1.0088,.90323,1,1.07463,1,.91056,.75806,1.19118,.96839,.78864,.82845,.84133,.75859,.83908,.83908,.83908,.83908,.83908,.83908,.77539,.71805,.73133,.73133,.73133,.73133,.95958,.95958,.95958,.95958,.88506,.90872,.85938,.85938,.85938,.85938,.85938,.85284,.87068,.90399,.90399,.90399,.90399,.77892,.79795,.90807,.94908,.94908,.94908,.94908,.94908,.94908,.85887,.74012,.88323,.88323,.88323,.88323,.88401,.88401,.88401,.88401,.8785,.86331,.86331,.86331,.86331,.86331,.86331,.90747,.89049,.86331,.86331,.86331,.86331,.84548,.86411,.84548,.83908,.94908,.83908,.94908,.83908,.94908,.71805,.74012,.71805,.74012,.71805,.74012,.71805,.74012,.87289,.79538,.88506,.92726,.73133,.88323,.73133,.88323,.73133,.88323,.73133,.88323,.73133,.88323,.81921,.86411,.81921,.86411,.81921,.86411,1,1,.87356,.86331,.91075,.8777,.95958,.88401,.95958,.88401,.95958,.88401,.95958,.88401,.95958,.88401,.76467,.90167,.59526,.91916,1,1,.86304,.69225,.88401,1,1,.70424,.77312,.91926,.88175,.70823,.94903,.90872,.86331,1,1,.90872,.86331,.86906,.88116,.86331,.85938,.86331,.85938,.86331,.85938,.86331,.87402,.86549,.77958,.90464,1,1,.77958,.90464,.69766,.70852,.69766,.70852,.69766,.70852,.69766,.70852,1,1,.81055,.75841,.81055,1.06452,.90399,.86331,.90399,.86331,.90399,.86331,.90399,.86331,.90399,.86331,.90399,.86331,.96068,.95794,.77892,.84548,.77892,.78257,.79492,.78257,.79492,.78257,.79492,.9297,.56892,.83908,.94908,.77539,.85887,.87068,.89049,1,1,.81055,1.04106,1.20528,1.20528,1,1.15543,.70088,.98387,.94721,1.33431,1.45894,.95161,1.48387,.83908,.80352,.57118,.6965,.56347,.79179,.55853,.80346,1.02988,.83908,.7762,.67174,.86036,.73133,.78257,.87356,.86441,.95958,.75727,.89019,1.04924,.90872,.74889,.85938,.87891,.79795,.7957,.81055,.77892,.97447,.82577,.97466,.87179,.95958,.77892,.94252,.95612,.8753,1.02988,.92733,.94252,.87411,.84021,.8728,.95612,.74081,.8753,1.02189,1.02988,.84814,.87445,.91822,.84723,.85668,.86331,.81344,.87581,.76422,.82046,.96057,.92733,.99375,.78022,.95452,.86015,1.02988,.92733,.86331,.92733,.86015,.73133,1,1,1,1,1,1,1,1,1,1,1,1,.90631,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,.88323,1,1,1,1,1,1,1,1,1,1,1,1,.85174,1,1,1,1,1,1,.96068,.95794,.96068,.95794,.96068,.95794,.77892,.84548,1,1,.89552,.90527,1,.90363,.92794,.92794,.92794,.89807,.87012,.87012,.87012,.89552,.89552,1.42259,.71094,1.06152,1,1,1.03372,1.03372,.97171,1.4956,2.2807,.92972,.83406,.91133,.83326,.91133,1,1,1,.72021,1,1.23108,.83489,.88525,.88525,.81499,.90616,1.81055,.90527,1.81055,1.3107,1.53711,.94434,1.08696,1,.95018,.77192,.85284,.90747,1.17534,.69825,.9716,1.37077,.90747,.90747,.85356,.90747,.90747,1.44947,.85284,.8941,.8941,.70572,.8,.70572,.70572,.70572,.70572,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,.99862,.99862,1,1,1,1,1,1.08004,.91027,1,1,1,.99862,1,1,1,1,1,1,1,1,1,1,1,1,.90727,.90727,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],Lj={lineHeight:1.2207,lineGap:.2207},Bj=[1.3877,1,1,1,1.17223,1.1293,.89552,.91133,.80395,1.02269,1.15601,.91056,.91056,1.2798,.85284,.89807,1,.90861,1.39543,.91133,.91133,.91133,.91133,.91133,.91133,.91133,.91133,.91133,.91133,.96309,.96309,.85284,.85284,.85284,.83319,.88071,.8675,.81552,.72346,.85193,.73206,.7522,.81105,.86275,.90685,.6377,.77892,.75593,1.02638,.89249,.84118,.77452,.85374,.75186,.67789,.79776,.88844,.85066,.94309,.77818,.7306,.76659,1.10369,1.38313,1.10369,1.06139,.89552,.8739,.9245,.9245,.83203,.9245,.85865,1.09842,.9245,.9245,1.03297,1.07692,.90918,1.03297,.94959,.9245,.92274,.9245,.9245,1.02933,.77832,1.20562,.9245,.8916,.98986,.86621,.89453,.79004,.94152,1.77256,.94152,.85284,.97801,.89552,.91133,.89552,.91133,1.91729,.89552,1.17889,1.13254,1.16359,.92098,.85284,.68787,.71353,.84737,.90747,1.0088,1.0044,.87683,1,1.09091,1,.92229,.739,1.15642,.92098,.76288,.80504,.80972,.75859,.8675,.8675,.8675,.8675,.8675,.8675,.76318,.72346,.73206,.73206,.73206,.73206,.90685,.90685,.90685,.90685,.86477,.89249,.84118,.84118,.84118,.84118,.84118,.85284,.84557,.88844,.88844,.88844,.88844,.7306,.77452,.86331,.9245,.9245,.9245,.9245,.9245,.9245,.84843,.83203,.85865,.85865,.85865,.85865,.82601,.82601,.82601,.82601,.94469,.9245,.92274,.92274,.92274,.92274,.92274,.90747,.86651,.9245,.9245,.9245,.9245,.89453,.9245,.89453,.8675,.9245,.8675,.9245,.8675,.9245,.72346,.83203,.72346,.83203,.72346,.83203,.72346,.83203,.85193,.8875,.86477,.99034,.73206,.85865,.73206,.85865,.73206,.85865,.73206,.85865,.73206,.85865,.81105,.9245,.81105,.9245,.81105,.9245,1,1,.86275,.9245,.90872,.93591,.90685,.82601,.90685,.82601,.90685,.82601,.90685,1.03297,.90685,.82601,.77896,1.05611,.6377,1.07692,1,1,.90918,.75593,1.03297,1,1,.76032,.9375,.98156,.93407,.77261,1.11429,.89249,.9245,1,1,.89249,.9245,.92534,.86698,.9245,.84118,.92274,.84118,.92274,.84118,.92274,.8667,.86291,.75186,1.02933,1,1,.75186,1.02933,.67789,.77832,.67789,.77832,.67789,.77832,.67789,.77832,1,1,.79776,.97655,.79776,1.23023,.88844,.9245,.88844,.9245,.88844,.9245,.88844,.9245,.88844,.9245,.88844,.9245,.94309,.98986,.7306,.89453,.7306,.76659,.79004,.76659,.79004,.76659,.79004,1.09231,.54873,.8675,.9245,.76318,.84843,.84557,.86651,1,1,.79776,1.20562,1.18622,1.18622,1,1.1437,.67009,.96334,.93695,1.35191,1.40909,.95161,1.48387,.8675,.90861,.6192,.7363,.64824,.82411,.56321,.85696,1.23516,.8675,.81552,.7286,.84134,.73206,.76659,.86275,.84369,.90685,.77892,.85871,1.02638,.89249,.75828,.84118,.85984,.77452,.76466,.79776,.7306,.90782,.77818,.903,.87291,.90685,.7306,.99058,1.03667,.94635,1.23516,.9849,.99058,.92393,.8916,.942,1.03667,.75026,.94635,1.0297,1.23516,.90918,.94048,.98217,.89746,.84153,.92274,.82507,.88832,.84438,.88178,1.03525,.9849,1.00225,.78086,.97248,.89404,1.23516,.9849,.92274,.9849,.89404,.73206,1,1,1,1,1,1,1,1,1,1,1,1,.89693,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,.85865,1,1,1,1,1,1,1,1,1,1,1,1,.90933,1,1,1,1,1,1,.94309,.98986,.94309,.98986,.94309,.98986,.7306,.89453,1,1,.89552,.90527,1,.90186,1.12308,1.12308,1.12308,1.12308,1.2566,1.2566,1.2566,.89552,.89552,1.42259,.68994,1.03809,1,1,1.0176,1.0176,1.11523,1.4956,2.01462,.97858,.82616,.91133,.83437,.91133,1,1,1,.70508,1,1.23108,.79801,.84426,.84426,.774,.90572,1.81055,.90749,1.81055,1.28809,1.55469,.94434,1.07806,1,.97094,.7589,.85284,.90747,1.19658,.69825,.97622,1.33512,.90747,.90747,.85284,.90747,.90747,1.44947,.85284,.8941,.8941,.70572,.8,.70572,.70572,.70572,.70572,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,.99862,.99862,1,1,1,1,1,1.0336,.91027,1,1,1,.99862,1,1,1,1,1,1,1,1,1,1,1,1,1.05859,1.05859,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],Uj={lineHeight:1.2207,lineGap:.2207},Hj=[1.3877,1,1,1,1.17223,1.1293,.89552,.91133,.80395,1.02269,1.15601,.91056,.91056,1.2798,.85284,.89807,1,.90861,1.39016,.91133,.91133,.91133,.91133,.91133,.91133,.91133,.91133,.91133,.91133,.96309,.96309,.85284,.85284,.85284,.83319,.88071,.8675,.81552,.73834,.85193,.73206,.7522,.81105,.86275,.90685,.6377,.77892,.75593,1.02638,.89385,.85122,.77452,.86503,.75186,.68887,.79776,.88844,.85066,.94258,.77818,.7306,.76659,1.10369,1.39016,1.10369,1.06139,.89552,.8739,.86128,.94469,.8457,.94469,.89464,1.09842,.84636,.94469,1.03297,1.07692,.90918,1.03297,.95897,.94469,.9482,.94469,.94469,1.04692,.78223,1.20562,.94469,.90332,.98986,.86621,.90527,.79004,.94152,1.77256,.94152,.85284,.97801,.89552,.91133,.89552,.91133,1.91729,.89552,1.17889,1.13254,1.08707,.92098,.85284,.68787,.71353,.84737,.90747,1.0088,1.0044,.87683,1,1.09091,1,.92229,.739,1.15642,.92098,.76288,.80504,.80972,.75859,.8675,.8675,.8675,.8675,.8675,.8675,.76318,.73834,.73206,.73206,.73206,.73206,.90685,.90685,.90685,.90685,.86477,.89385,.85122,.85122,.85122,.85122,.85122,.85284,.85311,.88844,.88844,.88844,.88844,.7306,.77452,.86331,.86128,.86128,.86128,.86128,.86128,.86128,.8693,.8457,.89464,.89464,.89464,.89464,.82601,.82601,.82601,.82601,.94469,.94469,.9482,.9482,.9482,.9482,.9482,.90747,.86651,.94469,.94469,.94469,.94469,.90527,.94469,.90527,.8675,.86128,.8675,.86128,.8675,.86128,.73834,.8457,.73834,.8457,.73834,.8457,.73834,.8457,.85193,.92454,.86477,.9921,.73206,.89464,.73206,.89464,.73206,.89464,.73206,.89464,.73206,.89464,.81105,.84636,.81105,.84636,.81105,.84636,1,1,.86275,.94469,.90872,.95786,.90685,.82601,.90685,.82601,.90685,.82601,.90685,1.03297,.90685,.82601,.77741,1.05611,.6377,1.07692,1,1,.90918,.75593,1.03297,1,1,.76032,.90452,.98156,1.11842,.77261,1.11429,.89385,.94469,1,1,.89385,.94469,.95877,.86901,.94469,.85122,.9482,.85122,.9482,.85122,.9482,.8667,.90016,.75186,1.04692,1,1,.75186,1.04692,.68887,.78223,.68887,.78223,.68887,.78223,.68887,.78223,1,1,.79776,.92188,.79776,1.23023,.88844,.94469,.88844,.94469,.88844,.94469,.88844,.94469,.88844,.94469,.88844,.94469,.94258,.98986,.7306,.90527,.7306,.76659,.79004,.76659,.79004,.76659,.79004,1.09231,.54873,.8675,.86128,.76318,.8693,.85311,.86651,1,1,.79776,1.20562,1.18622,1.18622,1,1.1437,.67742,.96334,.93695,1.35191,1.40909,.95161,1.48387,.86686,.90861,.62267,.74359,.65649,.85498,.56963,.88254,1.23516,.8675,.81552,.75443,.84503,.73206,.76659,.86275,.85122,.90685,.77892,.85746,1.02638,.89385,.75657,.85122,.86275,.77452,.74171,.79776,.7306,.95165,.77818,.89772,.88831,.90685,.7306,.98142,1.02191,.96576,1.23516,.99018,.98142,.9236,.89258,.94035,1.02191,.78848,.96576,.9561,1.23516,.90918,.92578,.95424,.89746,.83969,.9482,.80113,.89442,.85208,.86155,.98022,.99018,1.00452,.81209,.99247,.89181,1.23516,.99018,.9482,.99018,.89181,.73206,1,1,1,1,1,1,1,1,1,1,1,1,.88844,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,.89464,1,1,1,1,1,1,1,1,1,1,1,1,.96766,1,1,1,1,1,1,.94258,.98986,.94258,.98986,.94258,.98986,.7306,.90527,1,1,.89552,.90527,1,.90186,1.12308,1.12308,1.12308,1.12308,1.2566,1.2566,1.2566,.89552,.89552,1.42259,.69043,1.03809,1,1,1.0176,1.0176,1.11523,1.4956,2.01462,.99331,.82616,.91133,.84286,.91133,1,1,1,.70508,1,1.23108,.79801,.84426,.84426,.774,.90527,1.81055,.90527,1.81055,1.28809,1.55469,.94434,1.07806,1,.97094,.7589,.85284,.90747,1.19658,.69825,.97622,1.33512,.90747,.90747,.85356,.90747,.90747,1.44947,.85284,.8941,.8941,.70572,.8,.70572,.70572,.70572,.70572,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,.99862,.99862,1,1,1,1,1,1.0336,.91027,1,1,1,.99862,1,1,1,1,1,1,1,1,1,1,1,1,1.05859,1.05859,1,1,1,1.07185,.99413,.96334,1.08065,1,1,1,1,1,1,1,1,1,1,1],zj={lineHeight:1.2207,lineGap:.2207},jj=[.76116,1,1,1.0006,.99998,.99974,.99973,.99973,.99982,.99977,1.00087,.99998,.99998,.99959,1.00003,1.0006,.99998,1.0006,1.0006,.99973,.99973,.99973,.99973,.99973,.99973,.99973,.99973,.99973,.99973,.99998,1,1.00003,1.00003,1.00003,1.00026,.9999,.99977,.99977,.99977,.99977,1.00001,1.00026,1.00022,.99977,1.0006,.99973,.99977,1.00026,.99999,.99977,1.00022,1.00001,1.00022,.99977,1.00001,1.00026,.99977,1.00001,1.00016,1.00001,1.00001,1.00026,.99998,1.0006,.99998,1.00003,.99973,.99998,.99973,1.00026,.99973,1.00026,.99973,.99998,1.00026,1.00026,1.0006,1.0006,.99973,1.0006,.99982,1.00026,1.00026,1.00026,1.00026,.99959,.99973,.99998,1.00026,.99973,1.00022,.99973,.99973,1,.99959,1.00077,.99959,1.00003,.99998,.99973,.99973,.99973,.99973,1.00077,.99973,.99998,1.00025,.99968,.99973,1.00003,1.00025,.60299,1.00024,1.06409,1,1,.99998,1,.99973,1.0006,.99998,1,.99936,.99973,1.00002,1.00002,1.00002,1.00026,.99977,.99977,.99977,.99977,.99977,.99977,1,.99977,1.00001,1.00001,1.00001,1.00001,1.0006,1.0006,1.0006,1.0006,.99977,.99977,1.00022,1.00022,1.00022,1.00022,1.00022,1.00003,1.00022,.99977,.99977,.99977,.99977,1.00001,1.00001,1.00026,.99973,.99973,.99973,.99973,.99973,.99973,.99982,.99973,.99973,.99973,.99973,.99973,1.0006,1.0006,1.0006,1.0006,1.00026,1.00026,1.00026,1.00026,1.00026,1.00026,1.00026,1.06409,1.00026,1.00026,1.00026,1.00026,1.00026,.99973,1.00026,.99973,.99977,.99973,.99977,.99973,.99977,.99973,.99977,.99973,.99977,.99973,.99977,.99973,.99977,.99973,.99977,1.03374,.99977,1.00026,1.00001,.99973,1.00001,.99973,1.00001,.99973,1.00001,.99973,1.00001,.99973,1.00022,1.00026,1.00022,1.00026,1.00022,1.00026,1.00022,1.00026,.99977,1.00026,.99977,1.00026,1.0006,1.0006,1.0006,1.0006,1.0006,1.0006,1.0006,1.0006,1.0006,1.0006,1.00042,.99973,.99973,1.0006,.99977,.99973,.99973,1.00026,1.0006,1.00026,1.0006,1.00026,1.03828,1.00026,.99999,1.00026,1.0006,.99977,1.00026,.99977,1.00026,.99977,1.00026,.9993,.9998,1.00026,1.00022,1.00026,1.00022,1.00026,1.00022,1.00026,1,1.00016,.99977,.99959,.99977,.99959,.99977,.99959,1.00001,.99973,1.00001,.99973,1.00001,.99973,1.00001,.99973,1.00026,.99998,1.00026,.8121,1.00026,.99998,.99977,1.00026,.99977,1.00026,.99977,1.00026,.99977,1.00026,.99977,1.00026,.99977,1.00026,1.00016,1.00022,1.00001,.99973,1.00001,1.00026,1,1.00026,1,1.00026,1,1.0006,.99973,.99977,.99973,1,.99982,1.00022,1.00026,1.00001,.99973,1.00026,.99998,.99998,.99998,.99998,.99998,.99998,.99998,.99998,.99998,.99998,.99998,1.00034,.99977,1,.99997,1.00026,1.00078,1.00036,.99973,1.00013,1.0006,.99977,.99977,.99988,.85148,1.00001,1.00026,.99977,1.00022,1.0006,.99977,1.00001,.99999,.99977,1.00069,1.00022,.99977,1.00001,.99984,1.00026,1.00001,1.00024,1.00001,.9999,1,1.0006,1.00001,1.00041,.99962,1.00026,1.0006,.99995,1.00041,.99942,.99973,.99927,1.00082,.99902,1.00026,1.00087,1.0006,1.00069,.99973,.99867,.99973,.9993,1.00026,1.00049,1.00056,1,.99988,.99935,.99995,.99954,1.00055,.99945,1.00032,1.0006,.99995,1.00026,.99995,1.00032,1.00001,1.00008,.99971,1.00019,.9994,1.00001,1.0006,1.00044,.99973,1.00023,1.00047,1,.99942,.99561,.99989,1.00035,.99977,1.00035,.99977,1.00019,.99944,1.00001,1.00021,.99926,1.00035,1.00035,.99942,1.00048,.99999,.99977,1.00022,1.00035,1.00001,.99977,1.00026,.99989,1.00057,1.00001,.99936,1.00052,1.00012,.99996,1.00043,1,1.00035,.9994,.99976,1.00035,.99973,1.00052,1.00041,1.00119,1.00037,.99973,1.00002,.99986,1.00041,1.00041,.99902,.9996,1.00034,.99999,1.00026,.99999,1.00026,.99973,1.00052,.99973,1,.99973,1.00041,1.00075,.9994,1.0003,.99999,1,1.00041,.99955,1,.99915,.99973,.99973,1.00026,1.00119,.99955,.99973,1.0006,.99911,1.0006,1.00026,.99972,1.00026,.99902,1.00041,.99973,.99999,1,1,1.00038,1.0005,1.00016,1.00022,1.00016,1.00022,1.00016,1.00022,1.00001,.99973,1,1,.99973,1,1,.99955,1.0006,1.0006,1.0006,1.0006,1,1,1,.99973,.99973,.99972,1,1,1.00106,.99999,.99998,.99998,.99999,.99998,1.66475,1,.99973,.99973,1.00023,.99973,.99971,1.00047,1.00023,1,.99991,.99984,1.00002,1.00002,1.00002,1.00002,1,1,1,1,1,1,1,.99972,1,1.20985,1.39713,1.00003,1.00031,1.00015,1,.99561,1.00027,1.00031,1.00031,.99915,1.00031,1.00031,.99999,1.00003,.99999,.99999,1.41144,1.6,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.40579,1.40579,1.36625,.99999,1,.99861,.99861,1,1.00026,1.00026,1.00026,1.00026,.99972,.99999,.99999,.99999,.99999,1.40483,1,.99977,1.00054,1,1,.99953,.99962,1.00042,.9995,1,1,1,1,1,1,1,1,.99998,.99998,.99998,.99998,1,1,1,1,1,1,1,1,1,1,1],Gj={lineHeight:1.2,lineGap:.2},Vj=[.76116,1,1,1.0006,.99998,.99974,.99973,.99973,.99982,.99977,1.00087,.99998,.99998,.99959,1.00003,1.0006,.99998,1.0006,1.0006,.99973,.99973,.99973,.99973,.99973,.99973,.99973,.99973,.99973,.99973,.99998,1,1.00003,1.00003,1.00003,1.00026,.9999,.99977,.99977,.99977,.99977,1.00001,1.00026,1.00022,.99977,1.0006,.99973,.99977,1.00026,.99999,.99977,1.00022,1.00001,1.00022,.99977,1.00001,1.00026,.99977,1.00001,1.00016,1.00001,1.00001,1.00026,.99998,1.0006,.99998,1.00003,.99973,.99998,.99973,1.00026,.99973,1.00026,.99973,.99998,1.00026,1.00026,1.0006,1.0006,.99973,1.0006,.99982,1.00026,1.00026,1.00026,1.00026,.99959,.99973,.99998,1.00026,.99973,1.00022,.99973,.99973,1,.99959,1.00077,.99959,1.00003,.99998,.99973,.99973,.99973,.99973,1.00077,.99973,.99998,1.00025,.99968,.99973,1.00003,1.00025,.60299,1.00024,1.06409,1,1,.99998,1,.99973,1.0006,.99998,1,.99936,.99973,1.00002,1.00002,1.00002,1.00026,.99977,.99977,.99977,.99977,.99977,.99977,1,.99977,1.00001,1.00001,1.00001,1.00001,1.0006,1.0006,1.0006,1.0006,.99977,.99977,1.00022,1.00022,1.00022,1.00022,1.00022,1.00003,1.00022,.99977,.99977,.99977,.99977,1.00001,1.00001,1.00026,.99973,.99973,.99973,.99973,.99973,.99973,.99982,.99973,.99973,.99973,.99973,.99973,1.0006,1.0006,1.0006,1.0006,1.00026,1.00026,1.00026,1.00026,1.00026,1.00026,1.00026,1.06409,1.00026,1.00026,1.00026,1.00026,1.00026,.99973,1.00026,.99973,.99977,.99973,.99977,.99973,.99977,.99973,.99977,.99973,.99977,.99973,.99977,.99973,.99977,.99973,.99977,1.0044,.99977,1.00026,1.00001,.99973,1.00001,.99973,1.00001,.99973,1.00001,.99973,1.00001,.99973,1.00022,1.00026,1.00022,1.00026,1.00022,1.00026,1.00022,1.00026,.99977,1.00026,.99977,1.00026,1.0006,1.0006,1.0006,1.0006,1.0006,1.0006,1.0006,1.0006,1.0006,1.0006,.99971,.99973,.99973,1.0006,.99977,.99973,.99973,1.00026,1.0006,1.00026,1.0006,1.00026,1.01011,1.00026,.99999,1.00026,1.0006,.99977,1.00026,.99977,1.00026,.99977,1.00026,.9993,.9998,1.00026,1.00022,1.00026,1.00022,1.00026,1.00022,1.00026,1,1.00016,.99977,.99959,.99977,.99959,.99977,.99959,1.00001,.99973,1.00001,.99973,1.00001,.99973,1.00001,.99973,1.00026,.99998,1.00026,.8121,1.00026,.99998,.99977,1.00026,.99977,1.00026,.99977,1.00026,.99977,1.00026,.99977,1.00026,.99977,1.00026,1.00016,1.00022,1.00001,.99973,1.00001,1.00026,1,1.00026,1,1.00026,1,1.0006,.99973,.99977,.99973,1,.99982,1.00022,1.00026,1.00001,.99973,1.00026,.99998,.99998,.99998,.99998,.99998,.99998,.99998,.99998,.99998,.99998,.99998,.99998,.99977,1,1,1.00026,.99969,.99972,.99981,.9998,1.0006,.99977,.99977,1.00022,.91155,1.00001,1.00026,.99977,1.00022,1.0006,.99977,1.00001,.99999,.99977,.99966,1.00022,1.00032,1.00001,.99944,1.00026,1.00001,.99968,1.00001,1.00047,1,1.0006,1.00001,.99981,1.00101,1.00026,1.0006,.99948,.99981,1.00064,.99973,.99942,1.00101,1.00061,1.00026,1.00069,1.0006,1.00014,.99973,1.01322,.99973,1.00065,1.00026,1.00012,.99923,1,1.00064,1.00076,.99948,1.00055,1.00063,1.00007,.99943,1.0006,.99948,1.00026,.99948,.99943,1.00001,1.00001,1.00029,1.00038,1.00035,1.00001,1.0006,1.0006,.99973,.99978,1.00001,1.00057,.99989,.99967,.99964,.99967,.99977,.99999,.99977,1.00038,.99977,1.00001,.99973,1.00066,.99967,.99967,1.00041,.99998,.99999,.99977,1.00022,.99967,1.00001,.99977,1.00026,.99964,1.00031,1.00001,.99999,.99999,1,1.00023,1,1,.99999,1.00035,1.00001,.99999,.99973,.99977,.99999,1.00058,.99973,.99973,.99955,.9995,1.00026,1.00026,1.00032,.99989,1.00034,.99999,1.00026,1.00026,1.00026,.99973,.45998,.99973,1.00026,.99973,1.00001,.99999,.99982,.99994,.99996,1,1.00042,1.00044,1.00029,1.00023,.99973,.99973,1.00026,.99949,1.00002,.99973,1.0006,1.0006,1.0006,.99975,1.00026,1.00026,1.00032,.98685,.99973,1.00026,1,1,.99966,1.00044,1.00016,1.00022,1.00016,1.00022,1.00016,1.00022,1.00001,.99973,1,1,.99973,1,1,.99955,1.0006,1.0006,1.0006,1.0006,1,1,1,.99973,.99973,.99972,1,1,1.00106,.99999,.99998,.99998,.99999,.99998,1.66475,1,.99973,.99973,1,.99973,.99971,.99978,1,1,.99991,.99984,1.00002,1.00002,1.00002,1.00002,1.00098,1,1,1,1.00049,1,1,.99972,1,1.20985,1.39713,1.00003,1.00031,1.00015,1,.99561,1.00027,1.00031,1.00031,.99915,1.00031,1.00031,.99999,1.00003,.99999,.99999,1.41144,1.6,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.40579,1.40579,1.36625,.99999,1,.99861,.99861,1,1.00026,1.00026,1.00026,1.00026,.99972,.99999,.99999,.99999,.99999,1.40483,1,.99977,1.00054,1,1,.99953,.99962,1.00042,.9995,1,1,1,1,1,1,1,1,.99998,.99998,.99998,.99998,1,1,1,1,1,1,1,1,1,1,1],qj={lineHeight:1.35,lineGap:.2},Wj=[.76116,1,1,1.0006,1.0006,1.00006,.99973,.99973,.99982,1.00001,1.00043,.99998,.99998,.99959,1.00003,1.0006,.99998,1.0006,1.0006,.99973,.99973,.99973,.99973,.99973,.99973,.99973,.99973,.99973,.99973,1.0006,1,1.00003,1.00003,1.00003,.99973,.99987,1.00001,1.00001,.99977,.99977,1.00001,1.00026,1.00022,.99977,1.0006,1,1.00001,.99973,.99999,.99977,1.00022,1.00001,1.00022,.99977,1.00001,1.00026,.99977,1.00001,1.00016,1.00001,1.00001,1.00026,1.0006,1.0006,1.0006,.99949,.99973,.99998,.99973,.99973,1,.99973,.99973,1.0006,.99973,.99973,.99924,.99924,1,.99924,.99999,.99973,.99973,.99973,.99973,.99998,1,1.0006,.99973,1,.99977,1,1,1,1.00005,1.0009,1.00005,1.00003,.99998,.99973,.99973,.99973,.99973,1.0009,.99973,.99998,1.00025,.99968,.99973,1.00003,1.00025,.60299,1.00024,1.06409,1,1,.99998,1,.9998,1.0006,.99998,1,.99936,.99973,1.00002,1.00002,1.00002,1.00026,1.00001,1.00001,1.00001,1.00001,1.00001,1.00001,1,.99977,1.00001,1.00001,1.00001,1.00001,1.0006,1.0006,1.0006,1.0006,.99977,.99977,1.00022,1.00022,1.00022,1.00022,1.00022,1.00003,1.00022,.99977,.99977,.99977,.99977,1.00001,1.00001,1.00026,.99973,.99973,.99973,.99973,.99973,.99973,.99982,1,.99973,.99973,.99973,.99973,1.0006,1.0006,1.0006,1.0006,.99973,.99973,.99973,.99973,.99973,.99973,.99973,1.06409,1.00026,.99973,.99973,.99973,.99973,1,.99973,1,1.00001,.99973,1.00001,.99973,1.00001,.99973,.99977,1,.99977,1,.99977,1,.99977,1,.99977,1.0288,.99977,.99973,1.00001,.99973,1.00001,.99973,1.00001,.99973,1.00001,.99973,1.00001,.99973,1.00022,.99973,1.00022,.99973,1.00022,.99973,1.00022,.99973,.99977,.99973,.99977,.99973,1.0006,1.0006,1.0006,1.0006,1.0006,1.0006,1.0006,.99924,1.0006,1.0006,.99946,1.00034,1,.99924,1.00001,1,1,.99973,.99924,.99973,.99924,.99973,1.06311,.99973,1.00024,.99973,.99924,.99977,.99973,.99977,.99973,.99977,.99973,1.00041,.9998,.99973,1.00022,.99973,1.00022,.99973,1.00022,.99973,1,1.00016,.99977,.99998,.99977,.99998,.99977,.99998,1.00001,1,1.00001,1,1.00001,1,1.00001,1,1.00026,1.0006,1.00026,.89547,1.00026,1.0006,.99977,.99973,.99977,.99973,.99977,.99973,.99977,.99973,.99977,.99973,.99977,.99973,1.00016,.99977,1.00001,1,1.00001,1.00026,1,1.00026,1,1.00026,1,.99924,.99973,1.00001,.99973,1,.99982,1.00022,1.00026,1.00001,1,1.00026,1.0006,.99998,.99998,.99998,.99998,.99998,.99998,.99998,.99998,.99998,.99998,.99998,1.00001,1,1.00054,.99977,1.00084,1.00007,.99973,1.00013,.99924,1.00001,1.00001,.99945,.91221,1.00001,1.00026,.99977,1.00022,1.0006,1.00001,1.00001,.99999,.99977,.99933,1.00022,1.00054,1.00001,1.00065,1.00026,1.00001,1.0001,1.00001,1.00052,1,1.0006,1.00001,.99945,.99897,.99968,.99924,1.00036,.99945,.99949,1,1.0006,.99897,.99918,.99968,.99911,.99924,1,.99962,1.01487,1,1.0005,.99973,1.00012,1.00043,1,.99995,.99994,1.00036,.99947,1.00019,1.00063,1.00025,.99924,1.00036,.99973,1.00036,1.00025,1.00001,1.00001,1.00027,1.0001,1.00068,1.00001,1.0006,1.0006,1,1.00008,.99957,.99972,.9994,.99954,.99975,1.00051,1.00001,1.00019,1.00001,1.0001,.99986,1.00001,1.00001,1.00038,.99954,.99954,.9994,1.00066,.99999,.99977,1.00022,1.00054,1.00001,.99977,1.00026,.99975,1.0001,1.00001,.99993,.9995,.99955,1.00016,.99978,.99974,1.00019,1.00022,.99955,1.00053,.99973,1.00089,1.00005,.99967,1.00048,.99973,1.00002,1.00034,.99973,.99973,.99964,1.00006,1.00066,.99947,.99973,.98894,.99973,1,.44898,1,.99946,1,1.00039,1.00082,.99991,.99991,.99985,1.00022,1.00023,1.00061,1.00006,.99966,.99973,.99973,.99973,1.00019,1.0008,1,.99924,.99924,.99924,.99983,1.00044,.99973,.99964,.98332,1,.99973,1,1,.99962,.99895,1.00016,.99977,1.00016,.99977,1.00016,.99977,1.00001,1,1,1,.99973,1,1,.99955,.99924,.99924,.99924,.99924,.99998,.99998,.99998,.99973,.99973,.99972,1,1,1.00267,.99999,.99998,.99998,1,.99998,1.66475,1,.99973,.99973,1.00023,.99973,1.00423,.99925,.99999,1,.99991,.99984,1.00002,1.00002,1.00002,1.00002,1.00049,1,1.00245,1,1,1,1,.96329,1,1.20985,1.39713,1.00003,.8254,1.00015,1,1.00035,1.00027,1.00031,1.00031,1.00003,1.00031,1.00031,.99999,1.00003,.99999,.99999,1.41144,1.6,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.40579,1.40579,1.36625,.99999,1,.99861,.99861,1,1.00026,1.00026,1.00026,1.00026,.95317,.99999,.99999,.99999,.99999,1.40483,1,.99977,1.00054,1,1,.99953,.99962,1.00042,.9995,1,1,1,1,1,1,1,1,.99998,.99998,.99998,.99998,1,1,1,1,1,1,1,1,1,1,1],Kj={lineHeight:1.35,lineGap:.2},Xj=[.76116,1,1,1.0006,1.0006,1.00006,.99973,.99973,.99982,1.00001,1.00043,.99998,.99998,.99959,1.00003,1.0006,.99998,1.0006,1.0006,.99973,.99973,.99973,.99973,.99973,.99973,.99973,.99973,.99973,.99973,1.0006,1,1.00003,1.00003,1.00003,.99973,.99987,1.00001,1.00001,.99977,.99977,1.00001,1.00026,1.00022,.99977,1.0006,1,1.00001,.99973,.99999,.99977,1.00022,1.00001,1.00022,.99977,1.00001,1.00026,.99977,1.00001,1.00016,1.00001,1.00001,1.00026,1.0006,1.0006,1.0006,.99949,.99973,.99998,.99973,.99973,1,.99973,.99973,1.0006,.99973,.99973,.99924,.99924,1,.99924,.99999,.99973,.99973,.99973,.99973,.99998,1,1.0006,.99973,1,.99977,1,1,1,1.00005,1.0009,1.00005,1.00003,.99998,.99973,.99973,.99973,.99973,1.0009,.99973,.99998,1.00025,.99968,.99973,1.00003,1.00025,.60299,1.00024,1.06409,1,1,.99998,1,.9998,1.0006,.99998,1,.99936,.99973,1.00002,1.00002,1.00002,1.00026,1.00001,1.00001,1.00001,1.00001,1.00001,1.00001,1,.99977,1.00001,1.00001,1.00001,1.00001,1.0006,1.0006,1.0006,1.0006,.99977,.99977,1.00022,1.00022,1.00022,1.00022,1.00022,1.00003,1.00022,.99977,.99977,.99977,.99977,1.00001,1.00001,1.00026,.99973,.99973,.99973,.99973,.99973,.99973,.99982,1,.99973,.99973,.99973,.99973,1.0006,1.0006,1.0006,1.0006,.99973,.99973,.99973,.99973,.99973,.99973,.99973,1.06409,1.00026,.99973,.99973,.99973,.99973,1,.99973,1,1.00001,.99973,1.00001,.99973,1.00001,.99973,.99977,1,.99977,1,.99977,1,.99977,1,.99977,1.04596,.99977,.99973,1.00001,.99973,1.00001,.99973,1.00001,.99973,1.00001,.99973,1.00001,.99973,1.00022,.99973,1.00022,.99973,1.00022,.99973,1.00022,.99973,.99977,.99973,.99977,.99973,1.0006,1.0006,1.0006,1.0006,1.0006,1.0006,1.0006,.99924,1.0006,1.0006,1.00019,1.00034,1,.99924,1.00001,1,1,.99973,.99924,.99973,.99924,.99973,1.02572,.99973,1.00005,.99973,.99924,.99977,.99973,.99977,.99973,.99977,.99973,.99999,.9998,.99973,1.00022,.99973,1.00022,.99973,1.00022,.99973,1,1.00016,.99977,.99998,.99977,.99998,.99977,.99998,1.00001,1,1.00001,1,1.00001,1,1.00001,1,1.00026,1.0006,1.00026,.84533,1.00026,1.0006,.99977,.99973,.99977,.99973,.99977,.99973,.99977,.99973,.99977,.99973,.99977,.99973,1.00016,.99977,1.00001,1,1.00001,1.00026,1,1.00026,1,1.00026,1,.99924,.99973,1.00001,.99973,1,.99982,1.00022,1.00026,1.00001,1,1.00026,1.0006,.99998,.99998,.99998,.99998,.99998,.99998,.99998,.99998,.99998,.99998,.99998,.99928,1,.99977,1.00013,1.00055,.99947,.99945,.99941,.99924,1.00001,1.00001,1.0004,.91621,1.00001,1.00026,.99977,1.00022,1.0006,1.00001,1.00005,.99999,.99977,1.00015,1.00022,.99977,1.00001,.99973,1.00026,1.00001,1.00019,1.00001,.99946,1,1.0006,1.00001,.99978,1.00045,.99973,.99924,1.00023,.99978,.99966,1,1.00065,1.00045,1.00019,.99973,.99973,.99924,1,1,.96499,1,1.00055,.99973,1.00008,1.00027,1,.9997,.99995,1.00023,.99933,1.00019,1.00015,1.00031,.99924,1.00023,.99973,1.00023,1.00031,1.00001,.99928,1.00029,1.00092,1.00035,1.00001,1.0006,1.0006,1,.99988,.99975,1,1.00082,.99561,.9996,1.00035,1.00001,.99962,1.00001,1.00092,.99964,1.00001,.99963,.99999,1.00035,1.00035,1.00082,.99962,.99999,.99977,1.00022,1.00035,1.00001,.99977,1.00026,.9996,.99967,1.00001,1.00034,1.00074,1.00054,1.00053,1.00063,.99971,.99962,1.00035,.99975,.99977,.99973,1.00043,.99953,1.0007,.99915,.99973,1.00008,.99892,1.00073,1.00073,1.00114,.99915,1.00073,.99955,.99973,1.00092,.99973,1,.99998,1,1.0003,1,1.00043,1.00001,.99969,1.0003,1,1.00035,1.00001,.9995,1,1.00092,.99973,.99973,.99973,1.0007,.9995,1,.99924,1.0006,.99924,.99972,1.00062,.99973,1.00114,1.00073,1,.99955,1,1,1.00047,.99968,1.00016,.99977,1.00016,.99977,1.00016,.99977,1.00001,1,1,1,.99973,1,1,.99955,.99924,.99924,.99924,.99924,.99998,.99998,.99998,.99973,.99973,.99972,1,1,1.00267,.99999,.99998,.99998,1,.99998,1.66475,1,.99973,.99973,1.00023,.99973,.99971,.99925,1.00023,1,.99991,.99984,1.00002,1.00002,1.00002,1.00002,1,1,1,1,1,1,1,.96329,1,1.20985,1.39713,1.00003,.8254,1.00015,1,1.00035,1.00027,1.00031,1.00031,.99915,1.00031,1.00031,.99999,1.00003,.99999,.99999,1.41144,1.6,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.40579,1.40579,1.36625,.99999,1,.99861,.99861,1,1.00026,1.00026,1.00026,1.00026,.95317,.99999,.99999,.99999,.99999,1.40483,1,.99977,1.00054,1,1,.99953,.99962,1.00042,.9995,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],Yj={lineHeight:1.2,lineGap:.2},Lm=[365,0,333,278,333,474,556,556,889,722,238,333,333,389,584,278,333,278,278,556,556,556,556,556,556,556,556,556,556,333,333,584,584,584,611,975,722,722,722,722,667,611,778,722,278,556,722,611,833,722,778,667,778,722,667,611,722,667,944,667,667,611,333,278,333,584,556,333,556,611,556,611,556,333,611,611,278,278,556,278,889,611,611,611,611,389,556,333,611,556,778,556,556,500,389,280,389,584,333,556,556,556,556,280,556,333,737,370,556,584,737,552,400,549,333,333,333,576,556,278,333,333,365,556,834,834,834,611,722,722,722,722,722,722,1e3,722,667,667,667,667,278,278,278,278,722,722,778,778,778,778,778,584,778,722,722,722,722,667,667,611,556,556,556,556,556,556,889,556,556,556,556,556,278,278,278,278,611,611,611,611,611,611,611,549,611,611,611,611,611,556,611,556,722,556,722,556,722,556,722,556,722,556,722,556,722,556,722,719,722,611,667,556,667,556,667,556,667,556,667,556,778,611,778,611,778,611,778,611,722,611,722,611,278,278,278,278,278,278,278,278,278,278,785,556,556,278,722,556,556,611,278,611,278,611,385,611,479,611,278,722,611,722,611,722,611,708,723,611,778,611,778,611,778,611,1e3,944,722,389,722,389,722,389,667,556,667,556,667,556,667,556,611,333,611,479,611,333,722,611,722,611,722,611,722,611,722,611,722,611,944,778,667,556,667,611,500,611,500,611,500,278,556,722,556,1e3,889,778,611,667,556,611,333,333,333,333,333,333,333,333,333,333,333,465,722,333,853,906,474,825,927,838,278,722,722,601,719,667,611,722,778,278,722,667,833,722,644,778,722,667,600,611,667,821,667,809,802,278,667,615,451,611,278,582,615,610,556,606,475,460,611,541,278,558,556,612,556,445,611,766,619,520,684,446,582,715,576,753,845,278,582,611,582,845,667,669,885,567,711,667,278,276,556,1094,1062,875,610,722,622,719,722,719,722,567,712,667,904,626,719,719,610,702,833,722,778,719,667,722,611,622,854,667,730,703,1005,1019,870,979,719,711,1031,719,556,618,615,417,635,556,709,497,615,615,500,635,740,604,611,604,611,556,490,556,875,556,615,581,833,844,729,854,615,552,854,583,556,556,611,417,552,556,278,281,278,969,906,611,500,615,556,604,778,611,487,447,944,778,944,778,944,778,667,556,333,333,556,1e3,1e3,552,278,278,278,278,500,500,500,556,556,350,1e3,1e3,240,479,333,333,604,333,167,396,556,556,1094,556,885,489,1115,1e3,768,600,834,834,834,834,1e3,500,1e3,500,1e3,500,500,494,612,823,713,584,549,713,979,722,274,549,549,583,549,549,604,584,604,604,708,625,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,729,604,604,354,354,1e3,990,990,990,990,494,604,604,604,604,354,1021,1052,917,750,750,531,656,594,510,500,750,750,611,611,333,333,333,333,333,333,333,333,222,222,333,333,333,333,333,333,333,333],Bm=[-1,-1,-1,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,161,162,163,164,165,166,167,168,169,170,171,172,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,402,506,507,508,509,510,511,536,537,538,539,710,711,713,728,729,730,731,732,733,900,901,902,903,904,905,906,908,910,911,912,913,914,915,916,917,918,919,920,921,922,923,924,925,926,927,928,929,931,932,933,934,935,936,937,938,939,940,941,942,943,944,945,946,947,948,949,950,951,952,953,954,955,956,957,958,959,960,961,962,963,964,965,966,967,968,969,970,971,972,973,974,1024,1025,1026,1027,1028,1029,1030,1031,1032,1033,1034,1035,1036,1037,1038,1039,1040,1041,1042,1043,1044,1045,1046,1047,1048,1049,1050,1051,1052,1053,1054,1055,1056,1057,1058,1059,1060,1061,1062,1063,1064,1065,1066,1067,1068,1069,1070,1071,1072,1073,1074,1075,1076,1077,1078,1079,1080,1081,1082,1083,1084,1085,1086,1087,1088,1089,1090,1091,1092,1093,1094,1095,1096,1097,1098,1099,1100,1101,1102,1103,1104,1105,1106,1107,1108,1109,1110,1111,1112,1113,1114,1115,1116,1117,1118,1119,1138,1139,1168,1169,7808,7809,7810,7811,7812,7813,7922,7923,8208,8209,8211,8212,8213,8215,8216,8217,8218,8219,8220,8221,8222,8224,8225,8226,8230,8240,8242,8243,8249,8250,8252,8254,8260,8319,8355,8356,8359,8364,8453,8467,8470,8482,8486,8494,8539,8540,8541,8542,8592,8593,8594,8595,8596,8597,8616,8706,8710,8719,8721,8722,8730,8734,8735,8745,8747,8776,8800,8801,8804,8805,8962,8976,8992,8993,9472,9474,9484,9488,9492,9496,9500,9508,9516,9524,9532,9552,9553,9554,9555,9556,9557,9558,9559,9560,9561,9562,9563,9564,9565,9566,9567,9568,9569,9570,9571,9572,9573,9574,9575,9576,9577,9578,9579,9580,9600,9604,9608,9612,9616,9617,9618,9619,9632,9633,9642,9643,9644,9650,9658,9660,9668,9674,9675,9679,9688,9689,9702,9786,9787,9788,9792,9794,9824,9827,9829,9830,9834,9835,9836,61441,61442,61445,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],Um=[365,0,333,278,333,474,556,556,889,722,238,333,333,389,584,278,333,278,278,556,556,556,556,556,556,556,556,556,556,333,333,584,584,584,611,975,722,722,722,722,667,611,778,722,278,556,722,611,833,722,778,667,778,722,667,611,722,667,944,667,667,611,333,278,333,584,556,333,556,611,556,611,556,333,611,611,278,278,556,278,889,611,611,611,611,389,556,333,611,556,778,556,556,500,389,280,389,584,333,556,556,556,556,280,556,333,737,370,556,584,737,552,400,549,333,333,333,576,556,278,333,333,365,556,834,834,834,611,722,722,722,722,722,722,1e3,722,667,667,667,667,278,278,278,278,722,722,778,778,778,778,778,584,778,722,722,722,722,667,667,611,556,556,556,556,556,556,889,556,556,556,556,556,278,278,278,278,611,611,611,611,611,611,611,549,611,611,611,611,611,556,611,556,722,556,722,556,722,556,722,556,722,556,722,556,722,556,722,740,722,611,667,556,667,556,667,556,667,556,667,556,778,611,778,611,778,611,778,611,722,611,722,611,278,278,278,278,278,278,278,278,278,278,782,556,556,278,722,556,556,611,278,611,278,611,396,611,479,611,278,722,611,722,611,722,611,708,723,611,778,611,778,611,778,611,1e3,944,722,389,722,389,722,389,667,556,667,556,667,556,667,556,611,333,611,479,611,333,722,611,722,611,722,611,722,611,722,611,722,611,944,778,667,556,667,611,500,611,500,611,500,278,556,722,556,1e3,889,778,611,667,556,611,333,333,333,333,333,333,333,333,333,333,333,333,722,333,854,906,473,844,930,847,278,722,722,610,671,667,611,722,778,278,722,667,833,722,657,778,718,667,590,611,667,822,667,829,781,278,667,620,479,611,278,591,620,621,556,610,479,492,611,558,278,566,556,603,556,450,611,712,605,532,664,409,591,704,578,773,834,278,591,611,591,834,667,667,886,614,719,667,278,278,556,1094,1042,854,622,719,677,719,722,708,722,614,722,667,927,643,719,719,615,687,833,722,778,719,667,722,611,677,781,667,729,708,979,989,854,1e3,708,719,1042,729,556,619,604,534,618,556,736,510,611,611,507,622,740,604,611,611,611,556,889,556,885,556,646,583,889,935,707,854,594,552,865,589,556,556,611,469,563,556,278,278,278,969,906,611,507,619,556,611,778,611,575,467,944,778,944,778,944,778,667,556,333,333,556,1e3,1e3,552,278,278,278,278,500,500,500,556,556,350,1e3,1e3,240,479,333,333,604,333,167,396,556,556,1104,556,885,516,1146,1e3,768,600,834,834,834,834,999,500,1e3,500,1e3,500,500,494,612,823,713,584,549,713,979,722,274,549,549,583,549,549,604,584,604,604,708,625,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,729,604,604,354,354,1e3,990,990,990,990,494,604,604,604,604,354,1021,1052,917,750,750,531,656,594,510,500,750,750,611,611,333,333,333,333,333,333,333,333,222,222,333,333,333,333,333,333,333,333],Hm=[-1,-1,-1,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,161,162,163,164,165,166,167,168,169,170,171,172,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,402,506,507,508,509,510,511,536,537,538,539,710,711,713,728,729,730,731,732,733,900,901,902,903,904,905,906,908,910,911,912,913,914,915,916,917,918,919,920,921,922,923,924,925,926,927,928,929,931,932,933,934,935,936,937,938,939,940,941,942,943,944,945,946,947,948,949,950,951,952,953,954,955,956,957,958,959,960,961,962,963,964,965,966,967,968,969,970,971,972,973,974,1024,1025,1026,1027,1028,1029,1030,1031,1032,1033,1034,1035,1036,1037,1038,1039,1040,1041,1042,1043,1044,1045,1046,1047,1048,1049,1050,1051,1052,1053,1054,1055,1056,1057,1058,1059,1060,1061,1062,1063,1064,1065,1066,1067,1068,1069,1070,1071,1072,1073,1074,1075,1076,1077,1078,1079,1080,1081,1082,1083,1084,1085,1086,1087,1088,1089,1090,1091,1092,1093,1094,1095,1096,1097,1098,1099,1100,1101,1102,1103,1104,1105,1106,1107,1108,1109,1110,1111,1112,1113,1114,1115,1116,1117,1118,1119,1138,1139,1168,1169,7808,7809,7810,7811,7812,7813,7922,7923,8208,8209,8211,8212,8213,8215,8216,8217,8218,8219,8220,8221,8222,8224,8225,8226,8230,8240,8242,8243,8249,8250,8252,8254,8260,8319,8355,8356,8359,8364,8453,8467,8470,8482,8486,8494,8539,8540,8541,8542,8592,8593,8594,8595,8596,8597,8616,8706,8710,8719,8721,8722,8730,8734,8735,8745,8747,8776,8800,8801,8804,8805,8962,8976,8992,8993,9472,9474,9484,9488,9492,9496,9500,9508,9516,9524,9532,9552,9553,9554,9555,9556,9557,9558,9559,9560,9561,9562,9563,9564,9565,9566,9567,9568,9569,9570,9571,9572,9573,9574,9575,9576,9577,9578,9579,9580,9600,9604,9608,9612,9616,9617,9618,9619,9632,9633,9642,9643,9644,9650,9658,9660,9668,9674,9675,9679,9688,9689,9702,9786,9787,9788,9792,9794,9824,9827,9829,9830,9834,9835,9836,61441,61442,61445,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],zm=[365,0,333,278,278,355,556,556,889,667,191,333,333,389,584,278,333,278,278,556,556,556,556,556,556,556,556,556,556,278,278,584,584,584,556,1015,667,667,722,722,667,611,778,722,278,500,667,556,833,722,778,667,778,722,667,611,722,667,944,667,667,611,278,278,278,469,556,333,556,556,500,556,556,278,556,556,222,222,500,222,833,556,556,556,556,333,500,278,556,500,722,500,500,500,334,260,334,584,333,556,556,556,556,260,556,333,737,370,556,584,737,552,400,549,333,333,333,576,537,278,333,333,365,556,834,834,834,611,667,667,667,667,667,667,1e3,722,667,667,667,667,278,278,278,278,722,722,778,778,778,778,778,584,778,722,722,722,722,667,667,611,556,556,556,556,556,556,889,500,556,556,556,556,278,278,278,278,556,556,556,556,556,556,556,549,611,556,556,556,556,500,556,500,667,556,667,556,667,556,722,500,722,500,722,500,722,500,722,625,722,556,667,556,667,556,667,556,667,556,667,556,778,556,778,556,778,556,778,556,722,556,722,556,278,278,278,278,278,278,278,222,278,278,733,444,500,222,667,500,500,556,222,556,222,556,281,556,400,556,222,722,556,722,556,722,556,615,723,556,778,556,778,556,778,556,1e3,944,722,333,722,333,722,333,667,500,667,500,667,500,667,500,611,278,611,354,611,278,722,556,722,556,722,556,722,556,722,556,722,556,944,722,667,500,667,611,500,611,500,611,500,222,556,667,556,1e3,889,778,611,667,500,611,278,333,333,333,333,333,333,333,333,333,333,333,667,278,789,846,389,794,865,775,222,667,667,570,671,667,611,722,778,278,667,667,833,722,648,778,725,667,600,611,667,837,667,831,761,278,667,570,439,555,222,550,570,571,500,556,439,463,555,542,222,500,492,548,500,447,556,670,573,486,603,374,550,652,546,728,779,222,550,556,550,779,667,667,843,544,708,667,278,278,500,1066,982,844,589,715,639,724,667,651,667,544,704,667,917,614,715,715,589,686,833,722,778,725,667,722,611,639,795,667,727,673,920,923,805,886,651,694,1022,682,556,562,522,493,553,556,688,465,556,556,472,564,686,550,556,556,556,500,833,500,835,500,572,518,830,851,621,736,526,492,752,534,556,556,556,378,496,500,222,222,222,910,828,556,472,565,500,556,778,556,492,339,944,722,944,722,944,722,667,500,333,333,556,1e3,1e3,552,222,222,222,222,333,333,333,556,556,350,1e3,1e3,188,354,333,333,500,333,167,365,556,556,1094,556,885,323,1083,1e3,768,600,834,834,834,834,1e3,500,998,500,1e3,500,500,494,612,823,713,584,549,713,979,719,274,549,549,584,549,549,604,584,604,604,708,625,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,729,604,604,354,354,1e3,990,990,990,990,494,604,604,604,604,354,1021,1052,917,750,750,531,656,594,510,500,750,750,500,500,333,333,333,333,333,333,333,333,222,222,294,294,324,324,316,328,398,285],jm=[-1,-1,-1,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,161,162,163,164,165,166,167,168,169,170,171,172,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,402,506,507,508,509,510,511,536,537,538,539,710,711,713,728,729,730,731,732,733,900,901,902,903,904,905,906,908,910,911,912,913,914,915,916,917,918,919,920,921,922,923,924,925,926,927,928,929,931,932,933,934,935,936,937,938,939,940,941,942,943,944,945,946,947,948,949,950,951,952,953,954,955,956,957,958,959,960,961,962,963,964,965,966,967,968,969,970,971,972,973,974,1024,1025,1026,1027,1028,1029,1030,1031,1032,1033,1034,1035,1036,1037,1038,1039,1040,1041,1042,1043,1044,1045,1046,1047,1048,1049,1050,1051,1052,1053,1054,1055,1056,1057,1058,1059,1060,1061,1062,1063,1064,1065,1066,1067,1068,1069,1070,1071,1072,1073,1074,1075,1076,1077,1078,1079,1080,1081,1082,1083,1084,1085,1086,1087,1088,1089,1090,1091,1092,1093,1094,1095,1096,1097,1098,1099,1100,1101,1102,1103,1104,1105,1106,1107,1108,1109,1110,1111,1112,1113,1114,1115,1116,1117,1118,1119,1138,1139,1168,1169,7808,7809,7810,7811,7812,7813,7922,7923,8208,8209,8211,8212,8213,8215,8216,8217,8218,8219,8220,8221,8222,8224,8225,8226,8230,8240,8242,8243,8249,8250,8252,8254,8260,8319,8355,8356,8359,8364,8453,8467,8470,8482,8486,8494,8539,8540,8541,8542,8592,8593,8594,8595,8596,8597,8616,8706,8710,8719,8721,8722,8730,8734,8735,8745,8747,8776,8800,8801,8804,8805,8962,8976,8992,8993,9472,9474,9484,9488,9492,9496,9500,9508,9516,9524,9532,9552,9553,9554,9555,9556,9557,9558,9559,9560,9561,9562,9563,9564,9565,9566,9567,9568,9569,9570,9571,9572,9573,9574,9575,9576,9577,9578,9579,9580,9600,9604,9608,9612,9616,9617,9618,9619,9632,9633,9642,9643,9644,9650,9658,9660,9668,9674,9675,9679,9688,9689,9702,9786,9787,9788,9792,9794,9824,9827,9829,9830,9834,9835,9836,61441,61442,61445,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],Gm=[365,0,333,278,278,355,556,556,889,667,191,333,333,389,584,278,333,278,278,556,556,556,556,556,556,556,556,556,556,278,278,584,584,584,556,1015,667,667,722,722,667,611,778,722,278,500,667,556,833,722,778,667,778,722,667,611,722,667,944,667,667,611,278,278,278,469,556,333,556,556,500,556,556,278,556,556,222,222,500,222,833,556,556,556,556,333,500,278,556,500,722,500,500,500,334,260,334,584,333,556,556,556,556,260,556,333,737,370,556,584,737,552,400,549,333,333,333,576,537,278,333,333,365,556,834,834,834,611,667,667,667,667,667,667,1e3,722,667,667,667,667,278,278,278,278,722,722,778,778,778,778,778,584,778,722,722,722,722,667,667,611,556,556,556,556,556,556,889,500,556,556,556,556,278,278,278,278,556,556,556,556,556,556,556,549,611,556,556,556,556,500,556,500,667,556,667,556,667,556,722,500,722,500,722,500,722,500,722,615,722,556,667,556,667,556,667,556,667,556,667,556,778,556,778,556,778,556,778,556,722,556,722,556,278,278,278,278,278,278,278,222,278,278,735,444,500,222,667,500,500,556,222,556,222,556,292,556,334,556,222,722,556,722,556,722,556,604,723,556,778,556,778,556,778,556,1e3,944,722,333,722,333,722,333,667,500,667,500,667,500,667,500,611,278,611,375,611,278,722,556,722,556,722,556,722,556,722,556,722,556,944,722,667,500,667,611,500,611,500,611,500,222,556,667,556,1e3,889,778,611,667,500,611,278,333,333,333,333,333,333,333,333,333,333,333,667,278,784,838,384,774,855,752,222,667,667,551,668,667,611,722,778,278,667,668,833,722,650,778,722,667,618,611,667,798,667,835,748,278,667,578,446,556,222,547,578,575,500,557,446,441,556,556,222,500,500,576,500,448,556,690,569,482,617,395,547,648,525,713,781,222,547,556,547,781,667,667,865,542,719,667,278,278,500,1057,1010,854,583,722,635,719,667,656,667,542,677,667,923,604,719,719,583,656,833,722,778,719,667,722,611,635,760,667,740,667,917,938,792,885,656,719,1010,722,556,573,531,365,583,556,669,458,559,559,438,583,688,552,556,542,556,500,458,500,823,500,573,521,802,823,625,719,521,510,750,542,556,556,556,365,510,500,222,278,222,906,812,556,438,559,500,552,778,556,489,411,944,722,944,722,944,722,667,500,333,333,556,1e3,1e3,552,222,222,222,222,333,333,333,556,556,350,1e3,1e3,188,354,333,333,500,333,167,365,556,556,1094,556,885,323,1073,1e3,768,600,834,834,834,834,1e3,500,1e3,500,1e3,500,500,494,612,823,713,584,549,713,979,719,274,549,549,583,549,549,604,584,604,604,708,625,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,729,604,604,354,354,1e3,990,990,990,990,494,604,604,604,604,354,1021,1052,917,750,750,531,656,594,510,500,750,750,500,500,333,333,333,333,333,333,333,333,222,222,294,294,324,324,316,328,398,285],Vm=[-1,-1,-1,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,161,162,163,164,165,166,167,168,169,170,171,172,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,402,506,507,508,509,510,511,536,537,538,539,710,711,713,728,729,730,731,732,733,900,901,902,903,904,905,906,908,910,911,912,913,914,915,916,917,918,919,920,921,922,923,924,925,926,927,928,929,931,932,933,934,935,936,937,938,939,940,941,942,943,944,945,946,947,948,949,950,951,952,953,954,955,956,957,958,959,960,961,962,963,964,965,966,967,968,969,970,971,972,973,974,1024,1025,1026,1027,1028,1029,1030,1031,1032,1033,1034,1035,1036,1037,1038,1039,1040,1041,1042,1043,1044,1045,1046,1047,1048,1049,1050,1051,1052,1053,1054,1055,1056,1057,1058,1059,1060,1061,1062,1063,1064,1065,1066,1067,1068,1069,1070,1071,1072,1073,1074,1075,1076,1077,1078,1079,1080,1081,1082,1083,1084,1085,1086,1087,1088,1089,1090,1091,1092,1093,1094,1095,1096,1097,1098,1099,1100,1101,1102,1103,1104,1105,1106,1107,1108,1109,1110,1111,1112,1113,1114,1115,1116,1117,1118,1119,1138,1139,1168,1169,7808,7809,7810,7811,7812,7813,7922,7923,8208,8209,8211,8212,8213,8215,8216,8217,8218,8219,8220,8221,8222,8224,8225,8226,8230,8240,8242,8243,8249,8250,8252,8254,8260,8319,8355,8356,8359,8364,8453,8467,8470,8482,8486,8494,8539,8540,8541,8542,8592,8593,8594,8595,8596,8597,8616,8706,8710,8719,8721,8722,8730,8734,8735,8745,8747,8776,8800,8801,8804,8805,8962,8976,8992,8993,9472,9474,9484,9488,9492,9496,9500,9508,9516,9524,9532,9552,9553,9554,9555,9556,9557,9558,9559,9560,9561,9562,9563,9564,9565,9566,9567,9568,9569,9570,9571,9572,9573,9574,9575,9576,9577,9578,9579,9580,9600,9604,9608,9612,9616,9617,9618,9619,9632,9633,9642,9643,9644,9650,9658,9660,9668,9674,9675,9679,9688,9689,9702,9786,9787,9788,9792,9794,9824,9827,9829,9830,9834,9835,9836,61441,61442,61445,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],Jj=[1.36898,1,1,.72706,.80479,.83734,.98894,.99793,.9897,.93884,.86209,.94292,.94292,1.16661,1.02058,.93582,.96694,.93582,1.19137,.99793,.99793,.99793,.99793,.99793,.99793,.99793,.99793,.99793,.99793,.78076,.78076,1.02058,1.02058,1.02058,.72851,.78966,.90838,.83637,.82391,.96376,.80061,.86275,.8768,.95407,1.0258,.73901,.85022,.83655,1.0156,.95546,.92179,.87107,.92179,.82114,.8096,.89713,.94438,.95353,.94083,.91905,.90406,.9446,.94292,1.18777,.94292,1.02058,.89903,.90088,.94938,.97898,.81093,.97571,.94938,1.024,.9577,.95933,.98621,1.0474,.97455,.98981,.9672,.95933,.9446,.97898,.97407,.97646,.78036,1.10208,.95442,.95298,.97579,.9332,.94039,.938,.80687,1.01149,.80687,1.02058,.80479,.99793,.99793,.99793,.99793,1.01149,1.00872,.90088,.91882,1.0213,.8361,1.02058,.62295,.54324,.89022,1.08595,1,1,.90088,1,.97455,.93582,.90088,1,1.05686,.8361,.99642,.99642,.99642,.72851,.90838,.90838,.90838,.90838,.90838,.90838,.868,.82391,.80061,.80061,.80061,.80061,1.0258,1.0258,1.0258,1.0258,.97484,.95546,.92179,.92179,.92179,.92179,.92179,1.02058,.92179,.94438,.94438,.94438,.94438,.90406,.86958,.98225,.94938,.94938,.94938,.94938,.94938,.94938,.9031,.81093,.94938,.94938,.94938,.94938,.98621,.98621,.98621,.98621,.93969,.95933,.9446,.9446,.9446,.9446,.9446,1.08595,.9446,.95442,.95442,.95442,.95442,.94039,.97898,.94039,.90838,.94938,.90838,.94938,.90838,.94938,.82391,.81093,.82391,.81093,.82391,.81093,.82391,.81093,.96376,.84313,.97484,.97571,.80061,.94938,.80061,.94938,.80061,.94938,.80061,.94938,.80061,.94938,.8768,.9577,.8768,.9577,.8768,.9577,1,1,.95407,.95933,.97069,.95933,1.0258,.98621,1.0258,.98621,1.0258,.98621,1.0258,.98621,1.0258,.98621,.887,1.01591,.73901,1.0474,1,1,.97455,.83655,.98981,1,1,.83655,.73977,.83655,.73903,.84638,1.033,.95546,.95933,1,1,.95546,.95933,.8271,.95417,.95933,.92179,.9446,.92179,.9446,.92179,.9446,.936,.91964,.82114,.97646,1,1,.82114,.97646,.8096,.78036,.8096,.78036,1,1,.8096,.78036,1,1,.89713,.77452,.89713,1.10208,.94438,.95442,.94438,.95442,.94438,.95442,.94438,.95442,.94438,.95442,.94438,.95442,.94083,.97579,.90406,.94039,.90406,.9446,.938,.9446,.938,.9446,.938,1,.99793,.90838,.94938,.868,.9031,.92179,.9446,1,1,.89713,1.10208,.90088,.90088,.90088,.90088,.90088,.90088,.90088,.90088,.90088,.90989,.9358,.91945,.83181,.75261,.87992,.82976,.96034,.83689,.97268,1.0078,.90838,.83637,.8019,.90157,.80061,.9446,.95407,.92436,1.0258,.85022,.97153,1.0156,.95546,.89192,.92179,.92361,.87107,.96318,.89713,.93704,.95638,.91905,.91709,.92796,1.0258,.93704,.94836,1.0373,.95933,1.0078,.95871,.94836,.96174,.92601,.9498,.98607,.95776,.95933,1.05453,1.0078,.98275,.9314,.95617,.91701,1.05993,.9446,.78367,.9553,1,.86832,1.0128,.95871,.99394,.87548,.96361,.86774,1.0078,.95871,.9446,.95871,.86774,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,.94083,.97579,.94083,.97579,.94083,.97579,.90406,.94039,.96694,1,.89903,1,1,1,.93582,.93582,.93582,1,.908,.908,.918,.94219,.94219,.96544,1,1.285,1,1,.81079,.81079,1,1,.74854,1,1,1,1,.99793,1,1,1,.65,1,1.36145,1,1,1,1,1,1,1,1,1,1,1,1.17173,1,.80535,.76169,1.02058,1.0732,1.05486,1,1,1.30692,1.08595,1.08595,1,1.08595,1.08595,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1.16161,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],Zj={lineHeight:1.2,lineGap:.2},Qj=[1.36898,1,1,.66227,.80779,.81625,.97276,.97276,.97733,.92222,.83266,.94292,.94292,1.16148,1.02058,.93582,.96694,.93582,1.17337,.97276,.97276,.97276,.97276,.97276,.97276,.97276,.97276,.97276,.97276,.78076,.78076,1.02058,1.02058,1.02058,.71541,.76813,.85576,.80591,.80729,.94299,.77512,.83655,.86523,.92222,.98621,.71743,.81698,.79726,.98558,.92222,.90637,.83809,.90637,.80729,.76463,.86275,.90699,.91605,.9154,.85308,.85458,.90531,.94292,1.21296,.94292,1.02058,.89903,1.18616,.99613,.91677,.78216,.91677,.90083,.98796,.9135,.92168,.95381,.98981,.95298,.95381,.93459,.92168,.91513,.92004,.91677,.95077,.748,1.04502,.91677,.92061,.94236,.89544,.89364,.9,.80687,.8578,.80687,1.02058,.80779,.97276,.97276,.97276,.97276,.8578,.99973,1.18616,.91339,1.08074,.82891,1.02058,.55509,.71526,.89022,1.08595,1,1,1.18616,1,.96736,.93582,1.18616,1,1.04864,.82711,.99043,.99043,.99043,.71541,.85576,.85576,.85576,.85576,.85576,.85576,.845,.80729,.77512,.77512,.77512,.77512,.98621,.98621,.98621,.98621,.95961,.92222,.90637,.90637,.90637,.90637,.90637,1.02058,.90251,.90699,.90699,.90699,.90699,.85458,.83659,.94951,.99613,.99613,.99613,.99613,.99613,.99613,.85811,.78216,.90083,.90083,.90083,.90083,.95381,.95381,.95381,.95381,.9135,.92168,.91513,.91513,.91513,.91513,.91513,1.08595,.91677,.91677,.91677,.91677,.91677,.89364,.92332,.89364,.85576,.99613,.85576,.99613,.85576,.99613,.80729,.78216,.80729,.78216,.80729,.78216,.80729,.78216,.94299,.76783,.95961,.91677,.77512,.90083,.77512,.90083,.77512,.90083,.77512,.90083,.77512,.90083,.86523,.9135,.86523,.9135,.86523,.9135,1,1,.92222,.92168,.92222,.92168,.98621,.95381,.98621,.95381,.98621,.95381,.98621,.95381,.98621,.95381,.86036,.97096,.71743,.98981,1,1,.95298,.79726,.95381,1,1,.79726,.6894,.79726,.74321,.81691,1.0006,.92222,.92168,1,1,.92222,.92168,.79464,.92098,.92168,.90637,.91513,.90637,.91513,.90637,.91513,.909,.87514,.80729,.95077,1,1,.80729,.95077,.76463,.748,.76463,.748,1,1,.76463,.748,1,1,.86275,.72651,.86275,1.04502,.90699,.91677,.90699,.91677,.90699,.91677,.90699,.91677,.90699,.91677,.90699,.91677,.9154,.94236,.85458,.89364,.85458,.90531,.9,.90531,.9,.90531,.9,1,.97276,.85576,.99613,.845,.85811,.90251,.91677,1,1,.86275,1.04502,1.18616,1.18616,1.18616,1.18616,1.18616,1.18616,1.18616,1.18616,1.18616,1.00899,1.30628,.85576,.80178,.66862,.7927,.69323,.88127,.72459,.89711,.95381,.85576,.80591,.7805,.94729,.77512,.90531,.92222,.90637,.98621,.81698,.92655,.98558,.92222,.85359,.90637,.90976,.83809,.94523,.86275,.83509,.93157,.85308,.83392,.92346,.98621,.83509,.92886,.91324,.92168,.95381,.90646,.92886,.90557,.86847,.90276,.91324,.86842,.92168,.99531,.95381,.9224,.85408,.92699,.86847,1.0051,.91513,.80487,.93481,1,.88159,1.05214,.90646,.97355,.81539,.89398,.85923,.95381,.90646,.91513,.90646,.85923,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,.9154,.94236,.9154,.94236,.9154,.94236,.85458,.89364,.96694,1,.89903,1,1,1,.91782,.91782,.91782,1,.896,.896,.896,.9332,.9332,.95973,1,1.26,1,1,.80479,.80178,1,1,.85633,1,1,1,1,.97276,1,1,1,.698,1,1.36145,1,1,1,1,1,1,1,1,1,1,1,1.14542,1,.79199,.78694,1.02058,1.03493,1.05486,1,1,1.23026,1.08595,1.08595,1,1.08595,1.08595,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1.20006,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],$j={lineHeight:1.2,lineGap:.2},eG=[1.36898,1,1,.65507,.84943,.85639,.88465,.88465,.86936,.88307,.86948,.85283,.85283,1.06383,1.02058,.75945,.9219,.75945,1.17337,.88465,.88465,.88465,.88465,.88465,.88465,.88465,.88465,.88465,.88465,.75945,.75945,1.02058,1.02058,1.02058,.69046,.70926,.85158,.77812,.76852,.89591,.70466,.76125,.80094,.86822,.83864,.728,.77212,.79475,.93637,.87514,.8588,.76013,.8588,.72421,.69866,.77598,.85991,.80811,.87832,.78112,.77512,.8562,1.0222,1.18417,1.0222,1.27014,.89903,1.15012,.93859,.94399,.846,.94399,.81453,1.0186,.94219,.96017,1.03075,1.02175,.912,1.03075,.96998,.96017,.93859,.94399,.94399,.95493,.746,1.12658,.94578,.91,.979,.882,.882,.83,.85034,.83537,.85034,1.02058,.70869,.88465,.88465,.88465,.88465,.83537,.90083,1.15012,.9161,.94565,.73541,1.02058,.53609,.69353,.79519,1.08595,1,1,1.15012,1,.91974,.75945,1.15012,1,.9446,.73361,.9005,.9005,.9005,.62864,.85158,.85158,.85158,.85158,.85158,.85158,.773,.76852,.70466,.70466,.70466,.70466,.83864,.83864,.83864,.83864,.90561,.87514,.8588,.8588,.8588,.8588,.8588,1.02058,.85751,.85991,.85991,.85991,.85991,.77512,.76013,.88075,.93859,.93859,.93859,.93859,.93859,.93859,.8075,.846,.81453,.81453,.81453,.81453,.82424,.82424,.82424,.82424,.9278,.96017,.93859,.93859,.93859,.93859,.93859,1.08595,.8562,.94578,.94578,.94578,.94578,.882,.94578,.882,.85158,.93859,.85158,.93859,.85158,.93859,.76852,.846,.76852,.846,.76852,.846,.76852,.846,.89591,.8544,.90561,.94399,.70466,.81453,.70466,.81453,.70466,.81453,.70466,.81453,.70466,.81453,.80094,.94219,.80094,.94219,.80094,.94219,1,1,.86822,.96017,.86822,.96017,.83864,.82424,.83864,.82424,.83864,.82424,.83864,1.03075,.83864,.82424,.81402,1.02738,.728,1.02175,1,1,.912,.79475,1.03075,1,1,.79475,.83911,.79475,.66266,.80553,1.06676,.87514,.96017,1,1,.87514,.96017,.86865,.87396,.96017,.8588,.93859,.8588,.93859,.8588,.93859,.867,.84759,.72421,.95493,1,1,.72421,.95493,.69866,.746,.69866,.746,1,1,.69866,.746,1,1,.77598,.88417,.77598,1.12658,.85991,.94578,.85991,.94578,.85991,.94578,.85991,.94578,.85991,.94578,.85991,.94578,.87832,.979,.77512,.882,.77512,.8562,.83,.8562,.83,.8562,.83,1,.88465,.85158,.93859,.773,.8075,.85751,.8562,1,1,.77598,1.12658,1.15012,1.15012,1.15012,1.15012,1.15012,1.15313,1.15012,1.15012,1.15012,1.08106,1.03901,.85158,.77025,.62264,.7646,.65351,.86026,.69461,.89947,1.03075,.85158,.77812,.76449,.88836,.70466,.8562,.86822,.8588,.83864,.77212,.85308,.93637,.87514,.82352,.8588,.85701,.76013,.89058,.77598,.8156,.82565,.78112,.77899,.89386,.83864,.8156,.9486,.92388,.96186,1.03075,.91123,.9486,.93298,.878,.93942,.92388,.84596,.96186,.95119,1.03075,.922,.88787,.95829,.88,.93559,.93859,.78815,.93758,1,.89217,1.03737,.91123,.93969,.77487,.85769,.86799,1.03075,.91123,.93859,.91123,.86799,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,.87832,.979,.87832,.979,.87832,.979,.77512,.882,.9219,1,.89903,1,1,1,.87321,.87321,.87321,1,1.027,1.027,1.027,.86847,.86847,.79121,1,1.124,1,1,.73572,.73572,1,1,.85034,1,1,1,1,.88465,1,1,1,.669,1,1.36145,1,1,1,1,1,1,1,1,1,1,1,1.04828,1,.74948,.75187,1.02058,.98391,1.02119,1,1,1.06233,1.08595,1.08595,1,1.08595,1.08595,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1.05233,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],tG={lineHeight:1.2,lineGap:.2},nG=[1.36898,1,1,.76305,.82784,.94935,.89364,.92241,.89073,.90706,.98472,.85283,.85283,1.0664,1.02058,.74505,.9219,.74505,1.23456,.92241,.92241,.92241,.92241,.92241,.92241,.92241,.92241,.92241,.92241,.74505,.74505,1.02058,1.02058,1.02058,.73002,.72601,.91755,.8126,.80314,.92222,.73764,.79726,.83051,.90284,.86023,.74,.8126,.84869,.96518,.91115,.8858,.79761,.8858,.74498,.73914,.81363,.89591,.83659,.89633,.85608,.8111,.90531,1.0222,1.22736,1.0222,1.27014,.89903,.90088,.86667,1.0231,.896,1.01411,.90083,1.05099,1.00512,.99793,1.05326,1.09377,.938,1.06226,1.00119,.99793,.98714,1.0231,1.01231,.98196,.792,1.19137,.99074,.962,1.01915,.926,.942,.856,.85034,.92006,.85034,1.02058,.69067,.92241,.92241,.92241,.92241,.92006,.9332,.90088,.91882,.93484,.75339,1.02058,.56866,.54324,.79519,1.08595,1,1,.90088,1,.95325,.74505,.90088,1,.97198,.75339,.91009,.91009,.91009,.66466,.91755,.91755,.91755,.91755,.91755,.91755,.788,.80314,.73764,.73764,.73764,.73764,.86023,.86023,.86023,.86023,.92915,.91115,.8858,.8858,.8858,.8858,.8858,1.02058,.8858,.89591,.89591,.89591,.89591,.8111,.79611,.89713,.86667,.86667,.86667,.86667,.86667,.86667,.86936,.896,.90083,.90083,.90083,.90083,.84224,.84224,.84224,.84224,.97276,.99793,.98714,.98714,.98714,.98714,.98714,1.08595,.89876,.99074,.99074,.99074,.99074,.942,1.0231,.942,.91755,.86667,.91755,.86667,.91755,.86667,.80314,.896,.80314,.896,.80314,.896,.80314,.896,.92222,.93372,.92915,1.01411,.73764,.90083,.73764,.90083,.73764,.90083,.73764,.90083,.73764,.90083,.83051,1.00512,.83051,1.00512,.83051,1.00512,1,1,.90284,.99793,.90976,.99793,.86023,.84224,.86023,.84224,.86023,.84224,.86023,1.05326,.86023,.84224,.82873,1.07469,.74,1.09377,1,1,.938,.84869,1.06226,1,1,.84869,.83704,.84869,.81441,.85588,1.08927,.91115,.99793,1,1,.91115,.99793,.91887,.90991,.99793,.8858,.98714,.8858,.98714,.8858,.98714,.894,.91434,.74498,.98196,1,1,.74498,.98196,.73914,.792,.73914,.792,1,1,.73914,.792,1,1,.81363,.904,.81363,1.19137,.89591,.99074,.89591,.99074,.89591,.99074,.89591,.99074,.89591,.99074,.89591,.99074,.89633,1.01915,.8111,.942,.8111,.90531,.856,.90531,.856,.90531,.856,1,.92241,.91755,.86667,.788,.86936,.8858,.89876,1,1,.81363,1.19137,.90088,.90088,.90088,.90088,.90088,.90088,.90088,.90088,.90088,.90388,1.03901,.92138,.78105,.7154,.86169,.80513,.94007,.82528,.98612,1.06226,.91755,.8126,.81884,.92819,.73764,.90531,.90284,.8858,.86023,.8126,.91172,.96518,.91115,.83089,.8858,.87791,.79761,.89297,.81363,.88157,.89992,.85608,.81992,.94307,.86023,.88157,.95308,.98699,.99793,1.06226,.95817,.95308,.97358,.928,.98088,.98699,.92761,.99793,.96017,1.06226,.986,.944,.95978,.938,.96705,.98714,.80442,.98972,1,.89762,1.04552,.95817,.99007,.87064,.91879,.88888,1.06226,.95817,.98714,.95817,.88888,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,.89633,1.01915,.89633,1.01915,.89633,1.01915,.8111,.942,.9219,1,.89903,1,1,1,.93173,.93173,.93173,1,1.06304,1.06304,1.06904,.89903,.89903,.80549,1,1.156,1,1,.76575,.76575,1,1,.72458,1,1,1,1,.92241,1,1,1,.619,1,1.36145,1,1,1,1,1,1,1,1,1,1,1,1.07257,1,.74705,.71119,1.02058,1.024,1.02119,1,1,1.1536,1.08595,1.08595,1,1.08595,1.08595,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1.05638,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],iG={lineHeight:1.2,lineGap:.2},sG=[1.76738,1,1,.99297,.9824,1.04016,1.06497,1.03424,.97529,1.17647,1.23203,1.1085,1.1085,1.16939,1.2107,.9754,1.21408,.9754,1.59578,1.03424,1.03424,1.03424,1.03424,1.03424,1.03424,1.03424,1.03424,1.03424,1.03424,.81378,.81378,1.2107,1.2107,1.2107,.71703,.97847,.97363,.88776,.8641,1.02096,.79795,.85132,.914,1.06085,1.1406,.8007,.89858,.83693,1.14889,1.09398,.97489,.92094,.97489,.90399,.84041,.95923,1.00135,1,1.06467,.98243,.90996,.99361,1.1085,1.56942,1.1085,1.2107,.74627,.94282,.96752,1.01519,.86304,1.01359,.97278,1.15103,1.01359,.98561,1.02285,1.02285,1.00527,1.02285,1.0302,.99041,1.0008,1.01519,1.01359,1.02258,.79104,1.16862,.99041,.97454,1.02511,.99298,.96752,.95801,.94856,1.16579,.94856,1.2107,.9824,1.03424,1.03424,1,1.03424,1.16579,.8727,1.3871,1.18622,1.10818,1.04478,1.2107,1.18622,.75155,.94994,1.28826,1.21408,1.21408,.91056,1,.91572,.9754,.64663,1.18328,1.24866,1.04478,1.14169,1.15749,1.17389,.71703,.97363,.97363,.97363,.97363,.97363,.97363,.93506,.8641,.79795,.79795,.79795,.79795,1.1406,1.1406,1.1406,1.1406,1.02096,1.09398,.97426,.97426,.97426,.97426,.97426,1.2107,.97489,1.00135,1.00135,1.00135,1.00135,.90996,.92094,1.02798,.96752,.96752,.96752,.96752,.96752,.96752,.93136,.86304,.97278,.97278,.97278,.97278,1.02285,1.02285,1.02285,1.02285,.97122,.99041,1,1,1,1,1,1.28826,1.0008,.99041,.99041,.99041,.99041,.96752,1.01519,.96752,.97363,.96752,.97363,.96752,.97363,.96752,.8641,.86304,.8641,.86304,.8641,.86304,.8641,.86304,1.02096,1.03057,1.02096,1.03517,.79795,.97278,.79795,.97278,.79795,.97278,.79795,.97278,.79795,.97278,.914,1.01359,.914,1.01359,.914,1.01359,1,1,1.06085,.98561,1.06085,1.00879,1.1406,1.02285,1.1406,1.02285,1.1406,1.02285,1.1406,1.02285,1.1406,1.02285,.97138,1.08692,.8007,1.02285,1,1,1.00527,.83693,1.02285,1,1,.83693,.9455,.83693,.90418,.83693,1.13005,1.09398,.99041,1,1,1.09398,.99041,.96692,1.09251,.99041,.97489,1.0008,.97489,1.0008,.97489,1.0008,.93994,.97931,.90399,1.02258,1,1,.90399,1.02258,.84041,.79104,.84041,.79104,.84041,.79104,.84041,.79104,1,1,.95923,1.07034,.95923,1.16862,1.00135,.99041,1.00135,.99041,1.00135,.99041,1.00135,.99041,1.00135,.99041,1.00135,.99041,1.06467,1.02511,.90996,.96752,.90996,.99361,.95801,.99361,.95801,.99361,.95801,1.07733,1.03424,.97363,.96752,.93506,.93136,.97489,1.0008,1,1,.95923,1.16862,1.15103,1.15103,1.01173,1.03959,.75953,.81378,.79912,1.15103,1.21994,.95161,.87815,1.01149,.81525,.7676,.98167,1.01134,1.02546,.84097,1.03089,1.18102,.97363,.88776,.85134,.97826,.79795,.99361,1.06085,.97489,1.1406,.89858,1.0388,1.14889,1.09398,.86039,.97489,1.0595,.92094,.94793,.95923,.90996,.99346,.98243,1.02112,.95493,1.1406,.90996,1.03574,1.02597,1.0008,1.18102,1.06628,1.03574,1.0192,1.01932,1.00886,.97531,1.0106,1.0008,1.13189,1.18102,1.02277,.98683,1.0016,.99561,1.07237,1.0008,.90434,.99921,.93803,.8965,1.23085,1.06628,1.04983,.96268,1.0499,.98439,1.18102,1.06628,1.0008,1.06628,.98439,.79795,1,1,1,1,1,1,1,1,1,1,1,1,1.09466,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,.97278,1,1,1,1,1,1,1,1,1,1,1,1,1.02065,1,1,1,1,1,1,1.06467,1.02511,1.06467,1.02511,1.06467,1.02511,.90996,.96752,1,1.21408,.89903,1,1,.75155,1.04394,1.04394,1.04394,1.04394,.98633,.98633,.98633,.73047,.73047,1.20642,.91211,1.25635,1.222,1.02956,1.03372,1.03372,.96039,1.24633,1,1.12454,.93503,1.03424,1.19687,1.03424,1,1,1,.771,1,1,1.15749,1.15749,1.15749,1.10948,.86279,.94434,.86279,.94434,.86182,1,1,1.16897,1,.96085,.90137,1.2107,1.18416,1.13973,.69825,.9716,2.10339,1.29004,1.29004,1.21172,1.29004,1.29004,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1.42603,1,.99862,.99862,1,.87025,.87025,.87025,.87025,1.18874,1.42603,1,1.42603,1.42603,.99862,1,1,1,1,1,1.2886,1.04315,1.15296,1.34163,1,1,1,1.09193,1.09193,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],rG={lineHeight:1.33008,lineGap:0},aG=[1.76738,1,1,.98946,1.03959,1.04016,1.02809,1.036,.97639,1.10953,1.23203,1.11144,1.11144,1.16939,1.21237,.9754,1.21261,.9754,1.59754,1.036,1.036,1.036,1.036,1.036,1.036,1.036,1.036,1.036,1.036,.81378,.81378,1.21237,1.21237,1.21237,.73541,.97847,.97363,.89723,.87897,1.0426,.79429,.85292,.91149,1.05815,1.1406,.79631,.90128,.83853,1.04396,1.10615,.97552,.94436,.97552,.88641,.80527,.96083,1.00135,1,1.06777,.9817,.91142,.99361,1.11144,1.57293,1.11144,1.21237,.74627,1.31818,1.06585,.97042,.83055,.97042,.93503,1.1261,.97042,.97922,1.14236,.94552,1.01054,1.14236,1.02471,.97922,.94165,.97042,.97042,1.0276,.78929,1.1261,.97922,.95874,1.02197,.98507,.96752,.97168,.95107,1.16579,.95107,1.21237,1.03959,1.036,1.036,1,1.036,1.16579,.87357,1.31818,1.18754,1.26781,1.05356,1.21237,1.18622,.79487,.94994,1.29004,1.24047,1.24047,1.31818,1,.91484,.9754,1.31818,1.1349,1.24866,1.05356,1.13934,1.15574,1.17389,.73541,.97363,.97363,.97363,.97363,.97363,.97363,.94385,.87897,.79429,.79429,.79429,.79429,1.1406,1.1406,1.1406,1.1406,1.0426,1.10615,.97552,.97552,.97552,.97552,.97552,1.21237,.97552,1.00135,1.00135,1.00135,1.00135,.91142,.94436,.98721,1.06585,1.06585,1.06585,1.06585,1.06585,1.06585,.96705,.83055,.93503,.93503,.93503,.93503,1.14236,1.14236,1.14236,1.14236,.93125,.97922,.94165,.94165,.94165,.94165,.94165,1.29004,.94165,.97922,.97922,.97922,.97922,.96752,.97042,.96752,.97363,1.06585,.97363,1.06585,.97363,1.06585,.87897,.83055,.87897,.83055,.87897,.83055,.87897,.83055,1.0426,1.0033,1.0426,.97042,.79429,.93503,.79429,.93503,.79429,.93503,.79429,.93503,.79429,.93503,.91149,.97042,.91149,.97042,.91149,.97042,1,1,1.05815,.97922,1.05815,.97922,1.1406,1.14236,1.1406,1.14236,1.1406,1.14236,1.1406,1.14236,1.1406,1.14236,.97441,1.04302,.79631,1.01582,1,1,1.01054,.83853,1.14236,1,1,.83853,1.09125,.83853,.90418,.83853,1.19508,1.10615,.97922,1,1,1.10615,.97922,1.01034,1.10466,.97922,.97552,.94165,.97552,.94165,.97552,.94165,.91602,.91981,.88641,1.0276,1,1,.88641,1.0276,.80527,.78929,.80527,.78929,.80527,.78929,.80527,.78929,1,1,.96083,1.05403,.95923,1.16862,1.00135,.97922,1.00135,.97922,1.00135,.97922,1.00135,.97922,1.00135,.97922,1.00135,.97922,1.06777,1.02197,.91142,.96752,.91142,.99361,.97168,.99361,.97168,.99361,.97168,1.23199,1.036,.97363,1.06585,.94385,.96705,.97552,.94165,1,1,.96083,1.1261,1.31818,1.31818,1.31818,1.31818,1.31818,1.31818,1.31818,1.31818,1.31818,.95161,1.27126,1.00811,.83284,.77702,.99137,.95253,1.0347,.86142,1.07205,1.14236,.97363,.89723,.86869,1.09818,.79429,.99361,1.05815,.97552,1.1406,.90128,1.06662,1.04396,1.10615,.84918,.97552,1.04694,.94436,.98015,.96083,.91142,1.00356,.9817,1.01945,.98999,1.1406,.91142,1.04961,.9898,1.00639,1.14236,1.07514,1.04961,.99607,1.02897,1.008,.9898,.95134,1.00639,1.11121,1.14236,1.00518,.97981,1.02186,1,1.08578,.94165,.99314,.98387,.93028,.93377,1.35125,1.07514,1.10687,.93491,1.04232,1.00351,1.14236,1.07514,.94165,1.07514,1.00351,.79429,1,1,1,1,1,1,1,1,1,1,1,1,1.09097,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,.93503,1,1,1,1,1,1,1,1,1,1,1,1,.96609,1,1,1,1,1,1,1.06777,1.02197,1.06777,1.02197,1.06777,1.02197,.91142,.96752,1,1.21261,.89903,1,1,.75155,1.04745,1.04745,1.04745,1.04394,.98633,.98633,.98633,.72959,.72959,1.20502,.91406,1.26514,1.222,1.02956,1.03372,1.03372,.96039,1.24633,1,1.09125,.93327,1.03336,1.16541,1.036,1,1,1,.771,1,1,1.15574,1.15574,1.15574,1.15574,.86364,.94434,.86279,.94434,.86224,1,1,1.16798,1,.96085,.90068,1.21237,1.18416,1.13904,.69825,.9716,2.10339,1.29004,1.29004,1.21339,1.29004,1.29004,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1.42603,1,.99862,.99862,1,.87025,.87025,.87025,.87025,1.18775,1.42603,1,1.42603,1.42603,.99862,1,1,1,1,1,1.2886,1.04315,1.15296,1.34163,1,1,1,1.13269,1.13269,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],oG={lineHeight:1.33008,lineGap:0},lG=[1.76738,1,1,.98946,1.14763,1.05365,1.06234,.96927,.92586,1.15373,1.18414,.91349,.91349,1.07403,1.17308,.78383,1.20088,.78383,1.42531,.96927,.96927,.96927,.96927,.96927,.96927,.96927,.96927,.96927,.96927,.78383,.78383,1.17308,1.17308,1.17308,.77349,.94565,.94729,.85944,.88506,.9858,.74817,.80016,.88449,.98039,.95782,.69238,.89898,.83231,.98183,1.03989,.96924,.86237,.96924,.80595,.74524,.86091,.95402,.94143,.98448,.8858,.83089,.93285,1.0949,1.39016,1.0949,1.45994,.74627,1.04839,.97454,.97454,.87207,.97454,.87533,1.06151,.97454,1.00176,1.16484,1.08132,.98047,1.16484,1.02989,1.01054,.96225,.97454,.97454,1.06598,.79004,1.16344,1.00351,.94629,.9973,.91016,.96777,.9043,.91082,.92481,.91082,1.17308,.95748,.96927,.96927,1,.96927,.92481,.80597,1.04839,1.23393,1.1781,.9245,1.17308,1.20808,.63218,.94261,1.24822,1.09971,1.09971,1.04839,1,.85273,.78032,1.04839,1.09971,1.22326,.9245,1.09836,1.13525,1.15222,.70424,.94729,.94729,.94729,.94729,.94729,.94729,.85498,.88506,.74817,.74817,.74817,.74817,.95782,.95782,.95782,.95782,.9858,1.03989,.96924,.96924,.96924,.96924,.96924,1.17308,.96924,.95402,.95402,.95402,.95402,.83089,.86237,.88409,.97454,.97454,.97454,.97454,.97454,.97454,.92916,.87207,.87533,.87533,.87533,.87533,.93146,.93146,.93146,.93146,.93854,1.01054,.96225,.96225,.96225,.96225,.96225,1.24822,.8761,1.00351,1.00351,1.00351,1.00351,.96777,.97454,.96777,.94729,.97454,.94729,.97454,.94729,.97454,.88506,.87207,.88506,.87207,.88506,.87207,.88506,.87207,.9858,.95391,.9858,.97454,.74817,.87533,.74817,.87533,.74817,.87533,.74817,.87533,.74817,.87533,.88449,.97454,.88449,.97454,.88449,.97454,1,1,.98039,1.00176,.98039,1.00176,.95782,.93146,.95782,.93146,.95782,.93146,.95782,1.16484,.95782,.93146,.84421,1.12761,.69238,1.08132,1,1,.98047,.83231,1.16484,1,1,.84723,1.04861,.84723,.78755,.83231,1.23736,1.03989,1.01054,1,1,1.03989,1.01054,.9857,1.03849,1.01054,.96924,.96225,.96924,.96225,.96924,.96225,.92383,.90171,.80595,1.06598,1,1,.80595,1.06598,.74524,.79004,.74524,.79004,.74524,.79004,.74524,.79004,1,1,.86091,1.02759,.85771,1.16344,.95402,1.00351,.95402,1.00351,.95402,1.00351,.95402,1.00351,.95402,1.00351,.95402,1.00351,.98448,.9973,.83089,.96777,.83089,.93285,.9043,.93285,.9043,.93285,.9043,1.31868,.96927,.94729,.97454,.85498,.92916,.96924,.8761,1,1,.86091,1.16344,1.04839,1.04839,1.04839,1.04839,1.04839,1.04839,1.04839,1.04839,1.04839,.81965,.81965,.94729,.78032,.71022,.90883,.84171,.99877,.77596,1.05734,1.2,.94729,.85944,.82791,.9607,.74817,.93285,.98039,.96924,.95782,.89898,.98316,.98183,1.03989,.78614,.96924,.97642,.86237,.86075,.86091,.83089,.90082,.8858,.97296,1.01284,.95782,.83089,1.0976,1.04,1.03342,1.2,1.0675,1.0976,.98205,1.03809,1.05097,1.04,.95364,1.03342,1.05401,1.2,1.02148,1.0119,1.04724,1.0127,1.02732,.96225,.8965,.97783,.93574,.94818,1.30679,1.0675,1.11826,.99821,1.0557,1.0326,1.2,1.0675,.96225,1.0675,1.0326,.74817,1,1,1,1,1,1,1,1,1,1,1,1,1.03754,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,.87533,1,1,1,1,1,1,1,1,1,1,1,1,.98705,1,1,1,1,1,1,.98448,.9973,.98448,.9973,.98448,.9973,.83089,.96777,1,1.20088,.89903,1,1,.75155,.94945,.94945,.94945,.94945,1.12317,1.12317,1.12317,.67603,.67603,1.15621,.73584,1.21191,1.22135,1.06483,.94868,.94868,.95996,1.24633,1,1.07497,.87709,.96927,1.01473,.96927,1,1,1,.77295,1,1,1.09836,1.09836,1.09836,1.01522,.86321,.94434,.8649,.94434,.86182,1,1,1.083,1,.91578,.86438,1.17308,1.18416,1.14589,.69825,.97622,1.96791,1.24822,1.24822,1.17308,1.24822,1.24822,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1.42603,1,.99862,.99862,1,.87025,.87025,.87025,.87025,1.17984,1.42603,1,1.42603,1.42603,.99862,1,1,1,1,1,1.2886,1.04315,1.15296,1.34163,1,1,1,1.10742,1.10742,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],cG={lineHeight:1.33008,lineGap:0},hG=[1.76738,1,1,.98594,1.02285,1.10454,1.06234,.96927,.92037,1.19985,1.2046,.90616,.90616,1.07152,1.1714,.78032,1.20088,.78032,1.40246,.96927,.96927,.96927,.96927,.96927,.96927,.96927,.96927,.96927,.96927,.78032,.78032,1.1714,1.1714,1.1714,.80597,.94084,.96706,.85944,.85734,.97093,.75842,.79936,.88198,.9831,.95782,.71387,.86969,.84636,1.07796,1.03584,.96924,.83968,.96924,.82826,.79649,.85771,.95132,.93119,.98965,.88433,.8287,.93365,1.08612,1.3638,1.08612,1.45786,.74627,.80499,.91484,1.05707,.92383,1.05882,.9403,1.12654,1.05882,1.01756,1.09011,1.09011,.99414,1.09011,1.034,1.01756,1.05356,1.05707,1.05882,1.04399,.84863,1.21968,1.01756,.95801,1.00068,.91797,.96777,.9043,.90351,.92105,.90351,1.1714,.85337,.96927,.96927,.99912,.96927,.92105,.80597,1.2434,1.20808,1.05937,.90957,1.1714,1.20808,.75155,.94261,1.24644,1.09971,1.09971,.84751,1,.85273,.78032,.61584,1.05425,1.17914,.90957,1.08665,1.11593,1.14169,.73381,.96706,.96706,.96706,.96706,.96706,.96706,.86035,.85734,.75842,.75842,.75842,.75842,.95782,.95782,.95782,.95782,.97093,1.03584,.96924,.96924,.96924,.96924,.96924,1.1714,.96924,.95132,.95132,.95132,.95132,.8287,.83968,.89049,.91484,.91484,.91484,.91484,.91484,.91484,.93575,.92383,.9403,.9403,.9403,.9403,.8717,.8717,.8717,.8717,1.00527,1.01756,1.05356,1.05356,1.05356,1.05356,1.05356,1.24644,.95923,1.01756,1.01756,1.01756,1.01756,.96777,1.05707,.96777,.96706,.91484,.96706,.91484,.96706,.91484,.85734,.92383,.85734,.92383,.85734,.92383,.85734,.92383,.97093,1.0969,.97093,1.05882,.75842,.9403,.75842,.9403,.75842,.9403,.75842,.9403,.75842,.9403,.88198,1.05882,.88198,1.05882,.88198,1.05882,1,1,.9831,1.01756,.9831,1.01756,.95782,.8717,.95782,.8717,.95782,.8717,.95782,1.09011,.95782,.8717,.84784,1.11551,.71387,1.09011,1,1,.99414,.84636,1.09011,1,1,.84636,1.0536,.84636,.94298,.84636,1.23297,1.03584,1.01756,1,1,1.03584,1.01756,1.00323,1.03444,1.01756,.96924,1.05356,.96924,1.05356,.96924,1.05356,.93066,.98293,.82826,1.04399,1,1,.82826,1.04399,.79649,.84863,.79649,.84863,.79649,.84863,.79649,.84863,1,1,.85771,1.17318,.85771,1.21968,.95132,1.01756,.95132,1.01756,.95132,1.01756,.95132,1.01756,.95132,1.01756,.95132,1.01756,.98965,1.00068,.8287,.96777,.8287,.93365,.9043,.93365,.9043,.93365,.9043,1.08571,.96927,.96706,.91484,.86035,.93575,.96924,.95923,1,1,.85771,1.21968,1.11437,1.11437,.93109,.91202,.60411,.84164,.55572,1.01173,.97361,.81818,.81818,.96635,.78032,.72727,.92366,.98601,1.03405,.77968,1.09799,1.2,.96706,.85944,.85638,.96491,.75842,.93365,.9831,.96924,.95782,.86969,.94152,1.07796,1.03584,.78437,.96924,.98715,.83968,.83491,.85771,.8287,.94492,.88433,.9287,1.0098,.95782,.8287,1.0625,.98248,1.03424,1.2,1.01071,1.0625,.95246,1.03809,1.04912,.98248,1.00221,1.03424,1.05443,1.2,1.04785,.99609,1.00169,1.05176,.99346,1.05356,.9087,1.03004,.95542,.93117,1.23362,1.01071,1.07831,1.02512,1.05205,1.03502,1.2,1.01071,1.05356,1.01071,1.03502,.75842,1,1,1,1,1,1,1,1,1,1,1,1,1.03719,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,.9403,1,1,1,1,1,1,1,1,1,1,1,1,1.04021,1,1,1,1,1,1,.98965,1.00068,.98965,1.00068,.98965,1.00068,.8287,.96777,1,1.20088,.89903,1,1,.75155,1.03077,1.03077,1.03077,1.03077,1.13196,1.13196,1.13196,.67428,.67428,1.16039,.73291,1.20996,1.22135,1.06483,.94868,.94868,.95996,1.24633,1,1.07497,.87796,.96927,1.01518,.96927,1,1,1,.77295,1,1,1.10539,1.10539,1.11358,1.06967,.86279,.94434,.86279,.94434,.86182,1,1,1.083,1,.91578,.86507,1.1714,1.18416,1.14589,.69825,.97622,1.9697,1.24822,1.24822,1.17238,1.24822,1.24822,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1.42603,1,.99862,.99862,1,.87025,.87025,.87025,.87025,1.18083,1.42603,1,1.42603,1.42603,.99862,1,1,1,1,1,1.2886,1.04315,1.15296,1.34163,1,1,1,1.10938,1.10938,1,1,1,1.05425,1.09971,1.09971,1.09971,1,1,1,1,1,1,1,1,1,1,1],uG={lineHeight:1.33008,lineGap:0},dG=Ei(function(n){n["MyriadPro-Regular"]=n["PdfJS-Fallback-Regular"]={name:"LiberationSans-Regular",factors:nG,baseWidths:Gm,baseMapping:Vm,metrics:iG},n["MyriadPro-Bold"]=n["PdfJS-Fallback-Bold"]={name:"LiberationSans-Bold",factors:Jj,baseWidths:Lm,baseMapping:Bm,metrics:Zj},n["MyriadPro-It"]=n["MyriadPro-Italic"]=n["PdfJS-Fallback-Italic"]={name:"LiberationSans-Italic",factors:eG,baseWidths:zm,baseMapping:jm,metrics:tG},n["MyriadPro-BoldIt"]=n["MyriadPro-BoldItalic"]=n["PdfJS-Fallback-BoldItalic"]={name:"LiberationSans-BoldItalic",factors:Qj,baseWidths:Um,baseMapping:Hm,metrics:$j},n.ArialMT=n.Arial=n["Arial-Regular"]={name:"LiberationSans-Regular",baseWidths:Gm,baseMapping:Vm},n["Arial-BoldMT"]=n["Arial-Bold"]={name:"LiberationSans-Bold",baseWidths:Lm,baseMapping:Bm},n["Arial-ItalicMT"]=n["Arial-Italic"]={name:"LiberationSans-Italic",baseWidths:zm,baseMapping:jm},n["Arial-BoldItalicMT"]=n["Arial-BoldItalic"]={name:"LiberationSans-BoldItalic",baseWidths:Um,baseMapping:Hm},n["Calibri-Regular"]={name:"LiberationSans-Regular",factors:Hj,baseWidths:Gm,baseMapping:Vm,metrics:zj},n["Calibri-Bold"]={name:"LiberationSans-Bold",factors:Oj,baseWidths:Lm,baseMapping:Bm,metrics:Dj},n["Calibri-Italic"]={name:"LiberationSans-Italic",factors:Bj,baseWidths:zm,baseMapping:jm,metrics:Uj},n["Calibri-BoldItalic"]={name:"LiberationSans-BoldItalic",factors:Fj,baseWidths:Um,baseMapping:Hm,metrics:Lj},n["Segoeui-Regular"]={name:"LiberationSans-Regular",factors:hG,baseWidths:Gm,baseMapping:Vm,metrics:uG},n["Segoeui-Bold"]={name:"LiberationSans-Bold",factors:sG,baseWidths:Lm,baseMapping:Bm,metrics:rG},n["Segoeui-Italic"]={name:"LiberationSans-Italic",factors:lG,baseWidths:zm,baseMapping:jm,metrics:cG},n["Segoeui-BoldItalic"]={name:"LiberationSans-BoldItalic",factors:aG,baseWidths:Um,baseMapping:Hm,metrics:oG},n["Helvetica-Regular"]=n.Helvetica={name:"LiberationSans-Regular",factors:Xj,baseWidths:Gm,baseMapping:Vm,metrics:Yj},n["Helvetica-Bold"]={name:"LiberationSans-Bold",factors:jj,baseWidths:Lm,baseMapping:Bm,metrics:Gj},n["Helvetica-Italic"]={name:"LiberationSans-Italic",factors:Wj,baseWidths:zm,baseMapping:jm,metrics:Kj},n["Helvetica-BoldItalic"]={name:"LiberationSans-BoldItalic",factors:Vj,baseWidths:Um,baseMapping:Hm,metrics:qj}});function H4(n){const e=yx(n);return dG()[e]}function fG(n){const e=H4(n);if(!e)return null;const{baseWidths:t,baseMapping:i,factors:s}=e,r=s?t.map((c,h)=>c*s[h]):t;let a=-2,o;const l=[];for(const[c,h]of i.map((u,d)=>[u,d]).sort(([u],[d])=>u-d))c!==-1&&(c===a+1?(o.push(r[h]),a+=1):(a=c,o=[r[h]],l.push(c,o)));return l}function aM(n){const e=fG(n),t=new ue(null);t.set("BaseFont",ve.get(n)),t.set("Type",ve.get("Font")),t.set("Subtype",ve.get("CIDFontType2")),t.set("Encoding",ve.get("Identity-H")),t.set("CIDToGIDMap",ve.get("Identity")),t.set("W",e),t.set("FirstChar",e[0]),t.set("LastChar",e.at(-2)+e.at(-1).length-1);const i=new ue(null);t.set("FontDescriptor",i);const s=new ue(null);return s.set("Ordering","Identity"),s.set("Registry","Adobe"),s.set("Supplement",0),t.set("CIDSystemInfo",s),t}class gG{constructor(e){this.lexer=e,this.operators=[],this.token=null,this.prev=null}nextToken(){this.prev=this.token,this.token=this.lexer.getToken()}accept(e){return this.token.type===e?(this.nextToken(),!0):!1}expect(e){if(this.accept(e))return!0;throw new Te(`Unexpected symbol: found ${this.token.type} expected ${e}.`)}parse(){return this.nextToken(),this.expect(Tr.LBRACE),this.parseBlock(),this.expect(Tr.RBRACE),this.operators}parseBlock(){for(;;)if(this.accept(Tr.NUMBER))this.operators.push(this.prev.value);else if(this.accept(Tr.OPERATOR))this.operators.push(this.prev.value);else if(this.accept(Tr.LBRACE))this.parseCondition();else return}parseCondition(){const e=this.operators.length;if(this.operators.push(null,null),this.parseBlock(),this.expect(Tr.RBRACE),this.accept(Tr.IF))this.operators[e]=this.operators.length,this.operators[e+1]="jz";else if(this.accept(Tr.LBRACE)){const t=this.operators.length;this.operators.push(null,null);const i=this.operators.length;this.parseBlock(),this.expect(Tr.RBRACE),this.expect(Tr.IFELSE),this.operators[t]=this.operators.length,this.operators[t+1]="j",this.operators[e]=i,this.operators[e+1]="jz"}else throw new Te("PS Function: error parsing conditional.")}}const Tr={LBRACE:0,RBRACE:1,NUMBER:2,OPERATOR:3,IF:4,IFELSE:5};class qa{static get opCache(){return We(this,"opCache",Object.create(null))}constructor(e,t){this.type=e,this.value=t}static getOperator(e){var t;return(t=qa.opCache)[e]||(t[e]=new qa(Tr.OPERATOR,e))}static get LBRACE(){return We(this,"LBRACE",new qa(Tr.LBRACE,"{"))}static get RBRACE(){return We(this,"RBRACE",new qa(Tr.RBRACE,"}"))}static get IF(){return We(this,"IF",new qa(Tr.IF,"IF"))}static get IFELSE(){return We(this,"IFELSE",new qa(Tr.IFELSE,"IFELSE"))}}class mG{constructor(e){this.stream=e,this.nextChar(),this.strBuf=[]}nextChar(){return this.currentChar=this.stream.getByte()}getToken(){let e=!1,t=this.currentChar;for(;;){if(t<0)return Gs;if(e)(t===10||t===13)&&(e=!1);else if(t===37)e=!0;else if(!Za(t))break;t=this.nextChar()}switch(t|0){case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:case 43:case 45:case 46:return new qa(Tr.NUMBER,this.getNumber());case 123:return this.nextChar(),qa.LBRACE;case 125:return this.nextChar(),qa.RBRACE}const i=this.strBuf;for(i.length=0,i[0]=String.fromCharCode(t);(t=this.nextChar())>=0&&(t>=65&&t<=90||t>=97&&t<=122);)i.push(String.fromCharCode(t));const s=i.join("");switch(s.toLowerCase()){case"if":return qa.IF;case"ifelse":return qa.IFELSE;default:return qa.getOperator(s)}}getNumber(){let e=this.currentChar;const t=this.strBuf;for(t.length=0,t[0]=String.fromCharCode(e);(e=this.nextChar())>=0&&(e>=48&&e<=57||e===45||e===46);)t.push(String.fromCharCode(e));const i=parseFloat(t.join(""));if(isNaN(i))throw new Te(`Invalid floating point number: ${i}`);return i}}class mf{constructor(e){this._onlyRefs=(e==null?void 0:e.onlyRefs)===!0,this._onlyRefs||(this._nameRefMap=new Map,this._imageMap=new Map),this._imageCache=new ma}getByName(e){this._onlyRefs&&Cn("Should not call `getByName` method.");const t=this._nameRefMap.get(e);return t?this.getByRef(t):this._imageMap.get(e)||null}getByRef(e){return this._imageCache.get(e)||null}set(e,t,i){Cn("Abstract method `set` called.")}}class Gk extends mf{set(e,t=null,i){if(typeof e!="string")throw new Error('LocalImageCache.set - expected "name" argument.');if(t){if(this._imageCache.has(t))return;this._nameRefMap.set(e,t),this._imageCache.put(t,i);return}this._imageMap.has(e)||this._imageMap.set(e,i)}}class oM extends mf{set(e=null,t=null,i){if(typeof e!="string"&&!t)throw new Error('LocalColorSpaceCache.set - expected "name" and/or "ref" argument.');if(t){if(this._imageCache.has(t))return;e!==null&&this._nameRefMap.set(e,t),this._imageCache.put(t,i);return}this._imageMap.has(e)||this._imageMap.set(e,i)}}class pG extends mf{constructor(e){super({onlyRefs:!0})}set(e=null,t,i){if(!t)throw new Error('LocalFunctionCache.set - expected "ref" argument.');this._imageCache.has(t)||this._imageCache.put(t,i)}}class Vk extends mf{set(e,t=null,i){if(typeof e!="string")throw new Error('LocalGStateCache.set - expected "name" argument.');if(t){if(this._imageCache.has(t))return;this._nameRefMap.set(e,t),this._imageCache.put(t,i);return}this._imageMap.has(e)||this._imageMap.set(e,i)}}class bG extends mf{constructor(e){super({onlyRefs:!0})}set(e=null,t,i){if(!t)throw new Error('LocalTilingPatternCache.set - expected "ref" argument.');this._imageCache.has(t)||this._imageCache.put(t,i)}}class xG extends mf{constructor(e){super({onlyRefs:!0})}set(e=null,t,i){if(!t)throw new Error('RegionalImageCache.set - expected "ref" argument.');this._imageCache.has(t)||this._imageCache.put(t,i)}}class yG extends mf{constructor(e){super({onlyRefs:!0})}set(e=null,t,i){if(!t)throw new Error('GlobalColorSpaceCache.set - expected "ref" argument.');this._imageCache.has(t)||this._imageCache.put(t,i)}clear(){this._imageCache.clear()}}var Ig,df,lM,r6;const Sc=class Sc{constructor(){U(this,df);U(this,Ig,new ts);this._refCache=new ma,this._imageCache=new ma}shouldCache(e,t){let i=this._refCache.get(e);return i||(i=new Set,this._refCache.put(e,i)),i.add(t),!(i.size<Sc.NUM_PAGES_THRESHOLD||!this._imageCache.has(e)&&x(this,df,r6))}addDecodeFailed(e){x(this,Ig).put(e)}hasDecodeFailed(e){return x(this,Ig).has(e)}addByteSize(e,t){const i=this._imageCache.get(e);i&&(i.byteSize||(i.byteSize=t))}getData(e,t){const i=this._refCache.get(e);if(!i||i.size<Sc.NUM_PAGES_THRESHOLD)return null;const s=this._imageCache.get(e);return s?(i.add(t),s):null}setData(e,t){if(!this._refCache.has(e))throw new Error('GlobalImageCache.setData - expected "shouldCache" to have been called.');if(!this._imageCache.has(e)){if(x(this,df,r6)){ae("GlobalImageCache.setData - cache limit reached.");return}this._imageCache.put(e,t)}}clear(e=!1){e||(x(this,Ig).clear(),this._refCache.clear()),this._imageCache.clear()}};Ig=new WeakMap,df=new WeakSet,lM=function(){let e=0;for(const t of this._imageCache)e+=t.byteSize;return e},r6=function(){return!(this._imageCache.size<Sc.MIN_IMAGES_TO_CACHE||x(this,df,lM)<Sc.MAX_BYTE_SIZE)},Ue(Sc,"NUM_PAGES_THRESHOLD",2),Ue(Sc,"MIN_IMAGES_TO_CACHE",10),Ue(Sc,"MAX_BYTE_SIZE",5e7);let s6=Sc;class cM{constructor({xref:e,isEvalSupported:t=!0}){this.xref=e,this.isEvalSupported=t!==!1}create(e,t=!1){var a;let i,s;if(e instanceof tt?i=e:e instanceof ue?i=e.objId:e instanceof dn&&(i=(a=e.dict)==null?void 0:a.objId),i){const o=this._localFunctionCache.getByRef(i);if(o)return o}const r=this.xref.fetchIfRef(e);if(Array.isArray(r)){if(!t)throw new Error('PDFFunctionFactory.create - expected "parseArray" argument.');s=qk.parseArray(this,r)}else s=qk.parse(this,r);return i&&this._localFunctionCache.set(null,i,s),s}get _localFunctionCache(){return We(this,"_localFunctionCache",new pG)}}function so(n){return Array.isArray(n)?Yr(n,null)?n:n.map(e=>+e):null}class qk{static getSampleArray(e,t,i,s){let r,a,o=1;for(r=0,a=e.length;r<a;r++)o*=e[r];o*=t;const l=new Array(o);let c=0,h=0;const u=1/(2**i-1),d=s.getBytes((o*i+7)/8);let f=0;for(r=0;r<o;r++){for(;c<i;)h<<=8,h|=d[f++],c+=8;c-=i,l[r]=(h>>c)*u,h&=(1<<c)-1}return l}static parse(e,t){const i=t.dict||t;switch(i.get("FunctionType")){case 0:return this.constructSampled(e,t,i);case 1:break;case 2:return this.constructInterpolated(e,i);case 3:return this.constructStiched(e,i);case 4:return this.constructPostScript(e,t,i)}throw new Te("Unknown type of function")}static parseArray(e,t){const{xref:i}=e,s=[];for(const r of t)s.push(this.parse(e,i.fetchIfRef(r)));return function(r,a,o,l){for(let c=0,h=s.length;c<h;c++)s[c](r,a,o,l+c)}}static constructSampled(e,t,i){function s(b){const p=b.length,y=[];let w=0;for(let _=0;_<p;_+=2)y[w++]=[b[_],b[_+1]];return y}function r(b,p,y,w,_){return w+(b-p)*((_-w)/(y-p))}let a=so(i.getArray("Domain")),o=so(i.getArray("Range"));if(!a||!o)throw new Te("No domain or range");const l=a.length/2,c=o.length/2;a=s(a),o=s(o);const h=so(i.getArray("Size")),u=i.get("BitsPerSample"),d=i.get("Order")||1;d!==1&&gn("No support for cubic spline interpolation: "+d);let f=so(i.getArray("Encode"));if(f)f=s(f);else{f=[];for(let b=0;b<l;++b)f.push([0,h[b]-1])}let g=so(i.getArray("Decode"));g=g?s(g):o;const m=this.getSampleArray(h,c,u,t);return function(p,y,w,_){const v=1<<l,C=new Float64Array(v).fill(1),k=new Uint32Array(v);let I,E,T=c,M=1;for(I=0;I<l;++I){const D=a[I][0],H=a[I][1],R=Ws(p[y+I],D,H);let z=r(R,D,H,f[I][0],f[I][1]);const P=h[I];z=Ws(z,0,P-1);const B=z<P-1?Math.floor(z):z-1,Z=B+1-z,G=z-B,Y=B*T,J=Y+T;for(E=0;E<v;E++)E&M?(C[E]*=G,k[E]+=J):(C[E]*=Z,k[E]+=Y);T*=P,M<<=1}for(E=0;E<c;++E){let D=0;for(I=0;I<v;I++)D+=m[k[I]+E]*C[I];D=r(D,0,1,g[E][0],g[E][1]),w[_+E]=Ws(D,o[E][0],o[E][1])}}}static constructInterpolated(e,t){const i=so(t.getArray("C0"))||[0],s=so(t.getArray("C1"))||[1],r=t.get("N"),a=[];for(let l=0,c=i.length;l<c;++l)a.push(s[l]-i[l]);const o=a.length;return function(c,h,u,d){const f=r===1?c[h]:c[h]**r;for(let g=0;g<o;++g)u[d+g]=i[g]+f*a[g]}}static constructStiched(e,t){const i=so(t.getArray("Domain"));if(!i)throw new Te("No domain");if(i.length/2!==1)throw new Te("Bad domain for stiched function");const{xref:r}=e,a=[];for(const h of t.get("Functions"))a.push(this.parse(e,r.fetchIfRef(h)));const o=so(t.getArray("Bounds")),l=so(t.getArray("Encode")),c=new Float32Array(1);return function(u,d,f,g){const m=Ws(u[d],i[0],i[1]),b=o.length;let p;for(p=0;p<b&&!(m<o[p]);++p);let y=i[0];p>0&&(y=o[p-1]);let w=i[1];p<o.length&&(w=o[p]);const _=l[2*p],v=l[2*p+1];c[0]=y===w?_:_+(m-y)*(v-_)/(w-y),a[p](c,0,f,g)}}static constructPostScript(e,t,i){const s=so(i.getArray("Domain")),r=so(i.getArray("Range"));if(!s)throw new Te("No domain.");if(!r)throw new Te("No range.");const a=new mG(t),l=new gG(a).parse();if(e.isEvalSupported&&ya.isEvalSupported){const b=new IG().compile(l,s,r);if(b)return new Function("src","srcOffset","dest","destOffset",b)}gn("Unable to compile PS function");const c=r.length>>1,h=s.length>>1,u=new wG(l),d=Object.create(null);let g=2048*4;const m=new Float32Array(h);return function(p,y,w,_){let v,C,k="";const I=m;for(v=0;v<h;v++)C=p[y+v],I[v]=C,k+=C+"_";const E=d[k];if(E!==void 0){w.set(E,_);return}const T=new Float32Array(c),M=u.execute(I),D=M.length-c;for(v=0;v<c;v++){C=M[D+v];let H=r[v*2];C<H?C=H:(H=r[v*2+1],C>H&&(C=H)),T[v]=C}g>0&&(g--,d[k]=T),w.set(T,_)}}}function Ow(n){let e;if(n instanceof ue)e=n;else if(n instanceof dn)e=n.dict;else return!1;return e.has("FunctionType")}const Op=class Op{constructor(e){this.stack=e?Array.from(e):[]}push(e){if(this.stack.length>=Op.MAX_STACK_SIZE)throw new Error("PostScript function stack overflow.");this.stack.push(e)}pop(){if(this.stack.length<=0)throw new Error("PostScript function stack underflow.");return this.stack.pop()}copy(e){if(this.stack.length+e>=Op.MAX_STACK_SIZE)throw new Error("PostScript function stack overflow.");const t=this.stack;for(let i=t.length-e,s=e-1;s>=0;s--,i++)t.push(t[i])}index(e){this.push(this.stack[this.stack.length-e-1])}roll(e,t){const i=this.stack,s=i.length-e,r=i.length-1,a=s+(t-Math.floor(t/e)*e);for(let o=s,l=r;o<l;o++,l--){const c=i[o];i[o]=i[l],i[l]=c}for(let o=s,l=a-1;o<l;o++,l--){const c=i[o];i[o]=i[l],i[l]=c}for(let o=a,l=r;o<l;o++,l--){const c=i[o];i[o]=i[l],i[l]=c}}};Ue(Op,"MAX_STACK_SIZE",100);let a6=Op;class wG{constructor(e){this.operators=e}execute(e){const t=new a6(e);let i=0;const s=this.operators,r=s.length;let a,o,l;for(;i<r;){if(a=s[i++],typeof a=="number"){t.push(a);continue}switch(a){case"jz":l=t.pop(),o=t.pop(),o||(i=l);break;case"j":o=t.pop(),i=o;break;case"abs":o=t.pop(),t.push(Math.abs(o));break;case"add":l=t.pop(),o=t.pop(),t.push(o+l);break;case"and":l=t.pop(),o=t.pop(),typeof o=="boolean"&&typeof l=="boolean"?t.push(o&&l):t.push(o&l);break;case"atan":l=t.pop(),o=t.pop(),o=Math.atan2(o,l)/Math.PI*180,o<0&&(o+=360),t.push(o);break;case"bitshift":l=t.pop(),o=t.pop(),o>0?t.push(o<<l):t.push(o>>l);break;case"ceiling":o=t.pop(),t.push(Math.ceil(o));break;case"copy":o=t.pop(),t.copy(o);break;case"cos":o=t.pop(),t.push(Math.cos(o%360/180*Math.PI));break;case"cvi":o=t.pop()|0,t.push(o);break;case"cvr":break;case"div":l=t.pop(),o=t.pop(),t.push(o/l);break;case"dup":t.copy(1);break;case"eq":l=t.pop(),o=t.pop(),t.push(o===l);break;case"exch":t.roll(2,1);break;case"exp":l=t.pop(),o=t.pop(),t.push(o**l);break;case"false":t.push(!1);break;case"floor":o=t.pop(),t.push(Math.floor(o));break;case"ge":l=t.pop(),o=t.pop(),t.push(o>=l);break;case"gt":l=t.pop(),o=t.pop(),t.push(o>l);break;case"idiv":l=t.pop(),o=t.pop(),t.push(o/l|0);break;case"index":o=t.pop(),t.index(o);break;case"le":l=t.pop(),o=t.pop(),t.push(o<=l);break;case"ln":o=t.pop(),t.push(Math.log(o));break;case"log":o=t.pop(),t.push(Math.log10(o));break;case"lt":l=t.pop(),o=t.pop(),t.push(o<l);break;case"mod":l=t.pop(),o=t.pop(),t.push(o%l);break;case"mul":l=t.pop(),o=t.pop(),t.push(o*l);break;case"ne":l=t.pop(),o=t.pop(),t.push(o!==l);break;case"neg":o=t.pop(),t.push(-o);break;case"not":o=t.pop(),typeof o=="boolean"?t.push(!o):t.push(~o);break;case"or":l=t.pop(),o=t.pop(),typeof o=="boolean"&&typeof l=="boolean"?t.push(o||l):t.push(o|l);break;case"pop":t.pop();break;case"roll":l=t.pop(),o=t.pop(),t.roll(o,l);break;case"round":o=t.pop(),t.push(Math.round(o));break;case"sin":o=t.pop(),t.push(Math.sin(o%360/180*Math.PI));break;case"sqrt":o=t.pop(),t.push(Math.sqrt(o));break;case"sub":l=t.pop(),o=t.pop(),t.push(o-l);break;case"true":t.push(!0);break;case"truncate":o=t.pop(),o=o<0?Math.ceil(o):Math.floor(o),t.push(o);break;case"xor":l=t.pop(),o=t.pop(),typeof o=="boolean"&&typeof l=="boolean"?t.push(o!==l):t.push(o^l);break;default:throw new Te(`Unknown operator ${a}`)}}return t.stack}}class tm{constructor(e){this.type=e}visit(e){Cn("abstract method")}}class _G extends tm{constructor(e,t,i){super("args"),this.index=e,this.min=t,this.max=i}visit(e){e.visitArgument(this)}}class qd extends tm{constructor(e){super("literal"),this.number=e,this.min=e,this.max=e}visit(e){e.visitLiteral(this)}}class z4 extends tm{constructor(e,t,i,s,r){super("binary"),this.op=e,this.arg1=t,this.arg2=i,this.min=s,this.max=r}visit(e){e.visitBinaryOperation(this)}}class vG extends tm{constructor(e,t){super("max"),this.arg=e,this.min=e.min,this.max=t}visit(e){e.visitMin(this)}}class Wk extends tm{constructor(e,t,i){super("var"),this.index=e,this.min=t,this.max=i}visit(e){e.visitVariable(this)}}class Kk extends tm{constructor(e,t){super("definition"),this.variable=e,this.arg=t}visit(e){e.visitVariableDefinition(this)}}class Xk{constructor(){this.parts=[]}visitArgument(e){this.parts.push("Math.max(",e.min,", Math.min(",e.max,", src[srcOffset + ",e.index,"]))")}visitVariable(e){this.parts.push("v",e.index)}visitLiteral(e){this.parts.push(e.number)}visitBinaryOperation(e){this.parts.push("("),e.arg1.visit(this),this.parts.push(" ",e.op," "),e.arg2.visit(this),this.parts.push(")")}visitVariableDefinition(e){this.parts.push("var "),e.variable.visit(this),this.parts.push(" = "),e.arg.visit(this),this.parts.push(";")}visitMin(e){this.parts.push("Math.min("),e.arg.visit(this),this.parts.push(", ",e.max,")")}toString(){return this.parts.join("")}}function kG(n,e){return e.type==="literal"&&e.number===0?n:n.type==="literal"&&n.number===0?e:e.type==="literal"&&n.type==="literal"?new qd(n.number+e.number):new z4("+",n,e,n.min+e.min,n.max+e.max)}function CG(n,e){if(e.type==="literal"){if(e.number===0)return new qd(0);if(e.number===1)return n;if(n.type==="literal")return new qd(n.number*e.number)}if(n.type==="literal"){if(n.number===0)return new qd(0);if(n.number===1)return e}const t=Math.min(n.min*e.min,n.min*e.max,n.max*e.min,n.max*e.max),i=Math.max(n.min*e.min,n.min*e.max,n.max*e.min,n.max*e.max);return new z4("*",n,e,t,i)}function AG(n,e){if(e.type==="literal"){if(e.number===0)return n;if(n.type==="literal")return new qd(n.number-e.number)}return e.type==="binary"&&e.op==="-"&&n.type==="literal"&&n.number===1&&e.arg1.type==="literal"&&e.arg1.number===1?e.arg2:new z4("-",n,e,n.min-e.max,n.max-e.min)}function SG(n,e){return n.min>=e?new qd(e):n.max<=e?n:new vG(n,e)}class IG{compile(e,t,i){const s=[],r=[],a=t.length>>1,o=i.length>>1;let l=0,c,h,u,d,f,g,m,b;for(let y=0;y<a;y++)s.push(new _G(y,t[y*2],t[y*2+1]));for(let y=0,w=e.length;y<w;y++){if(b=e[y],typeof b=="number"){s.push(new qd(b));continue}switch(b){case"add":if(s.length<2)return null;d=s.pop(),u=s.pop(),s.push(kG(u,d));break;case"cvr":if(s.length<1)return null;break;case"mul":if(s.length<2)return null;d=s.pop(),u=s.pop(),s.push(CG(u,d));break;case"sub":if(s.length<2)return null;d=s.pop(),u=s.pop(),s.push(AG(u,d));break;case"exch":if(s.length<2)return null;f=s.pop(),g=s.pop(),s.push(f,g);break;case"pop":if(s.length<1)return null;s.pop();break;case"index":if(s.length<1||(u=s.pop(),u.type!=="literal")||(c=u.number,c<0||!Number.isInteger(c)||s.length<c))return null;if(f=s[s.length-c-1],f.type==="literal"||f.type==="var"){s.push(f);break}m=new Wk(l++,f.min,f.max),s[s.length-c-1]=m,s.push(m),r.push(new Kk(m,f));break;case"dup":if(s.length<1)return null;if(typeof e[y+1]=="number"&&e[y+2]==="gt"&&e[y+3]===y+7&&e[y+4]==="jz"&&e[y+5]==="pop"&&e[y+6]===e[y+1]){u=s.pop(),s.push(SG(u,e[y+1])),y+=6;break}if(f=s.at(-1),f.type==="literal"||f.type==="var"){s.push(f);break}m=new Wk(l++,f.min,f.max),s[s.length-1]=m,s.push(m),r.push(new Kk(m,f));break;case"roll":if(s.length<2||(d=s.pop(),u=s.pop(),d.type!=="literal"||u.type!=="literal")||(h=d.number,c=u.number,c<=0||!Number.isInteger(c)||!Number.isInteger(h)||s.length<c))return null;if(h=(h%c+c)%c,h===0)break;s.push(...s.splice(s.length-c,c-h));break;default:return null}}if(s.length!==o)return null;const p=[];for(const y of r){const w=new Xk;y.visit(w),p.push(w.toString())}for(let y=0,w=s.length;y<w;y++){const _=s[y],v=new Xk;_.visit(v);const C=i[y*2],k=i[y*2+1],I=[v.toString()];C>_.min&&(I.unshift("Math.max(",C,", "),I.push(")")),k<_.max&&(I.unshift("Math.min(",k,", "),I.push(")")),I.unshift("dest[destOffset + ",y,"] = "),I.push(";"),p.push(I.join(""))}return p.join(`
`)}}const EG=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","ON","ON","ET","ET","ET","ON","ON","ON","ON","ON","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","ON","ON","ON","ON","ON","ON","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","ON","ON","ON","ON","ON","ON","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","ON","ON","ON","ON","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","ON","ET","ET","ET","ET","ON","ON","ON","ON","L","ON","ON","BN","ON","ON","ET","ET","EN","EN","ON","L","ON","ON","ON","EN","L","ON","ON","ON","ON","ON","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","ON","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","ON","L","L","L","L","L","L","L","L"],TG=["AN","AN","AN","AN","AN","AN","ON","ON","AL","ET","ET","AL","CS","AL","ON","ON","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","ON","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","ON","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL"];function Yk(n){return(n&1)!==0}function RG(n){return(n&1)===0}function MG(n,e,t){let i,s;for(i=e,s=n.length;i<s;++i)if(n[i]!==t)return i;return i}function Jk(n,e,t){for(let i=e,s=t-1;i<s;++i,--s){const r=n[i];n[i]=n[s],n[s]=r}}function Dw(n,e,t=!1){let i="ltr";return t?i="ttb":e||(i="rtl"),{str:n,dir:i}}const P0=[],Hn=[];function hM(n,e=-1,t=!1){let i=!0;const s=n.length;if(s===0||t)return Dw(n,i,t);P0.length=s,Hn.length=s;let r=0,a,o;for(a=0;a<s;++a){P0[a]=n.charAt(a);const p=n.charCodeAt(a);let y="L";p<=255?y=EG[p]:1424<=p&&p<=1524?y="R":1536<=p&&p<=1791?(y=TG[p&255],y||ae("Bidi: invalid Unicode character "+p.toString(16))):(1792<=p&&p<=2220||64336<=p&&p<=65023||65136<=p&&p<=65279)&&(y="AL"),(y==="R"||y==="AL"||y==="AN")&&r++,Hn[a]=y}if(r===0)return i=!0,Dw(n,i);e===-1&&(r/s<.3&&s>4?(i=!0,e=0):(i=!1,e=1));const l=[];for(a=0;a<s;++a)l[a]=e;const c=Yk(e)?"R":"L",h=c,u=h;let d=h;for(a=0;a<s;++a)Hn[a]==="NSM"?Hn[a]=d:d=Hn[a];d=h;let f;for(a=0;a<s;++a)f=Hn[a],f==="EN"?Hn[a]=d==="AL"?"AN":"EN":(f==="R"||f==="L"||f==="AL")&&(d=f);for(a=0;a<s;++a)f=Hn[a],f==="AL"&&(Hn[a]="R");for(a=1;a<s-1;++a)Hn[a]==="ES"&&Hn[a-1]==="EN"&&Hn[a+1]==="EN"&&(Hn[a]="EN"),Hn[a]==="CS"&&(Hn[a-1]==="EN"||Hn[a-1]==="AN")&&Hn[a+1]===Hn[a-1]&&(Hn[a]=Hn[a-1]);for(a=0;a<s;++a)if(Hn[a]==="EN"){for(let p=a-1;p>=0&&Hn[p]==="ET";--p)Hn[p]="EN";for(let p=a+1;p<s&&Hn[p]==="ET";++p)Hn[p]="EN"}for(a=0;a<s;++a)f=Hn[a],(f==="WS"||f==="ES"||f==="ET"||f==="CS")&&(Hn[a]="ON");for(d=h,a=0;a<s;++a)f=Hn[a],f==="EN"?Hn[a]=d==="L"?"L":"EN":(f==="R"||f==="L")&&(d=f);for(a=0;a<s;++a)if(Hn[a]==="ON"){const p=MG(Hn,a+1,"ON");let y=h;a>0&&(y=Hn[a-1]);let w=u;p+1<s&&(w=Hn[p+1]),y!=="L"&&(y="R"),w!=="L"&&(w="R"),y===w&&Hn.fill(y,a,p),a=p-1}for(a=0;a<s;++a)Hn[a]==="ON"&&(Hn[a]=c);for(a=0;a<s;++a)f=Hn[a],RG(l[a])?f==="R"?l[a]+=1:(f==="AN"||f==="EN")&&(l[a]+=2):(f==="L"||f==="AN"||f==="EN")&&(l[a]+=1);let g=-1,m=99,b;for(a=0,o=l.length;a<o;++a)b=l[a],g<b&&(g=b),m>b&&Yk(b)&&(m=b);for(b=g;b>=m;--b){let p=-1;for(a=0,o=l.length;a<o;++a)l[a]<b?p>=0&&(Jk(P0,p,a),p=-1):p<0&&(p=a);p>=0&&Jk(P0,p,l.length)}for(a=0,o=P0.length;a<o;++a){const p=P0[a];(p==="<"||p===">")&&(P0[a]="")}return Dw(P0.join(""),i)}const mu={style:"normal",weight:"normal"},yu={style:"normal",weight:"bold"},wu={style:"italic",weight:"normal"},_u={style:"italic",weight:"bold"},vp=new Map([["Times-Roman",{local:["Times New Roman","Times-Roman","Times","Liberation Serif","Nimbus Roman","Nimbus Roman L","Tinos","Thorndale","TeX Gyre Termes","FreeSerif","Linux Libertine O","Libertinus Serif","DejaVu Serif","Bitstream Vera Serif","Ubuntu"],style:mu,ultimate:"serif"}],["Times-Bold",{alias:"Times-Roman",style:yu,ultimate:"serif"}],["Times-Italic",{alias:"Times-Roman",style:wu,ultimate:"serif"}],["Times-BoldItalic",{alias:"Times-Roman",style:_u,ultimate:"serif"}],["Helvetica",{local:["Helvetica","Helvetica Neue","Arial","Arial Nova","Liberation Sans","Arimo","Nimbus Sans","Nimbus Sans L","A030","TeX Gyre Heros","FreeSans","DejaVu Sans","Albany","Bitstream Vera Sans","Arial Unicode MS","Microsoft Sans Serif","Apple Symbols","Cantarell"],path:"LiberationSans-Regular.ttf",style:mu,ultimate:"sans-serif"}],["Helvetica-Bold",{alias:"Helvetica",path:"LiberationSans-Bold.ttf",style:yu,ultimate:"sans-serif"}],["Helvetica-Oblique",{alias:"Helvetica",path:"LiberationSans-Italic.ttf",style:wu,ultimate:"sans-serif"}],["Helvetica-BoldOblique",{alias:"Helvetica",path:"LiberationSans-BoldItalic.ttf",style:_u,ultimate:"sans-serif"}],["Courier",{local:["Courier","Courier New","Liberation Mono","Nimbus Mono","Nimbus Mono L","Cousine","Cumberland","TeX Gyre Cursor","FreeMono","Linux Libertine Mono O","Libertinus Mono"],style:mu,ultimate:"monospace"}],["Courier-Bold",{alias:"Courier",style:yu,ultimate:"monospace"}],["Courier-Oblique",{alias:"Courier",style:wu,ultimate:"monospace"}],["Courier-BoldOblique",{alias:"Courier",style:_u,ultimate:"monospace"}],["ArialBlack",{local:["Arial Black"],style:{style:"normal",weight:"900"},fallback:"Helvetica-Bold"}],["ArialBlack-Bold",{alias:"ArialBlack"}],["ArialBlack-Italic",{alias:"ArialBlack",style:{style:"italic",weight:"900"},fallback:"Helvetica-BoldOblique"}],["ArialBlack-BoldItalic",{alias:"ArialBlack-Italic"}],["ArialNarrow",{local:["Arial Narrow","Liberation Sans Narrow","Helvetica Condensed","Nimbus Sans Narrow","TeX Gyre Heros Cn"],style:mu,fallback:"Helvetica"}],["ArialNarrow-Bold",{alias:"ArialNarrow",style:yu,fallback:"Helvetica-Bold"}],["ArialNarrow-Italic",{alias:"ArialNarrow",style:wu,fallback:"Helvetica-Oblique"}],["ArialNarrow-BoldItalic",{alias:"ArialNarrow",style:_u,fallback:"Helvetica-BoldOblique"}],["Calibri",{local:["Calibri","Carlito"],style:mu,fallback:"Helvetica"}],["Calibri-Bold",{alias:"Calibri",style:yu,fallback:"Helvetica-Bold"}],["Calibri-Italic",{alias:"Calibri",style:wu,fallback:"Helvetica-Oblique"}],["Calibri-BoldItalic",{alias:"Calibri",style:_u,fallback:"Helvetica-BoldOblique"}],["Wingdings",{local:["Wingdings","URW Dingbats"],style:mu}],["Wingdings-Regular",{alias:"Wingdings"}],["Wingdings-Bold",{alias:"Wingdings"}]]),PG=new Map([["Arial-Black","ArialBlack"]]);function NG(n){switch(n){case yu:return"Bold";case wu:return"Italic";case _u:return"Bold Italic";default:if((n==null?void 0:n.weight)==="bold")return"Bold";if((n==null?void 0:n.style)==="italic")return"Italic"}return""}function Zk(n){const e=new Set(["thin","extralight","ultralight","demilight","semilight","light","book","regular","normal","medium","demibold","semibold","bold","extrabold","ultrabold","black","heavy","extrablack","ultrablack","roman","italic","oblique","ultracondensed","extracondensed","condensed","semicondensed","normal","semiexpanded","expanded","extraexpanded","ultraexpanded","bolditalic"]);return n.split(/[- ,+]+/g).filter(t=>!e.has(t.toLowerCase())).join(" ")}function o6({alias:n,local:e,path:t,fallback:i,style:s,ultimate:r},a,o,l=!0,c=!0,h=""){const u={style:null,ultimate:null};if(e){const d=h?` ${h}`:"";for(const f of e)a.push(`local(${f}${d})`)}if(n){const d=vp.get(n),f=h||NG(s);Object.assign(u,o6(d,a,o,l&&!i,c&&!t,f))}if(s&&(u.style=s),r&&(u.ultimate=r),l&&i){const d=vp.get(i),{ultimate:f}=o6(d,a,o,l,c&&!t,h);u.ultimate||(u.ultimate=f)}return c&&t&&o&&a.push(`url(${o}${t})`),u}function Qk(n,e,t,i,s,r){if(i.startsWith("InvalidPDFjsFont_"))return null;(r==="TrueType"||r==="Type1")&&/^[A-Z]{6}\+/.test(i)&&(i=i.slice(7)),i=yx(i);const a=i;let o=n.get(a);if(o)return o;let l=vp.get(i);if(!l){for(const[b,p]of PG)if(i.startsWith(b)){i=`${p}${i.substring(b.length)}`,l=vp.get(i);break}}let c=!1;l||(l=vp.get(s),c=!0);const h=`${e.getDocId()}_s${e.createFontId()}`;if(!l){if(!L7(i))return ae(`Cannot substitute the font because of its name: ${i}`),n.set(a,null),null;const b=/bold/gi.test(i),p=/oblique|italic/gi.test(i),y=b&&p&&_u||b&&yu||p&&wu||mu;return o={css:`"${Zk(i)}",${h}`,guessFallback:!0,loadedName:h,baseFontName:i,src:`local(${i})`,style:y},n.set(a,o),o}const u=[];c&&L7(i)&&u.push(`local(${i})`);const{style:d,ultimate:f}=o6(l,u,t),g=f===null,m=g?"":`,${f}`;return o={css:`"${Zk(i)}",${h}${m}`,guessFallback:g,loadedName:h,baseFontName:i,src:u.join(","),style:d},n.set(a,o),o}const $k=3285377520,ro=4294901760,kl=65535;class OG{constructor(e){this.h1=e?e&4294967295:$k,this.h2=e?e&4294967295:$k}update(e){let t,i;if(typeof e=="string"){t=new Uint8Array(e.length*2),i=0;for(let m=0,b=e.length;m<b;m++){const p=e.charCodeAt(m);p<=255?t[i++]=p:(t[i++]=p>>>8,t[i++]=p&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),i=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const s=i>>2,r=i-s*4,a=new Uint32Array(t.buffer,0,s);let o=0,l=0,c=this.h1,h=this.h2;const u=3432918353,d=461845907,f=u&kl,g=d&kl;for(let m=0;m<s;m++)m&1?(o=a[m],o=o*u&ro|o*f&kl,o=o<<15|o>>>17,o=o*d&ro|o*g&kl,c^=o,c=c<<13|c>>>19,c=c*5+3864292196):(l=a[m],l=l*u&ro|l*f&kl,l=l<<15|l>>>17,l=l*d&ro|l*g&kl,h^=l,h=h<<13|h>>>19,h=h*5+3864292196);switch(o=0,r){case 3:o^=t[s*4+2]<<16;case 2:o^=t[s*4+1]<<8;case 1:o^=t[s*4],o=o*u&ro|o*f&kl,o=o<<15|o>>>17,o=o*d&ro|o*g&kl,s&1?c^=o:h^=o}this.h1=c,this.h2=h}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&ro|e*36045&kl,t=t*4283543511&ro|((t<<16|e>>>16)*2950163797&ro)>>>16,e^=t>>>1,e=e*444984403&ro|e*60499&kl,t=t*3301882366&ro|((t<<16|e>>>16)*3120437893&ro)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}function eC(n,e,t,i,s,r){const a=s*r;let o;e<=8?o=new Uint8Array(a):e<=16?o=new Uint16Array(a):o=new Uint32Array(a);const l=t/s,c=i/r;let h,u,d,f=0,g;const m=new Uint16Array(s),b=t;for(h=0;h<s;h++)m[h]=Math.floor(h*l);for(h=0;h<r;h++)for(d=Math.floor(h*c)*b,u=0;u<s;u++)g=d+m[u],o[f++]=n[g];return o}var tx,l6;const Jf=class Jf{constructor({xref:e,res:t,image:i,isInline:s=!1,smask:r=null,mask:a=null,isMask:o=!1,pdfFunctionFactory:l,globalColorSpaceCache:c,localColorSpaceCache:h}){U(this,tx);var p,y;this.image=i;const u=i.dict,d=u.get("F","Filter");let f;if(d instanceof ve)f=d.name;else if(Array.isArray(d)){const w=e.fetchIfRef(d[0]);w instanceof ve&&(f=w.name)}switch(f){case"JPXDecode":({width:i.width,height:i.height,componentsCount:i.numComps,bitsPerComponent:i.bitsPerComponent}=Yo.parseImageProperties(i.stream)),i.stream.reset();const w=Fo.getReducePowerForJPX(i.width,i.height,i.numComps);if(this.jpxDecoderOptions={numComponents:0,isIndexedColormap:!1,smaskInData:u.has("SMaskInData"),reducePower:w},w){const _=2**w;i.width=Math.ceil(i.width/_),i.height=Math.ceil(i.height/_)}break;case"JBIG2Decode":i.bitsPerComponent=1,i.numComps=1;break}let g=u.get("W","Width"),m=u.get("H","Height");if(Number.isInteger(i.width)&&i.width>0&&Number.isInteger(i.height)&&i.height>0&&(i.width!==g||i.height!==m))ae("PDFImage - using the Width/Height of the image data, rather than the image dictionary."),g=i.width,m=i.height;else{const w=typeof g=="number"&&g>0,_=typeof m=="number"&&m>0;if(!w||!_){if(!i.fallbackDims)throw new Te(`Invalid image width: ${g} or height: ${m}`);ae("PDFImage - using the Width/Height of the parent image, for SMask/Mask data."),w||(g=i.fallbackDims.width),_||(m=i.fallbackDims.height)}}this.width=g,this.height=m,this.interpolate=u.get("I","Interpolate"),this.imageMask=u.get("IM","ImageMask")||!1,this.matte=u.get("Matte")||!1;let b=i.bitsPerComponent;if(!b&&(b=u.get("BPC","BitsPerComponent"),!b))if(this.imageMask)b=1;else throw new Te(`Bits per component missing in image: ${this.imageMask}`);if(this.bpc=b,!this.imageMask){let w=u.getRaw("CS")||u.getRaw("ColorSpace");const _=!!w;if(_)(p=this.jpxDecoderOptions)!=null&&p.smaskInData&&(w=ve.get("DeviceRGBA"));else if(this.jpxDecoderOptions)w=ve.get("DeviceRGBA");else switch(i.numComps){case 1:w=ve.get("DeviceGray");break;case 3:w=ve.get("DeviceRGB");break;case 4:w=ve.get("DeviceCMYK");break;default:throw new Error(`Images with ${i.numComps} color components not supported.`)}this.colorSpace=Dn.parse({cs:w,xref:e,resources:s?t:null,pdfFunctionFactory:l,globalColorSpaceCache:c,localColorSpaceCache:h}),this.numComps=this.colorSpace.numComps,this.jpxDecoderOptions&&(this.jpxDecoderOptions.numComponents=_?this.numComps:0,this.jpxDecoderOptions.isIndexedColormap=this.colorSpace.name==="Indexed")}if(this.decode=u.getArray("D","Decode"),this.needsDecode=!1,this.decode&&(this.colorSpace&&!this.colorSpace.isDefaultDecode(this.decode,b)||o&&!xr.isDefaultDecode(this.decode,1))){this.needsDecode=!0;const w=(1<<b)-1;this.decodeCoefficients=[],this.decodeAddends=[];const _=((y=this.colorSpace)==null?void 0:y.name)==="Indexed";for(let v=0,C=0;v<this.decode.length;v+=2,++C){const k=this.decode[v],I=this.decode[v+1];this.decodeCoefficients[C]=_?(I-k)/w:I-k,this.decodeAddends[C]=_?k:w*k}}r?(r.fallbackDims??(r.fallbackDims={width:g,height:m}),this.smask=new Jf({xref:e,res:t,image:r,isInline:s,pdfFunctionFactory:l,globalColorSpaceCache:c,localColorSpaceCache:h})):a&&(a instanceof dn?a.dict.get("IM","ImageMask")?(a.fallbackDims??(a.fallbackDims={width:g,height:m}),this.mask=new Jf({xref:e,res:t,image:a,isInline:s,isMask:!0,pdfFunctionFactory:l,globalColorSpaceCache:c,localColorSpaceCache:h})):ae("Ignoring /Mask in image without /ImageMask."):this.mask=a)}static async buildImage({xref:e,res:t,image:i,isInline:s=!1,pdfFunctionFactory:r,globalColorSpaceCache:a,localColorSpaceCache:o}){const l=i;let c=null,h=null;const u=i.dict.get("SMask"),d=i.dict.get("Mask");return u?u instanceof dn?c=u:ae("Unsupported /SMask format."):d&&(d instanceof dn||Array.isArray(d)?h=d:ae("Unsupported /Mask format.")),new Jf({xref:e,res:t,image:l,isInline:s,smask:c,mask:h,pdfFunctionFactory:r,globalColorSpaceCache:a,localColorSpaceCache:o})}static async createMask({image:e,isOffscreenCanvasSupported:t=!1}){const{dict:i}=e,s=i.get("W","Width"),r=i.get("H","Height"),a=i.get("I","Interpolate"),o=i.getArray("D","Decode"),l=(o==null?void 0:o[0])>0,c=(s+7>>3)*r,h=e.getBytes(c),u=s===1&&r===1&&l===(h.length===0||!!(h[0]&128));if(u)return{isSingleOpaquePixel:u};if(t){if(Fo.needsToBeResized(s,r)){const w=new Uint8ClampedArray(s*r*4);return V7({src:h,dest:w,width:s,height:r,nonBlackColor:0,inverseDecode:l}),Fo.createImage({kind:zs.RGBA_32BPP,data:w,width:s,height:r,interpolate:a})}const m=new OffscreenCanvas(s,r),b=m.getContext("2d"),p=b.createImageData(s,r);V7({src:h,dest:p.data,width:s,height:r,nonBlackColor:0,inverseDecode:l}),b.putImageData(p,0,0);const y=m.transferToImageBitmap();return{data:null,width:s,height:r,interpolate:a,bitmap:y}}const d=h.byteLength,f=c===d;let g;if(e instanceof na&&(!l||f)?g=h:l?(g=new Uint8Array(c),g.set(h),g.fill(255,d)):g=new Uint8Array(h),l)for(let m=0;m<d;m++)g[m]^=255;return{data:g,width:s,height:r,interpolate:a}}get drawWidth(){var e,t;return Math.max(this.width,((e=this.smask)==null?void 0:e.width)||0,((t=this.mask)==null?void 0:t.width)||0)}get drawHeight(){var e,t;return Math.max(this.height,((e=this.smask)==null?void 0:e.height)||0,((t=this.mask)==null?void 0:t.height)||0)}decodeBuffer(e){const t=this.bpc,i=this.numComps,s=this.decodeAddends,r=this.decodeCoefficients,a=(1<<t)-1;let o,l;if(t===1){for(o=0,l=e.length;o<l;o++)e[o]=+!e[o];return}let c=0;for(o=0,l=this.width*this.height;o<l;o++)for(let h=0;h<i;h++)e[c]=Ws(s[h]+e[c]*r[h],0,a),c++}getComponents(e){const t=this.bpc;if(t===8)return e;const i=this.width,s=this.height,r=this.numComps,a=i*s*r;let o=0,l;t<=8?l=new Uint8Array(a):t<=16?l=new Uint16Array(a):l=new Uint32Array(a);const c=i*r,h=(1<<t)-1;let u=0,d,f;if(t===1){let g,m,b;for(let p=0;p<s;p++){for(m=u+(c&-8),b=u+c;u<m;)f=e[o++],l[u]=f>>7&1,l[u+1]=f>>6&1,l[u+2]=f>>5&1,l[u+3]=f>>4&1,l[u+4]=f>>3&1,l[u+5]=f>>2&1,l[u+6]=f>>1&1,l[u+7]=f&1,u+=8;if(u<b)for(f=e[o++],g=128;u<b;)l[u++]=+!!(f&g),g>>=1}}else{let g=0;for(f=0,u=0,d=a;u<d;++u){for(u%c===0&&(f=0,g=0);g<t;)f=f<<8|e[o++],g+=8;const m=g-t;let b=f>>m;b<0?b=0:b>h&&(b=h),l[u]=b,f&=(1<<m)-1,g=m}}return l}async fillOpacity(e,t,i,s,r){const a=this.smask,o=this.mask;let l,c,h,u,d,f;if(a)c=a.width,h=a.height,l=new Uint8ClampedArray(c*h),await a.fillGrayBuffer(l),(c!==t||h!==i)&&(l=eC(l,a.bpc,c,h,t,i));else if(o)if(o instanceof Jf){for(c=o.width,h=o.height,l=new Uint8ClampedArray(c*h),o.numComps=1,await o.fillGrayBuffer(l),u=0,d=c*h;u<d;++u)l[u]=255-l[u];(c!==t||h!==i)&&(l=eC(l,o.bpc,c,h,t,i))}else if(Array.isArray(o)){l=new Uint8ClampedArray(t*i);const g=this.numComps;for(u=0,d=t*i;u<d;++u){let m=0;const b=u*g;for(f=0;f<g;++f){const p=r[b+f],y=f*2;if(p<o[y]||p>o[y+1]){m=255;break}}l[u]=m}}else throw new Te("Unknown mask format.");if(l)for(u=0,f=3,d=t*s;u<d;++u,f+=4)e[f]=l[u];else for(u=0,f=3,d=t*s;u<d;++u,f+=4)e[f]=255}undoPreblend(e,t,i){var h;const s=(h=this.smask)==null?void 0:h.matte;if(!s)return;const r=this.colorSpace.getRgb(s,0),a=r[0],o=r[1],l=r[2],c=t*i*4;for(let u=0;u<c;u+=4){const d=e[u+3];if(d===0){e[u]=255,e[u+1]=255,e[u+2]=255;continue}const f=255/d;e[u]=(e[u]-a)*f+a,e[u+1]=(e[u+1]-o)*f+o,e[u+2]=(e[u+2]-l)*f+l}}async createImageData(e=!1,t=!1){const i=this.drawWidth,s=this.drawHeight,r={width:i,height:s,interpolate:this.interpolate,kind:0,data:null},a=this.numComps,o=this.width,l=this.height,c=this.bpc,h=o*a*c+7>>3,u=t&&Fo.needsToBeResized(i,s);if(!this.smask&&!this.mask&&this.colorSpace.name==="DeviceRGBA"){r.kind=zs.RGBA_32BPP;const v=r.data=await this.getImageBytes(l*o*4,{});return t?u?Fo.createImage(r,!1):this.createBitmap(zs.RGBA_32BPP,i,s,v):r}if(!e){let v;if(this.colorSpace.name==="DeviceGray"&&c===1?v=zs.GRAYSCALE_1BPP:this.colorSpace.name==="DeviceRGB"&&c===8&&!this.needsDecode&&(v=zs.RGB_24BPP),v&&!this.smask&&!this.mask&&i===o&&s===l){const C=await F(this,tx,l6).call(this,o,l);if(C)return C;const k=await this.getImageBytes(l*h,{});if(t)return u?Fo.createImage({data:k,kind:v,width:i,height:s,interpolate:this.interpolate},this.needsDecode):this.createBitmap(v,o,l,k);if(r.kind=v,r.data=k,this.needsDecode){qs(v===zs.GRAYSCALE_1BPP,"PDFImage.createImageData: The image must be grayscale.");const I=r.data;for(let E=0,T=I.length;E<T;E++)I[E]^=255}return r}if(this.image instanceof Og&&!this.smask&&!this.mask&&!this.needsDecode){let C=l*h;if(t&&!u){let k=!1;switch(this.colorSpace.name){case"DeviceGray":C*=4,k=!0;break;case"DeviceRGB":C=C/3*4,k=!0;break;case"DeviceCMYK":k=!0;break}if(k){const I=await F(this,tx,l6).call(this,i,s);if(I)return I;const E=await this.getImageBytes(C,{drawWidth:i,drawHeight:s,forceRGBA:!0});return this.createBitmap(zs.RGBA_32BPP,i,s,E)}}else switch(this.colorSpace.name){case"DeviceGray":C*=3;case"DeviceRGB":case"DeviceCMYK":return r.kind=zs.RGB_24BPP,r.data=await this.getImageBytes(C,{drawWidth:i,drawHeight:s,forceRGB:!0}),u?Fo.createImage(r):r}}}const d=await this.getImageBytes(l*h,{internal:!0}),f=0|d.length/h*s/l,g=this.getComponents(d);let m,b,p,y,w,_;if(t&&!u&&(p=new OffscreenCanvas(i,s),y=p.getContext("2d"),w=y.createImageData(i,s),_=w.data),r.kind=zs.RGBA_32BPP,!e&&!this.smask&&!this.mask?(!t||u?(r.kind=zs.RGB_24BPP,_=new Uint8ClampedArray(i*s*3),m=0):(new Uint32Array(_.buffer).fill(ya.isLittleEndian?4278190080:255),m=1),b=!1):((!t||u)&&(_=new Uint8ClampedArray(i*s*4)),m=1,b=!0,await this.fillOpacity(_,i,s,f,g)),this.needsDecode&&this.decodeBuffer(g),this.colorSpace.fillRgb(_,o,l,i,s,f,c,g,m),b&&this.undoPreblend(_,i,f),t&&!u){y.putImageData(w,0,0);const v=p.transferToImageBitmap();return{data:null,width:i,height:s,bitmap:v,interpolate:this.interpolate}}return r.data=_,u?Fo.createImage(r):r}async fillGrayBuffer(e){const t=this.numComps;if(t!==1)throw new Te(`Reading gray scale from a color image: ${t}`);const i=this.width,s=this.height,r=this.bpc,a=i*t*r+7>>3,o=await this.getImageBytes(s*a,{internal:!0}),l=this.getComponents(o);let c,h;if(r===1){if(h=i*s,this.needsDecode)for(c=0;c<h;++c)e[c]=l[c]-1&255;else for(c=0;c<h;++c)e[c]=-l[c]&255;return}this.needsDecode&&this.decodeBuffer(l),h=i*s;const u=255/((1<<r)-1);for(c=0;c<h;++c)e[c]=u*l[c]}createBitmap(e,t,i,s){const r=new OffscreenCanvas(t,i),a=r.getContext("2d");let o;e===zs.RGBA_32BPP?o=new ImageData(s,t,i):(o=a.createImageData(t,i),OR({kind:e,src:s,dest:new Uint32Array(o.data.buffer),width:t,height:i,inverseDecode:this.needsDecode})),a.putImageData(o,0,0);const l=r.transferToImageBitmap();return{data:null,width:t,height:i,bitmap:l,interpolate:this.interpolate}}async getImageBytes(e,{drawWidth:t,drawHeight:i,forceRGBA:s=!1,forceRGB:r=!1,internal:a=!1}){this.image.reset(),this.image.drawWidth=t||this.width,this.image.drawHeight=i||this.height,this.image.forceRGBA=!!s,this.image.forceRGB=!!r;const o=await this.image.getImageData(e,this.jpxDecoderOptions);return a||this.image instanceof na?o:(qs(o instanceof Uint8Array,'PDFImage.getImageBytes: Unsupported "imageBytes" type.'),new Uint8Array(o))}};tx=new WeakSet,l6=async function(e,t){const i=await this.image.getTransferableImage();return i?{data:null,width:e,height:t,bitmap:i,interpolate:this.interpolate}:null};let kp=Jf;const DG=Object.freeze({maxImageSize:-1,disableFontFace:!1,ignoreErrors:!1,isEvalSupported:!0,isOffscreenCanvasSupported:!1,isImageDecoderSupported:!1,canvasMaxAreaInBytes:-1,fontExtraProperties:!1,useSystemFonts:!0,useWasm:!0,useWorkerFetch:!0,cMapUrl:null,iccUrl:null,standardFontDataUrl:null,wasmUrl:null}),tC={TILING:1,SHADING:2},FG=10,nC=Promise.resolve();function uM(n,e=!1){if(Array.isArray(n)){for(const t of n){const i=uM(t,!0);if(i)return i}return ae(`Unsupported blend mode Array: ${n}`),"source-over"}if(!(n instanceof ve))return e?null:"source-over";switch(n.name){case"Normal":case"Compatible":return"source-over";case"Multiply":return"multiply";case"Screen":return"screen";case"Overlay":return"overlay";case"Darken":return"darken";case"Lighten":return"lighten";case"ColorDodge":return"color-dodge";case"ColorBurn":return"color-burn";case"HardLight":return"hard-light";case"SoftLight":return"soft-light";case"Difference":return"difference";case"Exclusion":return"exclusion";case"Hue":return"hue";case"Saturation":return"saturation";case"Color":return"color";case"Luminosity":return"luminosity"}return e?null:(ae(`Unsupported blend mode: ${n.name}`),"source-over")}function Fw(n,{objId:e,fn:t,args:i,optionalContent:s,hasMask:r}){var a;e&&n.addDependency(e),n.addImageOps(t,i,s,r),t===ie.paintImageMaskXObject&&((a=i[0])==null?void 0:a.count)>0&&i[0].count++}const Zf=class Zf{constructor(){this.reset()}check(){return++this.checked<Zf.CHECK_TIME_EVERY?!1:(this.checked=0,this.endTime<=Date.now())}reset(){this.endTime=Date.now()+Zf.TIME_SLOT_DURATION_MS,this.checked=0}};Ue(Zf,"TIME_SLOT_DURATION_MS",20),Ue(Zf,"CHECK_TIME_EVERY",100);let U3=Zf;class Fg{constructor({xref:e,handler:t,pageIndex:i,idFactory:s,fontCache:r,builtInCMapCache:a,standardFontDataCache:o,globalColorSpaceCache:l,globalImageCache:c,systemFontCache:h,options:u=null}){this.xref=e,this.handler=t,this.pageIndex=i,this.idFactory=s,this.fontCache=r,this.builtInCMapCache=a,this.standardFontDataCache=o,this.globalColorSpaceCache=l,this.globalImageCache=c,this.systemFontCache=h,this.options=u||DG,this.type3FontRefs=null,this._regionalImageCache=new xG,this._fetchBuiltInCMapBound=this.fetchBuiltInCMap.bind(this)}get _pdfFunctionFactory(){const e=new cM({xref:this.xref,isEvalSupported:this.options.isEvalSupported});return We(this,"_pdfFunctionFactory",e)}get parsingType3Font(){return!!this.type3FontRefs}clone(e=null){const t=Object.create(this);return t.options=Object.assign(Object.create(null),this.options,e),t}hasBlendModes(e,t){if(!(e instanceof ue)||e.objId&&t.has(e.objId))return!1;const i=new ts(t);e.objId&&i.put(e.objId);const s=[e],r=this.xref;for(;s.length;){const a=s.shift(),o=a.get("ExtGState");if(o instanceof ue)for(let c of o.getRawValues()){if(c instanceof tt){if(i.has(c))continue;try{c=r.fetch(c)}catch(u){i.put(c),gn(`hasBlendModes - ignoring ExtGState: "${u}".`);continue}}if(!(c instanceof ue))continue;c.objId&&i.put(c.objId);const h=c.get("BM");if(h instanceof ve){if(h.name!=="Normal")return!0;continue}if(h!==void 0&&Array.isArray(h)){for(const u of h)if(u instanceof ve&&u.name!=="Normal")return!0}}const l=a.get("XObject");if(l instanceof ue)for(let c of l.getRawValues()){if(c instanceof tt){if(i.has(c))continue;try{c=r.fetch(c)}catch(u){i.put(c),gn(`hasBlendModes - ignoring XObject: "${u}".`);continue}}if(!(c instanceof dn))continue;c.dict.objId&&i.put(c.dict.objId);const h=c.dict.get("Resources");h instanceof ue&&(h.objId&&i.has(h.objId)||(s.push(h),h.objId&&i.put(h.objId)))}}for(const a of i)t.put(a);return!1}async fetchBuiltInCMap(e){const t=this.builtInCMapCache.get(e);if(t)return t;let i;return this.options.useWorkerFetch?i={cMapData:await D7(`${this.options.cMapUrl}${e}.bcmap`),isCompressed:!0}:i=await this.handler.sendWithPromise("FetchBinaryData",{type:"cMapReaderFactory",name:e}),this.builtInCMapCache.set(e,i),i}async fetchStandardFontData(e){const t=this.standardFontDataCache.get(e);if(t)return new ji(t);if(this.options.useSystemFonts&&e!=="Symbol"&&e!=="ZapfDingbats")return null;const i=Uz(),s=i[e];let r;try{this.options.useWorkerFetch?r=await D7(`${this.options.standardFontDataUrl}${s}`):r=await this.handler.sendWithPromise("FetchBinaryData",{type:"standardFontDataFactory",filename:s})}catch(a){return ae(a),null}return this.standardFontDataCache.set(e,r),new ji(r)}async buildFormXObject(e,t,i,s,r,a,o,l){const{dict:c}=t,h=Dh(c.getArray("Matrix"),null),u=A0(c.getArray("BBox"),null);let d,f;c.has("OC")&&(d=await this.parseMarkedContentProps(c.get("OC"),e)),d!==void 0&&s.addOp(ie.beginMarkedContentProps,["OC",d]);const g=c.get("Group");if(g){f={matrix:h,bbox:u,smask:i,isolated:!1,knockout:!1};const w=g.get("S");let _=null;if(Li(w,"Transparency")&&(f.isolated=g.get("I")||!1,f.knockout=g.get("K")||!1,g.has("CS"))){const v=this._getColorSpace(g.getRaw("CS"),e,o);_=v instanceof xr?v:await this._handleColorSpace(v)}i!=null&&i.backdrop&&(_||(_=Dn.rgb),i.backdrop=_.getRgbHex(i.backdrop,0)),s.addOp(ie.beginGroup,[f])}const m=h&&new Float32Array(h),b=!g&&u&&new Float32Array(u)||null,p=[m,b];s.addOp(ie.paintFormXObjectBegin,p);const y=c.get("Resources");await this.getOperatorList({stream:t,task:r,resources:y instanceof ue?y:e,operatorList:s,initialState:a,prevRefs:l}),s.addOp(ie.paintFormXObjectEnd,[]),g&&s.addOp(ie.endGroup,[f]),d!==void 0&&s.addOp(ie.endMarkedContent,[])}_sendImgData(e,t,i=!1){const s=t?[t.bitmap||t.data.buffer]:null;return this.parsingType3Font||i?this.handler.send("commonobj",[e,"Image",t],s):this.handler.send("obj",[e,this.pageIndex,"Image",t],s)}async buildPaintImageXObject({resources:e,image:t,isInline:i=!1,operatorList:s,cacheKey:r,localImageCache:a,localColorSpaceCache:o}){const{maxImageSize:l,ignoreErrors:c,isOffscreenCanvasSupported:h}=this.options,{dict:u}=t,d=u.objId,f=u.get("W","Width"),g=u.get("H","Height");if(!(f&&typeof f=="number")||!(g&&typeof g=="number")){ae("Image dimensions are missing, or not numbers.");return}if(l!==-1&&f*g>l){const E="Image exceeded maximum allowed size and was removed.";if(!c)throw new Error(E);ae(E);return}let m;u.has("OC")&&(m=await this.parseMarkedContentProps(u.get("OC"),e));const b=u.get("IM","ImageMask")||!1;let p,y,w;if(b){if(p=await kp.createMask({image:t,isOffscreenCanvasSupported:h&&!this.parsingType3Font}),p.isSingleOpaquePixel){if(y=ie.paintSolidColorImageMask,w=[],s.addImageOps(y,w,m),r){const T={fn:y,args:w,optionalContent:m};a.set(r,d,T),d&&this._regionalImageCache.set(null,d,T)}return}if(this.parsingType3Font){if(w=Tz(p),w){s.addImageOps(ie.constructPath,w,m);return}ae("Cannot compile Type3 glyph."),s.addImageOps(ie.paintImageMaskXObject,[p],m);return}const E=`mask_${this.idFactory.createObjId()}`;if(s.addDependency(E),p.dataLen=p.bitmap?p.width*p.height*4:p.data.length,this._sendImgData(E,p),y=ie.paintImageMaskXObject,w=[{data:E,width:p.width,height:p.height,interpolate:p.interpolate,count:1}],s.addImageOps(y,w,m),r){const T={objId:E,fn:y,args:w,optionalContent:m};a.set(r,d,T),d&&this._regionalImageCache.set(null,d,T)}return}const _=200,v=u.has("SMask")||u.has("Mask");if(i&&f+g<_&&!v){try{p=await new kp({xref:this.xref,res:e,image:t,isInline:i,pdfFunctionFactory:this._pdfFunctionFactory,globalColorSpaceCache:this.globalColorSpaceCache,localColorSpaceCache:o}).createImageData(!0,!1),s.addImageOps(ie.paintInlineImageXObject,[p],m)}catch(E){const T=`Unable to decode inline image: "${E}".`;if(!c)throw new Error(T);ae(T)}return}let C=`img_${this.idFactory.createObjId()}`,k=!1,I=null;if(this.parsingType3Font?C=`${this.idFactory.getDocId()}_type3_${C}`:r&&d&&(k=this.globalImageCache.shouldCache(d,this.pageIndex),k&&(qs(!i,"Cannot cache an inline image globally."),C=`${this.idFactory.getDocId()}_${C}`)),s.addDependency(C),y=ie.paintImageXObject,w=[C,f,g],s.addImageOps(y,w,m,v),k){if(I={objId:C,fn:y,args:w,optionalContent:m,hasMask:v,byteSize:0},this.globalImageCache.hasDecodeFailed(d)){this.globalImageCache.setData(d,I),this._sendImgData(C,null,k);return}if(f*g>25e4||v){const E=await this.handler.sendWithPromise("commonobj",[C,"CopyLocalImage",{imageRef:d}]);if(E){this.globalImageCache.setData(d,I),this.globalImageCache.addByteSize(d,E);return}}}if(kp.buildImage({xref:this.xref,res:e,image:t,isInline:i,pdfFunctionFactory:this._pdfFunctionFactory,globalColorSpaceCache:this.globalColorSpaceCache,localColorSpaceCache:o}).then(async E=>(p=await E.createImageData(!1,h),p.dataLen=p.bitmap?p.width*p.height*4:p.data.length,p.ref=d,k&&this.globalImageCache.addByteSize(d,p.dataLen),this._sendImgData(C,p,k))).catch(E=>(ae(`Unable to decode image "${C}": "${E}".`),d&&this.globalImageCache.addDecodeFailed(d),this._sendImgData(C,null,k))),r){const E={objId:C,fn:y,args:w,optionalContent:m,hasMask:v};a.set(r,d,E),d&&(this._regionalImageCache.set(null,d,E),k&&(qs(I,"The global cache-data must be available."),this.globalImageCache.setData(d,I)))}}handleSMask(e,t,i,s,r,a,o){const l=e.get("G"),c={subtype:e.get("S").name,backdrop:e.get("BC")},h=e.get("TR");if(Ow(h)){const u=this._pdfFunctionFactory.create(h),d=new Uint8Array(256),f=new Float32Array(1);for(let g=0;g<256;g++)f[0]=g/255,u(f,0,f,0),d[g]=f[0]*255|0;c.transferMap=d}return this.buildFormXObject(t,l,c,i,s,r.state.clone({newPath:!0}),a,o)}handleTransferFunction(e){let t;if(Array.isArray(e))t=e;else if(Ow(e))t=[e];else return null;const i=[];let s=0,r=0;for(const a of t){const o=this.xref.fetchIfRef(a);if(s++,Li(o,"Identity")){i.push(null);continue}else if(!Ow(o))return null;const l=this._pdfFunctionFactory.create(o),c=new Uint8Array(256),h=new Float32Array(1);for(let u=0;u<256;u++)h[0]=u/255,l(h,0,h,0),c[u]=h[0]*255|0;i.push(c),r++}return!(s===1||s===4)||r===0?null:i}handleTilingType(e,t,i,s,r,a,o,l){const c=new Pr,h=ue.merge({xref:this.xref,dictArray:[r.get("Resources"),i]});return this.getOperatorList({stream:s,task:o,resources:h,operatorList:c}).then(function(){const u=c.getIR(),d=jk(u,r,t);a.addDependencies(c.dependencies),a.addOp(e,d),r.objId&&l.set(null,r.objId,{operatorListIR:u,dict:r})}).catch(u=>{if(!(u instanceof hr)){if(this.options.ignoreErrors){ae(`handleTilingType - ignoring pattern: "${u}".`);return}throw u}})}async handleSetFont(e,t,i,s,r,a,o=null,l=null){const c=(t==null?void 0:t[0])instanceof ve?t[0].name:null,h=await this.loadFont(c,i,e,r,o,l);return h.font.isType3Font&&s.addDependencies(h.type3Dependencies),a.font=h.font,h.send(this.handler),h.loadedName}handleText(e,t){const i=t.font,s=i.charsToGlyphs(e);return i.data&&(t.textRenderingMode&gR.ADD_TO_PATH_FLAG||t.fillColorSpace.name==="Pattern"||i.disableFontFace)&&Fg.buildFontPaths(i,s,this.handler,this.options),s}ensureStateFont(e){if(e.font)return;const t=new Te("Missing setFont (Tf) operator before text rendering operator.");if(this.options.ignoreErrors){ae(`ensureStateFont: "${t}".`);return}throw t}async setGState({resources:e,gState:t,operatorList:i,cacheKey:s,task:r,stateManager:a,localGStateCache:o,localColorSpaceCache:l,seenRefs:c}){const h=t.objId;let u=!0;const d=[];let f=Promise.resolve();for(const[g,m]of t)switch(g){case"Type":break;case"LW":if(typeof m!="number"){ae(`Invalid LW (line width): ${m}`);break}d.push([g,Math.abs(m)]);break;case"LC":case"LJ":case"ML":case"D":case"RI":case"FL":case"CA":case"ca":d.push([g,m]);break;case"Font":u=!1,f=f.then(()=>this.handleSetFont(e,null,m[0],i,r,a.state).then(function(p){i.addDependency(p),d.push([g,[p,m[1]]])}));break;case"BM":d.push([g,uM(m)]);break;case"SMask":if(Li(m,"None")){d.push([g,!1]);break}m instanceof ue?(u=!1,f=f.then(()=>this.handleSMask(m,e,i,r,a,l,c)),d.push([g,!0])):ae("Unsupported SMask type");break;case"TR":const b=this.handleTransferFunction(m);d.push([g,b]);break;case"OP":case"op":case"OPM":case"BG":case"BG2":case"UCR":case"UCR2":case"TR2":case"HT":case"SM":case"SA":case"AIS":case"TK":gn("graphic state operator "+g);break;default:gn("Unknown graphic state operator "+g);break}await f,d.length>0&&i.addOp(ie.setGState,[d]),u&&o.set(s,h,d)}loadFont(e,t,i,s,r=null,a=null){var b;const o=async()=>new Lw({loadedName:"g_font_error",font:new Hk(`Font "${e}" is not available.`),dict:t});let l;if(t)t instanceof tt&&(l=t);else{const p=i.get("Font");p&&(l=p.getRaw(e))}if(l){if((b=this.type3FontRefs)!=null&&b.has(l))return o();if(this.fontCache.has(l))return this.fontCache.get(l);try{t=this.xref.fetchIfRef(l)}catch(p){ae(`loadFont - lookup failed: "${p}".`)}}if(!(t instanceof ue)){if(!this.options.ignoreErrors&&!this.parsingType3Font)return ae(`Font "${e}" is not available.`),o();ae(`Font "${e}" is not available -- attempting to fallback to a default font.`),t=r||Fg.fallbackFontDict}if(t.cacheKey&&this.fontCache.has(t.cacheKey))return this.fontCache.get(t.cacheKey);const{promise:c,resolve:h}=Promise.withResolvers();let u;try{u=this.preEvaluateFont(t),u.cssFontInfo=a}catch(p){return ae(`loadFont - preEvaluateFont failed: "${p}".`),o()}const{descriptor:d,hash:f}=u,g=l instanceof tt;let m;if(f&&d instanceof ue){const p=d.fontAliases||(d.fontAliases=Object.create(null));if(p[f]){const y=p[f].aliasRef;if(g&&y&&this.fontCache.has(y))return this.fontCache.putAlias(l,y),this.fontCache.get(l)}else p[f]={fontID:this.idFactory.createFontId()};g&&(p[f].aliasRef=l),m=p[f].fontID}else m=this.idFactory.createFontId();return qs(m==null?void 0:m.startsWith("f"),'The "fontID" must be (correctly) defined.'),g?this.fontCache.put(l,c):(t.cacheKey=`cacheKey_${m}`,this.fontCache.put(t.cacheKey,c)),t.loadedName=`${this.idFactory.getDocId()}_${m}`,this.translateFont(u).then(async p=>{const y=new Lw({loadedName:t.loadedName,font:p,dict:t});if(p.isType3Font)try{await y.loadType3Data(this,i,s)}catch(w){throw new Error(`Type3 font load error: ${w}`)}h(y)}).catch(p=>{ae(`loadFont - translateFont failed: "${p}".`),h(new Lw({loadedName:t.loadedName,font:new Hk(p==null?void 0:p.message),dict:t}))}),c}buildPath(e,t,i){const{pathMinMax:s,pathBuffer:r}=i;switch(e|0){case ie.rectangle:{const a=i.currentPointX=t[0],o=i.currentPointY=t[1],l=t[2],c=t[3],h=a+l,u=o+c;l===0||c===0?r.push(xs.moveTo,a,o,xs.lineTo,h,u,xs.closePath):r.push(xs.moveTo,a,o,xs.lineTo,h,o,xs.lineTo,h,u,xs.lineTo,a,u,xs.closePath),Ln.rectBoundingBox(a,o,h,u,s);break}case ie.moveTo:{const a=i.currentPointX=t[0],o=i.currentPointY=t[1];r.push(xs.moveTo,a,o),Ln.pointBoundingBox(a,o,s);break}case ie.lineTo:{const a=i.currentPointX=t[0],o=i.currentPointY=t[1];r.push(xs.lineTo,a,o),Ln.pointBoundingBox(a,o,s);break}case ie.curveTo:{const a=i.currentPointX,o=i.currentPointY,[l,c,h,u,d,f]=t;i.currentPointX=d,i.currentPointY=f,r.push(xs.curveTo,l,c,h,u,d,f),Ln.bezierBoundingBox(a,o,l,c,h,u,d,f,s);break}case ie.curveTo2:{const a=i.currentPointX,o=i.currentPointY,[l,c,h,u]=t;i.currentPointX=h,i.currentPointY=u,r.push(xs.curveTo,a,o,l,c,h,u),Ln.bezierBoundingBox(a,o,a,o,l,c,h,u,s);break}case ie.curveTo3:{const a=i.currentPointX,o=i.currentPointY,[l,c,h,u]=t;i.currentPointX=h,i.currentPointY=u,r.push(xs.curveTo,l,c,h,u,h,u),Ln.bezierBoundingBox(a,o,l,c,h,u,h,u,s);break}case ie.closePath:r.push(xs.closePath);break}}_getColorSpace(e,t,i){return Dn.parse({cs:e,xref:this.xref,resources:t,pdfFunctionFactory:this._pdfFunctionFactory,globalColorSpaceCache:this.globalColorSpaceCache,localColorSpaceCache:i,asyncIfNotCached:!0})}async _handleColorSpace(e){try{return await e}catch(t){if(t instanceof hr)return null;if(this.options.ignoreErrors)return ae(`_handleColorSpace - ignoring ColorSpace: "${t}".`),null;throw t}}parseShading({shading:e,resources:t,localColorSpaceCache:i,localShadingPatternCache:s}){let r=s.get(e);if(r)return r;let a;try{a=Ej.parseShading(e,this.xref,t,this._pdfFunctionFactory,this.globalColorSpaceCache,i).getIR()}catch(o){if(o instanceof hr)return null;if(this.options.ignoreErrors)return ae(`parseShading - ignoring shading: "${o}".`),s.set(e,null),null;throw o}return r=`pattern_${this.idFactory.createObjId()}`,this.parsingType3Font&&(r=`${this.idFactory.getDocId()}_type3_${r}`),s.set(e,r),this.parsingType3Font?this.handler.send("commonobj",[r,"Pattern",a]):this.handler.send("obj",[r,this.pageIndex,"Pattern",a]),r}handleColorN(e,t,i,s,r,a,o,l,c,h){const u=i.pop();if(u instanceof ve){const d=r.getRaw(u.name),f=d instanceof tt&&c.getByRef(d);if(f)try{const m=s.base?s.base.getRgbHex(i,0):null,b=jk(f.operatorListIR,f.dict,m);e.addOp(t,b);return}catch{}const g=this.xref.fetchIfRef(d);if(g){const m=g instanceof dn?g.dict:g,b=m.get("PatternType");if(b===tC.TILING){const p=s.base?s.base.getRgbHex(i,0):null;return this.handleTilingType(t,p,a,g,m,e,o,c)}else if(b===tC.SHADING){const p=m.get("Shading"),y=this.parseShading({shading:p,resources:a,localColorSpaceCache:l,localShadingPatternCache:h});if(y){const w=Dh(m.getArray("Matrix"),null);e.addOp(t,["Shading",y,w])}return}throw new Te(`Unknown PatternType: ${b}`)}}throw new Te(`Unknown PatternName: ${u}`)}_parseVisibilityExpression(e,t,i){if(++t>10){ae("Visibility expression is too deeply nested");return}const r=e.length,a=this.xref.fetchIfRef(e[0]);if(r<2||!(a instanceof ve)){ae("Invalid visibility expression");return}switch(a.name){case"And":case"Or":case"Not":i.push(a.name);break;default:ae(`Invalid operator ${a.name} in visibility expression`);return}for(let o=1;o<r;o++){const l=e[o],c=this.xref.fetchIfRef(l);if(Array.isArray(c)){const h=[];i.push(h),this._parseVisibilityExpression(c,t,h)}else l instanceof tt&&i.push(l.toString())}}async parseMarkedContentProps(e,t){var r;let i;if(e instanceof ve)i=t.get("Properties").get(e.name);else if(e instanceof ue)i=e;else throw new Te("Optional content properties malformed.");const s=(r=i.get("Type"))==null?void 0:r.name;if(s==="OCG")return{type:s,id:i.objId};if(s==="OCMD"){const a=i.get("VE");if(Array.isArray(a)){const l=[];if(this._parseVisibilityExpression(a,0,l),l.length>0)return{type:"OCMD",expression:l}}const o=i.get("OCGs");if(Array.isArray(o)||o instanceof ue){const l=[];if(Array.isArray(o))for(const c of o)l.push(c.toString());else l.push(o.objId);return{type:s,ids:l,policy:i.get("P")instanceof ve?i.get("P").name:null,expression:null}}else if(o instanceof tt)return{type:s,id:o.toString()}}return null}getOperatorList({stream:e,task:t,resources:i,operatorList:s,initialState:r=null,fallbackFontDict:a=null,prevRefs:o=null}){var k;const l=(k=e.dict)==null?void 0:k.objId,c=new ts(o);if(l){if(o!=null&&o.has(l))throw new Error(`getOperatorList - ignoring circular reference: ${l}`);c.put(l)}if(i||(i=ue.empty),r||(r=new gM),!s)throw new Error('getOperatorList: missing "operatorList" parameter');const h=this,u=this.xref,d=new Gk,f=new oM,g=new Vk,m=new bG,b=new Map,p=i.get("XObject")||ue.empty,y=i.get("Pattern")||ue.empty,w=new d3(r),_=new Lg(e,u,w),v=new U3;function C(I){for(let E=0,T=_.savedStatesDepth;E<T;E++)s.addOp(ie.restore,[])}return new Promise(function I(E,T){const M=function(G){Promise.all([G,s.ready]).then(function(){try{I(E,T)}catch(Y){T(Y)}},T)};t.ensureNotTerminated(),v.reset();const D={};let H,R,z,P,B,Z;for(;!(H=v.check())&&(D.args=null,!!_.read(D));){let G=D.args,Y=D.fn;switch(Y|0){case ie.paintXObject:if(Z=G[0]instanceof ve,B=G[0].name,Z){const N=d.getByName(B);if(N){Fw(s,N),G=null;continue}}M(new Promise(function(N,K){if(!Z)throw new Te("XObject must be referred to by name.");let oe=p.getRaw(B);if(oe instanceof tt){const le=d.getByRef(oe)||h._regionalImageCache.getByRef(oe)||h.globalImageCache.getData(oe,h.pageIndex);if(le){Fw(s,le),N();return}oe=u.fetch(oe)}if(!(oe instanceof dn))throw new Te("XObject should be a stream");const W=oe.dict.get("Subtype");if(!(W instanceof ve))throw new Te("XObject should have a Name subtype");if(W.name==="Form"){w.save(),h.buildFormXObject(i,oe,null,s,t,w.state.clone({newPath:!0}),f,c).then(function(){w.restore(),N()},K);return}else if(W.name==="Image"){h.buildPaintImageXObject({resources:i,image:oe,operatorList:s,cacheKey:B,localImageCache:d,localColorSpaceCache:f}).then(N,K);return}else if(W.name==="PS")gn("Ignored XObject subtype PS");else throw new Te(`Unhandled XObject subtype ${W.name}`);N()}).catch(function(N){if(!(N instanceof hr)){if(h.options.ignoreErrors){ae(`getOperatorList - ignoring XObject: "${N}".`);return}throw N}}));return;case ie.setFont:const J=G[1];M(h.handleSetFont(i,G,null,s,t,w.state,a).then(function(N){s.addDependency(N),s.addOp(ie.setFont,[N,J])}));return;case ie.endInlineImage:const se=G[0].cacheKey;if(se){const N=d.getByName(se);if(N){Fw(s,N),G=null;continue}}M(h.buildPaintImageXObject({resources:i,image:G[0],isInline:!0,operatorList:s,cacheKey:se,localImageCache:d,localColorSpaceCache:f}));return;case ie.showText:if(!w.state.font){h.ensureStateFont(w.state);continue}G[0]=h.handleText(G[0],w.state);break;case ie.showSpacedText:if(!w.state.font){h.ensureStateFont(w.state);continue}const fe=[],he=w.state;for(const N of G[0])typeof N=="string"?fe.push(...h.handleText(N,he)):typeof N=="number"&&fe.push(N);G[0]=fe,Y=ie.showText;break;case ie.nextLineShowText:if(!w.state.font){h.ensureStateFont(w.state);continue}s.addOp(ie.nextLine),G[0]=h.handleText(G[0],w.state),Y=ie.showText;break;case ie.nextLineSetSpacingShowText:if(!w.state.font){h.ensureStateFont(w.state);continue}s.addOp(ie.nextLine),s.addOp(ie.setWordSpacing,[G.shift()]),s.addOp(ie.setCharSpacing,[G.shift()]),G[0]=h.handleText(G[0],w.state),Y=ie.showText;break;case ie.setTextRenderingMode:w.state.textRenderingMode=G[0];break;case ie.setFillColorSpace:{const N=h._getColorSpace(G[0],i,f);if(N instanceof xr){w.state.fillColorSpace=N;continue}M(h._handleColorSpace(N).then(K=>{w.state.fillColorSpace=K||Dn.gray}));return}case ie.setStrokeColorSpace:{const N=h._getColorSpace(G[0],i,f);if(N instanceof xr){w.state.strokeColorSpace=N;continue}M(h._handleColorSpace(N).then(K=>{w.state.strokeColorSpace=K||Dn.gray}));return}case ie.setFillColor:P=w.state.fillColorSpace,G=[P.getRgbHex(G,0)],Y=ie.setFillRGBColor;break;case ie.setStrokeColor:P=w.state.strokeColorSpace,G=[P.getRgbHex(G,0)],Y=ie.setStrokeRGBColor;break;case ie.setFillGray:w.state.fillColorSpace=Dn.gray,G=[Dn.gray.getRgbHex(G,0)],Y=ie.setFillRGBColor;break;case ie.setStrokeGray:w.state.strokeColorSpace=Dn.gray,G=[Dn.gray.getRgbHex(G,0)],Y=ie.setStrokeRGBColor;break;case ie.setFillCMYKColor:w.state.fillColorSpace=Dn.cmyk,G=[Dn.cmyk.getRgbHex(G,0)],Y=ie.setFillRGBColor;break;case ie.setStrokeCMYKColor:w.state.strokeColorSpace=Dn.cmyk,G=[Dn.cmyk.getRgbHex(G,0)],Y=ie.setStrokeRGBColor;break;case ie.setFillRGBColor:w.state.fillColorSpace=Dn.rgb,G=[Dn.rgb.getRgbHex(G,0)];break;case ie.setStrokeRGBColor:w.state.strokeColorSpace=Dn.rgb,G=[Dn.rgb.getRgbHex(G,0)];break;case ie.setFillColorN:if(P=w.state.patternFillColorSpace,!P){if(Yr(G,null)){G=[Dn.gray.getRgbHex(G,0)],Y=ie.setFillRGBColor;break}G=[],Y=ie.setFillTransparent;break}if(P.name==="Pattern"){M(h.handleColorN(s,ie.setFillColorN,G,P,y,i,t,f,m,b));return}G=[P.getRgbHex(G,0)],Y=ie.setFillRGBColor;break;case ie.setStrokeColorN:if(P=w.state.patternStrokeColorSpace,!P){if(Yr(G,null)){G=[Dn.gray.getRgbHex(G,0)],Y=ie.setStrokeRGBColor;break}G=[],Y=ie.setStrokeTransparent;break}if(P.name==="Pattern"){M(h.handleColorN(s,ie.setStrokeColorN,G,P,y,i,t,f,m,b));return}G=[P.getRgbHex(G,0)],Y=ie.setStrokeRGBColor;break;case ie.shadingFill:let de;try{const N=i.get("Shading");if(!N)throw new Te("No shading resource found");if(de=N.get(G[0].name),!de)throw new Te("No shading object found")}catch(N){if(N instanceof hr)continue;if(h.options.ignoreErrors){ae(`getOperatorList - ignoring Shading: "${N}".`);continue}throw N}const ge=h.parseShading({shading:de,resources:i,localColorSpaceCache:f,localShadingPatternCache:b});if(!ge)continue;G=[ge],Y=ie.shadingFill;break;case ie.setGState:if(Z=G[0]instanceof ve,B=G[0].name,Z){const N=g.getByName(B);if(N){N.length>0&&s.addOp(ie.setGState,[N]),G=null;continue}}M(new Promise(function(N,K){if(!Z)throw new Te("GState must be referred to by name.");const oe=i.get("ExtGState");if(!(oe instanceof ue))throw new Te("ExtGState should be a dictionary.");const W=oe.get(B);if(!(W instanceof ue))throw new Te("GState should be a dictionary.");h.setGState({resources:i,gState:W,operatorList:s,cacheKey:B,task:t,stateManager:w,localGStateCache:g,localColorSpaceCache:f,seenRefs:c}).then(N,K)}).catch(function(N){if(!(N instanceof hr)){if(h.options.ignoreErrors){ae(`getOperatorList - ignoring ExtGState: "${N}".`);return}throw N}}));return;case ie.setLineWidth:{const[N]=G;if(typeof N!="number"){ae(`Invalid setLineWidth: ${N}`);continue}G[0]=Math.abs(N);break}case ie.moveTo:case ie.lineTo:case ie.curveTo:case ie.curveTo2:case ie.curveTo3:case ie.closePath:case ie.rectangle:h.buildPath(Y,G,w.state);continue;case ie.stroke:case ie.closeStroke:case ie.fill:case ie.eoFill:case ie.fillStroke:case ie.eoFillStroke:case ie.closeFillStroke:case ie.closeEOFillStroke:case ie.endPath:{const{state:{pathBuffer:N,pathMinMax:K}}=w;(Y===ie.closeStroke||Y===ie.closeFillStroke||Y===ie.closeEOFillStroke)&&N.push(xs.closePath),N.length===0?s.addOp(ie.constructPath,[Y,[null],null]):(s.addOp(ie.constructPath,[Y,[new Float32Array(N)],K.slice()]),N.length=0,K.set([1/0,1/0,-1/0,-1/0],0));continue}case ie.setTextMatrix:s.addOp(Y,[new Float32Array(G)]);continue;case ie.markPoint:case ie.markPointProps:case ie.beginCompat:case ie.endCompat:continue;case ie.beginMarkedContentProps:if(!(G[0]instanceof ve)){ae(`Expected name for beginMarkedContentProps arg0=${G[0]}`),s.addOp(ie.beginMarkedContentProps,["OC",null]);continue}if(G[0].name==="OC"){M(h.parseMarkedContentProps(G[1],i).then(N=>{s.addOp(ie.beginMarkedContentProps,["OC",N])}).catch(N=>{if(!(N instanceof hr)){if(h.options.ignoreErrors){ae(`getOperatorList - ignoring beginMarkedContentProps: "${N}".`),s.addOp(ie.beginMarkedContentProps,["OC",null]);return}throw N}}));return}G=[G[0].name,G[1]instanceof ue?G[1].get("MCID"):null];break;case ie.beginMarkedContent:case ie.endMarkedContent:default:if(G!==null){for(R=0,z=G.length;R<z&&!(G[R]instanceof ue);R++);if(R<z){ae("getOperatorList - ignoring operator: "+Y);continue}}}s.addOp(Y,G)}if(H){M(nC);return}C(),E()}).catch(I=>{if(!(I instanceof hr)){if(this.options.ignoreErrors){ae(`getOperatorList - ignoring errors during "${t.name}" task: "${I}".`),C();return}throw I}})}getTextContent({stream:e,task:t,resources:i,stateManager:s=null,includeMarkedContent:r=!1,sink:a,seenStyles:o=new Set,viewBox:l,lang:c=null,markedContentData:h=null,disableNormalization:u=!1,keepWhiteSpace:d=!1,prevRefs:f=null,intersector:g=null}){var qe;const m=(qe=e.dict)==null?void 0:qe.objId,b=new ts(f);if(m){if(f!=null&&f.has(m))throw new Error(`getTextContent - ignoring circular reference: ${m}`);b.put(m)}i||(i=ue.empty),s||(s=new d3(new LG)),r&&(h||(h={level:0}));const p={items:[],styles:Object.create(null),lang:c},y={initialized:!1,str:[],totalWidth:0,totalHeight:0,width:0,height:0,vertical:!1,prevTransform:null,textAdvanceScale:0,spaceInFlowMin:0,spaceInFlowMax:0,trackingSpaceMin:1/0,negativeSpaceMax:-1/0,notASpace:-1/0,transform:null,fontName:null,hasEOL:!1},w=[" "," "];let _=0;function v(He){const Me=(_+1)%2,Ne=w[_]!==" "&&w[Me]===" ";return w[_]=He,_=Me,!d&&Ne}function C(){return!d&&w[_]!==" "&&w[(_+1)%2]===" "}function k(){w[0]=w[1]=" ",_=0}const I=.102,E=.03,T=-.2,M=.102,D=.6,H=.25,R=this,z=this.xref,P=[];let B=null;const Z=new Gk,G=new Vk,Y=new Lg(e,z,s);let J;function se({width:He=0,height:Me=0,transform:Ne=y.prevTransform,fontName:Qe=y.fontName}){g==null||g.addExtraChar(" "),p.items.push({str:" ",dir:"ltr",width:He,height:Me,transform:Ne,fontName:Qe,hasEOL:!1})}function fe(){const He=J.font,Me=[J.fontSize*J.textHScale,0,0,J.fontSize,0,J.textRise];if(He.isType3Font&&(J.fontSize<=1||He.isCharBBox)&&!qp(J.fontMatrix,Vd)){const Ne=He.bbox[3]-He.bbox[1];Ne>0&&(Me[3]*=Ne*J.fontMatrix[3])}return Ln.transform(J.ctm,Ln.transform(J.textMatrix,Me))}function he(){if(y.initialized)return y;const{font:He,loadedName:Me}=J;if(!o.has(Me)&&(o.add(Me),p.styles[Me]={fontFamily:He.fallbackName,ascent:He.ascent,descent:He.descent,vertical:He.vertical},R.options.fontExtraProperties&&He.systemFontInfo)){const Xe=p.styles[Me];Xe.fontSubstitution=He.systemFontInfo.css,Xe.fontSubstitutionLoadedName=He.systemFontInfo.loadedName}y.fontName=Me;const Ne=y.transform=fe();He.vertical?(y.width=y.totalWidth=Math.hypot(Ne[0],Ne[1]),y.height=y.totalHeight=0,y.vertical=!0):(y.width=y.totalWidth=0,y.height=y.totalHeight=Math.hypot(Ne[2],Ne[3]),y.vertical=!1);const Qe=Math.hypot(J.textLineMatrix[0],J.textLineMatrix[1]),gt=Math.hypot(J.ctm[0],J.ctm[1]);y.textAdvanceScale=gt*Qe;const{fontSize:mt}=J;return y.trackingSpaceMin=mt*I,y.notASpace=mt*E,y.negativeSpaceMax=mt*T,y.spaceInFlowMin=mt*M,y.spaceInFlowMax=mt*D,y.hasEOL=!1,y.initialized=!0,y}function de(){if(!y.initialized)return;const He=Math.hypot(J.textLineMatrix[0],J.textLineMatrix[1]),Ne=Math.hypot(J.ctm[0],J.ctm[1])*He;Ne!==y.textAdvanceScale&&(y.vertical?(y.totalHeight+=y.height*y.textAdvanceScale,y.height=0):(y.totalWidth+=y.width*y.textAdvanceScale,y.width=0),y.textAdvanceScale=Ne)}function ge(He){let Me=He.str.join("");u||(Me=TU(Me));const Ne=hM(Me,-1,He.vertical);return{str:Ne.str,dir:Ne.dir,width:Math.abs(He.totalWidth),height:Math.abs(He.totalHeight),transform:He.transform,fontName:He.fontName,hasEOL:He.hasEOL}}async function N(He,Me){const Ne=await R.loadFont(He,Me,i,t);J.loadedName=Ne.loadedName,J.font=Ne.font,J.fontMatrix=Ne.font.fontMatrix||Vd}function K(He,Me,Ne){const Qe=Math.hypot(Ne[0],Ne[1]);return[(Ne[0]*He+Ne[1]*Me)/Qe,(Ne[2]*He+Ne[3]*Me)/Qe]}function oe(He){var ct;const Me=fe();let Ne=Me[4],Qe=Me[5];if((ct=J.font)!=null&&ct.vertical){if(Ne<l[0]||Ne>l[2]||Qe+He<l[1]||Qe>l[3])return!1}else if(Ne+He<l[0]||Ne>l[2]||Qe<l[1]||Qe>l[3])return!1;if(!J.font||!y.prevTransform)return!0;let gt=y.prevTransform[4],mt=y.prevTransform[5];if(gt===Ne&&mt===Qe)return!0;let Xe=-1;switch(Me[0]&&Me[1]===0&&Me[2]===0?Xe=Me[0]>0?0:180:Me[1]&&Me[0]===0&&Me[3]===0&&(Xe=Me[1]>0?90:270),Xe){case 0:break;case 90:[Ne,Qe]=[Qe,Ne],[gt,mt]=[mt,gt];break;case 180:[Ne,Qe,gt,mt]=[-Ne,-Qe,-gt,-mt];break;case 270:[Ne,Qe]=[-Qe,-Ne],[gt,mt]=[-mt,-gt];break;default:[Ne,Qe]=K(Ne,Qe,Me),[gt,mt]=K(gt,mt,y.prevTransform)}if(J.font.vertical){const at=(mt-Qe)/y.textAdvanceScale,ze=Ne-gt,Ht=Math.sign(y.height);return at<Ht*y.negativeSpaceMax?Math.abs(ze)>.5*y.width?(le(),!0):(k(),Ce(),!0):Math.abs(ze)>y.width?(le(),!0):(at<=Ht*y.notASpace&&k(),at<=Ht*y.trackingSpaceMin?C()?(k(),Ce(),se({height:Math.abs(at)})):y.height+=at:ce(at,y.prevTransform,Ht)||(y.str.length===0?(k(),se({height:Math.abs(at)})):y.height+=at),Math.abs(ze)>y.width*H&&Ce(),!0)}const rt=(Ne-gt)/y.textAdvanceScale,me=Qe-mt,Rt=Math.sign(y.width);return rt<Rt*y.negativeSpaceMax?Math.abs(me)>.5*y.height?(le(),!0):(k(),Ce(),!0):Math.abs(me)>y.height?(le(),!0):(rt<=Rt*y.notASpace&&k(),rt<=Rt*y.trackingSpaceMin?C()?(k(),Ce(),se({width:Math.abs(rt)})):y.width+=rt:ce(rt,y.prevTransform,Rt)||(y.str.length===0?(k(),se({width:Math.abs(rt)})):y.width+=rt),Math.abs(me)>y.height*H&&Ce(),!0)}function W({chars:He,extraSpacing:Me}){const Ne=J.font;if(!He){const mt=J.charSpacing+Me;mt&&(Ne.vertical?J.translateTextMatrix(0,-mt):J.translateTextMatrix(mt*J.textHScale,0)),d&&oe(0);return}const Qe=Ne.charsToGlyphs(He),gt=J.fontMatrix[0]*J.fontSize;for(let mt=0,Xe=Qe.length;mt<Xe;mt++){const rt=Qe[mt],{category:me}=rt;if(me.isInvisibleFormatMark)continue;let Rt=J.charSpacing+(mt+1===Xe?Me:0),ct=rt.width;Ne.vertical&&(ct=rt.vmetric?rt.vmetric[0]:-ct);let at=ct*gt;if(!d&&me.isWhitespace){Ne.vertical?(Rt+=-at+J.wordSpacing,J.translateTextMatrix(0,-Rt)):(Rt+=at+J.wordSpacing,J.translateTextMatrix(Rt*J.textHScale,0)),v(" ");continue}if(!me.isZeroWidthDiacritic&&!oe(at)){Ne.vertical?J.translateTextMatrix(0,at):J.translateTextMatrix(at*J.textHScale,0);continue}const ze=he();me.isZeroWidthDiacritic&&(at=0),Ne.vertical?(g==null||g.addGlyph(fe(),0,at,rt.unicode),J.translateTextMatrix(0,at),at=Math.abs(at),ze.height+=at):(at*=J.textHScale,g==null||g.addGlyph(fe(),at,0,rt.unicode),J.translateTextMatrix(at,0),ze.width+=at),at&&(ze.prevTransform=fe());const Ht=rt.unicode;v(Ht)&&(ze.str.push(" "),g==null||g.addExtraChar(" ")),g||ze.str.push(Ht),Rt&&(Ne.vertical?J.translateTextMatrix(0,-Rt):J.translateTextMatrix(Rt*J.textHScale,0))}}function le(){g==null||g.addExtraChar(`
`),k(),y.initialized?(y.hasEOL=!0,Ce()):p.items.push({str:"",dir:"ltr",width:0,height:0,transform:fe(),fontName:J.loadedName,hasEOL:!0})}function ce(He,Me,Ne){if(Ne*y.spaceInFlowMin<=He&&He<=Ne*y.spaceInFlowMax)return y.initialized&&(k(),y.str.push(" "),g==null||g.addExtraChar(" ")),!1;const Qe=y.fontName;let gt=0;return y.vertical&&(gt=He,He=0),Ce(),k(),se({width:Math.abs(He),height:Math.abs(gt),transform:Me||fe(),fontName:Qe}),!0}function Ce(){!y.initialized||!y.str||(y.vertical?y.totalHeight+=y.height*y.textAdvanceScale:y.totalWidth+=y.width*y.textAdvanceScale,p.items.push(ge(y)),y.initialized=!1,y.str.length=0)}function X(He=!1){const Me=p.items.length;Me!==0&&(He&&Me<FG||(a==null||a.enqueue(p,Me),p.items=[],p.styles=Object.create(null)))}const Ke=new U3;return new Promise(function He(Me,Ne){const Qe=function(Rt){X(!0),Promise.all([Rt,a==null?void 0:a.ready]).then(function(){try{He(Me,Ne)}catch(ct){Ne(ct)}},Ne)};t.ensureNotTerminated(),Ke.reset();const gt={};let mt,Xe,rt,me=[];for(;!(mt=Ke.check())&&(me.length=0,gt.args=me,!!Y.read(gt));){const Rt=J;J=s.state;const ct=gt.fn;switch(me=gt.args,ct|0){case ie.setFont:const at=me[0].name,ze=me[1];if(J.font&&at===J.fontName&&ze===J.fontSize)break;Ce(),J.fontName=at,J.fontSize=ze,Qe(N(at,null));return;case ie.setTextRise:J.textRise=me[0];break;case ie.setHScale:J.textHScale=me[0]/100;break;case ie.setLeading:J.leading=me[0];break;case ie.moveText:J.translateTextLineMatrix(me[0],me[1]),J.textMatrix=J.textLineMatrix.slice();break;case ie.setLeadingMoveText:J.leading=-me[1],J.translateTextLineMatrix(me[0],me[1]),J.textMatrix=J.textLineMatrix.slice();break;case ie.nextLine:J.carriageReturn();break;case ie.setTextMatrix:J.setTextMatrix(me[0],me[1],me[2],me[3],me[4],me[5]),J.setTextLineMatrix(me[0],me[1],me[2],me[3],me[4],me[5]),de();break;case ie.setCharSpacing:J.charSpacing=me[0];break;case ie.setWordSpacing:J.wordSpacing=me[0];break;case ie.beginText:J.textMatrix=al.slice(),J.textLineMatrix=al.slice();break;case ie.showSpacedText:if(!s.state.font){R.ensureStateFont(s.state);continue}const Ht=(J.font.vertical?1:-1)*J.fontSize/1e3,on=me[0];for(let Re=0,Mt=on.length;Re<Mt;Re++){const yt=on[Re];if(typeof yt=="string")P.push(yt);else if(typeof yt=="number"&&yt!==0){const Gt=P.join("");P.length=0,W({chars:Gt,extraSpacing:yt*Ht})}}if(P.length>0){const Re=P.join("");P.length=0,W({chars:Re,extraSpacing:0})}break;case ie.showText:if(!s.state.font){R.ensureStateFont(s.state);continue}W({chars:me[0],extraSpacing:0});break;case ie.nextLineShowText:if(!s.state.font){R.ensureStateFont(s.state);continue}J.carriageReturn(),W({chars:me[0],extraSpacing:0});break;case ie.nextLineSetSpacingShowText:if(!s.state.font){R.ensureStateFont(s.state);continue}J.wordSpacing=me[0],J.charSpacing=me[1],J.carriageReturn(),W({chars:me[2],extraSpacing:0});break;case ie.paintXObject:if(Ce(),B??(B=i.get("XObject")||ue.empty),rt=me[0]instanceof ve,Xe=me[0].name,rt&&Z.getByName(Xe))break;Qe(new Promise(function(Re,Mt){if(!rt)throw new Te("XObject must be referred to by name.");let yt=B.getRaw(Xe);if(yt instanceof tt){if(Z.getByRef(yt)){Re();return}if(R.globalImageCache.getData(yt,R.pageIndex)){Re();return}yt=z.fetch(yt)}if(!(yt instanceof dn))throw new Te("XObject should be a stream");const{dict:Gt}=yt,un=Gt.get("Subtype");if(!(un instanceof ve))throw new Te("XObject should have a Name subtype");if(un.name!=="Form"){Z.set(Xe,Gt.objId,!0),Re();return}const Kn=s.state.clone(),di=new d3(Kn),qi=Dh(Gt.getArray("Matrix"),null);qi&&di.transform(qi);const Cs=Gt.get("Resources");X();const Wi={enqueueInvoked:!1,enqueue(Ms,Ki){this.enqueueInvoked=!0,a.enqueue(Ms,Ki)},get desiredSize(){return a.desiredSize??0},get ready(){return a.ready}};R.getTextContent({stream:yt,task:t,resources:Cs instanceof ue?Cs:i,stateManager:di,includeMarkedContent:r,sink:a&&Wi,seenStyles:o,viewBox:l,lang:c,markedContentData:h,disableNormalization:u,keepWhiteSpace:d,prevRefs:b}).then(function(){Wi.enqueueInvoked||Z.set(Xe,Gt.objId,!0),Re()},Mt)}).catch(function(Re){if(!(Re instanceof hr)){if(R.options.ignoreErrors){ae(`getTextContent - ignoring XObject: "${Re}".`);return}throw Re}}));return;case ie.setGState:if(rt=me[0]instanceof ve,Xe=me[0].name,rt&&G.getByName(Xe))break;Qe(new Promise(function(Re,Mt){if(!rt)throw new Te("GState must be referred to by name.");const yt=i.get("ExtGState");if(!(yt instanceof ue))throw new Te("ExtGState should be a dictionary.");const Gt=yt.get(Xe);if(!(Gt instanceof ue))throw new Te("GState should be a dictionary.");const un=Gt.get("Font");if(!un){G.set(Xe,Gt.objId,!0),Re();return}Ce(),J.fontName=null,J.fontSize=un[1],N(null,un[0]).then(Re,Mt)}).catch(function(Re){if(!(Re instanceof hr)){if(R.options.ignoreErrors){ae(`getTextContent - ignoring ExtGState: "${Re}".`);return}throw Re}}));return;case ie.beginMarkedContent:Ce(),r&&(h.level++,p.items.push({type:"beginMarkedContent",tag:me[0]instanceof ve?me[0].name:null}));break;case ie.beginMarkedContentProps:if(Ce(),r){h.level++;let Re=null;me[1]instanceof ue&&(Re=me[1].get("MCID")),p.items.push({type:"beginMarkedContentProps",id:Number.isInteger(Re)?`${R.idFactory.getPageObjId()}_mc${Re}`:null,tag:me[0]instanceof ve?me[0].name:null})}break;case ie.endMarkedContent:if(Ce(),r){if(h.level===0)break;h.level--,p.items.push({type:"endMarkedContent"})}break;case ie.restore:Rt&&(Rt.font!==J.font||Rt.fontSize!==J.fontSize||Rt.fontName!==J.fontName)&&Ce();break}if(p.items.length>=((a==null?void 0:a.desiredSize)??1)){mt=!0;break}}if(mt){Qe(nC);return}Ce(),X(),Me()}).catch(He=>{if(!(He instanceof hr)){if(this.options.ignoreErrors){ae(`getTextContent - ignoring errors during "${t.name}" task: "${He}".`),Ce(),X();return}throw He}})}async extractDataStructures(e,t){const i=this.xref;let s;const r=this.readToUnicode(t.toUnicode);if(t.composite){const d=e.get("CIDSystemInfo");d instanceof ue&&(t.cidSystemInfo={registry:Rn(d.get("Registry")),ordering:Rn(d.get("Ordering")),supplement:d.get("Supplement")});try{const f=e.get("CIDToGIDMap");f instanceof dn&&(s=f.getBytes())}catch(f){if(!this.options.ignoreErrors)throw f;ae(`extractDataStructures - ignoring CIDToGIDMap data: "${f}".`)}}const a=[];let o=null,l;if(e.has("Encoding")){if(l=e.get("Encoding"),l instanceof ue){if(o=l.get("BaseEncoding"),o=o instanceof ve?o.name:null,l.has("Differences")){const d=l.get("Differences");let f=0;for(const g of d){const m=i.fetchIfRef(g);if(typeof m=="number")f=m;else if(m instanceof ve)a[f++]=m.name;else throw new Te(`Invalid entry in 'Differences' array: ${m}`)}}}else if(l instanceof ve)o=l.name;else{const d="Encoding is not a Name nor a Dict";if(!this.options.ignoreErrors)throw new Te(d);ae(d)}o!=="MacRomanEncoding"&&o!=="MacExpertEncoding"&&o!=="WinAnsiEncoding"&&(o=null)}const c=!t.file||t.isInternalFont,h=e6()[t.name];if(o&&c&&h&&(o=null),o)t.defaultEncoding=Yp(o);else{const d=!!(t.flags&po.Symbolic),f=!!(t.flags&po.Nonsymbolic);l=f0,t.type==="TrueType"&&!f&&(l=Xp),(d||h)&&(l=M4,c&&(/Symbol/i.test(t.name)?l=P4:/Dingbats/i.test(t.name)?l=N4:/Wingdings/i.test(t.name)&&(l=Xp))),t.defaultEncoding=l}t.differences=a,t.baseEncodingName=o,t.hasEncoding=!!o||a.length>0,t.dict=e,t.toUnicode=await r;const u=await this.buildToUnicode(t);return t.toUnicode=u,s&&(t.cidToGidMap=this.readCidToGidMap(s,u)),t}_simpleFontToUnicode(e,t=!1){qs(!e.composite,"Must be a simple font.");const i=[],s=e.defaultEncoding.slice(),r=e.baseEncodingName,a=e.differences;for(const l in a){const c=a[l];c!==".notdef"&&(s[l]=c)}const o=$l();for(const l in s){let c=s[l];if(c==="")continue;let h=o[c];if(h!==void 0){i[l]=String.fromCharCode(h);continue}let u=0;switch(c[0]){case"G":c.length===3&&(u=parseInt(c.substring(1),16));break;case"g":c.length===5&&(u=parseInt(c.substring(1),16));break;case"C":case"c":if(c.length>=3&&c.length<=4){const d=c.substring(1);if(t){u=parseInt(d,16);break}if(u=+d,Number.isNaN(u)&&Number.isInteger(parseInt(d,16)))return this._simpleFontToUnicode(e,!0)}break;case"u":h=Dg(c,o),h!==-1&&(u=h);break;default:switch(c){case"f_h":case"f_t":case"T_h":i[l]=c.replaceAll("_","");continue}break}if(u>0&&u<=1114111&&Number.isInteger(u)){if(r&&u===+l){const d=Yp(r);if(d&&(c=d[l])){i[l]=String.fromCharCode(o[c]);continue}}i[l]=String.fromCodePoint(u)}}return i}async buildToUnicode(e){var t,i;if(e.hasIncludedToUnicodeMap=((t=e.toUnicode)==null?void 0:t.length)>0,e.hasIncludedToUnicodeMap)return!e.composite&&e.hasEncoding&&(e.fallbackToUnicode=this._simpleFontToUnicode(e)),e.toUnicode;if(!e.composite)return new pp(this._simpleFontToUnicode(e));if(e.composite&&(e.cMap.builtInCMap&&!(e.cMap instanceof c1)||((i=e.cidSystemInfo)==null?void 0:i.registry)==="Adobe"&&(e.cidSystemInfo.ordering==="GB1"||e.cidSystemInfo.ordering==="CNS1"||e.cidSystemInfo.ordering==="Japan1"||e.cidSystemInfo.ordering==="Korea1"))){const{registry:s,ordering:r}=e.cidSystemInfo,a=ve.get(`${s}-${r}-UCS2`),o=await e9.create({encoding:a,fetchBuiltInCMap:this._fetchBuiltInCMapBound,useCMap:null}),l=[],c=[];return e.cMap.forEach(function(h,u){if(u>65535)throw new Te("Max size of CID is 65,535");const d=o.lookup(u);if(d){c.length=0;for(let f=0,g=d.length;f<g;f+=2)c.push((d.charCodeAt(f)<<8)+d.charCodeAt(f+1));l[h]=String.fromCharCode(...c)}}),new pp(l)}return new yo(e.firstChar,e.lastChar)}async readToUnicode(e){if(!e)return null;if(e instanceof ve){const t=await e9.create({encoding:e,fetchBuiltInCMap:this._fetchBuiltInCMapBound,useCMap:null});return t instanceof c1?new yo(0,65535):new pp(t.getMap())}if(e instanceof dn)try{const t=await e9.create({encoding:e,fetchBuiltInCMap:this._fetchBuiltInCMapBound,useCMap:null});if(t instanceof c1)return new yo(0,65535);const i=new Array(t.length);return t.forEach(function(s,r){if(typeof r=="number"){i[s]=String.fromCodePoint(r);return}r.length%2!==0&&(r="\0"+r);const a=[];for(let o=0;o<r.length;o+=2){const l=r.charCodeAt(o)<<8|r.charCodeAt(o+1);if((l&63488)!==55296){a.push(l);continue}o+=2;const c=r.charCodeAt(o)<<8|r.charCodeAt(o+1);a.push(((l&1023)<<10)+(c&1023)+65536)}i[s]=String.fromCodePoint(...a)}),new pp(i)}catch(t){if(t instanceof hr)return null;if(this.options.ignoreErrors)return ae(`readToUnicode - ignoring ToUnicode data: "${t}".`),null;throw t}return null}readCidToGidMap(e,t){const i=[];for(let s=0,r=e.length;s<r;s++){const a=e[s++]<<8|e[s],o=s>>1;a===0&&!t.has(o)||(i[o]=a)}return i}extractWidths(e,t,i){const s=this.xref;let r=[],a=0;const o=[];let l;if(i.composite){const u=e.get("DW");a=typeof u=="number"?Math.ceil(u):1e3;const d=e.get("W");if(Array.isArray(d))for(let f=0,g=d.length;f<g;f++){let m=s.fetchIfRef(d[f++]);if(!Number.isInteger(m))break;const b=s.fetchIfRef(d[f]);if(Array.isArray(b))for(const p of b){const y=s.fetchIfRef(p);typeof y=="number"&&(r[m]=y),m++}else if(Number.isInteger(b)){const p=s.fetchIfRef(d[++f]);if(typeof p!="number")continue;for(let y=m;y<=b;y++)r[y]=p}else break}if(i.vertical){const f=e.getArray("DW2");let g=Yr(f,2)?f:[880,-1e3];if(l=[g[1],a*.5,g[0]],g=e.get("W2"),Array.isArray(g))for(let m=0,b=g.length;m<b;m++){let p=s.fetchIfRef(g[m++]);if(!Number.isInteger(p))break;const y=s.fetchIfRef(g[m]);if(Array.isArray(y))for(let w=0,_=y.length;w<_;w++){const v=[s.fetchIfRef(y[w++]),s.fetchIfRef(y[w++]),s.fetchIfRef(y[w])];Yr(v,null)&&(o[p]=v),p++}else if(Number.isInteger(y)){const w=[s.fetchIfRef(g[++m]),s.fetchIfRef(g[++m]),s.fetchIfRef(g[++m])];if(!Yr(w,null))continue;for(let _=p;_<=y;_++)o[_]=w}else break}}}else{const u=e.get("Widths");if(Array.isArray(u)){let d=i.firstChar;for(const g of u){const m=s.fetchIfRef(g);typeof m=="number"&&(r[d]=m),d++}const f=t.get("MissingWidth");a=typeof f=="number"?f:0}else{const d=e.get("BaseFont");if(d instanceof ve){const f=this.getBaseFontMetrics(d.name);r=this.buildCharCodeToWidth(f.widths,i),a=f.defaultWidth}}}let c=!0,h=a;for(const u in r){const d=r[u];if(d){if(!h){h=d;continue}if(h!==d){c=!1;break}}}c?i.flags|=po.FixedPitch:i.flags&=~po.FixedPitch,i.defaultWidth=a,i.widths=r,i.defaultVMetrics=l,i.vmetrics=o}isSerifFont(e){const t=e.split("-",1)[0];return t in F4()||/serif/gi.test(t)}getBaseFontMetrics(e){let t=0,i=Object.create(null),s=!1,a=hy()[e]||e;const o=Yz();a in o||(a=this.isSerifFont(e)?"Times-Roman":"Helvetica");const l=o[a];return typeof l=="number"?(t=l,s=!0):i=l(),{defaultWidth:t,monospace:s,widths:i}}buildCharCodeToWidth(e,t){const i=Object.create(null),s=t.differences,r=t.defaultEncoding;for(let a=0;a<256;a++){if(a in s&&e[s[a]]){i[a]=e[s[a]];continue}if(a in r&&e[r[a]]){i[a]=e[r[a]];continue}}return i}preEvaluateFont(e){const t=e;let i=e.get("Subtype");if(!(i instanceof ve))throw new Te("invalid font Subtype");let s=!1,r;if(i.name==="Type0"){const h=e.get("DescendantFonts");if(!h)throw new Te("Descendant fonts are not specified");if(e=Array.isArray(h)?this.xref.fetchIfRef(h[0]):h,!(e instanceof ue))throw new Te("Descendant font is not a dictionary.");if(i=e.get("Subtype"),!(i instanceof ve))throw new Te("invalid font Subtype");s=!0}let a=e.get("FirstChar");Number.isInteger(a)||(a=0);let o=e.get("LastChar");Number.isInteger(o)||(o=s?65535:255);const l=e.get("FontDescriptor"),c=e.get("ToUnicode")||t.get("ToUnicode");if(l){r=new OG;const h=t.getRaw("Encoding");if(h instanceof ve)r.update(h.name);else if(h instanceof tt)r.update(h.toString());else if(h instanceof ue){for(const d of h.getRawValues())if(d instanceof ve)r.update(d.name);else if(d instanceof tt)r.update(d.toString());else if(Array.isArray(d)){const f=d.length,g=new Array(f);for(let m=0;m<f;m++){const b=d[m];b instanceof ve?g[m]=b.name:(typeof b=="number"||b instanceof tt)&&(g[m]=b.toString())}r.update(g.join())}}if(r.update(`${a}-${o}`),c instanceof dn){const d=c.str||c,f=d.buffer?new Uint8Array(d.buffer.buffer,0,d.bufferLength):new Uint8Array(d.bytes.buffer,d.start,d.end-d.start);r.update(f)}else c instanceof ve&&r.update(c.name);const u=e.get("Widths")||t.get("Widths");if(Array.isArray(u)){const d=[];for(const f of u)(typeof f=="number"||f instanceof tt)&&d.push(f.toString());r.update(d.join())}if(s){r.update("compositeFont");const d=e.get("W")||t.get("W");if(Array.isArray(d)){const g=[];for(const m of d)if(typeof m=="number"||m instanceof tt)g.push(m.toString());else if(Array.isArray(m)){const b=[];for(const p of m)(typeof p=="number"||p instanceof tt)&&b.push(p.toString());g.push(`[${b.join()}]`)}r.update(g.join())}const f=e.getRaw("CIDToGIDMap")||t.getRaw("CIDToGIDMap");f instanceof ve?r.update(f.name):f instanceof tt?r.update(f.toString()):f instanceof dn&&r.update(f.peekBytes())}}return{descriptor:l,dict:e,baseDict:t,composite:s,type:i.name,firstChar:a,lastChar:o,toUnicode:c,hash:r?r.hexdigest():""}}async translateFont({descriptor:e,dict:t,baseDict:i,composite:s,type:r,firstChar:a,lastChar:o,toUnicode:l,cssFontInfo:c}){const h=r==="Type3";if(!e)if(h)e=ue.empty;else{let B=t.get("BaseFont");if(!(B instanceof ve))throw new Te("Base font is not specified");B=B.name.replaceAll(/[,_]/g,"-");const Z=this.getBaseFontMetrics(B),G=B.split("-",1)[0],Y=(this.isSerifFont(G)?po.Serif:0)|(Z.monospace?po.FixedPitch:0)|(e6()[G]?po.Symbolic:po.Nonsymbolic),J={type:r,name:B,loadedName:i.loadedName,systemFontInfo:null,widths:Z.widths,defaultWidth:Z.defaultWidth,isSimulatedFlags:!0,flags:Y,firstChar:a,lastChar:o,toUnicode:l,xHeight:0,capHeight:0,italicAngle:0,isType3Font:h},se=t.get("Widths"),fe=_k(B);let he=null;fe&&(he=await this.fetchStandardFontData(fe),J.isInternalFont=!!he),!J.isInternalFont&&this.options.useSystemFonts&&(J.systemFontInfo=Qk(this.systemFontCache,this.idFactory,this.options.standardFontDataUrl,B,fe,r));const de=await this.extractDataStructures(t,J);if(Array.isArray(se)){const ge=[];let N=a;for(const K of se){const oe=this.xref.fetchIfRef(K);typeof oe=="number"&&(ge[N]=oe),N++}de.widths=ge}else de.widths=this.buildCharCodeToWidth(Z.widths,de);return new Uk(B,he,de,this.options)}let u=e.get("FontName"),d=t.get("BaseFont");typeof u=="string"&&(u=ve.get(u)),typeof d=="string"&&(d=ve.get(d));const f=u==null?void 0:u.name,g=d==null?void 0:d.name;if(h?f||(u=ve.get(r)):f!==g&&(gn(`The FontDescriptor's FontName is "${f}" but should be the same as the Font's BaseFont "${g}".`),f&&g&&(g.startsWith(f)||!vk(f)&&vk(g))&&(u=null),u||(u=d)),!(u instanceof ve))throw new Te("invalid font name");let m,b,p,y,w;try{if(m=e.get("FontFile","FontFile2","FontFile3"),m)if(m instanceof dn){if(m.isEmpty)throw new Te("FontFile is empty")}else throw new Te("FontFile should be a stream")}catch(B){if(!this.options.ignoreErrors)throw B;ae(`translateFont - fetching "${u.name}" font file: "${B}".`),m=null}let _=!1,v=null,C=null;if(m){if(m.dict){const B=m.dict.get("Subtype");B instanceof ve&&(b=B.name),p=m.dict.get("Length1"),y=m.dict.get("Length2"),w=m.dict.get("Length3")}}else if(c){const B=H4(u.name);B&&(c.fontFamily=`${c.fontFamily}-PdfJS-XFA`,c.metrics=B.metrics||null,v=B.factors||null,m=await this.fetchStandardFontData(B.name),_=!!m,i=t=aM(u.name),s=!0)}else if(!h){const B=_k(u.name);B&&(m=await this.fetchStandardFontData(B),_=!!m),!_&&this.options.useSystemFonts&&(C=Qk(this.systemFontCache,this.idFactory,this.options.standardFontDataUrl,u.name,B,r))}const k=Dh(t.getArray("FontMatrix"),Vd),I=A0(e.getArray("FontBBox")||t.getArray("FontBBox"),h?[0,0,0,0]:void 0);let E=e.get("Ascent");typeof E!="number"&&(E=void 0);let T=e.get("Descent");typeof T!="number"&&(T=void 0);let M=e.get("XHeight");typeof M!="number"&&(M=0);let D=e.get("CapHeight");typeof D!="number"&&(D=0);let H=e.get("Flags");Number.isInteger(H)||(H=0);let R=e.get("ItalicAngle");typeof R!="number"&&(R=0);const z={type:r,name:u.name,subtype:b,file:m,length1:p,length2:y,length3:w,isInternalFont:_,loadedName:i.loadedName,composite:s,fixedPitch:!1,fontMatrix:k,firstChar:a,lastChar:o,toUnicode:l,bbox:I,ascent:E,descent:T,xHeight:M,capHeight:D,flags:H,italicAngle:R,isType3Font:h,cssFontInfo:c,scaleFactors:v,systemFontInfo:C};if(s){const B=i.get("Encoding");B instanceof ve&&(z.cidEncoding=B.name);const Z=await e9.create({encoding:B,fetchBuiltInCMap:this._fetchBuiltInCMapBound,useCMap:null});z.cMap=Z,z.vertical=z.cMap.vertical}const P=await this.extractDataStructures(t,z);return this.extractWidths(t,e,P),new Uk(u.name,m,P,this.options)}static buildFontPaths(e,t,i,s){function r(a){const o=`${e.loadedName}_path_${a}`;try{if(e.renderer.hasBuiltPath(a))return;i.send("commonobj",[o,"FontPath",e.renderer.getPathJs(a)])}catch(l){if(s.ignoreErrors){ae(`buildFontPaths - ignoring ${o} glyph: "${l}".`);return}throw l}}for(const a of t){r(a.fontChar);const o=a.accent;o!=null&&o.fontChar&&r(o.fontChar)}}static get fallbackFontDict(){const e=new ue;return e.set("BaseFont",ve.get("Helvetica")),e.set("Type",ve.get("FallbackType")),e.set("Subtype",ve.get("FallbackType")),e.set("Encoding",ve.get("WinAnsiEncoding")),We(this,"fallbackFontDict",e)}}var nx,Ud,Jg,dM,fM;class Lw{constructor({loadedName:e,font:t,dict:i}){U(this,Jg);U(this,nx,!1);U(this,Ud,null);this.loadedName=e,this.font=t,this.dict=i,this.type3Dependencies=t.isType3Font?new Set:null}send(e){x(this,nx)||(O(this,nx,!0),e.send("commonobj",[this.loadedName,"Font",this.font.exportData()]))}fallback(e,t){this.font.data&&(this.font.disableFontFace=!0,Fg.buildFontPaths(this.font,this.font.glyphCacheValues,e,t))}loadType3Data(e,t,i){if(x(this,Ud))return x(this,Ud);const{font:s,type3Dependencies:r}=this;qs(s.isType3Font,"Must be a Type3 font.");const a=e.clone({ignoreErrors:!1}),o=new ts(e.type3FontRefs);this.dict.objId&&!o.has(this.dict.objId)&&o.put(this.dict.objId),a.type3FontRefs=o;let l=Promise.resolve();const c=this.dict.get("CharProcs"),h=this.dict.get("Resources")||t,u=Object.create(null),[d,f,g,m]=s.bbox,b=g-d,p=m-f,y=Math.hypot(b,p);for(const w of c.getKeys())l=l.then(()=>{const _=c.get(w),v=new Pr;return a.getOperatorList({stream:_,task:i,resources:h,operatorList:v}).then(()=>{switch(v.fnArray[0]){case ie.setCharWidthAndBounds:F(this,Jg,dM).call(this,v,y);break;case ie.setCharWidth:y||F(this,Jg,fM).call(this,v);break}u[w]=v.getIR();for(const C of v.dependencies)r.add(C)}).catch(function(C){ae(`Type3 font resource "${w}" is not available.`);const k=new Pr;u[w]=k.getIR()})});return O(this,Ud,l.then(()=>{s.charProcOperatorList=u,this._bbox&&(s.isCharBBox=!0,s.bbox=this._bbox)})),x(this,Ud)}}nx=new WeakMap,Ud=new WeakMap,Jg=new WeakSet,dM=function(e,t=NaN){const i=Ln.normalizeRect(e.argsArray[0].slice(2)),s=i[2]-i[0],r=i[3]-i[1],a=Math.hypot(s,r);s===0||r===0?(e.fnArray.splice(0,1),e.argsArray.splice(0,1)):(t===0||Math.round(a/t)>=10)&&(this._bbox??(this._bbox=[1/0,1/0,-1/0,-1/0]),Ln.rectBoundingBox(...i,this._bbox));let o=0,l=e.length;for(;o<l;){switch(e.fnArray[o]){case ie.setCharWidthAndBounds:break;case ie.setStrokeColorSpace:case ie.setFillColorSpace:case ie.setStrokeColor:case ie.setStrokeColorN:case ie.setFillColor:case ie.setFillColorN:case ie.setStrokeGray:case ie.setFillGray:case ie.setStrokeRGBColor:case ie.setFillRGBColor:case ie.setStrokeCMYKColor:case ie.setFillCMYKColor:case ie.shadingFill:case ie.setRenderingIntent:e.fnArray.splice(o,1),e.argsArray.splice(o,1),l--;continue;case ie.setGState:const[c]=e.argsArray[o];let h=0,u=c.length;for(;h<u;){const[d]=c[h];switch(d){case"TR":case"TR2":case"HT":case"BG":case"BG2":case"UCR":case"UCR2":c.splice(h,1),u--;continue}h++}break}o++}},fM=function(e){let t=1;const i=e.length;for(;t<i;){switch(e.fnArray[t]){case ie.constructPath:const s=e.argsArray[t][2];this._bbox??(this._bbox=[1/0,1/0,-1/0,-1/0]),Ln.rectBoundingBox(...s,this._bbox);break}t++}};class d3{constructor(e=new gM){this.state=e,this.stateStack=[]}save(){const e=this.state;this.stateStack.push(this.state),this.state=e.clone()}restore(){const e=this.stateStack.pop();e&&(this.state=e)}transform(e){this.state.ctm=Ln.transform(this.state.ctm,e)}}class LG{constructor(){this.ctm=new Float32Array(al),this.fontName=null,this.fontSize=0,this.loadedName=null,this.font=null,this.fontMatrix=Vd,this.textMatrix=al.slice(),this.textLineMatrix=al.slice(),this.charSpacing=0,this.wordSpacing=0,this.leading=0,this.textHScale=1,this.textRise=0}setTextMatrix(e,t,i,s,r,a){const o=this.textMatrix;o[0]=e,o[1]=t,o[2]=i,o[3]=s,o[4]=r,o[5]=a}setTextLineMatrix(e,t,i,s,r,a){const o=this.textLineMatrix;o[0]=e,o[1]=t,o[2]=i,o[3]=s,o[4]=r,o[5]=a}translateTextMatrix(e,t){const i=this.textMatrix;i[4]=i[0]*e+i[2]*t+i[4],i[5]=i[1]*e+i[3]*t+i[5]}translateTextLineMatrix(e,t){const i=this.textLineMatrix;i[4]=i[0]*e+i[2]*t+i[4],i[5]=i[1]*e+i[3]*t+i[5]}carriageReturn(){this.translateTextLineMatrix(0,-this.leading),this.textMatrix=this.textLineMatrix.slice()}clone(){const e=Object.create(this);return e.textMatrix=this.textMatrix.slice(),e.textLineMatrix=this.textLineMatrix.slice(),e.fontMatrix=this.fontMatrix.slice(),e}}class gM{constructor(){this.ctm=new Float32Array(al),this.font=null,this.textRenderingMode=gR.FILL,this._fillColorSpace=this._strokeColorSpace=Dn.gray,this.patternFillColorSpace=null,this.patternStrokeColorSpace=null,this.currentPointX=this.currentPointY=0,this.pathMinMax=new Float32Array([1/0,1/0,-1/0,-1/0]),this.pathBuffer=[]}get fillColorSpace(){return this._fillColorSpace}set fillColorSpace(e){this._fillColorSpace=this.patternFillColorSpace=e}get strokeColorSpace(){return this._strokeColorSpace}set strokeColorSpace(e){this._strokeColorSpace=this.patternStrokeColorSpace=e}clone({newPath:e=!1}={}){const t=Object.create(this);return e&&(t.pathBuffer=[],t.pathMinMax=new Float32Array([1/0,1/0,-1/0,-1/0])),t}}const Qf=class Qf{static get opMap(){return We(this,"opMap",Object.assign(Object.create(null),{w:{id:ie.setLineWidth,numArgs:1,variableArgs:!1},J:{id:ie.setLineCap,numArgs:1,variableArgs:!1},j:{id:ie.setLineJoin,numArgs:1,variableArgs:!1},M:{id:ie.setMiterLimit,numArgs:1,variableArgs:!1},d:{id:ie.setDash,numArgs:2,variableArgs:!1},ri:{id:ie.setRenderingIntent,numArgs:1,variableArgs:!1},i:{id:ie.setFlatness,numArgs:1,variableArgs:!1},gs:{id:ie.setGState,numArgs:1,variableArgs:!1},q:{id:ie.save,numArgs:0,variableArgs:!1},Q:{id:ie.restore,numArgs:0,variableArgs:!1},cm:{id:ie.transform,numArgs:6,variableArgs:!1},m:{id:ie.moveTo,numArgs:2,variableArgs:!1},l:{id:ie.lineTo,numArgs:2,variableArgs:!1},c:{id:ie.curveTo,numArgs:6,variableArgs:!1},v:{id:ie.curveTo2,numArgs:4,variableArgs:!1},y:{id:ie.curveTo3,numArgs:4,variableArgs:!1},h:{id:ie.closePath,numArgs:0,variableArgs:!1},re:{id:ie.rectangle,numArgs:4,variableArgs:!1},S:{id:ie.stroke,numArgs:0,variableArgs:!1},s:{id:ie.closeStroke,numArgs:0,variableArgs:!1},f:{id:ie.fill,numArgs:0,variableArgs:!1},F:{id:ie.fill,numArgs:0,variableArgs:!1},"f*":{id:ie.eoFill,numArgs:0,variableArgs:!1},B:{id:ie.fillStroke,numArgs:0,variableArgs:!1},"B*":{id:ie.eoFillStroke,numArgs:0,variableArgs:!1},b:{id:ie.closeFillStroke,numArgs:0,variableArgs:!1},"b*":{id:ie.closeEOFillStroke,numArgs:0,variableArgs:!1},n:{id:ie.endPath,numArgs:0,variableArgs:!1},W:{id:ie.clip,numArgs:0,variableArgs:!1},"W*":{id:ie.eoClip,numArgs:0,variableArgs:!1},BT:{id:ie.beginText,numArgs:0,variableArgs:!1},ET:{id:ie.endText,numArgs:0,variableArgs:!1},Tc:{id:ie.setCharSpacing,numArgs:1,variableArgs:!1},Tw:{id:ie.setWordSpacing,numArgs:1,variableArgs:!1},Tz:{id:ie.setHScale,numArgs:1,variableArgs:!1},TL:{id:ie.setLeading,numArgs:1,variableArgs:!1},Tf:{id:ie.setFont,numArgs:2,variableArgs:!1},Tr:{id:ie.setTextRenderingMode,numArgs:1,variableArgs:!1},Ts:{id:ie.setTextRise,numArgs:1,variableArgs:!1},Td:{id:ie.moveText,numArgs:2,variableArgs:!1},TD:{id:ie.setLeadingMoveText,numArgs:2,variableArgs:!1},Tm:{id:ie.setTextMatrix,numArgs:6,variableArgs:!1},"T*":{id:ie.nextLine,numArgs:0,variableArgs:!1},Tj:{id:ie.showText,numArgs:1,variableArgs:!1},TJ:{id:ie.showSpacedText,numArgs:1,variableArgs:!1},"'":{id:ie.nextLineShowText,numArgs:1,variableArgs:!1},'"':{id:ie.nextLineSetSpacingShowText,numArgs:3,variableArgs:!1},d0:{id:ie.setCharWidth,numArgs:2,variableArgs:!1},d1:{id:ie.setCharWidthAndBounds,numArgs:6,variableArgs:!1},CS:{id:ie.setStrokeColorSpace,numArgs:1,variableArgs:!1},cs:{id:ie.setFillColorSpace,numArgs:1,variableArgs:!1},SC:{id:ie.setStrokeColor,numArgs:4,variableArgs:!0},SCN:{id:ie.setStrokeColorN,numArgs:33,variableArgs:!0},sc:{id:ie.setFillColor,numArgs:4,variableArgs:!0},scn:{id:ie.setFillColorN,numArgs:33,variableArgs:!0},G:{id:ie.setStrokeGray,numArgs:1,variableArgs:!1},g:{id:ie.setFillGray,numArgs:1,variableArgs:!1},RG:{id:ie.setStrokeRGBColor,numArgs:3,variableArgs:!1},rg:{id:ie.setFillRGBColor,numArgs:3,variableArgs:!1},K:{id:ie.setStrokeCMYKColor,numArgs:4,variableArgs:!1},k:{id:ie.setFillCMYKColor,numArgs:4,variableArgs:!1},sh:{id:ie.shadingFill,numArgs:1,variableArgs:!1},BI:{id:ie.beginInlineImage,numArgs:0,variableArgs:!1},ID:{id:ie.beginImageData,numArgs:0,variableArgs:!1},EI:{id:ie.endInlineImage,numArgs:1,variableArgs:!1},Do:{id:ie.paintXObject,numArgs:1,variableArgs:!1},MP:{id:ie.markPoint,numArgs:1,variableArgs:!1},DP:{id:ie.markPointProps,numArgs:2,variableArgs:!1},BMC:{id:ie.beginMarkedContent,numArgs:1,variableArgs:!1},BDC:{id:ie.beginMarkedContentProps,numArgs:2,variableArgs:!1},EMC:{id:ie.endMarkedContent,numArgs:0,variableArgs:!1},BX:{id:ie.beginCompat,numArgs:0,variableArgs:!1},EX:{id:ie.endCompat,numArgs:0,variableArgs:!1},BM:null,BD:null,true:null,fa:null,fal:null,fals:null,false:null,nu:null,nul:null,null:null}))}constructor(e,t,i=new d3){this.parser=new F0({lexer:new Qo(e,Qf.opMap),xref:t}),this.stateManager=i,this.nonProcessedArgs=[],this._isPathOp=!1,this._numInvalidPathOPS=0}get savedStatesDepth(){return this.stateManager.stateStack.length}read(e){let t=e.args;for(;;){const i=this.parser.getObj();if(i instanceof ls){const s=i.cmd,r=Qf.opMap[s];if(!r){ae(`Unknown command "${s}".`);continue}const a=r.id,o=r.numArgs;let l=t!==null?t.length:0;if(this._isPathOp||(this._numInvalidPathOPS=0),this._isPathOp=a>=ie.moveTo&&a<=ie.endPath,r.variableArgs)l>o&&gn(`Command ${s}: expected [0, ${o}] args, but received ${l} args.`);else{if(l!==o){const c=this.nonProcessedArgs;for(;l>o;)c.push(t.shift()),l--;for(;l<o&&c.length!==0;)t===null&&(t=[]),t.unshift(c.pop()),l++}if(l<o){const c=`command ${s}: expected ${o} args, but received ${l} args.`;if(this._isPathOp&&++this._numInvalidPathOPS>Qf.MAX_INVALID_PATH_OPS)throw new Te(`Invalid ${c}`);ae(`Skipping ${c}`),t!==null&&(t.length=0);continue}}return this.preprocessCommand(a,t),e.fn=a,e.args=t,!0}if(i===Gs)return!1;if(i!==null&&(t===null&&(t=[]),t.push(i),t.length>33))throw new Te("Too many arguments")}}preprocessCommand(e,t){switch(e|0){case ie.save:this.stateManager.save();break;case ie.restore:this.stateManager.restore();break;case ie.transform:this.stateManager.transform(t);break}}};Ue(Qf,"MAX_INVALID_PATH_OPS",10);let Lg=Qf;class BG extends Lg{constructor(e){super(new ta(e))}parse(){const e={fn:0,args:[]},t={fontSize:0,fontName:"",fontColor:new Uint8ClampedArray(3)};try{for(;e.args.length=0,!!this.read(e);){if(this.savedStatesDepth!==0)continue;const{fn:i,args:s}=e;switch(i|0){case ie.setFont:const[r,a]=s;r instanceof ve&&(t.fontName=r.name),typeof a=="number"&&a>0&&(t.fontSize=a);break;case ie.setFillRGBColor:Dn.rgb.getRgbItem(s,0,t.fontColor,0);break;case ie.setFillGray:Dn.gray.getRgbItem(s,0,t.fontColor,0);break;case ie.setFillCMYKColor:Dn.cmyk.getRgbItem(s,0,t.fontColor,0);break}}}catch(i){ae(`parseDefaultAppearance - ignoring errors: "${i}".`)}return t}}function j4(n){return new BG(n).parse()}class UG extends Lg{constructor(e,t,i,s){var r;super(e),this.stream=e,this.evaluatorOptions=t,this.xref=i,this.globalColorSpaceCache=s,this.resources=(r=e.dict)==null?void 0:r.get("Resources")}parse(){const e={fn:0,args:[]};let t={scaleFactor:1,fontSize:0,fontName:"",fontColor:new Uint8ClampedArray(3),fillColorSpace:Dn.gray},i=!1;const s=[];try{for(;e.args.length=0,!(i||!this.read(e));){const{fn:r,args:a}=e;switch(r|0){case ie.save:s.push({scaleFactor:t.scaleFactor,fontSize:t.fontSize,fontName:t.fontName,fontColor:t.fontColor.slice(),fillColorSpace:t.fillColorSpace});break;case ie.restore:t=s.pop()||t;break;case ie.setTextMatrix:t.scaleFactor*=Math.hypot(a[0],a[1]);break;case ie.setFont:const[o,l]=a;o instanceof ve&&(t.fontName=o.name),typeof l=="number"&&l>0&&(t.fontSize=l*t.scaleFactor);break;case ie.setFillColorSpace:t.fillColorSpace=Dn.parse({cs:a[0],xref:this.xref,resources:this.resources,pdfFunctionFactory:this._pdfFunctionFactory,globalColorSpaceCache:this.globalColorSpaceCache,localColorSpaceCache:this._localColorSpaceCache});break;case ie.setFillColor:t.fillColorSpace.getRgbItem(a,0,t.fontColor,0);break;case ie.setFillRGBColor:Dn.rgb.getRgbItem(a,0,t.fontColor,0);break;case ie.setFillGray:Dn.gray.getRgbItem(a,0,t.fontColor,0);break;case ie.setFillCMYKColor:Dn.cmyk.getRgbItem(a,0,t.fontColor,0);break;case ie.showText:case ie.showSpacedText:case ie.nextLineShowText:case ie.nextLineSetSpacingShowText:i=!0;break}}}catch(r){ae(`parseAppearanceStream - ignoring errors: "${r}".`)}return this.stream.reset(),delete t.scaleFactor,delete t.fillColorSpace,t}get _localColorSpaceCache(){return We(this,"_localColorSpaceCache",new oM)}get _pdfFunctionFactory(){const e=new cM({xref:this.xref,isEvalSupported:this.evaluatorOptions.isEvalSupported});return We(this,"_pdfFunctionFactory",e)}}function HG(n,e,t,i){return new UG(n,e,t,i).parse()}function hc(n,e){if(n[0]===n[1]&&n[1]===n[2]){const t=n[0]/255;return`${kn(t)} ${e?"g":"G"}`}return Array.from(n,t=>kn(t/255)).join(" ")+` ${e?"rg":"RG"}`}function zG({fontSize:n,fontName:e,fontColor:t}){return`/${I4(e)} ${n} Tf ${hc(t,!0)}`}class Jl{constructor(e,t){this.xref=e,this.widths=null,this.firstChar=1/0,this.lastChar=-1/0,this.fontFamily=t;const i=new OffscreenCanvas(1,1);this.ctxMeasure=i.getContext("2d",{willReadFrequently:!0}),Jl._fontNameId||(Jl._fontNameId=1),this.fontName=ve.get(`InvalidPDFjsFont_${t}_${Jl._fontNameId++}`)}get fontDescriptorRef(){if(!Jl._fontDescriptorRef){const e=new ue(this.xref);e.set("Type",ve.get("FontDescriptor")),e.set("FontName",this.fontName),e.set("FontFamily","MyriadPro Regular"),e.set("FontBBox",[0,0,0,0]),e.set("FontStretch",ve.get("Normal")),e.set("FontWeight",400),e.set("ItalicAngle",0),Jl._fontDescriptorRef=this.xref.getNewPersistentRef(e)}return Jl._fontDescriptorRef}get descendantFontRef(){const e=new ue(this.xref);e.set("BaseFont",this.fontName),e.set("Type",ve.get("Font")),e.set("Subtype",ve.get("CIDFontType0")),e.set("CIDToGIDMap",ve.get("Identity")),e.set("FirstChar",this.firstChar),e.set("LastChar",this.lastChar),e.set("FontDescriptor",this.fontDescriptorRef),e.set("DW",1e3);const t=[],i=[...this.widths.entries()].sort();let s=null,r=null;for(const[o,l]of i){if(!s){s=o,r=[l];continue}o===s+r.length?r.push(l):(t.push(s,r),s=o,r=[l])}s&&t.push(s,r),e.set("W",t);const a=new ue(this.xref);return a.set("Ordering","Identity"),a.set("Registry","Adobe"),a.set("Supplement",0),e.set("CIDSystemInfo",a),this.xref.getNewPersistentRef(e)}get baseFontRef(){const e=new ue(this.xref);return e.set("BaseFont",this.fontName),e.set("Type",ve.get("Font")),e.set("Subtype",ve.get("Type0")),e.set("Encoding",ve.get("Identity-H")),e.set("DescendantFonts",[this.descendantFontRef]),e.set("ToUnicode",ve.get("Identity-H")),this.xref.getNewPersistentRef(e)}get resources(){const e=new ue(this.xref),t=new ue(this.xref);return t.set(this.fontName.name,this.baseFontRef),e.set("Font",t),e}_createContext(){return this.widths=new Map,this.ctxMeasure.font=`1000px ${this.fontFamily}`,this.ctxMeasure}createFontResources(e){const t=this._createContext();for(const i of e.split(/\r\n?|\n/))for(const s of i.split("")){const r=s.charCodeAt(0);if(this.widths.has(r))continue;const a=t.measureText(s),o=Math.ceil(a.width);this.widths.set(r,o),this.firstChar=Math.min(r,this.firstChar),this.lastChar=Math.max(r,this.lastChar)}return this.resources}static getFirstPositionInfo(e,t,i){const[s,r,a,o]=e;let l=a-s,c=o-r;t%180!==0&&([l,c]=[c,l]);const h=d0*i,u=M3*i;return{coords:[0,c+u-h],bbox:[0,0,l,c],matrix:t!==0?D3(t,c,h):void 0}}createAppearance(e,t,i,s,r,a){const o=this._createContext(),l=[];let c=-1/0;for(const H of e.split(/\r\n?|\n/)){l.push(H);const R=o.measureText(H).width;c=Math.max(c,R);for(const z of HU(H)){const P=String.fromCodePoint(z);let B=this.widths.get(z);if(B===void 0){const Z=o.measureText(P);B=Math.ceil(Z.width),this.widths.set(z,B),this.firstChar=Math.min(z,this.firstChar),this.lastChar=Math.max(z,this.lastChar)}}}c*=s/1e3;const[h,u,d,f]=t;let g=d-h,m=f-u;i%180!==0&&([g,m]=[m,g]);let b=1;c>g&&(b=g/c);let p=1;const y=d0*s,w=M3*s,_=y*l.length;_>m&&(p=m/_);const v=Math.min(b,p),C=s*v,k=["q",`0 0 ${kn(g)} ${kn(m)} re W n`,"BT",`1 0 0 1 0 ${kn(m+w)} Tm 0 Tc ${hc(r,!0)}`,`/${this.fontName.name} ${kn(C)} Tf`],{resources:I}=this;if(a=typeof a=="number"&&a>=0&&a<=1?a:1,a!==1){k.push("/R0 gs");const H=new ue(this.xref),R=new ue(this.xref);R.set("ca",a),R.set("CA",a),R.set("Type",ve.get("ExtGState")),H.set("R0",R),I.set("ExtGState",H)}const E=kn(y);for(const H of l)k.push(`0 -${E} Td <${GU(H)}> Tj`);k.push("ET","Q");const T=k.join(`
`),M=new ue(this.xref);if(M.set("Subtype",ve.get("Form")),M.set("Type",ve.get("XObject")),M.set("BBox",[0,0,g,m]),M.set("Length",T.length),M.set("Resources",I),i){const H=D3(i,g,m);M.set("Matrix",H)}const D=new ta(T);return D.dict=M,D}}const jG=["m/d","m/d/yy","mm/dd/yy","mm/yy","d-mmm","d-mmm-yy","dd-mmm-yy","yy-mm-dd","mmm-yy","mmmm-yy","mmm d, yyyy","mmmm d, yyyy","m/d/yy h:MM tt","m/d/yy HH:MM"],GG=["HH:MM","h:MM tt","HH:MM:ss","h:MM:ss tt"];class mM{constructor(e,t,i){this.root=e,this.xref=t,this._type=i}getAll(){const e=new Map;if(!this.root)return e;const t=this.xref,i=new ts;i.put(this.root);const s=[this.root];for(;s.length>0;){const r=t.fetchIfRef(s.shift());if(!(r instanceof ue))continue;if(r.has("Kids")){const o=r.get("Kids");if(!Array.isArray(o))continue;for(const l of o){if(i.has(l))throw new Te(`Duplicate entry in "${this._type}" tree.`);s.push(l),i.put(l)}continue}const a=r.get(this._type);if(Array.isArray(a))for(let o=0,l=a.length;o<l;o+=2)e.set(t.fetchIfRef(a[o]),t.fetchIfRef(a[o+1]))}return e}getRaw(e){if(!this.root)return null;const t=this.xref;let i=t.fetchIfRef(this.root),s=0;const r=10;for(;i.has("Kids");){if(++s>r)return ae(`Search depth limit reached for "${this._type}" tree.`),null;const o=i.get("Kids");if(!Array.isArray(o))return null;let l=0,c=o.length-1;for(;l<=c;){const h=l+c>>1,u=t.fetchIfRef(o[h]),d=u.get("Limits");if(e<t.fetchIfRef(d[0]))c=h-1;else if(e>t.fetchIfRef(d[1]))l=h+1;else{i=u;break}}if(l>c)return null}const a=i.get(this._type);if(Array.isArray(a)){let o=0,l=a.length-2;for(;o<=l;){const c=o+l>>1,h=c+(c&1),u=t.fetchIfRef(a[h]);if(e<u)l=h-2;else if(e>u)o=h+2;else return a[h+1]}}return null}get(e){return this.xref.fetchIfRef(this.getRaw(e))}}class vf extends mM{constructor(e,t){super(e,t,"Names")}}class H3 extends mM{constructor(e,t){super(e,t,"Nums")}}function G4(){Pj(),OU(),Iz(),Yo.cleanup()}function iC(n){return n instanceof ue?n.has("UF")?n.get("UF"):n.has("F")?n.get("F"):n.has("Unix")?n.get("Unix"):n.has("Mac")?n.get("Mac"):n.has("DOS")?n.get("DOS"):null:null}function VG(n){return n.substring(n.lastIndexOf("/")+1)}var ix;class c6{constructor(e,t,i=!1){U(this,ix,!1);e instanceof ue&&(this.xref=t,this.root=e,e.has("FS")&&(this.fs=e.get("FS")),e.has("RF")&&ae("Related file specifications are not supported"),i||(e.has("EF")?O(this,ix,!0):ae("Non-embedded file specifications are not supported")))}get filename(){let e="";const t=iC(this.root);return t&&typeof t=="string"&&(e=Rn(t,!0).replaceAll("\\\\","\\").replaceAll("\\/","/").replaceAll("\\","/")),We(this,"filename",e||"unnamed")}get content(){var t;if(!x(this,ix))return null;this._contentRef||(this._contentRef=iC((t=this.root)==null?void 0:t.get("EF")));let e=null;if(this._contentRef){const i=this.xref.fetchIfRef(this._contentRef);i instanceof dn?e=i.getBytes():ae("Embedded file specification points to non-existing/invalid content")}else ae("Embedded file specification does not have any content");return e}get description(){var i;let e="";const t=(i=this.root)==null?void 0:i.get("Desc");return t&&typeof t=="string"&&(e=Rn(t)),We(this,"description",e)}get serializable(){return{rawFilename:this.filename,filename:VG(this.filename),content:this.content,description:this.description}}}ix=new WeakMap;const ga={NoError:0,EndOfDocument:-1,UnterminatedCdat:-2,UnterminatedXmlDeclaration:-3,UnterminatedDoctypeDeclaration:-4,UnterminatedComment:-5,MalformedElement:-6,OutOfMemory:-7,UnterminatedAttributeValue:-8,UnterminatedElement:-9,ElementNeverBegun:-10};function Ff(n,e){const t=n[e];return t===" "||t===`
`||t==="\r"||t==="	"}function qG(n){for(let e=0,t=n.length;e<t;e++)if(!Ff(n,e))return!1;return!0}class pM{_resolveEntities(e){return e.replaceAll(/&([^;]+);/g,(t,i)=>{if(i.substring(0,2)==="#x")return String.fromCodePoint(parseInt(i.substring(2),16));if(i.substring(0,1)==="#")return String.fromCodePoint(parseInt(i.substring(1),10));switch(i){case"lt":return"<";case"gt":return">";case"amp":return"&";case"quot":return'"';case"apos":return"'"}return this.onResolveEntity(i)})}_parseContent(e,t){const i=[];let s=t;function r(){for(;s<e.length&&Ff(e,s);)++s}for(;s<e.length&&!Ff(e,s)&&e[s]!==">"&&e[s]!=="/";)++s;const a=e.substring(t,s);for(r();s<e.length&&e[s]!==">"&&e[s]!=="/"&&e[s]!=="?";){r();let o="",l="";for(;s<e.length&&!Ff(e,s)&&e[s]!=="=";)o+=e[s],++s;if(r(),e[s]!=="=")return null;++s,r();const c=e[s];if(c!=='"'&&c!=="'")return null;const h=e.indexOf(c,++s);if(h<0)return null;l=e.substring(s,h),i.push({name:o,value:this._resolveEntities(l)}),s=h+1,r()}return{name:a,attributes:i,parsed:s-t}}_parseProcessingInstruction(e,t){let i=t;function s(){for(;i<e.length&&Ff(e,i);)++i}for(;i<e.length&&!Ff(e,i)&&e[i]!==">"&&e[i]!=="?"&&e[i]!=="/";)++i;const r=e.substring(t,i);s();const a=i;for(;i<e.length&&(e[i]!=="?"||e[i+1]!==">");)++i;const o=e.substring(a,i);return{name:r,value:o,parsed:i-t}}parseXml(e){let t=0;for(;t<e.length;){const i=e[t];let s=t;if(i==="<"){++s;const r=e[s];let a;switch(r){case"/":if(++s,a=e.indexOf(">",s),a<0){this.onError(ga.UnterminatedElement);return}this.onEndElement(e.substring(s,a)),s=a+1;break;case"?":++s;const o=this._parseProcessingInstruction(e,s);if(e.substring(s+o.parsed,s+o.parsed+2)!=="?>"){this.onError(ga.UnterminatedXmlDeclaration);return}this.onPi(o.name,o.value),s+=o.parsed+2;break;case"!":if(e.substring(s+1,s+3)==="--"){if(a=e.indexOf("-->",s+3),a<0){this.onError(ga.UnterminatedComment);return}this.onComment(e.substring(s+3,a)),s=a+3}else if(e.substring(s+1,s+8)==="[CDATA["){if(a=e.indexOf("]]>",s+8),a<0){this.onError(ga.UnterminatedCdat);return}this.onCdata(e.substring(s+8,a)),s=a+3}else if(e.substring(s+1,s+8)==="DOCTYPE"){const h=e.indexOf("[",s+8);let u=!1;if(a=e.indexOf(">",s+8),a<0){this.onError(ga.UnterminatedDoctypeDeclaration);return}if(h>0&&a>h){if(a=e.indexOf("]>",s+8),a<0){this.onError(ga.UnterminatedDoctypeDeclaration);return}u=!0}const d=e.substring(s+8,a+(u?1:0));this.onDoctype(d),s=a+(u?2:1)}else{this.onError(ga.MalformedElement);return}break;default:const l=this._parseContent(e,s);if(l===null){this.onError(ga.MalformedElement);return}let c=!1;if(e.substring(s+l.parsed,s+l.parsed+2)==="/>")c=!0;else if(e.substring(s+l.parsed,s+l.parsed+1)!==">"){this.onError(ga.UnterminatedElement);return}this.onBeginElement(l.name,l.attributes,c),s+=l.parsed+(c?2:1);break}}else{for(;s<e.length&&e[s]!=="<";)s++;const r=e.substring(t,s);this.onText(this._resolveEntities(r))}t=s}}onResolveEntity(e){return`&${e};`}onPi(e,t){}onComment(e){}onCdata(e){}onDoctype(e){}onText(e){}onBeginElement(e,t,i){}onEndElement(e){}onError(e){}}class Cp{constructor(e,t){this.nodeName=e,this.nodeValue=t,Object.defineProperty(this,"parentNode",{value:null,writable:!0})}get firstChild(){var e;return(e=this.childNodes)==null?void 0:e[0]}get nextSibling(){const e=this.parentNode.childNodes;if(!e)return;const t=e.indexOf(this);if(t!==-1)return e[t+1]}get textContent(){return this.childNodes?this.childNodes.map(e=>e.textContent).join(""):this.nodeValue||""}get children(){return this.childNodes||[]}hasChildNodes(){var e;return((e=this.childNodes)==null?void 0:e.length)>0}searchNode(e,t){var a;if(t>=e.length)return this;const i=e[t];if(i.name.startsWith("#")&&t<e.length-1)return this.searchNode(e,t+1);const s=[];let r=this;for(;;){if(i.name===r.nodeName)if(i.pos===0){const o=r.searchNode(e,t+1);if(o!==null)return o}else{if(s.length===0)return null;{const[o]=s.pop();let l=0;for(const c of o.childNodes)if(i.name===c.nodeName){if(l===i.pos)return c.searchNode(e,t+1);l++}return r.searchNode(e,t+1)}}if(((a=r.childNodes)==null?void 0:a.length)>0)s.push([r,0]),r=r.childNodes[0];else{if(s.length===0)return null;for(;s.length!==0;){const[o,l]=s.pop(),c=l+1;if(c<o.childNodes.length){s.push([o,c]),r=o.childNodes[c];break}}if(s.length===0)return null}}}dump(e){if(this.nodeName==="#text"){e.push(l1(this.nodeValue));return}if(e.push(`<${this.nodeName}`),this.attributes)for(const t of this.attributes)e.push(` ${t.name}="${l1(t.value)}"`);if(this.hasChildNodes()){e.push(">");for(const t of this.childNodes)t.dump(e);e.push(`</${this.nodeName}>`)}else this.nodeValue?e.push(`>${l1(this.nodeValue)}</${this.nodeName}>`):e.push("/>")}}class uy extends pM{constructor({hasAttributes:e=!1,lowerCaseName:t=!1}){super(),this._currentFragment=null,this._stack=null,this._errorCode=ga.NoError,this._hasAttributes=e,this._lowerCaseName=t}parseFromString(e){if(this._currentFragment=[],this._stack=[],this._errorCode=ga.NoError,this.parseXml(e),this._errorCode!==ga.NoError)return;const[t]=this._currentFragment;if(t)return{documentElement:t}}onText(e){if(qG(e))return;const t=new Cp("#text",e);this._currentFragment.push(t)}onCdata(e){const t=new Cp("#text",e);this._currentFragment.push(t)}onBeginElement(e,t,i){this._lowerCaseName&&(e=e.toLowerCase());const s=new Cp(e);s.childNodes=[],this._hasAttributes&&(s.attributes=t),this._currentFragment.push(s),!i&&(this._stack.push(this._currentFragment),this._currentFragment=s.childNodes)}onEndElement(e){this._currentFragment=this._stack.pop()||[];const t=this._currentFragment.at(-1);if(!t)return null;for(const i of t.childNodes)i.parentNode=t;return t}onError(e){this._errorCode=e}}class WG{constructor(e){e=this._repair(e);const i=new uy({lowerCaseName:!0}).parseFromString(e);this._metadataMap=new Map,this._data=e,i&&this._parse(i)}_repair(e){return e.replace(/^[^<]+/,"").replaceAll(/>\\376\\377([^<]+)/g,function(t,i){const s=i.replaceAll(/\\([0-3])([0-7])([0-7])/g,function(a,o,l,c){return String.fromCharCode(o*64+l*8+c*1)}).replaceAll(/&(amp|apos|gt|lt|quot);/g,function(a,o){switch(o){case"amp":return"&";case"apos":return"'";case"gt":return">";case"lt":return"<";case"quot":return'"'}throw new Error(`_repair: ${o} isn't defined.`)}),r=[">"];for(let a=0,o=s.length;a<o;a+=2){const l=s.charCodeAt(a)*256+s.charCodeAt(a+1);l>=32&&l<127&&l!==60&&l!==62&&l!==38?r.push(String.fromCharCode(l)):r.push("&#x"+(65536+l).toString(16).substring(1)+";")}return r.join("")})}_getSequence(e){const t=e.nodeName;return t!=="rdf:bag"&&t!=="rdf:seq"&&t!=="rdf:alt"?null:e.childNodes.filter(i=>i.nodeName==="rdf:li")}_parseArray(e){if(!e.hasChildNodes())return;const[t]=e.childNodes,i=this._getSequence(t)||[];this._metadataMap.set(e.nodeName,i.map(s=>s.textContent.trim()))}_parse(e){let t=e.documentElement;if(t.nodeName!=="rdf:rdf")for(t=t.firstChild;t&&t.nodeName!=="rdf:rdf";)t=t.nextSibling;if(!(!t||t.nodeName!=="rdf:rdf"||!t.hasChildNodes())){for(const i of t.childNodes)if(i.nodeName==="rdf:description")for(const s of i.childNodes){const r=s.nodeName;switch(r){case"#text":continue;case"dc:creator":case"dc:subject":this._parseArray(s);continue}this._metadataMap.set(r,s.textContent.trim())}}}get serializable(){return{parsedData:this._metadataMap,rawData:this._data}}}const sC=40,xo={PAGE_CONTENT:1,STREAM_CONTENT:2,OBJECT:3,ANNOTATION:4,ELEMENT:5};var W5,bM,Eo,h6,u6,xM,yM;const Au=class Au{constructor(e,t,i){U(this,W5);this.xref=e,this.dict=t,this.ref=i instanceof tt?i:null,this.roleMap=new Map,this.structParentIds=null}init(){this.readRoleMap()}addAnnotationIdToPage(e,t){F(this,W5,bM).call(this,e,t,xo.ANNOTATION)}readRoleMap(){const e=this.dict.get("RoleMap");if(e instanceof ue)for(const[t,i]of e)i instanceof ve&&this.roleMap.set(t,i.name)}static async canCreateStructureTree({catalogRef:e,pdfManager:t,newAnnotationsByPage:i}){var a;if(!(e instanceof tt))return ae("Cannot save the struct tree: no catalog reference."),!1;let s=0,r=!0;for(const[o,l]of i){const{ref:c}=await t.getPage(o);if(!(c instanceof tt)){ae(`Cannot save the struct tree: page ${o} has no ref.`),r=!0;break}for(const h of l)(a=h.accessibilityData)!=null&&a.type&&(h.parentTreeId=s++,r=!1)}if(r){for(const o of i.values())for(const l of o)delete l.parentTreeId;return!1}return!0}static async createStructureTree({newAnnotationsByPage:e,xref:t,catalogRef:i,pdfManager:s,changes:r}){const a=await s.ensureCatalog("cloneDict"),o=new ma;o.put(i,a);const l=t.getNewTemporaryRef();a.set("StructTreeRoot",l);const c=new ue(t);c.set("Type",ve.get("StructTreeRoot"));const h=t.getNewTemporaryRef();c.set("ParentTree",h);const u=[];c.set("K",u),o.put(l,c);const d=new ue(t),f=[];d.set("Nums",f);const g=await F(this,Eo,h6).call(this,{newAnnotationsByPage:e,structTreeRootRef:l,structTreeRoot:null,kids:u,nums:f,xref:t,pdfManager:s,changes:r,cache:o});c.set("ParentTreeNextKey",g),o.put(h,d);for(const[m,b]of o.items())r.put(m,{data:b})}async canUpdateStructTree({pdfManager:e,newAnnotationsByPage:t}){var l,c;if(!this.ref)return ae("Cannot update the struct tree: no root reference."),!1;let i=this.dict.get("ParentTreeNextKey");if(!Number.isInteger(i)||i<0)return ae("Cannot update the struct tree: invalid next key."),!1;const s=this.dict.get("ParentTree");if(!(s instanceof ue))return ae("Cannot update the struct tree: ParentTree isn't a dict."),!1;const r=s.get("Nums");if(!Array.isArray(r))return ae("Cannot update the struct tree: nums isn't an array."),!1;const a=new H3(s,this.xref);for(const h of t.keys()){const{pageDict:u}=await e.getPage(h);if(!u.has("StructParents"))continue;const d=u.get("StructParents");if(!Number.isInteger(d)||!Array.isArray(a.get(d)))return ae(`Cannot save the struct tree: page ${h} has a wrong id.`),!1}let o=!0;for(const[h,u]of t){const{pageDict:d}=await e.getPage(h);F(l=Au,Eo,xM).call(l,{elements:u,xref:this.xref,pageDict:d,numberTree:a});for(const f of u)(c=f.accessibilityData)!=null&&c.type&&(f.accessibilityData.structParent>=0||(f.parentTreeId=i++),o=!1)}if(o){for(const h of t.values())for(const u of h)delete u.parentTreeId,delete u.structTreeParent;return!1}return!0}async updateStructureTree({newAnnotationsByPage:e,pdfManager:t,changes:i}){var f;const{ref:s,xref:r}=this,a=this.dict.clone(),o=new ma;o.put(s,a);let l=a.getRaw("ParentTree"),c;l instanceof tt?c=r.fetch(l):(c=l,l=r.getNewTemporaryRef(),a.set("ParentTree",l)),c=c.clone(),o.put(l,c);let h=c.getRaw("Nums"),u=null;h instanceof tt&&(u=h,h=r.fetch(u)),h=h.slice(),u||c.set("Nums",h);const d=await F(f=Au,Eo,h6).call(f,{newAnnotationsByPage:e,structTreeRootRef:s,structTreeRoot:this,kids:null,nums:h,xref:r,pdfManager:t,changes:i,cache:o});if(d!==-1){a.set("ParentTreeNextKey",d),u&&o.put(u,h);for(const[g,m]of o.items())i.put(g,{data:m})}}};W5=new WeakSet,bM=function(e,t,i){if(!(e instanceof tt)||t<0)return;this.structParentIds||(this.structParentIds=new ma);let s=this.structParentIds.get(e);s||(s=[],this.structParentIds.put(e,s)),s.push([t,i])},Eo=new WeakSet,h6=async function({newAnnotationsByPage:e,structTreeRootRef:t,structTreeRoot:i,kids:s,nums:r,xref:a,pdfManager:o,changes:l,cache:c}){var f,g;const h=ve.get("OBJR");let u=-1,d;for(const[m,b]of e){const p=await o.getPage(m),{ref:y}=p,w=y instanceof tt;for(const{accessibilityData:_,ref:v,parentTreeId:C,structTreeParent:k}of b){if(!(_!=null&&_.type))continue;const{structParent:I}=_;if(i&&Number.isInteger(I)&&I>=0){let D=(d||(d=new Map)).get(m);D===void 0&&(D=new wM(i,p.pageDict).collectObjects(y),d.set(m,D));const H=D==null?void 0:D.get(I);if(H){const R=a.fetch(H).clone();F(f=Au,Eo,u6).call(f,R,_),l.put(H,{data:R});continue}}u=Math.max(u,C);const E=a.getNewTemporaryRef(),T=new ue(a);F(g=Au,Eo,u6).call(g,T,_),await F(this,Eo,yM).call(this,{structTreeParent:k,tagDict:T,newTagRef:E,structTreeRootRef:t,fallbackKids:s,xref:a,cache:c});const M=new ue(a);T.set("K",M),M.set("Type",h),w&&M.set("Pg",y),M.set("Obj",v),c.put(E,T),r.push(C,E)}}return u+1},u6=function(e,{type:t,title:i,lang:s,alt:r,expanded:a,actualText:o}){e.set("S",ve.get(t)),i&&e.set("T",_o(i)),s&&e.set("Lang",_o(s)),r&&e.set("Alt",_o(r)),a&&e.set("E",_o(a)),o&&e.set("ActualText",_o(o))},xM=function({elements:e,xref:t,pageDict:i,numberTree:s}){const r=new Map;for(const c of e)if(c.structTreeParentId){const h=parseInt(c.structTreeParentId.split("_mc")[1],10);let u=r.get(h);u||(u=[],r.set(h,u)),u.push(c)}const a=i.get("StructParents");if(!Number.isInteger(a))return;const o=s.get(a),l=(c,h,u)=>{const d=r.get(c);if(d){const f=h.getRaw("P"),g=t.fetchIfRef(f);if(f instanceof tt&&g instanceof ue){const m={ref:u,dict:h};for(const b of d)b.structTreeParent=m}return!0}return!1};for(const c of o){if(!(c instanceof tt))continue;const h=t.fetch(c),u=h.get("K");if(Number.isInteger(u)){l(u,h,c);continue}if(Array.isArray(u))for(let d of u){if(d=t.fetchIfRef(d),Number.isInteger(d)&&l(d,h,c))break;if(!(d instanceof ue))continue;if(!Li(d.get("Type"),"MCR"))break;const f=d.get("MCID");if(Number.isInteger(f)&&l(f,h,c))break}}},yM=async function({structTreeParent:e,tagDict:t,newTagRef:i,structTreeRootRef:s,fallbackKids:r,xref:a,cache:o}){let l=null,c;e?({ref:l}=e,c=e.dict.getRaw("P")||s):c=s,t.set("P",c);const h=a.fetchIfRef(c);if(!h){r.push(i);return}let u=o.get(c);u||(u=h.clone(),o.put(c,u));const d=u.getRaw("K");let f=d instanceof tt?o.get(d):null;if(!f){f=a.fetchIfRef(d),f=Array.isArray(f)?f.slice():[d];const m=a.getNewTemporaryRef();u.set("K",m),o.put(m,f)}const g=f.indexOf(l);f.splice(g>=0?g+1:f.length,0,i)},U(Au,Eo);let e2=Au;class KG{constructor(e,t){this.tree=e,this.xref=e.xref,this.dict=t,this.kids=[],this.parseKids()}get role(){const e=this.dict.get("S"),t=e instanceof ve?e.name:"",{root:i}=this.tree;return i.roleMap.get(t)??t}parseKids(){let e=null;const t=this.dict.getRaw("Pg");t instanceof tt&&(e=t.toString());const i=this.dict.get("K");if(Array.isArray(i))for(const s of i){const r=this.parseKid(e,this.xref.fetchIfRef(s));r&&this.kids.push(r)}else{const s=this.parseKid(e,i);s&&this.kids.push(s)}}parseKid(e,t){if(Number.isInteger(t))return this.tree.pageDict.objId!==e?null:new o9({type:xo.PAGE_CONTENT,mcid:t,pageObjId:e});if(!(t instanceof ue))return null;const i=t.getRaw("Pg");i instanceof tt&&(e=i.toString());const s=t.get("Type")instanceof ve?t.get("Type").name:null;if(s==="MCR"){if(this.tree.pageDict.objId!==e)return null;const r=t.getRaw("Stm");return new o9({type:xo.STREAM_CONTENT,refObjId:r instanceof tt?r.toString():null,pageObjId:e,mcid:t.get("MCID")})}if(s==="OBJR"){if(this.tree.pageDict.objId!==e)return null;const r=t.getRaw("Obj");return new o9({type:xo.OBJECT,refObjId:r instanceof tt?r.toString():null,pageObjId:e})}return new o9({type:xo.ELEMENT,dict:t})}}class o9{constructor({type:e,dict:t=null,mcid:i=null,pageObjId:s=null,refObjId:r=null}){this.type=e,this.dict=t,this.mcid=i,this.pageObjId=s,this.refObjId=r,this.parentNode=null}}class wM{constructor(e,t){this.root=e,this.xref=(e==null?void 0:e.xref)??null,this.rootDict=(e==null?void 0:e.dict)??null,this.pageDict=t,this.nodes=[]}collectObjects(e){var a;if(!this.root||!this.rootDict||!(e instanceof tt))return null;const t=this.rootDict.get("ParentTree");if(!t)return null;const i=(a=this.root.structParentIds)==null?void 0:a.get(e);if(!i)return null;const s=new Map,r=new H3(t,this.xref);for(const[o]of i){const l=r.getRaw(o);l instanceof tt&&s.set(o,l)}return s}parse(e){var o,l;if(!this.root||!this.rootDict||!(e instanceof tt))return;const t=this.rootDict.get("ParentTree");if(!t)return;const i=this.pageDict.get("StructParents"),s=(o=this.root.structParentIds)==null?void 0:o.get(e);if(!Number.isInteger(i)&&!s)return;const r=new Map,a=new H3(t,this.xref);if(Number.isInteger(i)){const c=a.get(i);if(Array.isArray(c))for(const h of c)h instanceof tt&&this.addNode(this.xref.fetch(h),r)}if(s)for(const[c,h]of s){const u=a.get(c);if(u){const d=this.addNode(this.xref.fetchIfRef(u),r);((l=d==null?void 0:d.kids)==null?void 0:l.length)===1&&d.kids[0].type===xo.OBJECT&&(d.kids[0].type=h)}}}addNode(e,t,i=0){if(i>sC)return ae("StructTree MAX_DEPTH reached."),null;if(!(e instanceof ue))return null;if(t.has(e))return t.get(e);const s=new KG(this,e);t.set(e,s);const r=e.get("P");if(!(r instanceof ue)||Li(r.get("Type"),"StructTreeRoot"))return this.addTopLevelNode(e,s)||t.delete(e),s;const a=this.addNode(r,t,i+1);if(!a)return s;let o=!1;for(const l of a.kids)l.type===xo.ELEMENT&&l.dict===e&&(l.parentNode=s,o=!0);return o||t.delete(e),s}addTopLevelNode(e,t){const i=this.rootDict.get("K");if(!i)return!1;if(i instanceof ue)return i.objId!==e.objId?!1:(this.nodes[0]=t,!0);if(!Array.isArray(i))return!0;let s=!1;for(let r=0;r<i.length;r++){const a=i[r];(a==null?void 0:a.toString())===e.objId&&(this.nodes[r]=t,s=!0)}return s}get serializable(){function e(i,s,r=0){if(r>sC){ae("StructTree too deep to be fully serialized.");return}const a=Object.create(null);a.role=i.role,a.children=[],s.children.push(a);let o=i.dict.get("Alt");typeof o!="string"&&(o=i.dict.get("ActualText")),typeof o=="string"&&(a.alt=Rn(o));const l=i.dict.get("A");if(l instanceof ue){const h=A0(l.getArray("BBox"),null);if(h)a.bbox=h;else{const u=l.get("Width"),d=l.get("Height");typeof u=="number"&&u>0&&typeof d=="number"&&d>0&&(a.bbox=[0,0,u,d])}}const c=i.dict.get("Lang");typeof c=="string"&&(a.lang=Rn(c));for(const h of i.kids){const u=h.type===xo.ELEMENT?h.parentNode:null;if(u){e(u,a,r+1);continue}else h.type===xo.PAGE_CONTENT||h.type===xo.STREAM_CONTENT?a.children.push({type:"content",id:`p${h.pageObjId}_mc${h.mcid}`}):h.type===xo.OBJECT?a.children.push({type:"object",id:h.refObjId}):h.type===xo.ANNOTATION&&a.children.push({type:"annotation",id:`${RU}${h.refObjId}`})}}const t=Object.create(null);t.children=[],t.role="Root";for(const i of this.nodes)i&&e(i,t);return t}}const XG=n=>n instanceof tt,z3=MU.bind(null,XG,Li);function Bw(n){return n instanceof ue&&(n=n.get("D")),z3(n)?n:null}function rC(n){let e=n.get("D");if(e){if(e instanceof ve&&(e=e.name),typeof e=="string")return Rn(e,!0);if(z3(e))return JSON.stringify(e)}return null}var Eg,Xn,ds,_M,vM,kM,CM,AM,SM,d6,IM,EM;const K5=class K5{constructor(e,t){U(this,ds);U(this,Eg,null);U(this,Xn,null);Ue(this,"builtInCMapCache",new Map);Ue(this,"fontCache",new ma);Ue(this,"globalColorSpaceCache",new yG);Ue(this,"globalImageCache",new s6);Ue(this,"nonBlendModesSet",new ts);Ue(this,"pageDictCache",new ma);Ue(this,"pageIndexCache",new ma);Ue(this,"pageKidsCountCache",new ma);Ue(this,"standardFontDataCache",new Map);Ue(this,"systemFontCache",new Map);if(this.pdfManager=e,this.xref=t,O(this,Xn,t.getCatalogObj()),!(x(this,Xn)instanceof ue))throw new Te("Catalog object is not a dictionary.");this.toplevelPagesDict}cloneDict(){return x(this,Xn).clone()}get version(){const e=x(this,Xn).get("Version");if(e instanceof ve){if(xR.test(e.name))return We(this,"version",e.name);ae(`Invalid PDF catalog version: ${e.name}`)}return We(this,"version",null)}get lang(){const e=x(this,Xn).get("Lang");return We(this,"lang",e&&typeof e=="string"?Rn(e):null)}get needsRendering(){const e=x(this,Xn).get("NeedsRendering");return We(this,"needsRendering",typeof e=="boolean"?e:!1)}get collection(){let e=null;try{const t=x(this,Xn).get("Collection");t instanceof ue&&t.size>0&&(e=t)}catch(t){if(t instanceof vi)throw t;gn("Cannot fetch Collection entry; assuming no collection is present.")}return We(this,"collection",e)}get acroForm(){let e=null;try{const t=x(this,Xn).get("AcroForm");t instanceof ue&&t.size>0&&(e=t)}catch(t){if(t instanceof vi)throw t;gn("Cannot fetch AcroForm entry; assuming no forms are present.")}return We(this,"acroForm",e)}get acroFormRef(){const e=x(this,Xn).getRaw("AcroForm");return We(this,"acroFormRef",e instanceof tt?e:null)}get metadata(){var i;const e=x(this,Xn).getRaw("Metadata");if(!(e instanceof tt))return We(this,"metadata",null);let t=null;try{const s=this.xref.fetch(e,!((i=this.xref.encrypt)!=null&&i.encryptMetadata));if(s instanceof dn&&s.dict instanceof ue){const r=s.dict.get("Type"),a=s.dict.get("Subtype");if(Li(r,"Metadata")&&Li(a,"XML")){const o=Vp(s.getString());o&&(t=new WG(o).serializable)}}}catch(s){if(s instanceof vi)throw s;gn(`Skipping invalid Metadata: "${s}".`)}return We(this,"metadata",t)}get markInfo(){let e=null;try{e=F(this,ds,_M).call(this)}catch(t){if(t instanceof vi)throw t;ae("Unable to read mark info.")}return We(this,"markInfo",e)}get structTreeRoot(){let e=null;try{e=F(this,ds,vM).call(this)}catch(t){if(t instanceof vi)throw t;ae("Unable read to structTreeRoot info.")}return We(this,"structTreeRoot",e)}get toplevelPagesDict(){const e=x(this,Xn).get("Pages");if(!(e instanceof ue))throw new Te("Invalid top-level pages dictionary.");return We(this,"toplevelPagesDict",e)}get documentOutline(){let e=null;try{e=F(this,ds,kM).call(this)}catch(t){if(t instanceof vi)throw t;ae("Unable to read document outline.")}return We(this,"documentOutline",e)}get permissions(){let e=null;try{e=F(this,ds,CM).call(this)}catch(t){if(t instanceof vi)throw t;ae("Unable to read permissions.")}return We(this,"permissions",e)}get optionalContentConfig(){let e=null;try{const t=x(this,Xn).get("OCProperties");if(!t)return We(this,"optionalContentConfig",null);const i=t.get("D");if(!i)return We(this,"optionalContentConfig",null);const s=t.get("OCGs");if(!Array.isArray(s))return We(this,"optionalContentConfig",null);const r=new ma;for(const a of s)!(a instanceof tt)||r.has(a)||r.put(a,F(this,ds,AM).call(this,a));e=F(this,ds,SM).call(this,i,r)}catch(t){if(t instanceof vi)throw t;ae(`Unable to read optional content config: ${t}`)}return We(this,"optionalContentConfig",e)}setActualNumPages(e=null){O(this,Eg,e)}get hasActualNumPages(){return x(this,Eg)!==null}get _pagesCount(){const e=this.toplevelPagesDict.get("Count");if(!Number.isInteger(e))throw new Te("Page count in top-level pages dictionary is not an integer.");return We(this,"_pagesCount",e)}get numPages(){return x(this,Eg)??this._pagesCount}get destinations(){var i;const e=F(this,ds,d6).call(this),t=Object.create(null);for(const s of e)if(s instanceof vf)for(const[r,a]of s.getAll()){const o=Bw(a);o&&(t[Rn(r,!0)]=o)}else if(s instanceof ue)for(const[r,a]of s){const o=Bw(a);o&&(t[i=Rn(r,!0)]||(t[i]=o))}return We(this,"destinations",t)}getDestination(e){if(this.hasOwnProperty("destinations"))return this.destinations[e]??null;const t=F(this,ds,d6).call(this);for(const i of t)if(i instanceof vf||i instanceof ue){const s=Bw(i.get(e));if(s)return s}if(t.length){const i=this.destinations[e];if(i)return i}return null}get pageLabels(){let e=null;try{e=F(this,ds,IM).call(this)}catch(t){if(t instanceof vi)throw t;ae("Unable to read page labels.")}return We(this,"pageLabels",e)}get pageLayout(){const e=x(this,Xn).get("PageLayout");let t="";if(e instanceof ve)switch(e.name){case"SinglePage":case"OneColumn":case"TwoColumnLeft":case"TwoColumnRight":case"TwoPageLeft":case"TwoPageRight":t=e.name}return We(this,"pageLayout",t)}get pageMode(){const e=x(this,Xn).get("PageMode");let t="UseNone";if(e instanceof ve)switch(e.name){case"UseNone":case"UseOutlines":case"UseThumbs":case"FullScreen":case"UseOC":case"UseAttachments":t=e.name}return We(this,"pageMode",t)}get viewerPreferences(){const e=x(this,Xn).get("ViewerPreferences");if(!(e instanceof ue))return We(this,"viewerPreferences",null);let t=null;for(const[i,s]of e){let r;switch(i){case"HideToolbar":case"HideMenubar":case"HideWindowUI":case"FitWindow":case"CenterWindow":case"DisplayDocTitle":case"PickTrayByPDFSize":typeof s=="boolean"&&(r=s);break;case"NonFullScreenPageMode":if(s instanceof ve)switch(s.name){case"UseNone":case"UseOutlines":case"UseThumbs":case"UseOC":r=s.name;break;default:r="UseNone"}break;case"Direction":if(s instanceof ve)switch(s.name){case"L2R":case"R2L":r=s.name;break;default:r="L2R"}break;case"ViewArea":case"ViewClip":case"PrintArea":case"PrintClip":if(s instanceof ve)switch(s.name){case"MediaBox":case"CropBox":case"BleedBox":case"TrimBox":case"ArtBox":r=s.name;break;default:r="CropBox"}break;case"PrintScaling":if(s instanceof ve)switch(s.name){case"None":case"AppDefault":r=s.name;break;default:r="AppDefault"}break;case"Duplex":if(s instanceof ve)switch(s.name){case"Simplex":case"DuplexFlipShortEdge":case"DuplexFlipLongEdge":r=s.name;break;default:r="None"}break;case"PrintPageRange":Array.isArray(s)&&s.length%2===0&&s.every((o,l,c)=>Number.isInteger(o)&&o>0&&(l===0||o>=c[l-1])&&o<=this.numPages)&&(r=s);break;case"NumCopies":Number.isInteger(s)&&s>0&&(r=s);break;default:ae(`Ignoring non-standard key in ViewerPreferences: ${i}.`);continue}if(r===void 0){ae(`Bad value, for key "${i}", in ViewerPreferences: ${s}.`);continue}t??(t=Object.create(null)),t[i]=r}return We(this,"viewerPreferences",t)}get openAction(){const e=x(this,Xn).get("OpenAction"),t=Object.create(null);if(e instanceof ue){const i=new ue(this.xref);i.set("A",e);const s={url:null,dest:null,action:null};K5.parseDestDictionary({destDict:i,resultObj:s}),Array.isArray(s.dest)?t.dest=s.dest:s.action&&(t.action=s.action)}else z3(e)&&(t.dest=e);return We(this,"openAction",A4(t)>0?t:null)}get attachments(){const e=x(this,Xn).get("Names");let t=null;if(e instanceof ue&&e.has("EmbeddedFiles")){const i=new vf(e.getRaw("EmbeddedFiles"),this.xref);for(const[s,r]of i.getAll()){const a=new c6(r,this.xref);t??(t=Object.create(null)),t[Rn(s,!0)]=a.serializable}}return We(this,"attachments",t)}get xfaImages(){const e=x(this,Xn).get("Names");let t=null;if(e instanceof ue&&e.has("XFAImages")){const i=new vf(e.getRaw("XFAImages"),this.xref);for(const[s,r]of i.getAll())r instanceof dn&&(t??(t=new Map),t.set(Rn(s,!0),r.getBytes()))}return We(this,"xfaImages",t)}get jsActions(){const e=F(this,ds,EM).call(this);let t=oy(this.xref,x(this,Xn),_U);if(e){t||(t=Object.create(null));for(const[i,s]of e)i in t?t[i].push(s):t[i]=[s]}return We(this,"jsActions",t)}async cleanup(e=!1){G4(),this.globalColorSpaceCache.clear(),this.globalImageCache.clear(e),this.pageKidsCountCache.clear(),this.pageIndexCache.clear(),this.pageDictCache.clear(),this.nonBlendModesSet.clear();for(const{dict:t}of await Promise.all(this.fontCache))delete t.cacheKey;this.fontCache.clear(),this.builtInCMapCache.clear(),this.standardFontDataCache.clear(),this.systemFontCache.clear()}async getPageDict(e){const t=[this.toplevelPagesDict],i=new ts,s=x(this,Xn).getRaw("Pages");s instanceof tt&&i.put(s);const r=this.xref,a=this.pageKidsCountCache,o=this.pageIndexCache,l=this.pageDictCache;let c=0;for(;t.length;){const h=t.pop();if(h instanceof tt){const g=a.get(h);if(g>=0&&c+g<=e){c+=g;continue}if(i.has(h))throw new Te("Pages tree contains circular reference.");i.put(h);const m=await(l.get(h)||r.fetchAsync(h));if(m instanceof ue){let b=m.getRaw("Type");if(b instanceof tt&&(b=await r.fetchAsync(b)),Li(b,"Page")||!m.has("Kids")){if(a.has(h)||a.put(h,1),o.has(h)||o.put(h,c),c===e)return[m,h];c++;continue}}t.push(m);continue}if(!(h instanceof ue))throw new Te("Page dictionary kid reference points to wrong type of object.");const{objId:u}=h;let d=h.getRaw("Count");if(d instanceof tt&&(d=await r.fetchAsync(d)),Number.isInteger(d)&&d>=0&&(u&&!a.has(u)&&a.put(u,d),c+d<=e)){c+=d;continue}let f=h.getRaw("Kids");if(f instanceof tt&&(f=await r.fetchAsync(f)),!Array.isArray(f)){let g=h.getRaw("Type");if(g instanceof tt&&(g=await r.fetchAsync(g)),Li(g,"Page")||!h.has("Kids")){if(c===e)return[h,null];c++;continue}throw new Te("Page dictionary kids object is not an array.")}for(let g=f.length-1;g>=0;g--){const m=f[g];t.push(m),h===this.toplevelPagesDict&&m instanceof tt&&!l.has(m)&&l.put(m,r.fetchAsync(m))}}throw new Error(`Page index ${e} not found.`)}async getAllPageDicts(e=!1){const{ignoreErrors:t}=this.pdfManager.evaluatorOptions,i=[{currentNode:this.toplevelPagesDict,posInKids:0}],s=new ts,r=x(this,Xn).getRaw("Pages");r instanceof tt&&s.put(r);const a=new Map,o=this.xref,l=this.pageIndexCache;let c=0;function h(d,f){f&&!l.has(f)&&l.put(f,c),a.set(c++,[d,f])}function u(d){if(d instanceof Oh&&!e)throw d;e&&t&&c===0&&(ae(`getAllPageDicts - Skipping invalid first page: "${d}".`),d=ue.empty),a.set(c++,[d,null])}for(;i.length>0;){const d=i.at(-1),{currentNode:f,posInKids:g}=d;let m=f.getRaw("Kids");if(m instanceof tt)try{m=await o.fetchAsync(m)}catch(w){u(w);break}if(!Array.isArray(m)){u(new Te("Page dictionary kids object is not an array."));break}if(g>=m.length){i.pop();continue}const b=m[g];let p;if(b instanceof tt){if(s.has(b)){u(new Te("Pages tree contains circular reference."));break}s.put(b);try{p=await o.fetchAsync(b)}catch(w){u(w);break}}else p=b;if(!(p instanceof ue)){u(new Te("Page dictionary kid reference points to wrong type of object."));break}let y=p.getRaw("Type");if(y instanceof tt)try{y=await o.fetchAsync(y)}catch(w){u(w);break}Li(y,"Page")||!p.has("Kids")?h(p,b instanceof tt?b:null):i.push({currentNode:p,posInKids:0}),d.posInKids++}return a}getPageIndex(e){const t=this.pageIndexCache.get(e);if(t!==void 0)return Promise.resolve(t);const i=this.xref;function s(o){let l=0,c;return i.fetchAsync(o).then(function(h){if(N3(o,e)&&!bR(h,"Page")&&!(h instanceof ue&&!h.has("Type")&&h.has("Contents")))throw new Te("The reference does not point to a /Page dictionary.");if(!h)return null;if(!(h instanceof ue))throw new Te("Node must be a dictionary.");return c=h.getRaw("Parent"),h.getAsync("Parent")}).then(function(h){if(!h)return null;if(!(h instanceof ue))throw new Te("Parent must be a dictionary.");return h.getAsync("Kids")}).then(function(h){if(!h)return null;const u=[];let d=!1;for(const f of h){if(!(f instanceof tt))throw new Te("Kid must be a reference.");if(N3(f,o)){d=!0;break}u.push(i.fetchAsync(f).then(function(g){if(!(g instanceof ue))throw new Te("Kid node must be a dictionary.");g.has("Count")?l+=g.get("Count"):l++}))}if(!d)throw new Te("Kid reference not found in parent's kids.");return Promise.all(u).then(()=>[l,c])})}let r=0;const a=o=>s(o).then(l=>{if(!l)return this.pageIndexCache.put(e,r),r;const[c,h]=l;return r+=c,a(h)});return a(e)}get baseUrl(){const e=x(this,Xn).get("URI");if(e instanceof ue){const t=e.get("Base");if(typeof t=="string"){const i=P3(t,null,{tryConvertEncoding:!0});if(i)return We(this,"baseUrl",i.href)}}return We(this,"baseUrl",this.pdfManager.docBaseUrl)}static parseDestDictionary({destDict:e,resultObj:t,docBaseUrl:i=null,docAttachments:s=null}){if(!(e instanceof ue)){ae("parseDestDictionary: `destDict` must be a dictionary.");return}let r=e.get("A"),a,o;if(r instanceof ue||(e.has("Dest")?r=e.get("Dest"):(r=e.get("AA"),r instanceof ue&&(r.has("D")?r=r.get("D"):r.has("U")&&(r=r.get("U"))))),r instanceof ue){const l=r.get("S");if(!(l instanceof ve)){ae("parseDestDictionary: Invalid type in Action dictionary.");return}const c=l.name;switch(c){case"ResetForm":const h=r.get("Flags"),u=((typeof h=="number"?h:0)&1)===0,d=[],f=[];for(const T of r.get("Fields")||[])T instanceof tt?f.push(T.toString()):typeof T=="string"&&d.push(Rn(T));t.resetForm={fields:d,refs:f,include:u};break;case"URI":a=r.get("URI"),a instanceof ve&&(a="/"+a.name);break;case"GoTo":o=r.get("D");break;case"Launch":case"GoToR":const g=r.get("F");if(g instanceof ue){const T=new c6(g,null,!0),{rawFilename:M}=T.serializable;a=M}else typeof g=="string"&&(a=g);const m=rC(r);m&&typeof a=="string"&&(a=a.split("#",1)[0]+"#"+m);const b=r.get("NewWindow");typeof b=="boolean"&&(t.newWindow=b);break;case"GoToE":const p=r.get("T");let y;if(s&&p instanceof ue){const T=p.get("R"),M=p.get("N");Li(T,"C")&&typeof M=="string"&&(y=s[Rn(M,!0)])}if(y){t.attachment=y;const T=rC(r);T&&(t.attachmentDest=T)}else ae('parseDestDictionary - unimplemented "GoToE" action.');break;case"Named":const w=r.get("N");w instanceof ve&&(t.action=w.name);break;case"SetOCGState":const _=r.get("State"),v=r.get("PreserveRB");if(!Array.isArray(_)||_.length===0)break;const C=[];for(const T of _)if(T instanceof ve)switch(T.name){case"ON":case"OFF":case"Toggle":C.push(T.name);break}else T instanceof tt&&C.push(T.toString());if(C.length!==_.length)break;t.setOCGState={state:C,preserveRB:typeof v=="boolean"?v:!0};break;case"JavaScript":const k=r.get("JS");let I;k instanceof dn?I=k.getString():typeof k=="string"&&(I=k);const E=I&&_R(Rn(I,!0));if(E){a=E.url,t.newWindow=E.newWindow;break}default:if(c==="JavaScript"||c==="SubmitForm")break;ae(`parseDestDictionary - unsupported action: "${c}".`);break}}else e.has("Dest")&&(o=e.get("Dest"));if(typeof a=="string"){const l=P3(a,i,{addDefaultProtocol:!0,tryConvertEncoding:!0});l&&(t.url=l.href),t.unsafeUrl=a}o&&(o instanceof ve&&(o=o.name),typeof o=="string"?t.dest=Rn(o,!0):z3(o)&&(t.dest=o))}};Eg=new WeakMap,Xn=new WeakMap,ds=new WeakSet,_M=function(){const e=x(this,Xn).get("MarkInfo");if(!(e instanceof ue))return null;const t={Marked:!1,UserProperties:!1,Suspects:!1};for(const i in t){const s=e.get(i);typeof s=="boolean"&&(t[i]=s)}return t},vM=function(){const e=x(this,Xn).getRaw("StructTreeRoot"),t=this.xref.fetchIfRef(e);if(!(t instanceof ue))return null;const i=new e2(this.xref,t,e);return i.init(),i},kM=function(){let e=x(this,Xn).get("Outlines");if(!(e instanceof ue)||(e=e.getRaw("First"),!(e instanceof tt)))return null;const t={items:[]},i=[{obj:e,parent:t}],s=new ts;s.put(e);const r=this.xref,a=new Uint8ClampedArray(3);for(;i.length>0;){const o=i.shift(),l=r.fetchIfRef(o.obj);if(l===null)continue;l.has("Title")||ae("Invalid outline item encountered.");const c={url:null,dest:null,action:null};K5.parseDestDictionary({destDict:l,resultObj:c,docBaseUrl:this.baseUrl,docAttachments:this.attachments});const h=l.get("Title"),u=l.get("F")||0,d=l.getArray("C"),f=l.get("Count");let g=a;Yr(d,3)&&(d[0]!==0||d[1]!==0||d[2]!==0)&&(g=Dn.rgb.getRgb(d,0));const m={action:c.action,attachment:c.attachment,dest:c.dest,url:c.url,unsafeUrl:c.unsafeUrl,newWindow:c.newWindow,setOCGState:c.setOCGState,title:typeof h=="string"?Rn(h):"",color:g,count:Number.isInteger(f)?f:void 0,bold:!!(u&2),italic:!!(u&1),items:[]};o.parent.items.push(m),e=l.getRaw("First"),e instanceof tt&&!s.has(e)&&(i.push({obj:e,parent:m}),s.put(e)),e=l.getRaw("Next"),e instanceof tt&&!s.has(e)&&(i.push({obj:e,parent:o.parent}),s.put(e))}return t.items.length>0?t.items:null},CM=function(){const e=this.xref.trailer.get("Encrypt");if(!(e instanceof ue))return null;let t=e.get("P");if(typeof t!="number")return null;t+=2**32;const i=[];for(const s in Kv){const r=Kv[s];t&r&&i.push(r)}return i},AM=function(e){const t=this.xref.fetch(e),i={id:e.toString(),name:null,intent:null,usage:{print:null,view:null},rbGroups:[]},s=t.get("Name");typeof s=="string"&&(i.name=Rn(s));let r=t.getArray("Intent");Array.isArray(r)||(r=[r]),r.every(h=>h instanceof ve)&&(i.intent=r.map(h=>h.name));const a=t.get("Usage");if(!(a instanceof ue))return i;const o=i.usage,l=a.get("Print");if(l instanceof ue){const h=l.get("PrintState");if(h instanceof ve)switch(h.name){case"ON":case"OFF":o.print={printState:h.name}}}const c=a.get("View");if(c instanceof ue){const h=c.get("ViewState");if(h instanceof ve)switch(h.name){case"ON":case"OFF":o.view={viewState:h.name}}}return i},SM=function(e,t){function i(h){const u=[];if(Array.isArray(h))for(const d of h)d instanceof tt&&t.has(d)&&u.push(d.toString());return u}function s(h,u=0){if(!Array.isArray(h))return null;const d=[];for(const g of h){if(g instanceof tt&&t.has(g)){l.put(g),d.push(g.toString());continue}const m=r(g,u);m&&d.push(m)}if(u>0)return d;const f=[];for(const[g]of t.items())l.has(g)||f.push(g.toString());return f.length&&d.push({name:null,order:f}),d}function r(h,u){if(++u>c)return ae("parseNestedOrder - reached MAX_NESTED_LEVELS."),null;const d=o.fetchIfRef(h);if(!Array.isArray(d))return null;const f=o.fetchIfRef(d[0]);if(typeof f!="string")return null;const g=s(d.slice(1),u);return g!=null&&g.length?{name:Rn(f),order:g}:null}function a(h){if(Array.isArray(h))for(const u of h){const d=o.fetchIfRef(u);if(!Array.isArray(d)||!d.length)continue;const f=new Set;for(const g of d)g instanceof tt&&t.has(g)&&!f.has(g.toString())&&(f.add(g.toString()),t.get(g).rbGroups.push(f))}}const o=this.xref,l=new ts,c=10;return a(e.get("RBGroups")),{name:typeof e.get("Name")=="string"?Rn(e.get("Name")):null,creator:typeof e.get("Creator")=="string"?Rn(e.get("Creator")):null,baseState:e.get("BaseState")instanceof ve?e.get("BaseState").name:null,on:i(e.get("ON")),off:i(e.get("OFF")),order:s(e.get("Order")),groups:[...t]}},d6=function(){const e=x(this,Xn).get("Names"),t=[];return e!=null&&e.has("Dests")&&t.push(new vf(e.getRaw("Dests"),this.xref)),x(this,Xn).has("Dests")&&t.push(x(this,Xn).get("Dests")),t},IM=function(){const e=x(this,Xn).getRaw("PageLabels");if(!e)return null;const t=new Array(this.numPages);let i=null,s="";const a=new H3(e,this.xref).getAll();let o="",l=1;for(let c=0,h=this.numPages;c<h;c++){const u=a.get(c);if(u!==void 0){if(!(u instanceof ue))throw new Te("PageLabel is not a dictionary.");if(u.has("Type")&&!Li(u.get("Type"),"PageLabel"))throw new Te("Invalid type in PageLabel dictionary.");if(u.has("S")){const d=u.get("S");if(!(d instanceof ve))throw new Te("Invalid style in PageLabel dictionary.");i=d.name}else i=null;if(u.has("P")){const d=u.get("P");if(typeof d!="string")throw new Te("Invalid prefix in PageLabel dictionary.");s=Rn(d)}else s="";if(u.has("St")){const d=u.get("St");if(!(Number.isInteger(d)&&d>=1))throw new Te("Invalid start in PageLabel dictionary.");l=d}else l=1}switch(i){case"D":o=l;break;case"R":case"r":o=LU(l,i==="r");break;case"A":case"a":const d=26,m=i==="a"?97:65,b=l-1;o=String.fromCharCode(m+b%d).repeat(Math.floor(b/d)+1);break;default:if(i)throw new Te(`Invalid style "${i}" in PageLabel dictionary.`);o=""}t[c]=s+o,l++}return t},EM=function(){const e=x(this,Xn).get("Names");let t=null;function i(r,a){if(!(a instanceof ue)||!Li(a.get("S"),"JavaScript"))return;let o=a.get("JS");if(o instanceof dn)o=o.getString();else if(typeof o!="string")return;o=Rn(o,!0).replaceAll("\0",""),o&&(t||(t=new Map)).set(r,o)}if(e instanceof ue&&e.has("JavaScript")){const r=new vf(e.getRaw("JavaScript"),this.xref);for(const[a,o]of r.getAll())i(Rn(a,!0),o)}const s=x(this,Xn).get("OpenAction");return s&&i("OpenAction",s),t};let t2=K5;function YG(n){return n instanceof tt||n instanceof ue||n instanceof dn||Array.isArray(n)}function JG(n,e){if(n instanceof ue)n=n.getRawValues();else if(n instanceof dn)n=n.dict.getRawValues();else if(!Array.isArray(n))return;for(const t of n)YG(t)&&e.push(t)}var sx,f6;const nv=class nv{constructor(e,t,i){U(this,sx);Ue(this,"refSet",new ts);this.dict=e,this.keys=t,this.xref=i}async load(){const{keys:e,dict:t}=this,i=[];for(const s of e){const r=t.getRaw(s);r!==void 0&&i.push(r)}await F(this,sx,f6).call(this,i),this.refSet=null}static async load(e,t,i){if(i.stream.isDataLoaded)return;await new nv(e,t,i).load()}};sx=new WeakSet,f6=async function(e){const t=[],i=[];for(;e.length;){let s=e.pop();if(s instanceof tt){if(this.refSet.has(s))continue;try{this.refSet.put(s),s=this.xref.fetch(s)}catch(r){if(!(r instanceof vi)){ae(`ObjectLoader.#walk - requesting all data: "${r}".`),await this.xref.stream.manager.requestAllChunks();return}t.push(s),i.push({begin:r.begin,end:r.end})}}if(s instanceof dn){const r=s.getBaseStreams();if(r){let a=!1;for(const o of r)o.isDataLoaded||(a=!0,i.push({begin:o.start,end:o.end}));a&&t.push(s)}}JG(s,e)}if(i.length){await this.xref.stream.manager.requestRanges(i);for(const s of t)s instanceof tt&&this.refSet.remove(s);await F(this,sx,f6).call(this,t)}};let Bg=nv;const dy=Symbol(),Wd=Symbol(),Ui=Symbol(),Kh=Symbol(),Io=Symbol(),Gf=Symbol(),f3=Symbol(),el=Symbol(),Zl=Symbol(),De=Symbol("content"),vo=Symbol("data"),Ug=Symbol(),_e=Symbol("extra"),ni=Symbol(),_x=Symbol(),g6=Symbol(),TM=Symbol(),Kd=Symbol(),fy=Symbol(),n2=Symbol(),Ap=Symbol(),V4=Symbol(),mr=Symbol(),Sp=Symbol(),Ks=Symbol(),Hg=Symbol(),Ic=Symbol(),ns=Symbol(),en=Symbol(),$i=Symbol(),ti=Symbol(),i2=Symbol(),Lf=Symbol(),m6=Symbol(),g3=Symbol(),q4=Symbol(),pf=Symbol(),Vf=Symbol(),z0=Symbol(),Ip=Symbol(),g0=Symbol(),S0=Symbol(),s2=Symbol(),r2=Symbol(),ZG=Symbol(),es=Symbol("namespaceId"),Fn=Symbol("nodeName"),o0=Symbol(),sc=Symbol(),p6=Symbol(),m0=Symbol(),uc=Symbol(),pa=Symbol(),nm=Symbol(),Uh=Symbol(),RM=Symbol("root"),bp=Symbol(),l0=Symbol(),b6=Symbol(),MM=Symbol(),wa=Symbol(),Jo=Symbol(),_s=Symbol(),PM=Symbol(),Kt=Symbol(),Ep=Symbol(),Mn=Symbol(),qn=Symbol("uid"),ml=Symbol(),ss={config:{id:0,check:n=>n.startsWith("http://www.xfa.org/schema/xci/")},connectionSet:{id:1,check:n=>n.startsWith("http://www.xfa.org/schema/xfa-connection-set/")},datasets:{id:2,check:n=>n.startsWith("http://www.xfa.org/schema/xfa-data/")},form:{id:3,check:n=>n.startsWith("http://www.xfa.org/schema/xfa-form/")},localeSet:{id:4,check:n=>n.startsWith("http://www.xfa.org/schema/xfa-locale-set/")},pdf:{id:5,check:n=>n==="http://ns.adobe.com/xdp/pdf/"},signature:{id:6,check:n=>n==="http://www.w3.org/2000/09/xmldsig#"},sourceSet:{id:7,check:n=>n.startsWith("http://www.xfa.org/schema/xfa-source-set/")},stylesheet:{id:8,check:n=>n==="http://www.w3.org/1999/XSL/Transform"},template:{id:9,check:n=>n.startsWith("http://www.xfa.org/schema/xfa-template/")},xdc:{id:10,check:n=>n.startsWith("http://www.xfa.org/schema/xdc/")},xdp:{id:11,check:n=>n==="http://ns.adobe.com/xdp/"},xfdf:{id:12,check:n=>n==="http://ns.adobe.com/xfdf/"},xhtml:{id:13,check:n=>n==="http://www.w3.org/1999/xhtml"},xmpmeta:{id:14,check:n=>n==="http://ns.adobe.com/xmpmeta/"}},QG={pt:n=>n,cm:n=>n/2.54*72,mm:n=>n/(10*2.54)*72,in:n=>n*72,px:n=>n},$G=/([+-]?\d+\.?\d*)(.*)/;function gy(n){return n.startsWith("'")||n.startsWith('"')?n.slice(1,-1):n}function Qt({data:n,defaultValue:e,validate:t}){if(!n)return e;n=n.trim();const i=parseInt(n,10);return!isNaN(i)&&t(i)?i:e}function j3({data:n,defaultValue:e,validate:t}){if(!n)return e;n=n.trim();const i=parseFloat(n);return!isNaN(i)&&t(i)?i:e}function my({data:n,defaultValue:e,validate:t}){return n?(n=n.trim(),t(n)?n:e):e}function Le(n,e){return my({data:n,defaultValue:e[0],validate:t=>e.includes(t)})}function ft(n,e="0"){if(e||(e="0"),!n)return ft(e);const t=n.trim().match($G);if(!t)return ft(e);const[,i,s]=t,r=parseFloat(i);if(isNaN(r))return ft(e);if(r===0)return 0;const a=QG[s];return a?a(r):r}function aC(n){if(!n)return{num:1,den:1};const e=n.split(":",2).map(s=>parseFloat(s.trim())).filter(s=>!isNaN(s));if(e.length===1&&e.push(1),e.length===0)return{num:1,den:1};const[t,i]=e;return{num:t,den:i}}function pl(n){return n?n.trim().split(/\s+/).map(e=>({excluded:e[0]==="-",viewname:e.substring(1)})):[]}function eV(n,e=[0,0,0]){let[t,i,s]=e;if(!n)return{r:t,g:i,b:s};const r=n.split(",",3).map(a=>Ws(parseInt(a.trim(),10),0,255)).map(a=>isNaN(a)?0:a);return r.length<3?{r:t,g:i,b:s}:([t,i,s]=r,{r:t,g:i,b:s})}function tV(n){if(!n)return{x:-1,y:-1,width:-1,height:-1};const t=n.split(",",4).map(o=>ft(o.trim(),"-1"));if(t.length<4||t[2]<0||t[3]<0)return{x:-1,y:-1,width:-1,height:-1};const[i,s,r,a]=t;return{x:i,y:s,width:r,height:a}}class Et{static get FAILURE(){return We(this,"FAILURE",new Et(!1,null,null,null))}static get EMPTY(){return We(this,"EMPTY",new Et(!0,null,null,null))}constructor(e,t,i,s){this.success=e,this.html=t,this.bbox=i,this.breakNode=s}isBreak(){return!!this.breakNode}static breakNode(e){return new Et(!1,null,null,e)}static success(e,t=null){return new Et(!0,e,t,null)}}class nV{constructor(e){this.fonts=new Map,this.cache=new Map,this.warned=new Set,this.defaultFont=null,this.add(e)}add(e,t=null){for(const s of e)this.addPdfFont(s);for(const s of this.fonts.values())s.regular||(s.regular=s.italic||s.bold||s.bolditalic);if(!t||t.size===0)return;const i=this.fonts.get("PdfJS-Fallback-PdfJS-XFA");for(const s of t)this.fonts.set(s,i)}addPdfFont(e){var o,l,c;const t=e.cssFontInfo,i=t.fontFamily;let s=this.fonts.get(i);s||(s=Object.create(null),this.fonts.set(i,s),this.defaultFont||(this.defaultFont=s));let r="";const a=parseFloat(t.fontWeight);parseFloat(t.italicAngle)!==0?r=a>=700?"bolditalic":"italic":a>=700&&(r="bold"),r||((e.name.includes("Bold")||(o=e.psName)!=null&&o.includes("Bold"))&&(r="bold"),(e.name.includes("Italic")||e.name.endsWith("It")||(l=e.psName)!=null&&l.includes("Italic")||(c=e.psName)!=null&&c.endsWith("It"))&&(r+="italic")),r||(r="regular"),s[r]=e}getDefault(){return this.defaultFont}find(e,t=!0){var o,l;let i=this.fonts.get(e)||this.cache.get(e);if(i)return i;const s=/,|-|_| |bolditalic|bold|italic|regular|it/gi;let r=e.replaceAll(s,"");if(i=this.fonts.get(r),i)return this.cache.set(e,i),i;r=r.toLowerCase();const a=[];for(const[c,h]of this.fonts.entries())c.replaceAll(s,"").toLowerCase().startsWith(r)&&a.push(h);if(a.length===0)for(const[,c]of this.fonts.entries())(o=c.regular.name)!=null&&o.replaceAll(s,"").toLowerCase().startsWith(r)&&a.push(c);if(a.length===0){r=r.replaceAll(/psmt|mt/gi,"");for(const[c,h]of this.fonts.entries())c.replaceAll(s,"").toLowerCase().startsWith(r)&&a.push(h)}if(a.length===0)for(const c of this.fonts.values())(l=c.regular.name)!=null&&l.replaceAll(s,"").toLowerCase().startsWith(r)&&a.push(c);return a.length>=1?(a.length!==1&&t&&ae(`XFA - Too many choices to guess the correct font: ${e}`),this.cache.set(e,a[0]),a[0]):(t&&!this.warned.has(e)&&(this.warned.add(e),ae(`XFA - Cannot find the font: ${e}`)),null)}}function W4(n,e){return n.posture==="italic"?n.weight==="bold"?e.bolditalic:e.italic:n.weight==="bold"?e.bold:e.regular}function iV(n,e=!1){let t=null;if(n){const a=gy(n.typeface),o=n[ti].fontFinder.find(a);t=W4(n,o)}if(!t)return{lineHeight:12,lineGap:2,lineNoGap:10};const i=n.size||10,s=t.lineHeight?Math.max(e?0:1.2,t.lineHeight):1.2,r=t.lineGap===void 0?.2:t.lineGap;return{lineHeight:s*i,lineGap:r*i,lineNoGap:Math.max(1,s-r)*i}}const sV=1.02;class oC{constructor(e,t,i,s){if(this.lineHeight=i,this.paraMargin=t||{top:0,bottom:0,left:0,right:0},!e){[this.pdfFont,this.xfaFont]=this.defaultFont(s);return}this.xfaFont={typeface:e.typeface,posture:e.posture,weight:e.weight,size:e.size,letterSpacing:e.letterSpacing};const r=s.find(e.typeface);if(!r){[this.pdfFont,this.xfaFont]=this.defaultFont(s);return}this.pdfFont=W4(e,r),this.pdfFont||([this.pdfFont,this.xfaFont]=this.defaultFont(s))}defaultFont(e){const t=e.find("Helvetica",!1)||e.find("Myriad Pro",!1)||e.find("Arial",!1)||e.getDefault();if(t!=null&&t.regular){const s=t.regular,a={typeface:s.cssFontInfo.fontFamily,posture:"normal",weight:"normal",size:10,letterSpacing:0};return[s,a]}return[null,{typeface:"Courier",posture:"normal",weight:"normal",size:10,letterSpacing:0}]}}class rV{constructor(e,t,i,s){this.fontFinder=s,this.stack=[new oC(e,t,i,s)]}pushData(e,t,i){const s=this.stack.at(-1);for(const a of["typeface","posture","weight","size","letterSpacing"])e[a]||(e[a]=s.xfaFont[a]);for(const a of["top","bottom","left","right"])isNaN(t[a])&&(t[a]=s.paraMargin[a]);const r=new oC(e,t,i||s.lineHeight,this.fontFinder);r.pdfFont||(r.pdfFont=s.pdfFont),this.stack.push(r)}popFont(){this.stack.pop()}topFont(){return this.stack.at(-1)}}class aV{constructor(e,t,i,s){this.glyphs=[],this.fontSelector=new rV(e,t,i,s),this.extraHeight=0}pushData(e,t,i){this.fontSelector.pushData(e,t,i)}popFont(e){return this.fontSelector.popFont()}addPara(){const e=this.fontSelector.topFont();this.extraHeight+=e.paraMargin.top+e.paraMargin.bottom}addString(e){if(!e)return;const t=this.fontSelector.topFont(),i=t.xfaFont.size;if(t.pdfFont){const s=t.xfaFont.letterSpacing,r=t.pdfFont,a=r.lineHeight||1.2,o=t.lineHeight||Math.max(1.2,a)*i,l=r.lineGap===void 0?.2:r.lineGap,c=a-l,h=Math.max(1,c)*i,u=i/1e3,d=r.defaultWidth||r.charsToGlyphs(" ")[0].width;for(const f of e.split(/[\u2029\n]/)){const g=r.encodeString(f).join(""),m=r.charsToGlyphs(g);for(const b of m){const p=b.width||d;this.glyphs.push([p*u+s,o,h,b.unicode,!1])}this.glyphs.push([0,0,0,`
`,!0])}this.glyphs.pop();return}for(const s of e.split(/[\u2029\n]/)){for(const r of s.split(""))this.glyphs.push([i,1.2*i,i,r,!1]);this.glyphs.push([0,0,0,`
`,!0])}this.glyphs.pop()}compute(e){let t=-1,i=0,s=0,r=0,a=0,o=0,l=!1,c=!0;for(let h=0,u=this.glyphs.length;h<u;h++){const[d,f,g,m,b]=this.glyphs[h],p=m===" ",y=c?g:f;if(b){s=Math.max(s,a),a=0,r+=o,o=y,t=-1,i=0,c=!1;continue}if(p){a+d>e?(s=Math.max(s,a),a=0,r+=o,o=y,t=-1,i=0,l=!0,c=!1):(o=Math.max(y,o),i=a,a+=d,t=h);continue}if(a+d>e){r+=o,o=y,t!==-1?(h=t,s=Math.max(s,i),a=0,t=-1,i=0):(s=Math.max(s,a),a=d),l=!0,c=!1;continue}a+=d,o=Math.max(y,o)}return s=Math.max(s,a),r+=o+this.extraHeight,{width:sV*s,height:r,isBroken:l}}}const lC=/^[^.[]+/,oV=/^[^\]]+/,Wa={dot:0,dotDot:1,dotHash:2,dotBracket:3,dotParen:4},NM=new Map([["$data",(n,e)=>n.datasets?n.datasets.data:n],["$record",(n,e)=>(n.datasets?n.datasets.data:n)[Ks]()[0]],["$template",(n,e)=>n.template],["$connectionSet",(n,e)=>n.connectionSet],["$form",(n,e)=>n.form],["$layout",(n,e)=>n.layout],["$host",(n,e)=>n.host],["$dataWindow",(n,e)=>n.dataWindow],["$event",(n,e)=>n.event],["!",(n,e)=>n.datasets],["$xfa",(n,e)=>n],["xfa",(n,e)=>n],["$",(n,e)=>e]]),cC=new WeakMap;function lV(n){return n=n.trim(),n==="*"?1/0:parseInt(n,10)||0}function OM(n,e,t=!0){let i=n.match(lC);if(!i)return null;let[s]=i;const r=[{name:s,cacheName:"."+s,index:0,js:null,formCalc:null,operator:Wa.dot}];let a=s.length;for(;a<n.length;){const o=a;if(n.charAt(a++)==="["){if(i=n.slice(a).match(oV),!i)return ae("XFA - Invalid index in SOM expression"),null;r.at(-1).index=lV(i[0]),a+=i[0].length+1;continue}let c;switch(n.charAt(a)){case".":if(!e)return null;a++,c=Wa.dotDot;break;case"#":a++,c=Wa.dotHash;break;case"[":if(t)return ae("XFA - SOM expression contains a FormCalc subexpression which is not supported for now."),null;c=Wa.dotBracket;break;case"(":if(t)return ae("XFA - SOM expression contains a JavaScript subexpression which is not supported for now."),null;c=Wa.dotParen;break;default:c=Wa.dot;break}if(i=n.slice(a).match(lC),!i)break;[s]=i,a+=s.length,r.push({name:s,cacheName:n.slice(o,a),operator:c,index:0,js:null,formCalc:null})}return r}function L0(n,e,t,i=!0,s=!0){const r=OM(t,i);if(!r)return null;const a=NM.get(r[0].name);let o=0,l;a?(l=!0,n=[a(n,e)],o=1):(l=e===null,n=[e||n]);for(let c=r.length;o<c;o++){const{name:h,cacheName:u,operator:d,index:f}=r[o],g=[];for(const m of n){if(!m.isXFAObject)continue;let b,p;if(s&&(p=cC.get(m),p||(p=new Map,cC.set(m,p)),b=p.get(u)),!b){switch(d){case Wa.dot:b=m[n2](h,!1);break;case Wa.dotDot:b=m[n2](h,!0);break;case Wa.dotHash:b=m[fy](h),b=b.isXFAObjectArray?b.children:[b];break}s&&p.set(u,b)}b.length>0&&g.push(b)}if(g.length===0&&!l&&o===0){if(e=e[en](),!e)return null;o=-1,n=[e];continue}n=isFinite(f)?g.filter(m=>f<m.length).map(m=>m[f]):g.flat()}return n.length===0?null:n}function cV(n,e,t){const i=OM(t);if(!i||i.some(a=>a.operator===Wa.dotDot))return null;const s=NM.get(i[0].name);let r=0;s?(n=s(n,e),r=1):n=e||n;for(let a=i.length;r<a;r++){const{name:o,operator:l,index:c}=i[r];if(!isFinite(c))return i[r].index=0,n.createNodes(i.slice(r));let h;switch(l){case Wa.dot:h=n[n2](o,!1);break;case Wa.dotDot:h=n[n2](o,!0);break;case Wa.dotHash:h=n[fy](o),h=h.isXFAObjectArray?h.children:[h];break}if(h.length===0)return n.createNodes(i.slice(r));if(c<h.length){const u=h[c];if(!u.isXFAObject)return ae("XFA - Cannot create a node."),null;n=u}else return i[r].index=c-h.length,n.createNodes(i.slice(r))}return null}const l9=Symbol(),lu=Symbol(),kf=Symbol(),fn=Symbol("_children"),Uw=Symbol(),N0=Symbol(),Hw=Symbol(),hC=Symbol(),zw=Symbol(),uC=Symbol(),jw=Symbol(),xp=Symbol(),c9=Symbol(),bo=Symbol("parent"),qm=Symbol(),Wm=Symbol(),Gw=Symbol();let x6=0;const DM=ss.datasets.id;class Ie{constructor(e,t,i=!1){this[es]=e,this[Fn]=t,this[jw]=i,this[bo]=null,this[fn]=[],this[qn]=`${t}${x6++}`,this[ti]=null}get isXFAObject(){return!0}get isXFAObjectArray(){return!1}createNodes(e){let t=this,i=null;for(const{name:s,index:r}of e){for(let a=0,o=isFinite(r)?r:0;a<=o;a++){const l=t[es]===DM?-1:t[es];i=new rc(l,s),t[Ui](i)}t=i}return i}[sc](e){if(!this[jw]||!this[p6](e))return!1;const t=e[Fn],i=this[t];if(i instanceof re){if(i.push(e))return this[Ui](e),!0}else return i!==null&&this[Uh](i),this[t]=e,this[Ui](e),!0;let s="";return this.id?s=` (id: ${this.id})`:this.name&&(s=` (name: ${this.name} ${this.h.value})`),ae(`XFA - node "${this[Fn]}"${s} has already enough "${t}"!`),!1}[p6](e){return this.hasOwnProperty(e[Fn])&&e[es]===this[es]}[Ip](){return!1}[dy](){return!1}[q4](){return!1}[pf](){return!1}[pa](){this.para&&this[$i]()[_e].paraStack.pop()}[nm](){this[$i]()[_e].paraStack.push(this.para)}[b6](e){this.id&&this[es]===ss.template.id&&e.set(this.id,this)}[$i](){return this[ti].template}[g0](){return!1}[S0](){return!1}[Ui](e){e[bo]=this,this[fn].push(e),!e[ti]&&this[ti]&&(e[ti]=this[ti])}[Uh](e){const t=this[fn].indexOf(e);this[fn].splice(t,1)}[i2](){return this.hasOwnProperty("value")}[wa](e){}[m0](e){}[ni](){}[Io](e){delete this[jw],this[f3]&&(e.clean(this[f3]),delete this[f3])}[m6](e){return this[fn].indexOf(e)}[g3](e,t){t[bo]=this,this[fn].splice(e,0,t),!t[ti]&&this[ti]&&(t[ti]=this[ti])}[s2](){return!this.name}[ZG](){return""}[_s](){return this[fn].length===0?this[De]:this[fn].map(e=>e[_s]()).join("")}get[kf](){const e=Object.getPrototypeOf(this);if(!e._attributes){const t=e._attributes=new Set;for(const i of Object.getOwnPropertyNames(this)){if(this[i]===null||this[i]instanceof Ie||this[i]instanceof re)break;t.add(i)}}return We(this,kf,e._attributes)}[z0](e){let t=this;for(;t;){if(t===e)return!0;t=t[en]()}return!1}[en](){return this[bo]}[ns](){return this[en]()}[Ks](e=null){return e?this[e]:this[fn]}[Ug](){const e=Object.create(null);this[De]&&(e.$content=this[De]);for(const t of Object.getOwnPropertyNames(this)){const i=this[t];i!==null&&(i instanceof Ie?e[t]=i[Ug]():i instanceof re?i.isEmpty()||(e[t]=i.dump()):e[t]=i)}return e}[Mn](){return null}[Kt](){return Et.EMPTY}*[Hg](){for(const e of this[Ks]())yield e}*[hC](e,t){for(const i of this[Hg]())if(!e||t===e.has(i[Fn])){const s=this[Kd](),r=i[Kt](s);r.success||(this[_e].failingNode=i),yield r}}[_x](){return null}[Wd](e,t){this[_e].children.push(e)}[Kd](){}[Kh]({filter:e=null,include:t=!0}){if(!this[_e].generator)this[_e].generator=this[hC](e,t);else{const i=this[Kd](),s=this[_e].failingNode[Kt](i);if(!s.success)return s;s.html&&this[Wd](s.html,s.bbox),delete this[_e].failingNode}for(;;){const i=this[_e].generator.next();if(i.done)break;const s=i.value;if(!s.success)return s;s.html&&this[Wd](s.html,s.bbox)}return this[_e].generator=null,Et.EMPTY}[MM](e){this[Wm]=new Set(Object.keys(e))}[uC](e){const t=this[kf],i=this[Wm];return[...e].filter(s=>t.has(s)&&!i.has(s))}[bp](e,t=new Set){for(const i of this[fn])i[qm](e,t)}[qm](e,t){const i=this[zw](e,t);i?this[l9](i,e,t):this[bp](e,t)}[zw](e,t){const{use:i,usehref:s}=this;if(!i&&!s)return null;let r=null,a=null,o=null,l=i;if(s?(l=s,s.startsWith("#som(")&&s.endsWith(")")?a=s.slice(5,-1):s.startsWith(".#som(")&&s.endsWith(")")?a=s.slice(6,-1):s.startsWith("#")?o=s.slice(1):s.startsWith(".#")&&(o=s.slice(2))):i.startsWith("#")?o=i.slice(1):a=i,this.use=this.usehref="",o?r=e.get(o):(r=L0(e.get(RM),this,a,!0,!1),r&&(r=r[0])),!r)return ae(`XFA - Invalid prototype reference: ${l}.`),null;if(r[Fn]!==this[Fn])return ae(`XFA - Incompatible prototype: ${r[Fn]} !== ${this[Fn]}.`),null;if(t.has(r))return ae("XFA - Cycle detected in prototypes use."),null;t.add(r);const c=r[zw](e,t);return c&&r[l9](c,e,t),r[bp](e,t),t.delete(r),r}[l9](e,t,i){if(i.has(e)){ae("XFA - Cycle detected in prototypes use.");return}!this[De]&&e[De]&&(this[De]=e[De]),new Set(i).add(e);for(const r of this[uC](e[Wm]))this[r]=e[r],this[Wm]&&this[Wm].add(r);for(const r of Object.getOwnPropertyNames(this)){if(this[kf].has(r))continue;const a=this[r],o=e[r];if(a instanceof re){for(const l of a[fn])l[qm](t,i);for(let l=a[fn].length,c=o[fn].length;l<c;l++){const h=e[fn][l][el]();if(a.push(h))h[bo]=this,this[fn].push(h),h[qm](t,i);else break}continue}if(a!==null){a[bp](t,i),o&&a[l9](o,t,i);continue}if(o!==null){const l=o[el]();l[bo]=this,this[r]=l,this[fn].push(l),l[qm](t,i)}}}static[Uw](e){return Array.isArray(e)?e.map(t=>Ie[Uw](t)):typeof e=="object"&&e!==null?Object.assign({},e):e}[el](){const e=Object.create(Object.getPrototypeOf(this));for(const t of Object.getOwnPropertySymbols(this))try{e[t]=this[t]}catch{We(e,t,this[t])}e[qn]=`${e[Fn]}${x6++}`,e[fn]=[];for(const t of Object.getOwnPropertyNames(this)){if(this[kf].has(t)){e[t]=Ie[Uw](this[t]);continue}const i=this[t];e[t]=i instanceof re?new re(i[xp]):null}for(const t of this[fn]){const i=t[Fn],s=t[el]();e[fn].push(s),s[bo]=e,e[i]===null?e[i]=s:e[i][fn].push(s)}return e}[Ks](e=null){return e?this[fn].filter(t=>t[Fn]===e):this[fn]}[fy](e){return this[e]}[n2](e,t,i=!0){return Array.from(this[Ap](e,t,i))}*[Ap](e,t,i=!0){if(e==="parent"){yield this[bo];return}for(const s of this[fn])s[Fn]===e&&(yield s),s.name===e&&(yield s),(t||s[s2]())&&(yield*s[Ap](e,t,!1));i&&this[kf].has(e)&&(yield new K4(this,e,this[e]))}}class re{constructor(e=1/0){this[xp]=e,this[fn]=[]}get isXFAObject(){return!1}get isXFAObjectArray(){return!0}push(e){return this[fn].length<=this[xp]?(this[fn].push(e),!0):(ae(`XFA - node "${e[Fn]}" accepts no more than ${this[xp]} children`),!1)}isEmpty(){return this[fn].length===0}dump(){return this[fn].length===1?this[fn][0][Ug]():this[fn].map(e=>e[Ug]())}[el](){const e=new re(this[xp]);return e[fn]=this[fn].map(t=>t[el]()),e}get children(){return this[fn]}clear(){this[fn].length=0}}class K4{constructor(e,t,i){this[bo]=e,this[Fn]=t,this[De]=i,this[Zl]=!1,this[qn]=`attribute${x6++}`}[en](){return this[bo]}[Vf](){return!0}[V4](){return this[De].trim()}[wa](e){e=e.value||"",this[De]=e.toString()}[_s](){return this[De]}[z0](e){return this[bo]===e||this[bo][z0](e)}}class rc extends Ie{constructor(e,t,i={}){if(super(e,t),this[De]="",this[N0]=null,t!=="#text"){const s=new Map;this[lu]=s;for(const[r,a]of Object.entries(i))s.set(r,new K4(this,r,a));if(i.hasOwnProperty(o0)){const r=i[o0].xfa.dataNode;r!==void 0&&(r==="dataGroup"?this[N0]=!1:r==="dataValue"&&(this[N0]=!0))}}this[Zl]=!1}[Ep](e){const t=this[Fn];if(t==="#text"){e.push(l1(this[De]));return}const i=R7(t),s=this[es]===DM?"xfa:":"";e.push(`<${s}${i}`);for(const[r,a]of this[lu].entries()){const o=R7(r);e.push(` ${o}="${l1(a[De])}"`)}if(this[N0]!==null&&(this[N0]?e.push(' xfa:dataNode="dataValue"'):e.push(' xfa:dataNode="dataGroup"')),!this[De]&&this[fn].length===0){e.push("/>");return}if(e.push(">"),this[De])typeof this[De]=="string"?e.push(l1(this[De])):this[De][Ep](e);else for(const r of this[fn])r[Ep](e);e.push(`</${s}${i}>`)}[sc](e){if(this[De]){const t=new rc(this[es],"#text");this[Ui](t),t[De]=this[De],this[De]=""}return this[Ui](e),!0}[m0](e){this[De]+=e}[ni](){if(this[De]&&this[fn].length>0){const e=new rc(this[es],"#text");this[Ui](e),e[De]=this[De],delete this[De]}}[Kt](){return this[Fn]==="#text"?Et.success({name:"#text",value:this[De]}):Et.EMPTY}[Ks](e=null){return e?this[fn].filter(t=>t[Fn]===e):this[fn]}[TM](){return this[lu]}[fy](e){const t=this[lu].get(e);return t!==void 0?t:this[Ks](e)}*[Ap](e,t){const i=this[lu].get(e);i&&(yield i);for(const s of this[fn])s[Fn]===e&&(yield s),t&&(yield*s[Ap](e,t))}*[g6](e,t){const i=this[lu].get(e);i&&(!t||!i[Zl])&&(yield i);for(const s of this[fn])yield*s[g6](e,t)}*[Sp](e,t,i){for(const s of this[fn])s[Fn]===e&&(!i||!s[Zl])&&(yield s),t&&(yield*s[Sp](e,t,i))}[Vf](){return this[N0]===null?this[fn].length===0||this[fn][0][es]===ss.xhtml.id:this[N0]}[V4](){return this[N0]===null?this[fn].length===0?this[De].trim():this[fn][0][es]===ss.xhtml.id?this[fn][0][_s]().trim():null:this[De].trim()}[wa](e){e=e.value||"",this[De]=e.toString()}[Ug](e=!1){const t=Object.create(null);e&&(t.$ns=this[es]),this[De]&&(t.$content=this[De]),t.$name=this[Fn],t.children=[];for(const i of this[fn])t.children.push(i[Ug](e));t.attributes=Object.create(null);for(const[i,s]of this[lu])t.attributes[i]=s[De];return t}}class Gi extends Ie{constructor(e,t){super(e,t),this[De]=""}[m0](e){this[De]+=e}[ni](){}}class Wn extends Gi{constructor(e,t,i){super(e,t),this[c9]=i}[ni](){this[De]=my({data:this[De],defaultValue:this[c9][0],validate:e=>this[c9].includes(e)})}[Io](e){super[Io](e),delete this[c9]}}class yn extends Gi{[ni](){this[De]=this[De].trim()}}class bl extends Gi{constructor(e,t,i,s){super(e,t),this[Hw]=i,this[Gw]=s}[ni](){this[De]=Qt({data:this[De],defaultValue:this[Hw],validate:this[Gw]})}[Io](e){super[Io](e),delete this[Hw],delete this[Gw]}}class ks extends bl{constructor(e,t){super(e,t,0,i=>i===1)}}class FM extends bl{constructor(e,t){super(e,t,1,i=>i===0)}}function Zt(n){return typeof n=="string"?"0px":Number.isInteger(n)?`${n}px`:`${n.toFixed(2)}px`}const dC={anchorType(n,e){const t=n[ns]();if(!(!t||t.layout&&t.layout!=="position"))switch("transform"in e||(e.transform=""),n.anchorType){case"bottomCenter":e.transform+="translate(-50%, -100%)";break;case"bottomLeft":e.transform+="translate(0,-100%)";break;case"bottomRight":e.transform+="translate(-100%,-100%)";break;case"middleCenter":e.transform+="translate(-50%,-50%)";break;case"middleLeft":e.transform+="translate(0,-50%)";break;case"middleRight":e.transform+="translate(-100%,-50%)";break;case"topCenter":e.transform+="translate(-50%,0)";break;case"topRight":e.transform+="translate(-100%,0)";break}},dimensions(n,e){var r;const t=n[ns]();let i=n.w;const s=n.h;if((r=t.layout)!=null&&r.includes("row")){const a=t[_e],o=n.colSpan;let l;o===-1?(l=Math.sumPrecise(a.columnWidths.slice(a.currentColumn)),a.currentColumn=0):(l=Math.sumPrecise(a.columnWidths.slice(a.currentColumn,a.currentColumn+o)),a.currentColumn=(a.currentColumn+n.colSpan)%a.columnWidths.length),isNaN(l)||(i=n.w=l)}e.width=i!==""?Zt(i):"auto",e.height=s!==""?Zt(s):"auto"},position(n,e){const t=n[ns]();t!=null&&t.layout&&t.layout!=="position"||(e.position="absolute",e.left=Zt(n.x),e.top=Zt(n.y))},rotate(n,e){n.rotate&&("transform"in e||(e.transform=""),e.transform+=`rotate(-${n.rotate}deg)`,e.transformOrigin="top left")},presence(n,e){switch(n.presence){case"invisible":e.visibility="hidden";break;case"hidden":case"inactive":e.display="none";break}},hAlign(n,e){if(n[Fn]==="para")switch(n.hAlign){case"justifyAll":e.textAlign="justify-all";break;case"radix":e.textAlign="left";break;default:e.textAlign=n.hAlign}else switch(n.hAlign){case"left":e.alignSelf="start";break;case"center":e.alignSelf="center";break;case"right":e.alignSelf="end";break}},margin(n,e){n.margin&&(e.margin=n.margin[Mn]().margin)}};function LM(n,e){n[ns]().layout==="position"&&(n.minW>0&&(e.minWidth=Zt(n.minW)),n.maxW>0&&(e.maxWidth=Zt(n.maxW)),n.minH>0&&(e.minHeight=Zt(n.minH)),n.maxH>0&&(e.maxHeight=Zt(n.maxH)))}function fC(n,e,t,i,s,r){const a=new aV(e,t,i,s);return typeof n=="string"?a.addString(n):n[uc](a),a.compute(r)}function X4(n,e){let t=null,i=null,s=!1;if((!n.w||!n.h)&&n.value){let r=0,a=0;n.margin&&(r=n.margin.leftInset+n.margin.rightInset,a=n.margin.topInset+n.margin.bottomInset);let o=null,l=null;n.para&&(l=Object.create(null),o=n.para.lineHeight===""?null:n.para.lineHeight,l.top=n.para.spaceAbove===""?0:n.para.spaceAbove,l.bottom=n.para.spaceBelow===""?0:n.para.spaceBelow,l.left=n.para.marginLeft===""?0:n.para.marginLeft,l.right=n.para.marginRight===""?0:n.para.marginRight);let c=n.font;if(!c){const d=n[$i]();let f=n[en]();for(;f&&f!==d;){if(f.font){c=f.font;break}f=f[en]()}}const h=(n.w||e.width)-r,u=n[ti].fontFinder;if(n.value.exData&&n.value.exData[De]&&n.value.exData.contentType==="text/html"){const d=fC(n.value.exData[De],c,l,o,u,h);i=d.width,t=d.height,s=d.isBroken}else{const d=n.value[_s]();if(d){const f=fC(d,c,l,o,u,h);i=f.width,t=f.height,s=f.isBroken}}i!==null&&!n.w&&(i+=r),t!==null&&!n.h&&(t+=a)}return{w:i,h:t,isBroken:s}}function BM(n,e,t){let i;if(n.w!==""&&n.h!=="")i=[n.x,n.y,n.w,n.h];else{if(!t)return null;let s=n.w;if(s===""){if(n.maxW===0){const a=n[ns]();s=a.layout==="position"&&a.w!==""?0:n.minW}else s=Math.min(n.maxW,t.width);e.attributes.style.width=Zt(s)}let r=n.h;if(r===""){if(n.maxH===0){const a=n[ns]();r=a.layout==="position"&&a.h!==""?0:n.minH}else r=Math.min(n.maxH,t.height);e.attributes.style.height=Zt(r)}i=[n.x,n.y,s,r]}return i}function py(n){var t;const e=n[ns]();if((t=e.layout)!=null&&t.includes("row")){const i=e[_e],s=n.colSpan;let r;s===-1?r=Math.sumPrecise(i.columnWidths.slice(i.currentColumn)):r=Math.sumPrecise(i.columnWidths.slice(i.currentColumn,i.currentColumn+s)),isNaN(r)||(n.w=r)}e.layout&&e.layout!=="position"&&(n.x=n.y=0),n.layout==="table"&&n.w===""&&Array.isArray(n.columnWidths)&&(n.w=Math.sumPrecise(n.columnWidths))}function UM(n){switch(n.layout){case"position":return"xfaPosition";case"lr-tb":return"xfaLrTb";case"rl-row":return"xfaRlRow";case"rl-tb":return"xfaRlTb";case"row":return"xfaRow";case"table":return"xfaTable";case"tb":return"xfaTb";default:return"xfaPosition"}}function ra(n,...e){const t=Object.create(null);for(const i of e){const s=n[i];if(s!==null){if(dC.hasOwnProperty(i)){dC[i](n,t);continue}if(s instanceof Ie){const r=s[Mn]();r?Object.assign(t,r):ae(`(DEBUG) - XFA - style for ${i} not implemented yet`)}}}return t}function Xd(n,e){const{attributes:t}=e,{style:i}=t,s={name:"div",attributes:{class:["xfaWrapper"],style:Object.create(null)},children:[]};if(t.class.push("xfaWrapped"),n.border){const{widths:r,insets:a}=n.border[_e];let o,l,c=a[0],h=a[3];const u=a[0]+a[2],d=a[1]+a[3];switch(n.border.hand){case"even":c-=r[0]/2,h-=r[3]/2,o=`calc(100% + ${(r[1]+r[3])/2-d}px)`,l=`calc(100% + ${(r[0]+r[2])/2-u}px)`;break;case"left":c-=r[0],h-=r[3],o=`calc(100% + ${r[1]+r[3]-d}px)`,l=`calc(100% + ${r[0]+r[2]-u}px)`;break;case"right":o=d?`calc(100% - ${d}px)`:"100%",l=u?`calc(100% - ${u}px)`:"100%";break}const f=["xfaBorder"];im(n.border)&&f.push("xfaPrintOnly");const g={name:"div",attributes:{class:f,style:{top:`${c}px`,left:`${h}px`,width:o,height:l}},children:[]};for(const m of["border","borderWidth","borderColor","borderRadius","borderStyle"])i[m]!==void 0&&(g.attributes.style[m]=i[m],delete i[m]);s.children.push(g,e)}else s.children.push(e);for(const r of["background","backgroundClip","top","left","width","height","minWidth","minHeight","maxWidth","maxHeight","transform","transformOrigin","visibility"])i[r]!==void 0&&(s.attributes.style[r]=i[r],delete i[r]);return s.attributes.style.position=i.position==="absolute"?"absolute":"relative",delete i.position,i.alignSelf&&(s.attributes.style.alignSelf=i.alignSelf,delete i.alignSelf),s}function HM(n){const e=ft(n.textIndent,"0px");if(e>=0)return;const i="padding"+((n.textAlign==="right"?"right":"left")==="left"?"Left":"Right"),s=ft(n[i],"0px");n[i]=`${s-e}px`}function Y4(n,e){switch(n.access){case"nonInteractive":e.push("xfaNonInteractive");break;case"readOnly":e.push("xfaReadOnly");break;case"protected":e.push("xfaDisabled");break}}function im(n){return n.relevant.length>0&&!n.relevant[0].excluded&&n.relevant[0].viewname==="print"}function zM(n){const e=n[$i]()[_e].paraStack;return e.length?e.at(-1):null}function jM(n,e,t){var i;if((i=t.attributes.class)!=null&&i.includes("xfaRich")){e&&(n.h===""&&(e.height="auto"),n.w===""&&(e.width="auto"));const s=zM(n);if(s){const r=t.attributes.style;switch(r.display="flex",r.flexDirection="column",s.vAlign){case"top":r.justifyContent="start";break;case"bottom":r.justifyContent="end";break;case"middle":r.justifyContent="center";break}const a=s[Mn]();for(const[o,l]of Object.entries(a))o in r||(r[o]=l)}}}function GM(n,e,t,i){if(!t){delete i.fontFamily;return}const s=gy(n.typeface);i.fontFamily=`"${s}"`;const r=t.find(s);if(r){const{fontFamily:a}=r.regular.cssFontInfo;a!==s&&(i.fontFamily=`"${a}"`);const o=zM(e);if(o&&o.lineHeight!==""||i.lineHeight)return;const l=W4(n,r);l&&(i.lineHeight=Math.max(1.2,l.lineHeight))}}function VM(n){const e=P3(n,null,{addDefaultProtocol:!0,tryConvertEncoding:!0});return e?e.href:null}function qM(n,e){return{name:"div",attributes:{class:[n.layout==="lr-tb"?"xfaLr":"xfaRl"]},children:e}}function WM(n){if(!n[_e])return null;const t={name:"div",attributes:n[_e].attributes,children:n[_e].children};if(n[_e].failingNode){const i=n[_e].failingNode[_x]();i&&(n.layout.endsWith("-tb")?t.children.push(qM(n,[i])):t.children.push(i))}return t.children.length===0?null:t}function KM(n,e,t){const i=n[_e],s=i.availableSpace,[r,a,o,l]=t;switch(n.layout){case"position":{i.width=Math.max(i.width,r+o),i.height=Math.max(i.height,a+l),i.children.push(e);break}case"lr-tb":case"rl-tb":(!i.line||i.attempt===1)&&(i.line=qM(n,[]),i.children.push(i.line),i.numberInLine=0),i.numberInLine+=1,i.line.children.push(e),i.attempt===0?(i.currentWidth+=o,i.height=Math.max(i.height,i.prevHeight+l)):(i.currentWidth=o,i.prevHeight=i.height,i.height+=l,i.attempt=0),i.width=Math.max(i.width,i.currentWidth);break;case"rl-row":case"row":{i.children.push(e),i.width+=o,i.height=Math.max(i.height,l);const c=Zt(i.height);for(const h of i.children)h.attributes.style.height=c;break}case"table":{i.width=Ws(o,i.width,s.width),i.height+=l,i.children.push(e);break}case"tb":{i.width=Ws(o,i.width,s.width),i.height+=l,i.children.push(e);break}}}function XM(n){const e=n[_e].availableSpace,t=n.margin?n.margin.topInset+n.margin.bottomInset:0,i=n.margin?n.margin.leftInset+n.margin.rightInset:0;switch(n.layout){case"lr-tb":case"rl-tb":return n[_e].attempt===0?{width:e.width-i-n[_e].currentWidth,height:e.height-t-n[_e].prevHeight}:{width:e.width-i,height:e.height-t-n[_e].height};case"rl-row":case"row":return{width:Math.sumPrecise(n[_e].columnWidths.slice(n[_e].currentColumn)),height:e.height-i};case"table":case"tb":return{width:e.width-i,height:e.height-t-n[_e].height};case"position":default:return e}}function hV(n){let e=n.w===""?NaN:n.w,t=n.h===""?NaN:n.h,[i,s]=[0,0];switch(n.anchorType||""){case"bottomCenter":[i,s]=[e/2,t];break;case"bottomLeft":[i,s]=[0,t];break;case"bottomRight":[i,s]=[e,t];break;case"middleCenter":[i,s]=[e/2,t/2];break;case"middleLeft":[i,s]=[0,t/2];break;case"middleRight":[i,s]=[e,t/2];break;case"topCenter":[i,s]=[e/2,0];break;case"topRight":[i,s]=[e,0];break}let r,a;switch(n.rotate||0){case 0:[r,a]=[-i,-s];break;case 90:[r,a]=[-s,i],[e,t]=[t,-e];break;case 180:[r,a]=[i,s],[e,t]=[-e,-t];break;case 270:[r,a]=[s,-i],[e,t]=[-t,e];break}return[n.x+r+Math.min(0,e),n.y+a+Math.min(0,t),Math.abs(e),Math.abs(t)]}function by(n,e){var l;if(n[$i]()[_e].firstUnsplittable===null||n.w===0||n.h===0)return!0;const t=2,i=n[ns](),s=((l=i[_e])==null?void 0:l.attempt)||0,[,r,a,o]=hV(n);switch(i.layout){case"lr-tb":case"rl-tb":return s===0?n[$i]()[_e].noLayoutFailure?n.w!==""?Math.round(a-e.width)<=t:e.width>t:n.h!==""&&Math.round(o-e.height)>t?!1:n.w!==""?Math.round(a-e.width)<=t?!0:i[_e].numberInLine===0?e.height>t:!1:e.width>t:n[$i]()[_e].noLayoutFailure?!0:n.h!==""&&Math.round(o-e.height)>t?!1:n.w===""||Math.round(a-e.width)<=t?e.height>t:i[S0]()?!1:e.height>t;case"table":case"tb":return n[$i]()[_e].noLayoutFailure?!0:n.h!==""&&!n[g0]()?Math.round(o-e.height)<=t:n.w===""||Math.round(a-e.width)<=t?e.height>t:i[S0]()?!1:e.height>t;case"position":if(n[$i]()[_e].noLayoutFailure||n.h===""||Math.round(o+r-e.height)<=t)return!0;const c=n[$i]()[_e].currentContentArea;return o+r>c.h;case"rl-row":case"row":return n[$i]()[_e].noLayoutFailure?!0:n.h!==""?Math.round(o-e.height)<=t:!0;default:return!0}}const Je=ss.template.id,Yd="http://www.w3.org/2000/svg",G3=2,uV=3,dV=5e3,fV=/^H(\d+)$/,gV=new Set(["image/gif","image/jpeg","image/jpg","image/pjpeg","image/png","image/apng","image/x-png","image/bmp","image/x-ms-bmp","image/tiff","image/tif","application/octet-stream"]),mV=[[[66,77],"image/bmp"],[[255,216,255],"image/jpeg"],[[73,73,42,0],"image/tiff"],[[77,77,0,42],"image/tiff"],[[71,73,70,56,57,97],"image/gif"],[[137,80,78,71,13,10,26,10],"image/png"]];function gC(n){if(!n||!n.border)return{w:0,h:0};const e=n.border[mr]();return e?{w:e.widths[0]+e.widths[2]+e.insets[0]+e.insets[2],h:e.widths[1]+e.widths[3]+e.insets[1]+e.insets[3]}:{w:0,h:0}}function J4(n){return n.margin&&(n.margin.topInset||n.margin.rightInset||n.margin.bottomInset||n.margin.leftInset)}function Z4(n,e){if(!n.value){const t=new s_({});n[Ui](t),n.value=t}n.value[wa](e)}function*Q4(n){for(const e of n[Ks]()){if(e instanceof t_){yield*e[Hg]();continue}yield e}}function vx(n){var e;return((e=n.validate)==null?void 0:e.nullTest)==="error"}function xy(n){for(;n;){if(!n.traversal){n[Jo]=n[en]()[Jo];return}if(n[Jo])return;let e=null;for(const s of n.traversal[Ks]())if(s.operation==="next"){e=s;break}if(!e||!e.ref){n[Jo]=n[en]()[Jo];return}const t=n[$i]();n[Jo]=++t[Jo];const i=t[l0](e.ref,n);if(!i)return;n=i[0]}}function yy(n,e){var i;const t=n.assist;if(t){const s=t[Kt]();s&&(e.title=s);const a=t.role.match(fV);if(a){const o="heading",l=a[1];e.role=o,e["aria-level"]=l}}if(n.layout==="table")e.role="table";else if(n.layout==="row")e.role="row";else{const s=n[en]();s.layout==="row"&&(e.role=((i=s.assist)==null?void 0:i.role)==="TH"?"columnheader":"cell")}}function sf(n){if(!n.assist)return null;const e=n.assist;return e.speak&&e.speak[De]!==""?e.speak[De]:e.toolTip?e.toolTip[De]:null}function eu(n){return Et.success({name:"div",attributes:{class:["xfaRich"],style:Object.create(null)},children:[{name:"span",attributes:{style:Object.create(null)},value:n}]})}function wy(n){const e=n[$i]();e[_e].firstUnsplittable===null&&(e[_e].firstUnsplittable=n,e[_e].noLayoutFailure=!0)}function _y(n){const e=n[$i]();e[_e].firstUnsplittable===n&&(e[_e].noLayoutFailure=!1)}function mC(n){if(n[_e]||(n[_e]=Object.create(null),n.targetType==="auto"))return!1;const e=n[$i]();let t=null;if(n.target){if(t=e[l0](n.target,n[en]()),!t)return!1;t=t[0]}const{currentPageArea:i,currentContentArea:s}=e[_e];if(n.targetType==="pageArea")return t instanceof zg||(t=null),n.startNew?(n[_e].target=t||i,!0):t&&t!==i?(n[_e].target=t,!0):!1;t instanceof $4||(t=null);const r=t&&t[en]();let a,o=r;if(n.startNew)if(t){const l=r.contentArea.children,c=l.indexOf(s),h=l.indexOf(t);c!==-1&&c<h&&(o=null),a=h-1}else a=i.contentArea.children.indexOf(s);else if(t&&t!==s)a=r.contentArea.children.indexOf(t)-1,o=r===i?null:r;else return!1;return n[_e].target=o,n[_e].index=a,!0}function pC(n,e,t){const i=n[$i](),s=i[_e].noLayoutFailure,r=e[ns];e[ns]=()=>n,i[_e].noLayoutFailure=!0;const a=e[Kt](t);n[Wd](a.html,a.bbox),i[_e].noLayoutFailure=s,e[ns]=r}class pV extends yn{constructor(e){super(Je,"appearanceFilter"),this.id=e.id||"",this.type=Le(e.type,["optional","required"]),this.use=e.use||"",this.usehref=e.usehref||""}}class YM extends Ie{constructor(e){super(Je,"arc",!0),this.circular=Qt({data:e.circular,defaultValue:0,validate:t=>t===1}),this.hand=Le(e.hand,["even","left","right"]),this.id=e.id||"",this.startAngle=j3({data:e.startAngle,defaultValue:0,validate:t=>!0}),this.sweepAngle=j3({data:e.sweepAngle,defaultValue:360,validate:t=>!0}),this.use=e.use||"",this.usehref=e.usehref||"",this.edge=null,this.fill=null}[Kt](){var l;const e=this.edge||new kx({}),t=e[Mn](),i=Object.create(null);((l=this.fill)==null?void 0:l.presence)==="visible"?Object.assign(i,this.fill[Mn]()):i.fill="transparent",i.strokeWidth=Zt(e.presence==="visible"?e.thickness:0),i.stroke=t.color;let s;const r={xmlns:Yd,style:{width:"100%",height:"100%",overflow:"visible"}};if(this.sweepAngle===360)s={name:"ellipse",attributes:{xmlns:Yd,cx:"50%",cy:"50%",rx:"50%",ry:"50%",style:i}};else{const c=this.startAngle*Math.PI/180,h=this.sweepAngle*Math.PI/180,u=this.sweepAngle>180?1:0,[d,f,g,m]=[50*(1+Math.cos(c)),50*(1-Math.sin(c)),50*(1+Math.cos(c+h)),50*(1-Math.sin(c+h))];s={name:"path",attributes:{xmlns:Yd,d:`M ${d} ${f} A 50 50 0 ${u} 0 ${g} ${m}`,vectorEffect:"non-scaling-stroke",style:i}},Object.assign(r,{viewBox:"0 0 100 100",preserveAspectRatio:"none"})}const a={name:"svg",children:[s],attributes:r},o=this[en]()[en]();return J4(o)?Et.success({name:"div",attributes:{style:{display:"inline",width:"100%",height:"100%"}},children:[a]}):(a.attributes.style.position="absolute",Et.success(a))}}class bV extends Ie{constructor(e){super(Je,"area",!0),this.colSpan=Qt({data:e.colSpan,defaultValue:1,validate:t=>t>=1||t===-1}),this.id=e.id||"",this.name=e.name||"",this.relevant=pl(e.relevant),this.use=e.use||"",this.usehref=e.usehref||"",this.x=ft(e.x,"0pt"),this.y=ft(e.y,"0pt"),this.desc=null,this.extras=null,this.area=new re,this.draw=new re,this.exObject=new re,this.exclGroup=new re,this.field=new re,this.subform=new re,this.subformSet=new re}*[Hg](){yield*Q4(this)}[s2](){return!0}[pf](){return!0}[Wd](e,t){const[i,s,r,a]=t;this[_e].width=Math.max(this[_e].width,i+r),this[_e].height=Math.max(this[_e].height,s+a),this[_e].children.push(e)}[Kd](){return this[_e].availableSpace}[Kt](e){const t=ra(this,"position"),i={style:t,id:this[qn],class:["xfaArea"]};im(this)&&i.class.push("xfaPrintOnly"),this.name&&(i.xfaName=this.name);const s=[];this[_e]={children:s,width:0,height:0,availableSpace:e};const r=this[Kh]({filter:new Set(["area","draw","field","exclGroup","subform","subformSet"]),include:!0});if(!r.success)return r.isBreak()?r:(delete this[_e],Et.FAILURE);t.width=Zt(this[_e].width),t.height=Zt(this[_e].height);const a={name:"div",attributes:i,children:s},o=[this.x,this.y,this[_e].width,this[_e].height];return delete this[_e],Et.success(a,o)}}class xV extends Ie{constructor(e){super(Je,"assist",!0),this.id=e.id||"",this.role=e.role||"",this.use=e.use||"",this.usehref=e.usehref||"",this.speak=null,this.toolTip=null}[Kt](){var e;return((e=this.toolTip)==null?void 0:e[De])||null}}class yV extends Ie{constructor(e){super(Je,"barcode",!0),this.charEncoding=my({data:e.charEncoding?e.charEncoding.toLowerCase():"",defaultValue:"",validate:t=>["utf-8","big-five","fontspecific","gbk","gb-18030","gb-2312","ksc-5601","none","shift-jis","ucs-2","utf-16"].includes(t)||t.match(/iso-8859-\d{2}/)}),this.checksum=Le(e.checksum,["none","1mod10","1mod10_1mod11","2mod10","auto"]),this.dataColumnCount=Qt({data:e.dataColumnCount,defaultValue:-1,validate:t=>t>=0}),this.dataLength=Qt({data:e.dataLength,defaultValue:-1,validate:t=>t>=0}),this.dataPrep=Le(e.dataPrep,["none","flateCompress"]),this.dataRowCount=Qt({data:e.dataRowCount,defaultValue:-1,validate:t=>t>=0}),this.endChar=e.endChar||"",this.errorCorrectionLevel=Qt({data:e.errorCorrectionLevel,defaultValue:-1,validate:t=>t>=0&&t<=8}),this.id=e.id||"",this.moduleHeight=ft(e.moduleHeight,"5mm"),this.moduleWidth=ft(e.moduleWidth,"0.25mm"),this.printCheckDigit=Qt({data:e.printCheckDigit,defaultValue:0,validate:t=>t===1}),this.rowColumnRatio=aC(e.rowColumnRatio),this.startChar=e.startChar||"",this.textLocation=Le(e.textLocation,["below","above","aboveEmbedded","belowEmbedded","none"]),this.truncate=Qt({data:e.truncate,defaultValue:0,validate:t=>t===1}),this.type=Le(e.type?e.type.toLowerCase():"",["aztec","codabar","code2of5industrial","code2of5interleaved","code2of5matrix","code2of5standard","code3of9","code3of9extended","code11","code49","code93","code128","code128a","code128b","code128c","code128sscc","datamatrix","ean8","ean8add2","ean8add5","ean13","ean13add2","ean13add5","ean13pwcd","fim","logmars","maxicode","msi","pdf417","pdf417macro","plessey","postauscust2","postauscust3","postausreplypaid","postausstandard","postukrm4scc","postusdpbc","postusimb","postusstandard","postus5zip","qrcode","rfid","rss14","rss14expanded","rss14limited","rss14stacked","rss14stackedomni","rss14truncated","telepen","ucc128","ucc128random","ucc128sscc","upca","upcaadd2","upcaadd5","upcapwcd","upce","upceadd2","upceadd5","upcean2","upcean5","upsmaxicode"]),this.upsMode=Le(e.upsMode,["usCarrier","internationalCarrier","secureSymbol","standardSymbol"]),this.use=e.use||"",this.usehref=e.usehref||"",this.wideNarrowRatio=aC(e.wideNarrowRatio),this.encrypt=null,this.extras=null}}class wV extends Ie{constructor(e){super(Je,"bind",!0),this.match=Le(e.match,["once","dataRef","global","none"]),this.ref=e.ref||"",this.picture=null}}class y6 extends Ie{constructor(e){super(Je,"bindItems"),this.connection=e.connection||"",this.labelRef=e.labelRef||"",this.ref=e.ref||"",this.valueRef=e.valueRef||""}}class _V extends Ie{constructor(e){super(Je,"bookend"),this.id=e.id||"",this.leader=e.leader||"",this.trailer=e.trailer||"",this.use=e.use||"",this.usehref=e.usehref||""}}class vV extends ks{constructor(e){super(Je,"boolean"),this.id=e.id||"",this.name=e.name||"",this.use=e.use||"",this.usehref=e.usehref||""}[Kt](e){return eu(this[De]===1?"1":"0")}}class JM extends Ie{constructor(e){super(Je,"border",!0),this.break=Le(e.break,["close","open"]),this.hand=Le(e.hand,["even","left","right"]),this.id=e.id||"",this.presence=Le(e.presence,["visible","hidden","inactive","invisible"]),this.relevant=pl(e.relevant),this.use=e.use||"",this.usehref=e.usehref||"",this.corner=new re(4),this.edge=new re(4),this.extras=null,this.fill=null,this.margin=null}[mr](){if(!this[_e]){const e=this.edge.children.slice();if(e.length<4){const s=e.at(-1)||new kx({});for(let r=e.length;r<4;r++)e.push(s)}const t=e.map(s=>s.thickness),i=[0,0,0,0];this.margin&&(i[0]=this.margin.topInset,i[1]=this.margin.rightInset,i[2]=this.margin.bottomInset,i[3]=this.margin.leftInset),this[_e]={widths:t,insets:i,edges:e}}return this[_e]}[Mn](){var s;const{edges:e}=this[mr](),t=e.map(r=>{const a=r[Mn]();return a.color||(a.color="#000000"),a}),i=Object.create(null);if(this.margin&&Object.assign(i,this.margin[Mn]()),((s=this.fill)==null?void 0:s.presence)==="visible"&&Object.assign(i,this.fill[Mn]()),this.corner.children.some(r=>r.radius!==0)){const r=this.corner.children.map(a=>a[Mn]());if(r.length===2||r.length===3){const a=r.at(-1);for(let o=r.length;o<4;o++)r.push(a)}i.borderRadius=r.map(a=>a.radius).join(" ")}switch(this.presence){case"invisible":case"hidden":i.borderStyle="";break;case"inactive":i.borderStyle="none";break;default:i.borderStyle=t.map(r=>r.style).join(" ");break}return i.borderWidth=t.map(r=>r.width).join(" "),i.borderColor=t.map(r=>r.color).join(" "),i}}class kV extends Ie{constructor(e){super(Je,"break",!0),this.after=Le(e.after,["auto","contentArea","pageArea","pageEven","pageOdd"]),this.afterTarget=e.afterTarget||"",this.before=Le(e.before,["auto","contentArea","pageArea","pageEven","pageOdd"]),this.beforeTarget=e.beforeTarget||"",this.bookendLeader=e.bookendLeader||"",this.bookendTrailer=e.bookendTrailer||"",this.id=e.id||"",this.overflowLeader=e.overflowLeader||"",this.overflowTarget=e.overflowTarget||"",this.overflowTrailer=e.overflowTrailer||"",this.startNew=Qt({data:e.startNew,defaultValue:0,validate:t=>t===1}),this.use=e.use||"",this.usehref=e.usehref||"",this.extras=null}}class ZM extends Ie{constructor(e){super(Je,"breakAfter",!0),this.id=e.id||"",this.leader=e.leader||"",this.startNew=Qt({data:e.startNew,defaultValue:0,validate:t=>t===1}),this.target=e.target||"",this.targetType=Le(e.targetType,["auto","contentArea","pageArea"]),this.trailer=e.trailer||"",this.use=e.use||"",this.usehref=e.usehref||"",this.script=null}}class QM extends Ie{constructor(e){super(Je,"breakBefore",!0),this.id=e.id||"",this.leader=e.leader||"",this.startNew=Qt({data:e.startNew,defaultValue:0,validate:t=>t===1}),this.target=e.target||"",this.targetType=Le(e.targetType,["auto","contentArea","pageArea"]),this.trailer=e.trailer||"",this.use=e.use||"",this.usehref=e.usehref||"",this.script=null}[Kt](e){return this[_e]={},Et.FAILURE}}class CV extends Ie{constructor(e){super(Je,"button",!0),this.highlight=Le(e.highlight,["inverted","none","outline","push"]),this.id=e.id||"",this.use=e.use||"",this.usehref=e.usehref||"",this.extras=null}[Kt](e){const i=this[en]()[en](),s={name:"button",attributes:{id:this[qn],class:["xfaButton"],style:{}},children:[]};for(const r of i.event.children){if(r.activity!=="click"||!r.script)continue;const a=_R(r.script[De]);if(!a)continue;const o=VM(a.url);o&&s.children.push({name:"a",attributes:{id:"link"+this[qn],href:o,newWindow:a.newWindow,class:["xfaLink"],style:{}},children:[]})}return Et.success(s)}}class AV extends Ie{constructor(e){super(Je,"calculate",!0),this.id=e.id||"",this.override=Le(e.override,["disabled","error","ignore","warning"]),this.use=e.use||"",this.usehref=e.usehref||"",this.extras=null,this.message=null,this.script=null}}class SV extends Ie{constructor(e){super(Je,"caption",!0),this.id=e.id||"",this.placement=Le(e.placement,["left","bottom","inline","right","top"]),this.presence=Le(e.presence,["visible","hidden","inactive","invisible"]),this.reserve=Math.ceil(ft(e.reserve)),this.use=e.use||"",this.usehref=e.usehref||"",this.extras=null,this.font=null,this.margin=null,this.para=null,this.value=null}[wa](e){Z4(this,e)}[mr](e){if(!this[_e]){let{width:t,height:i}=e;switch(this.placement){case"left":case"right":case"inline":t=this.reserve<=0?t:this.reserve;break;case"top":case"bottom":i=this.reserve<=0?i:this.reserve;break}this[_e]=X4(this,{width:t,height:i})}return this[_e]}[Kt](e){if(!this.value)return Et.EMPTY;this[nm]();const t=this.value[Kt](e).html;if(!t)return this[pa](),Et.EMPTY;const i=this.reserve;if(this.reserve<=0){const{w:a,h:o}=this[mr](e);switch(this.placement){case"left":case"right":case"inline":this.reserve=a;break;case"top":case"bottom":this.reserve=o;break}}const s=[];typeof t=="string"?s.push({name:"#text",value:t}):s.push(t);const r=ra(this,"font","margin","visibility");switch(this.placement){case"left":case"right":this.reserve>0&&(r.width=Zt(this.reserve));break;case"top":case"bottom":this.reserve>0&&(r.height=Zt(this.reserve));break}return jM(this,null,t),this[pa](),this.reserve=i,Et.success({name:"div",attributes:{style:r,class:["xfaCaption"]},children:s})}}class IV extends yn{constructor(e){super(Je,"certificate"),this.id=e.id||"",this.name=e.name||"",this.use=e.use||"",this.usehref=e.usehref||""}}class EV extends Ie{constructor(e){super(Je,"certificates",!0),this.credentialServerPolicy=Le(e.credentialServerPolicy,["optional","required"]),this.id=e.id||"",this.url=e.url||"",this.urlPolicy=e.urlPolicy||"",this.use=e.use||"",this.usehref=e.usehref||"",this.encryption=null,this.issuers=null,this.keyUsage=null,this.oids=null,this.signing=null,this.subjectDNs=null}}class $M extends Ie{constructor(e){super(Je,"checkButton",!0),this.id=e.id||"",this.mark=Le(e.mark,["default","check","circle","cross","diamond","square","star"]),this.shape=Le(e.shape,["square","round"]),this.size=ft(e.size,"10pt"),this.use=e.use||"",this.usehref=e.usehref||"",this.border=null,this.extras=null,this.margin=null}[Kt](e){var b,p,y;const t=ra(this,"margin"),i=Zt(this.size);t.width=t.height=i;let s,r,a;const o=this[en]()[en](),l=o.items.children.length&&o.items.children[0][Kt]().html||[],c={on:(l[0]!==void 0?l[0]:"on").toString(),off:(l[1]!==void 0?l[1]:"off").toString()},u=(((b=o.value)==null?void 0:b[_s]())||"off")===c.on||void 0,d=o[ns](),f=o[qn];let g;d instanceof iP?(a=d[qn],s="radio",r="xfaRadio",g=((p=d[vo])==null?void 0:p[qn])||d[qn]):(s="checkbox",r="xfaCheckbox",g=((y=o[vo])==null?void 0:y[qn])||o[qn]);const m={name:"input",attributes:{class:[r],style:t,fieldId:f,dataId:g,type:s,checked:u,xfaOn:c.on,xfaOff:c.off,"aria-label":sf(o),"aria-required":!1}};return a&&(m.attributes.name=a),vx(o)&&(m.attributes["aria-required"]=!0,m.attributes.required=!0),Et.success({name:"label",attributes:{class:["xfaLabel"]},children:[m]})}}class eP extends Ie{constructor(e){super(Je,"choiceList",!0),this.commitOn=Le(e.commitOn,["select","exit"]),this.id=e.id||"",this.open=Le(e.open,["userControl","always","multiSelect","onEntry"]),this.textEntry=Qt({data:e.textEntry,defaultValue:0,validate:t=>t===1}),this.use=e.use||"",this.usehref=e.usehref||"",this.border=null,this.extras=null,this.margin=null}[Kt](e){var c,h,u;const t=ra(this,"border","margin"),s=this[en]()[en](),a={fontSize:`calc(${((c=s.font)==null?void 0:c.size)||10}px * var(--total-scale-factor))`},o=[];if(s.items.children.length>0){const d=s.items;let f=0,g=0;d.children.length===2&&(f=d.children[0].save,g=1-f);const m=d.children[f][Kt]().html,b=d.children[g][Kt]().html;let p=!1;const y=((h=s.value)==null?void 0:h[_s]())||"";for(let w=0,_=m.length;w<_;w++){const v={name:"option",attributes:{value:b[w]||m[w],style:a},value:m[w]};b[w]===y&&(v.attributes.selected=p=!0),o.push(v)}p||o.splice(0,0,{name:"option",attributes:{hidden:!0,selected:!0},value:" "})}const l={class:["xfaSelect"],fieldId:s[qn],dataId:((u=s[vo])==null?void 0:u[qn])||s[qn],style:t,"aria-label":sf(s),"aria-required":!1};return vx(s)&&(l["aria-required"]=!0,l.required=!0),this.open==="multiSelect"&&(l.multiple=!0),Et.success({name:"label",attributes:{class:["xfaLabel"]},children:[{name:"select",children:o,attributes:l}]})}}class TV extends Ie{constructor(e){super(Je,"color",!0),this.cSpace=Le(e.cSpace,["SRGB"]),this.id=e.id||"",this.use=e.use||"",this.usehref=e.usehref||"",this.value=e.value?eV(e.value):"",this.extras=null}[i2](){return!1}[Mn](){return this.value?Ln.makeHexColor(this.value.r,this.value.g,this.value.b):null}}class RV extends Ie{constructor(e){super(Je,"comb"),this.id=e.id||"",this.numberOfCells=Qt({data:e.numberOfCells,defaultValue:0,validate:t=>t>=0}),this.use=e.use||"",this.usehref=e.usehref||""}}class MV extends Ie{constructor(e){super(Je,"connect",!0),this.connection=e.connection||"",this.id=e.id||"",this.ref=e.ref||"",this.usage=Le(e.usage,["exportAndImport","exportOnly","importOnly"]),this.use=e.use||"",this.usehref=e.usehref||"",this.picture=null}}class $4 extends Ie{constructor(e){super(Je,"contentArea",!0),this.h=ft(e.h),this.id=e.id||"",this.name=e.name||"",this.relevant=pl(e.relevant),this.use=e.use||"",this.usehref=e.usehref||"",this.w=ft(e.w),this.x=ft(e.x,"0pt"),this.y=ft(e.y,"0pt"),this.desc=null,this.extras=null}[Kt](e){const t=Zt(this.x),i=Zt(this.y),s={left:t,top:i,width:Zt(this.w),height:Zt(this.h)},r=["xfaContentarea"];return im(this)&&r.push("xfaPrintOnly"),Et.success({name:"div",children:[],attributes:{style:s,class:r,id:this[qn]}})}}class tP extends Ie{constructor(e){super(Je,"corner",!0),this.id=e.id||"",this.inverted=Qt({data:e.inverted,defaultValue:0,validate:t=>t===1}),this.join=Le(e.join,["square","round"]),this.presence=Le(e.presence,["visible","hidden","inactive","invisible"]),this.radius=ft(e.radius),this.stroke=Le(e.stroke,["solid","dashDot","dashDotDot","dashed","dotted","embossed","etched","lowered","raised"]),this.thickness=ft(e.thickness,"0.5pt"),this.use=e.use||"",this.usehref=e.usehref||"",this.color=null,this.extras=null}[Mn](){const e=ra(this,"visibility");return e.radius=Zt(this.join==="square"?0:this.radius),e}}class PV extends Gi{constructor(e){super(Je,"date"),this.id=e.id||"",this.name=e.name||"",this.use=e.use||"",this.usehref=e.usehref||""}[ni](){const e=this[De].trim();this[De]=e?new Date(e):null}[Kt](e){return eu(this[De]?this[De].toString():"")}}class NV extends Gi{constructor(e){super(Je,"dateTime"),this.id=e.id||"",this.name=e.name||"",this.use=e.use||"",this.usehref=e.usehref||""}[ni](){const e=this[De].trim();this[De]=e?new Date(e):null}[Kt](e){return eu(this[De]?this[De].toString():"")}}class OV extends Ie{constructor(e){super(Je,"dateTimeEdit",!0),this.hScrollPolicy=Le(e.hScrollPolicy,["auto","off","on"]),this.id=e.id||"",this.picker=Le(e.picker,["host","none"]),this.use=e.use||"",this.usehref=e.usehref||"",this.border=null,this.comb=null,this.extras=null,this.margin=null}[Kt](e){var r;const t=ra(this,"border","font","margin"),i=this[en]()[en](),s={name:"input",attributes:{type:"text",fieldId:i[qn],dataId:((r=i[vo])==null?void 0:r[qn])||i[qn],class:["xfaTextfield"],style:t,"aria-label":sf(i),"aria-required":!1}};return vx(i)&&(s.attributes["aria-required"]=!0,s.attributes.required=!0),Et.success({name:"label",attributes:{class:["xfaLabel"]},children:[s]})}}class DV extends Gi{constructor(e){super(Je,"decimal"),this.fracDigits=Qt({data:e.fracDigits,defaultValue:2,validate:t=>!0}),this.id=e.id||"",this.leadDigits=Qt({data:e.leadDigits,defaultValue:-1,validate:t=>!0}),this.name=e.name||"",this.use=e.use||"",this.usehref=e.usehref||""}[ni](){const e=parseFloat(this[De].trim());this[De]=isNaN(e)?null:e}[Kt](e){return eu(this[De]!==null?this[De].toString():"")}}class FV extends Ie{constructor(e){super(Je,"defaultUi",!0),this.id=e.id||"",this.use=e.use||"",this.usehref=e.usehref||"",this.extras=null}}class LV extends Ie{constructor(e){super(Je,"desc",!0),this.id=e.id||"",this.use=e.use||"",this.usehref=e.usehref||"",this.boolean=new re,this.date=new re,this.dateTime=new re,this.decimal=new re,this.exData=new re,this.float=new re,this.image=new re,this.integer=new re,this.text=new re,this.time=new re}}class BV extends Wn{constructor(e){super(Je,"digestMethod",["","SHA1","SHA256","SHA512","RIPEMD160"]),this.id=e.id||"",this.use=e.use||"",this.usehref=e.usehref||""}}class UV extends Ie{constructor(e){super(Je,"digestMethods",!0),this.id=e.id||"",this.type=Le(e.type,["optional","required"]),this.use=e.use||"",this.usehref=e.usehref||"",this.digestMethod=new re}}class nP extends Ie{constructor(e){super(Je,"draw",!0),this.anchorType=Le(e.anchorType,["topLeft","bottomCenter","bottomLeft","bottomRight","middleCenter","middleLeft","middleRight","topCenter","topRight"]),this.colSpan=Qt({data:e.colSpan,defaultValue:1,validate:t=>t>=1||t===-1}),this.h=e.h?ft(e.h):"",this.hAlign=Le(e.hAlign,["left","center","justify","justifyAll","radix","right"]),this.id=e.id||"",this.locale=e.locale||"",this.maxH=ft(e.maxH,"0pt"),this.maxW=ft(e.maxW,"0pt"),this.minH=ft(e.minH,"0pt"),this.minW=ft(e.minW,"0pt"),this.name=e.name||"",this.presence=Le(e.presence,["visible","hidden","inactive","invisible"]),this.relevant=pl(e.relevant),this.rotate=Qt({data:e.rotate,defaultValue:0,validate:t=>t%90===0}),this.use=e.use||"",this.usehref=e.usehref||"",this.w=e.w?ft(e.w):"",this.x=ft(e.x,"0pt"),this.y=ft(e.y,"0pt"),this.assist=null,this.border=null,this.caption=null,this.desc=null,this.extras=null,this.font=null,this.keep=null,this.margin=null,this.para=null,this.traversal=null,this.ui=null,this.value=null,this.setProperty=new re}[wa](e){Z4(this,e)}[Kt](e){if(xy(this),this.presence==="hidden"||this.presence==="inactive")return Et.EMPTY;py(this),this[nm]();const t=this.w,i=this.h,{w:s,h:r,isBroken:a}=X4(this,e);if(s&&this.w===""){if(a&&this[ns]()[S0]())return this[pa](),Et.FAILURE;this.w=s}if(r&&this.h===""&&(this.h=r),wy(this),!by(this,e))return this.w=t,this.h=i,this[pa](),Et.FAILURE;_y(this);const o=ra(this,"font","hAlign","dimensions","position","presence","rotate","anchorType","border","margin");LM(this,o),o.margin&&(o.padding=o.margin,delete o.margin);const l=["xfaDraw"];this.font&&l.push("xfaFont"),im(this)&&l.push("xfaPrintOnly");const c={style:o,id:this[qn],class:l};this.name&&(c.xfaName=this.name);const h={name:"div",attributes:c,children:[]};yy(this,c);const u=BM(this,h,e),d=this.value?this.value[Kt](e).html:null;return d===null?(this.w=t,this.h=i,this[pa](),Et.success(Xd(this,h),u)):(h.children.push(d),jM(this,o,d),this.w=t,this.h=i,this[pa](),Et.success(Xd(this,h),u))}}class kx extends Ie{constructor(e){super(Je,"edge",!0),this.cap=Le(e.cap,["square","butt","round"]),this.id=e.id||"",this.presence=Le(e.presence,["visible","hidden","inactive","invisible"]),this.stroke=Le(e.stroke,["solid","dashDot","dashDotDot","dashed","dotted","embossed","etched","lowered","raised"]),this.thickness=ft(e.thickness,"0.5pt"),this.use=e.use||"",this.usehref=e.usehref||"",this.color=null,this.extras=null}[Mn](){const e=ra(this,"visibility");if(Object.assign(e,{linecap:this.cap,width:Zt(this.thickness),color:this.color?this.color[Mn]():"#000000",style:""}),this.presence!=="visible")e.style="none";else switch(this.stroke){case"solid":e.style="solid";break;case"dashDot":e.style="dashed";break;case"dashDotDot":e.style="dashed";break;case"dashed":e.style="dashed";break;case"dotted":e.style="dotted";break;case"embossed":e.style="ridge";break;case"etched":e.style="groove";break;case"lowered":e.style="inset";break;case"raised":e.style="outset";break}return e}}class HV extends Wn{constructor(e){super(Je,"encoding",["adbe.x509.rsa_sha1","adbe.pkcs7.detached","adbe.pkcs7.sha1"]),this.id=e.id||"",this.use=e.use||"",this.usehref=e.usehref||""}}class zV extends Ie{constructor(e){super(Je,"encodings",!0),this.id=e.id||"",this.type=Le(e.type,["optional","required"]),this.use=e.use||"",this.usehref=e.usehref||"",this.encoding=new re}}class jV extends Ie{constructor(e){super(Je,"encrypt",!0),this.id=e.id||"",this.use=e.use||"",this.usehref=e.usehref||"",this.certificate=null}}class GV extends Ie{constructor(e){super(Je,"encryptData",!0),this.id=e.id||"",this.operation=Le(e.operation,["encrypt","decrypt"]),this.target=e.target||"",this.use=e.use||"",this.usehref=e.usehref||"",this.filter=null,this.manifest=null}}class VV extends Ie{constructor(e){super(Je,"encryption",!0),this.id=e.id||"",this.type=Le(e.type,["optional","required"]),this.use=e.use||"",this.usehref=e.usehref||"",this.certificate=new re}}class qV extends Wn{constructor(e){super(Je,"encryptionMethod",["","AES256-CBC","TRIPLEDES-CBC","AES128-CBC","AES192-CBC"]),this.id=e.id||"",this.use=e.use||"",this.usehref=e.usehref||""}}class WV extends Ie{constructor(e){super(Je,"encryptionMethods",!0),this.id=e.id||"",this.type=Le(e.type,["optional","required"]),this.use=e.use||"",this.usehref=e.usehref||"",this.encryptionMethod=new re}}let KV=class extends Ie{constructor(e){super(Je,"event",!0),this.activity=Le(e.activity,["click","change","docClose","docReady","enter","exit","full","indexChange","initialize","mouseDown","mouseEnter","mouseExit","mouseUp","postExecute","postOpen","postPrint","postSave","postSign","postSubmit","preExecute","preOpen","prePrint","preSave","preSign","preSubmit","ready","validationState"]),this.id=e.id||"",this.listen=Le(e.listen,["refOnly","refAndDescendents"]),this.name=e.name||"",this.ref=e.ref||"",this.use=e.use||"",this.usehref=e.usehref||"",this.extras=null,this.encryptData=null,this.execute=null,this.script=null,this.signData=null,this.submit=null}};class XV extends Gi{constructor(e){super(Je,"exData"),this.contentType=e.contentType||"",this.href=e.href||"",this.id=e.id||"",this.maxLength=Qt({data:e.maxLength,defaultValue:-1,validate:t=>t>=-1}),this.name=e.name||"",this.rid=e.rid||"",this.transferEncoding=Le(e.transferEncoding,["none","base64","package"]),this.use=e.use||"",this.usehref=e.usehref||""}[q4](){return this.contentType==="text/html"}[sc](e){return this.contentType==="text/html"&&e[es]===ss.xhtml.id?(this[De]=e,!0):this.contentType==="text/xml"?(this[De]=e,!0):!1}[Kt](e){return this.contentType!=="text/html"||!this[De]?Et.EMPTY:this[De][Kt](e)}}class YV extends Ie{constructor(e){super(Je,"exObject",!0),this.archive=e.archive||"",this.classId=e.classId||"",this.codeBase=e.codeBase||"",this.codeType=e.codeType||"",this.id=e.id||"",this.name=e.name||"",this.use=e.use||"",this.usehref=e.usehref||"",this.extras=null,this.boolean=new re,this.date=new re,this.dateTime=new re,this.decimal=new re,this.exData=new re,this.exObject=new re,this.float=new re,this.image=new re,this.integer=new re,this.text=new re,this.time=new re}}class iP extends Ie{constructor(e){super(Je,"exclGroup",!0),this.access=Le(e.access,["open","nonInteractive","protected","readOnly"]),this.accessKey=e.accessKey||"",this.anchorType=Le(e.anchorType,["topLeft","bottomCenter","bottomLeft","bottomRight","middleCenter","middleLeft","middleRight","topCenter","topRight"]),this.colSpan=Qt({data:e.colSpan,defaultValue:1,validate:t=>t>=1||t===-1}),this.h=e.h?ft(e.h):"",this.hAlign=Le(e.hAlign,["left","center","justify","justifyAll","radix","right"]),this.id=e.id||"",this.layout=Le(e.layout,["position","lr-tb","rl-row","rl-tb","row","table","tb"]),this.maxH=ft(e.maxH,"0pt"),this.maxW=ft(e.maxW,"0pt"),this.minH=ft(e.minH,"0pt"),this.minW=ft(e.minW,"0pt"),this.name=e.name||"",this.presence=Le(e.presence,["visible","hidden","inactive","invisible"]),this.relevant=pl(e.relevant),this.use=e.use||"",this.usehref=e.usehref||"",this.w=e.w?ft(e.w):"",this.x=ft(e.x,"0pt"),this.y=ft(e.y,"0pt"),this.assist=null,this.bind=null,this.border=null,this.calculate=null,this.caption=null,this.desc=null,this.extras=null,this.margin=null,this.para=null,this.traversal=null,this.validate=null,this.connect=new re,this.event=new re,this.field=new re,this.setProperty=new re}[pf](){return!0}[i2](){return!0}[wa](e){for(const t of this.field.children){if(!t.value){const i=new s_({});t[Ui](i),t.value=i}t.value[wa](e)}}[S0](){return this.layout.endsWith("-tb")&&this[_e].attempt===0&&this[_e].numberInLine>0||this[en]()[S0]()}[g0](){var t;const e=this[ns]();return e[g0]()?this[_e]._isSplittable!==void 0?this[_e]._isSplittable:this.layout==="position"||this.layout.includes("row")?(this[_e]._isSplittable=!1,!1):(t=e.layout)!=null&&t.endsWith("-tb")&&e[_e].numberInLine!==0?!1:(this[_e]._isSplittable=!0,!0):!1}[_x](){return WM(this)}[Wd](e,t){KM(this,e,t)}[Kd](){return XM(this)}[Kt](e){if(xy(this),this.presence==="hidden"||this.presence==="inactive"||this.h===0||this.w===0)return Et.EMPTY;py(this);const t=[],i={id:this[qn],class:[]};Y4(this,i.class),this[_e]||(this[_e]=Object.create(null)),Object.assign(this[_e],{children:t,attributes:i,attempt:0,line:null,numberInLine:0,availableSpace:{width:Math.min(this.w||1/0,e.width),height:Math.min(this.h||1/0,e.height)},width:0,height:0,prevHeight:0,currentWidth:0});const s=this[g0]();if(s||wy(this),!by(this,e))return Et.FAILURE;const r=new Set(["field"]);if(this.layout.includes("row")){const p=this[ns]().columnWidths;Array.isArray(p)&&p.length>0&&(this[_e].columnWidths=p,this[_e].currentColumn=0)}const a=ra(this,"anchorType","dimensions","position","presence","border","margin","hAlign"),o=["xfaExclgroup"],l=UM(this);l&&o.push(l),im(this)&&o.push("xfaPrintOnly"),i.style=a,i.class=o,this.name&&(i.xfaName=this.name),this[nm]();const c=this.layout==="lr-tb"||this.layout==="rl-tb",h=c?G3:1;for(;this[_e].attempt<h;this[_e].attempt++){c&&this[_e].attempt===G3-1&&(this[_e].numberInLine=0);const p=this[Kh]({filter:r,include:!0});if(p.success)break;if(p.isBreak())return this[pa](),p;if(c&&this[_e].attempt===0&&this[_e].numberInLine===0&&!this[$i]()[_e].noLayoutFailure){this[_e].attempt=h;break}}if(this[pa](),s||_y(this),this[_e].attempt===h)return s||delete this[_e],Et.FAILURE;let u=0,d=0;this.margin&&(u=this.margin.leftInset+this.margin.rightInset,d=this.margin.topInset+this.margin.bottomInset);const f=Math.max(this[_e].width+u,this.w||0),g=Math.max(this[_e].height+d,this.h||0),m=[this.x,this.y,f,g];this.w===""&&(a.width=Zt(f)),this.h===""&&(a.height=Zt(g));const b={name:"div",attributes:i,children:t};return yy(this,i),delete this[_e],Et.success(Xd(this,b),m)}}class JV extends Ie{constructor(e){super(Je,"execute"),this.connection=e.connection||"",this.executeType=Le(e.executeType,["import","remerge"]),this.id=e.id||"",this.runAt=Le(e.runAt,["client","both","server"]),this.use=e.use||"",this.usehref=e.usehref||""}}class ZV extends Ie{constructor(e){super(Je,"extras",!0),this.id=e.id||"",this.name=e.name||"",this.use=e.use||"",this.usehref=e.usehref||"",this.boolean=new re,this.date=new re,this.dateTime=new re,this.decimal=new re,this.exData=new re,this.extras=new re,this.float=new re,this.image=new re,this.integer=new re,this.text=new re,this.time=new re}}class e_ extends Ie{constructor(e){super(Je,"field",!0),this.access=Le(e.access,["open","nonInteractive","protected","readOnly"]),this.accessKey=e.accessKey||"",this.anchorType=Le(e.anchorType,["topLeft","bottomCenter","bottomLeft","bottomRight","middleCenter","middleLeft","middleRight","topCenter","topRight"]),this.colSpan=Qt({data:e.colSpan,defaultValue:1,validate:t=>t>=1||t===-1}),this.h=e.h?ft(e.h):"",this.hAlign=Le(e.hAlign,["left","center","justify","justifyAll","radix","right"]),this.id=e.id||"",this.locale=e.locale||"",this.maxH=ft(e.maxH,"0pt"),this.maxW=ft(e.maxW,"0pt"),this.minH=ft(e.minH,"0pt"),this.minW=ft(e.minW,"0pt"),this.name=e.name||"",this.presence=Le(e.presence,["visible","hidden","inactive","invisible"]),this.relevant=pl(e.relevant),this.rotate=Qt({data:e.rotate,defaultValue:0,validate:t=>t%90===0}),this.use=e.use||"",this.usehref=e.usehref||"",this.w=e.w?ft(e.w):"",this.x=ft(e.x,"0pt"),this.y=ft(e.y,"0pt"),this.assist=null,this.bind=null,this.border=null,this.calculate=null,this.caption=null,this.desc=null,this.extras=null,this.font=null,this.format=null,this.items=new re(2),this.keep=null,this.margin=null,this.para=null,this.traversal=null,this.ui=null,this.validate=null,this.value=null,this.bindItems=new re,this.connect=new re,this.event=new re,this.setProperty=new re}[pf](){return!0}[wa](e){Z4(this,e)}[Kt](e){var p,y,w,_,v;if(xy(this),!this.ui){this.ui=new i_({}),this.ui[ti]=this[ti],this[Ui](this.ui);let C;switch(this.items.children.length){case 0:C=new cP({}),this.ui.textEdit=C;break;case 1:C=new $M({}),this.ui.checkButton=C;break;case 2:C=new eP({}),this.ui.choiceList=C;break}this.ui[Ui](C)}if(!this.ui||this.presence==="hidden"||this.presence==="inactive"||this.h===0||this.w===0)return Et.EMPTY;this.caption&&delete this.caption[_e],this[nm]();const t=this.caption?this.caption[Kt](e).html:null,i=this.w,s=this.h;let r=0,a=0;this.margin&&(r=this.margin.leftInset+this.margin.rightInset,a=this.margin.topInset+this.margin.bottomInset);let o=null;if(this.w===""||this.h===""){let C=null,k=null,I=0,E=0;if(this.ui.checkButton)I=E=this.ui.checkButton.size;else{const{w:T,h:M}=X4(this,e);T!==null?(I=T,E=M):E=iV(this.font,!0).lineNoGap}if(o=gC(this.ui[mr]()),I+=o.w,E+=o.h,this.caption){const{w:T,h:M,isBroken:D}=this.caption[mr](e);if(D&&this[ns]()[S0]())return this[pa](),Et.FAILURE;switch(C=T,k=M,this.caption.placement){case"left":case"right":case"inline":C+=I;break;case"top":case"bottom":k+=E;break}}else C=I,k=E;C&&this.w===""&&(C+=r,this.w=Math.min(this.maxW<=0?1/0:this.maxW,this.minW+1<C?C:this.minW)),k&&this.h===""&&(k+=a,this.h=Math.min(this.maxH<=0?1/0:this.maxH,this.minH+1<k?k:this.minH))}if(this[pa](),py(this),wy(this),!by(this,e))return this.w=i,this.h=s,this[pa](),Et.FAILURE;_y(this);const l=ra(this,"font","dimensions","position","rotate","anchorType","presence","margin","hAlign");LM(this,l);const c=["xfaField"];this.font&&c.push("xfaFont"),im(this)&&c.push("xfaPrintOnly");const h={style:l,id:this[qn],class:c};l.margin&&(l.padding=l.margin,delete l.margin),Y4(this,c),this.name&&(h.xfaName=this.name);const u=[],d={name:"div",attributes:h,children:u};yy(this,h);const f=this.border?this.border[Mn]():null,g=BM(this,d,e),m=this.ui[Kt]().html;if(!m)return Object.assign(l,f),Et.success(Xd(this,d),g);this[Jo]&&((p=m.children)!=null&&p[0]?m.children[0].attributes.tabindex=this[Jo]:m.attributes.tabindex=this[Jo]),(y=m.attributes).style||(y.style=Object.create(null));let b=null;if(this.ui.button?(m.children.length===1&&([b]=m.children.splice(0,1)),Object.assign(m.attributes.style,f)):Object.assign(l,f),u.push(m),this.value){if(this.ui.imageEdit)m.children.push(this.value[Kt]().html);else if(!this.ui.button){let C="";if(this.value.exData)C=this.value.exData[_s]();else if(this.value.text)C=this.value.text[mr]();else{const k=this.value[Kt]().html;k!==null&&(C=k.children[0].value)}this.ui.textEdit&&((w=this.value.text)!=null&&w.maxChars)&&(m.children[0].attributes.maxLength=this.value.text.maxChars),C&&(this.ui.numericEdit&&(C=parseFloat(C),C=isNaN(C)?"":C.toString()),m.children[0].name==="textarea"?m.children[0].attributes.textContent=C:m.children[0].attributes.value=C)}}if(!this.ui.imageEdit&&((_=m.children)!=null&&_[0])&&this.h){o=o||gC(this.ui[mr]());let C=0;if(this.caption&&["top","bottom"].includes(this.caption.placement)){C=this.caption.reserve,C<=0&&(C=this.caption[mr](e).h);const k=this.h-C-a-o.h;m.children[0].attributes.style.height=Zt(k)}else m.children[0].attributes.style.height="100%"}if(b&&m.children.push(b),!t)return m.attributes.class&&m.attributes.class.push("xfaLeft"),this.w=i,this.h=s,Et.success(Xd(this,d),g);if(this.ui.button)return l.padding&&delete l.padding,t.name==="div"&&(t.name="span"),m.children.push(t),Et.success(d,g);switch(this.ui.checkButton&&(t.attributes.class[0]="xfaCaptionForCheckButton"),(v=m.attributes).class||(v.class=[]),m.children.splice(0,0,t),this.caption.placement){case"left":m.attributes.class.push("xfaLeft");break;case"right":m.attributes.class.push("xfaRight");break;case"top":m.attributes.class.push("xfaTop");break;case"bottom":m.attributes.class.push("xfaBottom");break;case"inline":m.attributes.class.push("xfaLeft");break}return this.w=i,this.h=s,Et.success(Xd(this,d),g)}}class QV extends Ie{constructor(e){super(Je,"fill",!0),this.id=e.id||"",this.presence=Le(e.presence,["visible","hidden","inactive","invisible"]),this.use=e.use||"",this.usehref=e.usehref||"",this.color=null,this.extras=null,this.linear=null,this.pattern=null,this.radial=null,this.solid=null,this.stipple=null}[Mn](){var o;const e=this[en](),i=e[en]()[en](),s=Object.create(null);let r="color",a=r;e instanceof JM&&(r="background-color",a="background",i instanceof i_&&(s.backgroundColor="white")),(e instanceof aP||e instanceof YM)&&(r=a="fill",s.fill="white");for(const l of Object.getOwnPropertyNames(this)){if(l==="extras"||l==="color")continue;const c=this[l];if(!(c instanceof Ie))continue;const h=c[Mn](this.color);return h&&(s[h.startsWith("#")?r:a]=h),s}if((o=this.color)!=null&&o.value){const l=this.color[Mn]();s[l.startsWith("#")?r:a]=l}return s}}class $V extends Ie{constructor(e){super(Je,"filter",!0),this.addRevocationInfo=Le(e.addRevocationInfo,["","required","optional","none"]),this.id=e.id||"",this.name=e.name||"",this.use=e.use||"",this.usehref=e.usehref||"",this.version=Qt({data:this.version,defaultValue:5,validate:t=>t>=1&&t<=5}),this.appearanceFilter=null,this.certificates=null,this.digestMethods=null,this.encodings=null,this.encryptionMethods=null,this.handler=null,this.lockDocument=null,this.mdp=null,this.reasons=null,this.timeStamp=null}}class eq extends Gi{constructor(e){super(Je,"float"),this.id=e.id||"",this.name=e.name||"",this.use=e.use||"",this.usehref=e.usehref||""}[ni](){const e=parseFloat(this[De].trim());this[De]=isNaN(e)?null:e}[Kt](e){return eu(this[De]!==null?this[De].toString():"")}}class tq extends Ie{constructor(e){super(Je,"font",!0),this.baselineShift=ft(e.baselineShift),this.fontHorizontalScale=j3({data:e.fontHorizontalScale,defaultValue:100,validate:t=>t>=0}),this.fontVerticalScale=j3({data:e.fontVerticalScale,defaultValue:100,validate:t=>t>=0}),this.id=e.id||"",this.kerningMode=Le(e.kerningMode,["none","pair"]),this.letterSpacing=ft(e.letterSpacing,"0"),this.lineThrough=Qt({data:e.lineThrough,defaultValue:0,validate:t=>t===1||t===2}),this.lineThroughPeriod=Le(e.lineThroughPeriod,["all","word"]),this.overline=Qt({data:e.overline,defaultValue:0,validate:t=>t===1||t===2}),this.overlinePeriod=Le(e.overlinePeriod,["all","word"]),this.posture=Le(e.posture,["normal","italic"]),this.size=ft(e.size,"10pt"),this.typeface=e.typeface||"Courier",this.underline=Qt({data:e.underline,defaultValue:0,validate:t=>t===1||t===2}),this.underlinePeriod=Le(e.underlinePeriod,["all","word"]),this.use=e.use||"",this.usehref=e.usehref||"",this.weight=Le(e.weight,["normal","bold"]),this.extras=null,this.fill=null}[Io](e){super[Io](e),this[ti].usedTypefaces.add(this.typeface)}[Mn](){const e=ra(this,"fill"),t=e.color;return t&&(t==="#000000"?delete e.color:t.startsWith("#")||(e.background=t,e.backgroundClip="text",e.color="transparent")),this.baselineShift&&(e.verticalAlign=Zt(this.baselineShift)),e.fontKerning=this.kerningMode==="none"?"none":"normal",e.letterSpacing=Zt(this.letterSpacing),this.lineThrough!==0&&(e.textDecoration="line-through",this.lineThrough===2&&(e.textDecorationStyle="double")),this.overline!==0&&(e.textDecoration="overline",this.overline===2&&(e.textDecorationStyle="double")),e.fontStyle=this.posture,e.fontSize=Zt(.99*this.size),GM(this,this,this[ti].fontFinder,e),this.underline!==0&&(e.textDecoration="underline",this.underline===2&&(e.textDecorationStyle="double")),e.fontWeight=this.weight,e}}class nq extends Ie{constructor(e){super(Je,"format",!0),this.id=e.id||"",this.use=e.use||"",this.usehref=e.usehref||"",this.extras=null,this.picture=null}}class iq extends yn{constructor(e){super(Je,"handler"),this.id=e.id||"",this.type=Le(e.type,["optional","required"]),this.use=e.use||"",this.usehref=e.usehref||""}}class sq extends Ie{constructor(e){super(Je,"hyphenation"),this.excludeAllCaps=Qt({data:e.excludeAllCaps,defaultValue:0,validate:t=>t===1}),this.excludeInitialCap=Qt({data:e.excludeInitialCap,defaultValue:0,validate:t=>t===1}),this.hyphenate=Qt({data:e.hyphenate,defaultValue:0,validate:t=>t===1}),this.id=e.id||"",this.pushCharacterCount=Qt({data:e.pushCharacterCount,defaultValue:3,validate:t=>t>=0}),this.remainCharacterCount=Qt({data:e.remainCharacterCount,defaultValue:3,validate:t=>t>=0}),this.use=e.use||"",this.usehref=e.usehref||"",this.wordCharacterCount=Qt({data:e.wordCharacterCount,defaultValue:7,validate:t=>t>=0})}}let sP=class extends yn{constructor(e){super(Je,"image"),this.aspect=Le(e.aspect,["fit","actual","height","none","width"]),this.contentType=e.contentType||"",this.href=e.href||"",this.id=e.id||"",this.name=e.name||"",this.transferEncoding=Le(e.transferEncoding,["base64","none","package"]),this.use=e.use||"",this.usehref=e.usehref||""}[Kt](){var r;if(this.contentType&&!gV.has(this.contentType.toLowerCase()))return Et.EMPTY;let e=(r=this[ti].images)==null?void 0:r.get(this.href);if(!e&&(this.href||!this[De])||(!e&&this.transferEncoding==="base64"&&(e=PU(this[De])),!e))return Et.EMPTY;if(!this.contentType){for(const[a,o]of mV)if(e.length>a.length&&a.every((l,c)=>l===e[c])){this.contentType=o;break}if(!this.contentType)return Et.EMPTY}const t=new Blob([e],{type:this.contentType});let i;switch(this.aspect){case"fit":case"actual":break;case"height":i={height:"100%",objectFit:"fill"};break;case"none":i={width:"100%",height:"100%",objectFit:"fill"};break;case"width":i={width:"100%",objectFit:"fill"};break}const s=this[en]();return Et.success({name:"img",attributes:{class:["xfaImage"],style:i,src:URL.createObjectURL(t),alt:s?sf(s[en]()):null}})}};class rq extends Ie{constructor(e){super(Je,"imageEdit",!0),this.data=Le(e.data,["link","embed"]),this.id=e.id||"",this.use=e.use||"",this.usehref=e.usehref||"",this.border=null,this.extras=null,this.margin=null}[Kt](e){return this.data==="embed"?Et.success({name:"div",children:[],attributes:{}}):Et.EMPTY}}class aq extends Gi{constructor(e){super(Je,"integer"),this.id=e.id||"",this.name=e.name||"",this.use=e.use||"",this.usehref=e.usehref||""}[ni](){const e=parseInt(this[De].trim(),10);this[De]=isNaN(e)?null:e}[Kt](e){return eu(this[De]!==null?this[De].toString():"")}}class oq extends Ie{constructor(e){super(Je,"issuers",!0),this.id=e.id||"",this.type=Le(e.type,["optional","required"]),this.use=e.use||"",this.usehref=e.usehref||"",this.certificate=new re}}class w6 extends Ie{constructor(e){super(Je,"items",!0),this.id=e.id||"",this.name=e.name||"",this.presence=Le(e.presence,["visible","hidden","inactive","invisible"]),this.ref=e.ref||"",this.save=Qt({data:e.save,defaultValue:0,validate:t=>t===1}),this.use=e.use||"",this.usehref=e.usehref||"",this.boolean=new re,this.date=new re,this.dateTime=new re,this.decimal=new re,this.exData=new re,this.float=new re,this.image=new re,this.integer=new re,this.text=new re,this.time=new re}[Kt](){const e=[];for(const t of this[Ks]())e.push(t[_s]());return Et.success(e)}}class lq extends Ie{constructor(e){super(Je,"keep",!0),this.id=e.id||"";const t=["none","contentArea","pageArea"];this.intact=Le(e.intact,t),this.next=Le(e.next,t),this.previous=Le(e.previous,t),this.use=e.use||"",this.usehref=e.usehref||"",this.extras=null}}class cq extends Ie{constructor(e){super(Je,"keyUsage");const t=["","yes","no"];this.crlSign=Le(e.crlSign,t),this.dataEncipherment=Le(e.dataEncipherment,t),this.decipherOnly=Le(e.decipherOnly,t),this.digitalSignature=Le(e.digitalSignature,t),this.encipherOnly=Le(e.encipherOnly,t),this.id=e.id||"",this.keyAgreement=Le(e.keyAgreement,t),this.keyCertSign=Le(e.keyCertSign,t),this.keyEncipherment=Le(e.keyEncipherment,t),this.nonRepudiation=Le(e.nonRepudiation,t),this.type=Le(e.type,["optional","required"]),this.use=e.use||"",this.usehref=e.usehref||""}}class hq extends Ie{constructor(e){super(Je,"line",!0),this.hand=Le(e.hand,["even","left","right"]),this.id=e.id||"",this.slope=Le(e.slope,["\\","/"]),this.use=e.use||"",this.usehref=e.usehref||"",this.edge=null}[Kt](){const e=this[en]()[en](),t=this.edge||new kx({}),i=t[Mn](),s=Object.create(null),r=t.presence==="visible"?t.thickness:0;s.strokeWidth=Zt(r),s.stroke=i.color;let a,o,l,c,h="100%",u="100%";e.w<=r?([a,o,l,c]=["50%",0,"50%","100%"],h=s.strokeWidth):e.h<=r?([a,o,l,c]=[0,"50%","100%","50%"],u=s.strokeWidth):this.slope==="\\"?[a,o,l,c]=[0,0,"100%","100%"]:[a,o,l,c]=[0,"100%","100%",0];const f={name:"svg",children:[{name:"line",attributes:{xmlns:Yd,x1:a,y1:o,x2:l,y2:c,style:s}}],attributes:{xmlns:Yd,width:h,height:u,style:{overflow:"visible"}}};return J4(e)?Et.success({name:"div",attributes:{style:{display:"inline",width:"100%",height:"100%"}},children:[f]}):(f.attributes.style.position="absolute",Et.success(f))}}class uq extends Ie{constructor(e){super(Je,"linear",!0),this.id=e.id||"",this.type=Le(e.type,["toRight","toBottom","toLeft","toTop"]),this.use=e.use||"",this.usehref=e.usehref||"",this.color=null,this.extras=null}[Mn](e){e=e?e[Mn]():"#FFFFFF";const t=this.type.replace(/([RBLT])/," $1").toLowerCase(),i=this.color?this.color[Mn]():"#000000";return`linear-gradient(${t}, ${e}, ${i})`}}class dq extends Gi{constructor(e){super(Je,"lockDocument"),this.id=e.id||"",this.type=Le(e.type,["optional","required"]),this.use=e.use||"",this.usehref=e.usehref||""}[ni](){this[De]=Le(this[De],["auto","0","1"])}}class fq extends Ie{constructor(e){super(Je,"manifest",!0),this.action=Le(e.action,["include","all","exclude"]),this.id=e.id||"",this.name=e.name||"",this.use=e.use||"",this.usehref=e.usehref||"",this.extras=null,this.ref=new re}}class gq extends Ie{constructor(e){super(Je,"margin",!0),this.bottomInset=ft(e.bottomInset,"0"),this.id=e.id||"",this.leftInset=ft(e.leftInset,"0"),this.rightInset=ft(e.rightInset,"0"),this.topInset=ft(e.topInset,"0"),this.use=e.use||"",this.usehref=e.usehref||"",this.extras=null}[Mn](){return{margin:Zt(this.topInset)+" "+Zt(this.rightInset)+" "+Zt(this.bottomInset)+" "+Zt(this.leftInset)}}}class mq extends Ie{constructor(e){super(Je,"mdp"),this.id=e.id||"",this.permissions=Qt({data:e.permissions,defaultValue:2,validate:t=>t===1||t===3}),this.signatureType=Le(e.signatureType,["filler","author"]),this.use=e.use||"",this.usehref=e.usehref||""}}class pq extends Ie{constructor(e){super(Je,"medium"),this.id=e.id||"",this.imagingBBox=tV(e.imagingBBox),this.long=ft(e.long),this.orientation=Le(e.orientation,["portrait","landscape"]),this.short=ft(e.short),this.stock=e.stock||"",this.trayIn=Le(e.trayIn,["auto","delegate","pageFront"]),this.trayOut=Le(e.trayOut,["auto","delegate"]),this.use=e.use||"",this.usehref=e.usehref||""}}class bq extends Ie{constructor(e){super(Je,"message",!0),this.id=e.id||"",this.use=e.use||"",this.usehref=e.usehref||"",this.text=new re}}class xq extends Ie{constructor(e){super(Je,"numericEdit",!0),this.hScrollPolicy=Le(e.hScrollPolicy,["auto","off","on"]),this.id=e.id||"",this.use=e.use||"",this.usehref=e.usehref||"",this.border=null,this.comb=null,this.extras=null,this.margin=null}[Kt](e){var r;const t=ra(this,"border","font","margin"),i=this[en]()[en](),s={name:"input",attributes:{type:"text",fieldId:i[qn],dataId:((r=i[vo])==null?void 0:r[qn])||i[qn],class:["xfaTextfield"],style:t,"aria-label":sf(i),"aria-required":!1}};return vx(i)&&(s.attributes["aria-required"]=!0,s.attributes.required=!0),Et.success({name:"label",attributes:{class:["xfaLabel"]},children:[s]})}}class yq extends Ie{constructor(e){super(Je,"occur",!0),this.id=e.id||"",this.initial=e.initial!==""?Qt({data:e.initial,defaultValue:"",validate:t=>!0}):"",this.max=e.max!==""?Qt({data:e.max,defaultValue:1,validate:t=>!0}):"",this.min=e.min!==""?Qt({data:e.min,defaultValue:1,validate:t=>!0}):"",this.use=e.use||"",this.usehref=e.usehref||"",this.extras=null}[Io](){const e=this[en](),t=this.min;this.min===""&&(this.min=e instanceof zg||e instanceof a2?0:1),this.max===""&&(t===""?this.max=e instanceof zg||e instanceof a2?-1:1:this.max=this.min),this.max!==-1&&this.max<this.min&&(this.max=this.min),this.initial===""&&(this.initial=e instanceof n_?1:this.min)}}class wq extends yn{constructor(e){super(Je,"oid"),this.id=e.id||"",this.name=e.name||"",this.use=e.use||"",this.usehref=e.usehref||""}}class _q extends Ie{constructor(e){super(Je,"oids",!0),this.id=e.id||"",this.type=Le(e.type,["optional","required"]),this.use=e.use||"",this.usehref=e.usehref||"",this.oid=new re}}class rP extends Ie{constructor(e){super(Je,"overflow"),this.id=e.id||"",this.leader=e.leader||"",this.target=e.target||"",this.trailer=e.trailer||"",this.use=e.use||"",this.usehref=e.usehref||""}[mr](){if(!this[_e]){const e=this[en](),t=this[$i](),i=t[l0](this.target,e),s=t[l0](this.leader,e),r=t[l0](this.trailer,e);this[_e]={target:(i==null?void 0:i[0])||null,leader:(s==null?void 0:s[0])||null,trailer:(r==null?void 0:r[0])||null,addLeader:!1,addTrailer:!1}}return this[_e]}}class zg extends Ie{constructor(e){super(Je,"pageArea",!0),this.blankOrNotBlank=Le(e.blankOrNotBlank,["any","blank","notBlank"]),this.id=e.id||"",this.initialNumber=Qt({data:e.initialNumber,defaultValue:1,validate:t=>!0}),this.name=e.name||"",this.numbered=Qt({data:e.numbered,defaultValue:1,validate:t=>!0}),this.oddOrEven=Le(e.oddOrEven,["any","even","odd"]),this.pagePosition=Le(e.pagePosition,["any","first","last","only","rest"]),this.relevant=pl(e.relevant),this.use=e.use||"",this.usehref=e.usehref||"",this.desc=null,this.extras=null,this.medium=null,this.occur=null,this.area=new re,this.contentArea=new re,this.draw=new re,this.exclGroup=new re,this.field=new re,this.subform=new re}[r2](){return this[_e]?!this.occur||this.occur.max===-1||this[_e].numberOfUse<this.occur.max:(this[_e]={numberOfUse:0},!0)}[Gf](){delete this[_e]}[Ic](){this[_e]||(this[_e]={numberOfUse:0});const e=this[en]();return e.relation==="orderedOccurrence"&&this[r2]()?(this[_e].numberOfUse+=1,this):e[Ic]()}[Kd](){return this[_e].space||{width:0,height:0}}[Kt](){this[_e]||(this[_e]={numberOfUse:1});const e=[];this[_e].children=e;const t=Object.create(null);if(this.medium&&this.medium.short&&this.medium.long){if(t.width=Zt(this.medium.short),t.height=Zt(this.medium.long),this[_e].space={width:this.medium.short,height:this.medium.long},this.medium.orientation==="landscape"){const i=t.width;t.width=t.height,t.height=i,this[_e].space={width:this.medium.long,height:this.medium.short}}}else ae("XFA - No medium specified in pageArea: please file a bug.");return this[Kh]({filter:new Set(["area","draw","field","subform"]),include:!0}),this[Kh]({filter:new Set(["contentArea"]),include:!0}),Et.success({name:"div",children:e,attributes:{class:["xfaPage"],id:this[qn],style:t,xfaName:this.name}})}}class a2 extends Ie{constructor(e){super(Je,"pageSet",!0),this.duplexImposition=Le(e.duplexImposition,["longEdge","shortEdge"]),this.id=e.id||"",this.name=e.name||"",this.relation=Le(e.relation,["orderedOccurrence","duplexPaginated","simplexPaginated"]),this.relevant=pl(e.relevant),this.use=e.use||"",this.usehref=e.usehref||"",this.extras=null,this.occur=null,this.pageArea=new re,this.pageSet=new re}[Gf](){for(const e of this.pageArea.children)e[Gf]();for(const e of this.pageSet.children)e[Gf]()}[r2](){return!this.occur||this.occur.max===-1||this[_e].numberOfUse<this.occur.max}[Ic](){if(this[_e]||(this[_e]={numberOfUse:1,pageIndex:-1,pageSetIndex:-1}),this.relation==="orderedOccurrence"){if(this[_e].pageIndex+1<this.pageArea.children.length)return this[_e].pageIndex+=1,this.pageArea.children[this[_e].pageIndex][Ic]();if(this[_e].pageSetIndex+1<this.pageSet.children.length)return this[_e].pageSetIndex+=1,this.pageSet.children[this[_e].pageSetIndex][Ic]();if(this[r2]())return this[_e].numberOfUse+=1,this[_e].pageIndex=-1,this[_e].pageSetIndex=-1,this[Ic]();const r=this[en]();return r instanceof a2?r[Ic]():(this[Gf](),this[Ic]())}const e=this[$i]()[_e].pageNumber,t=e%2===0?"even":"odd",i=e===0?"first":"rest";let s=this.pageArea.children.find(r=>r.oddOrEven===t&&r.pagePosition===i);return s||(s=this.pageArea.children.find(r=>r.oddOrEven==="any"&&r.pagePosition===i),s)||(s=this.pageArea.children.find(r=>r.oddOrEven==="any"&&r.pagePosition==="any"),s)?s:this.pageArea.children[0]}}class vq extends Ie{constructor(e){super(Je,"para",!0),this.hAlign=Le(e.hAlign,["left","center","justify","justifyAll","radix","right"]),this.id=e.id||"",this.lineHeight=e.lineHeight?ft(e.lineHeight,"0pt"):"",this.marginLeft=e.marginLeft?ft(e.marginLeft,"0pt"):"",this.marginRight=e.marginRight?ft(e.marginRight,"0pt"):"",this.orphans=Qt({data:e.orphans,defaultValue:0,validate:t=>t>=0}),this.preserve=e.preserve||"",this.radixOffset=e.radixOffset?ft(e.radixOffset,"0pt"):"",this.spaceAbove=e.spaceAbove?ft(e.spaceAbove,"0pt"):"",this.spaceBelow=e.spaceBelow?ft(e.spaceBelow,"0pt"):"",this.tabDefault=e.tabDefault?ft(this.tabDefault):"",this.tabStops=(e.tabStops||"").trim().split(/\s+/).map((t,i)=>i%2===1?ft(t):t),this.textIndent=e.textIndent?ft(e.textIndent,"0pt"):"",this.use=e.use||"",this.usehref=e.usehref||"",this.vAlign=Le(e.vAlign,["top","bottom","middle"]),this.widows=Qt({data:e.widows,defaultValue:0,validate:t=>t>=0}),this.hyphenation=null}[Mn](){const e=ra(this,"hAlign");return this.marginLeft!==""&&(e.paddingLeft=Zt(this.marginLeft)),this.marginRight!==""&&(e.paddingRight=Zt(this.marginRight)),this.spaceAbove!==""&&(e.paddingTop=Zt(this.spaceAbove)),this.spaceBelow!==""&&(e.paddingBottom=Zt(this.spaceBelow)),this.textIndent!==""&&(e.textIndent=Zt(this.textIndent),HM(e)),this.lineHeight>0&&(e.lineHeight=Zt(this.lineHeight)),this.tabDefault!==""&&(e.tabSize=Zt(this.tabDefault)),this.tabStops.length>0,this.hyphenatation&&Object.assign(e,this.hyphenatation[Mn]()),e}}class kq extends Ie{constructor(e){super(Je,"passwordEdit",!0),this.hScrollPolicy=Le(e.hScrollPolicy,["auto","off","on"]),this.id=e.id||"",this.passwordChar=e.passwordChar||"*",this.use=e.use||"",this.usehref=e.usehref||"",this.border=null,this.extras=null,this.margin=null}}class Cq extends Ie{constructor(e){super(Je,"pattern",!0),this.id=e.id||"",this.type=Le(e.type,["crossHatch","crossDiagonal","diagonalLeft","diagonalRight","horizontal","vertical"]),this.use=e.use||"",this.usehref=e.usehref||"",this.color=null,this.extras=null}[Mn](e){e=e?e[Mn]():"#FFFFFF";const t=this.color?this.color[Mn]():"#000000",i=5,s="repeating-linear-gradient",r=`${e},${e} ${i}px,${t} ${i}px,${t} ${2*i}px`;switch(this.type){case"crossHatch":return`${s}(to top,${r}) ${s}(to right,${r})`;case"crossDiagonal":return`${s}(45deg,${r}) ${s}(-45deg,${r})`;case"diagonalLeft":return`${s}(45deg,${r})`;case"diagonalRight":return`${s}(-45deg,${r})`;case"horizontal":return`${s}(to top,${r})`;case"vertical":return`${s}(to right,${r})`}return""}}class Aq extends yn{constructor(e){super(Je,"picture"),this.id=e.id||"",this.use=e.use||"",this.usehref=e.usehref||""}}class Sq extends Ie{constructor(e){super(Je,"proto",!0),this.appearanceFilter=new re,this.arc=new re,this.area=new re,this.assist=new re,this.barcode=new re,this.bindItems=new re,this.bookend=new re,this.boolean=new re,this.border=new re,this.break=new re,this.breakAfter=new re,this.breakBefore=new re,this.button=new re,this.calculate=new re,this.caption=new re,this.certificate=new re,this.certificates=new re,this.checkButton=new re,this.choiceList=new re,this.color=new re,this.comb=new re,this.connect=new re,this.contentArea=new re,this.corner=new re,this.date=new re,this.dateTime=new re,this.dateTimeEdit=new re,this.decimal=new re,this.defaultUi=new re,this.desc=new re,this.digestMethod=new re,this.digestMethods=new re,this.draw=new re,this.edge=new re,this.encoding=new re,this.encodings=new re,this.encrypt=new re,this.encryptData=new re,this.encryption=new re,this.encryptionMethod=new re,this.encryptionMethods=new re,this.event=new re,this.exData=new re,this.exObject=new re,this.exclGroup=new re,this.execute=new re,this.extras=new re,this.field=new re,this.fill=new re,this.filter=new re,this.float=new re,this.font=new re,this.format=new re,this.handler=new re,this.hyphenation=new re,this.image=new re,this.imageEdit=new re,this.integer=new re,this.issuers=new re,this.items=new re,this.keep=new re,this.keyUsage=new re,this.line=new re,this.linear=new re,this.lockDocument=new re,this.manifest=new re,this.margin=new re,this.mdp=new re,this.medium=new re,this.message=new re,this.numericEdit=new re,this.occur=new re,this.oid=new re,this.oids=new re,this.overflow=new re,this.pageArea=new re,this.pageSet=new re,this.para=new re,this.passwordEdit=new re,this.pattern=new re,this.picture=new re,this.radial=new re,this.reason=new re,this.reasons=new re,this.rectangle=new re,this.ref=new re,this.script=new re,this.setProperty=new re,this.signData=new re,this.signature=new re,this.signing=new re,this.solid=new re,this.speak=new re,this.stipple=new re,this.subform=new re,this.subformSet=new re,this.subjectDN=new re,this.subjectDNs=new re,this.submit=new re,this.text=new re,this.textEdit=new re,this.time=new re,this.timeStamp=new re,this.toolTip=new re,this.traversal=new re,this.traverse=new re,this.ui=new re,this.validate=new re,this.value=new re,this.variables=new re}}class Iq extends Ie{constructor(e){super(Je,"radial",!0),this.id=e.id||"",this.type=Le(e.type,["toEdge","toCenter"]),this.use=e.use||"",this.usehref=e.usehref||"",this.color=null,this.extras=null}[Mn](e){e=e?e[Mn]():"#FFFFFF";const t=this.color?this.color[Mn]():"#000000";return`radial-gradient(circle at center, ${this.type==="toEdge"?`${e},${t}`:`${t},${e}`})`}}class Eq extends yn{constructor(e){super(Je,"reason"),this.id=e.id||"",this.name=e.name||"",this.use=e.use||"",this.usehref=e.usehref||""}}class Tq extends Ie{constructor(e){super(Je,"reasons",!0),this.id=e.id||"",this.type=Le(e.type,["optional","required"]),this.use=e.use||"",this.usehref=e.usehref||"",this.reason=new re}}class aP extends Ie{constructor(e){super(Je,"rectangle",!0),this.hand=Le(e.hand,["even","left","right"]),this.id=e.id||"",this.use=e.use||"",this.usehref=e.usehref||"",this.corner=new re(4),this.edge=new re(4),this.fill=null}[Kt](){var c;const e=this.edge.children.length?this.edge.children[0]:new kx({}),t=e[Mn](),i=Object.create(null);((c=this.fill)==null?void 0:c.presence)==="visible"?Object.assign(i,this.fill[Mn]()):i.fill="transparent",i.strokeWidth=Zt(e.presence==="visible"?e.thickness:0),i.stroke=t.color;const r=(this.corner.children.length?this.corner.children[0]:new tP({}))[Mn](),o={name:"svg",children:[{name:"rect",attributes:{xmlns:Yd,width:"100%",height:"100%",x:0,y:0,rx:r.radius,ry:r.radius,style:i}}],attributes:{xmlns:Yd,style:{overflow:"visible"},width:"100%",height:"100%"}},l=this[en]()[en]();return J4(l)?Et.success({name:"div",attributes:{style:{display:"inline",width:"100%",height:"100%"}},children:[o]}):(o.attributes.style.position="absolute",Et.success(o))}}class Rq extends yn{constructor(e){super(Je,"ref"),this.id=e.id||"",this.use=e.use||"",this.usehref=e.usehref||""}}class Mq extends yn{constructor(e){super(Je,"script"),this.binding=e.binding||"",this.contentType=e.contentType||"",this.id=e.id||"",this.name=e.name||"",this.runAt=Le(e.runAt,["client","both","server"]),this.use=e.use||"",this.usehref=e.usehref||""}}class _6 extends Ie{constructor(e){super(Je,"setProperty"),this.connection=e.connection||"",this.ref=e.ref||"",this.target=e.target||""}}class Pq extends Ie{constructor(e){super(Je,"signData",!0),this.id=e.id||"",this.operation=Le(e.operation,["sign","clear","verify"]),this.ref=e.ref||"",this.target=e.target||"",this.use=e.use||"",this.usehref=e.usehref||"",this.filter=null,this.manifest=null}}class Nq extends Ie{constructor(e){super(Je,"signature",!0),this.id=e.id||"",this.type=Le(e.type,["PDF1.3","PDF1.6"]),this.use=e.use||"",this.usehref=e.usehref||"",this.border=null,this.extras=null,this.filter=null,this.manifest=null,this.margin=null}}class Oq extends Ie{constructor(e){super(Je,"signing",!0),this.id=e.id||"",this.type=Le(e.type,["optional","required"]),this.use=e.use||"",this.usehref=e.usehref||"",this.certificate=new re}}class Dq extends Ie{constructor(e){super(Je,"solid",!0),this.id=e.id||"",this.use=e.use||"",this.usehref=e.usehref||"",this.extras=null}[Mn](e){return e?e[Mn]():"#FFFFFF"}}class Fq extends yn{constructor(e){super(Je,"speak"),this.disable=Qt({data:e.disable,defaultValue:0,validate:t=>t===1}),this.id=e.id||"",this.priority=Le(e.priority,["custom","caption","name","toolTip"]),this.rid=e.rid||"",this.use=e.use||"",this.usehref=e.usehref||""}}class Lq extends Ie{constructor(e){super(Je,"stipple",!0),this.id=e.id||"",this.rate=Qt({data:e.rate,defaultValue:50,validate:t=>t>=0&&t<=100}),this.use=e.use||"",this.usehref=e.usehref||"",this.color=null,this.extras=null}[Mn](e){const t=this.rate/100;return Ln.makeHexColor(Math.round(e.value.r*(1-t)+this.value.r*t),Math.round(e.value.g*(1-t)+this.value.g*t),Math.round(e.value.b*(1-t)+this.value.b*t))}}class oP extends Ie{constructor(e){super(Je,"subform",!0),this.access=Le(e.access,["open","nonInteractive","protected","readOnly"]),this.allowMacro=Qt({data:e.allowMacro,defaultValue:0,validate:t=>t===1}),this.anchorType=Le(e.anchorType,["topLeft","bottomCenter","bottomLeft","bottomRight","middleCenter","middleLeft","middleRight","topCenter","topRight"]),this.colSpan=Qt({data:e.colSpan,defaultValue:1,validate:t=>t>=1||t===-1}),this.columnWidths=(e.columnWidths||"").trim().split(/\s+/).map(t=>t==="-1"?-1:ft(t)),this.h=e.h?ft(e.h):"",this.hAlign=Le(e.hAlign,["left","center","justify","justifyAll","radix","right"]),this.id=e.id||"",this.layout=Le(e.layout,["position","lr-tb","rl-row","rl-tb","row","table","tb"]),this.locale=e.locale||"",this.maxH=ft(e.maxH,"0pt"),this.maxW=ft(e.maxW,"0pt"),this.mergeMode=Le(e.mergeMode,["consumeData","matchTemplate"]),this.minH=ft(e.minH,"0pt"),this.minW=ft(e.minW,"0pt"),this.name=e.name||"",this.presence=Le(e.presence,["visible","hidden","inactive","invisible"]),this.relevant=pl(e.relevant),this.restoreState=Le(e.restoreState,["manual","auto"]),this.scope=Le(e.scope,["name","none"]),this.use=e.use||"",this.usehref=e.usehref||"",this.w=e.w?ft(e.w):"",this.x=ft(e.x,"0pt"),this.y=ft(e.y,"0pt"),this.assist=null,this.bind=null,this.bookend=null,this.border=null,this.break=null,this.calculate=null,this.desc=null,this.extras=null,this.keep=null,this.margin=null,this.occur=null,this.overflow=null,this.pageSet=null,this.para=null,this.traversal=null,this.validate=null,this.variables=null,this.area=new re,this.breakAfter=new re,this.breakBefore=new re,this.connect=new re,this.draw=new re,this.event=new re,this.exObject=new re,this.exclGroup=new re,this.field=new re,this.proto=new re,this.setProperty=new re,this.subform=new re,this.subformSet=new re}[ns](){const e=this[en]();return e instanceof t_?e[ns]():e}[pf](){return!0}[S0](){return this.layout.endsWith("-tb")&&this[_e].attempt===0&&this[_e].numberInLine>0||this[en]()[S0]()}*[Hg](){yield*Q4(this)}[_x](){return WM(this)}[Wd](e,t){KM(this,e,t)}[Kd](){return XM(this)}[g0](){var t;const e=this[ns]();return e[g0]()?this[_e]._isSplittable!==void 0?this[_e]._isSplittable:this.layout==="position"||this.layout.includes("row")?(this[_e]._isSplittable=!1,!1):this.keep&&this.keep.intact!=="none"?(this[_e]._isSplittable=!1,!1):(t=e.layout)!=null&&t.endsWith("-tb")&&e[_e].numberInLine!==0?!1:(this[_e]._isSplittable=!0,!0):!1}[Kt](e){var _;if(xy(this),this.break){if(this.break.after!=="auto"||this.break.afterTarget!==""){const v=new ZM({targetType:this.break.after,target:this.break.afterTarget,startNew:this.break.startNew.toString()});v[ti]=this[ti],this[Ui](v),this.breakAfter.push(v)}if(this.break.before!=="auto"||this.break.beforeTarget!==""){const v=new QM({targetType:this.break.before,target:this.break.beforeTarget,startNew:this.break.startNew.toString()});v[ti]=this[ti],this[Ui](v),this.breakBefore.push(v)}if(this.break.overflowTarget!==""){const v=new rP({target:this.break.overflowTarget,leader:this.break.overflowLeader,trailer:this.break.overflowTrailer});v[ti]=this[ti],this[Ui](v),this.overflow.push(v)}this[Uh](this.break),this.break=null}if(this.presence==="hidden"||this.presence==="inactive")return Et.EMPTY;if((this.breakBefore.children.length>1||this.breakAfter.children.length>1)&&ae("XFA - Several breakBefore or breakAfter in subforms: please file a bug."),this.breakBefore.children.length>=1){const v=this.breakBefore.children[0];if(mC(v))return Et.breakNode(v)}if((_=this[_e])!=null&&_.afterBreakAfter)return Et.EMPTY;py(this);const t=[],i={id:this[qn],class:[]};Y4(this,i.class),this[_e]||(this[_e]=Object.create(null)),Object.assign(this[_e],{children:t,line:null,attributes:i,attempt:0,numberInLine:0,availableSpace:{width:Math.min(this.w||1/0,e.width),height:Math.min(this.h||1/0,e.height)},width:0,height:0,prevHeight:0,currentWidth:0});const s=this[$i](),r=s[_e].noLayoutFailure,a=this[g0]();if(a||wy(this),!by(this,e))return Et.FAILURE;const o=new Set(["area","draw","exclGroup","field","subform","subformSet"]);if(this.layout.includes("row")){const v=this[ns]().columnWidths;Array.isArray(v)&&v.length>0&&(this[_e].columnWidths=v,this[_e].currentColumn=0)}const l=ra(this,"anchorType","dimensions","position","presence","border","margin","hAlign"),c=["xfaSubform"],h=UM(this);if(h&&c.push(h),i.style=l,i.class=c,this.name&&(i.xfaName=this.name),this.overflow){const v=this.overflow[mr]();v.addLeader&&(v.addLeader=!1,pC(this,v.leader,e))}this[nm]();const u=this.layout==="lr-tb"||this.layout==="rl-tb",d=u?G3:1;for(;this[_e].attempt<d;this[_e].attempt++){u&&this[_e].attempt===G3-1&&(this[_e].numberInLine=0);const v=this[Kh]({filter:o,include:!0});if(v.success)break;if(v.isBreak())return this[pa](),v;if(u&&this[_e].attempt===0&&this[_e].numberInLine===0&&!s[_e].noLayoutFailure){this[_e].attempt=d;break}}if(this[pa](),a||_y(this),s[_e].noLayoutFailure=r,this[_e].attempt===d)return this.overflow&&(this[$i]()[_e].overflowNode=this.overflow),a||delete this[_e],Et.FAILURE;if(this.overflow){const v=this.overflow[mr]();v.addTrailer&&(v.addTrailer=!1,pC(this,v.trailer,e))}let f=0,g=0;this.margin&&(f=this.margin.leftInset+this.margin.rightInset,g=this.margin.topInset+this.margin.bottomInset);const m=Math.max(this[_e].width+f,this.w||0),b=Math.max(this[_e].height+g,this.h||0),p=[this.x,this.y,m,b];if(this.w===""&&(l.width=Zt(m)),this.h===""&&(l.height=Zt(b)),(l.width==="0px"||l.height==="0px")&&t.length===0)return Et.EMPTY;const y={name:"div",attributes:i,children:t};yy(this,i);const w=Et.success(Xd(this,y),p);if(this.breakAfter.children.length>=1){const v=this.breakAfter.children[0];if(mC(v))return this[_e].afterBreakAfter=w,Et.breakNode(v)}return delete this[_e],w}}class t_ extends Ie{constructor(e){super(Je,"subformSet",!0),this.id=e.id||"",this.name=e.name||"",this.relation=Le(e.relation,["ordered","choice","unordered"]),this.relevant=pl(e.relevant),this.use=e.use||"",this.usehref=e.usehref||"",this.bookend=null,this.break=null,this.desc=null,this.extras=null,this.occur=null,this.overflow=null,this.breakAfter=new re,this.breakBefore=new re,this.subform=new re,this.subformSet=new re}*[Hg](){yield*Q4(this)}[ns](){let e=this[en]();for(;!(e instanceof oP);)e=e[en]();return e}[pf](){return!0}}class Bq extends Gi{constructor(e){super(Je,"subjectDN"),this.delimiter=e.delimiter||",",this.id=e.id||"",this.name=e.name||"",this.use=e.use||"",this.usehref=e.usehref||""}[ni](){this[De]=new Map(this[De].split(this.delimiter).map(e=>(e=e.split("=",2),e[0]=e[0].trim(),e)))}}class Uq extends Ie{constructor(e){super(Je,"subjectDNs",!0),this.id=e.id||"",this.type=Le(e.type,["optional","required"]),this.use=e.use||"",this.usehref=e.usehref||"",this.subjectDN=new re}}class Hq extends Ie{constructor(e){super(Je,"submit",!0),this.embedPDF=Qt({data:e.embedPDF,defaultValue:0,validate:t=>t===1}),this.format=Le(e.format,["xdp","formdata","pdf","urlencoded","xfd","xml"]),this.id=e.id||"",this.target=e.target||"",this.textEncoding=my({data:e.textEncoding?e.textEncoding.toLowerCase():"",defaultValue:"",validate:t=>["utf-8","big-five","fontspecific","gbk","gb-18030","gb-2312","ksc-5601","none","shift-jis","ucs-2","utf-16"].includes(t)||t.match(/iso-8859-\d{2}/)}),this.use=e.use||"",this.usehref=e.usehref||"",this.xdpContent=e.xdpContent||"",this.encrypt=null,this.encryptData=new re,this.signData=new re}}class n_ extends Ie{constructor(e){super(Je,"template",!0),this.baseProfile=Le(e.baseProfile,["full","interactiveForms"]),this.extras=null,this.subform=new re}[ni](){this.subform.children.length===0&&ae("XFA - No subforms in template node."),this.subform.children.length>=2&&ae("XFA - Several subforms in template node: please file a bug."),this[Jo]=dV}[g0](){return!0}[l0](e,t){return e.startsWith("#")?[this[Lf].get(e.slice(1))]:L0(this,t,e,!0,!0)}*[PM](){var g,m,b;if(!this.subform.children.length)return Et.success({name:"div",children:[]});this[_e]={overflowNode:null,firstUnsplittable:null,currentContentArea:null,currentPageArea:null,noLayoutFailure:!1,pageNumber:1,pagePosition:"first",oddOrEven:"odd",blankOrNotBlank:"nonBlank",paraStack:[]};const e=this.subform.children[0];e.pageSet[Gf]();const t=e.pageSet.pageArea.children,i={name:"div",children:[]};let s=null,r=null,a=null;if(e.breakBefore.children.length>=1?(r=e.breakBefore.children[0],a=r.target):e.subform.children.length>=1&&e.subform.children[0].breakBefore.children.length>=1?(r=e.subform.children[0].breakBefore.children[0],a=r.target):(g=e.break)!=null&&g.beforeTarget?(r=e.break,a=r.beforeTarget):e.subform.children.length>=1&&((m=e.subform.children[0].break)!=null&&m.beforeTarget)&&(r=e.subform.children[0].break,a=r.beforeTarget),r){const p=this[l0](a,r[en]());p instanceof zg&&(s=p,r[_e]={})}s||(s=t[0]),s[_e]={numberOfUse:1};const o=s[en]();o[_e]={numberOfUse:1,pageIndex:o.pageArea.children.indexOf(s),pageSetIndex:0};let l,c=null,h=null,u=!0,d=0,f=0;for(;;){if(u)d=0;else if(i.children.pop(),++d===uV)return ae("XFA - Something goes wrong: please file a bug."),i;l=null,this[_e].currentPageArea=s;const p=s[Kt]().html;i.children.push(p),c&&(this[_e].noLayoutFailure=!0,p.children.push(c[Kt](s[_e].space).html),c=null),h&&(this[_e].noLayoutFailure=!0,p.children.push(h[Kt](s[_e].space).html),h=null);const y=s.contentArea.children,w=p.children.filter(v=>v.attributes.class.includes("xfaContentarea"));u=!1,this[_e].firstUnsplittable=null,this[_e].noLayoutFailure=!1;const _=v=>{var k;const C=e[_x]();C&&(u||(u=((k=C.children)==null?void 0:k.length)>0),w[v].children.push(C))};for(let v=f,C=y.length;v<C;v++){const k=this[_e].currentContentArea=y[v],I={width:k.w,height:k.h};f=0,c&&(w[v].children.push(c[Kt](I).html),c=null),h&&(w[v].children.push(h[Kt](I).html),h=null);const E=e[Kt](I);if(E.success)return E.html?(u||(u=((b=E.html.children)==null?void 0:b.length)>0),w[v].children.push(E.html)):!u&&i.children.length>1&&i.children.pop(),i;if(E.isBreak()){const T=E.breakNode;if(_(v),T.targetType==="auto")continue;T.leader&&(c=this[l0](T.leader,T[en]()),c=c?c[0]:null),T.trailer&&(h=this[l0](T.trailer,T[en]()),h=h?h[0]:null),T.targetType==="pageArea"?(l=T[_e].target,v=1/0):T[_e].target?(l=T[_e].target,f=T[_e].index+1,v=1/0):v=T[_e].index;continue}if(this[_e].overflowNode){const T=this[_e].overflowNode;this[_e].overflowNode=null;const M=T[mr](),D=M.target;M.addLeader=M.leader!==null,M.addTrailer=M.trailer!==null,_(v);const H=v;if(v=1/0,D instanceof zg)l=D;else if(D instanceof $4){const R=y.indexOf(D);R!==-1?R>H?v=R-1:f=R:(l=D[en](),f=l.contentArea.children.indexOf(D))}continue}_(v)}this[_e].pageNumber+=1,l&&(l[r2]()?l[_e].numberOfUse+=1:l=null),s=l||s[Ic](),yield null}}}class lP extends Gi{constructor(e){super(Je,"text"),this.id=e.id||"",this.maxChars=Qt({data:e.maxChars,defaultValue:0,validate:t=>t>=0}),this.name=e.name||"",this.rid=e.rid||"",this.use=e.use||"",this.usehref=e.usehref||""}[dy](){return!0}[sc](e){return e[es]===ss.xhtml.id?(this[De]=e,!0):(ae(`XFA - Invalid content in Text: ${e[Fn]}.`),!1)}[m0](e){this[De]instanceof Ie||super[m0](e)}[ni](){typeof this[De]=="string"&&(this[De]=this[De].replaceAll(`\r
`,`
`))}[mr](){return typeof this[De]=="string"?this[De].split(/[\u2029\u2028\n]/).filter(e=>!!e).join(`
`):this[De][_s]()}[Kt](e){if(typeof this[De]=="string"){const t=eu(this[De]).html;return this[De].includes("\u2029")?(t.name="div",t.children=[],this[De].split("\u2029").map(i=>i.split(/[\u2028\n]/).flatMap(s=>[{name:"span",value:s},{name:"br"}])).forEach(i=>{t.children.push({name:"p",children:i})})):/[\u2028\n]/.test(this[De])&&(t.name="div",t.children=[],this[De].split(/[\u2028\n]/).forEach(i=>{t.children.push({name:"span",value:i},{name:"br"})})),Et.success(t)}return this[De][Kt](e)}}class cP extends Ie{constructor(e){super(Je,"textEdit",!0),this.allowRichText=Qt({data:e.allowRichText,defaultValue:0,validate:t=>t===1}),this.hScrollPolicy=Le(e.hScrollPolicy,["auto","off","on"]),this.id=e.id||"",this.multiLine=Qt({data:e.multiLine,defaultValue:"",validate:t=>t===0||t===1}),this.use=e.use||"",this.usehref=e.usehref||"",this.vScrollPolicy=Le(e.vScrollPolicy,["auto","off","on"]),this.border=null,this.comb=null,this.extras=null,this.margin=null}[Kt](e){var r,a;const t=ra(this,"border","font","margin");let i;const s=this[en]()[en]();return this.multiLine===""&&(this.multiLine=s instanceof nP?1:0),this.multiLine===1?i={name:"textarea",attributes:{dataId:((r=s[vo])==null?void 0:r[qn])||s[qn],fieldId:s[qn],class:["xfaTextfield"],style:t,"aria-label":sf(s),"aria-required":!1}}:i={name:"input",attributes:{type:"text",dataId:((a=s[vo])==null?void 0:a[qn])||s[qn],fieldId:s[qn],class:["xfaTextfield"],style:t,"aria-label":sf(s),"aria-required":!1}},vx(s)&&(i.attributes["aria-required"]=!0,i.attributes.required=!0),Et.success({name:"label",attributes:{class:["xfaLabel"]},children:[i]})}}class zq extends yn{constructor(e){super(Je,"time"),this.id=e.id||"",this.name=e.name||"",this.use=e.use||"",this.usehref=e.usehref||""}[ni](){const e=this[De].trim();this[De]=e?new Date(e):null}[Kt](e){return eu(this[De]?this[De].toString():"")}}class jq extends Ie{constructor(e){super(Je,"timeStamp"),this.id=e.id||"",this.server=e.server||"",this.type=Le(e.type,["optional","required"]),this.use=e.use||"",this.usehref=e.usehref||""}}class Gq extends yn{constructor(e){super(Je,"toolTip"),this.id=e.id||"",this.rid=e.rid||"",this.use=e.use||"",this.usehref=e.usehref||""}}class Vq extends Ie{constructor(e){super(Je,"traversal",!0),this.id=e.id||"",this.use=e.use||"",this.usehref=e.usehref||"",this.extras=null,this.traverse=new re}}class qq extends Ie{constructor(e){super(Je,"traverse",!0),this.id=e.id||"",this.operation=Le(e.operation,["next","back","down","first","left","right","up"]),this.ref=e.ref||"",this.use=e.use||"",this.usehref=e.usehref||"",this.extras=null,this.script=null}get name(){return this.operation}[s2](){return!1}}class i_ extends Ie{constructor(e){super(Je,"ui",!0),this.id=e.id||"",this.use=e.use||"",this.usehref=e.usehref||"",this.extras=null,this.picture=null,this.barcode=null,this.button=null,this.checkButton=null,this.choiceList=null,this.dateTimeEdit=null,this.defaultUi=null,this.imageEdit=null,this.numericEdit=null,this.passwordEdit=null,this.signature=null,this.textEdit=null}[mr](){if(this[_e]===void 0){for(const e of Object.getOwnPropertyNames(this)){if(e==="extras"||e==="picture")continue;const t=this[e];if(t instanceof Ie)return this[_e]=t,t}this[_e]=null}return this[_e]}[Kt](e){const t=this[mr]();return t?t[Kt](e):Et.EMPTY}}class Wq extends Ie{constructor(e){super(Je,"validate",!0),this.formatTest=Le(e.formatTest,["warning","disabled","error"]),this.id=e.id||"",this.nullTest=Le(e.nullTest,["disabled","error","warning"]),this.scriptTest=Le(e.scriptTest,["error","disabled","warning"]),this.use=e.use||"",this.usehref=e.usehref||"",this.extras=null,this.message=null,this.picture=null,this.script=null}}class s_ extends Ie{constructor(e){super(Je,"value",!0),this.id=e.id||"",this.override=Qt({data:e.override,defaultValue:0,validate:t=>t===1}),this.relevant=pl(e.relevant),this.use=e.use||"",this.usehref=e.usehref||"",this.arc=null,this.boolean=null,this.date=null,this.dateTime=null,this.decimal=null,this.exData=null,this.float=null,this.image=null,this.integer=null,this.line=null,this.rectangle=null,this.text=null,this.time=null}[wa](e){var s;const t=this[en]();if(t instanceof e_&&(s=t.ui)!=null&&s.imageEdit){this.image||(this.image=new sP({}),this[Ui](this.image)),this.image[De]=e[De];return}const i=e[Fn];if(this[i]!==null){this[i][De]=e[De];return}for(const r of Object.getOwnPropertyNames(this)){const a=this[r];a instanceof Ie&&(this[r]=null,this[Uh](a))}this[e[Fn]]=e,this[Ui](e)}[_s](){if(this.exData)return typeof this.exData[De]=="string"?this.exData[De].trim():this.exData[De][_s]().trim();for(const e of Object.getOwnPropertyNames(this)){if(e==="image")continue;const t=this[e];if(t instanceof Ie)return(t[De]||"").toString().trim()}return null}[Kt](e){for(const t of Object.getOwnPropertyNames(this)){const i=this[t];if(i instanceof Ie)return i[Kt](e)}return Et.EMPTY}}class Kq extends Ie{constructor(e){super(Je,"variables",!0),this.id=e.id||"",this.use=e.use||"",this.usehref=e.usehref||"",this.boolean=new re,this.date=new re,this.dateTime=new re,this.decimal=new re,this.exData=new re,this.float=new re,this.image=new re,this.integer=new re,this.manifest=new re,this.script=new re,this.text=new re,this.time=new re}[s2](){return!0}}class V3{static[ml](e,t){if(V3.hasOwnProperty(e)){const i=V3[e](t);return i[MM](t),i}}static appearanceFilter(e){return new pV(e)}static arc(e){return new YM(e)}static area(e){return new bV(e)}static assist(e){return new xV(e)}static barcode(e){return new yV(e)}static bind(e){return new wV(e)}static bindItems(e){return new y6(e)}static bookend(e){return new _V(e)}static boolean(e){return new vV(e)}static border(e){return new JM(e)}static break(e){return new kV(e)}static breakAfter(e){return new ZM(e)}static breakBefore(e){return new QM(e)}static button(e){return new CV(e)}static calculate(e){return new AV(e)}static caption(e){return new SV(e)}static certificate(e){return new IV(e)}static certificates(e){return new EV(e)}static checkButton(e){return new $M(e)}static choiceList(e){return new eP(e)}static color(e){return new TV(e)}static comb(e){return new RV(e)}static connect(e){return new MV(e)}static contentArea(e){return new $4(e)}static corner(e){return new tP(e)}static date(e){return new PV(e)}static dateTime(e){return new NV(e)}static dateTimeEdit(e){return new OV(e)}static decimal(e){return new DV(e)}static defaultUi(e){return new FV(e)}static desc(e){return new LV(e)}static digestMethod(e){return new BV(e)}static digestMethods(e){return new UV(e)}static draw(e){return new nP(e)}static edge(e){return new kx(e)}static encoding(e){return new HV(e)}static encodings(e){return new zV(e)}static encrypt(e){return new jV(e)}static encryptData(e){return new GV(e)}static encryption(e){return new VV(e)}static encryptionMethod(e){return new qV(e)}static encryptionMethods(e){return new WV(e)}static event(e){return new KV(e)}static exData(e){return new XV(e)}static exObject(e){return new YV(e)}static exclGroup(e){return new iP(e)}static execute(e){return new JV(e)}static extras(e){return new ZV(e)}static field(e){return new e_(e)}static fill(e){return new QV(e)}static filter(e){return new $V(e)}static float(e){return new eq(e)}static font(e){return new tq(e)}static format(e){return new nq(e)}static handler(e){return new iq(e)}static hyphenation(e){return new sq(e)}static image(e){return new sP(e)}static imageEdit(e){return new rq(e)}static integer(e){return new aq(e)}static issuers(e){return new oq(e)}static items(e){return new w6(e)}static keep(e){return new lq(e)}static keyUsage(e){return new cq(e)}static line(e){return new hq(e)}static linear(e){return new uq(e)}static lockDocument(e){return new dq(e)}static manifest(e){return new fq(e)}static margin(e){return new gq(e)}static mdp(e){return new mq(e)}static medium(e){return new pq(e)}static message(e){return new bq(e)}static numericEdit(e){return new xq(e)}static occur(e){return new yq(e)}static oid(e){return new wq(e)}static oids(e){return new _q(e)}static overflow(e){return new rP(e)}static pageArea(e){return new zg(e)}static pageSet(e){return new a2(e)}static para(e){return new vq(e)}static passwordEdit(e){return new kq(e)}static pattern(e){return new Cq(e)}static picture(e){return new Aq(e)}static proto(e){return new Sq(e)}static radial(e){return new Iq(e)}static reason(e){return new Eq(e)}static reasons(e){return new Tq(e)}static rectangle(e){return new aP(e)}static ref(e){return new Rq(e)}static script(e){return new Mq(e)}static setProperty(e){return new _6(e)}static signData(e){return new Pq(e)}static signature(e){return new Nq(e)}static signing(e){return new Oq(e)}static solid(e){return new Dq(e)}static speak(e){return new Fq(e)}static stipple(e){return new Lq(e)}static subform(e){return new oP(e)}static subformSet(e){return new t_(e)}static subjectDN(e){return new Bq(e)}static subjectDNs(e){return new Uq(e)}static submit(e){return new Hq(e)}static template(e){return new n_(e)}static text(e){return new lP(e)}static textEdit(e){return new cP(e)}static time(e){return new zq(e)}static timeStamp(e){return new jq(e)}static toolTip(e){return new Gq(e)}static traversal(e){return new Vq(e)}static traverse(e){return new qq(e)}static ui(e){return new i_(e)}static validate(e){return new Wq(e)}static value(e){return new s_(e)}static variables(e){return new Kq(e)}}const bC=ss.datasets.id;function h9(n){const e=new lP({});return e[De]=n,e}class Xq{constructor(e){var t;this.root=e,this.datasets=e.datasets,this.data=((t=e.datasets)==null?void 0:t.data)||new rc(ss.datasets.id,"data"),this.emptyMerge=this.data[Ks]().length===0,this.root.form=this.form=e.template[el]()}_isConsumeData(){return!this.emptyMerge&&this._mergeMode}_isMatchTemplate(){return!this._isConsumeData()}bind(){return this._bindElement(this.form,this.data),this.form}getData(){return this.data}_bindValue(e,t,i){var s,r;if(e[vo]=t,e[i2]())if(t[Vf]()){const a=t[V4]();e[wa](h9(a))}else if(e instanceof e_&&((r=(s=e.ui)==null?void 0:s.choiceList)==null?void 0:r.open)==="multiSelect"){const a=t[Ks]().map(o=>o[De].trim()).join(`
`);e[wa](h9(a))}else this._isConsumeData()&&ae("XFA - Nodes haven't the same type.");else!t[Vf]()||this._isMatchTemplate()?this._bindElement(e,t):ae("XFA - Nodes haven't the same type.")}_findDataByNameToConsume(e,t,i,s){if(!e)return null;let r,a;for(let o=0;o<3;o++){for(r=i[Sp](e,!1,!0);a=r.next().value,!!a;)if(t===a[Vf]())return a;if(i[es]===ss.datasets.id&&i[Fn]==="data")break;i=i[en]()}return s?(r=this.data[Sp](e,!0,!1),a=r.next().value,a||(r=this.data[g6](e,!0),a=r.next().value,a!=null&&a[Vf]())?a:null):null}_setProperties(e,t){if(e.hasOwnProperty("setProperty"))for(const{ref:i,target:s,connection:r}of e.setProperty.children){if(r||!i)continue;const a=L0(this.root,t,i,!1,!1);if(!a){ae(`XFA - Invalid reference: ${i}.`);continue}const[o]=a;if(!o[z0](this.data)){ae("XFA - Invalid node: must be a data node.");continue}const l=L0(this.root,e,s,!1,!1);if(!l){ae(`XFA - Invalid target: ${s}.`);continue}const[c]=l;if(!c[z0](e)){ae("XFA - Invalid target: must be a property or subproperty.");continue}const h=c[en]();if(c instanceof _6||h instanceof _6){ae("XFA - Invalid target: cannot be a setProperty or one of its properties.");continue}if(c instanceof y6||h instanceof y6){ae("XFA - Invalid target: cannot be a bindItems or one of its properties.");continue}const u=o[_s](),d=c[Fn];if(c instanceof K4){const f=Object.create(null);f[d]=u;const g=Reflect.construct(Object.getPrototypeOf(h).constructor,[f]);h[d]=g[d];continue}if(!c.hasOwnProperty(De)){ae("XFA - Invalid node to use in setProperty");continue}c[vo]=o,c[De]=u,c[ni]()}}_bindItems(e,t){if(!e.hasOwnProperty("items")||!e.hasOwnProperty("bindItems")||e.bindItems.isEmpty())return;for(const r of e.items.children)e[Uh](r);e.items.clear();const i=new w6({}),s=new w6({});e[Ui](i),e.items.push(i),e[Ui](s),e.items.push(s);for(const{ref:r,labelRef:a,valueRef:o,connection:l}of e.bindItems.children){if(l||!r)continue;const c=L0(this.root,t,r,!1,!1);if(!c){ae(`XFA - Invalid reference: ${r}.`);continue}for(const h of c){if(!h[z0](this.datasets)){ae(`XFA - Invalid ref (${r}): must be a datasets child.`);continue}const u=L0(this.root,h,a,!0,!1);if(!u){ae(`XFA - Invalid label: ${a}.`);continue}const[d]=u;if(!d[z0](this.datasets)){ae("XFA - Invalid label: must be a datasets child.");continue}const f=L0(this.root,h,o,!0,!1);if(!f){ae(`XFA - Invalid value: ${o}.`);continue}const[g]=f;if(!g[z0](this.datasets)){ae("XFA - Invalid value: must be a datasets child.");continue}const m=h9(d[_s]()),b=h9(g[_s]());i[Ui](m),i.text.push(m),s[Ui](b),s.text.push(b)}}}_bindOccurrences(e,t,i){let s;if(t.length>1&&(s=e[el](),s[Uh](s.occur),s.occur=null),this._bindValue(e,t[0],i),this._setProperties(e,t[0]),this._bindItems(e,t[0]),t.length===1)return;const r=e[en](),a=e[Fn],o=r[m6](e);for(let l=1,c=t.length;l<c;l++){const h=t[l],u=s[el]();r[a].push(u),r[g3](o+l,u),this._bindValue(u,h,i),this._setProperties(u,h),this._bindItems(u,h)}}_createOccurrences(e){if(!this.emptyMerge)return;const{occur:t}=e;if(!t||t.initial<=1)return;const i=e[en](),s=e[Fn];if(!(i[s]instanceof re))return;let r;e.name?r=i[s].children.filter(l=>l.name===e.name).length:r=i[s].children.length;const a=i[m6](e)+1,o=t.initial-r;if(o){const l=e[el]();l[Uh](l.occur),l.occur=null,i[s].push(l),i[g3](a,l);for(let c=1;c<o;c++){const h=l[el]();i[s].push(h),i[g3](a+c,h)}}}_getOccurInfo(e){const{name:t,occur:i}=e;if(!i||!t)return[1,1];const s=i.max===-1?1/0:i.max;return[i.min,s]}_setAndBind(e,t){this._setProperties(e,t),this._bindItems(e,t),this._bindElement(e,t)}_bindElement(e,t){const i=[];this._createOccurrences(e);for(const s of e[Ks]()){if(s[vo])continue;if(this._mergeMode===void 0&&s[Fn]==="subform"){this._mergeMode=s.mergeMode==="consumeData";const u=t[Ks]();if(u.length>0)this._bindOccurrences(s,[u[0]],null);else if(this.emptyMerge){const d=t[es]===bC?-1:t[es],f=s[vo]=new rc(d,s.name||"root");t[Ui](f),this._bindElement(s,f)}continue}if(!s[pf]())continue;let r=!1,a=null,o=null,l=null;if(s.bind){switch(s.bind.match){case"none":this._setAndBind(s,t);continue;case"global":r=!0;break;case"dataRef":if(!s.bind.ref){ae(`XFA - ref is empty in node ${s[Fn]}.`),this._setAndBind(s,t);continue}o=s.bind.ref;break}s.bind.picture&&(a=s.bind.picture[De])}const[c,h]=this._getOccurInfo(s);if(o)if(l=L0(this.root,t,o,!0,!1),l===null){if(l=cV(this.data,t,o),!l)continue;this._isConsumeData()&&(l[Zl]=!0),this._setAndBind(s,l);continue}else this._isConsumeData()&&(l=l.filter(u=>!u[Zl])),l.length>h?l=l.slice(0,h):l.length===0&&(l=null),l&&this._isConsumeData()&&l.forEach(u=>{u[Zl]=!0});else{if(!s.name){this._setAndBind(s,t);continue}if(this._isConsumeData()){const u=[];for(;u.length<h;){const d=this._findDataByNameToConsume(s.name,s[i2](),t,r);if(!d)break;d[Zl]=!0,u.push(d)}l=u.length>0?u:null}else{if(l=t[Sp](s.name,!1,this.emptyMerge).next().value,!l){if(c===0){i.push(s);continue}const u=t[es]===bC?-1:t[es];l=s[vo]=new rc(u,s.name),this.emptyMerge&&(l[Zl]=!0),t[Ui](l),this._setAndBind(s,l);continue}this.emptyMerge&&(l[Zl]=!0),l=[l]}}l?this._bindOccurrences(s,l,a):c>0?this._setAndBind(s,t):i.push(s)}i.forEach(s=>s[en]()[Uh](s))}}class Yq{constructor(e,t){this.data=t,this.dataset=e.datasets||null}serialize(e){const t=[[-1,this.data[Ks]()]];for(;t.length>0;){const s=t.at(-1),[r,a]=s;if(r+1===a.length){t.pop();continue}const o=a[++s[0]],l=e.get(o[qn]);if(l)o[wa](l);else{const h=o[TM]();for(const u of h.values()){const d=e.get(u[qn]);if(d){u[wa](d);break}}}const c=o[Ks]();c.length>0&&t.push([-1,c])}const i=['<xfa:datasets xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/">'];if(this.dataset)for(const s of this.dataset[Ks]())s[Fn]!=="data"&&s[Ep](i);return this.data[Ep](i),i.push("</xfa:datasets>"),i.join("")}}const Be=ss.config.id;class Jq extends Ie{constructor(e){super(Be,"acrobat",!0),this.acrobat7=null,this.autoSave=null,this.common=null,this.validate=null,this.validateApprovalSignatures=null,this.submitUrl=new re}}class Zq extends Ie{constructor(e){super(Be,"acrobat7",!0),this.dynamicRender=null}}class Qq extends Wn{constructor(e){super(Be,"ADBE_JSConsole",["delegate","Enable","Disable"])}}class $q extends Wn{constructor(e){super(Be,"ADBE_JSDebugger",["delegate","Enable","Disable"])}}class eW extends ks{constructor(e){super(Be,"addSilentPrint")}}class tW extends ks{constructor(e){super(Be,"addViewerPreferences")}}class nW extends FM{constructor(e){super(Be,"adjustData")}}class iW extends bl{constructor(e){super(Be,"adobeExtensionLevel",0,t=>t>=1&&t<=8)}}class sW extends Ie{constructor(e){super(Be,"agent",!0),this.name=e.name?e.name.trim():"",this.common=new re}}class rW extends Gi{constructor(e){super(Be,"alwaysEmbed")}}class aW extends yn{constructor(e){super(Be,"amd")}}class oW extends Ie{constructor(e){super(Be,"area"),this.level=Qt({data:e.level,defaultValue:0,validate:t=>t>=1&&t<=3}),this.name=Le(e.name,["","barcode","coreinit","deviceDriver","font","general","layout","merge","script","signature","sourceSet","templateCache"])}}class lW extends Wn{constructor(e){super(Be,"attributes",["preserve","delegate","ignore"])}}class cW extends Wn{constructor(e){super(Be,"autoSave",["disabled","enabled"])}}class hW extends yn{constructor(e){super(Be,"base")}}class uW extends Ie{constructor(e){super(Be,"batchOutput"),this.format=Le(e.format,["none","concat","zip","zipCompress"])}}class dW extends Gi{constructor(e){super(Be,"behaviorOverride")}[ni](){this[De]=new Map(this[De].trim().split(/\s+/).filter(e=>e.includes(":")).map(e=>e.split(":",2)))}}class fW extends Ie{constructor(e){super(Be,"cache",!0),this.templateCache=null}}class gW extends ks{constructor(e){super(Be,"change")}}class mW extends Ie{constructor(e){super(Be,"common",!0),this.data=null,this.locale=null,this.localeSet=null,this.messaging=null,this.suppressBanner=null,this.template=null,this.validationMessaging=null,this.versionControl=null,this.log=new re}}class pW extends Ie{constructor(e){super(Be,"compress"),this.scope=Le(e.scope,["imageOnly","document"])}}class bW extends ks{constructor(e){super(Be,"compressLogicalStructure")}}class xW extends FM{constructor(e){super(Be,"compressObjectStream")}}class yW extends Ie{constructor(e){super(Be,"compression",!0),this.compressLogicalStructure=null,this.compressObjectStream=null,this.level=null,this.type=null}}class wW extends Ie{constructor(e){super(Be,"config",!0),this.acrobat=null,this.present=null,this.trace=null,this.agent=new re}}class _W extends Wn{constructor(e){super(Be,"conformance",["A","B"])}}class vW extends ks{constructor(e){super(Be,"contentCopy")}}class kW extends bl{constructor(e){super(Be,"copies",1,t=>t>=1)}}class CW extends yn{constructor(e){super(Be,"creator")}}class AW extends bl{constructor(e){super(Be,"currentPage",0,t=>t>=0)}}class SW extends Ie{constructor(e){super(Be,"data",!0),this.adjustData=null,this.attributes=null,this.incrementalLoad=null,this.outputXSL=null,this.range=null,this.record=null,this.startNode=null,this.uri=null,this.window=null,this.xsl=null,this.excludeNS=new re,this.transform=new re}}class IW extends Ie{constructor(e){super(Be,"debug",!0),this.uri=null}}class EW extends Gi{constructor(e){super(Be,"defaultTypeface"),this.writingScript=Le(e.writingScript,["*","Arabic","Cyrillic","EastEuropeanRoman","Greek","Hebrew","Japanese","Korean","Roman","SimplifiedChinese","Thai","TraditionalChinese","Vietnamese"])}}class TW extends Wn{constructor(e){super(Be,"destination",["pdf","pcl","ps","webClient","zpl"])}}class RW extends ks{constructor(e){super(Be,"documentAssembly")}}class MW extends Ie{constructor(e){super(Be,"driver",!0),this.name=e.name?e.name.trim():"",this.fontInfo=null,this.xdc=null}}class PW extends Wn{constructor(e){super(Be,"duplexOption",["simplex","duplexFlipLongEdge","duplexFlipShortEdge"])}}class NW extends Wn{constructor(e){super(Be,"dynamicRender",["forbidden","required"])}}class OW extends ks{constructor(e){super(Be,"embed")}}class DW extends ks{constructor(e){super(Be,"encrypt")}}class FW extends Ie{constructor(e){super(Be,"encryption",!0),this.encrypt=null,this.encryptionLevel=null,this.permissions=null}}class LW extends Wn{constructor(e){super(Be,"encryptionLevel",["40bit","128bit"])}}class BW extends yn{constructor(e){super(Be,"enforce")}}class UW extends Ie{constructor(e){super(Be,"equate"),this.force=Qt({data:e.force,defaultValue:1,validate:t=>t===0}),this.from=e.from||"",this.to=e.to||""}}class HW extends Ie{constructor(e){super(Be,"equateRange"),this.from=e.from||"",this.to=e.to||"",this._unicodeRange=e.unicodeRange||""}get unicodeRange(){const e=[],t=/U\+([0-9a-fA-F]+)/,i=this._unicodeRange;for(let s of i.split(",").map(r=>r.trim()).filter(r=>!!r))s=s.split("-",2).map(r=>{const a=r.match(t);return a?parseInt(a[1],16):0}),s.length===1&&s.push(s[0]),e.push(s);return We(this,"unicodeRange",e)}}class zW extends Gi{constructor(e){super(Be,"exclude")}[ni](){this[De]=this[De].trim().split(/\s+/).filter(e=>e&&["calculate","close","enter","exit","initialize","ready","validate"].includes(e))}}class jW extends yn{constructor(e){super(Be,"excludeNS")}}class GW extends Wn{constructor(e){super(Be,"flipLabel",["usePrinterSetting","on","off"])}}class VW extends Ie{constructor(e){super(Be,"fontInfo",!0),this.embed=null,this.map=null,this.subsetBelow=null,this.alwaysEmbed=new re,this.defaultTypeface=new re,this.neverEmbed=new re}}class qW extends ks{constructor(e){super(Be,"formFieldFilling")}}class WW extends yn{constructor(e){super(Be,"groupParent")}}class KW extends Wn{constructor(e){super(Be,"ifEmpty",["dataValue","dataGroup","ignore","remove"])}}class XW extends yn{constructor(e){super(Be,"includeXDPContent")}}class YW extends Wn{constructor(e){super(Be,"incrementalLoad",["none","forwardOnly"])}}class JW extends ks{constructor(e){super(Be,"incrementalMerge")}}class ZW extends ks{constructor(e){super(Be,"interactive")}}class QW extends Wn{constructor(e){super(Be,"jog",["usePrinterSetting","none","pageSet"])}}class $W extends Ie{constructor(e){super(Be,"labelPrinter",!0),this.name=Le(e.name,["zpl","dpl","ipl","tcpl"]),this.batchOutput=null,this.flipLabel=null,this.fontInfo=null,this.xdc=null}}class eK extends Wn{constructor(e){super(Be,"layout",["paginate","panel"])}}class tK extends bl{constructor(e){super(Be,"level",0,t=>t>0)}}class nK extends ks{constructor(e){super(Be,"linearized")}}class iK extends yn{constructor(e){super(Be,"locale")}}class sK extends yn{constructor(e){super(Be,"localeSet")}}class rK extends Ie{constructor(e){super(Be,"log",!0),this.mode=null,this.threshold=null,this.to=null,this.uri=null}}class aK extends Ie{constructor(e){super(Be,"map",!0),this.equate=new re,this.equateRange=new re}}class oK extends Ie{constructor(e){super(Be,"mediumInfo",!0),this.map=null}}class lK extends Ie{constructor(e){super(Be,"message",!0),this.msgId=null,this.severity=null}}class cK extends Ie{constructor(e){super(Be,"messaging",!0),this.message=new re}}class hK extends Wn{constructor(e){super(Be,"mode",["append","overwrite"])}}class uK extends ks{constructor(e){super(Be,"modifyAnnots")}}class dK extends bl{constructor(e){super(Be,"msgId",1,t=>t>=1)}}class fK extends yn{constructor(e){super(Be,"nameAttr")}}class gK extends Gi{constructor(e){super(Be,"neverEmbed")}}class mK extends bl{constructor(e){super(Be,"numberOfCopies",null,t=>t>=2&&t<=5)}}class pK extends Ie{constructor(e){super(Be,"openAction",!0),this.destination=null}}class bK extends Ie{constructor(e){super(Be,"output",!0),this.to=null,this.type=null,this.uri=null}}class xK extends yn{constructor(e){super(Be,"outputBin")}}class yK extends Ie{constructor(e){super(Be,"outputXSL",!0),this.uri=null}}class wK extends Wn{constructor(e){super(Be,"overprint",["none","both","draw","field"])}}class _K extends yn{constructor(e){super(Be,"packets")}[ni](){this[De]!=="*"&&(this[De]=this[De].trim().split(/\s+/).filter(e=>["config","datasets","template","xfdf","xslt"].includes(e)))}}class vK extends Ie{constructor(e){super(Be,"pageOffset"),this.x=Qt({data:e.x,defaultValue:"useXDCSetting",validate:t=>!0}),this.y=Qt({data:e.y,defaultValue:"useXDCSetting",validate:t=>!0})}}class kK extends yn{constructor(e){super(Be,"pageRange")}[ni](){const e=this[De].trim().split(/\s+/).map(i=>parseInt(i,10)),t=[];for(let i=0,s=e.length;i<s;i+=2)t.push(e.slice(i,i+2));this[De]=t}}class CK extends Wn{constructor(e){super(Be,"pagination",["simplex","duplexShortEdge","duplexLongEdge"])}}class AK extends Wn{constructor(e){super(Be,"paginationOverride",["none","forceDuplex","forceDuplexLongEdge","forceDuplexShortEdge","forceSimplex"])}}class SK extends bl{constructor(e){super(Be,"part",1,t=>!1)}}class IK extends Ie{constructor(e){super(Be,"pcl",!0),this.name=e.name||"",this.batchOutput=null,this.fontInfo=null,this.jog=null,this.mediumInfo=null,this.outputBin=null,this.pageOffset=null,this.staple=null,this.xdc=null}}class EK extends Ie{constructor(e){super(Be,"pdf",!0),this.name=e.name||"",this.adobeExtensionLevel=null,this.batchOutput=null,this.compression=null,this.creator=null,this.encryption=null,this.fontInfo=null,this.interactive=null,this.linearized=null,this.openAction=null,this.pdfa=null,this.producer=null,this.renderPolicy=null,this.scriptModel=null,this.silentPrint=null,this.submitFormat=null,this.tagged=null,this.version=null,this.viewerPreferences=null,this.xdc=null}}class TK extends Ie{constructor(e){super(Be,"pdfa",!0),this.amd=null,this.conformance=null,this.includeXDPContent=null,this.part=null}}class RK extends Ie{constructor(e){super(Be,"permissions",!0),this.accessibleContent=null,this.change=null,this.contentCopy=null,this.documentAssembly=null,this.formFieldFilling=null,this.modifyAnnots=null,this.plaintextMetadata=null,this.print=null,this.printHighQuality=null}}class MK extends ks{constructor(e){super(Be,"pickTrayByPDFSize")}}class PK extends yn{constructor(e){super(Be,"picture")}}class NK extends ks{constructor(e){super(Be,"plaintextMetadata")}}class OK extends Wn{constructor(e){super(Be,"presence",["preserve","dissolve","dissolveStructure","ignore","remove"])}}class DK extends Ie{constructor(e){super(Be,"present",!0),this.behaviorOverride=null,this.cache=null,this.common=null,this.copies=null,this.destination=null,this.incrementalMerge=null,this.layout=null,this.output=null,this.overprint=null,this.pagination=null,this.paginationOverride=null,this.script=null,this.validate=null,this.xdp=null,this.driver=new re,this.labelPrinter=new re,this.pcl=new re,this.pdf=new re,this.ps=new re,this.submitUrl=new re,this.webClient=new re,this.zpl=new re}}class FK extends ks{constructor(e){super(Be,"print")}}class LK extends ks{constructor(e){super(Be,"printHighQuality")}}class BK extends Wn{constructor(e){super(Be,"printScaling",["appdefault","noScaling"])}}class UK extends yn{constructor(e){super(Be,"printerName")}}class HK extends yn{constructor(e){super(Be,"producer")}}class zK extends Ie{constructor(e){super(Be,"ps",!0),this.name=e.name||"",this.batchOutput=null,this.fontInfo=null,this.jog=null,this.mediumInfo=null,this.outputBin=null,this.staple=null,this.xdc=null}}let jK=class extends Gi{constructor(e){super(Be,"range")}[ni](){this[De]=this[De].split(",",2).map(e=>e.split("-").map(t=>parseInt(t.trim(),10))).filter(e=>e.every(t=>!isNaN(t))).map(e=>(e.length===1&&e.push(e[0]),e))}};class GK extends Gi{constructor(e){super(Be,"record")}[ni](){this[De]=this[De].trim();const e=parseInt(this[De],10);!isNaN(e)&&e>=0&&(this[De]=e)}}class VK extends Gi{constructor(e){super(Be,"relevant")}[ni](){this[De]=this[De].trim().split(/\s+/)}}class qK extends Gi{constructor(e){super(Be,"rename")}[ni](){this[De]=this[De].trim(),(this[De].toLowerCase().startsWith("xml")||new RegExp("[\\p{L}_][\\p{L}\\d._\\p{M}-]*","u").test(this[De]))&&ae("XFA - Rename: invalid XFA name")}}class WK extends Wn{constructor(e){super(Be,"renderPolicy",["server","client"])}}class KK extends Wn{constructor(e){super(Be,"runScripts",["both","client","none","server"])}}class XK extends Ie{constructor(e){super(Be,"script",!0),this.currentPage=null,this.exclude=null,this.runScripts=null}}class YK extends Wn{constructor(e){super(Be,"scriptModel",["XFA","none"])}}class JK extends Wn{constructor(e){super(Be,"severity",["ignore","error","information","trace","warning"])}}class ZK extends Ie{constructor(e){super(Be,"silentPrint",!0),this.addSilentPrint=null,this.printerName=null}}class QK extends Ie{constructor(e){super(Be,"staple"),this.mode=Le(e.mode,["usePrinterSetting","on","off"])}}class $K extends yn{constructor(e){super(Be,"startNode")}}class eX extends bl{constructor(e){super(Be,"startPage",0,t=>!0)}}class tX extends Wn{constructor(e){super(Be,"submitFormat",["html","delegate","fdf","xml","pdf"])}}class nX extends yn{constructor(e){super(Be,"submitUrl")}}class iX extends bl{constructor(e){super(Be,"subsetBelow",100,t=>t>=0&&t<=100)}}class sX extends ks{constructor(e){super(Be,"suppressBanner")}}class rX extends ks{constructor(e){super(Be,"tagged")}}class aX extends Ie{constructor(e){super(Be,"template",!0),this.base=null,this.relevant=null,this.startPage=null,this.uri=null,this.xsl=null}}class oX extends Wn{constructor(e){super(Be,"threshold",["trace","error","information","warning"])}}class lX extends Wn{constructor(e){super(Be,"to",["null","memory","stderr","stdout","system","uri"])}}class cX extends Ie{constructor(e){super(Be,"templateCache"),this.maxEntries=Qt({data:e.maxEntries,defaultValue:5,validate:t=>t>=0})}}class hX extends Ie{constructor(e){super(Be,"trace",!0),this.area=new re}}class uX extends Ie{constructor(e){super(Be,"transform",!0),this.groupParent=null,this.ifEmpty=null,this.nameAttr=null,this.picture=null,this.presence=null,this.rename=null,this.whitespace=null}}class dX extends Wn{constructor(e){super(Be,"type",["none","ascii85","asciiHex","ccittfax","flate","lzw","runLength","native","xdp","mergedXDP"])}}class fX extends yn{constructor(e){super(Be,"uri")}}class gX extends Wn{constructor(e){super(Be,"validate",["preSubmit","prePrint","preExecute","preSave"])}}class mX extends Gi{constructor(e){super(Be,"validateApprovalSignatures")}[ni](){this[De]=this[De].trim().split(/\s+/).filter(e=>["docReady","postSign"].includes(e))}}class pX extends Wn{constructor(e){super(Be,"validationMessaging",["allMessagesIndividually","allMessagesTogether","firstMessageOnly","noMessages"])}}class bX extends Wn{constructor(e){super(Be,"version",["1.7","1.6","1.5","1.4","1.3","1.2"])}}class xX extends Ie{constructor(e){super(Be,"VersionControl"),this.outputBelow=Le(e.outputBelow,["warn","error","update"]),this.sourceAbove=Le(e.sourceAbove,["warn","error"]),this.sourceBelow=Le(e.sourceBelow,["update","maintain"])}}class yX extends Ie{constructor(e){super(Be,"viewerPreferences",!0),this.ADBE_JSConsole=null,this.ADBE_JSDebugger=null,this.addViewerPreferences=null,this.duplexOption=null,this.enforce=null,this.numberOfCopies=null,this.pageRange=null,this.pickTrayByPDFSize=null,this.printScaling=null}}class wX extends Ie{constructor(e){super(Be,"webClient",!0),this.name=e.name?e.name.trim():"",this.fontInfo=null,this.xdc=null}}class _X extends Wn{constructor(e){super(Be,"whitespace",["preserve","ltrim","normalize","rtrim","trim"])}}class vX extends Gi{constructor(e){super(Be,"window")}[ni](){const e=this[De].split(",",2).map(t=>parseInt(t.trim(),10));if(e.some(t=>isNaN(t))){this[De]=[0,0];return}e.length===1&&e.push(e[0]),this[De]=e}}class kX extends Ie{constructor(e){super(Be,"xdc",!0),this.uri=new re,this.xsl=new re}}class CX extends Ie{constructor(e){super(Be,"xdp",!0),this.packets=null}}class AX extends Ie{constructor(e){super(Be,"xsl",!0),this.debug=null,this.uri=null}}class SX extends Ie{constructor(e){super(Be,"zpl",!0),this.name=e.name?e.name.trim():"",this.batchOutput=null,this.flipLabel=null,this.fontInfo=null,this.xdc=null}}class q3{static[ml](e,t){if(q3.hasOwnProperty(e))return q3[e](t)}static acrobat(e){return new Jq(e)}static acrobat7(e){return new Zq(e)}static ADBE_JSConsole(e){return new Qq(e)}static ADBE_JSDebugger(e){return new $q(e)}static addSilentPrint(e){return new eW(e)}static addViewerPreferences(e){return new tW(e)}static adjustData(e){return new nW(e)}static adobeExtensionLevel(e){return new iW(e)}static agent(e){return new sW(e)}static alwaysEmbed(e){return new rW(e)}static amd(e){return new aW(e)}static area(e){return new oW(e)}static attributes(e){return new lW(e)}static autoSave(e){return new cW(e)}static base(e){return new hW(e)}static batchOutput(e){return new uW(e)}static behaviorOverride(e){return new dW(e)}static cache(e){return new fW(e)}static change(e){return new gW(e)}static common(e){return new mW(e)}static compress(e){return new pW(e)}static compressLogicalStructure(e){return new bW(e)}static compressObjectStream(e){return new xW(e)}static compression(e){return new yW(e)}static config(e){return new wW(e)}static conformance(e){return new _W(e)}static contentCopy(e){return new vW(e)}static copies(e){return new kW(e)}static creator(e){return new CW(e)}static currentPage(e){return new AW(e)}static data(e){return new SW(e)}static debug(e){return new IW(e)}static defaultTypeface(e){return new EW(e)}static destination(e){return new TW(e)}static documentAssembly(e){return new RW(e)}static driver(e){return new MW(e)}static duplexOption(e){return new PW(e)}static dynamicRender(e){return new NW(e)}static embed(e){return new OW(e)}static encrypt(e){return new DW(e)}static encryption(e){return new FW(e)}static encryptionLevel(e){return new LW(e)}static enforce(e){return new BW(e)}static equate(e){return new UW(e)}static equateRange(e){return new HW(e)}static exclude(e){return new zW(e)}static excludeNS(e){return new jW(e)}static flipLabel(e){return new GW(e)}static fontInfo(e){return new VW(e)}static formFieldFilling(e){return new qW(e)}static groupParent(e){return new WW(e)}static ifEmpty(e){return new KW(e)}static includeXDPContent(e){return new XW(e)}static incrementalLoad(e){return new YW(e)}static incrementalMerge(e){return new JW(e)}static interactive(e){return new ZW(e)}static jog(e){return new QW(e)}static labelPrinter(e){return new $W(e)}static layout(e){return new eK(e)}static level(e){return new tK(e)}static linearized(e){return new nK(e)}static locale(e){return new iK(e)}static localeSet(e){return new sK(e)}static log(e){return new rK(e)}static map(e){return new aK(e)}static mediumInfo(e){return new oK(e)}static message(e){return new lK(e)}static messaging(e){return new cK(e)}static mode(e){return new hK(e)}static modifyAnnots(e){return new uK(e)}static msgId(e){return new dK(e)}static nameAttr(e){return new fK(e)}static neverEmbed(e){return new gK(e)}static numberOfCopies(e){return new mK(e)}static openAction(e){return new pK(e)}static output(e){return new bK(e)}static outputBin(e){return new xK(e)}static outputXSL(e){return new yK(e)}static overprint(e){return new wK(e)}static packets(e){return new _K(e)}static pageOffset(e){return new vK(e)}static pageRange(e){return new kK(e)}static pagination(e){return new CK(e)}static paginationOverride(e){return new AK(e)}static part(e){return new SK(e)}static pcl(e){return new IK(e)}static pdf(e){return new EK(e)}static pdfa(e){return new TK(e)}static permissions(e){return new RK(e)}static pickTrayByPDFSize(e){return new MK(e)}static picture(e){return new PK(e)}static plaintextMetadata(e){return new NK(e)}static presence(e){return new OK(e)}static present(e){return new DK(e)}static print(e){return new FK(e)}static printHighQuality(e){return new LK(e)}static printScaling(e){return new BK(e)}static printerName(e){return new UK(e)}static producer(e){return new HK(e)}static ps(e){return new zK(e)}static range(e){return new jK(e)}static record(e){return new GK(e)}static relevant(e){return new VK(e)}static rename(e){return new qK(e)}static renderPolicy(e){return new WK(e)}static runScripts(e){return new KK(e)}static script(e){return new XK(e)}static scriptModel(e){return new YK(e)}static severity(e){return new JK(e)}static silentPrint(e){return new ZK(e)}static staple(e){return new QK(e)}static startNode(e){return new $K(e)}static startPage(e){return new eX(e)}static submitFormat(e){return new tX(e)}static submitUrl(e){return new nX(e)}static subsetBelow(e){return new iX(e)}static suppressBanner(e){return new sX(e)}static tagged(e){return new rX(e)}static template(e){return new aX(e)}static templateCache(e){return new cX(e)}static threshold(e){return new oX(e)}static to(e){return new lX(e)}static trace(e){return new hX(e)}static transform(e){return new uX(e)}static type(e){return new dX(e)}static uri(e){return new fX(e)}static validate(e){return new gX(e)}static validateApprovalSignatures(e){return new mX(e)}static validationMessaging(e){return new pX(e)}static version(e){return new bX(e)}static versionControl(e){return new xX(e)}static viewerPreferences(e){return new yX(e)}static webClient(e){return new wX(e)}static whitespace(e){return new _X(e)}static window(e){return new vX(e)}static xdc(e){return new kX(e)}static xdp(e){return new CX(e)}static xsl(e){return new AX(e)}static zpl(e){return new SX(e)}}const Mo=ss.connectionSet.id;class IX extends Ie{constructor(e){super(Mo,"connectionSet",!0),this.wsdlConnection=new re,this.xmlConnection=new re,this.xsdConnection=new re}}class EX extends Ie{constructor(e){super(Mo,"effectiveInputPolicy"),this.id=e.id||"",this.name=e.name||"",this.use=e.use||"",this.usehref=e.usehref||""}}class TX extends Ie{constructor(e){super(Mo,"effectiveOutputPolicy"),this.id=e.id||"",this.name=e.name||"",this.use=e.use||"",this.usehref=e.usehref||""}}class RX extends yn{constructor(e){super(Mo,"operation"),this.id=e.id||"",this.input=e.input||"",this.name=e.name||"",this.output=e.output||"",this.use=e.use||"",this.usehref=e.usehref||""}}class MX extends yn{constructor(e){super(Mo,"rootElement"),this.id=e.id||"",this.name=e.name||"",this.use=e.use||"",this.usehref=e.usehref||""}}class PX extends yn{constructor(e){super(Mo,"soapAction"),this.id=e.id||"",this.name=e.name||"",this.use=e.use||"",this.usehref=e.usehref||""}}class NX extends yn{constructor(e){super(Mo,"soapAddress"),this.id=e.id||"",this.name=e.name||"",this.use=e.use||"",this.usehref=e.usehref||""}}class OX extends yn{constructor(e){super(Mo,"uri"),this.id=e.id||"",this.name=e.name||"",this.use=e.use||"",this.usehref=e.usehref||""}}class DX extends yn{constructor(e){super(Mo,"wsdlAddress"),this.id=e.id||"",this.name=e.name||"",this.use=e.use||"",this.usehref=e.usehref||""}}class FX extends Ie{constructor(e){super(Mo,"wsdlConnection",!0),this.dataDescription=e.dataDescription||"",this.name=e.name||"",this.effectiveInputPolicy=null,this.effectiveOutputPolicy=null,this.operation=null,this.soapAction=null,this.soapAddress=null,this.wsdlAddress=null}}class LX extends Ie{constructor(e){super(Mo,"xmlConnection",!0),this.dataDescription=e.dataDescription||"",this.name=e.name||"",this.uri=null}}class BX extends Ie{constructor(e){super(Mo,"xsdConnection",!0),this.dataDescription=e.dataDescription||"",this.name=e.name||"",this.rootElement=null,this.uri=null}}class W3{static[ml](e,t){if(W3.hasOwnProperty(e))return W3[e](t)}static connectionSet(e){return new IX(e)}static effectiveInputPolicy(e){return new EX(e)}static effectiveOutputPolicy(e){return new TX(e)}static operation(e){return new RX(e)}static rootElement(e){return new MX(e)}static soapAction(e){return new PX(e)}static soapAddress(e){return new NX(e)}static uri(e){return new OX(e)}static wsdlAddress(e){return new DX(e)}static wsdlConnection(e){return new FX(e)}static xmlConnection(e){return new LX(e)}static xsdConnection(e){return new BX(e)}}const v6=ss.datasets.id;class UX extends rc{constructor(e){super(v6,"data",e)}[Ip](){return!0}}class HX extends Ie{constructor(e){super(v6,"datasets",!0),this.data=null,this.Signature=null}[sc](e){const t=e[Fn];(t==="data"&&e[es]===v6||t==="Signature"&&e[es]===ss.signature.id)&&(this[t]=e),this[Ui](e)}}class K3{static[ml](e,t){if(K3.hasOwnProperty(e))return K3[e](t)}static datasets(e){return new HX(e)}static data(e){return new UX(e)}}const Vi=ss.localeSet.id;class zX extends Ie{constructor(e){super(Vi,"calendarSymbols",!0),this.name="gregorian",this.dayNames=new re(2),this.eraNames=null,this.meridiemNames=null,this.monthNames=new re(2)}}class jX extends yn{constructor(e){super(Vi,"currencySymbol"),this.name=Le(e.name,["symbol","isoname","decimal"])}}class GX extends Ie{constructor(e){super(Vi,"currencySymbols",!0),this.currencySymbol=new re(3)}}class VX extends yn{constructor(e){super(Vi,"datePattern"),this.name=Le(e.name,["full","long","med","short"])}}class qX extends Ie{constructor(e){super(Vi,"datePatterns",!0),this.datePattern=new re(4)}}class WX extends Gi{constructor(e){super(Vi,"dateTimeSymbols")}}class KX extends yn{constructor(e){super(Vi,"day")}}class XX extends Ie{constructor(e){super(Vi,"dayNames",!0),this.abbr=Qt({data:e.abbr,defaultValue:0,validate:t=>t===1}),this.day=new re(7)}}class YX extends yn{constructor(e){super(Vi,"era")}}class JX extends Ie{constructor(e){super(Vi,"eraNames",!0),this.era=new re(2)}}class ZX extends Ie{constructor(e){super(Vi,"locale",!0),this.desc=e.desc||"",this.name="isoname",this.calendarSymbols=null,this.currencySymbols=null,this.datePatterns=null,this.dateTimeSymbols=null,this.numberPatterns=null,this.numberSymbols=null,this.timePatterns=null,this.typeFaces=null}}class QX extends Ie{constructor(e){super(Vi,"localeSet",!0),this.locale=new re}}class $X extends yn{constructor(e){super(Vi,"meridiem")}}class eY extends Ie{constructor(e){super(Vi,"meridiemNames",!0),this.meridiem=new re(2)}}class tY extends yn{constructor(e){super(Vi,"month")}}class nY extends Ie{constructor(e){super(Vi,"monthNames",!0),this.abbr=Qt({data:e.abbr,defaultValue:0,validate:t=>t===1}),this.month=new re(12)}}class iY extends yn{constructor(e){super(Vi,"numberPattern"),this.name=Le(e.name,["full","long","med","short"])}}class sY extends Ie{constructor(e){super(Vi,"numberPatterns",!0),this.numberPattern=new re(4)}}class rY extends yn{constructor(e){super(Vi,"numberSymbol"),this.name=Le(e.name,["decimal","grouping","percent","minus","zero"])}}class aY extends Ie{constructor(e){super(Vi,"numberSymbols",!0),this.numberSymbol=new re(5)}}class oY extends yn{constructor(e){super(Vi,"timePattern"),this.name=Le(e.name,["full","long","med","short"])}}class lY extends Ie{constructor(e){super(Vi,"timePatterns",!0),this.timePattern=new re(4)}}class cY extends Ie{constructor(e){super(Vi,"typeFace",!0),this.name=e.name|""}}class hY extends Ie{constructor(e){super(Vi,"typeFaces",!0),this.typeFace=new re}}class X3{static[ml](e,t){if(X3.hasOwnProperty(e))return X3[e](t)}static calendarSymbols(e){return new zX(e)}static currencySymbol(e){return new jX(e)}static currencySymbols(e){return new GX(e)}static datePattern(e){return new VX(e)}static datePatterns(e){return new qX(e)}static dateTimeSymbols(e){return new WX(e)}static day(e){return new KX(e)}static dayNames(e){return new XX(e)}static era(e){return new YX(e)}static eraNames(e){return new JX(e)}static locale(e){return new ZX(e)}static localeSet(e){return new QX(e)}static meridiem(e){return new $X(e)}static meridiemNames(e){return new eY(e)}static month(e){return new tY(e)}static monthNames(e){return new nY(e)}static numberPattern(e){return new iY(e)}static numberPatterns(e){return new sY(e)}static numberSymbol(e){return new rY(e)}static numberSymbols(e){return new aY(e)}static timePattern(e){return new oY(e)}static timePatterns(e){return new lY(e)}static typeFace(e){return new cY(e)}static typeFaces(e){return new hY(e)}}const uY=ss.signature.id;class dY extends Ie{constructor(e){super(uY,"signature",!0)}}class Y3{static[ml](e,t){if(Y3.hasOwnProperty(e))return Y3[e](t)}static signature(e){return new dY(e)}}const fY=ss.stylesheet.id;class gY extends Ie{constructor(e){super(fY,"stylesheet",!0)}}class J3{static[ml](e,t){if(J3.hasOwnProperty(e))return J3[e](t)}static stylesheet(e){return new gY(e)}}const mY=ss.xdp.id;class pY extends Ie{constructor(e){super(mY,"xdp",!0),this.uuid=e.uuid||"",this.timeStamp=e.timeStamp||"",this.config=null,this.connectionSet=null,this.datasets=null,this.localeSet=null,this.stylesheet=new re,this.template=null}[p6](e){const t=ss[e[Fn]];return t&&e[es]===t.id}}class Z3{static[ml](e,t){if(Z3.hasOwnProperty(e))return Z3[e](t)}static xdp(e){return new pY(e)}}const bY=ss.xhtml.id,u9=Symbol(),xY=new Set(["color","font","font-family","font-size","font-stretch","font-style","font-weight","margin","margin-bottom","margin-left","margin-right","margin-top","letter-spacing","line-height","orphans","page-break-after","page-break-before","page-break-inside","tab-interval","tab-stop","text-align","text-decoration","text-indent","vertical-align","widows","kerning-mode","xfa-font-horizontal-scale","xfa-font-vertical-scale","xfa-spacerun","xfa-tab-stops"]),yY=new Map([["page-break-after","breakAfter"],["page-break-before","breakBefore"],["page-break-inside","breakInside"],["kerning-mode",n=>n==="none"?"none":"normal"],["xfa-font-horizontal-scale",n=>`scaleX(${Math.max(0,parseInt(n)/100).toFixed(2)})`],["xfa-font-vertical-scale",n=>`scaleY(${Math.max(0,parseInt(n)/100).toFixed(2)})`],["xfa-spacerun",""],["xfa-tab-stops",""],["font-size",(n,e)=>(n=e.fontSize=Math.abs(ft(n)),Zt(.99*n))],["letter-spacing",n=>Zt(ft(n))],["line-height",n=>Zt(ft(n))],["margin",n=>Zt(ft(n))],["margin-bottom",n=>Zt(ft(n))],["margin-left",n=>Zt(ft(n))],["margin-right",n=>Zt(ft(n))],["margin-top",n=>Zt(ft(n))],["text-indent",n=>Zt(ft(n))],["font-family",n=>n],["vertical-align",n=>Zt(ft(n))]]),wY=/\s+/g,_Y=/[\r\n]+/g,vY=/\r\n?/g;function kY(n,e,t){const i=Object.create(null);if(!n)return i;const s=Object.create(null);for(const[r,a]of n.split(";").map(o=>o.split(":",2))){const o=yY.get(r);if(o==="")continue;let l=a;o&&(l=typeof o=="string"?o:o(a,s)),r.endsWith("scale")?i.transform=i.transform?`${i[r]} ${l}`:l:i[r.replaceAll(/-([a-zA-Z])/g,(c,h)=>h.toUpperCase())]=l}if(i.fontFamily&&GM({typeface:i.fontFamily,weight:i.fontWeight||"normal",posture:i.fontStyle||"normal",size:s.fontSize||0},e,e[ti].fontFinder,i),t&&i.verticalAlign&&i.verticalAlign!=="0px"&&i.fontSize){const o=ft(i.fontSize);i.fontSize=Zt(o*.583),i.verticalAlign=Zt(Math.sign(ft(i.verticalAlign))*o*.333)}return t&&i.fontSize&&(i.fontSize=`calc(${i.fontSize} * var(--total-scale-factor))`),HM(i),i}function CY(n){return n.style?n.style.split(";").filter(e=>!!e.trim()).map(e=>e.split(":",2).map(t=>t.trim())).filter(([e,t])=>(e==="font-family"&&n[ti].usedTypefaces.add(t),xY.has(e))).map(e=>e.join(":")).join(";"):""}const AY=new Set(["body","html"]);class to extends rc{constructor(e,t){super(bY,t),this[u9]=!1,this.style=e.style||""}[Io](e){super[Io](e),this.style=CY(this)}[dy](){return!AY.has(this[Fn])}[m0](e,t=!1){t?this[u9]=!0:(e=e.replaceAll(_Y,""),this.style.includes("xfa-spacerun:yes")||(e=e.replaceAll(wY," "))),e&&(this[De]+=e)}[uc](e,t=!0){const i=Object.create(null),s={top:NaN,bottom:NaN,left:NaN,right:NaN};let r=null;for(const[a,o]of this.style.split(";").map(l=>l.split(":",2)))switch(a){case"font-family":i.typeface=gy(o);break;case"font-size":i.size=ft(o);break;case"font-weight":i.weight=o;break;case"font-style":i.posture=o;break;case"letter-spacing":i.letterSpacing=ft(o);break;case"margin":const l=o.split(/ \t/).map(c=>ft(c));switch(l.length){case 1:s.top=s.bottom=s.left=s.right=l[0];break;case 2:s.top=s.bottom=l[0],s.left=s.right=l[1];break;case 3:s.top=l[0],s.bottom=l[2],s.left=s.right=l[1];break;case 4:s.top=l[0],s.left=l[1],s.bottom=l[2],s.right=l[3];break}break;case"margin-top":s.top=ft(o);break;case"margin-bottom":s.bottom=ft(o);break;case"margin-left":s.left=ft(o);break;case"margin-right":s.right=ft(o);break;case"line-height":r=ft(o);break}if(e.pushData(i,s,r),this[De])e.addString(this[De]);else for(const a of this[Ks]()){if(a[Fn]==="#text"){e.addString(a[De]);continue}a[uc](e)}t&&e.popFont()}[Kt](e){const t=[];if(this[_e]={children:t},this[Kh]({}),t.length===0&&!this[De])return Et.EMPTY;let i;return this[u9]?i=this[De]?this[De].replaceAll(vY,`
`):void 0:i=this[De]||void 0,Et.success({name:this[Fn],attributes:{href:this.href,style:kY(this.style,this,this[u9])},children:t,value:i})}}class SY extends to{constructor(e){super(e,"a"),this.href=VM(e.href)||""}}class IY extends to{constructor(e){super(e,"b")}[uc](e){e.pushFont({weight:"bold"}),super[uc](e),e.popFont()}}class EY extends to{constructor(e){super(e,"body")}[Kt](e){const t=super[Kt](e),{html:i}=t;return i?(i.name="div",i.attributes.class=["xfaRich"],t):Et.EMPTY}}class TY extends to{constructor(e){super(e,"br")}[_s](){return`
`}[uc](e){e.addString(`
`)}[Kt](e){return Et.success({name:"br"})}}class RY extends to{constructor(e){super(e,"html")}[Kt](e){var i;const t=[];if(this[_e]={children:t},this[Kh]({}),t.length===0)return Et.success({name:"div",attributes:{class:["xfaRich"],style:{}},value:this[De]||""});if(t.length===1){const s=t[0];if((i=s.attributes)!=null&&i.class.includes("xfaRich"))return Et.success(s)}return Et.success({name:"div",attributes:{class:["xfaRich"],style:{}},children:t})}}class MY extends to{constructor(e){super(e,"i")}[uc](e){e.pushFont({posture:"italic"}),super[uc](e),e.popFont()}}class PY extends to{constructor(e){super(e,"li")}}class NY extends to{constructor(e){super(e,"ol")}}class OY extends to{constructor(e){super(e,"p")}[uc](e){super[uc](e,!1),e.addString(`
`),e.addPara(),e.popFont()}[_s](){return this[en]()[Ks]().at(-1)===this?super[_s]():super[_s]()+`
`}}class DY extends to{constructor(e){super(e,"span")}}class FY extends to{constructor(e){super(e,"sub")}}class LY extends to{constructor(e){super(e,"sup")}}class BY extends to{constructor(e){super(e,"ul")}}class jg{static[ml](e,t){if(jg.hasOwnProperty(e))return jg[e](t)}static a(e){return new SY(e)}static b(e){return new IY(e)}static body(e){return new EY(e)}static br(e){return new TY(e)}static html(e){return new RY(e)}static i(e){return new MY(e)}static li(e){return new PY(e)}static ol(e){return new NY(e)}static p(e){return new OY(e)}static span(e){return new DY(e)}static sub(e){return new FY(e)}static sup(e){return new LY(e)}static ul(e){return new BY(e)}}const xC={config:q3,connection:W3,datasets:K3,localeSet:X3,signature:Y3,stylesheet:J3,template:V3,xdp:Z3,xhtml:jg};class yC{constructor(e){this.namespaceId=e}[ml](e,t){return new rc(this.namespaceId,e,t)}}class UY extends Ie{constructor(e){super(-1,"root",Object.create(null)),this.element=null,this[Lf]=e}[sc](e){return this.element=e,!0}[ni](){super[ni](),this.element.template instanceof n_&&(this[Lf].set(RM,this.element),this.element.template[bp](this[Lf]),this.element.template[Lf]=this[Lf])}}class HY extends Ie{constructor(){super(-1,"",Object.create(null))}[sc](e){return!1}}class zY{constructor(e=null){this._namespaceStack=[],this._nsAgnosticLevel=0,this._namespacePrefixes=new Map,this._namespaces=new Map,this._nextNsId=Math.max(...Object.values(ss).map(({id:t})=>t)),this._currentNamespace=e||new yC(++this._nextNsId)}buildRoot(e){return new UY(e)}build({nsPrefix:e,name:t,attributes:i,namespace:s,prefixes:r}){const a=s!==null;if(a&&(this._namespaceStack.push(this._currentNamespace),this._currentNamespace=this._searchNamespace(s)),r&&this._addNamespacePrefix(r),i.hasOwnProperty(o0)){const c=xC.datasets,h=i[o0];let u=null;for(const[d,f]of Object.entries(h))if(this._getNamespaceToUse(d)===c){u={xfa:f};break}u?i[o0]=u:delete i[o0]}const o=this._getNamespaceToUse(e),l=(o==null?void 0:o[ml](t,i))||new HY;return l[Ip]()&&this._nsAgnosticLevel++,(a||r||l[Ip]())&&(l[f3]={hasNamespace:a,prefixes:r,nsAgnostic:l[Ip]()}),l}isNsAgnostic(){return this._nsAgnosticLevel>0}_searchNamespace(e){let t=this._namespaces.get(e);if(t)return t;for(const[i,{check:s}]of Object.entries(ss))if(s(e)){if(t=xC[i],t)return this._namespaces.set(e,t),t;break}return t=new yC(++this._nextNsId),this._namespaces.set(e,t),t}_addNamespacePrefix(e){for(const{prefix:t,value:i}of e){const s=this._searchNamespace(i);let r=this._namespacePrefixes.get(t);r||(r=[],this._namespacePrefixes.set(t,r)),r.push(s)}}_getNamespaceToUse(e){if(!e)return this._currentNamespace;const t=this._namespacePrefixes.get(e);return(t==null?void 0:t.length)>0?t.at(-1):(ae(`Unknown namespace prefix: ${e}.`),null)}clean(e){const{hasNamespace:t,prefixes:i,nsAgnostic:s}=e;t&&(this._currentNamespace=this._namespaceStack.pop()),i&&i.forEach(({prefix:r})=>{this._namespacePrefixes.get(r).pop()}),s&&this._nsAgnosticLevel--}}class Q3 extends pM{constructor(e=null,t=!1){super(),this._builder=new zY(e),this._stack=[],this._globalData={usedTypefaces:new Set},this._ids=new Map,this._current=this._builder.buildRoot(this._ids),this._errorCode=ga.NoError,this._whiteRegex=/^\s+$/,this._nbsps=/\xa0+/g,this._richText=t}parse(e){if(this.parseXml(e),this._errorCode===ga.NoError)return this._current[ni](),this._current.element}onText(e){if(e=e.replace(this._nbsps,t=>t.slice(1)+" "),this._richText||this._current[dy]()){this._current[m0](e,this._richText);return}this._whiteRegex.test(e)||this._current[m0](e.trim())}onCdata(e){this._current[m0](e)}_mkAttributes(e,t){let i=null,s=null;const r=Object.create({});for(const{name:a,value:o}of e)if(a==="xmlns")i?ae(`XFA - multiple namespace definition in <${t}>`):i=o;else if(a.startsWith("xmlns:")){const l=a.substring(6);s??(s=[]),s.push({prefix:l,value:o})}else{const l=a.indexOf(":");if(l===-1)r[a]=o;else{const c=r[o0]??(r[o0]=Object.create(null)),[h,u]=[a.slice(0,l),a.slice(l+1)],d=c[h]||(c[h]=Object.create(null));d[u]=o}}return[i,s,r]}_getNameAndPrefix(e,t){const i=e.indexOf(":");return i===-1?[e,null]:[e.substring(i+1),t?"":e.substring(0,i)]}onBeginElement(e,t,i){const[s,r,a]=this._mkAttributes(t,e),[o,l]=this._getNameAndPrefix(e,this._builder.isNsAgnostic()),c=this._builder.build({nsPrefix:l,name:o,attributes:a,namespace:s,prefixes:r});if(c[ti]=this._globalData,i){c[ni](),this._current[sc](c)&&c[b6](this._ids),c[Io](this._builder);return}this._stack.push(this._current),this._current=c}onEndElement(e){const t=this._current;if(t[q4]()&&typeof t[De]=="string"){const i=new Q3;i._globalData=this._globalData;const s=i.parse(t[De]);t[De]=null,t[sc](s)}t[ni](),this._current=this._stack.pop(),this._current[sc](t)&&t[b6](this._ids),t[Io](this._builder)}onError(e){this._errorCode=e}}class Cx{constructor(e){try{this.root=new Q3().parse(Cx._createDocument(e));const t=new Xq(this.root);this.form=t.bind(),this.dataHandler=new Yq(this.root,t.getData()),this.form[ti].template=this.form}catch(t){ae(`XFA - an error occurred during parsing and binding: ${t}`)}}isValid(){return!!(this.root&&this.form)}_createPagesHelper(){const e=this.form[PM]();return new Promise((t,i)=>{const s=()=>{try{const r=e.next();r.done?t(r.value):setTimeout(s,0)}catch(r){i(r)}};setTimeout(s,0)})}async _createPages(){try{this.pages=await this._createPagesHelper(),this.dims=this.pages.children.map(e=>{const{width:t,height:i}=e.attributes.style;return[0,0,parseInt(t),parseInt(i)]})}catch(e){ae(`XFA - an error occurred during layout: ${e}`)}}getBoundingBox(e){return this.dims[e]}async getNumPages(){return this.pages||await this._createPages(),this.dims.length}setImages(e){this.form[ti].images=e}setFonts(e){this.form[ti].fontFinder=new nV(e);const t=[];for(let i of this.form[ti].usedTypefaces)i=gy(i),this.form[ti].fontFinder.find(i)||t.push(i);return t.length>0?t:null}appendFonts(e,t){this.form[ti].fontFinder.add(e,t)}async getPages(){this.pages||await this._createPages();const e=this.pages;return this.pages=null,e}serializeData(e){return this.dataHandler.serialize(e)}static _createDocument(e){return e["/xdp:xdp"]?Object.values(e).join(""):e["xdp:xdp"]}static getRichTextAsHtml(e){if(!e||typeof e!="string")return null;try{let t=new Q3(jg,!0).parse(e);if(!["body","xhtml"].includes(t[Fn])){const a=jg.body({});a[Ui](t),t=a}const i=t[Kt]();if(!i.success)return null;const{html:s}=i,{attributes:r}=s;return r&&(r.class&&(r.class=r.class.filter(a=>!a.startsWith("xfa"))),r.dir="auto"),{html:s,str:t[_s]()}}catch(t){ae(`XFA - an error occurred during parsing of rich text: ${t}`)}return null}}class j0{static createGlobals(e){return Promise.all([e.ensureCatalog("acroForm"),e.ensureDoc("xfaDatasets"),e.ensureCatalog("structTreeRoot"),e.ensureCatalog("baseUrl"),e.ensureCatalog("attachments"),e.ensureCatalog("globalColorSpaceCache")]).then(([t,i,s,r,a,o])=>({pdfManager:e,acroForm:t instanceof ue?t:ue.empty,xfaDatasets:i,structTreeRoot:s,baseUrl:r,attachments:a,globalColorSpaceCache:o}),t=>(ae(`createGlobals: "${t}".`),null))}static async create(e,t,i,s,r,a,o){const l=r?await this._getPageIndex(e,t,i.pdfManager):null;return i.pdfManager.ensure(this,"_create",[e,t,i,s,r,a,l,o])}static _create(e,t,i,s,r=!1,a=null,o=null,l=null){const c=e.fetchIfRef(t);if(!(c instanceof ue))return;const{acroForm:h,pdfManager:u}=i,d=t instanceof tt?t.toString():`annot_${s.createObjId()}`;let f=c.get("Subtype");f=f instanceof ve?f.name:null;const g={xref:e,ref:t,dict:c,subtype:f,id:d,annotationGlobals:i,collectFields:r,orphanFields:a,needAppearances:!r&&h.get("NeedAppearances")===!0,pageIndex:o,evaluatorOptions:u.evaluatorOptions,pageRef:l};switch(f){case"Link":return new KY(g);case"Text":return new WY(g);case"Widget":let m=wo({dict:c,key:"FT"});switch(m=m instanceof ve?m.name:null,m){case"Tx":return new GY(g);case"Btn":return new VY(g);case"Ch":return new qY(g);case"Sig":return new hP(g)}return ae(`Unimplemented widget field type "${m}", falling back to base field type.`),new cl(g);case"Popup":return new uP(g);case"FreeText":return new Vw(g);case"Line":return new XY(g);case"Square":return new YY(g);case"Circle":return new JY(g);case"PolyLine":return new dP(g);case"Polygon":return new fP(g);case"Caret":return new ZY(g);case"Ink":return new Km(g);case"Highlight":return new qw(g);case"Underline":return new QY(g);case"Squiggly":return new $Y(g);case"StrikeOut":return new eJ(g);case"Stamp":return new pu(g);case"FileAttachment":return new tJ(g);default:return r||ae(f?`Unimplemented annotation type "${f}", falling back to base annotation.`:"Annotation is missing the required /Subtype."),new Sx(g)}}static async _getPageIndex(e,t,i){try{const s=await e.fetchIfRefAsync(t);if(!(s instanceof ue))return-1;const r=s.getRaw("P");if(r instanceof tt)try{return await i.ensureCatalog("getPageIndex",[r])}catch(o){gn(`_getPageIndex -- not a valid page reference: "${o}".`)}if(s.has("Kids"))return-1;const a=await i.ensureDoc("numPages");for(let o=0;o<a;o++){const l=await i.getPage(o),c=await i.ensure(l,"annotations");for(const h of c)if(h instanceof tt&&N3(h,t))return o}}catch(s){ae(`_getPageIndex: "${s}".`)}return-1}static generateImages(e,t,i){if(!i)return ae("generateImages: OffscreenCanvas is not supported, cannot save or print some annotations with images."),null;let s;for(const{bitmapId:r,bitmap:a}of e)a&&(s||(s=new Map),s.set(r,pu.createImage(a,t)));return s}static async saveNewAnnotations(e,t,i,s,r){const a=e.xref;let o;const l=[],{isOffscreenCanvasSupported:c}=e.options;for(const h of i)if(!h.deleted)switch(h.annotationType){case vl.FREETEXT:if(!o){const d=new ue(a);d.set("BaseFont",ve.get("Helvetica")),d.set("Type",ve.get("Font")),d.set("Subtype",ve.get("Type1")),d.set("Encoding",ve.get("WinAnsiEncoding")),o=a.getNewTemporaryRef(),r.put(o,{data:d})}l.push(Vw.createNewAnnotation(a,h,r,{evaluator:e,task:t,baseFontRef:o}));break;case vl.HIGHLIGHT:h.quadPoints?l.push(qw.createNewAnnotation(a,h,r)):l.push(Km.createNewAnnotation(a,h,r));break;case vl.INK:l.push(Km.createNewAnnotation(a,h,r));break;case vl.STAMP:const u=c?await(s==null?void 0:s.get(h.bitmapId)):null;if(u!=null&&u.imageStream){const{imageStream:d,smaskStream:f}=u;if(f){const m=a.getNewTemporaryRef();r.put(m,{data:f}),d.dict.set("SMask",m)}const g=u.imageRef=a.getNewTemporaryRef();r.put(g,{data:d}),u.imageStream=u.smaskStream=null}l.push(pu.createNewAnnotation(a,h,r,{image:u}));break;case vl.SIGNATURE:l.push(pu.createNewAnnotation(a,h,r,{}));break}return{annotations:await Promise.all(l)}}static async printNewAnnotations(e,t,i,s,r){if(!s)return null;const{options:a,xref:o}=t,l=[];for(const c of s)if(!c.deleted)switch(c.annotationType){case vl.FREETEXT:l.push(Vw.createNewPrintAnnotation(e,o,c,{evaluator:t,task:i,evaluatorOptions:a}));break;case vl.HIGHLIGHT:c.quadPoints?l.push(qw.createNewPrintAnnotation(e,o,c,{evaluatorOptions:a})):l.push(Km.createNewPrintAnnotation(e,o,c,{evaluatorOptions:a}));break;case vl.INK:l.push(Km.createNewPrintAnnotation(e,o,c,{evaluatorOptions:a}));break;case vl.STAMP:const h=a.isOffscreenCanvasSupported?await(r==null?void 0:r.get(c.bitmapId)):null;if(h!=null&&h.imageStream){const{imageStream:u,smaskStream:d}=h;d&&u.dict.set("SMask",d),h.imageRef=new Og(u,u.length),h.imageStream=h.smaskStream=null}l.push(pu.createNewPrintAnnotation(e,o,c,{image:h,evaluatorOptions:a}));break;case vl.SIGNATURE:l.push(pu.createNewPrintAnnotation(e,o,c,{evaluatorOptions:a}));break}return Promise.all(l)}}function d1(n,e=new Uint8ClampedArray(3)){if(!Array.isArray(n))return e;const t=e||new Uint8ClampedArray(3);switch(n.length){case 0:return null;case 1:return Dn.gray.getRgbItem(n,0,t,0),t;case 3:return Dn.rgb.getRgbItem(n,0,t,0),t;case 4:return Dn.cmyk.getRgbItem(n,0,t,0),t;default:return e}}function Or(n){return Array.from(n,e=>e/255)}function Ax(n,e){const t=n.getArray("QuadPoints");if(!Yr(t,null)||t.length===0||t.length%8>0)return null;const i=new Float32Array(t.length);for(let s=0,r=t.length;s<r;s+=8){const[a,o,l,c,h,u,d,f]=t.slice(s,s+8),g=Math.min(a,l,h,d),m=Math.max(a,l,h,d),b=Math.min(o,c,u,f),p=Math.max(o,c,u,f);if(e!==null&&(g<e[0]||m>e[2]||b<e[1]||p>e[3]))return null;i.set([g,p,m,p,g,b,m,b],s)}return i}function k6(n,e,t){const i=new Float32Array([1/0,1/0,-1/0,-1/0]);Ln.axialAlignedBoundingBox(e,t,i);const[s,r,a,o]=i;if(s===a||r===o)return[1,0,0,1,n[0],n[1]];const l=(n[2]-n[0])/(a-s),c=(n[3]-n[1])/(o-r);return[l,0,0,c,n[0]-s*l,n[1]-r*c]}class Sx{constructor(e){const{dict:t,xref:i,annotationGlobals:s,ref:r,orphanFields:a}=e,o=a==null?void 0:a.get(r);o&&t.set("Parent",o),this.setTitle(t.get("T")),this.setContents(t.get("Contents")),this.setModificationDate(t.get("M")),this.setFlags(t.get("F")),this.setRectangle(t.getArray("Rect")),this.setColor(t.getArray("C")),this.setBorderStyle(t),this.setAppearance(t),this.setOptionalContent(t);const l=t.get("MK");this.setBorderAndBackgroundColors(l),this.setRotation(l,t),this.ref=e.ref instanceof tt?e.ref:null,this._streams=[],this.appearance&&this._streams.push(this.appearance);const c=!!(this.flags&_i.LOCKED),h=!!(this.flags&_i.LOCKEDCONTENTS);if(this.data={annotationFlags:this.flags,borderStyle:this.borderStyle,color:this.color,backgroundColor:this.backgroundColor,borderColor:this.borderColor,rotation:this.rotation,contentsObj:this._contents,hasAppearance:!!this.appearance,id:e.id,modificationDate:this.modificationDate,rect:this.rectangle,subtype:e.subtype,hasOwnCanvas:!1,noRotate:!!(this.flags&_i.NOROTATE),noHTML:c&&h,isEditable:!1,structParent:-1},s.structTreeRoot){let d=t.get("StructParent");this.data.structParent=d=Number.isInteger(d)&&d>=0?d:-1,s.structTreeRoot.addAnnotationIdToPage(e.pageRef,d)}if(e.collectFields){const d=t.get("Kids");if(Array.isArray(d)){const f=[];for(const g of d)g instanceof tt&&f.push(g.toString());f.length!==0&&(this.data.kidIds=f)}this.data.actions=oy(i,t,mR),this.data.fieldName=this._constructFieldName(t),this.data.pageIndex=e.pageIndex}const u=t.get("IT");u instanceof ve&&(this.data.it=u.name),this._isOffscreenCanvasSupported=e.evaluatorOptions.isOffscreenCanvasSupported,this._fallbackFontDict=null,this._needAppearances=!1}_hasFlag(e,t){return!!(e&t)}_buildFlags(e,t){let{flags:i}=this;return e===void 0?t===void 0?void 0:t?i&~_i.PRINT:i&~_i.HIDDEN|_i.PRINT:e?(i|=_i.PRINT,t?i&~_i.NOVIEW|_i.HIDDEN:i&~_i.HIDDEN|_i.NOVIEW):(i&=~(_i.HIDDEN|_i.NOVIEW),t?i&~_i.PRINT:i|_i.PRINT)}_isViewable(e){return!this._hasFlag(e,_i.INVISIBLE)&&!this._hasFlag(e,_i.NOVIEW)}_isPrintable(e){return this._hasFlag(e,_i.PRINT)&&!this._hasFlag(e,_i.HIDDEN)&&!this._hasFlag(e,_i.INVISIBLE)}mustBeViewed(e,t){var s;const i=(s=e==null?void 0:e.get(this.data.id))==null?void 0:s.noView;return i!==void 0?!i:this.viewable&&!this._hasFlag(this.flags,_i.HIDDEN)}mustBePrinted(e){var i;const t=(i=e==null?void 0:e.get(this.data.id))==null?void 0:i.noPrint;return t!==void 0?!t:this.printable}mustBeViewedWhenEditing(e,t=null){return e?!this.data.isEditable:!(t!=null&&t.has(this.data.id))}get viewable(){return this.data.quadPoints===null?!1:this.flags===0?!0:this._isViewable(this.flags)}get printable(){return this.data.quadPoints===null||this.flags===0?!1:this._isPrintable(this.flags)}_parseStringHelper(e){const t=typeof e=="string"?Rn(e):"",i=t&&hM(t).dir==="rtl"?"rtl":"ltr";return{str:t,dir:i}}setDefaultAppearance(e){const{dict:t,annotationGlobals:i}=e,s=wo({dict:t,key:"DA"})||i.acroForm.get("DA");this._defaultAppearance=typeof s=="string"?s:"",this.data.defaultAppearanceData=j4(this._defaultAppearance)}setTitle(e){this._title=this._parseStringHelper(e)}setContents(e){this._contents=this._parseStringHelper(e)}setModificationDate(e){this.modificationDate=typeof e=="string"?e:null}setFlags(e){this.flags=Number.isInteger(e)&&e>0?e:0,this.flags&_i.INVISIBLE&&this.constructor.name!=="Annotation"&&(this.flags^=_i.INVISIBLE)}hasFlag(e){return this._hasFlag(this.flags,e)}setRectangle(e){this.rectangle=A0(e,[0,0,0,0])}setColor(e){this.color=d1(e)}setLineEndings(e){if(this.lineEndings=["None","None"],Array.isArray(e)&&e.length===2)for(let t=0;t<2;t++){const i=e[t];if(i instanceof ve)switch(i.name){case"None":continue;case"Square":case"Circle":case"Diamond":case"OpenArrow":case"ClosedArrow":case"Butt":case"ROpenArrow":case"RClosedArrow":case"Slash":this.lineEndings[t]=i.name;continue}ae(`Ignoring invalid lineEnding: ${i}`)}}setRotation(e,t){this.rotation=0;let i=e instanceof ue?e.get("R")||0:t.get("Rotate")||0;Number.isInteger(i)&&i!==0&&(i%=360,i<0&&(i+=360),i%90===0&&(this.rotation=i))}setBorderAndBackgroundColors(e){e instanceof ue?(this.borderColor=d1(e.getArray("BC"),null),this.backgroundColor=d1(e.getArray("BG"),null)):this.borderColor=this.backgroundColor=null}setBorderStyle(e){if(this.borderStyle=new jY,e instanceof ue)if(e.has("BS")){const t=e.get("BS");if(t instanceof ue){const i=t.get("Type");(!i||Li(i,"Border"))&&(this.borderStyle.setWidth(t.get("W"),this.rectangle),this.borderStyle.setStyle(t.get("S")),this.borderStyle.setDashArray(t.getArray("D")))}}else if(e.has("Border")){const t=e.getArray("Border");Array.isArray(t)&&t.length>=3&&(this.borderStyle.setHorizontalCornerRadius(t[0]),this.borderStyle.setVerticalCornerRadius(t[1]),this.borderStyle.setWidth(t[2],this.rectangle),t.length===4&&this.borderStyle.setDashArray(t[3],!0))}else this.borderStyle.setWidth(0)}setAppearance(e){this.appearance=null;const t=e.get("AP");if(!(t instanceof ue))return;const i=t.get("N");if(i instanceof dn){this.appearance=i;return}if(!(i instanceof ue))return;const s=e.get("AS");if(!(s instanceof ve)||!i.has(s.name))return;const r=i.get(s.name);r instanceof dn&&(this.appearance=r)}setOptionalContent(e){this.oc=null;const t=e.get("OC");t instanceof ve?ae("setOptionalContent: Support for /Name-entry is not implemented."):t instanceof ue&&(this.oc=t)}async loadResources(e,t){const i=await t.dict.getAsync("Resources");return i&&await Bg.load(i,e,i.xref),i}async getOperatorList(e,t,i,s){const{hasOwnCanvas:r,id:a,rect:o}=this.data;let l=this.appearance;const c=!!(r&&i&Wr.DISPLAY);if(c&&(this.width===0||this.height===0))return this.data.hasOwnCanvas=!1,{opList:new Pr,separateForm:!1,separateCanvas:!1};if(!l){if(!c)return{opList:new Pr,separateForm:!1,separateCanvas:!1};l=new ta(""),l.dict=new ue}const h=l.dict,u=await this.loadResources(P7,l),d=F7(h.getArray("BBox"),[0,0,1,1]),f=Dh(h.getArray("Matrix"),al),g=k6(o,d,f),m=new Pr;let b;return this.oc&&(b=await e.parseMarkedContentProps(this.oc,null)),b!==void 0&&m.addOp(ie.beginMarkedContentProps,["OC",b]),m.addOp(ie.beginAnnotation,[a,o,g,f,c]),await e.getOperatorList({stream:l,task:t,resources:u,operatorList:m,fallbackFontDict:this._fallbackFontDict}),m.addOp(ie.endAnnotation,[]),b!==void 0&&m.addOp(ie.endMarkedContent,[]),this.reset(),{opList:m,separateForm:!1,separateCanvas:c}}async save(e,t,i,s){return null}get overlaysTextContent(){return!1}get hasTextContent(){return!1}async extractTextContent(e,t,i){if(!this.appearance)return;const s=await this.loadResources(N7,this.appearance),r=[],a=[];let o=null;const l={desiredSize:Math.Infinity,ready:!0,enqueue(c,h){for(const u of c.items)u.str!==void 0&&(o||(o=u.transform.slice(-2)),a.push(u.str),u.hasEOL&&(r.push(a.join("").trimEnd()),a.length=0))}};if(await e.getTextContent({stream:this.appearance,task:t,resources:s,includeMarkedContent:!0,keepWhiteSpace:!0,sink:l,viewBox:i}),this.reset(),a.length&&r.push(a.join("").trimEnd()),r.length>1||r[0]){const c=this.appearance.dict,h=F7(c.getArray("BBox"),null),u=Dh(c.getArray("Matrix"),null);this.data.textPosition=this._transformPoint(o,h,u),this.data.textContent=r}}_transformPoint(e,t,i){const{rect:s}=this.data;t||(t=[0,0,1,1]),i||(i=[1,0,0,1,0,0]);const r=k6(s,t,i);r[4]-=s[0],r[5]-=s[1];const a=e.slice();return Ln.applyTransform(a,r),Ln.applyTransform(a,i),a}getFieldObject(){return this.data.kidIds?{id:this.data.id,actions:this.data.actions,name:this.data.fieldName,strokeColor:this.data.borderColor,fillColor:this.data.backgroundColor,type:"",kidIds:this.data.kidIds,page:this.data.pageIndex,rotation:this.rotation}:null}reset(){for(const e of this._streams)e.reset()}_constructFieldName(e){if(!e.has("T")&&!e.has("Parent"))return ae("Unknown field name, falling back to empty field name."),"";if(!e.has("Parent"))return Rn(e.get("T"));const t=[];e.has("T")&&t.unshift(Rn(e.get("T")));let i=e;const s=new ts;for(e.objId&&s.put(e.objId);i.has("Parent")&&(i=i.get("Parent"),!(!(i instanceof ue)||i.objId&&s.has(i.objId)));)i.objId&&s.put(i.objId),i.has("T")&&t.unshift(Rn(i.get("T")));return t.join(".")}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}}class jY{constructor(){this.width=1,this.rawWidth=1,this.style=bf.SOLID,this.dashArray=[3],this.horizontalCornerRadius=0,this.verticalCornerRadius=0}setWidth(e,t=[0,0,0,0]){if(e instanceof ve){this.width=0;return}if(typeof e=="number"){if(e>0){this.rawWidth=e;const i=(t[2]-t[0])/2,s=(t[3]-t[1])/2;i>0&&s>0&&(e>i||e>s)&&(ae(`AnnotationBorderStyle.setWidth - ignoring width: ${e}`),e=1)}this.width=e}}setStyle(e){if(e instanceof ve)switch(e.name){case"S":this.style=bf.SOLID;break;case"D":this.style=bf.DASHED;break;case"B":this.style=bf.BEVELED;break;case"I":this.style=bf.INSET;break;case"U":this.style=bf.UNDERLINE;break}}setDashArray(e,t=!1){if(Array.isArray(e)){let i=!0,s=!0;for(const r of e)if(+r>=0)r>0&&(s=!1);else{i=!1;break}e.length===0||i&&!s?(this.dashArray=e,t&&this.setStyle(ve.get("D"))):this.width=0}else e&&(this.width=0)}setHorizontalCornerRadius(e){Number.isInteger(e)&&(this.horizontalCornerRadius=e)}setVerticalCornerRadius(e){Number.isInteger(e)&&(this.verticalCornerRadius=e)}}class _a extends Sx{constructor(e){super(e);const{dict:t}=e;if(t.has("IRT")){const s=t.getRaw("IRT");this.data.inReplyTo=s instanceof tt?s.toString():null;const r=t.get("RT");this.data.replyType=r instanceof ve?r.name:E7.REPLY}let i=null;if(this.data.replyType===E7.GROUP){const s=t.get("IRT");this.setTitle(s.get("T")),this.data.titleObj=this._title,this.setContents(s.get("Contents")),this.data.contentsObj=this._contents,s.has("CreationDate")?(this.setCreationDate(s.get("CreationDate")),this.data.creationDate=this.creationDate):this.data.creationDate=null,s.has("M")?(this.setModificationDate(s.get("M")),this.data.modificationDate=this.modificationDate):this.data.modificationDate=null,i=s.getRaw("Popup"),s.has("C")?(this.setColor(s.getArray("C")),this.data.color=this.color):this.data.color=null}else this.data.titleObj=this._title,this.setCreationDate(t.get("CreationDate")),this.data.creationDate=this.creationDate,i=t.getRaw("Popup"),t.has("C")||(this.data.color=null);this.data.popupRef=i instanceof tt?i.toString():null,t.has("RC")&&(this.data.richText=Cx.getRichTextAsHtml(t.get("RC")))}setCreationDate(e){this.creationDate=typeof e=="string"?e:null}_setDefaultAppearance({xref:e,extra:t,strokeColor:i,fillColor:s,blendMode:r,strokeAlpha:a,fillAlpha:o,pointsCallback:l}){const c=this.data.rect=[1/0,1/0,-1/0,-1/0],h=["q"];t&&h.push(t),i&&h.push(`${i[0]} ${i[1]} ${i[2]} RG`),s&&h.push(`${s[0]} ${s[1]} ${s[2]} rg`);const u=this.data.quadPoints||Float32Array.from([this.rectangle[0],this.rectangle[3],this.rectangle[2],this.rectangle[3],this.rectangle[0],this.rectangle[1],this.rectangle[2],this.rectangle[1]]);for(let w=0,_=u.length;w<_;w+=8){const v=l(h,u.subarray(w,w+8));Ln.rectBoundingBox(...v,c)}h.push("Q");const d=new ue(e),f=new ue(e);f.set("Subtype",ve.get("Form"));const g=new ta(h.join(" "));g.dict=f,d.set("Fm0",g);const m=new ue(e);r&&m.set("BM",ve.get(r)),typeof a=="number"&&m.set("CA",a),typeof o=="number"&&m.set("ca",o);const b=new ue(e);b.set("GS0",m);const p=new ue(e);p.set("ExtGState",b),p.set("XObject",d);const y=new ue(e);y.set("Resources",p),y.set("BBox",c),this.appearance=new ta("/GS0 gs /Fm0 Do"),this.appearance.dict=y,this._streams.push(this.appearance,g)}static async createNewAnnotation(e,t,i,s){const r=t.ref||(t.ref=e.getNewTemporaryRef()),a=await this.createNewAppearanceStream(t,e,s);let o;if(a){const l=e.getNewTemporaryRef();o=this.createNewDict(t,e,{apRef:l}),i.put(l,{data:a})}else o=this.createNewDict(t,e,{});return Number.isInteger(t.parentTreeId)&&o.set("StructParent",t.parentTreeId),i.put(r,{data:o}),{ref:r}}static async createNewPrintAnnotation(e,t,i,s){const r=await this.createNewAppearanceStream(i,t,s),a=this.createNewDict(i,t,r?{ap:r}:{}),o=new this.prototype.constructor({dict:a,xref:t,annotationGlobals:e,evaluatorOptions:s.evaluatorOptions});return i.ref&&(o.ref=o.refToReplace=i.ref),o}}class cl extends Sx{constructor(e){var d;super(e);const{dict:t,xref:i,annotationGlobals:s}=e,r=this.data;this._needAppearances=e.needAppearances,r.annotationType=Qs.WIDGET,r.fieldName===void 0&&(r.fieldName=this._constructFieldName(t)),r.actions===void 0&&(r.actions=oy(i,t,mR));let a=wo({dict:t,key:"V",getArray:!0});r.fieldValue=this._decodeFormValue(a);const o=wo({dict:t,key:"DV",getArray:!0});if(r.defaultFieldValue=this._decodeFormValue(o),a===void 0&&s.xfaDatasets){const f=this._title.str;f&&(this._hasValueFromXFA=!0,r.fieldValue=a=s.xfaDatasets.getValue(f))}a===void 0&&r.defaultFieldValue!==null&&(r.fieldValue=r.defaultFieldValue),r.alternativeText=Rn(t.get("TU")||""),this.setDefaultAppearance(e),r.hasAppearance||(r.hasAppearance=this._needAppearances&&r.fieldValue!==void 0&&r.fieldValue!==null);const l=wo({dict:t,key:"FT"});r.fieldType=l instanceof ve?l.name:null;const c=wo({dict:t,key:"DR"}),h=s.acroForm.get("DR"),u=(d=this.appearance)==null?void 0:d.dict.get("Resources");this._fieldResources={localResources:c,acroFormResources:h,appearanceResources:u,mergedResources:ue.merge({xref:i,dictArray:[c,u,h],mergeSubDicts:!0})},r.fieldFlags=wo({dict:t,key:"Ff"}),(!Number.isInteger(r.fieldFlags)||r.fieldFlags<0)&&(r.fieldFlags=0),r.password=this.hasFieldFlag(nl.PASSWORD),r.readOnly=this.hasFieldFlag(nl.READONLY),r.required=this.hasFieldFlag(nl.REQUIRED),r.hidden=this._hasFlag(r.annotationFlags,_i.HIDDEN)||this._hasFlag(r.annotationFlags,_i.NOVIEW)}_decodeFormValue(e){return Array.isArray(e)?e.filter(t=>typeof t=="string").map(t=>Rn(t)):e instanceof ve?Rn(e.name):typeof e=="string"?Rn(e):null}hasFieldFlag(e){return!!(this.data.fieldFlags&e)}_isViewable(e){return!0}mustBeViewed(e,t){return t?this.viewable:super.mustBeViewed(e,t)&&!this._hasFlag(this.flags,_i.NOVIEW)}getRotationMatrix(e){var i;let t=(i=e==null?void 0:e.get(this.data.id))==null?void 0:i.rotation;return t===void 0&&(t=this.rotation),t===0?al:D3(t,this.width,this.height)}getBorderAndBackgroundAppearances(e){var r;let t=(r=e==null?void 0:e.get(this.data.id))==null?void 0:r.rotation;if(t===void 0&&(t=this.rotation),!this.backgroundColor&&!this.borderColor)return"";const i=t===0||t===180?`0 0 ${this.width} ${this.height} re`:`0 0 ${this.height} ${this.width} re`;let s="";if(this.backgroundColor&&(s=`${hc(this.backgroundColor,!0)} ${i} f `),this.borderColor){const a=this.borderStyle.width||1;s+=`${a} w ${hc(this.borderColor,!1)} ${i} S `}return s}async getOperatorList(e,t,i,s){if(i&Wr.ANNOTATIONS_FORMS&&!(this instanceof hP)&&!this.data.noHTML&&!this.data.hasOwnCanvas)return{opList:new Pr,separateForm:!0,separateCanvas:!1};if(!this._hasText)return super.getOperatorList(e,t,i,s);const r=await this._getAppearance(e,t,i,s);if(this.appearance&&r===null)return super.getOperatorList(e,t,i,s);const a=new Pr;if(!this._defaultAppearance||r===null)return{opList:a,separateForm:!1,separateCanvas:!1};const o=!!(this.data.hasOwnCanvas&&i&Wr.DISPLAY),l=[1,0,0,1,0,0],c=[0,0,this.width,this.height],h=k6(this.data.rect,c,l);let u;this.oc&&(u=await e.parseMarkedContentProps(this.oc,null)),u!==void 0&&a.addOp(ie.beginMarkedContentProps,["OC",u]),a.addOp(ie.beginAnnotation,[this.data.id,this.data.rect,h,this.getRotationMatrix(s),o]);const d=new ta(r);return await e.getOperatorList({stream:d,task:t,resources:this._fieldResources.mergedResources,operatorList:a}),a.addOp(ie.endAnnotation,[]),u!==void 0&&a.addOp(ie.endMarkedContent,[]),{opList:a,separateForm:!1,separateCanvas:o}}_getMKDict(e){const t=new ue(null);return e&&t.set("R",e),this.borderColor&&t.set("BC",Or(this.borderColor)),this.backgroundColor&&t.set("BG",Or(this.backgroundColor)),t.size>0?t:null}amendSavedDict(e,t){}setValue(e,t,i,s){const{dict:r,ref:a}=FU(e,this.ref,i);if(!r)e.set("V",t);else if(!s.has(a)){const o=r.clone();return o.set("V",t),s.put(a,{data:o}),o}return null}async save(e,t,i,s){const r=i==null?void 0:i.get(this.data.id),a=this._buildFlags(r==null?void 0:r.noView,r==null?void 0:r.noPrint);let o=r==null?void 0:r.value,l=r==null?void 0:r.rotation;if(o===this.data.fieldValue||o===void 0){if(!this._hasValueFromXFA&&l===void 0&&a===void 0)return;o||(o=this.data.fieldValue)}if(l===void 0&&!this._hasValueFromXFA&&Array.isArray(o)&&Array.isArray(this.data.fieldValue)&&qp(o,this.data.fieldValue)&&a===void 0)return;l===void 0&&(l=this.rotation);let c=null;if(!this._needAppearances&&(c=await this._getAppearance(e,t,Wr.SAVE,i),c===null&&a===void 0))return;let h=!1;c!=null&&c.needAppearances&&(h=!0,c=null);const{xref:u}=e,d=u.fetchIfRef(this.ref);if(!(d instanceof ue))return;const f=new ue(u);for(const p of d.getKeys())p!=="AP"&&f.set(p,d.getRaw(p));if(a!==void 0&&(f.set("F",a),c===null&&!h)){const p=d.getRaw("AP");p&&f.set("AP",p)}const g={path:this.data.fieldName,value:o},m=this.setValue(f,Array.isArray(o)?o.map(_o):_o(o),u,s);this.amendSavedDict(i,m||f);const b=this._getMKDict(l);if(b&&f.set("MK",b),s.put(this.ref,{data:f,xfa:g,needAppearances:h}),c!==null){const p=u.getNewTemporaryRef(),y=new ue(u);f.set("AP",y),y.set("N",p);const w=this._getSaveFieldResources(u),_=new ta(c),v=_.dict=new ue(u);v.set("Subtype",ve.get("Form")),v.set("Resources",w);const C=l%180===0?[0,0,this.width,this.height]:[0,0,this.height,this.width];v.set("BBox",C);const k=this.getRotationMatrix(i);k!==al&&v.set("Matrix",k),s.put(p,{data:_,xfa:null,needAppearances:!1})}f.set("M",`D:${C0()}`)}async _getAppearance(e,t,i,s){if(this.data.password)return null;const r=s==null?void 0:s.get(this.data.id);let a,o;if(r&&(a=r.formattedValue||r.value,o=r.rotation),o===void 0&&a===void 0&&!this._needAppearances&&(!this._hasValueFromXFA||this.appearance))return null;const l=this.getBorderAndBackgroundAppearances(s);if(a===void 0&&(a=this.data.fieldValue,!a))return`/Tx BMC q ${l}Q EMC`;if(Array.isArray(a)&&a.length===1&&(a=a[0]),qs(typeof a=="string","Expected `value` to be a string."),a=a.trimEnd(),this.data.combo){const M=this.data.options.find(({exportValue:D})=>a===D);a=(M==null?void 0:M.displayValue)||a}if(a==="")return`/Tx BMC q ${l}Q EMC`;o===void 0&&(o=this.rotation);let c=-1,h;this.data.multiLine?(h=a.split(/\r\n?|\n/).map(M=>M.normalize("NFC")),c=h.length):h=[a.replace(/\r\n?|\n/,"").normalize("NFC")];const u=1,d=2;let{width:f,height:g}=this;(o===90||o===270)&&([f,g]=[g,f]),this._defaultAppearance||(this.data.defaultAppearanceData=j4(this._defaultAppearance="/Helvetica 0 Tf 0 g"));let m=await cl._getFontData(e,t,this.data.defaultAppearanceData,this._fieldResources.mergedResources),b,p,y;const w=[];let _=!1;for(const M of h){const D=m.encodeString(M);D.length>1&&(_=!0),w.push(D.join(""))}if(_&&i&Wr.SAVE)return{needAppearances:!0};if(_&&this._isOffscreenCanvasSupported){const M=this.data.comb?"monospace":"sans-serif",D=new Jl(e.xref,M),H=D.createFontResources(h.join("")),R=H.getRaw("Font");if(this._fieldResources.mergedResources.has("Font")){const B=this._fieldResources.mergedResources.get("Font");for(const Z of R.getKeys())B.set(Z,R.getRaw(Z))}else this._fieldResources.mergedResources.set("Font",R);const z=D.fontName.name;m=await cl._getFontData(e,t,{fontName:z,fontSize:0},H);for(let B=0,Z=w.length;B<Z;B++)w[B]=kR(h[B]);const P=Object.assign(Object.create(null),this.data.defaultAppearanceData);this.data.defaultAppearanceData.fontSize=0,this.data.defaultAppearanceData.fontName=z,[b,p,y]=this._computeFontSize(g-2*u,f-2*d,a,m,c),this.data.defaultAppearanceData=P}else this._isOffscreenCanvasSupported||ae("_getAppearance: OffscreenCanvas is not supported, annotation may not render correctly."),[b,p,y]=this._computeFontSize(g-2*u,f-2*d,a,m,c);let v=m.descent;isNaN(v)?v=Wv*y:v=Math.max(Wv*y,Math.abs(v)*p);const C=Math.min(Math.floor((g-p)/2),u),k=this.data.textAlignment;if(this.data.multiLine)return this._getMultilineAppearance(b,w,m,p,f,g,k,d,C,v,y,s);if(this.data.comb)return this._getCombAppearance(b,m,w[0],p,f,g,d,C,v,y,s);const I=C+v;if(k===0||k>2)return`/Tx BMC q ${l}BT `+b+` 1 0 0 1 ${kn(d)} ${kn(I)} Tm (${Ng(w[0])}) Tj ET Q EMC`;const E={shift:0},T=this._renderText(w[0],m,p,f,k,E,d,I);return`/Tx BMC q ${l}BT `+b+` 1 0 0 1 0 0 Tm ${T} ET Q EMC`}static async _getFontData(e,t,i,s){const r=new Pr,a={font:null,clone(){return this}},{fontName:o,fontSize:l}=i;return await e.handleSetFont(s,[o&&ve.get(o),l],null,r,t,a,null),a.font}_getTextWidth(e,t){return Math.sumPrecise(t.charsToGlyphs(e).map(i=>i.width))/1e3}_computeFontSize(e,t,i,s,r){let{fontSize:a}=this.data.defaultAppearanceData,o=(a||12)*d0,l=Math.round(e/o);if(!a){const c=d=>Math.floor(d*100)/100;if(r===-1){const d=this._getTextWidth(i,s);a=c(Math.min(e/d0,t/d)),l=1}else{const d=i.split(/\r\n?|\n/),f=[];for(const m of d){const b=s.encodeString(m).join(""),p=s.charsToGlyphs(b),y=s.getCharPositions(b);f.push({line:b,glyphs:p,positions:y})}const g=m=>{let b=0;for(const p of f){const y=this._splitLine(null,s,m,t,p);if(b+=y.length*m,b>e)return!0}return!1};for(l=Math.max(l,r);;){if(o=e/l,a=c(o/d0),g(a)){l++;continue}break}}const{fontName:h,fontColor:u}=this.data.defaultAppearanceData;this._defaultAppearance=zG({fontSize:a,fontName:h,fontColor:u})}return[this._defaultAppearance,a,e/l]}_renderText(e,t,i,s,r,a,o,l){let c;if(r===1){const u=this._getTextWidth(e,t)*i;c=(s-u)/2}else if(r===2){const u=this._getTextWidth(e,t)*i;c=s-u-o}else c=o;const h=kn(c-a.shift);return a.shift=c,l=kn(l),`${h} ${l} Td (${Ng(e)}) Tj`}_getSaveFieldResources(e){var a;const{localResources:t,appearanceResources:i,acroFormResources:s}=this._fieldResources,r=(a=this.data.defaultAppearanceData)==null?void 0:a.fontName;if(!r)return t||ue.empty;for(const o of[t,i])if(o instanceof ue){const l=o.get("Font");if(l instanceof ue&&l.has(r))return o}if(s instanceof ue){const o=s.get("Font");if(o instanceof ue&&o.has(r)){const l=new ue(e);l.set(r,o.getRaw(r));const c=new ue(e);return c.set("Font",l),ue.merge({xref:e,dictArray:[c,t],mergeSubDicts:!0})}}return t||ue.empty}getFieldObject(){return null}}class GY extends cl{constructor(e){super(e);const{dict:t}=e;t.has("PMD")&&(this.flags|=_i.HIDDEN,this.data.hidden=!0,ae("Barcodes are not supported")),this.data.hasOwnCanvas=this.data.readOnly&&!this.data.noHTML,this._hasText=!0,typeof this.data.fieldValue!="string"&&(this.data.fieldValue="");let i=wo({dict:t,key:"Q"});(!Number.isInteger(i)||i<0||i>2)&&(i=null),this.data.textAlignment=i;let s=wo({dict:t,key:"MaxLen"});(!Number.isInteger(s)||s<0)&&(s=0),this.data.maxLen=s,this.data.multiLine=this.hasFieldFlag(nl.MULTILINE),this.data.comb=this.hasFieldFlag(nl.COMB)&&!this.data.multiLine&&!this.data.password&&!this.hasFieldFlag(nl.FILESELECT)&&this.data.maxLen!==0,this.data.doNotScroll=this.hasFieldFlag(nl.DONOTSCROLL);const{data:{actions:r}}=this;for(const a of(r==null?void 0:r.Keystroke)||[]){const o=a.trim().match(/^AF(Date|Time)_Keystroke(?:Ex)?\(['"]?([^'"]+)['"]?\);$/);if(o){let l=o[2];const c=parseInt(l,10);!isNaN(c)&&Math.floor(Math.log10(c))+1===o[2].length&&(l=(o[1]==="Date"?jG:GG)[c]??l),this.data[o[1]==="Date"?"dateFormat":"timeFormat"]=l;break}}}get hasTextContent(){return!!this.appearance&&!this._needAppearances}_getCombAppearance(e,t,i,s,r,a,o,l,c,h,u){const d=r/this.data.maxLen,f=this.getBorderAndBackgroundAppearances(u),g=[],m=t.getCharPositions(i);for(const[p,y]of m)g.push(`(${Ng(i.substring(p,y))}) Tj`);const b=g.join(` ${kn(d)} 0 Td `);return`/Tx BMC q ${f}BT `+e+` 1 0 0 1 ${kn(o)} ${kn(l+c)} Tm ${b} ET Q EMC`}_getMultilineAppearance(e,t,i,s,r,a,o,l,c,h,u,d){const f=[],g=r-2*l,m={shift:0};for(let y=0,w=t.length;y<w;y++){const _=t[y],v=this._splitLine(_,i,s,g);for(let C=0,k=v.length;C<k;C++){const I=v[C],E=y===0&&C===0?-c-(u-h):-u;f.push(this._renderText(I,i,s,r,o,m,l,E))}}const b=this.getBorderAndBackgroundAppearances(d),p=f.join(`
`);return`/Tx BMC q ${b}BT `+e+` 1 0 0 1 0 ${kn(a)} Tm ${p} ET Q EMC`}_splitLine(e,t,i,s,r={}){e=r.line||e;const a=r.glyphs||t.charsToGlyphs(e);if(a.length<=1)return[e];const o=r.positions||t.getCharPositions(e),l=i/1e3,c=[];let h=-1,u=-1,d=-1,f=0,g=0;for(let m=0,b=a.length;m<b;m++){const[p,y]=o[m],w=a[m],_=w.width*l;w.unicode===" "?g+_>s?(c.push(e.substring(f,p)),f=p,g=_,h=-1,d=-1):(g+=_,h=p,u=y,d=m):g+_>s?h!==-1?(c.push(e.substring(f,u)),f=u,m=d+1,h=-1,g=0):(c.push(e.substring(f,p)),f=p,g=_):g+=_}return f<e.length&&c.push(e.substring(f,e.length)),c}async extractTextContent(e,t,i){await super.extractTextContent(e,t,i);const s=this.data.textContent;if(!s)return;const r=s.join(`
`);if(r===this.data.fieldValue)return;const a=r.replaceAll(/([.*+?^${}()|[\]\\])|(\s+)/g,(o,l)=>l?`\\${l}`:"\\s+");new RegExp(`^\\s*${a}\\s*$`).test(this.data.fieldValue)&&(this.data.textContent=this.data.fieldValue.split(`
`))}getFieldObject(){return{id:this.data.id,value:this.data.fieldValue,defaultValue:this.data.defaultFieldValue||"",multiline:this.data.multiLine,password:this.data.password,charLimit:this.data.maxLen,comb:this.data.comb,editable:!this.data.readOnly,hidden:this.data.hidden,name:this.data.fieldName,rect:this.data.rect,actions:this.data.actions,page:this.data.pageIndex,strokeColor:this.data.borderColor,fillColor:this.data.backgroundColor,rotation:this.rotation,type:"text"}}}class VY extends cl{constructor(e){super(e),this.checkedAppearance=null,this.uncheckedAppearance=null;const t=this.hasFieldFlag(nl.RADIO),i=this.hasFieldFlag(nl.PUSHBUTTON);this.data.checkBox=!t&&!i,this.data.radioButton=t&&!i,this.data.pushButton=i,this.data.isTooltipOnly=!1,this.data.checkBox?this._processCheckBox(e):this.data.radioButton?this._processRadioButton(e):this.data.pushButton?(this.data.hasOwnCanvas=!0,this.data.noHTML=!1,this._processPushButton(e)):ae("Invalid field flags for button widget annotation")}async getOperatorList(e,t,i,s){if(this.data.pushButton)return super.getOperatorList(e,t,i,!1,s);let r=null,a=null;if(s){const l=s.get(this.data.id);r=l?l.value:null,a=l?l.rotation:null}if(r===null&&this.appearance)return super.getOperatorList(e,t,i,s);r==null&&(r=this.data.checkBox?this.data.fieldValue===this.data.exportValue:this.data.fieldValue===this.data.buttonValue);const o=r?this.checkedAppearance:this.uncheckedAppearance;if(o){const l=this.appearance,c=Dh(o.dict.getArray("Matrix"),al);a&&o.dict.set("Matrix",this.getRotationMatrix(s)),this.appearance=o;const h=super.getOperatorList(e,t,i,s);return this.appearance=l,o.dict.set("Matrix",c),h}return{opList:new Pr,separateForm:!1,separateCanvas:!1}}async save(e,t,i,s){if(this.data.checkBox){this._saveCheckbox(e,t,i,s);return}this.data.radioButton&&this._saveRadioButton(e,t,i,s)}async _saveCheckbox(e,t,i,s){if(!i)return;const r=i.get(this.data.id),a=this._buildFlags(r==null?void 0:r.noView,r==null?void 0:r.noPrint);let o=r==null?void 0:r.rotation,l=r==null?void 0:r.value;if(o===void 0&&a===void 0&&(l===void 0||this.data.fieldValue===this.data.exportValue===l))return;let c=e.xref.fetchIfRef(this.ref);if(!(c instanceof ue))return;c=c.clone(),o===void 0&&(o=this.rotation),l===void 0&&(l=this.data.fieldValue===this.data.exportValue);const h={path:this.data.fieldName,value:l?this.data.exportValue:""},u=ve.get(l?this.data.exportValue:"Off");this.setValue(c,u,e.xref,s),c.set("AS",u),c.set("M",`D:${C0()}`),a!==void 0&&c.set("F",a);const d=this._getMKDict(o);d&&c.set("MK",d),s.put(this.ref,{data:c,xfa:h,needAppearances:!1})}async _saveRadioButton(e,t,i,s){if(!i)return;const r=i.get(this.data.id),a=this._buildFlags(r==null?void 0:r.noView,r==null?void 0:r.noPrint);let o=r==null?void 0:r.rotation,l=r==null?void 0:r.value;if(o===void 0&&a===void 0&&(l===void 0||this.data.fieldValue===this.data.buttonValue===l))return;let c=e.xref.fetchIfRef(this.ref);if(!(c instanceof ue))return;c=c.clone(),l===void 0&&(l=this.data.fieldValue===this.data.buttonValue),o===void 0&&(o=this.rotation);const h={path:this.data.fieldName,value:l?this.data.buttonValue:""},u=ve.get(l?this.data.buttonValue:"Off");l&&this.setValue(c,u,e.xref,s),c.set("AS",u),c.set("M",`D:${C0()}`),a!==void 0&&c.set("F",a);const d=this._getMKDict(o);d&&c.set("MK",d),s.put(this.ref,{data:c,xfa:h,needAppearances:!1})}_getDefaultCheckedAppearance(e,t){const{width:i,height:s}=this,r=[0,0,i,s],o=Math.min(i,s)*.8;let l,c;t==="check"?(l={width:.755*o,height:.705*o},c="3"):t==="disc"?(l={width:.791*o,height:.705*o},c="l"):Cn(`_getDefaultCheckedAppearance - unsupported type: ${t}`);const h=kn((i-l.width)/2),u=kn((s-l.height)/2),d=`q BT /PdfJsZaDb ${o} Tf 0 g ${h} ${u} Td (${c}) Tj ET Q`,f=new ue(e.xref);f.set("FormType",1),f.set("Subtype",ve.get("Form")),f.set("Type",ve.get("XObject")),f.set("BBox",r),f.set("Matrix",[1,0,0,1,0,0]),f.set("Length",d.length);const g=new ue(e.xref),m=new ue(e.xref);m.set("PdfJsZaDb",this.fallbackFontDict),g.set("Font",m),f.set("Resources",g),this.checkedAppearance=new ta(d),this.checkedAppearance.dict=f,this._streams.push(this.checkedAppearance)}_processCheckBox(e){const t=e.dict.get("AP");if(!(t instanceof ue))return;const i=t.get("N");if(!(i instanceof ue))return;const s=this._decodeFormValue(e.dict.get("AS"));typeof s=="string"&&(this.data.fieldValue=s);const r=this.data.fieldValue!==null&&this.data.fieldValue!=="Off"?this.data.fieldValue:"Yes",a=this._decodeFormValue(i.getKeys());if(a.length===0)a.push("Off",r);else if(a.length===1)a[0]==="Off"?a.push(r):a.unshift("Off");else if(a.includes(r))a.length=0,a.push("Off",r);else{const c=a.find(h=>h!=="Off");a.length=0,a.push("Off",c)}a.includes(this.data.fieldValue)||(this.data.fieldValue="Off"),this.data.exportValue=a[1];const o=i.get(this.data.exportValue);this.checkedAppearance=o instanceof dn?o:null;const l=i.get("Off");this.uncheckedAppearance=l instanceof dn?l:null,this.checkedAppearance?this._streams.push(this.checkedAppearance):this._getDefaultCheckedAppearance(e,"check"),this.uncheckedAppearance&&this._streams.push(this.uncheckedAppearance),this._fallbackFontDict=this.fallbackFontDict,this.data.defaultFieldValue===null&&(this.data.defaultFieldValue="Off")}_processRadioButton(e){this.data.buttonValue=null;const t=e.dict.get("Parent");if(t instanceof ue){this.parent=e.dict.getRaw("Parent");const o=t.get("V");o instanceof ve&&(this.data.fieldValue=this._decodeFormValue(o))}const i=e.dict.get("AP");if(!(i instanceof ue))return;const s=i.get("N");if(!(s instanceof ue))return;for(const o of s.getKeys())if(o!=="Off"){this.data.buttonValue=this._decodeFormValue(o);break}const r=s.get(this.data.buttonValue);this.checkedAppearance=r instanceof dn?r:null;const a=s.get("Off");this.uncheckedAppearance=a instanceof dn?a:null,this.checkedAppearance?this._streams.push(this.checkedAppearance):this._getDefaultCheckedAppearance(e,"disc"),this.uncheckedAppearance&&this._streams.push(this.uncheckedAppearance),this._fallbackFontDict=this.fallbackFontDict,this.data.defaultFieldValue===null&&(this.data.defaultFieldValue="Off")}_processPushButton(e){const{dict:t,annotationGlobals:i}=e;if(!t.has("A")&&!t.has("AA")&&!this.data.alternativeText){ae("Push buttons without action dictionaries are not supported");return}this.data.isTooltipOnly=!t.has("A")&&!t.has("AA"),t2.parseDestDictionary({destDict:t,resultObj:this.data,docBaseUrl:i.baseUrl,docAttachments:i.attachments})}getFieldObject(){let e="button",t;return this.data.checkBox?(e="checkbox",t=this.data.exportValue):this.data.radioButton&&(e="radiobutton",t=this.data.buttonValue),{id:this.data.id,value:this.data.fieldValue||"Off",defaultValue:this.data.defaultFieldValue,exportValues:t,editable:!this.data.readOnly,name:this.data.fieldName,rect:this.data.rect,hidden:this.data.hidden,actions:this.data.actions,page:this.data.pageIndex,strokeColor:this.data.borderColor,fillColor:this.data.backgroundColor,rotation:this.rotation,type:e}}get fallbackFontDict(){const e=new ue;return e.set("BaseFont",ve.get("ZapfDingbats")),e.set("Type",ve.get("FallbackType")),e.set("Subtype",ve.get("FallbackType")),e.set("Encoding",ve.get("ZapfDingbatsEncoding")),We(this,"fallbackFontDict",e)}}class qY extends cl{constructor(e){var r;super(e);const{dict:t,xref:i}=e;this.indices=t.getArray("I"),this.hasIndices=Array.isArray(this.indices)&&this.indices.length>0,this.data.options=[];const s=wo({dict:t,key:"Opt"});if(Array.isArray(s))for(let a=0,o=s.length;a<o;a++){const l=i.fetchIfRef(s[a]),c=Array.isArray(l);this.data.options[a]={exportValue:this._decodeFormValue(c?i.fetchIfRef(l[0]):l),displayValue:this._decodeFormValue(c?i.fetchIfRef(l[1]):l)}}if(!this.hasIndices)typeof this.data.fieldValue=="string"?this.data.fieldValue=[this.data.fieldValue]:(r=this.data).fieldValue||(r.fieldValue=[]);else{this.data.fieldValue=[];const a=this.data.options.length;for(const o of this.indices)Number.isInteger(o)&&o>=0&&o<a&&this.data.fieldValue.push(this.data.options[o].exportValue)}this.data.options.length===0&&this.data.fieldValue.length>0&&(this.data.options=this.data.fieldValue.map(a=>({exportValue:a,displayValue:a}))),this.data.combo=this.hasFieldFlag(nl.COMBO),this.data.multiSelect=this.hasFieldFlag(nl.MULTISELECT),this._hasText=!0}getFieldObject(){const e=this.data.combo?"combobox":"listbox",t=this.data.fieldValue.length>0?this.data.fieldValue[0]:null;return{id:this.data.id,value:t,defaultValue:this.data.defaultFieldValue,editable:!this.data.readOnly,name:this.data.fieldName,rect:this.data.rect,numItems:this.data.fieldValue.length,multipleSelection:this.data.multiSelect,hidden:this.data.hidden,actions:this.data.actions,items:this.data.options,page:this.data.pageIndex,strokeColor:this.data.borderColor,fillColor:this.data.backgroundColor,rotation:this.rotation,type:e}}amendSavedDict(e,t){var a;if(!this.hasIndices)return;let i=(a=e==null?void 0:e.get(this.data.id))==null?void 0:a.value;Array.isArray(i)||(i=[i]);const s=[],{options:r}=this.data;for(let o=0,l=0,c=r.length;o<c;o++)r[o].exportValue===i[l]&&(s.push(o),l+=1);t.set("I",s)}async _getAppearance(e,t,i,s){if(this.data.combo)return super._getAppearance(e,t,i,s);let r,a;const o=s==null?void 0:s.get(this.data.id);if(o&&(a=o.rotation,r=o.value),a===void 0&&r===void 0&&!this._needAppearances)return null;r===void 0?r=this.data.fieldValue:Array.isArray(r)||(r=[r]);const l=1,c=2;let{width:h,height:u}=this;(a===90||a===270)&&([h,u]=[u,h]);const d=this.data.options.length,f=[];for(let I=0;I<d;I++){const{exportValue:E}=this.data.options[I];r.includes(E)&&f.push(I)}this._defaultAppearance||(this.data.defaultAppearanceData=j4(this._defaultAppearance="/Helvetica 0 Tf 0 g"));const g=await cl._getFontData(e,t,this.data.defaultAppearanceData,this._fieldResources.mergedResources);let m,{fontSize:b}=this.data.defaultAppearanceData;if(b)m=this._defaultAppearance;else{const I=(u-l)/d;let E=-1,T;for(const{displayValue:M}of this.data.options){const D=this._getTextWidth(M,g);D>E&&(E=D,T=M)}[m,b]=this._computeFontSize(I,h-2*c,T,g,-1)}const p=b*d0,y=(p-b)/2,w=Math.floor(u/p);let _=0;if(f.length>0){const I=Math.min(...f),E=Math.max(...f);_=Math.max(0,E-w+1),_>I&&(_=I)}const v=Math.min(_+w+1,d),C=["/Tx BMC q",`1 1 ${h} ${u} re W n`];if(f.length){C.push("0.600006 0.756866 0.854904 rg");for(const I of f)_<=I&&I<v&&C.push(`1 ${u-(I-_+1)*p} ${h} ${p} re f`)}C.push("BT",m,`1 0 0 1 0 ${u} Tm`);const k={shift:0};for(let I=_;I<v;I++){const{displayValue:E}=this.data.options[I],T=I===_?y:0;C.push(this._renderText(E,g,b,h,0,k,c,-p+T))}return C.push("ET Q EMC"),C.join(`
`)}}class hP extends cl{constructor(e){super(e),this.data.fieldValue=null,this.data.hasOwnCanvas=this.data.noRotate,this.data.noHTML=!this.data.hasOwnCanvas}getFieldObject(){return{id:this.data.id,value:null,page:this.data.pageIndex,type:"signature"}}}class WY extends _a{constructor(e){super(e),this.data.noRotate=!0,this.data.hasOwnCanvas=this.data.noRotate,this.data.noHTML=!1;const{dict:i}=e;this.data.annotationType=Qs.TEXT,this.data.hasAppearance?this.data.name="NoIcon":(this.data.rect[1]=this.data.rect[3]-22,this.data.rect[2]=this.data.rect[0]+22,this.data.name=i.has("Name")?i.get("Name").name:"Note"),i.has("State")?(this.data.state=i.get("State")||null,this.data.stateModel=i.get("StateModel")||null):(this.data.state=null,this.data.stateModel=null)}}class KY extends Sx{constructor(e){var r;super(e);const{dict:t,annotationGlobals:i}=e;this.data.annotationType=Qs.LINK,this.data.noHTML=!1;const s=Ax(t,this.rectangle);s&&(this.data.quadPoints=s),(r=this.data).borderColor||(r.borderColor=this.data.color),t2.parseDestDictionary({destDict:t,resultObj:this.data,docBaseUrl:i.baseUrl,docAttachments:i.attachments})}}class uP extends Sx{constructor(e){super(e);const{dict:t}=e;this.data.annotationType=Qs.POPUP,this.data.noHTML=!1,(this.width===0||this.height===0)&&(this.data.rect=null);let i=t.get("Parent");if(!i){ae("Popup annotation has a missing or invalid parent annotation.");return}this.data.parentRect=A0(i.getArray("Rect"),null);const s=i.get("RT");if(Li(s,E7.GROUP)&&(i=i.get("IRT")),i.has("M")?(this.setModificationDate(i.get("M")),this.data.modificationDate=this.modificationDate):this.data.modificationDate=null,i.has("C")?(this.setColor(i.getArray("C")),this.data.color=this.color):this.data.color=null,!this.viewable){const r=i.get("F");this._isViewable(r)&&this.setFlags(r)}this.setTitle(i.get("T")),this.data.titleObj=this._title,this.setContents(i.get("Contents")),this.data.contentsObj=this._contents,i.has("RC")&&(this.data.richText=Cx.getRichTextAsHtml(i.get("RC"))),this.data.open=!!t.get("Open")}}class Vw extends _a{constructor(e){var r;super(e),this.data.hasOwnCanvas=this.data.noRotate,this.data.isEditable=!this.data.noHTML,this.data.noHTML=!1;const{annotationGlobals:t,evaluatorOptions:i,xref:s}=e;if(this.data.annotationType=Qs.FREETEXT,this.setDefaultAppearance(e),this._hasAppearance=!!this.appearance,this._hasAppearance){const{fontColor:a,fontSize:o}=HG(this.appearance,i,s,t.globalColorSpaceCache);this.data.defaultAppearanceData.fontColor=a,this.data.defaultAppearanceData.fontSize=o||10}else{(r=this.data.defaultAppearanceData).fontSize||(r.fontSize=10);const{fontColor:a,fontSize:o}=this.data.defaultAppearanceData;if(this._contents.str){this.data.textContent=this._contents.str.split(/\r\n?|\n/).map(u=>u.trimEnd());const{coords:l,bbox:c,matrix:h}=Jl.getFirstPositionInfo(this.rectangle,this.rotation,o);this.data.textPosition=this._transformPoint(l,c,h)}if(this._isOffscreenCanvasSupported){const l=e.dict.get("CA"),c=new Jl(s,"sans-serif");this.appearance=c.createAppearance(this._contents.str,this.rectangle,this.rotation,o,a,l),this._streams.push(this.appearance)}else ae("FreeTextAnnotation: OffscreenCanvas is not supported, annotation may not render correctly.")}}get hasTextContent(){return this._hasAppearance}static createNewDict(e,t,{apRef:i,ap:s}){const{color:r,fontSize:a,oldAnnotation:o,rect:l,rotation:c,user:h,value:u}=e,d=o||new ue(t);d.set("Type",ve.get("Annot")),d.set("Subtype",ve.get("FreeText")),o?(d.set("M",`D:${C0()}`),d.delete("RC")):d.set("CreationDate",`D:${C0()}`),d.set("Rect",l);const f=`/Helv ${a} Tf ${hc(r,!0)}`;if(d.set("DA",f),d.set("Contents",_o(u)),d.set("F",4),d.set("Border",[0,0,0]),d.set("Rotate",c),h&&d.set("T",_o(h)),i||s){const g=new ue(t);d.set("AP",g),i?g.set("N",i):g.set("N",s)}return d}static async createNewAppearanceStream(e,t,i){const{baseFontRef:s,evaluator:r,task:a}=i,{color:o,fontSize:l,rect:c,rotation:h,value:u}=e,d=new ue(t),f=new ue(t);if(s)f.set("Helv",s);else{const he=new ue(t);he.set("BaseFont",ve.get("Helvetica")),he.set("Type",ve.get("Font")),he.set("Subtype",ve.get("Type1")),he.set("Encoding",ve.get("WinAnsiEncoding")),f.set("Helv",he)}d.set("Font",f);const g=await cl._getFontData(r,a,{fontName:"Helv",fontSize:l},d),[m,b,p,y]=c;let w=p-m,_=y-b;h%180!==0&&([w,_]=[_,w]);const v=u.split(`
`),C=l/1e3;let k=-1/0;const I=[];for(let he of v){const de=g.encodeString(he);if(de.length>1)return null;he=de.join(""),I.push(he);let ge=0;const N=g.charsToGlyphs(he);for(const K of N)ge+=K.width*C;k=Math.max(k,ge)}let E=1;k>w&&(E=w/k);let T=1;const M=d0*l,D=(d0-M3)*l,H=M*v.length;H>_&&(T=_/H);const R=Math.min(E,T),z=l*R;let P,B,Z;switch(h){case 0:Z=[1,0,0,1],B=[c[0],c[1],w,_],P=[c[0],c[3]-D];break;case 90:Z=[0,1,-1,0],B=[c[1],-c[2],w,_],P=[c[1],-c[0]-D];break;case 180:Z=[-1,0,0,-1],B=[-c[2],-c[3],w,_],P=[-c[2],-c[1]-D];break;case 270:Z=[0,-1,1,0],B=[-c[3],c[0],w,_],P=[-c[3],c[2]-D];break}const G=["q",`${Z.join(" ")} 0 0 cm`,`${B.join(" ")} re W n`,"BT",`${hc(o,!0)}`,`0 Tc /Helv ${kn(z)} Tf`];G.push(`${P.join(" ")} Td (${Ng(I[0])}) Tj`);const Y=kn(M);for(let he=1,de=I.length;he<de;he++){const ge=I[he];G.push(`0 -${Y} Td (${Ng(ge)}) Tj`)}G.push("ET","Q");const J=G.join(`
`),se=new ue(t);se.set("FormType",1),se.set("Subtype",ve.get("Form")),se.set("Type",ve.get("XObject")),se.set("BBox",c),se.set("Resources",d),se.set("Matrix",[1,0,0,1,-c[0],-c[1]]);const fe=new ta(J);return fe.dict=se,fe}}class XY extends _a{constructor(e){super(e);const{dict:t,xref:i}=e;this.data.annotationType=Qs.LINE,this.data.hasOwnCanvas=this.data.noRotate,this.data.noHTML=!1;const s=F7(t.getArray("L"),[0,0,0,0]);if(this.data.lineCoordinates=Ln.normalizeRect(s),this.setLineEndings(t.getArray("LE")),this.data.lineEndings=this.lineEndings,!this.appearance){const r=this.color?Or(this.color):[0,0,0],a=t.get("CA"),o=d1(t.getArray("IC"),null),l=o?Or(o):null,c=l?a:null,h=this.borderStyle.width||1,u=2*h,d=[this.data.lineCoordinates[0]-u,this.data.lineCoordinates[1]-u,this.data.lineCoordinates[2]+u,this.data.lineCoordinates[3]+u];Ln.intersect(this.rectangle,d)||(this.rectangle=d),this._setDefaultAppearance({xref:i,extra:`${h} w`,strokeColor:r,fillColor:l,strokeAlpha:a,fillAlpha:c,pointsCallback:(f,g)=>(f.push(`${s[0]} ${s[1]} m`,`${s[2]} ${s[3]} l`,"S"),[g[0]-h,g[7]-h,g[2]+h,g[3]+h])})}}}class YY extends _a{constructor(e){super(e);const{dict:t,xref:i}=e;if(this.data.annotationType=Qs.SQUARE,this.data.hasOwnCanvas=this.data.noRotate,this.data.noHTML=!1,!this.appearance){const s=this.color?Or(this.color):[0,0,0],r=t.get("CA"),a=d1(t.getArray("IC"),null),o=a?Or(a):null,l=o?r:null;if(this.borderStyle.width===0&&!o)return;this._setDefaultAppearance({xref:i,extra:`${this.borderStyle.width} w`,strokeColor:s,fillColor:o,strokeAlpha:r,fillAlpha:l,pointsCallback:(c,h)=>{const u=h[4]+this.borderStyle.width/2,d=h[5]+this.borderStyle.width/2,f=h[6]-h[4]-this.borderStyle.width,g=h[3]-h[7]-this.borderStyle.width;return c.push(`${u} ${d} ${f} ${g} re`),o?c.push("B"):c.push("S"),[h[0],h[7],h[2],h[3]]}})}}}class JY extends _a{constructor(e){super(e);const{dict:t,xref:i}=e;if(this.data.annotationType=Qs.CIRCLE,!this.appearance){const s=this.color?Or(this.color):[0,0,0],r=t.get("CA"),a=d1(t.getArray("IC"),null),o=a?Or(a):null,l=o?r:null;if(this.borderStyle.width===0&&!o)return;const c=4/3*Math.tan(Math.PI/(2*4));this._setDefaultAppearance({xref:i,extra:`${this.borderStyle.width} w`,strokeColor:s,fillColor:o,strokeAlpha:r,fillAlpha:l,pointsCallback:(h,u)=>{const d=u[0]+this.borderStyle.width/2,f=u[1]-this.borderStyle.width/2,g=u[6]-this.borderStyle.width/2,m=u[7]+this.borderStyle.width/2,b=d+(g-d)/2,p=f+(m-f)/2,y=(g-d)/2*c,w=(m-f)/2*c;return h.push(`${b} ${m} m`,`${b+y} ${m} ${g} ${p+w} ${g} ${p} c`,`${g} ${p-w} ${b+y} ${f} ${b} ${f} c`,`${b-y} ${f} ${d} ${p-w} ${d} ${p} c`,`${d} ${p+w} ${b-y} ${m} ${b} ${m} c`,"h"),o?h.push("B"):h.push("S"),[u[0],u[7],u[2],u[3]]}})}}}class dP extends _a{constructor(e){super(e);const{dict:t,xref:i}=e;this.data.annotationType=Qs.POLYLINE,this.data.hasOwnCanvas=this.data.noRotate,this.data.noHTML=!1,this.data.vertices=null,this instanceof fP||(this.setLineEndings(t.getArray("LE")),this.data.lineEndings=this.lineEndings);const s=t.getArray("Vertices");if(!Yr(s,null))return;const r=this.data.vertices=Float32Array.from(s);if(!this.appearance){const a=this.color?Or(this.color):[0,0,0],o=t.get("CA"),l=this.borderStyle.width||1,c=2*l,h=[1/0,1/0,-1/0,-1/0];for(let u=0,d=r.length;u<d;u+=2)Ln.rectBoundingBox(r[u]-c,r[u+1]-c,r[u]+c,r[u+1]+c,h);Ln.intersect(this.rectangle,h)||(this.rectangle=h),this._setDefaultAppearance({xref:i,extra:`${l} w`,strokeColor:a,strokeAlpha:o,pointsCallback:(u,d)=>{for(let f=0,g=r.length;f<g;f+=2)u.push(`${r[f]} ${r[f+1]} ${f===0?"m":"l"}`);return u.push("S"),[d[0],d[7],d[2],d[3]]}})}}}class fP extends dP{constructor(e){super(e),this.data.annotationType=Qs.POLYGON}}class ZY extends _a{constructor(e){super(e),this.data.annotationType=Qs.CARET}}class Km extends _a{constructor(e){super(e),this.data.hasOwnCanvas=this.data.noRotate,this.data.noHTML=!1;const{dict:t,xref:i}=e;this.data.annotationType=Qs.INK,this.data.inkLists=[],this.data.isEditable=!this.data.noHTML,this.data.noHTML=!1,this.data.opacity=t.get("CA")||1;const s=t.getArray("InkList");if(Array.isArray(s)){for(let r=0,a=s.length;r<a;++r){if(!Array.isArray(s[r]))continue;const o=new Float32Array(s[r].length);this.data.inkLists.push(o);for(let l=0,c=s[r].length;l<c;l+=2){const h=i.fetchIfRef(s[r][l]),u=i.fetchIfRef(s[r][l+1]);typeof h=="number"&&typeof u=="number"&&(o[l]=h,o[l+1]=u)}}if(!this.appearance){const r=this.color?Or(this.color):[0,0,0],a=t.get("CA"),o=this.borderStyle.width||1,l=2*o,c=[1/0,1/0,-1/0,-1/0];for(const h of this.data.inkLists)for(let u=0,d=h.length;u<d;u+=2)Ln.rectBoundingBox(h[u]-l,h[u+1]-l,h[u]+l,h[u+1]+l,c);Ln.intersect(this.rectangle,c)||(this.rectangle=c),this._setDefaultAppearance({xref:i,extra:`${o} w`,strokeColor:r,strokeAlpha:a,pointsCallback:(h,u)=>{for(const d of this.data.inkLists){for(let f=0,g=d.length;f<g;f+=2)h.push(`${d[f]} ${d[f+1]} ${f===0?"m":"l"}`);h.push("S")}return[u[0],u[7],u[2],u[3]]}})}}}static createNewDict(e,t,{apRef:i,ap:s}){const{oldAnnotation:r,color:a,opacity:o,paths:l,outlines:c,rect:h,rotation:u,thickness:d,user:f}=e,g=r||new ue(t);g.set("Type",ve.get("Annot")),g.set("Subtype",ve.get("Ink")),g.set(r?"M":"CreationDate",`D:${C0()}`),g.set("Rect",h),g.set("InkList",(c==null?void 0:c.points)||l.points),g.set("F",4),g.set("Rotate",u),f&&g.set("T",_o(f)),c&&g.set("IT",ve.get("InkHighlight"));const m=new ue(t);g.set("BS",m),m.set("W",d),g.set("C",Or(a)),g.set("CA",o);const b=new ue(t);return g.set("AP",b),i?b.set("N",i):b.set("N",s),g}static async createNewAppearanceStream(e,t,i){if(e.outlines)return this.createNewAppearanceStreamForHighlight(e,t,i);const{color:s,rect:r,paths:a,thickness:o,opacity:l}=e,c=[`${o} w 1 J 1 j`,`${hc(s,!1)}`];l!==1&&c.push("/R0 gs");for(const f of a.lines){c.push(`${kn(f[4])} ${kn(f[5])} m`);for(let g=6,m=f.length;g<m;g+=6)if(isNaN(f[g]))c.push(`${kn(f[g+4])} ${kn(f[g+5])} l`);else{const[b,p,y,w,_,v]=f.slice(g,g+6);c.push([b,p,y,w,_,v].map(kn).join(" ")+" c")}f.length===6&&c.push(`${kn(f[4])} ${kn(f[5])} l`)}c.push("S");const h=c.join(`
`),u=new ue(t);if(u.set("FormType",1),u.set("Subtype",ve.get("Form")),u.set("Type",ve.get("XObject")),u.set("BBox",r),u.set("Length",h.length),l!==1){const f=new ue(t),g=new ue(t),m=new ue(t);m.set("CA",l),m.set("Type",ve.get("ExtGState")),g.set("R0",m),f.set("ExtGState",g),u.set("Resources",f)}const d=new ta(h);return d.dict=u,d}static async createNewAppearanceStreamForHighlight(e,t,i){const{color:s,rect:r,outlines:{outline:a},opacity:o}=e,l=[`${hc(s,!0)}`,"/R0 gs"];l.push(`${kn(a[4])} ${kn(a[5])} m`);for(let m=6,b=a.length;m<b;m+=6)if(isNaN(a[m]))l.push(`${kn(a[m+4])} ${kn(a[m+5])} l`);else{const[p,y,w,_,v,C]=a.slice(m,m+6);l.push([p,y,w,_,v,C].map(kn).join(" ")+" c")}l.push("h f");const c=l.join(`
`),h=new ue(t);h.set("FormType",1),h.set("Subtype",ve.get("Form")),h.set("Type",ve.get("XObject")),h.set("BBox",r),h.set("Length",c.length);const u=new ue(t),d=new ue(t);u.set("ExtGState",d),h.set("Resources",u);const f=new ue(t);d.set("R0",f),f.set("BM",ve.get("Multiply")),o!==1&&(f.set("ca",o),f.set("Type",ve.get("ExtGState")));const g=new ta(c);return g.dict=h,g}}class qw extends _a{constructor(e){var r;super(e);const{dict:t,xref:i}=e;if(this.data.annotationType=Qs.HIGHLIGHT,this.data.isEditable=!this.data.noHTML,this.data.noHTML=!1,this.data.opacity=t.get("CA")||1,this.data.quadPoints=Ax(t,null)){const a=(r=this.appearance)==null?void 0:r.dict.get("Resources");if(!this.appearance||!(a!=null&&a.has("ExtGState"))){this.appearance&&ae("HighlightAnnotation - ignoring built-in appearance stream.");const o=this.color?Or(this.color):[1,1,0],l=t.get("CA");this._setDefaultAppearance({xref:i,fillColor:o,blendMode:"Multiply",fillAlpha:l,pointsCallback:(c,h)=>(c.push(`${h[0]} ${h[1]} m`,`${h[2]} ${h[3]} l`,`${h[6]} ${h[7]} l`,`${h[4]} ${h[5]} l`,"f"),[h[0],h[7],h[2],h[3]])})}}else this.data.popupRef=null}get overlaysTextContent(){return!0}static createNewDict(e,t,{apRef:i,ap:s}){const{color:r,oldAnnotation:a,opacity:o,rect:l,rotation:c,user:h,quadPoints:u}=e,d=a||new ue(t);if(d.set("Type",ve.get("Annot")),d.set("Subtype",ve.get("Highlight")),d.set(a?"M":"CreationDate",`D:${C0()}`),d.set("CreationDate",`D:${C0()}`),d.set("Rect",l),d.set("F",4),d.set("Border",[0,0,0]),d.set("Rotate",c),d.set("QuadPoints",u),d.set("C",Or(r)),d.set("CA",o),h&&d.set("T",_o(h)),i||s){const f=new ue(t);d.set("AP",f),f.set("N",i||s)}return d}static async createNewAppearanceStream(e,t,i){const{color:s,rect:r,outlines:a,opacity:o}=e,l=[`${hc(s,!0)}`,"/R0 gs"],c=[];for(const b of a){c.length=0,c.push(`${kn(b[0])} ${kn(b[1])} m`);for(let p=2,y=b.length;p<y;p+=2)c.push(`${kn(b[p])} ${kn(b[p+1])} l`);c.push("h"),l.push(c.join(`
`))}l.push("f*");const h=l.join(`
`),u=new ue(t);u.set("FormType",1),u.set("Subtype",ve.get("Form")),u.set("Type",ve.get("XObject")),u.set("BBox",r),u.set("Length",h.length);const d=new ue(t),f=new ue(t);d.set("ExtGState",f),u.set("Resources",d);const g=new ue(t);f.set("R0",g),g.set("BM",ve.get("Multiply")),o!==1&&(g.set("ca",o),g.set("Type",ve.get("ExtGState")));const m=new ta(h);return m.dict=u,m}}class QY extends _a{constructor(e){super(e);const{dict:t,xref:i}=e;if(this.data.annotationType=Qs.UNDERLINE,this.data.quadPoints=Ax(t,null)){if(!this.appearance){const r=this.color?Or(this.color):[0,0,0],a=t.get("CA");this._setDefaultAppearance({xref:i,extra:"[] 0 d 0.571 w",strokeColor:r,strokeAlpha:a,pointsCallback:(o,l)=>(o.push(`${l[4]} ${l[5]+1.3} m`,`${l[6]} ${l[7]+1.3} l`,"S"),[l[0],l[7],l[2],l[3]])})}}else this.data.popupRef=null}get overlaysTextContent(){return!0}}class $Y extends _a{constructor(e){super(e);const{dict:t,xref:i}=e;if(this.data.annotationType=Qs.SQUIGGLY,this.data.quadPoints=Ax(t,null)){if(!this.appearance){const r=this.color?Or(this.color):[0,0,0],a=t.get("CA");this._setDefaultAppearance({xref:i,extra:"[] 0 d 1 w",strokeColor:r,strokeAlpha:a,pointsCallback:(o,l)=>{const c=(l[1]-l[5])/6;let h=c,u=l[4];const d=l[5],f=l[6];o.push(`${u} ${d+h} m`);do u+=2,h=h===0?c:0,o.push(`${u} ${d+h} l`);while(u<f);return o.push("S"),[l[4],d-2*c,f,d+2*c]}})}}else this.data.popupRef=null}get overlaysTextContent(){return!0}}class eJ extends _a{constructor(e){super(e);const{dict:t,xref:i}=e;if(this.data.annotationType=Qs.STRIKEOUT,this.data.quadPoints=Ax(t,null)){if(!this.appearance){const r=this.color?Or(this.color):[0,0,0],a=t.get("CA");this._setDefaultAppearance({xref:i,extra:"[] 0 d 1 w",strokeColor:r,strokeAlpha:a,pointsCallback:(o,l)=>(o.push(`${(l[0]+l[4])/2} ${(l[1]+l[5])/2} m`,`${(l[2]+l[6])/2} ${(l[3]+l[7])/2} l`,"S"),[l[0],l[7],l[2],l[3]])})}}else this.data.popupRef=null}get overlaysTextContent(){return!0}}var Hd,X5,gP;class pu extends _a{constructor(t){super(t);U(this,Hd,null);this.data.annotationType=Qs.STAMP,this.data.hasOwnCanvas=this.data.noRotate,this.data.isEditable=!this.data.noHTML,this.data.noHTML=!1}mustBeViewedWhenEditing(t,i=null){return t?(this.data.isEditable&&(x(this,Hd)??O(this,Hd,this.data.hasOwnCanvas),this.data.hasOwnCanvas=!0),!0):(x(this,Hd)!==null&&(this.data.hasOwnCanvas=x(this,Hd),O(this,Hd,null)),!(i!=null&&i.has(this.data.id)))}static async createImage(t,i){const{width:s,height:r}=t,a=new OffscreenCanvas(s,r),o=a.getContext("2d",{alpha:!0});o.drawImage(t,0,0);const l=o.getImageData(0,0,s,r).data,c=new Uint32Array(l.buffer),h=c.some(ya.isLittleEndian?p=>p>>>24!==255:p=>(p&255)!==255);h&&(o.fillStyle="white",o.fillRect(0,0,s,r),o.drawImage(t,0,0));const u=a.convertToBlob({type:"image/jpeg",quality:1}).then(p=>p.arrayBuffer()),d=ve.get("XObject"),f=ve.get("Image"),g=new ue(i);g.set("Type",d),g.set("Subtype",f),g.set("BitsPerComponent",8),g.set("ColorSpace",ve.get("DeviceRGB")),g.set("Filter",ve.get("DCTDecode")),g.set("BBox",[0,0,s,r]),g.set("Width",s),g.set("Height",r);let m=null;if(h){const p=new Uint8Array(c.length);if(ya.isLittleEndian)for(let w=0,_=c.length;w<_;w++)p[w]=c[w]>>>24;else for(let w=0,_=c.length;w<_;w++)p[w]=c[w]&255;const y=new ue(i);y.set("Type",d),y.set("Subtype",f),y.set("BitsPerComponent",8),y.set("ColorSpace",ve.get("DeviceGray")),y.set("Width",s),y.set("Height",r),m=new ji(p,0,0,y)}return{imageStream:new ji(await u,0,0,g),smaskStream:m,width:s,height:r}}static createNewDict(t,i,{apRef:s,ap:r}){const{oldAnnotation:a,rect:o,rotation:l,user:c}=t,h=a||new ue(i);if(h.set("Type",ve.get("Annot")),h.set("Subtype",ve.get("Stamp")),h.set(a?"M":"CreationDate",`D:${C0()}`),h.set("Rect",o),h.set("F",4),h.set("Border",[0,0,0]),h.set("Rotate",l),c&&h.set("T",_o(c)),s||r){const u=new ue(i);h.set("AP",u),s?u.set("N",s):u.set("N",r)}return h}static async createNewAppearanceStream(t,i,s){if(t.oldAnnotation)return null;if(t.isSignature)return F(this,X5,gP).call(this,t,i);const{rotation:r}=t,{imageRef:a,width:o,height:l}=s.image,c=new ue(i),h=new ue(i);c.set("XObject",h),h.set("Im0",a);const u=`q ${o} 0 0 ${l} 0 0 cm /Im0 Do Q`,d=new ue(i);if(d.set("FormType",1),d.set("Subtype",ve.get("Form")),d.set("Type",ve.get("XObject")),d.set("BBox",[0,0,o,l]),d.set("Resources",c),r){const g=D3(r,o,l);d.set("Matrix",g)}const f=new ta(u);return f.dict=d,f}}Hd=new WeakMap,X5=new WeakSet,gP=async function(t,i){const{areContours:s,color:r,rect:a,lines:o,thickness:l}=t,c=[`${l} w 1 J 1 j`,`${hc(r,s)}`];for(const f of o){c.push(`${kn(f[4])} ${kn(f[5])} m`);for(let g=6,m=f.length;g<m;g+=6)if(isNaN(f[g]))c.push(`${kn(f[g+4])} ${kn(f[g+5])} l`);else{const[b,p,y,w,_,v]=f.slice(g,g+6);c.push([b,p,y,w,_,v].map(kn).join(" ")+" c")}f.length===6&&c.push(`${kn(f[4])} ${kn(f[5])} l`)}c.push(s?"F":"S");const h=c.join(`
`),u=new ue(i);u.set("FormType",1),u.set("Subtype",ve.get("Form")),u.set("Type",ve.get("XObject")),u.set("BBox",a),u.set("Length",h.length);const d=new ta(h);return d.dict=u,d},U(pu,X5);class tJ extends _a{constructor(e){super(e);const{dict:t,xref:i}=e,s=new c6(t.get("FS"),i);this.data.annotationType=Qs.FILEATTACHMENT,this.data.hasOwnCanvas=this.data.noRotate,this.data.noHTML=!1,this.data.file=s.serializable;const r=t.get("Name");this.data.name=r instanceof ve?Rn(r.name):"PushPin";const a=t.get("ca");this.data.fillAlpha=typeof a=="number"&&a>=0&&a<=1?a:null}}const nJ={get r(){return We(this,"r",new Uint8Array([7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21]))},get k(){return We(this,"k",new Int32Array([-680876936,-389564586,606105819,-1044525330,-176418897,1200080426,-1473231341,-45705983,1770035416,-1958414417,-42063,-1990404162,1804603682,-40341101,-1502002290,1236535329,-165796510,-1069501632,643717713,-373897302,-701558691,38016083,-660478335,-405537848,568446438,-1019803690,-187363961,1163531501,-1444681467,-51403784,1735328473,-1926607734,-378558,-2022574463,1839030562,-35309556,-1530992060,1272893353,-155497632,-1094730640,681279174,-358537222,-722521979,76029189,-640364487,-421815835,530742520,-995338651,-198630844,1126891415,-1416354905,-57434055,1700485571,-1894986606,-1051523,-2054922799,1873313359,-30611744,-1560198380,1309151649,-145523070,-1120210379,718787259,-343485551]))}};function B0(n,e,t){let i=1732584193,s=-271733879,r=-1732584194,a=271733878;const o=t+72&-64,l=new Uint8Array(o);let c,h;for(c=0;c<t;++c)l[c]=n[e++];l[c++]=128;const u=o-8;c<u&&(c=u),l[c++]=t<<3&255,l[c++]=t>>5&255,l[c++]=t>>13&255,l[c++]=t>>21&255,l[c++]=t>>>29&255,c+=3;const d=new Int32Array(16),{k:f,r:g}=nJ;for(c=0;c<o;){for(h=0;h<16;++h,c+=4)d[h]=l[c]|l[c+1]<<8|l[c+2]<<16|l[c+3]<<24;let m=i,b=s,p=r,y=a,w,_;for(h=0;h<64;++h){h<16?(w=b&p|~b&y,_=h):h<32?(w=y&b|~y&p,_=5*h+1&15):h<48?(w=b^p^y,_=3*h+5&15):(w=p^(b|~y),_=7*h&15);const v=y,C=m+w+f[h]+d[_]|0,k=g[h];y=p,p=b,b=b+(C<<k|C>>>32-k)|0,m=v}i=i+m|0,s=s+b|0,r=r+p|0,a=a+y|0}return new Uint8Array([i&255,i>>8&255,i>>16&255,i>>>24&255,s&255,s>>8&255,s>>16&255,s>>>24&255,r&255,r>>8&255,r>>16&255,r>>>24&255,a&255,a>>8&255,a>>16&255,a>>>24&255])}function wC(n){try{return Vp(n)}catch(e){return ae(`UTF-8 decoding failed: "${e}".`),n}}class iJ extends uy{constructor(e){super(e),this.node=null}onEndElement(e){const t=super.onEndElement(e);if(t&&e==="xfa:datasets")throw this.node=t,new Error("Aborting DatasetXMLParser.")}}class sJ{constructor(e){if(e.datasets)this.node=new uy({hasAttributes:!0}).parseFromString(e.datasets).documentElement;else{const t=new iJ({hasAttributes:!0});try{t.parseFromString(e["xdp:xdp"])}catch{}this.node=t.node}}getValue(e){if(!this.node||!e)return"";const t=this.node.searchNode(wR(e),0);if(!t)return"";const i=t.firstChild;return(i==null?void 0:i.nodeName)==="value"?t.children.map(s=>wC(s.textContent)):wC(t.textContent)}}var rx,Eh,Th,Rh,Mh,ax,Tg,Ph,zd,jd,Y5,mP;class rJ{constructor(e){U(this,Y5);U(this,rx);U(this,Eh,1/0);U(this,Th,1/0);U(this,Rh,-1/0);U(this,Mh,-1/0);U(this,ax);U(this,Tg,[]);U(this,Ph,[]);U(this,zd,-1);U(this,jd,!1);O(this,rx,e);const t=O(this,ax,e.data.quadPoints);for(let i=0,s=t.length;i<s;i+=8)O(this,Eh,Math.min(x(this,Eh),t[i])),O(this,Rh,Math.max(x(this,Rh),t[i+2])),O(this,Th,Math.min(x(this,Th),t[i+5])),O(this,Mh,Math.max(x(this,Mh),t[i+1]))}overlaps(e){return!(x(this,Eh)>=x(e,Rh)||x(this,Rh)<=x(e,Eh)||x(this,Th)>=x(e,Mh)||x(this,Mh)<=x(e,Th))}addGlyph(e,t,i){return F(this,Y5,mP).call(this,e,t)?(x(this,Ph).length>0&&(x(this,Tg).push(x(this,Ph).join("")),x(this,Ph).length=0),x(this,Tg).push(i),O(this,jd,!0),!0):(this.disableExtraChars(),!1)}addExtraChar(e){x(this,jd)&&x(this,Ph).push(e)}disableExtraChars(){x(this,jd)&&(O(this,jd,!1),x(this,Ph).length=0)}setText(){x(this,rx).data.overlaidText=x(this,Tg).join("")}}rx=new WeakMap,Eh=new WeakMap,Th=new WeakMap,Rh=new WeakMap,Mh=new WeakMap,ax=new WeakMap,Tg=new WeakMap,Ph=new WeakMap,zd=new WeakMap,jd=new WeakMap,Y5=new WeakSet,mP=function(e,t){if(x(this,Eh)>=e||x(this,Rh)<=e||x(this,Th)>=t||x(this,Mh)<=t)return!1;const i=x(this,ax);if(i.length===8)return!0;if(x(this,zd)>=0){const s=x(this,zd);if(!(i[s]>=e||i[s+2]<=e||i[s+5]>=t||i[s+1]<=t))return!0;O(this,zd,-1)}for(let s=0,r=i.length;s<r;s+=8)if(!(i[s]>=e||i[s+2]<=e||i[s+5]>=t||i[s+1]<=t))return O(this,zd,s),!0;return!1};var s0;class aJ{constructor(e){U(this,s0,new Map);for(const t of e){if(!t.data.quadPoints)continue;const i=new rJ(t);for(const[s,r]of x(this,s0))s.overlaps(i)&&(r?r.add(i):x(this,s0).set(s,new Set([i])));x(this,s0).set(i,null)}}addGlyph(e,t,i,s){const r=e[4]+t/2,a=e[5]+i/2;let o;for(const[l,c]of x(this,s0)){if(o){o.has(l)?l.addGlyph(r,a,s):l.disableExtraChars();continue}l.addGlyph(r,a,s)&&(o=c)}}addExtraChar(e){for(const t of x(this,s0).keys())t.addExtraChar(e)}setText(){for(const e of x(this,s0).keys())e.setText()}}s0=new WeakMap;class et{constructor(e,t){this.high=e|0,this.low=t|0}and(e){this.high&=e.high,this.low&=e.low}xor(e){this.high^=e.high,this.low^=e.low}shiftRight(e){e>=32?(this.low=this.high>>>e-32|0,this.high=0):(this.low=this.low>>>e|this.high<<32-e,this.high=this.high>>>e|0)}rotateRight(e){let t,i;e&32?(i=this.low,t=this.high):(t=this.low,i=this.high),e&=31,this.low=t>>>e|i<<32-e,this.high=i>>>e|t<<32-e}not(){this.high=~this.high,this.low=~this.low}add(e){const t=(this.low>>>0)+(e.low>>>0);let i=(this.high>>>0)+(e.high>>>0);t>4294967295&&(i+=1),this.low=t|0,this.high=i|0}copyTo(e,t){e[t]=this.high>>>24&255,e[t+1]=this.high>>16&255,e[t+2]=this.high>>8&255,e[t+3]=this.high&255,e[t+4]=this.low>>>24&255,e[t+5]=this.low>>16&255,e[t+6]=this.low>>8&255,e[t+7]=this.low&255}assign(e){this.high=e.high,this.low=e.low}}const oJ={get k(){return We(this,"k",[new et(1116352408,3609767458),new et(1899447441,602891725),new et(3049323471,3964484399),new et(3921009573,2173295548),new et(961987163,4081628472),new et(1508970993,3053834265),new et(2453635748,2937671579),new et(2870763221,3664609560),new et(3624381080,2734883394),new et(310598401,1164996542),new et(607225278,1323610764),new et(1426881987,3590304994),new et(1925078388,4068182383),new et(2162078206,991336113),new et(2614888103,633803317),new et(3248222580,3479774868),new et(3835390401,2666613458),new et(4022224774,944711139),new et(264347078,2341262773),new et(604807628,2007800933),new et(770255983,1495990901),new et(1249150122,1856431235),new et(1555081692,3175218132),new et(1996064986,2198950837),new et(2554220882,3999719339),new et(2821834349,766784016),new et(2952996808,2566594879),new et(3210313671,3203337956),new et(3336571891,1034457026),new et(3584528711,2466948901),new et(113926993,3758326383),new et(338241895,168717936),new et(666307205,1188179964),new et(773529912,1546045734),new et(1294757372,1522805485),new et(1396182291,2643833823),new et(1695183700,2343527390),new et(1986661051,1014477480),new et(2177026350,1206759142),new et(2456956037,344077627),new et(2730485921,1290863460),new et(2820302411,3158454273),new et(3259730800,3505952657),new et(3345764771,106217008),new et(3516065817,3606008344),new et(3600352804,1432725776),new et(4094571909,1467031594),new et(275423344,851169720),new et(430227734,3100823752),new et(506948616,1363258195),new et(659060556,3750685593),new et(883997877,3785050280),new et(958139571,3318307427),new et(1322822218,3812723403),new et(1537002063,2003034995),new et(1747873779,3602036899),new et(1955562222,1575990012),new et(2024104815,1125592928),new et(2227730452,2716904306),new et(2361852424,442776044),new et(2428436474,593698344),new et(2756734187,3733110249),new et(3204031479,2999351573),new et(3329325298,3815920427),new et(3391569614,3928383900),new et(3515267271,566280711),new et(3940187606,3454069534),new et(4118630271,4000239992),new et(116418474,1914138554),new et(174292421,2731055270),new et(289380356,3203993006),new et(460393269,320620315),new et(685471733,587496836),new et(852142971,1086792851),new et(1017036298,365543100),new et(1126000580,2618297676),new et(1288033470,3409855158),new et(1501505948,4234509866),new et(1607167915,987167468),new et(1816402316,1246189591)])}};function lJ(n,e,t,i,s){n.assign(e),n.and(t),s.assign(e),s.not(),s.and(i),n.xor(s)}function cJ(n,e,t,i,s){n.assign(e),n.and(t),s.assign(e),s.and(i),n.xor(s),s.assign(t),s.and(i),n.xor(s)}function hJ(n,e,t){n.assign(e),n.rotateRight(28),t.assign(e),t.rotateRight(34),n.xor(t),t.assign(e),t.rotateRight(39),n.xor(t)}function uJ(n,e,t){n.assign(e),n.rotateRight(14),t.assign(e),t.rotateRight(18),n.xor(t),t.assign(e),t.rotateRight(41),n.xor(t)}function dJ(n,e,t){n.assign(e),n.rotateRight(1),t.assign(e),t.rotateRight(8),n.xor(t),t.assign(e),t.shiftRight(7),n.xor(t)}function fJ(n,e,t){n.assign(e),n.rotateRight(19),t.assign(e),t.rotateRight(61),n.xor(t),t.assign(e),t.shiftRight(6),n.xor(t)}function pP(n,e,t,i=!1){let s,r,a,o,l,c,h,u;i?(s=new et(3418070365,3238371032),r=new et(1654270250,914150663),a=new et(2438529370,812702999),o=new et(355462360,4144912697),l=new et(1731405415,4290775857),c=new et(2394180231,1750603025),h=new et(3675008525,1694076839),u=new et(1203062813,3204075428)):(s=new et(1779033703,4089235720),r=new et(3144134277,2227873595),a=new et(1013904242,4271175723),o=new et(2773480762,1595750129),l=new et(1359893119,2917565137),c=new et(2600822924,725511199),h=new et(528734635,4215389547),u=new et(1541459225,327033209));const d=Math.ceil((t+17)/128)*128,f=new Uint8Array(d);let g,m;for(g=0;g<t;++g)f[g]=n[e++];f[g++]=128;const b=d-16;g<b&&(g=b),g+=11,f[g++]=t>>>29&255,f[g++]=t>>21&255,f[g++]=t>>13&255,f[g++]=t>>5&255,f[g++]=t<<3&255;const p=new Array(80);for(g=0;g<80;g++)p[g]=new et(0,0);const{k:y}=oJ;let w=new et(0,0),_=new et(0,0),v=new et(0,0),C=new et(0,0),k=new et(0,0),I=new et(0,0),E=new et(0,0),T=new et(0,0);const M=new et(0,0),D=new et(0,0),H=new et(0,0),R=new et(0,0);let z;for(g=0;g<d;){for(m=0;m<16;++m)p[m].high=f[g]<<24|f[g+1]<<16|f[g+2]<<8|f[g+3],p[m].low=f[g+4]<<24|f[g+5]<<16|f[g+6]<<8|f[g+7],g+=8;for(m=16;m<80;++m)z=p[m],fJ(z,p[m-2],R),z.add(p[m-7]),dJ(H,p[m-15],R),z.add(H),z.add(p[m-16]);for(w.assign(s),_.assign(r),v.assign(a),C.assign(o),k.assign(l),I.assign(c),E.assign(h),T.assign(u),m=0;m<80;++m)M.assign(T),uJ(H,k,R),M.add(H),lJ(H,k,I,E,R),M.add(H),M.add(y[m]),M.add(p[m]),hJ(D,w,R),cJ(H,w,_,v,R),D.add(H),z=T,T=E,E=I,I=k,C.add(M),k=C,C=v,v=_,_=w,z.assign(M),z.add(D),w=z;s.add(w),r.add(_),a.add(v),o.add(C),l.add(k),c.add(I),h.add(E),u.add(T)}let P;return i?(P=new Uint8Array(48),s.copyTo(P,0),r.copyTo(P,8),a.copyTo(P,16),o.copyTo(P,24),l.copyTo(P,32),c.copyTo(P,40)):(P=new Uint8Array(64),s.copyTo(P,0),r.copyTo(P,8),a.copyTo(P,16),o.copyTo(P,24),l.copyTo(P,32),c.copyTo(P,40),h.copyTo(P,48),u.copyTo(P,56)),P}function gJ(n,e,t){return pP(n,e,t,!0)}const mJ={get k(){return We(this,"k",[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298])}};function ac(n,e){return n>>>e|n<<32-e}function pJ(n,e,t){return n&e^~n&t}function bJ(n,e,t){return n&e^n&t^e&t}function xJ(n){return ac(n,2)^ac(n,13)^ac(n,22)}function yJ(n){return ac(n,6)^ac(n,11)^ac(n,25)}function wJ(n){return ac(n,7)^ac(n,18)^n>>>3}function _J(n){return ac(n,17)^ac(n,19)^n>>>10}function C6(n,e,t){let i=1779033703,s=3144134277,r=1013904242,a=2773480762,o=1359893119,l=2600822924,c=528734635,h=1541459225;const u=Math.ceil((t+9)/64)*64,d=new Uint8Array(u);let f,g;for(f=0;f<t;++f)d[f]=n[e++];d[f++]=128;const m=u-8;f<m&&(f=m),f+=3,d[f++]=t>>>29&255,d[f++]=t>>21&255,d[f++]=t>>13&255,d[f++]=t>>5&255,d[f++]=t<<3&255;const b=new Uint32Array(64),{k:p}=mJ;for(f=0;f<u;){for(g=0;g<16;++g)b[g]=d[f]<<24|d[f+1]<<16|d[f+2]<<8|d[f+3],f+=4;for(g=16;g<64;++g)b[g]=_J(b[g-2])+b[g-7]+wJ(b[g-15])+b[g-16]|0;let y=i,w=s,_=r,v=a,C=o,k=l,I=c,E=h,T,M;for(g=0;g<64;++g)T=E+yJ(C)+pJ(C,k,I)+p[g]+b[g],M=xJ(y)+bJ(y,w,_),E=I,I=k,k=C,C=v+T|0,v=_,_=w,w=y,y=T+M|0;i=i+y|0,s=s+w|0,r=r+_|0,a=a+v|0,o=o+C|0,l=l+k|0,c=c+I|0,h=h+E|0}return new Uint8Array([i>>24&255,i>>16&255,i>>8&255,i&255,s>>24&255,s>>16&255,s>>8&255,s&255,r>>24&255,r>>16&255,r>>8&255,r&255,a>>24&255,a>>16&255,a>>8&255,a&255,o>>24&255,o>>16&255,o>>8&255,o&255,l>>24&255,l>>16&255,l>>8&255,l&255,c>>24&255,c>>16&255,c>>8&255,c&255,h>>24&255,h>>16&255,h>>8&255,h&255])}const _C=512;class vJ extends na{constructor(e,t,i){super(t),this.str=e,this.dict=e.dict,this.decrypt=i,this.nextChunk=null,this.initialized=!1}readBlock(){var o;let e;if(this.initialized?e=this.nextChunk:(e=this.str.getBytes(_C),this.initialized=!0),!(e!=null&&e.length)){this.eof=!0;return}this.nextChunk=this.str.getBytes(_C);const t=((o=this.nextChunk)==null?void 0:o.length)>0,i=this.decrypt;e=i(e,!t);const s=this.bufferLength,r=s+e.length;this.ensureBuffer(r).set(e,s),this.bufferLength=r}}class cu{constructor(e){this.a=0,this.b=0;const t=new Uint8Array(256),i=e.length;for(let s=0;s<256;++s)t[s]=s;for(let s=0,r=0;s<256;++s){const a=t[s];r=r+a+e[s%i]&255,t[s]=t[r],t[r]=a}this.s=t}encryptBlock(e){let t=this.a,i=this.b;const s=this.s,r=e.length,a=new Uint8Array(r);for(let o=0;o<r;++o){t=t+1&255;const l=s[t];i=i+l&255;const c=s[i];s[t]=c,s[i]=l,a[o]=e[o]^s[l+c&255]}return this.a=t,this.b=i,a}decryptBlock(e){return this.encryptBlock(e)}encrypt(e){return this.encryptBlock(e)}}class kJ{decryptBlock(e){return e}encrypt(e){return e}}class r_{constructor(){Ue(this,"_s",new Uint8Array([99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22]));Ue(this,"_inv_s",new Uint8Array([82,9,106,213,48,54,165,56,191,64,163,158,129,243,215,251,124,227,57,130,155,47,255,135,52,142,67,68,196,222,233,203,84,123,148,50,166,194,35,61,238,76,149,11,66,250,195,78,8,46,161,102,40,217,36,178,118,91,162,73,109,139,209,37,114,248,246,100,134,104,152,22,212,164,92,204,93,101,182,146,108,112,72,80,253,237,185,218,94,21,70,87,167,141,157,132,144,216,171,0,140,188,211,10,247,228,88,5,184,179,69,6,208,44,30,143,202,63,15,2,193,175,189,3,1,19,138,107,58,145,17,65,79,103,220,234,151,242,207,206,240,180,230,115,150,172,116,34,231,173,53,133,226,249,55,232,28,117,223,110,71,241,26,113,29,41,197,137,111,183,98,14,170,24,190,27,252,86,62,75,198,210,121,32,154,219,192,254,120,205,90,244,31,221,168,51,136,7,199,49,177,18,16,89,39,128,236,95,96,81,127,169,25,181,74,13,45,229,122,159,147,201,156,239,160,224,59,77,174,42,245,176,200,235,187,60,131,83,153,97,23,43,4,126,186,119,214,38,225,105,20,99,85,33,12,125]));Ue(this,"_mix",new Uint32Array([0,235474187,470948374,303765277,941896748,908933415,607530554,708780849,1883793496,2118214995,1817866830,1649639237,1215061108,1181045119,1417561698,1517767529,3767586992,4003061179,4236429990,4069246893,3635733660,3602770327,3299278474,3400528769,2430122216,2664543715,2362090238,2193862645,2835123396,2801107407,3035535058,3135740889,3678124923,3576870512,3341394285,3374361702,3810496343,3977675356,4279080257,4043610186,2876494627,2776292904,3076639029,3110650942,2472011535,2640243204,2403728665,2169303058,1001089995,899835584,666464733,699432150,59727847,226906860,530400753,294930682,1273168787,1172967064,1475418501,1509430414,1942435775,2110667444,1876241833,1641816226,2910219766,2743034109,2976151520,3211623147,2505202138,2606453969,2302690252,2269728455,3711829422,3543599269,3240894392,3475313331,3843699074,3943906441,4178062228,4144047775,1306967366,1139781709,1374988112,1610459739,1975683434,2076935265,1775276924,1742315127,1034867998,866637845,566021896,800440835,92987698,193195065,429456164,395441711,1984812685,2017778566,1784663195,1683407248,1315562145,1080094634,1383856311,1551037884,101039829,135050206,437757123,337553864,1042385657,807962610,573804783,742039012,2531067453,2564033334,2328828971,2227573024,2935566865,2700099354,3001755655,3168937228,3868552805,3902563182,4203181171,4102977912,3736164937,3501741890,3265478751,3433712980,1106041591,1340463100,1576976609,1408749034,2043211483,2009195472,1708848333,1809054150,832877231,1068351396,766945465,599762354,159417987,126454664,361929877,463180190,2709260871,2943682380,3178106961,3009879386,2572697195,2538681184,2236228733,2336434550,3509871135,3745345300,3441850377,3274667266,3910161971,3877198648,4110568485,4211818798,2597806476,2497604743,2261089178,2295101073,2733856160,2902087851,3202437046,2968011453,3936291284,3835036895,4136440770,4169408201,3535486456,3702665459,3467192302,3231722213,2051518780,1951317047,1716890410,1750902305,1113818384,1282050075,1584504582,1350078989,168810852,67556463,371049330,404016761,841739592,1008918595,775550814,540080725,3969562369,3801332234,4035489047,4269907996,3569255213,3669462566,3366754619,3332740144,2631065433,2463879762,2160117071,2395588676,2767645557,2868897406,3102011747,3069049960,202008497,33778362,270040487,504459436,875451293,975658646,675039627,641025152,2084704233,1917518562,1615861247,1851332852,1147550661,1248802510,1484005843,1451044056,933301370,967311729,733156972,632953703,260388950,25965917,328671808,496906059,1206477858,1239443753,1543208500,1441952575,2144161806,1908694277,1675577880,1842759443,3610369226,3644379585,3408119516,3307916247,4011190502,3776767469,4077384432,4245618683,2809771154,2842737049,3144396420,3043140495,2673705150,2438237621,2203032232,2370213795]));Ue(this,"_mixCol",new Uint8Array(256).map((e,t)=>t<128?t<<1:t<<1^27));this.buffer=new Uint8Array(16),this.bufferPosition=0}_expandKey(e){Cn("Cannot call `_expandKey` on the base class")}_decrypt(e,t){let i,s,r;const a=new Uint8Array(16);a.set(e);for(let o=0,l=this._keySize;o<16;++o,++l)a[o]^=t[l];for(let o=this._cyclesOfRepetition-1;o>=1;--o){i=a[13],a[13]=a[9],a[9]=a[5],a[5]=a[1],a[1]=i,i=a[14],s=a[10],a[14]=a[6],a[10]=a[2],a[6]=i,a[2]=s,i=a[15],s=a[11],r=a[7],a[15]=a[3],a[11]=i,a[7]=s,a[3]=r;for(let l=0;l<16;++l)a[l]=this._inv_s[a[l]];for(let l=0,c=o*16;l<16;++l,++c)a[l]^=t[c];for(let l=0;l<16;l+=4){const c=this._mix[a[l]],h=this._mix[a[l+1]],u=this._mix[a[l+2]],d=this._mix[a[l+3]];i=c^h>>>8^h<<24^u>>>16^u<<16^d>>>24^d<<8,a[l]=i>>>24&255,a[l+1]=i>>16&255,a[l+2]=i>>8&255,a[l+3]=i&255}}i=a[13],a[13]=a[9],a[9]=a[5],a[5]=a[1],a[1]=i,i=a[14],s=a[10],a[14]=a[6],a[10]=a[2],a[6]=i,a[2]=s,i=a[15],s=a[11],r=a[7],a[15]=a[3],a[11]=i,a[7]=s,a[3]=r;for(let o=0;o<16;++o)a[o]=this._inv_s[a[o]],a[o]^=t[o];return a}_encrypt(e,t){const i=this._s;let s,r,a;const o=new Uint8Array(16);o.set(e);for(let l=0;l<16;++l)o[l]^=t[l];for(let l=1;l<this._cyclesOfRepetition;l++){for(let c=0;c<16;++c)o[c]=i[o[c]];a=o[1],o[1]=o[5],o[5]=o[9],o[9]=o[13],o[13]=a,a=o[2],r=o[6],o[2]=o[10],o[6]=o[14],o[10]=a,o[14]=r,a=o[3],r=o[7],s=o[11],o[3]=o[15],o[7]=a,o[11]=r,o[15]=s;for(let c=0;c<16;c+=4){const h=o[c],u=o[c+1],d=o[c+2],f=o[c+3];s=h^u^d^f,o[c]^=s^this._mixCol[h^u],o[c+1]^=s^this._mixCol[u^d],o[c+2]^=s^this._mixCol[d^f],o[c+3]^=s^this._mixCol[f^h]}for(let c=0,h=l*16;c<16;++c,++h)o[c]^=t[h]}for(let l=0;l<16;++l)o[l]=i[o[l]];a=o[1],o[1]=o[5],o[5]=o[9],o[9]=o[13],o[13]=a,a=o[2],r=o[6],o[2]=o[10],o[6]=o[14],o[10]=a,o[14]=r,a=o[3],r=o[7],s=o[11],o[3]=o[15],o[7]=a,o[11]=r,o[15]=s;for(let l=0,c=this._keySize;l<16;++l,++c)o[l]^=t[c];return o}_decryptBlock2(e,t){const i=e.length;let s=this.buffer,r=this.bufferPosition;const a=[];let o=this.iv;for(let h=0;h<i;++h){if(s[r]=e[h],++r,r<16)continue;const u=this._decrypt(s,this._key);for(let d=0;d<16;++d)u[d]^=o[d];o=s,a.push(u),s=new Uint8Array(16),r=0}if(this.buffer=s,this.bufferLength=r,this.iv=o,a.length===0)return new Uint8Array(0);let l=16*a.length;if(t){const h=a.at(-1);let u=h[15];if(u<=16){for(let d=15,f=16-u;d>=f;--d)if(h[d]!==u){u=0;break}l-=u,a[a.length-1]=h.subarray(0,16-u)}}const c=new Uint8Array(l);for(let h=0,u=0,d=a.length;h<d;++h,u+=16)c.set(a[h],u);return c}decryptBlock(e,t,i=null){const s=e.length,r=this.buffer;let a=this.bufferPosition;if(i)this.iv=i;else{for(let o=0;a<16&&o<s;++o,++a)r[a]=e[o];if(a<16)return this.bufferLength=a,new Uint8Array(0);this.iv=r,e=e.subarray(16)}return this.buffer=new Uint8Array(16),this.bufferLength=0,this.decryptBlock=this._decryptBlock2,this.decryptBlock(e,t)}encrypt(e,t){const i=e.length;let s=this.buffer,r=this.bufferPosition;const a=[];t||(t=new Uint8Array(16));for(let c=0;c<i;++c){if(s[r]=e[c],++r,r<16)continue;for(let u=0;u<16;++u)s[u]^=t[u];const h=this._encrypt(s,this._key);t=h,a.push(h),s=new Uint8Array(16),r=0}if(this.buffer=s,this.bufferLength=r,this.iv=t,a.length===0)return new Uint8Array(0);const o=16*a.length,l=new Uint8Array(o);for(let c=0,h=0,u=a.length;c<u;++c,h+=16)l.set(a[c],h);return l}}class bP extends r_{constructor(t){super();Ue(this,"_rcon",new Uint8Array([141,1,2,4,8,16,32,64,128,27,54,108,216,171,77,154,47,94,188,99,198,151,53,106,212,179,125,250,239,197,145,57,114,228,211,189,97,194,159,37,74,148,51,102,204,131,29,58,116,232,203,141,1,2,4,8,16,32,64,128,27,54,108,216,171,77,154,47,94,188,99,198,151,53,106,212,179,125,250,239,197,145,57,114,228,211,189,97,194,159,37,74,148,51,102,204,131,29,58,116,232,203,141,1,2,4,8,16,32,64,128,27,54,108,216,171,77,154,47,94,188,99,198,151,53,106,212,179,125,250,239,197,145,57,114,228,211,189,97,194,159,37,74,148,51,102,204,131,29,58,116,232,203,141,1,2,4,8,16,32,64,128,27,54,108,216,171,77,154,47,94,188,99,198,151,53,106,212,179,125,250,239,197,145,57,114,228,211,189,97,194,159,37,74,148,51,102,204,131,29,58,116,232,203,141,1,2,4,8,16,32,64,128,27,54,108,216,171,77,154,47,94,188,99,198,151,53,106,212,179,125,250,239,197,145,57,114,228,211,189,97,194,159,37,74,148,51,102,204,131,29,58,116,232,203,141]));this._cyclesOfRepetition=10,this._keySize=160,this._key=this._expandKey(t)}_expandKey(t){const s=this._s,r=this._rcon,a=new Uint8Array(176);a.set(t);for(let o=16,l=1;o<176;++l){let c=a[o-3],h=a[o-2],u=a[o-1],d=a[o-4];c=s[c],h=s[h],u=s[u],d=s[d],c^=r[l];for(let f=0;f<4;++f)a[o]=c^=a[o-16],o++,a[o]=h^=a[o-16],o++,a[o]=u^=a[o-16],o++,a[o]=d^=a[o-16],o++}return a}}class A6 extends r_{constructor(e){super(),this._cyclesOfRepetition=14,this._keySize=224,this._key=this._expandKey(e)}_expandKey(e){const i=this._s,s=new Uint8Array(240);s.set(e);let r=1,a,o,l,c;for(let h=32,u=1;h<240;++u){h%32===16?(a=i[a],o=i[o],l=i[l],c=i[c]):h%32===0&&(a=s[h-3],o=s[h-2],l=s[h-1],c=s[h-4],a=i[a],o=i[o],l=i[l],c=i[c],a^=r,(r<<=1)>=256&&(r=(r^27)&255));for(let d=0;d<4;++d)s[h]=a^=s[h-32],h++,s[h]=o^=s[h-32],h++,s[h]=l^=s[h-32],h++,s[h]=c^=s[h-32],h++}return s}}class xP{_hash(e,t,i){Cn("Abstract method `_hash` called")}checkOwnerPassword(e,t,i,s){const r=new Uint8Array(e.length+56);r.set(e,0),r.set(t,e.length),r.set(i,e.length+t.length);const a=this._hash(e,r,i);return qp(a,s)}checkUserPassword(e,t,i){const s=new Uint8Array(e.length+8);s.set(e,0),s.set(t,e.length);const r=this._hash(e,s,[]);return qp(r,i)}getOwnerKey(e,t,i,s){const r=new Uint8Array(e.length+56);r.set(e,0),r.set(t,e.length),r.set(i,e.length+t.length);const a=this._hash(e,r,i);return new A6(a).decryptBlock(s,!1,new Uint8Array(16))}getUserKey(e,t,i){const s=new Uint8Array(e.length+8);s.set(e,0),s.set(t,e.length);const r=this._hash(e,s,[]);return new A6(r).decryptBlock(i,!1,new Uint8Array(16))}}class CJ extends xP{_hash(e,t,i){return C6(t,0,t.length)}}class AJ extends xP{_hash(e,t,i){let s=C6(t,0,t.length).subarray(0,32),r=[0],a=0;for(;a<64||r.at(-1)>a-32;){const o=e.length+s.length+i.length,l=new Uint8Array(o);let c=0;l.set(e,c),c+=e.length,l.set(s,c),c+=s.length,l.set(i,c);const h=new Uint8Array(o*64);for(let f=0,g=0;f<64;f++,g+=o)h.set(l,g);r=new bP(s.subarray(0,16)).encrypt(h,s.subarray(16,32));const d=Math.sumPrecise(r.slice(0,16))%3;d===0?s=C6(r,0,r.length):d===1?s=gJ(r,0,r.length):d===2&&(s=pP(r,0,r.length)),a++}return s.subarray(0,32)}}class vC{constructor(e,t){this.StringCipherConstructor=e,this.StreamCipherConstructor=t}createStream(e,t){const i=new this.StreamCipherConstructor;return new vJ(e,t,function(r,a){return i.decryptBlock(r,a)})}decryptString(e){const t=new this.StringCipherConstructor;let i=gr(e);return i=t.decryptBlock(i,!0),xa(i)}encryptString(e){const t=new this.StringCipherConstructor;if(t instanceof r_){const r=16-e.length%16;e+=String.fromCharCode(r).repeat(r);const a=new Uint8Array(16);crypto.getRandomValues(a);let o=gr(e);o=t.encrypt(o,a);const l=new Uint8Array(16+o.length);return l.set(a),l.set(o,16),xa(l)}let i=gr(e);return i=t.encrypt(i),xa(i)}}var Nr,yP,I6,wP,m3,E6;const $f=class $f{constructor(e,t,i){U(this,Nr);const s=e.get("Filter");if(!Li(s,"Standard"))throw new Te("unknown encryption method");this.filterName=s.name,this.dict=e;const r=e.get("V");if(!Number.isInteger(r)||r!==1&&r!==2&&r!==4&&r!==5)throw new Te("unsupported encryption algorithm");this.algorithm=r;let a=e.get("Length");if(!a)if(r<=3)a=40;else{const p=e.get("CF"),y=e.get("StmF");if(p instanceof ue&&y instanceof ve){p.suppressEncryption=!0;const w=p.get(y.name);a=(w==null?void 0:w.get("Length"))||128,a<40&&(a<<=3)}}if(!Number.isInteger(a)||a<40||a%8!==0)throw new Te("invalid key length");const o=gr(e.get("O")),l=gr(e.get("U")),c=o.subarray(0,32),h=l.subarray(0,32),u=e.get("P"),d=e.get("R"),f=(r===4||r===5)&&e.get("EncryptMetadata")!==!1;this.encryptMetadata=f;const g=gr(t);let m;if(i){if(d===6)try{i=R7(i)}catch{ae("CipherTransformFactory: Unable to convert UTF8 encoded password.")}m=gr(i)}let b;if(r!==5)b=F(this,Nr,I6).call(this,g,m,c,h,u,d,a,f);else{const p=o.subarray(32,40),y=o.subarray(40,48),w=l.subarray(0,48),_=l.subarray(32,40),v=l.subarray(40,48),C=gr(e.get("OE")),k=gr(e.get("UE")),I=gr(e.get("Perms"));b=F(this,Nr,yP).call(this,d,m,c,p,y,w,h,_,v,C,k,I)}if(!b){if(!i)throw new jp("No password given",Xv.NEED_PASSWORD);const p=F(this,Nr,wP).call(this,m,c,d,a);b=F(this,Nr,I6).call(this,g,p,c,h,u,d,a,f)}if(!b)throw new jp("Incorrect Password",Xv.INCORRECT_PASSWORD);if(r===4&&b.length<16?(this.encryptionKey=new Uint8Array(16),this.encryptionKey.set(b)):this.encryptionKey=b,r>=4){const p=e.get("CF");p instanceof ue&&(p.suppressEncryption=!0),this.cf=p,this.stmf=e.get("StmF")||ve.get("Identity"),this.strf=e.get("StrF")||ve.get("Identity"),this.eff=e.get("EFF")||this.stmf}}static get _defaultPasswordBytes(){return We(this,"_defaultPasswordBytes",new Uint8Array([40,191,78,94,78,117,138,65,100,0,78,86,255,250,1,8,46,46,0,182,208,104,62,128,47,12,169,254,100,83,105,122]))}createCipherTransform(e,t){if(this.algorithm===4||this.algorithm===5)return new vC(F(this,Nr,E6).call(this,this.cf,this.strf,e,t,this.encryptionKey),F(this,Nr,E6).call(this,this.cf,this.stmf,e,t,this.encryptionKey));const i=F(this,Nr,m3).call(this,e,t,this.encryptionKey,!1),s=function(){return new cu(i)};return new vC(s,s)}};Nr=new WeakSet,yP=function(e,t,i,s,r,a,o,l,c,h,u,d){if(t){const g=Math.min(127,t.length);t=t.subarray(0,g)}else t=[];const f=e===6?new AJ:new CJ;return f.checkUserPassword(t,l,o)?f.getUserKey(t,c,u):t.length&&f.checkOwnerPassword(t,s,a,i)?f.getOwnerKey(t,r,a,h):null},I6=function(e,t,i,s,r,a,o,l){const c=40+i.length+e.length,h=new Uint8Array(c);let u=0,d,f;if(t)for(f=Math.min(32,t.length);u<f;++u)h[u]=t[u];for(d=0;u<32;)h[u++]=$f._defaultPasswordBytes[d++];h.set(i,u),u+=i.length,h[u++]=r&255,h[u++]=r>>8&255,h[u++]=r>>16&255,h[u++]=r>>>24&255,h.set(e,u),u+=e.length,a>=4&&!l&&(h.fill(255,u,u+4),u+=4);let g=B0(h,0,u);const m=o>>3;if(a>=3)for(d=0;d<50;++d)g=B0(g,0,m);const b=g.subarray(0,m);let p,y;if(a>=3){u=0,h.set($f._defaultPasswordBytes,u),u+=32,h.set(e,u),u+=e.length,p=new cu(b),y=p.encryptBlock(B0(h,0,u)),f=b.length;const w=new Uint8Array(f);for(d=1;d<=19;++d){for(let _=0;_<f;++_)w[_]=b[_]^d;p=new cu(w),y=p.encryptBlock(y)}}else p=new cu(b),y=p.encryptBlock($f._defaultPasswordBytes);return y.every((w,_)=>s[_]===w)?b:null},wP=function(e,t,i,s){const r=new Uint8Array(32);let a=0;const o=Math.min(32,e.length);for(;a<o;++a)r[a]=e[a];let l=0;for(;a<32;)r[a++]=$f._defaultPasswordBytes[l++];let c=B0(r,0,a);const h=s>>3;if(i>=3)for(l=0;l<50;++l)c=B0(c,0,c.length);let u,d;if(i>=3){d=t;const f=new Uint8Array(h);for(l=19;l>=0;l--){for(let g=0;g<h;++g)f[g]=c[g]^l;u=new cu(f),d=u.encryptBlock(d)}}else u=new cu(c.subarray(0,h)),d=u.encryptBlock(t);return d},m3=function(e,t,i,s=!1){const r=i.length,a=new Uint8Array(r+9);a.set(i);let o=r;return a[o++]=e&255,a[o++]=e>>8&255,a[o++]=e>>16&255,a[o++]=t&255,a[o++]=t>>8&255,s&&(a[o++]=115,a[o++]=65,a[o++]=108,a[o++]=84),B0(a,0,o).subarray(0,Math.min(r+5,16))},E6=function(e,t,i,s,r){if(!(t instanceof ve))throw new Te("Invalid crypt filter name.");const a=this,o=e.get(t.name),l=o==null?void 0:o.get("CFM");if(!l||l.name==="None")return function(){return new kJ};if(l.name==="V2")return function(){var c;return new cu(F(c=a,Nr,m3).call(c,i,s,r,!1))};if(l.name==="AESV2")return function(){var c;return new bP(F(c=a,Nr,m3).call(c,i,s,r,!0))};if(l.name==="AESV3")return function(){return new A6(r)};throw new Te("Unknown crypto method")};let S6=$f;var ox;class SJ{constructor(e,t){U(this,ox,null);this.stream=e,this.pdfManager=t,this.entries=[],this._xrefStms=new Set,this._cacheMap=new Map,this._pendingRefs=new ts,this._newPersistentRefNum=null,this._newTemporaryRefNum=null,this._persistentRefsCache=null}getNewPersistentRef(e){this._newPersistentRefNum===null&&(this._newPersistentRefNum=this.entries.length||1);const t=this._newPersistentRefNum++;return this._cacheMap.set(t,e),tt.get(t,0)}getNewTemporaryRef(){if(this._newTemporaryRefNum===null&&(this._newTemporaryRefNum=this.entries.length||1,this._newPersistentRefNum)){this._persistentRefsCache=new Map;for(let e=this._newTemporaryRefNum;e<this._newPersistentRefNum;e++)this._persistentRefsCache.set(e,this._cacheMap.get(e)),this._cacheMap.delete(e)}return tt.get(this._newTemporaryRefNum++,0)}resetNewTemporaryRef(){if(this._newTemporaryRefNum=null,this._persistentRefsCache)for(const[e,t]of this._persistentRefsCache)this._cacheMap.set(e,t);this._persistentRefsCache=null}setStartXRef(e){this.startXRefQueue=[e]}parse(e=!1){let t;e?(ae("Indexing all PDF objects"),t=this.indexObjects()):t=this.readXRef(),t.assignXref(this),this.trailer=t;let i;try{i=t.get("Encrypt")}catch(r){if(r instanceof vi)throw r;ae(`XRef.parse - Invalid "Encrypt" reference: "${r}".`)}if(i instanceof ue){const r=t.get("ID"),a=r!=null&&r.length?r[0]:"";i.suppressEncryption=!0,this.encrypt=new S6(i,a,this.pdfManager.password)}let s;try{s=t.get("Root")}catch(r){if(r instanceof vi)throw r;ae(`XRef.parse - Invalid "Root" reference: "${r}".`)}if(s instanceof ue)try{if(s.get("Pages")instanceof ue){this.root=s;return}}catch(r){if(r instanceof vi)throw r;ae(`XRef.parse - Invalid "Pages" reference: "${r}".`)}throw e?new Gp("Invalid Root reference."):new o1}processXRefTable(e){"tableState"in this||(this.tableState={entryNum:0,streamPos:e.lexer.stream.pos,parserBuf1:e.buf1,parserBuf2:e.buf2});const t=this.readXRefTable(e);if(!Ts(t,"trailer"))throw new Te("Invalid XRef table: could not find trailer dictionary");let i=e.getObj();if(!(i instanceof ue)&&i.dict&&(i=i.dict),!(i instanceof ue))throw new Te("Invalid XRef table: could not parse trailer dictionary");return delete this.tableState,i}readXRefTable(e){const t=e.lexer.stream,i=this.tableState;t.pos=i.streamPos,e.buf1=i.parserBuf1,e.buf2=i.parserBuf2;let s;for(;;){if(!("firstEntryNum"in i)||!("entryCount"in i)){if(Ts(s=e.getObj(),"trailer"))break;i.firstEntryNum=s,i.entryCount=e.getObj()}let r=i.firstEntryNum;const a=i.entryCount;if(!Number.isInteger(r)||!Number.isInteger(a))throw new Te("Invalid XRef table: wrong types in subsection header");for(let o=i.entryNum;o<a;o++){i.streamPos=t.pos,i.entryNum=o,i.parserBuf1=e.buf1,i.parserBuf2=e.buf2;const l={};l.offset=e.getObj(),l.gen=e.getObj();const c=e.getObj();if(c instanceof ls)switch(c.cmd){case"f":l.free=!0;break;case"n":l.uncompressed=!0;break}if(!Number.isInteger(l.offset)||!Number.isInteger(l.gen)||!(l.free||l.uncompressed))throw new Te(`Invalid entry in XRef subsection: ${r}, ${a}`);o===0&&l.free&&r===1&&(r=0),this.entries[o+r]||(this.entries[o+r]=l)}i.entryNum=0,i.streamPos=t.pos,i.parserBuf1=e.buf1,i.parserBuf2=e.buf2,delete i.firstEntryNum,delete i.entryCount}if(this.entries[0]&&!this.entries[0].free)throw new Te("Invalid XRef table: unexpected first object");return s}processXRefStream(e){if(!("streamState"in this)){const{dict:t,pos:i}=e,s=t.get("W"),r=t.get("Index")||[0,t.get("Size")];this.streamState={entryRanges:r,byteWidths:s,entryNum:0,streamPos:i}}return this.readXRefStream(e),delete this.streamState,e.dict}readXRefStream(e){const t=this.streamState;e.pos=t.streamPos;const[i,s,r]=t.byteWidths,a=t.entryRanges;for(;a.length>0;){const[o,l]=a;if(!Number.isInteger(o)||!Number.isInteger(l))throw new Te(`Invalid XRef range fields: ${o}, ${l}`);if(!Number.isInteger(i)||!Number.isInteger(s)||!Number.isInteger(r))throw new Te(`Invalid XRef entry fields length: ${o}, ${l}`);for(let c=t.entryNum;c<l;++c){t.entryNum=c,t.streamPos=e.pos;let h=0,u=0,d=0;for(let g=0;g<i;++g){const m=e.getByte();if(m===-1)throw new Te("Invalid XRef byteWidths 'type'.");h=h<<8|m}i===0&&(h=1);for(let g=0;g<s;++g){const m=e.getByte();if(m===-1)throw new Te("Invalid XRef byteWidths 'offset'.");u=u<<8|m}for(let g=0;g<r;++g){const m=e.getByte();if(m===-1)throw new Te("Invalid XRef byteWidths 'generation'.");d=d<<8|m}const f={};switch(f.offset=u,f.gen=d,h){case 0:f.free=!0;break;case 1:f.uncompressed=!0;break;case 2:break;default:throw new Te(`Invalid XRef entry type: ${h}`)}this.entries[o+c]||(this.entries[o+c]=f)}t.entryNum=0,t.streamPos=e.pos,a.splice(0,2)}}indexObjects(){function o(T,M){let D="",H=T[M];for(;H!==10&&H!==13&&H!==60&&!(++M>=T.length);)D+=String.fromCharCode(H),H=T[M];return D}function l(T,M,D){const H=D.length,R=T.length;let z=0;for(;M<R;){let P=0;for(;P<H&&T[M+P]===D[P];)++P;if(P>=H)break;M++,z++}return z}const c=/\b(endobj|\d+\s+\d+\s+obj|xref|trailer\s*<<)\b/g,h=/\b(startxref|\d+\s+\d+\s+obj)\b/g,u=/^(\d+)\s+(\d+)\s+obj\b/,d=new Uint8Array([116,114,97,105,108,101,114]),f=new Uint8Array([115,116,97,114,116,120,114,101,102]),g=new Uint8Array([47,88,82,101,102]);this.entries.length=0,this._cacheMap.clear();const m=this.stream;m.pos=0;const b=m.getBytes(),p=xa(b),y=b.length;let w=m.start;const _=[],v=[];for(;w<y;){let T=b[w];if(T===9||T===10||T===13||T===32){++w;continue}if(T===37){do{if(++w,w>=y)break;T=b[w]}while(T!==10&&T!==13);continue}const M=o(b,w);let D;if(M.startsWith("xref")&&(M.length===4||/\s/.test(M[4])))w+=l(b,w,d),_.push(w),w+=l(b,w,f);else if(D=u.exec(M)){const H=D[1]|0,R=D[2]|0,z=w+M.length;let P,B=!1;if(!this.entries[H])B=!0;else if(this.entries[H].gen===R)try{new F0({lexer:new Qo(m.makeSubStream(z))}).getObj(),B=!0}catch(J){J instanceof O7?ae(`indexObjects -- checking object (${M}): "${J}".`):B=!0}B&&(this.entries[H]={offset:w-m.start,gen:R,uncompressed:!0}),c.lastIndex=z;const Z=c.exec(p);Z?(P=c.lastIndex+1-w,Z[1]!=="endobj"&&(ae(`indexObjects: Found "${Z[1]}" inside of another "obj", caused by missing "endobj" -- trying to recover.`),P-=Z[1].length+1)):P=y-w;const G=b.subarray(w,w+P),Y=l(G,0,g);Y<P&&G[Y+5]<64&&(v.push(w-m.start),this._xrefStms.add(w-m.start)),w+=P}else if(M.startsWith("trailer")&&(M.length===7||/\s/.test(M[7]))){_.push(w);const H=w+M.length;let R;h.lastIndex=H;const z=h.exec(p);z?(R=h.lastIndex+1-w,z[1]!=="startxref"&&(ae(`indexObjects: Found "${z[1]}" after "trailer", caused by missing "startxref" -- trying to recover.`),R-=z[1].length+1)):R=y-w,w+=R}else w+=M.length+1}for(const T of v)this.startXRefQueue.push(T),this.readXRef(!0);const C=[];let k=!1;for(const T of _){m.pos=T;const M=new F0({lexer:new Qo(m),xref:this,allowStreams:!0,recoveryMode:!0}),D=M.getObj();if(!Ts(D,"trailer"))continue;const H=M.getObj();H instanceof ue&&(C.push(H),H.has("Encrypt")&&(k=!0))}let I,E;for(const T of[...C,"genFallback",...C]){if(T==="genFallback"){if(!E)break;this._generationFallback=!0;continue}let M=!1;try{const D=T.get("Root");if(!(D instanceof ue))continue;const H=D.get("Pages");if(!(H instanceof ue))continue;const R=H.get("Count");Number.isInteger(R)&&(M=!0)}catch(D){E=D;continue}if(M&&(!k||T.has("Encrypt"))&&T.has("ID"))return T;I=T}if(I)return I;if(this.topDict)return this.topDict;if(!C.length)for(const[T,M]of this.entries.entries()){if(!M)continue;const D=tt.get(T,M.gen);let H;try{H=this.fetch(D)}catch{continue}if(H instanceof dn&&(H=H.dict),H instanceof ue&&H.has("Root"))return H}throw new Gp("Invalid PDF structure.")}readXRef(e=!1){const t=this.stream,i=new Set;for(;this.startXRefQueue.length;){try{const s=this.startXRefQueue[0];if(i.has(s)){ae("readXRef - skipping XRef table since it was already parsed."),this.startXRefQueue.shift();continue}i.add(s),t.pos=s+t.start;const r=new F0({lexer:new Qo(t),xref:this,allowStreams:!0});let a=r.getObj(),o;if(Ts(a,"xref"))o=this.processXRefTable(r),this.topDict||(this.topDict=o),a=o.get("XRefStm"),Number.isInteger(a)&&!this._xrefStms.has(a)&&(this._xrefStms.add(a),this.startXRefQueue.push(a),x(this,ox)??O(this,ox,a));else if(Number.isInteger(a)){if(!Number.isInteger(r.getObj())||!Ts(r.getObj(),"obj")||!((a=r.getObj())instanceof dn))throw new Te("Invalid XRef stream");if(o=this.processXRefStream(a),this.topDict||(this.topDict=o),!o)throw new Te("Failed to read XRef stream")}else throw new Te("Invalid XRef stream header");a=o.get("Prev"),Number.isInteger(a)?this.startXRefQueue.push(a):a instanceof tt&&this.startXRefQueue.push(a.num)}catch(s){if(s instanceof vi)throw s;gn("(while reading XRef): "+s)}this.startXRefQueue.shift()}if(this.topDict)return this.topDict;if(!e)throw new o1}get lastXRefStreamPos(){return x(this,ox)??(this._xrefStms.size>0?Math.max(...this._xrefStms):null)}getEntry(e){const t=this.entries[e];return t&&!t.free&&t.offset?t:null}fetchIfRef(e,t=!1){return e instanceof tt?this.fetch(e,t):e}fetch(e,t=!1){if(!(e instanceof tt))throw new Error("ref object is not a reference");const i=e.num,s=this._cacheMap.get(i);if(s!==void 0)return s instanceof ue&&!s.objId&&(s.objId=e.toString()),s;let r=this.getEntry(i);if(r===null)return r;if(this._pendingRefs.has(e))return this._pendingRefs.remove(e),ae(`Ignoring circular reference: ${e}.`),NU;this._pendingRefs.put(e);try{r=r.uncompressed?this.fetchUncompressed(e,r,t):this.fetchCompressed(e,r,t),this._pendingRefs.remove(e)}catch(a){throw this._pendingRefs.remove(e),a}return r instanceof ue?r.objId=e.toString():r instanceof dn&&(r.dict.objId=e.toString()),r}fetchUncompressed(e,t,i=!1){const s=e.gen;let r=e.num;if(t.gen!==s){const u=`Inconsistent generation in XRef: ${e}`;if(this._generationFallback&&t.gen<s)return ae(u),this.fetchUncompressed(tt.get(r,t.gen),t,i);throw new Oh(u)}const a=this.stream.makeSubStream(t.offset+this.stream.start),o=new F0({lexer:new Qo(a),xref:this,allowStreams:!0}),l=o.getObj(),c=o.getObj(),h=o.getObj();if(l!==r||c!==s||!(h instanceof ls))throw new Oh(`Bad (uncompressed) XRef entry: ${e}`);if(h.cmd!=="obj"){if(h.cmd.startsWith("obj")&&(r=parseInt(h.cmd.substring(3),10),!Number.isNaN(r)))return r;throw new Oh(`Bad (uncompressed) XRef entry: ${e}`)}return t=this.encrypt&&!i?o.getObj(this.encrypt.createCipherTransform(r,s)):o.getObj(),t instanceof dn||this._cacheMap.set(r,t),t}fetchCompressed(e,t,i=!1){const s=t.offset,r=this.fetch(tt.get(s,0));if(!(r instanceof dn))throw new Te("bad ObjStm stream");const a=r.dict.get("First"),o=r.dict.get("N");if(!Number.isInteger(a)||!Number.isInteger(o))throw new Te("invalid first and n parameters for ObjStm stream");let l=new F0({lexer:new Qo(r),xref:this,allowStreams:!0});const c=new Array(o),h=new Array(o);for(let f=0;f<o;++f){const g=l.getObj();if(!Number.isInteger(g))throw new Te(`invalid object number in the ObjStm stream: ${g}`);const m=l.getObj();if(!Number.isInteger(m))throw new Te(`invalid object offset in the ObjStm stream: ${m}`);c[f]=g,h[f]=m}const u=(r.start||0)+a,d=new Array(o);for(let f=0;f<o;++f){const g=f<o-1?h[f+1]-h[f]:void 0;if(g<0)throw new Te("Invalid offset in the ObjStm stream.");l=new F0({lexer:new Qo(r.makeSubStream(u+h[f],g,r.dict)),xref:this,allowStreams:!0});const m=l.getObj();if(d[f]=m,m instanceof dn)continue;const b=c[f],p=this.entries[b];p&&p.offset===s&&p.gen===f&&this._cacheMap.set(b,m)}if(t=d[t.gen],t===void 0)throw new Oh(`Bad (compressed) XRef entry: ${e}`);return t}async fetchIfRefAsync(e,t){return e instanceof tt?this.fetchAsync(e,t):e}async fetchAsync(e,t){try{return this.fetch(e,t)}catch(i){if(!(i instanceof vi))throw i;return await this.pdfManager.requestRange(i.begin,i.end),this.fetchAsync(e,t)}}getCatalogObj(){return this.root}}ox=new WeakMap;const IJ=[0,0,612,792];var J5,Hi,Bf,yp,T6,_P,R6,M6;class kC{constructor({pdfManager:e,xref:t,pageIndex:i,pageDict:s,ref:r,globalIdFactory:a,fontCache:o,builtInCMapCache:l,standardFontDataCache:c,globalColorSpaceCache:h,globalImageCache:u,systemFontCache:d,nonBlendModesSet:f,xfaFactory:g}){U(this,Hi);U(this,J5,null);this.pdfManager=e,this.pageIndex=i,this.pageDict=s,this.xref=t,this.ref=r,this.fontCache=o,this.builtInCMapCache=l,this.standardFontDataCache=c,this.globalColorSpaceCache=h,this.globalImageCache=u,this.systemFontCache=d,this.nonBlendModesSet=f,this.evaluatorOptions=e.evaluatorOptions,this.xfaFactory=g;const m={obj:0};this._localIdFactory=class extends a{static createObjId(){return`p${i}_${++m.obj}`}static getPageObjId(){return`p${r.toString()}`}}}get content(){return this.pageDict.getArray("Contents")}get resources(){const e=F(this,Hi,yp).call(this,"Resources");return We(this,"resources",e instanceof ue?e:ue.empty)}get mediaBox(){return We(this,"mediaBox",F(this,Hi,T6).call(this,"MediaBox")||IJ)}get cropBox(){return We(this,"cropBox",F(this,Hi,T6).call(this,"CropBox")||this.mediaBox)}get userUnit(){const e=this.pageDict.get("UserUnit");return We(this,"userUnit",typeof e=="number"&&e>0?e:1)}get view(){const{cropBox:e,mediaBox:t}=this;if(e!==t&&!qp(e,t)){const i=Ln.intersect(e,t);if(i&&i[2]-i[0]>0&&i[3]-i[1]>0)return We(this,"view",i);ae("Empty /CropBox and /MediaBox intersection.")}return We(this,"view",t)}get rotate(){let e=F(this,Hi,yp).call(this,"Rotate")||0;return e%90!==0?e=0:e>=360?e%=360:e<0&&(e=(e%360+360)%360),We(this,"rotate",e)}async getContentStream(){const e=await this.pdfManager.ensure(this,"content");return e instanceof dn?e:Array.isArray(e)?new wH(e,F(this,Hi,_P).bind(this)):new G7}get xfaData(){return We(this,"xfaData",this.xfaFactory?{bbox:this.xfaFactory.getBoundingBox(this.pageIndex)}:null)}async saveNewAnnotations(e,t,i,s,r){if(this.xfaFactory)throw new Error("XFA: Cannot save new annotations.");const a=F(this,Hi,Bf).call(this,e),o=new ma,l=new ts;await F(this,Hi,R6).call(this,i,o,l);const c=this.pageDict,h=this.annotations.filter(f=>!(f instanceof tt&&o.has(f))),u=await j0.saveNewAnnotations(a,t,i,s,r);for(const{ref:f}of u.annotations)f instanceof tt&&!l.has(f)&&h.push(f);const d=c.clone();d.set("Annots",h),r.put(this.ref,{data:d});for(const f of o)r.put(f,{data:null})}async save(e,t,i,s){const r=F(this,Hi,Bf).call(this,e),a=await this._parsedAnnotations,o=[];for(const l of a)o.push(l.save(r,t,i,s).catch(function(c){return ae(`save - ignoring annotation data during "${t.name}" task: "${c}".`),null}));return Promise.all(o)}async loadResources(e){await(x(this,J5)??O(this,J5,this.pdfManager.ensure(this,"resources"))),await Bg.load(this.resources,e,this.xref)}async getOperatorList({handler:e,sink:t,task:i,intent:s,cacheKey:r,annotationStorage:a=null,modifiedIds:o=null}){const l=this.getContentStream(),c=this.loadResources(P7),h=F(this,Hi,Bf).call(this,e),u=this.xfaFactory?null:vR(a),d=u==null?void 0:u.get(this.pageIndex);let f=Promise.resolve(null),g=null;if(d){const D=this.pdfManager.ensureDoc("annotationGlobals");let H;const R=new Set;for(const{bitmapId:P,bitmap:B}of d)P&&!B&&!R.has(P)&&R.add(P);const{isOffscreenCanvasSupported:z}=this.evaluatorOptions;if(R.size>0){const P=d.slice();for(const[B,Z]of a)B.startsWith(fR)&&Z.bitmap&&R.has(Z.bitmapId)&&P.push(Z);H=j0.generateImages(P,this.xref,z)}else H=j0.generateImages(d,this.xref,z);g=new ts,f=Promise.all([D,F(this,Hi,R6).call(this,d,g,null)]).then(([P])=>P?j0.printNewAnnotations(P,h,i,d,H):null)}const m=Promise.all([l,c]).then(async([D])=>{const H=await F(this,Hi,M6).call(this,D.dict,P7),R=new Pr(s,t);return e.send("StartRenderPage",{transparency:h.hasBlendModes(H,this.nonBlendModesSet),pageIndex:this.pageIndex,cacheKey:r}),await h.getOperatorList({stream:D,task:i,resources:H,operatorList:R}),R});let[b,p,y]=await Promise.all([m,this._parsedAnnotations,f]);if(y){p=p.filter(D=>!(D.ref&&g.has(D.ref)));for(let D=0,H=y.length;D<H;D++){const R=y[D];if(R.refToReplace){const z=p.findIndex(P=>P.ref&&N3(P.ref,R.refToReplace));z>=0&&(p.splice(z,1,R),y.splice(D--,1),H--)}}p=p.concat(y)}if(p.length===0||s&Wr.ANNOTATIONS_DISABLE)return b.flush(!0),{length:b.totalLength};const w=!!(s&Wr.ANNOTATIONS_FORMS),_=!!(s&Wr.IS_EDITING),v=!!(s&Wr.ANY),C=!!(s&Wr.DISPLAY),k=!!(s&Wr.PRINT),I=[];for(const D of p)(v||C&&D.mustBeViewed(a,w)&&D.mustBeViewedWhenEditing(_,o)||k&&D.mustBePrinted(a))&&I.push(D.getOperatorList(h,i,s,a).catch(function(H){return ae(`getOperatorList - ignoring annotation data during "${i.name}" task: "${H}".`),{opList:null,separateForm:!1,separateCanvas:!1}}));const E=await Promise.all(I);let T=!1,M=!1;for(const{opList:D,separateForm:H,separateCanvas:R}of E)b.addOpList(D),T||(T=H),M||(M=R);return b.flush(!0,{form:T,canvas:M}),{length:b.totalLength}}async extractTextContent({handler:e,task:t,includeMarkedContent:i,disableNormalization:s,sink:r,intersector:a=null}){const o=this.getContentStream(),l=this.loadResources(N7),c=this.pdfManager.ensureCatalog("lang"),[h,,u]=await Promise.all([o,l,c]),d=await F(this,Hi,M6).call(this,h.dict,N7);return F(this,Hi,Bf).call(this,e).getTextContent({stream:h,task:t,resources:d,includeMarkedContent:i,disableNormalization:s,sink:r,viewBox:this.view,lang:u,intersector:a})}async getStructTree(){const e=await this.pdfManager.ensureCatalog("structTreeRoot");if(!e)return null;await this._parsedAnnotations;try{const t=await this.pdfManager.ensure(this,"_parseStructTree",[e]);return await this.pdfManager.ensure(t,"serializable")}catch(t){return ae(`getStructTree: "${t}".`),null}}_parseStructTree(e){const t=new wM(e,this.pageDict);return t.parse(this.ref),t}async getAnnotationsData(e,t,i){const s=await this._parsedAnnotations;if(s.length===0)return s;const r=[],a=[];let o;const l=!!(i&Wr.ANY),c=!!(i&Wr.DISPLAY),h=!!(i&Wr.PRINT),u=[];for(const d of s){const f=l||c&&d.viewable;(f||h&&d.printable)&&r.push(d.data),d.hasTextContent&&f?(o??(o=F(this,Hi,Bf).call(this,e)),a.push(d.extractTextContent(o,t,[-1/0,-1/0,1/0,1/0]).catch(function(g){ae(`getAnnotationsData - ignoring textContent during "${t.name}" task: "${g}".`)}))):d.overlaysTextContent&&f&&u.push(d)}if(u.length>0){const d=new aJ(u);a.push(this.extractTextContent({handler:e,task:t,includeMarkedContent:!1,disableNormalization:!1,sink:null,viewBox:this.view,lang:null,intersector:d}).then(()=>{d.setText()}))}return await Promise.all(a),r}get annotations(){const e=F(this,Hi,yp).call(this,"Annots");return We(this,"annotations",Array.isArray(e)?e:[])}get _parsedAnnotations(){const e=this.pdfManager.ensure(this,"annotations").then(async t=>{if(t.length===0)return t;const[i,s]=await Promise.all([this.pdfManager.ensureDoc("annotationGlobals"),this.pdfManager.ensureDoc("fieldObjects")]);if(!i)return[];const r=s==null?void 0:s.orphanFields,a=[];for(const h of t)a.push(j0.create(this.xref,h,i,this._localIdFactory,!1,r,this.ref).catch(function(u){return ae(`_parsedAnnotations: "${u}".`),null}));const o=[];let l,c;for(const h of await Promise.all(a))if(h){if(h instanceof cl){(c||(c=[])).push(h);continue}if(h instanceof uP){(l||(l=[])).push(h);continue}o.push(h)}return c&&o.push(...c),l&&o.push(...l),o});return We(this,"_parsedAnnotations",e)}get jsActions(){const e=oy(this.xref,this.pageDict,vU);return We(this,"jsActions",e)}}J5=new WeakMap,Hi=new WeakSet,Bf=function(e){return new Fg({xref:this.xref,handler:e,pageIndex:this.pageIndex,idFactory:this._localIdFactory,fontCache:this.fontCache,builtInCMapCache:this.builtInCMapCache,standardFontDataCache:this.standardFontDataCache,globalColorSpaceCache:this.globalColorSpaceCache,globalImageCache:this.globalImageCache,systemFontCache:this.systemFontCache,options:this.evaluatorOptions})},yp=function(e,t=!1){const i=wo({dict:this.pageDict,key:e,getArray:t,stopWhenFound:!1});return Array.isArray(i)?i.length===1||!(i[0]instanceof ue)?i[0]:ue.merge({xref:this.xref,dictArray:i}):i},T6=function(e){if(this.xfaData)return this.xfaData.bbox;const t=A0(F(this,Hi,yp).call(this,e,!0),null);if(t){if(t[2]-t[0]>0&&t[3]-t[1]>0)return t;ae(`Empty, or invalid, /${e} entry.`)}return null},_P=function(e,t){if(this.evaluatorOptions.ignoreErrors){ae(`getContentStream - ignoring sub-stream (${t}): "${e}".`);return}throw e},R6=async function(e,t,i){const s=[];for(const r of e)if(r.id){const a=tt.fromString(r.id);if(!a){ae(`A non-linked annotation cannot be modified: ${r.id}`);continue}if(r.deleted){if(t.put(a,a),r.popupRef){const o=tt.fromString(r.popupRef);o&&t.put(o,o)}continue}i==null||i.put(a),r.ref=a,s.push(this.xref.fetchAsync(a).then(o=>{o instanceof ue&&(r.oldAnnotation=o.clone())},()=>{ae(`Cannot fetch \`oldAnnotation\` for: ${a}.`)})),delete r.id}await Promise.all(s)},M6=async function(e,t){const i=e==null?void 0:e.get("Resources");return i instanceof ue&&i.size?(await Bg.load(i,t,this.xref),ue.merge({xref:this.xref,dictArray:[i,this.resources],mergeSubDicts:!0})):this.resources};const CC=new Uint8Array([37,80,68,70,45]),AC=new Uint8Array([115,116,97,114,116,120,114,101,102]),EJ=new Uint8Array([101,110,100,111,98,106]);function Ww(n,e,t=1024,i=!1){const s=e.length,r=n.peekBytes(t),a=r.length-s;if(a<=0)return!1;if(i){const o=s-1;let l=r.length-1;for(;l>=o;){let c=0;for(;c<s&&r[l-c]===e[o-c];)c++;if(c>=s)return n.pos+=l-o,!0;l--}}else{let o=0;for(;o<=a;){let l=0;for(;l<s&&r[o+l]===e[l];)l++;if(l>=s)return n.pos+=o,!0;o++}}return!1}var Nh,lx,Dr,P6,kP,CP,AP,SP,N6;class vP{constructor(e,t){U(this,Dr);U(this,Nh,new Map);U(this,lx,null);if(t.length<=0)throw new Gp("The PDF file is empty, i.e. its size is zero bytes.");this.pdfManager=e,this.stream=t,this.xref=new SJ(t,e);const i={font:0};this._globalIdFactory=class{static getDocId(){return`g_${e.docId}`}static createFontId(){return`f${++i.font}`}static createObjId(){Cn("Abstract method `createObjId` called.")}static getPageObjId(){Cn("Abstract method `getPageObjId` called.")}}}parse(e){this.xref.parse(e),this.catalog=new t2(this.pdfManager,this.xref)}get linearization(){let e=null;try{e=uz.create(this.stream)}catch(t){if(t instanceof vi)throw t;gn(t)}return We(this,"linearization",e)}get startXRef(){const e=this.stream;let t=0;if(this.linearization){if(e.reset(),Ww(e,EJ)){e.skip(6);let i=e.peekByte();for(;Za(i);)e.pos++,i=e.peekByte();t=e.pos-e.start}}else{const s=AC.length;let r=!1,a=e.end;for(;!r&&a>0;)a-=1024-s,a<0&&(a=0),e.pos=a,r=Ww(e,AC,1024,!0);if(r){e.skip(9);let o;do o=e.getByte();while(Za(o));let l="";for(;o>=32&&o<=57;)l+=String.fromCharCode(o),o=e.getByte();t=parseInt(l,10),isNaN(t)&&(t=0)}}return We(this,"startXRef",t)}checkHeader(){const e=this.stream;if(e.reset(),!Ww(e,CC))return;e.moveStart(),e.skip(CC.length);let t="",i;for(;(i=e.getByte())>32&&t.length<7;)t+=String.fromCharCode(i);xR.test(t)?O(this,lx,t):ae(`Invalid PDF header version: ${t}`)}parseStartXRef(){this.xref.setStartXRef(this.startXRef)}get numPages(){let e=0;return this.catalog.hasActualNumPages?e=this.catalog.numPages:this.xfaFactory?e=this.xfaFactory.getNumPages():this.linearization?e=this.linearization.numPages:e=this.catalog.numPages,We(this,"numPages",e)}get _xfaStreams(){const{acroForm:e}=this.catalog;if(!e)return null;const t=e.get("XFA"),i=new Map(["xdp:xdp","template","datasets","config","connectionSet","localeSet","stylesheet","/xdp:xdp"].map(s=>[s,null]));if(t instanceof dn&&!t.isEmpty)return i.set("xdp:xdp",t),i;if(!Array.isArray(t)||t.length===0)return null;for(let s=0,r=t.length;s<r;s+=2){let a;if(s===0?a="xdp:xdp":s===r-2?a="/xdp:xdp":a=t[s],!i.has(a))continue;const o=this.xref.fetchIfRef(t[s+1]);!(o instanceof dn)||o.isEmpty||i.set(a,o)}return i}get xfaDatasets(){const e=this._xfaStreams;if(!e)return We(this,"xfaDatasets",null);for(const t of["datasets","xdp:xdp"]){const i=e.get(t);if(i)try{const s=Vp(i.getString()),r={[t]:s};return We(this,"xfaDatasets",new sJ(r))}catch{ae("XFA - Invalid utf-8 string.");break}}return We(this,"xfaDatasets",null)}get xfaData(){const e=this._xfaStreams;if(!e)return null;const t=Object.create(null);for(const[i,s]of e)if(s)try{t[i]=Vp(s.getString())}catch{return ae("XFA - Invalid utf-8 string."),null}return t}get xfaFactory(){let e;return this.pdfManager.enableXfa&&this.catalog.needsRendering&&this.formInfo.hasXfa&&!this.formInfo.hasAcroForm&&(e=this.xfaData),We(this,"xfaFactory",e?new Cx(e):null)}get isPureXfa(){return this.xfaFactory?this.xfaFactory.isValid():!1}get htmlForXfa(){return this.xfaFactory?this.xfaFactory.getPages():null}loadXfaResources(e,t){return Promise.all([F(this,Dr,AP).call(this,e,t).catch(()=>{}),F(this,Dr,CP).call(this)])}serializeXfaData(e){return this.xfaFactory?this.xfaFactory.serializeData(e):null}get version(){return this.catalog.version||x(this,lx)}get formInfo(){const e={hasFields:!1,hasAcroForm:!1,hasXfa:!1,hasSignatures:!1},{acroForm:t}=this.catalog;if(!t)return We(this,"formInfo",e);try{const i=t.get("Fields"),s=Array.isArray(i)&&i.length>0;e.hasFields=s;const r=t.get("XFA");e.hasXfa=Array.isArray(r)&&r.length>0||r instanceof dn&&!r.isEmpty;const o=!!(t.get("SigFlags")&1),l=o&&F(this,Dr,P6).call(this,i);e.hasAcroForm=s&&!l,e.hasSignatures=o}catch(i){if(i instanceof vi)throw i;ae(`Cannot fetch form information: "${i}".`)}return We(this,"formInfo",e)}get documentInfo(){var a;const{catalog:e,formInfo:t,xref:i}=this,s={PDFFormatVersion:this.version,Language:e.lang,EncryptFilterName:((a=i.encrypt)==null?void 0:a.filterName)??null,IsLinearized:!!this.linearization,IsAcroFormPresent:t.hasAcroForm,IsXFAPresent:t.hasXfa,IsCollectionPresent:!!e.collection,IsSignaturesPresent:t.hasSignatures};let r;try{r=i.trailer.get("Info")}catch(o){if(o instanceof vi)throw o;gn("The document information dictionary is invalid.")}if(!(r instanceof ue))return We(this,"documentInfo",s);for(const[o,l]of r){switch(o){case"Title":case"Author":case"Subject":case"Keywords":case"Creator":case"Producer":case"CreationDate":case"ModDate":if(typeof l=="string"){s[o]=Rn(l);continue}break;case"Trapped":if(l instanceof ve){s[o]=l;continue}break;default:let c;switch(typeof l){case"string":c=Rn(l);break;case"number":case"boolean":c=l;break;default:l instanceof ve&&(c=l);break}if(c===void 0){ae(`Bad value, for custom key "${o}", in Info: ${l}.`);continue}s.Custom??(s.Custom=Object.create(null)),s.Custom[o]=c;continue}ae(`Bad value, for key "${o}", in Info: ${l}.`)}return We(this,"documentInfo",s)}get fingerprints(){const t="\0".repeat(16);function i(o){return typeof o=="string"&&o.length===16&&o!==t}const s=this.xref.trailer.get("ID");let r,a;return Array.isArray(s)&&i(s[0])?(r=gr(s[0]),s[1]!==s[0]&&i(s[1])&&(a=gr(s[1]))):r=B0(this.stream.getByteRange(0,1024),0,1024),We(this,"fingerprints",[Zv(r),a?Zv(a):null])}getPage(e){const t=x(this,Nh).get(e);if(t)return t;const{catalog:i,linearization:s,xfaFactory:r}=this;let a;return r?a=Promise.resolve([ue.empty,null]):(s==null?void 0:s.pageFirst)===e?a=F(this,Dr,SP).call(this,e):a=i.getPageDict(e),a=a.then(([o,l])=>new kC({pdfManager:this.pdfManager,xref:this.xref,pageIndex:e,pageDict:o,ref:l,globalIdFactory:this._globalIdFactory,fontCache:i.fontCache,builtInCMapCache:i.builtInCMapCache,standardFontDataCache:i.standardFontDataCache,globalColorSpaceCache:i.globalColorSpaceCache,globalImageCache:i.globalImageCache,systemFontCache:i.systemFontCache,nonBlendModesSet:i.nonBlendModesSet,xfaFactory:r})),x(this,Nh).set(e,a),a}async checkFirstPage(e=!1){if(!e)try{await this.getPage(0)}catch(t){if(t instanceof Oh)throw x(this,Nh).delete(0),await this.cleanup(),new o1}}async checkLastPage(e=!1){const{catalog:t,pdfManager:i}=this;t.setActualNumPages();let s;try{if(await Promise.all([i.ensureDoc("xfaFactory"),i.ensureDoc("linearization"),i.ensureCatalog("numPages")]),this.xfaFactory)return;if(this.linearization?s=this.linearization.numPages:s=t.numPages,Number.isInteger(s)){if(s<=1)return}else throw new Te("Page count is not an integer.");await this.getPage(s-1)}catch(r){if(x(this,Nh).delete(s-1),await this.cleanup(),r instanceof Oh&&!e)throw new o1;ae(`checkLastPage - invalid /Pages tree /Count: ${s}.`);let a;try{a=await t.getAllPageDicts(e)}catch(o){if(o instanceof Oh&&!e)throw new o1;t.setActualNumPages(1);return}for(const[o,[l,c]]of a){let h;l instanceof Error?(h=Promise.reject(l),h.catch(()=>{})):h=Promise.resolve(new kC({pdfManager:i,xref:this.xref,pageIndex:o,pageDict:l,ref:c,globalIdFactory:this._globalIdFactory,fontCache:t.fontCache,builtInCMapCache:t.builtInCMapCache,standardFontDataCache:t.standardFontDataCache,globalColorSpaceCache:this.globalColorSpaceCache,globalImageCache:t.globalImageCache,systemFontCache:t.systemFontCache,nonBlendModesSet:t.nonBlendModesSet,xfaFactory:null})),x(this,Nh).set(o,h)}t.setActualNumPages(a.size)}}async fontFallback(e,t){const{catalog:i,pdfManager:s}=this;for(const r of await Promise.all(i.fontCache))if(r.loadedName===e){r.fallback(t,s.evaluatorOptions);return}}async cleanup(e=!1){return this.catalog?this.catalog.cleanup(e):G4()}get fieldObjects(){const e=this.pdfManager.ensureDoc("formInfo").then(async t=>{if(!t.hasFields)return null;const i=await this.annotationGlobals;if(!i)return null;const{acroForm:s}=i,r=new ts,a=Object.create(null),o=new Map,l=new ma;for(const h of s.get("Fields"))await F(this,Dr,N6).call(this,"",null,h,o,i,r,l);const c=[];for(const[h,u]of o)c.push(Promise.all(u).then(d=>{d=d.filter(f=>!!f),d.length>0&&(a[h]=d)}));return await Promise.all(c),{allFields:A4(a)>0?a:null,orphanFields:l}});return We(this,"fieldObjects",e)}get hasJSActions(){const e=this.pdfManager.ensureDoc("_parseHasJSActions");return We(this,"hasJSActions",e)}async _parseHasJSActions(){const[e,t]=await Promise.all([this.pdfManager.ensureCatalog("jsActions"),this.pdfManager.ensureDoc("fieldObjects")]);return e?!0:t!=null&&t.allFields?Object.values(t.allFields).some(i=>i.some(s=>s.actions!==null)):!1}get calculationOrderIds(){var i;const e=(i=this.catalog.acroForm)==null?void 0:i.get("CO");if(!Array.isArray(e)||e.length===0)return We(this,"calculationOrderIds",null);const t=[];for(const s of e)s instanceof tt&&t.push(s.toString());return We(this,"calculationOrderIds",t.length?t:null)}get annotationGlobals(){return We(this,"annotationGlobals",j0.createGlobals(this.pdfManager))}}Nh=new WeakMap,lx=new WeakMap,Dr=new WeakSet,P6=function(e,t=0){return Array.isArray(e)?e.every(s=>{if(s=this.xref.fetchIfRef(s),!(s instanceof ue))return!1;if(s.has("Kids"))return++t>10?(ae("#hasOnlyDocumentSignatures: maximum recursion depth reached"),!1):F(this,Dr,P6).call(this,s.get("Kids"),t);const r=Li(s.get("FT"),"Sig"),a=s.get("Rect"),o=Array.isArray(a)&&a.every(l=>l===0);return r&&o}):!1},kP=function(e,t,i=new ts){if(Array.isArray(e))for(let s of e){if(s instanceof tt){if(i.has(s))continue;i.put(s)}if(s=this.xref.fetchIfRef(s),!(s instanceof ue))continue;if(s.has("Kids")){F(this,Dr,kP).call(this,s.get("Kids"),t,i);continue}if(!Li(s.get("FT"),"Sig"))continue;const a=s.get("V");if(!(a instanceof ue))continue;const o=a.get("SubFilter");o instanceof ve&&t.add(o.name)}},CP=async function(){const e=await this.pdfManager.ensureCatalog("xfaImages");e&&this.xfaFactory.setImages(e)},AP=async function(e,t){const i=await this.pdfManager.ensureCatalog("acroForm");if(!i)return;const s=await i.getAsync("DR");if(!(s instanceof ue))return;await Bg.load(s,["Font"],this.xref);const r=s.get("Font");if(!(r instanceof ue))return;const a=Object.assign(Object.create(null),this.pdfManager.evaluatorOptions,{useSystemFonts:!1}),{builtInCMapCache:o,fontCache:l,standardFontDataCache:c}=this.catalog,h=new Fg({xref:this.xref,handler:e,pageIndex:-1,idFactory:this._globalIdFactory,fontCache:l,builtInCMapCache:o,standardFontDataCache:c,options:a}),u=new Pr,d=[],f={get font(){return d.at(-1)},set font(y){d.push(y)},clone(){return this}},g=(y,w,_)=>h.handleSetFont(s,[ve.get(y),1],null,u,t,f,w,_).catch(v=>(ae(`loadXfaFonts: "${v}".`),null)),m=[];for(const[y,w]of r){const _=w.get("FontDescriptor");if(!(_ instanceof ue))continue;let v=_.get("FontFamily");v=v.replaceAll(/[ ]+(\d)/g,"$1");const C=_.get("FontWeight"),k=-_.get("ItalicAngle"),I={fontFamily:v,fontWeight:C,italicAngle:k};zU(I)&&m.push(g(y,null,I))}await Promise.all(m);const b=this.xfaFactory.setFonts(d);if(!b)return;a.ignoreErrors=!0,m.length=0,d.length=0;const p=new Set;for(const y of b)H4(`${y}-Regular`)||p.add(y);p.size&&b.push("PdfJS-Fallback");for(const y of b)if(!p.has(y))for(const w of[{name:"Regular",fontWeight:400,italicAngle:0},{name:"Bold",fontWeight:700,italicAngle:0},{name:"Italic",fontWeight:400,italicAngle:12},{name:"BoldItalic",fontWeight:700,italicAngle:12}]){const _=`${y}-${w.name}`;m.push(g(_,aM(_),{fontFamily:y,fontWeight:w.fontWeight,italicAngle:w.italicAngle}))}await Promise.all(m),this.xfaFactory.appendFonts(d,p)},SP=async function(e){const{catalog:t,linearization:i,xref:s}=this,r=tt.get(i.objectNumberFirst,0);try{const a=await s.fetchAsync(r);if(a instanceof ue){let o=a.getRaw("Type");if(o instanceof tt&&(o=await s.fetchAsync(o)),Li(o,"Page")||!a.has("Type")&&!a.has("Kids")&&a.has("Contents"))return t.pageKidsCountCache.has(r)||t.pageKidsCountCache.put(r,1),t.pageIndexCache.has(r)||t.pageIndexCache.put(r,0),[a,r]}throw new Te("The Linearization dictionary doesn't point to a valid Page dictionary.")}catch(a){return ae(`_getLinearizationPage: "${a.message}".`),t.getPageDict(e)}},N6=async function(e,t,i,s,r,a,o){const{xref:l}=this;if(!(i instanceof tt)||a.has(i))return;a.put(i);const c=await l.fetchAsync(i);if(!(c instanceof ue))return;let h=await c.getAsync("Subtype");switch(h=h instanceof ve?h.name:null,h){case"Link":return}if(c.has("T")){const d=Rn(await c.getAsync("T"));e=e===""?d:`${e}.${d}`}else{let d=c;for(;;){if(d=d.getRaw("Parent")||t,d instanceof tt){if(a.has(d))break;d=await l.fetchAsync(d)}if(!(d instanceof ue))break;if(d.has("T")){const f=Rn(await d.getAsync("T"));e=e===""?f:`${e}.${f}`;break}}}if(t&&!c.has("Parent")&&Li(c.get("Subtype"),"Widget")&&o.put(i,t),s.has(e)||s.set(e,[]),s.get(e).push(j0.create(l,i,r,null,!0,o,null).then(d=>d==null?void 0:d.getFieldObject()).catch(function(d){return ae(`#collectFieldObjects: "${d}".`),null})),!c.has("Kids"))return;const u=await c.getAsync("Kids");if(Array.isArray(u))for(const d of u)await F(this,Dr,N6).call(this,e,i,d,s,r,a,o)};function TJ(n){if(n){const e=P3(n);if(e)return e.href;ae(`Invalid absolute docBaseUrl: "${n}".`)}return null}class IP{constructor({docBaseUrl:e,docId:t,enableXfa:i,evaluatorOptions:s,handler:r,password:a}){this._docBaseUrl=TJ(e),this._docId=t,this._password=a,this.enableXfa=i,s.isOffscreenCanvasSupported&&(s.isOffscreenCanvasSupported=ya.isOffscreenCanvasSupported),s.isImageDecoderSupported&&(s.isImageDecoderSupported=ya.isImageDecoderSupported),this.evaluatorOptions=Object.freeze(s),Fo.setOptions(s),Og.setOptions(s),Pr.setOptions(s);const o={...s,handler:r};Yo.setOptions(o),ef.setOptions(o),Wp.setOptions(o)}get docId(){return this._docId}get password(){return this._password}get docBaseUrl(){return this._docBaseUrl}ensureDoc(e,t){return this.ensure(this.pdfDocument,e,t)}ensureXRef(e,t){return this.ensure(this.pdfDocument.xref,e,t)}ensureCatalog(e,t){return this.ensure(this.pdfDocument.catalog,e,t)}getPage(e){return this.pdfDocument.getPage(e)}fontFallback(e,t){return this.pdfDocument.fontFallback(e,t)}cleanup(e=!1){return this.pdfDocument.cleanup(e)}async ensure(e,t,i){Cn("Abstract method `ensure` called")}requestRange(e,t){Cn("Abstract method `requestRange` called")}requestLoadedStream(e=!1){Cn("Abstract method `requestLoadedStream` called")}sendProgressiveData(e){Cn("Abstract method `sendProgressiveData` called")}updatePassword(e){this._password=e}terminate(e){Cn("Abstract method `terminate` called")}}class SC extends IP{constructor(e){super(e);const t=new ji(e.source);this.pdfDocument=new vP(this,t),this._loadedStreamPromise=Promise.resolve(t)}async ensure(e,t,i){const s=e[t];return typeof s=="function"?s.apply(e,i):s}requestRange(e,t){return Promise.resolve()}requestLoadedStream(e=!1){return this._loadedStreamPromise}terminate(e){}}class RJ extends IP{constructor(e){super(e),this.streamManager=new mH(e.source,{msgHandler:e.handler,length:e.length,disableAutoFetch:e.disableAutoFetch,rangeChunkSize:e.rangeChunkSize}),this.pdfDocument=new vP(this,this.streamManager.getStream())}async ensure(e,t,i){try{const s=e[t];return typeof s=="function"?s.apply(e,i):s}catch(s){if(!(s instanceof vi))throw s;return await this.requestRange(s.begin,s.end),this.ensure(e,t,i)}}requestRange(e,t){return this.streamManager.requestRange(e,t)}requestLoadedStream(e=!1){return this.streamManager.requestAllChunks(e)}sendProgressiveData(e){this.streamManager.onReceiveData({chunk:e})}terminate(e){this.streamManager.abort(e)}}const d9={DATA:1,ERROR:2},ms={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function IC(){}function Ca(n){if(n instanceof hr||n instanceof Gp||n instanceof jp||n instanceof Yv||n instanceof ww)return n;switch(n instanceof Error||typeof n=="object"&&n!==null||Cn('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),n.name){case"AbortException":return new hr(n.message);case"InvalidPDFException":return new Gp(n.message);case"PasswordException":return new jp(n.message,n.code);case"ResponseException":return new Yv(n.message,n.status,n.missing);case"UnknownErrorException":return new ww(n.message,n.details)}return new ww(n.message,n.toString())}var Rg,Ao,EP,TP,RP,p3;class EC{constructor(e,t,i){U(this,Ao);U(this,Rg,new AbortController);this.sourceName=e,this.targetName=t,this.comObj=i,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),i.addEventListener("message",F(this,Ao,EP).bind(this),{signal:x(this,Rg).signal})}on(e,t){const i=this.actionHandler;if(i[e])throw new Error(`There is already an actionName called "${e}"`);i[e]=t}send(e,t,i){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},i)}sendWithPromise(e,t,i){const s=this.callbackId++,r=Promise.withResolvers();this.callbackCapabilities[s]=r;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:s,data:t},i)}catch(a){r.reject(a)}return r.promise}sendWithStream(e,t,i,s){const r=this.streamId++,a=this.sourceName,o=this.targetName,l=this.comObj;return new ReadableStream({start:c=>{const h=Promise.withResolvers();return this.streamControllers[r]={controller:c,startCall:h,pullCall:null,cancelCall:null,isClosed:!1},l.postMessage({sourceName:a,targetName:o,action:e,streamId:r,data:t,desiredSize:c.desiredSize},s),h.promise},pull:c=>{const h=Promise.withResolvers();return this.streamControllers[r].pullCall=h,l.postMessage({sourceName:a,targetName:o,stream:ms.PULL,streamId:r,desiredSize:c.desiredSize}),h.promise},cancel:c=>{qs(c instanceof Error,"cancel must have a valid reason");const h=Promise.withResolvers();return this.streamControllers[r].cancelCall=h,this.streamControllers[r].isClosed=!0,l.postMessage({sourceName:a,targetName:o,stream:ms.CANCEL,streamId:r,reason:Ca(c)}),h.promise}},i)}destroy(){var e;(e=x(this,Rg))==null||e.abort(),O(this,Rg,null)}}Rg=new WeakMap,Ao=new WeakSet,EP=function({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){F(this,Ao,RP).call(this,e);return}if(e.callback){const i=e.callbackId,s=this.callbackCapabilities[i];if(!s)throw new Error(`Cannot resolve callback ${i}`);if(delete this.callbackCapabilities[i],e.callback===d9.DATA)s.resolve(e.data);else if(e.callback===d9.ERROR)s.reject(Ca(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const i=this.sourceName,s=e.sourceName,r=this.comObj;Promise.try(t,e.data).then(function(a){r.postMessage({sourceName:i,targetName:s,callback:d9.DATA,callbackId:e.callbackId,data:a})},function(a){r.postMessage({sourceName:i,targetName:s,callback:d9.ERROR,callbackId:e.callbackId,reason:Ca(a)})});return}if(e.streamId){F(this,Ao,TP).call(this,e);return}t(e.data)},TP=function(e){const t=e.streamId,i=this.sourceName,s=e.sourceName,r=this.comObj,a=this,o=this.actionHandler[e.action],l={enqueue(c,h=1,u){if(this.isCancelled)return;const d=this.desiredSize;this.desiredSize-=h,d>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),r.postMessage({sourceName:i,targetName:s,stream:ms.ENQUEUE,streamId:t,chunk:c},u)},close(){this.isCancelled||(this.isCancelled=!0,r.postMessage({sourceName:i,targetName:s,stream:ms.CLOSE,streamId:t}),delete a.streamSinks[t])},error(c){qs(c instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,r.postMessage({sourceName:i,targetName:s,stream:ms.ERROR,streamId:t,reason:Ca(c)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};l.sinkCapability.resolve(),l.ready=l.sinkCapability.promise,this.streamSinks[t]=l,Promise.try(o,e.data,l).then(function(){r.postMessage({sourceName:i,targetName:s,stream:ms.START_COMPLETE,streamId:t,success:!0})},function(c){r.postMessage({sourceName:i,targetName:s,stream:ms.START_COMPLETE,streamId:t,reason:Ca(c)})})},RP=function(e){const t=e.streamId,i=this.sourceName,s=e.sourceName,r=this.comObj,a=this.streamControllers[t],o=this.streamSinks[t];switch(e.stream){case ms.START_COMPLETE:e.success?a.startCall.resolve():a.startCall.reject(Ca(e.reason));break;case ms.PULL_COMPLETE:e.success?a.pullCall.resolve():a.pullCall.reject(Ca(e.reason));break;case ms.PULL:if(!o){r.postMessage({sourceName:i,targetName:s,stream:ms.PULL_COMPLETE,streamId:t,success:!0});break}o.desiredSize<=0&&e.desiredSize>0&&o.sinkCapability.resolve(),o.desiredSize=e.desiredSize,Promise.try(o.onPull||IC).then(function(){r.postMessage({sourceName:i,targetName:s,stream:ms.PULL_COMPLETE,streamId:t,success:!0})},function(c){r.postMessage({sourceName:i,targetName:s,stream:ms.PULL_COMPLETE,streamId:t,reason:Ca(c)})});break;case ms.ENQUEUE:if(qs(a,"enqueue should have stream controller"),a.isClosed)break;a.controller.enqueue(e.chunk);break;case ms.CLOSE:if(qs(a,"close should have stream controller"),a.isClosed)break;a.isClosed=!0,a.controller.close(),F(this,Ao,p3).call(this,a,t);break;case ms.ERROR:qs(a,"error should have stream controller"),a.controller.error(Ca(e.reason)),F(this,Ao,p3).call(this,a,t);break;case ms.CANCEL_COMPLETE:e.success?a.cancelCall.resolve():a.cancelCall.reject(Ca(e.reason)),F(this,Ao,p3).call(this,a,t);break;case ms.CANCEL:if(!o)break;const l=Ca(e.reason);Promise.try(o.onCancel||IC,l).then(function(){r.postMessage({sourceName:i,targetName:s,stream:ms.CANCEL_COMPLETE,streamId:t,success:!0})},function(c){r.postMessage({sourceName:i,targetName:s,stream:ms.CANCEL_COMPLETE,streamId:t,reason:Ca(c)})}),o.sinkCapability.reject(l),o.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}},p3=async function(e,t){var i,s,r;await Promise.allSettled([(i=e.startCall)==null?void 0:i.promise,(s=e.pullCall)==null?void 0:s.promise,(r=e.cancelCall)==null?void 0:r.promise]),delete this.streamControllers[t]};async function MP(n,e,t,{encrypt:i=null}){const s=i==null?void 0:i.createCipherTransform(n.num,n.gen);t.push(`${n.num} ${n.gen} obj
`),e instanceof ue?await vy(e,t,s):e instanceof dn?await PP(e,t,s):(Array.isArray(e)||ArrayBuffer.isView(e))&&await NP(e,t,s),t.push(`
endobj
`)}async function vy(n,e,t){e.push("<<");for(const i of n.getKeys())e.push(` /${I4(i)} `),await OP(n.getRaw(i),e,t);e.push(">>")}async function PP(n,e,t){let i=n.getBytes();const{dict:s}=n,[r,a]=await Promise.all([s.getAsync("Filter"),s.getAsync("DecodeParms")]),o=Array.isArray(r)?await s.xref.fetchIfRefAsync(r[0]):r,l=Li(o,"FlateDecode");if(i.length>=256||l)try{const u=new CompressionStream("deflate"),d=u.writable.getWriter();await d.ready,d.write(i).then(async()=>{await d.ready,await d.close()}).catch(()=>{});const f=await new Response(u.readable).arrayBuffer();i=new Uint8Array(f);let g,m;r?l||(g=Array.isArray(r)?[ve.get("FlateDecode"),...r]:[ve.get("FlateDecode"),r],a&&(m=Array.isArray(a)?[null,...a]:[null,a])):g=ve.get("FlateDecode"),g&&s.set("Filter",g),m&&s.set("DecodeParms",m)}catch(u){gn(`writeStream - cannot compress data: "${u}".`)}let h=xa(i);t&&(h=t.encryptString(h)),s.set("Length",h.length),await vy(s,e,t),e.push(` stream
`,h,`
endstream`)}async function NP(n,e,t){e.push("[");let i=!0;for(const s of n)i?i=!1:e.push(" "),await OP(s,e,t);e.push("]")}async function OP(n,e,t){n instanceof ve?e.push(`/${I4(n.name)}`):n instanceof tt?e.push(`${n.num} ${n.gen} R`):Array.isArray(n)||ArrayBuffer.isView(n)?await NP(n,e,t):typeof n=="string"?(t&&(n=t.encryptString(n)),e.push(`(${Ng(n)})`)):typeof n=="number"?e.push(kn(n)):typeof n=="boolean"?e.push(n.toString()):n instanceof ue?await vy(n,e,t):n instanceof dn?await PP(n,e,t):n===null?e.push("null"):ae(`Unhandled value in writer: ${typeof n}, please file a bug.`)}function Kw(n,e,t,i){for(let s=e+t-1;s>t-1;s--)i[s]=n&255,n>>=8;return t+e}function DP(n,e,t){const i=n.length;for(let s=0;s<i;s++)t[e+s]=n.charCodeAt(s)&255;return e+i}function MJ(n,e){const t=Math.floor(Date.now()/1e3),i=e.filename||"",s=[t.toString(),i,n.toString(),...e.infoMap.values()],r=Math.sumPrecise(s.map(l=>l.length)),a=new Uint8Array(r);let o=0;for(const l of s)o=DP(l,o,a);return xa(B0(a,0,a.length))}function PJ(n,e){const t=new uy({hasAttributes:!0}).parseFromString(n);for(const{xfa:s}of e){if(!s)continue;const{path:r,value:a}=s;if(!r)continue;const o=wR(r);let l=t.documentElement.searchNode(o,0);!l&&o.length>1&&(l=t.documentElement.searchNode([o.at(-1)],0)),l?l.childNodes=Array.isArray(a)?a.map(c=>new Cp("value",c)):[new Cp("#text",a)]:ae(`Node not found for path: ${r}`)}const i=[];return t.documentElement.dump(i),i.join("")}async function NJ({xref:n,acroForm:e,acroFormRef:t,hasXfa:i,hasXfaDatasetsEntry:s,xfaDatasetsRef:r,needAppearances:a,changes:o}){if(i&&!s&&!r&&ae("XFA - Cannot save it"),!a&&(!i||!r||s))return;const l=e.clone();if(i&&!s){const c=e.get("XFA").slice();c.splice(2,0,"datasets"),c.splice(3,0,r),l.set("XFA",c)}a&&l.set("NeedAppearances",!0),o.put(t,{data:l})}function OJ({xfaData:n,xfaDatasetsRef:e,changes:t,xref:i}){if(n===null){const r=i.fetchIfRef(e);n=PJ(r.getString(),t)}const s=new ta(n);s.dict=new ue(i),s.dict.set("Type",ve.get("EmbeddedFile")),t.put(e,{data:s})}async function DJ(n,e,t,i,s){s.push(`xref
`);const r=FP(t);let a=0;for(const{ref:o,data:l}of t)o.num===r[a]&&(s.push(`${r[a]} ${r[a+1]}
`),a+=2),l!==null?(s.push(`${e.toString().padStart(10,"0")} ${Math.min(o.gen,65535).toString().padStart(5,"0")} n\r
`),e+=l.length):s.push(`0000000000 ${Math.min(o.gen+1,65535).toString().padStart(5,"0")} f\r
`);LP(e,n,i),s.push(`trailer
`),await vy(i,s),s.push(`
startxref
`,e.toString(),`
%%EOF
`)}function FP(n){const e=[];for(const{ref:t}of n)t.num===e.at(-2)+e.at(-1)?e[e.length-1]+=1:e.push(t.num,1);return e}async function FJ(n,e,t,i,s){const r=[];let a=0,o=0;for(const{ref:m,data:b}of t){let p;a=Math.max(a,e),b!==null?(p=Math.min(m.gen,65535),r.push([1,e,p]),e+=b.length):(p=Math.min(m.gen+1,65535),r.push([0,0,p])),o=Math.max(o,p)}i.set("Index",FP(t));const l=Qv(a),c=Qv(o),h=[1,l,c];i.set("W",h),LP(e,n,i);const u=Math.sumPrecise(h),d=new Uint8Array(u*r.length),f=new ji(d);f.dict=i;let g=0;for(const[m,b,p]of r)g=Kw(m,h[0],g,d),g=Kw(b,h[1],g,d),g=Kw(p,h[2],g,d);await MP(n.newRef,f,s,{}),s.push(`startxref
`,e.toString(),`
%%EOF
`)}function LP(n,e,t){if(Array.isArray(e.fileIds)&&e.fileIds.length>0){const i=MJ(n,e);t.set("ID",[e.fileIds[0],i])}}function LJ(n,e,t){const i=new ue(null);i.set("Prev",n.startXRef);const s=n.newRef;return t?(e.put(s,{data:""}),i.set("Size",s.num+1),i.set("Type",ve.get("XRef"))):i.set("Size",s.num),n.rootRef!==null&&i.set("Root",n.rootRef),n.infoRef!==null&&i.set("Info",n.infoRef),n.encryptRef!==null&&i.set("Encrypt",n.encryptRef),i}async function BJ(n,e,t=[]){const i=[];for(const[s,{data:r}]of n.items()){if(r===null||typeof r=="string"){i.push({ref:s,data:r});continue}await MP(s,r,t,e),i.push({ref:s,data:t.join("")}),t.length=0}return i.sort((s,r)=>s.ref.num-r.ref.num)}async function UJ({originalData:n,xrefInfo:e,changes:t,xref:i=null,hasXfa:s=!1,xfaDatasetsRef:r=null,hasXfaDatasetsEntry:a=!1,needAppearances:o,acroFormRef:l=null,acroForm:c=null,xfaData:h=null,useXrefStream:u=!1}){await NJ({xref:i,acroForm:c,acroFormRef:l,hasXfa:s,hasXfaDatasetsEntry:a,xfaDatasetsRef:r,needAppearances:o,changes:t}),s&&OJ({xfaData:h,xfaDatasetsRef:r,changes:t,xref:i});const d=LJ(e,t,u),f=[],g=await BJ(t,i,f);let m=n.length;const b=n.at(-1);b!==10&&b!==13&&(f.push(`
`),m+=1);for(const{data:_}of g)_!==null&&f.push(_);await(u?FJ(e,m,g,d,f):DJ(e,m,g,d,f));const p=n.length+Math.sumPrecise(f.map(_=>_.length)),y=new Uint8Array(p);y.set(n);let w=n.length;for(const _ of f)w=DP(_,w,y);return y}class HJ{constructor(e){this._msgHandler=e,this._contentLength=null,this._fullRequestReader=null,this._rangeRequestReaders=[]}getFullReader(){return qs(!this._fullRequestReader,"PDFWorkerStream.getFullReader can only be called once."),this._fullRequestReader=new zJ(this._msgHandler),this._fullRequestReader}getRangeReader(e,t){const i=new jJ(e,t,this._msgHandler);return this._rangeRequestReaders.push(i),i}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const i of this._rangeRequestReaders.slice(0))i.cancel(e)}}class zJ{constructor(e){this._msgHandler=e,this.onProgress=null,this._contentLength=null,this._isRangeSupported=!1,this._isStreamingSupported=!1;const t=this._msgHandler.sendWithStream("GetReader");this._reader=t.getReader(),this._headersReady=this._msgHandler.sendWithPromise("ReaderHeadersReady").then(i=>{this._isStreamingSupported=i.isStreamingSupported,this._isRangeSupported=i.isRangeSupported,this._contentLength=i.contentLength})}get headersReady(){return this._headersReady}get contentLength(){return this._contentLength}get isStreamingSupported(){return this._isStreamingSupported}get isRangeSupported(){return this._isRangeSupported}async read(){const{value:e,done:t}=await this._reader.read();return t?{value:void 0,done:!0}:{value:e.buffer,done:!1}}cancel(e){this._reader.cancel(e)}}class jJ{constructor(e,t,i){this._msgHandler=i,this.onProgress=null;const s=this._msgHandler.sendWithStream("GetRangeReader",{begin:e,end:t});this._reader=s.getReader()}get isStreamingSupported(){return!1}async read(){const{value:e,done:t}=await this._reader.read();return t?{value:void 0,done:!0}:{value:e.buffer,done:!1}}cancel(e){this._reader.cancel(e)}}class hu{constructor(e){this.name=e,this.terminated=!1,this._capability=Promise.withResolvers()}get finished(){return this._capability.promise}finish(){this._capability.resolve()}terminate(){this.terminated=!0}ensureNotTerminated(){if(this.terminated)throw new Error("Worker task was terminated")}}const iv=class iv{static setup(e,t){let i=!1;e.on("test",s=>{i||(i=!0,e.send("test",s instanceof Uint8Array))}),e.on("configure",s=>{kU(s.verbosity)}),e.on("GetDocRequest",s=>this.createDocumentHandler(s,t))}static createDocumentHandler(e,t){let i,s=!1,r=null;const a=new Set,o=CU(),{docId:l,apiVersion:c}=e,h="5.3.93";if(c!==h)throw new Error(`The API version "${c}" does not match the Worker version "${h}".`);const u=(_,v)=>`The \`${_}.prototype\` contains unexpected enumerable property "${v}", thus breaking e.g. \`for...in\` iteration of ${_}s.`;for(const _ in{})throw new Error(u("Object",_));for(const _ in[])throw new Error(u("Array",_));const d=l+"_worker";let f=new EC(d,l,t);function g(){if(s)throw new Error("Worker was terminated")}function m(_){a.add(_)}function b(_){_.finish(),a.delete(_)}async function p(_){await i.ensureDoc("checkHeader"),await i.ensureDoc("parseStartXRef"),await i.ensureDoc("parse",[_]),await i.ensureDoc("checkFirstPage",[_]),await i.ensureDoc("checkLastPage",[_]);const v=await i.ensureDoc("isPureXfa");if(v){const E=new hu("loadXfaResources");m(E),await i.ensureDoc("loadXfaResources",[f,E]),b(E)}const[C,k]=await Promise.all([i.ensureDoc("numPages"),i.ensureDoc("fingerprints")]),I=v?await i.ensureDoc("htmlForXfa"):null;return{numPages:C,fingerprints:k,htmlForXfa:I}}async function y({data:_,password:v,disableAutoFetch:C,rangeChunkSize:k,length:I,docBaseUrl:E,enableXfa:T,evaluatorOptions:M}){const D={source:null,disableAutoFetch:C,docBaseUrl:E,docId:l,enableXfa:T,evaluatorOptions:M,handler:f,length:I,password:v,rangeChunkSize:k};if(_)return D.source=_,new SC(D);const H=new HJ(f),R=H.getFullReader(),z=Promise.withResolvers();let P,B=[],Z=0;return R.headersReady.then(function(){if(R.isRangeSupported){D.source=H,D.length=R.contentLength,D.disableAutoFetch||(D.disableAutoFetch=R.isStreamingSupported),P=new RJ(D);for(const G of B)P.sendProgressiveData(G);B=[],z.resolve(P),r=null}}).catch(function(G){z.reject(G),r=null}),new Promise(function(G,Y){const J=function({value:se,done:fe}){try{if(g(),fe){if(!P){const he=yR(B);B=[],I&&he.length!==I&&ae("reported HTTP length is different from actual"),D.source=he,P=new SC(D),z.resolve(P)}r=null;return}Z+=se.byteLength,R.isStreamingSupported||f.send("DocProgress",{loaded:Z,total:Math.max(Z,R.contentLength||0)}),P?P.sendProgressiveData(se):B.push(se),R.read().then(J,Y)}catch(he){Y(he)}};R.read().then(J,Y)}).catch(function(G){z.reject(G),r=null}),r=G=>{H.cancelAllRequests(G)},z.promise}function w(_){function v(I){g(),f.send("GetDoc",{pdfInfo:I})}function C(I){if(g(),I instanceof jp){const E=new hu(`PasswordException: response ${I.code}`);m(E),f.sendWithPromise("PasswordRequest",I).then(function({password:T}){b(E),i.updatePassword(T),k()}).catch(function(){b(E),f.send("DocException",I)})}else f.send("DocException",Ca(I))}function k(){g(),p(!1).then(v,function(I){if(g(),!(I instanceof o1)){C(I);return}i.requestLoadedStream().then(function(){g(),p(!0).then(v,C)})})}g(),y(_).then(function(I){if(s)throw I.terminate(new hr("Worker was terminated.")),new Error("Worker was terminated");i=I,i.requestLoadedStream(!0).then(E=>{f.send("DataLoaded",{length:E.bytes.byteLength})})}).then(k,C)}return f.on("GetPage",function(_){return i.getPage(_.pageIndex).then(function(v){return Promise.all([i.ensure(v,"rotate"),i.ensure(v,"ref"),i.ensure(v,"userUnit"),i.ensure(v,"view")]).then(function([C,k,I,E]){return{rotate:C,ref:k,refStr:(k==null?void 0:k.toString())??null,userUnit:I,view:E}})})}),f.on("GetPageIndex",function(_){const v=tt.get(_.num,_.gen);return i.ensureCatalog("getPageIndex",[v])}),f.on("GetDestinations",function(_){return i.ensureCatalog("destinations")}),f.on("GetDestination",function(_){return i.ensureCatalog("getDestination",[_.id])}),f.on("GetPageLabels",function(_){return i.ensureCatalog("pageLabels")}),f.on("GetPageLayout",function(_){return i.ensureCatalog("pageLayout")}),f.on("GetPageMode",function(_){return i.ensureCatalog("pageMode")}),f.on("GetViewerPreferences",function(_){return i.ensureCatalog("viewerPreferences")}),f.on("GetOpenAction",function(_){return i.ensureCatalog("openAction")}),f.on("GetAttachments",function(_){return i.ensureCatalog("attachments")}),f.on("GetDocJSActions",function(_){return i.ensureCatalog("jsActions")}),f.on("GetPageJSActions",function({pageIndex:_}){return i.getPage(_).then(v=>i.ensure(v,"jsActions"))}),f.on("GetOutline",function(_){return i.ensureCatalog("documentOutline")}),f.on("GetOptionalContentConfig",function(_){return i.ensureCatalog("optionalContentConfig")}),f.on("GetPermissions",function(_){return i.ensureCatalog("permissions")}),f.on("GetMetadata",function(_){return Promise.all([i.ensureDoc("documentInfo"),i.ensureCatalog("metadata")])}),f.on("GetMarkInfo",function(_){return i.ensureCatalog("markInfo")}),f.on("GetData",function(_){return i.requestLoadedStream().then(v=>v.bytes)}),f.on("GetAnnotations",function({pageIndex:_,intent:v}){return i.getPage(_).then(function(C){const k=new hu(`GetAnnotations: page ${_}`);return m(k),C.getAnnotationsData(f,k,v).then(I=>(b(k),I),I=>{throw b(k),I})})}),f.on("GetFieldObjects",function(_){return i.ensureDoc("fieldObjects").then(v=>(v==null?void 0:v.allFields)||null)}),f.on("HasJSActions",function(_){return i.ensureDoc("hasJSActions")}),f.on("GetCalculationOrderIds",function(_){return i.ensureDoc("calculationOrderIds")}),f.on("SaveDocument",async function({isPureXfa:_,numPages:v,annotationStorage:C,filename:k}){const I=[i.requestLoadedStream(),i.ensureCatalog("acroForm"),i.ensureCatalog("acroFormRef"),i.ensureDoc("startXRef"),i.ensureDoc("xref"),i.ensureDoc("linearization"),i.ensureCatalog("structTreeRoot")],E=new ma,T=[],M=_?null:vR(C),[D,H,R,z,P,B,Z]=await Promise.all(I),G=P.trailer.getRaw("Root")||null;let Y;if(M){Z?await Z.canUpdateStructTree({pdfManager:i,newAnnotationsByPage:M})&&(Y=Z):await e2.canCreateStructureTree({catalogRef:G,pdfManager:i,newAnnotationsByPage:M})&&(Y=null);const K=j0.generateImages(C.values(),P,i.evaluatorOptions.isOffscreenCanvasSupported),oe=Y===void 0?T:[];for(const[W,le]of M)oe.push(i.getPage(W).then(ce=>{const Ce=new hu(`Save (editor): page ${W}`);return m(Ce),ce.saveNewAnnotations(f,Ce,le,K,E).finally(function(){b(Ce)})}));Y===null?T.push(Promise.all(oe).then(async()=>{await e2.createStructureTree({newAnnotationsByPage:M,xref:P,catalogRef:G,pdfManager:i,changes:E})})):Y&&T.push(Promise.all(oe).then(async()=>{await Y.updateStructureTree({newAnnotationsByPage:M,pdfManager:i,changes:E})}))}if(_)T.push(i.ensureDoc("serializeXfaData",[C]));else for(let K=0;K<v;K++)T.push(i.getPage(K).then(function(oe){const W=new hu(`Save: page ${K}`);return m(W),oe.save(f,W,C,E).finally(function(){b(W)})}));const J=await Promise.all(T);let se=null;if(_){if(se=J[0],!se)return D.bytes}else if(E.size===0)return D.bytes;const fe=R&&H instanceof ue&&E.values().some(K=>K.needAppearances),he=H instanceof ue&&H.get("XFA")||null;let de=null,ge=!1;if(Array.isArray(he)){for(let K=0,oe=he.length;K<oe;K+=2)he[K]==="datasets"&&(de=he[K+1],ge=!0);de===null&&(de=P.getNewTemporaryRef())}else he&&ae("Unsupported XFA type.");let N=Object.create(null);if(P.trailer){const K=new Map,oe=P.trailer.get("Info")||null;if(oe instanceof ue)for(const[W,le]of oe)typeof le=="string"&&K.set(W,Rn(le));N={rootRef:G,encryptRef:P.trailer.getRaw("Encrypt")||null,newRef:P.getNewTemporaryRef(),infoRef:P.trailer.getRaw("Info")||null,infoMap:K,fileIds:P.trailer.get("ID")||null,startXRef:B?z:P.lastXRefStreamPos??z,filename:k}}return UJ({originalData:D.bytes,xrefInfo:N,changes:E,xref:P,hasXfa:!!he,xfaDatasetsRef:de,hasXfaDatasetsEntry:ge,needAppearances:fe,acroFormRef:R,acroForm:H,xfaData:se,useXrefStream:bR(P.topDict,"XRef")}).finally(()=>{P.resetNewTemporaryRef()})}),f.on("GetOperatorList",function(_,v){const C=_.pageIndex;i.getPage(C).then(function(k){const I=new hu(`GetOperatorList: page ${C}`);m(I);const E=o>=zp.INFOS?Date.now():0;k.getOperatorList({handler:f,sink:v,task:I,intent:_.intent,cacheKey:_.cacheKey,annotationStorage:_.annotationStorage,modifiedIds:_.modifiedIds}).then(function(T){b(I),E&&gn(`page=${C+1} - getOperatorList: time=${Date.now()-E}ms, len=${T.length}`),v.close()},function(T){b(I),!I.terminated&&v.error(T)})})}),f.on("GetTextContent",function(_,v){const{pageIndex:C,includeMarkedContent:k,disableNormalization:I}=_;i.getPage(C).then(function(E){const T=new hu("GetTextContent: page "+C);m(T);const M=o>=zp.INFOS?Date.now():0;E.extractTextContent({handler:f,task:T,sink:v,includeMarkedContent:k,disableNormalization:I}).then(function(){b(T),M&&gn(`page=${C+1} - getTextContent: time=${Date.now()-M}ms`),v.close()},function(D){b(T),!T.terminated&&v.error(D)})})}),f.on("GetStructTree",function(_){return i.getPage(_.pageIndex).then(v=>i.ensure(v,"getStructTree"))}),f.on("FontFallback",function(_){return i.fontFallback(_.id,f)}),f.on("Cleanup",function(_){return i.cleanup(!0)}),f.on("Terminate",function(_){s=!0;const v=[];if(i){i.terminate(new hr("Worker was terminated."));const C=i.cleanup();v.push(C),i=null}else G4();r==null||r(new hr("Worker was terminated."));for(const C of a)v.push(C.finished),C.terminate();return Promise.all(v).then(function(){f.destroy(),f=null})}),f.on("Ready",function(_){w(e),e=null}),d}static initializeFromPort(e){const t=new EC("worker","main",e);this.setup(t,e),t.send("ready",null)}};typeof window>"u"&&!wU&&typeof self<"u"&&typeof self.postMessage=="function"&&"onmessage"in self&&iv.initializeFromPort(self);let O6=iv;globalThis.pdfjsWorker={WorkerMessageHandler:O6};let o2="",l2="";async function GJ(){var t,i;const n=await fetch("/api/config");if(!n.ok)throw new Error("Failed to fetch Google Drive credentials");const e=await n.json();if(o2=(t=e.google_drive)==null?void 0:t.api_key,l2=(i=e.google_drive)==null?void 0:i.client_id,!o2||!l2)throw new Error("Google Drive API credentials not configured")}const VJ=["https://www.googleapis.com/auth/drive.readonly","https://www.googleapis.com/auth/drive.file"],qJ=()=>{if(!o2||!l2)throw new Error("Google Drive API credentials not configured");if(o2===""||l2==="")throw new Error("Please configure valid Google Drive API credentials")};let f9=null,TC=!1;const WJ=()=>new Promise((n,e)=>{if(typeof gapi>"u"){const t=document.createElement("script");t.src="https://apis.google.com/js/api.js",t.onload=()=>{gapi.load("picker",()=>{n(!0)})},t.onerror=e,document.body.appendChild(t)}else gapi.load("picker",()=>{n(!0)})}),KJ=()=>new Promise((n,e)=>{if(typeof google>"u"){const t=document.createElement("script");t.src="https://accounts.google.com/gsi/client",t.onload=n,t.onerror=e,document.body.appendChild(t)}else n(!0)}),XJ=async()=>f9||new Promise((n,e)=>{google.accounts.oauth2.initTokenClient({client_id:l2,scope:VJ.join(" "),callback:i=>{i.access_token?(f9=i.access_token,n(f9)):e(new Error("Failed to get access token"))},error_callback:i=>{e(new Error(i.message||"OAuth error occurred"))}}).requestAccessToken()}),YJ=async()=>{TC||(await GJ(),qJ(),await Promise.all([WJ(),KJ()]),TC=!0)},JJ=()=>new Promise(async(n,e)=>{try{await YJ();const t=await XJ();if(!t)throw console.error("Failed to get OAuth token"),new Error("Unable to get OAuth token");new google.picker.PickerBuilder().enableFeature(google.picker.Feature.NAV_HIDDEN).enableFeature(google.picker.Feature.MULTISELECT_ENABLED).addView(new google.picker.DocsView().setIncludeFolders(!1).setSelectFolderEnabled(!1).setMimeTypes("application/pdf,text/plain,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/vnd.google-apps.document,application/vnd.google-apps.spreadsheet,application/vnd.google-apps.presentation")).setOAuthToken(t).setDeveloperKey(o2).setCallback(async s=>{if(s[google.picker.Response.ACTION]===google.picker.Action.PICKED)try{const r=s[google.picker.Response.DOCUMENTS][0],a=r[google.picker.Document.ID],o=r[google.picker.Document.NAME],l=r[google.picker.Document.URL];if(!a||!o)throw new Error("Required file details missing");const c=r[google.picker.Document.MIME_TYPE];let h,u;c.includes("google-apps")?(c.includes("document")?u="text/plain":c.includes("spreadsheet")?u="text/csv":c.includes("presentation")?u="text/plain":u="application/pdf",h=`https://www.googleapis.com/drive/v3/files/${a}/export?mimeType=${encodeURIComponent(u)}`):h=`https://www.googleapis.com/drive/v3/files/${a}?alt=media`;const d=await fetch(h,{headers:{Authorization:`Bearer ${t}`,Accept:"*/*"}});if(!d.ok){const m=await d.text();throw console.error("Download failed:",{status:d.status,statusText:d.statusText,error:m}),new Error(`Failed to download file (${d.status}): ${m}`)}const f=await d.blob(),g={id:a,name:o,url:h,blob:f,headers:{Authorization:`Bearer ${t}`,Accept:"*/*"}};n(g)}catch(r){e(r)}else s[google.picker.Response.ACTION]===google.picker.Action.CANCEL&&n(null)}).build().setVisible(!0)}catch(t){console.error("Google Drive Picker error:",t),e(t)}});/*! @azure/msal-common v15.2.0 2025-02-18 */const Ge={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",DSTS:"dstsv2",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",CIAM_AUTH_URL:".ciamlogin.com",AAD_TENANT_DOMAIN_SUFFIX:".onmicrosoft.com",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_RESPONSE_TYPE:"code",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",FRAGMENT_RESPONSE_MODE:"fragment",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",NOT_APPLICABLE:"N/A",NOT_AVAILABLE:"Not Available",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],TOKEN_RESPONSE_TYPE:"token",ID_TOKEN_RESPONSE_TYPE:"id_token",SHR_NONCE_VALIDITY:240,INVALID_INSTANCE:"invalid_instance"},g9={SUCCESS:200,SUCCESS_RANGE_START:200,SUCCESS_RANGE_END:299,REDIRECT:302,CLIENT_ERROR:400,CLIENT_ERROR_RANGE_START:400,BAD_REQUEST:400,UNAUTHORIZED:401,NOT_FOUND:404,REQUEST_TIMEOUT:408,TOO_MANY_REQUESTS:429,CLIENT_ERROR_RANGE_END:499,SERVER_ERROR:500,SERVER_ERROR_RANGE_START:500,SERVICE_UNAVAILABLE:503,GATEWAY_TIMEOUT:504,SERVER_ERROR_RANGE_END:599,MULTI_SIDED_ERROR:600},Ix=[Ge.OPENID_SCOPE,Ge.PROFILE_SCOPE,Ge.OFFLINE_ACCESS_SCOPE],RC=[...Ix,Ge.EMAIL_SCOPE],Kr={CONTENT_TYPE:"Content-Type",CONTENT_LENGTH:"Content-Length",RETRY_AFTER:"Retry-After",CCS_HEADER:"X-AnchorMailbox",WWWAuthenticate:"WWW-Authenticate",AuthenticationInfo:"Authentication-Info",X_MS_REQUEST_ID:"x-ms-request-id",X_MS_HTTP_VERSION:"x-ms-httpver"},MC={ACTIVE_ACCOUNT_FILTERS:"active-account-filters"},zh={COMMON:"common",ORGANIZATIONS:"organizations",CONSUMERS:"consumers"},m9={ACCESS_TOKEN:"access_token",XMS_CC:"xms_cc"},Vs={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",CREATE:"create",NO_SESSION:"no_session"},PC={PLAIN:"plain",S256:"S256"},Ex={QUERY:"query",FRAGMENT:"fragment"},ZJ={...Ex,FORM_POST:"form_post"},BP={IMPLICIT_GRANT:"implicit",AUTHORIZATION_CODE_GRANT:"authorization_code",CLIENT_CREDENTIALS_GRANT:"client_credentials",RESOURCE_OWNER_PASSWORD_GRANT:"password",REFRESH_TOKEN_GRANT:"refresh_token",DEVICE_CODE_GRANT:"device_code",JWT_BEARER:"urn:ietf:params:oauth:grant-type:jwt-bearer"},p9={MSSTS_ACCOUNT_TYPE:"MSSTS",ADFS_ACCOUNT_TYPE:"ADFS",MSAV1_ACCOUNT_TYPE:"MSA",GENERIC_ACCOUNT_TYPE:"Generic"},Mr={CACHE_KEY_SEPARATOR:"-",CLIENT_INFO_SEPARATOR:"."},An={ID_TOKEN:"IdToken",ACCESS_TOKEN:"AccessToken",ACCESS_TOKEN_WITH_AUTH_SCHEME:"AccessToken_With_AuthScheme",REFRESH_TOKEN:"RefreshToken"},a_="appmetadata",QJ="client_info",Tp="1",$3={CACHE_KEY:"authority-metadata",REFRESH_TIME_SECONDS:3600*24},Aa={CONFIG:"config",CACHE:"cache",NETWORK:"network",HARDCODED_VALUES:"hardcoded_values"},sr={SCHEMA_VERSION:5,MAX_CUR_HEADER_BYTES:80,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"},pi={BEARER:"Bearer",POP:"pop",SSH:"ssh-cert"},Rp={DEFAULT_THROTTLE_TIME_SECONDS:60,DEFAULT_MAX_THROTTLE_TIME_SECONDS:3600,THROTTLING_PREFIX:"throttling",X_MS_LIB_CAPABILITY_VALUE:"retry-after, h429"},NC={INVALID_GRANT_ERROR:"invalid_grant",CLIENT_MISMATCH_ERROR:"client_mismatch"},OC={username:"username",password:"password"},b9={httpSuccess:200,httpBadRequest:400},Cf={FAILED_AUTO_DETECTION:"1",INTERNAL_CACHE:"2",ENVIRONMENT_VARIABLE:"3",IMDS:"4"},Xw={CONFIGURED_MATCHES_DETECTED:"1",CONFIGURED_NO_AUTO_DETECTION:"2",CONFIGURED_NOT_DETECTED:"3",AUTO_DETECTION_REQUESTED_SUCCESSFUL:"4",AUTO_DETECTION_REQUESTED_FAILED:"5"},bu={NOT_APPLICABLE:"0",FORCE_REFRESH_OR_CLAIMS:"1",NO_CACHED_ACCESS_TOKEN:"2",CACHED_ACCESS_TOKEN_EXPIRED:"3",PROACTIVELY_REFRESHED:"4"},$J={Jwt:"JWT",Jwk:"JWK",Pop:"pop"},eZ=300;/*! @azure/msal-common v15.2.0 2025-02-18 */const o_="unexpected_error",tZ="post_request_failed";/*! @azure/msal-common v15.2.0 2025-02-18 */const DC={[o_]:"Unexpected error in authentication.",[tZ]:"Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details."};class zi extends Error{constructor(e,t,i){const s=t?`${e}: ${t}`:e;super(s),Object.setPrototypeOf(this,zi.prototype),this.errorCode=e||Ge.EMPTY_STRING,this.errorMessage=t||Ge.EMPTY_STRING,this.subError=i||Ge.EMPTY_STRING,this.name="AuthError"}setCorrelationId(e){this.correlationId=e}}function UP(n,e){return new zi(n,e?`${DC[n]} ${e}`:DC[n])}/*! @azure/msal-common v15.2.0 2025-02-18 */const l_="client_info_decoding_error",HP="client_info_empty_error",c_="token_parsing_error",zP="null_or_empty_token",vc="endpoints_resolution_error",jP="network_error",GP="openid_config_error",VP="hash_not_deserialized",Gg="invalid_state",qP="state_mismatch",e5="state_not_found",WP="nonce_mismatch",h_="auth_time_not_found",KP="max_age_transpired",nZ="multiple_matching_tokens",iZ="multiple_matching_accounts",XP="multiple_matching_appMetadata",YP="request_cannot_be_made",JP="cannot_remove_empty_scope",ZP="cannot_append_scopeset",D6="empty_input_scopeset",sZ="device_code_polling_cancelled",rZ="device_code_expired",aZ="device_code_unknown_error",u_="no_account_in_silent_request",QP="invalid_cache_record",d_="invalid_cache_environment",F6="no_account_found",L6="no_crypto_object",B6="unexpected_credential_type",oZ="invalid_assertion",lZ="invalid_client_credential",jh="token_refresh_required",cZ="user_timeout_reached",$P="token_claims_cnf_required_for_signedjwt",eN="authorization_code_missing_from_server_response",tN="binding_key_not_removed",nN="end_session_endpoint_not_supported",f_="key_id_missing",hZ="no_network_connectivity",uZ="user_canceled",dZ="missing_tenant_id_error",On="method_not_implemented",fZ="nested_app_auth_bridge_disabled";/*! @azure/msal-common v15.2.0 2025-02-18 */const FC={[l_]:"The client info could not be parsed/decoded correctly",[HP]:"The client info was empty",[c_]:"Token cannot be parsed",[zP]:"The token is null or empty",[vc]:"Endpoints cannot be resolved",[jP]:"Network request failed",[GP]:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints.",[VP]:"The hash parameters could not be deserialized",[Gg]:"State was not the expected format",[qP]:"State mismatch error",[e5]:"State not found",[WP]:"Nonce mismatch error",[h_]:"Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information.",[KP]:"Max Age is set to 0, or too much time has elapsed since the last end-user authentication.",[nZ]:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account.",[iZ]:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account",[XP]:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata",[YP]:"Token request cannot be made without authorization code or refresh token.",[JP]:"Cannot remove null or empty scope from ScopeSet",[ZP]:"Cannot append ScopeSet",[D6]:"Empty input ScopeSet cannot be processed",[sZ]:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true.",[rZ]:"Device code is expired.",[aZ]:"Device code stopped polling for unknown reasons.",[u_]:"Please pass an account object, silent flow is not supported without account information",[QP]:"Cache record object was null or undefined.",[d_]:"Invalid environment when attempting to create cache entry",[F6]:"No account found in cache for given key.",[L6]:"No crypto object detected.",[B6]:"Unexpected credential type.",[oZ]:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515",[lZ]:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential",[jh]:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired.",[cZ]:"User defined timeout for device code polling reached",[$P]:"Cannot generate a POP jwt if the token_claims are not populated",[eN]:"Server response does not contain an authorization code to proceed",[tN]:"Could not remove the credential's binding key from storage.",[nN]:"The provided authority does not support logout",[f_]:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key.",[hZ]:"No network connectivity. Check your internet connection.",[uZ]:"User cancelled the flow.",[dZ]:"A tenant id - not common, organizations, or consumers - must be specified when using the client_credentials flow.",[On]:"This method has not been implemented",[fZ]:"The nested app auth bridge is disabled"};class g_ extends zi{constructor(e,t){super(e,t?`${FC[e]}: ${t}`:FC[e]),this.name="ClientAuthError",Object.setPrototypeOf(this,g_.prototype)}}function ut(n,e){return new g_(n,e)}/*! @azure/msal-common v15.2.0 2025-02-18 */const t5={createNewGuid:()=>{throw ut(On)},base64Decode:()=>{throw ut(On)},base64Encode:()=>{throw ut(On)},base64UrlEncode:()=>{throw ut(On)},encodeKid:()=>{throw ut(On)},async getPublicKeyThumbprint(){throw ut(On)},async removeTokenBindingKey(){throw ut(On)},async clearKeystore(){throw ut(On)},async signJwt(){throw ut(On)},async hashString(){throw ut(On)}};/*! @azure/msal-common v15.2.0 2025-02-18 */var Di;(function(n){n[n.Error=0]="Error",n[n.Warning=1]="Warning",n[n.Info=2]="Info",n[n.Verbose=3]="Verbose",n[n.Trace=4]="Trace"})(Di||(Di={}));class Xh{constructor(e,t,i){this.level=Di.Info;const s=()=>{},r=e||Xh.createDefaultLoggerOptions();this.localCallback=r.loggerCallback||s,this.piiLoggingEnabled=r.piiLoggingEnabled||!1,this.level=typeof r.logLevel=="number"?r.logLevel:Di.Info,this.correlationId=r.correlationId||Ge.EMPTY_STRING,this.packageName=t||Ge.EMPTY_STRING,this.packageVersion=i||Ge.EMPTY_STRING}static createDefaultLoggerOptions(){return{loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:Di.Info}}clone(e,t,i){return new Xh({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:i||this.correlationId},e,t)}logMessage(e,t){if(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)return;const r=`${`[${new Date().toUTCString()}] : [${t.correlationId||this.correlationId||""}]`} : ${this.packageName}@${this.packageVersion} : ${Di[t.logLevel]} - ${e}`;this.executeCallback(t.logLevel,r,t.containsPii||!1)}executeCallback(e,t,i){this.localCallback&&this.localCallback(e,t,i)}error(e,t){this.logMessage(e,{logLevel:Di.Error,containsPii:!1,correlationId:t||Ge.EMPTY_STRING})}errorPii(e,t){this.logMessage(e,{logLevel:Di.Error,containsPii:!0,correlationId:t||Ge.EMPTY_STRING})}warning(e,t){this.logMessage(e,{logLevel:Di.Warning,containsPii:!1,correlationId:t||Ge.EMPTY_STRING})}warningPii(e,t){this.logMessage(e,{logLevel:Di.Warning,containsPii:!0,correlationId:t||Ge.EMPTY_STRING})}info(e,t){this.logMessage(e,{logLevel:Di.Info,containsPii:!1,correlationId:t||Ge.EMPTY_STRING})}infoPii(e,t){this.logMessage(e,{logLevel:Di.Info,containsPii:!0,correlationId:t||Ge.EMPTY_STRING})}verbose(e,t){this.logMessage(e,{logLevel:Di.Verbose,containsPii:!1,correlationId:t||Ge.EMPTY_STRING})}verbosePii(e,t){this.logMessage(e,{logLevel:Di.Verbose,containsPii:!0,correlationId:t||Ge.EMPTY_STRING})}trace(e,t){this.logMessage(e,{logLevel:Di.Trace,containsPii:!1,correlationId:t||Ge.EMPTY_STRING})}tracePii(e,t){this.logMessage(e,{logLevel:Di.Trace,containsPii:!0,correlationId:t||Ge.EMPTY_STRING})}isPiiLoggingEnabled(){return this.piiLoggingEnabled||!1}}/*! @azure/msal-common v15.2.0 2025-02-18 */const iN="@azure/msal-common",m_="15.2.0";/*! @azure/msal-common v15.2.0 2025-02-18 */const p_={None:"none",AzurePublic:"https://login.microsoftonline.com",AzurePpe:"https://login.windows-ppe.net",AzureChina:"https://login.chinacloudapi.cn",AzureGermany:"https://login.microsoftonline.de",AzureUsGovernment:"https://login.microsoftonline.us"};/*! @azure/msal-common v15.2.0 2025-02-18 */function sm(n,e){const t=gZ(n);try{const i=e(t);return JSON.parse(i)}catch{throw ut(c_)}}function gZ(n){if(!n)throw ut(zP);const t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(n);if(!t||t.length<4)throw ut(c_);return t[2]}function sN(n,e){if(e===0||Date.now()-3e5>n+e)throw ut(KP)}/*! @azure/msal-common v15.2.0 2025-02-18 */function dc(){return Math.round(new Date().getTime()/1e3)}function U6(n,e){const t=Number(n)||0;return dc()+e>t}function mZ(n){return Number(n)>dc()}/*! @azure/msal-common v15.2.0 2025-02-18 */function Mp(n){return[yZ(n),wZ(n),_Z(n),vZ(n),kZ(n)].join(Mr.CACHE_KEY_SEPARATOR).toLowerCase()}function ky(n,e,t,i,s){return{credentialType:An.ID_TOKEN,homeAccountId:n,environment:e,clientId:i,secret:t,realm:s}}function Cy(n,e,t,i,s,r,a,o,l,c,h,u,d,f,g){var b,p;const m={homeAccountId:n,credentialType:An.ACCESS_TOKEN,secret:t,cachedAt:dc().toString(),expiresOn:a.toString(),extendedExpiresOn:o.toString(),environment:e,clientId:i,realm:s,target:r,tokenType:h||pi.BEARER};if(u&&(m.userAssertionHash=u),c&&(m.refreshOn=c.toString()),f&&(m.requestedClaims=f,m.requestedClaimsHash=g),((b=m.tokenType)==null?void 0:b.toLowerCase())!==pi.BEARER.toLowerCase())switch(m.credentialType=An.ACCESS_TOKEN_WITH_AUTH_SCHEME,m.tokenType){case pi.POP:const y=sm(t,l);if(!((p=y==null?void 0:y.cnf)!=null&&p.kid))throw ut($P);m.keyId=y.cnf.kid;break;case pi.SSH:m.keyId=d}return m}function rN(n,e,t,i,s,r,a){const o={credentialType:An.REFRESH_TOKEN,homeAccountId:n,environment:e,clientId:i,secret:t};return r&&(o.userAssertionHash=r),s&&(o.familyId=s),a&&(o.expiresOn=a.toString()),o}function b_(n){return n.hasOwnProperty("homeAccountId")&&n.hasOwnProperty("environment")&&n.hasOwnProperty("credentialType")&&n.hasOwnProperty("clientId")&&n.hasOwnProperty("secret")}function pZ(n){return n?b_(n)&&n.hasOwnProperty("realm")&&n.hasOwnProperty("target")&&(n.credentialType===An.ACCESS_TOKEN||n.credentialType===An.ACCESS_TOKEN_WITH_AUTH_SCHEME):!1}function bZ(n){return n?b_(n)&&n.hasOwnProperty("realm")&&n.credentialType===An.ID_TOKEN:!1}function xZ(n){return n?b_(n)&&n.credentialType===An.REFRESH_TOKEN:!1}function yZ(n){return[n.homeAccountId,n.environment].join(Mr.CACHE_KEY_SEPARATOR).toLowerCase()}function wZ(n){const e=n.credentialType===An.REFRESH_TOKEN&&n.familyId||n.clientId;return[n.credentialType,e,n.realm||""].join(Mr.CACHE_KEY_SEPARATOR).toLowerCase()}function _Z(n){return(n.target||"").toLowerCase()}function vZ(n){return(n.requestedClaimsHash||"").toLowerCase()}function kZ(n){return n.tokenType&&n.tokenType.toLowerCase()!==pi.BEARER.toLowerCase()?n.tokenType.toLowerCase():""}function CZ(n,e){const t=n.indexOf(sr.CACHE_KEY)===0;let i=!0;return e&&(i=e.hasOwnProperty("failedRequests")&&e.hasOwnProperty("errors")&&e.hasOwnProperty("cacheHits")),t&&i}function AZ(n,e){let t=!1;n&&(t=n.indexOf(Rp.THROTTLING_PREFIX)===0);let i=!0;return e&&(i=e.hasOwnProperty("throttleTime")),t&&i}function SZ({environment:n,clientId:e}){return[a_,n,e].join(Mr.CACHE_KEY_SEPARATOR).toLowerCase()}function IZ(n,e){return e?n.indexOf(a_)===0&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("environment"):!1}function EZ(n,e){return e?n.indexOf($3.CACHE_KEY)===0&&e.hasOwnProperty("aliases")&&e.hasOwnProperty("preferred_cache")&&e.hasOwnProperty("preferred_network")&&e.hasOwnProperty("canonical_authority")&&e.hasOwnProperty("authorization_endpoint")&&e.hasOwnProperty("token_endpoint")&&e.hasOwnProperty("issuer")&&e.hasOwnProperty("aliasesFromNetwork")&&e.hasOwnProperty("endpointsFromNetwork")&&e.hasOwnProperty("expiresAt")&&e.hasOwnProperty("jwks_uri"):!1}function LC(){return dc()+$3.REFRESH_TIME_SECONDS}function x9(n,e,t){n.authorization_endpoint=e.authorization_endpoint,n.token_endpoint=e.token_endpoint,n.end_session_endpoint=e.end_session_endpoint,n.issuer=e.issuer,n.endpointsFromNetwork=t,n.jwks_uri=e.jwks_uri}function Yw(n,e,t){n.aliases=e.aliases,n.preferred_cache=e.preferred_cache,n.preferred_network=e.preferred_network,n.aliasesFromNetwork=t}function BC(n){return n.expiresAt<=dc()}/*! @azure/msal-common v15.2.0 2025-02-18 */const aN="redirect_uri_empty",TZ="claims_request_parsing_error",oN="authority_uri_insecure",wp="url_parse_error",lN="empty_url_error",cN="empty_input_scopes_error",hN="invalid_prompt_value",x_="invalid_claims",uN="token_request_empty",dN="logout_request_empty",fN="invalid_code_challenge_method",y_="pkce_params_missing",w_="invalid_cloud_discovery_metadata",gN="invalid_authority_metadata",mN="untrusted_authority",Ay="missing_ssh_jwk",pN="missing_ssh_kid",RZ="missing_nonce_authentication_header",MZ="invalid_authentication_header",bN="cannot_set_OIDCOptions",xN="cannot_allow_platform_broker",yN="authority_mismatch";/*! @azure/msal-common v15.2.0 2025-02-18 */const PZ={[aN]:"A redirect URI is required for all calls, and none has been set.",[TZ]:"Could not parse the given claims request object.",[oN]:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options",[wp]:"URL could not be parsed into appropriate segments.",[lN]:"URL was empty or null.",[cN]:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token.",[hN]:"Please see here for valid configuration options: https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_common.html#commonauthorizationurlrequest",[x_]:"Given claims parameter must be a stringified JSON object.",[uN]:"Token request was empty and not found in cache.",[dN]:"The logout request was null or undefined.",[fN]:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".',[y_]:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request",[w_]:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields",[gN]:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields.",[mN]:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter.",[Ay]:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme.",[pN]:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme.",[RZ]:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce.",[MZ]:"Invalid authentication header provided",[bN]:"Cannot set OIDCOptions parameter. Please change the protocol mode to OIDC or use a non-Microsoft authority.",[xN]:"Cannot set allowPlatformBroker parameter to true when not in AAD protocol mode.",[yN]:"Authority mismatch error. Authority provided in login request or PublicClientApplication config does not match the environment of the provided account. Please use a matching account or make an interactive request to login to this authority."};class __ extends zi{constructor(e){super(e,PZ[e]),this.name="ClientConfigurationError",Object.setPrototypeOf(this,__.prototype)}}function ki(n){return new __(n)}/*! @azure/msal-common v15.2.0 2025-02-18 */class oc{static isEmptyObj(e){if(e)try{const t=JSON.parse(e);return Object.keys(t).length===0}catch{}return!0}static startsWith(e,t){return e.indexOf(t)===0}static endsWith(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length}static queryStringToObject(e){const t={},i=e.split("&"),s=r=>decodeURIComponent(r.replace(/\+/g," "));return i.forEach(r=>{if(r.trim()){const[a,o]=r.split(/=(.+)/g,2);a&&o&&(t[s(a)]=s(o))}}),t}static trimArrayEntries(e){return e.map(t=>t.trim())}static removeEmptyStringsFromArray(e){return e.filter(t=>!!t)}static jsonParseHelper(e){try{return JSON.parse(e)}catch{return null}}static matchPattern(e,t){return new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(t)}}/*! @azure/msal-common v15.2.0 2025-02-18 */class cs{constructor(e){const t=e?oc.trimArrayEntries([...e]):[],i=t?oc.removeEmptyStringsFromArray(t):[];if(!i||!i.length)throw ki(cN);this.scopes=new Set,i.forEach(s=>this.scopes.add(s))}static fromString(e){const i=(e||Ge.EMPTY_STRING).split(" ");return new cs(i)}static createSearchScopes(e){const t=new cs(e);return t.containsOnlyOIDCScopes()?t.removeScope(Ge.OFFLINE_ACCESS_SCOPE):t.removeOIDCScopes(),t}containsScope(e){const t=this.printScopesLowerCase().split(" "),i=new cs(t);return e?i.scopes.has(e.toLowerCase()):!1}containsScopeSet(e){return!e||e.scopes.size<=0?!1:this.scopes.size>=e.scopes.size&&e.asArray().every(t=>this.containsScope(t))}containsOnlyOIDCScopes(){let e=0;return RC.forEach(t=>{this.containsScope(t)&&(e+=1)}),this.scopes.size===e}appendScope(e){e&&this.scopes.add(e.trim())}appendScopes(e){try{e.forEach(t=>this.appendScope(t))}catch{throw ut(ZP)}}removeScope(e){if(!e)throw ut(JP);this.scopes.delete(e.trim())}removeOIDCScopes(){RC.forEach(e=>{this.scopes.delete(e)})}unionScopeSets(e){if(!e)throw ut(D6);const t=new Set;return e.scopes.forEach(i=>t.add(i.toLowerCase())),this.scopes.forEach(i=>t.add(i.toLowerCase())),t}intersectingScopeSets(e){if(!e)throw ut(D6);e.containsOnlyOIDCScopes()||e.removeOIDCScopes();const t=this.unionScopeSets(e),i=e.getScopeCount(),s=this.getScopeCount();return t.size<s+i}getScopeCount(){return this.scopes.size}asArray(){const e=[];return this.scopes.forEach(t=>e.push(t)),e}printScopes(){return this.scopes?this.asArray().join(" "):Ge.EMPTY_STRING}printScopesLowerCase(){return this.printScopes().toLowerCase()}}/*! @azure/msal-common v15.2.0 2025-02-18 */function n5(n,e){if(!n)throw ut(HP);try{const t=e(n);return JSON.parse(t)}catch{throw ut(l_)}}function qf(n){if(!n)throw ut(l_);const e=n.split(Mr.CLIENT_INFO_SEPARATOR,2);return{uid:e[0],utid:e.length<2?Ge.EMPTY_STRING:e[1]}}/*! @azure/msal-common v15.2.0 2025-02-18 */function UC(n,e){return!!n&&!!e&&n===e.split(".")[1]}function v_(n,e,t,i){if(i){const{oid:s,sub:r,tid:a,name:o,tfp:l,acr:c}=i,h=a||l||c||"";return{tenantId:h,localAccountId:s||r||"",name:o,isHomeTenant:UC(h,n)}}else return{tenantId:t,localAccountId:e,isHomeTenant:UC(t,n)}}function k_(n,e,t,i){let s=n;if(e){const{isHomeTenant:r,...a}=e;s={...n,...a}}if(t){const{isHomeTenant:r,...a}=v_(n.homeAccountId,n.localAccountId,n.tenantId,t);return s={...s,...a,idTokenClaims:t,idToken:i},s}return s}/*! @azure/msal-common v15.2.0 2025-02-18 */const Zo={Default:0,Adfs:1,Dsts:2,Ciam:3};/*! @azure/msal-common v15.2.0 2025-02-18 */function wN(n){return n&&(n.tid||n.tfp||n.acr)||null}/*! @azure/msal-common v15.2.0 2025-02-18 */const p0={AAD:"AAD",OIDC:"OIDC"};/*! @azure/msal-common v15.2.0 2025-02-18 */class $r{generateAccountId(){return[this.homeAccountId,this.environment].join(Mr.CACHE_KEY_SEPARATOR).toLowerCase()}generateAccountKey(){return $r.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})}getAccountInfo(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,nativeAccountId:this.nativeAccountId,authorityType:this.authorityType,tenantProfiles:new Map((this.tenantProfiles||[]).map(e=>[e.tenantId,e]))}}isSingleTenant(){return!this.tenantProfiles}static generateAccountCacheKey(e){const t=e.homeAccountId.split(".")[1];return[e.homeAccountId,e.environment||"",t||e.tenantId||""].join(Mr.CACHE_KEY_SEPARATOR).toLowerCase()}static createAccount(e,t,i){var c,h,u,d,f,g;const s=new $r;t.authorityType===Zo.Adfs?s.authorityType=p9.ADFS_ACCOUNT_TYPE:t.protocolMode===p0.AAD?s.authorityType=p9.MSSTS_ACCOUNT_TYPE:s.authorityType=p9.GENERIC_ACCOUNT_TYPE;let r;e.clientInfo&&i&&(r=n5(e.clientInfo,i)),s.clientInfo=e.clientInfo,s.homeAccountId=e.homeAccountId,s.nativeAccountId=e.nativeAccountId;const a=e.environment||t&&t.getPreferredCache();if(!a)throw ut(d_);s.environment=a,s.realm=(r==null?void 0:r.utid)||wN(e.idTokenClaims)||"",s.localAccountId=(r==null?void 0:r.uid)||((c=e.idTokenClaims)==null?void 0:c.oid)||((h=e.idTokenClaims)==null?void 0:h.sub)||"";const o=((u=e.idTokenClaims)==null?void 0:u.preferred_username)||((d=e.idTokenClaims)==null?void 0:d.upn),l=(f=e.idTokenClaims)!=null&&f.emails?e.idTokenClaims.emails[0]:null;if(s.username=o||l||"",s.name=((g=e.idTokenClaims)==null?void 0:g.name)||"",s.cloudGraphHostName=e.cloudGraphHostName,s.msGraphHost=e.msGraphHost,e.tenantProfiles)s.tenantProfiles=e.tenantProfiles;else{const m=v_(e.homeAccountId,s.localAccountId,s.realm,e.idTokenClaims);s.tenantProfiles=[m]}return s}static createFromAccountInfo(e,t,i){var r;const s=new $r;return s.authorityType=e.authorityType||p9.GENERIC_ACCOUNT_TYPE,s.homeAccountId=e.homeAccountId,s.localAccountId=e.localAccountId,s.nativeAccountId=e.nativeAccountId,s.realm=e.tenantId,s.environment=e.environment,s.username=e.username,s.name=e.name,s.cloudGraphHostName=t,s.msGraphHost=i,s.tenantProfiles=Array.from(((r=e.tenantProfiles)==null?void 0:r.values())||[]),s}static generateHomeAccountId(e,t,i,s,r){if(!(t===Zo.Adfs||t===Zo.Dsts)){if(e)try{const a=n5(e,s.base64Decode);if(a.uid&&a.utid)return`${a.uid}.${a.utid}`}catch{}i.warning("No client info in response")}return(r==null?void 0:r.sub)||""}static isAccountEntity(e){return e?e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType"):!1}static accountInfoIsEqual(e,t,i){if(!e||!t)return!1;let s=!0;if(i){const r=e.idTokenClaims||{},a=t.idTokenClaims||{};s=r.iat===a.iat&&r.nonce===a.nonce}return e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username&&e.tenantId===t.tenantId&&e.environment===t.environment&&e.nativeAccountId===t.nativeAccountId&&s}}/*! @azure/msal-common v15.2.0 2025-02-18 */function _N(n){return n.startsWith("#/")?n.substring(2):n.startsWith("#")||n.startsWith("?")?n.substring(1):n}function i5(n){if(!n||n.indexOf("=")<0)return null;try{const e=_N(n),t=Object.fromEntries(new URLSearchParams(e));if(t.code||t.error||t.error_description||t.state)return t}catch{throw ut(VP)}return null}/*! @azure/msal-common v15.2.0 2025-02-18 */class Zn{get urlString(){return this._urlString}constructor(e){if(this._urlString=e,!this._urlString)throw ki(lN);e.includes("#")||(this._urlString=Zn.canonicalizeUri(e))}static canonicalizeUri(e){if(e){let t=e.toLowerCase();return oc.endsWith(t,"?")?t=t.slice(0,-1):oc.endsWith(t,"?/")&&(t=t.slice(0,-2)),oc.endsWith(t,"/")||(t+="/"),t}return e}validateAsUri(){let e;try{e=this.getUrlComponents()}catch{throw ki(wp)}if(!e.HostNameAndPort||!e.PathSegments)throw ki(wp);if(!e.Protocol||e.Protocol.toLowerCase()!=="https:")throw ki(oN)}static appendQueryString(e,t){return t?e.indexOf("?")<0?`${e}?${t}`:`${e}&${t}`:e}static removeHashFromUrl(e){return Zn.canonicalizeUri(e.split("#")[0])}replaceTenantPath(e){const t=this.getUrlComponents(),i=t.PathSegments;return e&&i.length!==0&&(i[0]===zh.COMMON||i[0]===zh.ORGANIZATIONS)&&(i[0]=e),Zn.constructAuthorityUriFromObject(t)}getUrlComponents(){const e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw ki(wp);const i={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5],QueryString:t[7]};let s=i.AbsolutePath.split("/");return s=s.filter(r=>r&&r.length>0),i.PathSegments=s,i.QueryString&&i.QueryString.endsWith("/")&&(i.QueryString=i.QueryString.substring(0,i.QueryString.length-1)),i}static getDomainFromUrl(e){const t=RegExp("^([^:/?#]+://)?([^/?#]*)"),i=e.match(t);if(!i)throw ki(wp);return i[2]}static getAbsoluteUrl(e,t){if(e[0]===Ge.FORWARD_SLASH){const s=new Zn(t).getUrlComponents();return s.Protocol+"//"+s.HostNameAndPort+e}return e}static constructAuthorityUriFromObject(e){return new Zn(e.Protocol+"//"+e.HostNameAndPort+"/"+e.PathSegments.join("/"))}static hashContainsKnownProperties(e){return!!i5(e)}}/*! @azure/msal-common v15.2.0 2025-02-18 */const vN={endpointMetadata:{"login.microsoftonline.com":{token_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.com/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/logout"},"login.chinacloudapi.cn":{token_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.chinacloudapi.cn/{tenantid}/discovery/v2.0/keys",issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",authorization_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/logout"},"login.microsoftonline.us":{token_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.us/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/logout"}},instanceDiscoveryMetadata:{tenant_discovery_endpoint:"https://{canonicalAuthority}/v2.0/.well-known/openid-configuration",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]}},HC=vN.endpointMetadata,C_=vN.instanceDiscoveryMetadata,kN=new Set;C_.metadata.forEach(n=>{n.aliases.forEach(e=>{kN.add(e)})});function NZ(n,e){var s;let t;const i=n.canonicalAuthority;if(i){const r=new Zn(i).getUrlComponents().HostNameAndPort;t=zC(r,(s=n.cloudDiscoveryMetadata)==null?void 0:s.metadata,Aa.CONFIG,e)||zC(r,C_.metadata,Aa.HARDCODED_VALUES,e)||n.knownAuthorities}return t||[]}function zC(n,e,t,i){if(i==null||i.trace(`getAliasesFromMetadata called with source: ${t}`),n&&e){const s=s5(e,n);if(s)return i==null||i.trace(`getAliasesFromMetadata: found cloud discovery metadata in ${t}, returning aliases`),s.aliases;i==null||i.trace(`getAliasesFromMetadata: did not find cloud discovery metadata in ${t}`)}return null}function OZ(n){return s5(C_.metadata,n)}function s5(n,e){for(let t=0;t<n.length;t++){const i=n[t];if(i.aliases.includes(e))return i}return null}/*! @azure/msal-common v15.2.0 2025-02-18 */const CN="cache_quota_exceeded",A_="cache_error_unknown";/*! @azure/msal-common v15.2.0 2025-02-18 */const Jw={[CN]:"Exceeded cache storage capacity.",[A_]:"Unexpected error occurred when using cache storage."};class f1 extends Error{constructor(e,t){const i=t||(Jw[e]?Jw[e]:Jw[A_]);super(`${e}: ${i}`),Object.setPrototypeOf(this,f1.prototype),this.name="CacheError",this.errorCode=e,this.errorMessage=i}}/*! @azure/msal-common v15.2.0 2025-02-18 */class H6{constructor(e,t,i,s){this.clientId=e,this.cryptoImpl=t,this.commonLogger=i.clone(iN,m_),this.staticAuthorityOptions=s}getAllAccounts(e){return this.buildTenantProfiles(this.getAccountsFilteredBy(e||{}),e)}getAccountInfoFilteredBy(e){const t=this.getAllAccounts(e);return t.length>1?t.sort(s=>s.idTokenClaims?-1:1)[0]:t.length===1?t[0]:null}getBaseAccountInfo(e){const t=this.getAccountsFilteredBy(e);return t.length>0?t[0].getAccountInfo():null}buildTenantProfiles(e,t){return e.flatMap(i=>this.getTenantProfilesFromAccountEntity(i,t==null?void 0:t.tenantId,t))}getTenantedAccountInfoByFilter(e,t,i,s){let r=null,a;if(s&&!this.tenantProfileMatchesFilter(i,s))return null;const o=this.getIdToken(e,t,i.tenantId);return o&&(a=sm(o.secret,this.cryptoImpl.base64Decode),!this.idTokenClaimsMatchTenantProfileFilter(a,s))?null:(r=k_(e,i,a,o==null?void 0:o.secret),r)}getTenantProfilesFromAccountEntity(e,t,i){const s=e.getAccountInfo();let r=s.tenantProfiles||new Map;const a=this.getTokenKeys();if(t){const l=r.get(t);if(l)r=new Map([[t,l]]);else return[]}const o=[];return r.forEach(l=>{const c=this.getTenantedAccountInfoByFilter(s,a,l,i);c&&o.push(c)}),o}tenantProfileMatchesFilter(e,t){return!(t.localAccountId&&!this.matchLocalAccountIdFromTenantProfile(e,t.localAccountId)||t.name&&e.name!==t.name||t.isHomeTenant!==void 0&&e.isHomeTenant!==t.isHomeTenant)}idTokenClaimsMatchTenantProfileFilter(e,t){return!(t&&(t.localAccountId&&!this.matchLocalAccountIdFromTokenClaims(e,t.localAccountId)||t.loginHint&&!this.matchLoginHintFromTokenClaims(e,t.loginHint)||t.username&&!this.matchUsername(e.preferred_username,t.username)||t.name&&!this.matchName(e,t.name)||t.sid&&!this.matchSid(e,t.sid)))}async saveCacheRecord(e,t,i){var s,r,a,o;if(!e)throw ut(QP);try{e.account&&await this.setAccount(e.account,t),e.idToken&&(i==null?void 0:i.idToken)!==!1&&await this.setIdTokenCredential(e.idToken,t),e.accessToken&&(i==null?void 0:i.accessToken)!==!1&&await this.saveAccessToken(e.accessToken,t),e.refreshToken&&(i==null?void 0:i.refreshToken)!==!1&&await this.setRefreshTokenCredential(e.refreshToken,t),e.appMetadata&&this.setAppMetadata(e.appMetadata)}catch(l){throw(s=this.commonLogger)==null||s.error("CacheManager.saveCacheRecord: failed"),l instanceof Error?((r=this.commonLogger)==null||r.errorPii(`CacheManager.saveCacheRecord: ${l.message}`,t),l.name==="QuotaExceededError"||l.name==="NS_ERROR_DOM_QUOTA_REACHED"||l.message.includes("exceeded the quota")?((a=this.commonLogger)==null||a.error("CacheManager.saveCacheRecord: exceeded storage quota",t),new f1(CN)):new f1(l.name,l.message)):((o=this.commonLogger)==null||o.errorPii(`CacheManager.saveCacheRecord: ${l}`,t),new f1(A_))}}async saveAccessToken(e,t){const i={clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm,tokenType:e.tokenType,requestedClaimsHash:e.requestedClaimsHash},s=this.getTokenKeys(),r=cs.fromString(e.target),a=[];s.accessToken.forEach(o=>{if(!this.accessTokenKeyMatchesFilter(o,i,!1))return;const l=this.getAccessTokenCredential(o);l&&this.credentialMatchesFilter(l,i)&&cs.fromString(l.target).intersectingScopeSets(r)&&a.push(this.removeAccessToken(o))}),await Promise.all(a),await this.setAccessTokenCredential(e,t)}getAccountsFilteredBy(e){const t=this.getAccountKeys(),i=[];return t.forEach(s=>{var l;if(!this.isAccountKey(s,e.homeAccountId))return;const r=this.getAccount(s,this.commonLogger);if(!r||e.homeAccountId&&!this.matchHomeAccountId(r,e.homeAccountId)||e.username&&!this.matchUsername(r.username,e.username)||e.environment&&!this.matchEnvironment(r,e.environment)||e.realm&&!this.matchRealm(r,e.realm)||e.nativeAccountId&&!this.matchNativeAccountId(r,e.nativeAccountId)||e.authorityType&&!this.matchAuthorityType(r,e.authorityType))return;const a={localAccountId:e==null?void 0:e.localAccountId,name:e==null?void 0:e.name},o=(l=r.tenantProfiles)==null?void 0:l.filter(c=>this.tenantProfileMatchesFilter(c,a));o&&o.length===0||i.push(r)}),i}isAccountKey(e,t,i){return!(e.split(Mr.CACHE_KEY_SEPARATOR).length<3||t&&!e.toLowerCase().includes(t.toLowerCase())||i&&!e.toLowerCase().includes(i.toLowerCase()))}isCredentialKey(e){if(e.split(Mr.CACHE_KEY_SEPARATOR).length<6)return!1;const t=e.toLowerCase();if(t.indexOf(An.ID_TOKEN.toLowerCase())===-1&&t.indexOf(An.ACCESS_TOKEN.toLowerCase())===-1&&t.indexOf(An.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())===-1&&t.indexOf(An.REFRESH_TOKEN.toLowerCase())===-1)return!1;if(t.indexOf(An.REFRESH_TOKEN.toLowerCase())>-1){const i=`${An.REFRESH_TOKEN}${Mr.CACHE_KEY_SEPARATOR}${this.clientId}${Mr.CACHE_KEY_SEPARATOR}`,s=`${An.REFRESH_TOKEN}${Mr.CACHE_KEY_SEPARATOR}${Tp}${Mr.CACHE_KEY_SEPARATOR}`;if(t.indexOf(i.toLowerCase())===-1&&t.indexOf(s.toLowerCase())===-1)return!1}else if(t.indexOf(this.clientId.toLowerCase())===-1)return!1;return!0}credentialMatchesFilter(e,t){return!(t.clientId&&!this.matchClientId(e,t.clientId)||t.userAssertionHash&&!this.matchUserAssertionHash(e,t.userAssertionHash)||typeof t.homeAccountId=="string"&&!this.matchHomeAccountId(e,t.homeAccountId)||t.environment&&!this.matchEnvironment(e,t.environment)||t.realm&&!this.matchRealm(e,t.realm)||t.credentialType&&!this.matchCredentialType(e,t.credentialType)||t.familyId&&!this.matchFamilyId(e,t.familyId)||t.target&&!this.matchTarget(e,t.target)||(t.requestedClaimsHash||e.requestedClaimsHash)&&e.requestedClaimsHash!==t.requestedClaimsHash||e.credentialType===An.ACCESS_TOKEN_WITH_AUTH_SCHEME&&(t.tokenType&&!this.matchTokenType(e,t.tokenType)||t.tokenType===pi.SSH&&t.keyId&&!this.matchKeyId(e,t.keyId)))}getAppMetadataFilteredBy(e){const t=this.getKeys(),i={};return t.forEach(s=>{if(!this.isAppMetadata(s))return;const r=this.getAppMetadata(s);r&&(e.environment&&!this.matchEnvironment(r,e.environment)||e.clientId&&!this.matchClientId(r,e.clientId)||(i[s]=r))}),i}getAuthorityMetadataByAlias(e){const t=this.getAuthorityMetadataKeys();let i=null;return t.forEach(s=>{if(!this.isAuthorityMetadata(s)||s.indexOf(this.clientId)===-1)return;const r=this.getAuthorityMetadata(s);r&&r.aliases.indexOf(e)!==-1&&(i=r)}),i}async removeAllAccounts(){const e=this.getAccountKeys(),t=[];e.forEach(i=>{t.push(this.removeAccount(i))}),await Promise.all(t)}async removeAccount(e){const t=this.getAccount(e,this.commonLogger);t&&(await this.removeAccountContext(t),this.removeItem(e))}async removeAccountContext(e){const t=this.getTokenKeys(),i=e.generateAccountId(),s=[];t.idToken.forEach(r=>{r.indexOf(i)===0&&this.removeIdToken(r)}),t.accessToken.forEach(r=>{r.indexOf(i)===0&&s.push(this.removeAccessToken(r))}),t.refreshToken.forEach(r=>{r.indexOf(i)===0&&this.removeRefreshToken(r)}),await Promise.all(s)}async removeAccessToken(e){const t=this.getAccessTokenCredential(e);if(t){if(t.credentialType.toLowerCase()===An.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase()&&t.tokenType===pi.POP){const s=t.keyId;if(s)try{await this.cryptoImpl.removeTokenBindingKey(s)}catch{throw ut(tN)}}return this.removeItem(e)}}removeAppMetadata(){return this.getKeys().forEach(t=>{this.isAppMetadata(t)&&this.removeItem(t)}),!0}readAccountFromCache(e){const t=$r.generateAccountCacheKey(e);return this.getAccount(t,this.commonLogger)}getIdToken(e,t,i,s,r){this.commonLogger.trace("CacheManager - getIdToken called");const a={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:An.ID_TOKEN,clientId:this.clientId,realm:i},o=this.getIdTokensByFilter(a,t),l=o.size;if(l<1)return this.commonLogger.info("CacheManager:getIdToken - No token found"),null;if(l>1){let c=o;if(!i){const h=new Map;o.forEach((d,f)=>{d.realm===e.tenantId&&h.set(f,d)});const u=h.size;if(u<1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account but none match account entity tenant id, returning first result"),o.values().next().value;if(u===1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account, defaulting to home tenant profile"),h.values().next().value;c=h}return this.commonLogger.info("CacheManager:getIdToken - Multiple matching ID tokens found, clearing them"),c.forEach((h,u)=>{this.removeIdToken(u)}),s&&r&&s.addFields({multiMatchedID:o.size},r),null}return this.commonLogger.info("CacheManager:getIdToken - Returning ID token"),o.values().next().value}getIdTokensByFilter(e,t){const i=t&&t.idToken||this.getTokenKeys().idToken,s=new Map;return i.forEach(r=>{if(!this.idTokenKeyMatchesFilter(r,{clientId:this.clientId,...e}))return;const a=this.getIdTokenCredential(r);a&&this.credentialMatchesFilter(a,e)&&s.set(r,a)}),s}idTokenKeyMatchesFilter(e,t){const i=e.toLowerCase();return!(t.clientId&&i.indexOf(t.clientId.toLowerCase())===-1||t.homeAccountId&&i.indexOf(t.homeAccountId.toLowerCase())===-1)}removeIdToken(e){this.removeItem(e)}removeRefreshToken(e){this.removeItem(e)}getAccessToken(e,t,i,s,r,a){this.commonLogger.trace("CacheManager - getAccessToken called");const o=cs.createSearchScopes(t.scopes),l=t.authenticationScheme||pi.BEARER,c=l&&l.toLowerCase()!==pi.BEARER.toLowerCase()?An.ACCESS_TOKEN_WITH_AUTH_SCHEME:An.ACCESS_TOKEN,h={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:c,clientId:this.clientId,realm:s||e.tenantId,target:o,tokenType:l,keyId:t.sshKid,requestedClaimsHash:t.requestedClaimsHash},u=i&&i.accessToken||this.getTokenKeys().accessToken,d=[];u.forEach(g=>{if(this.accessTokenKeyMatchesFilter(g,h,!0)){const m=this.getAccessTokenCredential(g);m&&this.credentialMatchesFilter(m,h)&&d.push(m)}});const f=d.length;return f<1?(this.commonLogger.info("CacheManager:getAccessToken - No token found"),null):f>1?(this.commonLogger.info("CacheManager:getAccessToken - Multiple access tokens found, clearing them"),d.forEach(g=>{this.removeAccessToken(Mp(g))}),r&&a&&r.addFields({multiMatchedAT:d.length},a),null):(this.commonLogger.info("CacheManager:getAccessToken - Returning access token"),d[0])}accessTokenKeyMatchesFilter(e,t,i){const s=e.toLowerCase();if(t.clientId&&s.indexOf(t.clientId.toLowerCase())===-1||t.homeAccountId&&s.indexOf(t.homeAccountId.toLowerCase())===-1||t.realm&&s.indexOf(t.realm.toLowerCase())===-1||t.requestedClaimsHash&&s.indexOf(t.requestedClaimsHash.toLowerCase())===-1)return!1;if(t.target){const r=t.target.asArray();for(let a=0;a<r.length;a++){if(i&&!s.includes(r[a].toLowerCase()))return!1;if(!i&&s.includes(r[a].toLowerCase()))return!0}}return!0}getAccessTokensByFilter(e){const t=this.getTokenKeys(),i=[];return t.accessToken.forEach(s=>{if(!this.accessTokenKeyMatchesFilter(s,e,!0))return;const r=this.getAccessTokenCredential(s);r&&this.credentialMatchesFilter(r,e)&&i.push(r)}),i}getRefreshToken(e,t,i,s,r){this.commonLogger.trace("CacheManager - getRefreshToken called");const a=t?Tp:void 0,o={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:An.REFRESH_TOKEN,clientId:this.clientId,familyId:a},l=i&&i.refreshToken||this.getTokenKeys().refreshToken,c=[];l.forEach(u=>{if(this.refreshTokenKeyMatchesFilter(u,o)){const d=this.getRefreshTokenCredential(u);d&&this.credentialMatchesFilter(d,o)&&c.push(d)}});const h=c.length;return h<1?(this.commonLogger.info("CacheManager:getRefreshToken - No refresh token found."),null):(h>1&&s&&r&&s.addFields({multiMatchedRT:h},r),this.commonLogger.info("CacheManager:getRefreshToken - returning refresh token"),c[0])}refreshTokenKeyMatchesFilter(e,t){const i=e.toLowerCase();return!(t.familyId&&i.indexOf(t.familyId.toLowerCase())===-1||!t.familyId&&t.clientId&&i.indexOf(t.clientId.toLowerCase())===-1||t.homeAccountId&&i.indexOf(t.homeAccountId.toLowerCase())===-1)}readAppMetadataFromCache(e){const t={environment:e,clientId:this.clientId},i=this.getAppMetadataFilteredBy(t),s=Object.keys(i).map(a=>i[a]),r=s.length;if(r<1)return null;if(r>1)throw ut(XP);return s[0]}isAppMetadataFOCI(e){const t=this.readAppMetadataFromCache(e);return!!(t&&t.familyId===Tp)}matchHomeAccountId(e,t){return typeof e.homeAccountId=="string"&&t===e.homeAccountId}matchLocalAccountIdFromTokenClaims(e,t){const i=e.oid||e.sub;return t===i}matchLocalAccountIdFromTenantProfile(e,t){return e.localAccountId===t}matchName(e,t){var i;return t.toLowerCase()===((i=e.name)==null?void 0:i.toLowerCase())}matchUsername(e,t){return!!(e&&typeof e=="string"&&(t==null?void 0:t.toLowerCase())===e.toLowerCase())}matchUserAssertionHash(e,t){return!!(e.userAssertionHash&&t===e.userAssertionHash)}matchEnvironment(e,t){if(this.staticAuthorityOptions){const s=NZ(this.staticAuthorityOptions,this.commonLogger);if(s.includes(t)&&s.includes(e.environment))return!0}const i=this.getAuthorityMetadataByAlias(t);return!!(i&&i.aliases.indexOf(e.environment)>-1)}matchCredentialType(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()}matchClientId(e,t){return!!(e.clientId&&t===e.clientId)}matchFamilyId(e,t){return!!(e.familyId&&t===e.familyId)}matchRealm(e,t){var i;return((i=e.realm)==null?void 0:i.toLowerCase())===t.toLowerCase()}matchNativeAccountId(e,t){return!!(e.nativeAccountId&&t===e.nativeAccountId)}matchLoginHintFromTokenClaims(e,t){return e.login_hint===t||e.preferred_username===t||e.upn===t}matchSid(e,t){return e.sid===t}matchAuthorityType(e,t){return!!(e.authorityType&&t.toLowerCase()===e.authorityType.toLowerCase())}matchTarget(e,t){return e.credentialType!==An.ACCESS_TOKEN&&e.credentialType!==An.ACCESS_TOKEN_WITH_AUTH_SCHEME||!e.target?!1:cs.fromString(e.target).containsScopeSet(t)}matchTokenType(e,t){return!!(e.tokenType&&e.tokenType===t)}matchKeyId(e,t){return!!(e.keyId&&e.keyId===t)}isAppMetadata(e){return e.indexOf(a_)!==-1}isAuthorityMetadata(e){return e.indexOf($3.CACHE_KEY)!==-1}generateAuthorityMetadataCacheKey(e){return`${$3.CACHE_KEY}-${this.clientId}-${e}`}static toObject(e,t){for(const i in t)e[i]=t[i];return e}}class DZ extends H6{async setAccount(){throw ut(On)}getAccount(){throw ut(On)}async setIdTokenCredential(){throw ut(On)}getIdTokenCredential(){throw ut(On)}async setAccessTokenCredential(){throw ut(On)}getAccessTokenCredential(){throw ut(On)}async setRefreshTokenCredential(){throw ut(On)}getRefreshTokenCredential(){throw ut(On)}setAppMetadata(){throw ut(On)}getAppMetadata(){throw ut(On)}setServerTelemetry(){throw ut(On)}getServerTelemetry(){throw ut(On)}setAuthorityMetadata(){throw ut(On)}getAuthorityMetadata(){throw ut(On)}getAuthorityMetadataKeys(){throw ut(On)}setThrottlingCache(){throw ut(On)}getThrottlingCache(){throw ut(On)}removeItem(){throw ut(On)}getKeys(){throw ut(On)}getAccountKeys(){throw ut(On)}getTokenKeys(){throw ut(On)}}/*! @azure/msal-common v15.2.0 2025-02-18 */const AN={tokenRenewalOffsetSeconds:eZ,preventCorsPreflight:!1},FZ={loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:Di.Info,correlationId:Ge.EMPTY_STRING},LZ={claimsBasedCachingEnabled:!1},BZ={async sendGetRequestAsync(){throw ut(On)},async sendPostRequestAsync(){throw ut(On)}},UZ={sku:Ge.SKU,version:m_,cpu:Ge.EMPTY_STRING,os:Ge.EMPTY_STRING},HZ={clientSecret:Ge.EMPTY_STRING,clientAssertion:void 0},zZ={azureCloudInstance:p_.None,tenant:`${Ge.DEFAULT_COMMON_TENANT}`},jZ={application:{appName:"",appVersion:""}};function GZ({authOptions:n,systemOptions:e,loggerOptions:t,cacheOptions:i,storageInterface:s,networkInterface:r,cryptoInterface:a,clientCredentials:o,libraryInfo:l,telemetry:c,serverTelemetryManager:h,persistencePlugin:u,serializableCache:d}){const f={...FZ,...t};return{authOptions:VZ(n),systemOptions:{...AN,...e},loggerOptions:f,cacheOptions:{...LZ,...i},storageInterface:s||new DZ(n.clientId,t5,new Xh(f)),networkInterface:r||BZ,cryptoInterface:a||t5,clientCredentials:o||HZ,libraryInfo:{...UZ,...l},telemetry:{...jZ,...c},serverTelemetryManager:h||null,persistencePlugin:u||null,serializableCache:d||null}}function VZ(n){return{clientCapabilities:[],azureCloudOptions:zZ,skipAuthorityMetadataCache:!1,instanceAware:!1,...n}}function z6(n){return n.authOptions.authority.options.protocolMode===p0.OIDC}/*! @azure/msal-common v15.2.0 2025-02-18 */const Ja={HOME_ACCOUNT_ID:"home_account_id",UPN:"UPN"};/*! @azure/msal-common v15.2.0 2025-02-18 */const rf="client_id",SN="redirect_uri",jC="response_type",qZ="response_mode",WZ="grant_type",KZ="claims",XZ="scope",YZ="refresh_token",JZ="state",ZZ="nonce",QZ="prompt",$Z="code",eQ="code_challenge",tQ="code_challenge_method",nQ="code_verifier",iQ="client-request-id",sQ="x-client-SKU",rQ="x-client-VER",aQ="x-client-OS",oQ="x-client-CPU",lQ="x-client-current-telemetry",cQ="x-client-last-telemetry",hQ="x-ms-lib-capability",uQ="x-app-name",dQ="x-app-ver",fQ="post_logout_redirect_uri",gQ="id_token_hint",mQ="device_code",pQ="client_secret",bQ="client_assertion",xQ="client_assertion_type",GC="token_type",VC="req_cnf",yQ="assertion",wQ="requested_token_use",qC="return_spa_code",_Q="nativebroker",vQ="logout_hint",kQ="sid",CQ="login_hint",AQ="domain_hint",SQ="x-client-xtra-sku",S_="brk_client_id",j6="brk_redirect_uri";/*! @azure/msal-common v15.2.0 2025-02-18 */class Uf{static validateRedirectUri(e){if(!e)throw ki(aN)}static validatePrompt(e){const t=[];for(const i in Vs)t.push(Vs[i]);if(t.indexOf(e)<0)throw ki(hN)}static validateClaims(e){try{JSON.parse(e)}catch{throw ki(x_)}}static validateCodeChallengeParams(e,t){if(!e||!t)throw ki(y_);this.validateCodeChallengeMethod(t)}static validateCodeChallengeMethod(e){if([PC.PLAIN,PC.S256].indexOf(e)<0)throw ki(fN)}}/*! @azure/msal-common v15.2.0 2025-02-18 */function IQ(n,e,t){if(!e)return;const i=n.get(rf);i&&n.has(S_)&&(t==null||t.addFields({embeddedClientId:i,embeddedRedirectUri:n.get(SN)},e))}class Pp{constructor(e,t){this.parameters=new Map,this.performanceClient=t,this.correlationId=e}addResponseTypeCode(){this.parameters.set(jC,encodeURIComponent(Ge.CODE_RESPONSE_TYPE))}addResponseTypeForTokenAndIdToken(){this.parameters.set(jC,encodeURIComponent(`${Ge.TOKEN_RESPONSE_TYPE} ${Ge.ID_TOKEN_RESPONSE_TYPE}`))}addResponseMode(e){this.parameters.set(qZ,encodeURIComponent(e||ZJ.QUERY))}addNativeBroker(){this.parameters.set(_Q,encodeURIComponent("1"))}addScopes(e,t=!0,i=Ix){t&&!i.includes("openid")&&!e.includes("openid")&&i.push("openid");const s=t?[...e||[],...i]:e||[],r=new cs(s);this.parameters.set(XZ,encodeURIComponent(r.printScopes()))}addClientId(e){this.parameters.set(rf,encodeURIComponent(e))}addRedirectUri(e){Uf.validateRedirectUri(e),this.parameters.set(SN,encodeURIComponent(e))}addPostLogoutRedirectUri(e){Uf.validateRedirectUri(e),this.parameters.set(fQ,encodeURIComponent(e))}addIdTokenHint(e){this.parameters.set(gQ,encodeURIComponent(e))}addDomainHint(e){this.parameters.set(AQ,encodeURIComponent(e))}addLoginHint(e){this.parameters.set(CQ,encodeURIComponent(e))}addCcsUpn(e){this.parameters.set(Kr.CCS_HEADER,encodeURIComponent(`UPN:${e}`))}addCcsOid(e){this.parameters.set(Kr.CCS_HEADER,encodeURIComponent(`Oid:${e.uid}@${e.utid}`))}addSid(e){this.parameters.set(kQ,encodeURIComponent(e))}addClaims(e,t){const i=this.addClientCapabilitiesToClaims(e,t);Uf.validateClaims(i),this.parameters.set(KZ,encodeURIComponent(i))}addCorrelationId(e){this.parameters.set(iQ,encodeURIComponent(e))}addLibraryInfo(e){this.parameters.set(sQ,e.sku),this.parameters.set(rQ,e.version),e.os&&this.parameters.set(aQ,e.os),e.cpu&&this.parameters.set(oQ,e.cpu)}addApplicationTelemetry(e){e!=null&&e.appName&&this.parameters.set(uQ,e.appName),e!=null&&e.appVersion&&this.parameters.set(dQ,e.appVersion)}addPrompt(e){Uf.validatePrompt(e),this.parameters.set(`${QZ}`,encodeURIComponent(e))}addState(e){e&&this.parameters.set(JZ,encodeURIComponent(e))}addNonce(e){this.parameters.set(ZZ,encodeURIComponent(e))}addCodeChallengeParams(e,t){if(Uf.validateCodeChallengeParams(e,t),e&&t)this.parameters.set(eQ,encodeURIComponent(e)),this.parameters.set(tQ,encodeURIComponent(t));else throw ki(y_)}addAuthorizationCode(e){this.parameters.set($Z,encodeURIComponent(e))}addDeviceCode(e){this.parameters.set(mQ,encodeURIComponent(e))}addRefreshToken(e){this.parameters.set(YZ,encodeURIComponent(e))}addCodeVerifier(e){this.parameters.set(nQ,encodeURIComponent(e))}addClientSecret(e){this.parameters.set(pQ,encodeURIComponent(e))}addClientAssertion(e){e&&this.parameters.set(bQ,encodeURIComponent(e))}addClientAssertionType(e){e&&this.parameters.set(xQ,encodeURIComponent(e))}addOboAssertion(e){this.parameters.set(yQ,encodeURIComponent(e))}addRequestTokenUse(e){this.parameters.set(wQ,encodeURIComponent(e))}addGrantType(e){this.parameters.set(WZ,encodeURIComponent(e))}addClientInfo(){this.parameters.set(QJ,"1")}addExtraQueryParameters(e){Object.entries(e).forEach(([t,i])=>{!this.parameters.has(t)&&i&&this.parameters.set(t,i)})}addClientCapabilitiesToClaims(e,t){let i;if(!e)i={};else try{i=JSON.parse(e)}catch{throw ki(x_)}return t&&t.length>0&&(i.hasOwnProperty(m9.ACCESS_TOKEN)||(i[m9.ACCESS_TOKEN]={}),i[m9.ACCESS_TOKEN][m9.XMS_CC]={values:t}),JSON.stringify(i)}addUsername(e){this.parameters.set(OC.username,encodeURIComponent(e))}addPassword(e){this.parameters.set(OC.password,encodeURIComponent(e))}addPopToken(e){e&&(this.parameters.set(GC,pi.POP),this.parameters.set(VC,encodeURIComponent(e)))}addSshJwk(e){e&&(this.parameters.set(GC,pi.SSH),this.parameters.set(VC,encodeURIComponent(e)))}addServerTelemetry(e){this.parameters.set(lQ,e.generateCurrentRequestHeaderValue()),this.parameters.set(cQ,e.generateLastRequestHeaderValue())}addThrottling(){this.parameters.set(hQ,Rp.X_MS_LIB_CAPABILITY_VALUE)}addLogoutHint(e){this.parameters.set(vQ,encodeURIComponent(e))}addBrokerParameters(e){const t={};t[S_]=e.brokerClientId,t[j6]=e.brokerRedirectUri,this.addExtraQueryParameters(t)}createQueryString(){const e=new Array;return this.parameters.forEach((t,i)=>{e.push(`${i}=${t}`)}),IQ(this.parameters,this.correlationId,this.performanceClient),e.join("&")}}/*! @azure/msal-common v15.2.0 2025-02-18 */function EQ(n){return n.hasOwnProperty("authorization_endpoint")&&n.hasOwnProperty("token_endpoint")&&n.hasOwnProperty("issuer")&&n.hasOwnProperty("jwks_uri")}/*! @azure/msal-common v15.2.0 2025-02-18 */function TQ(n){return n.hasOwnProperty("tenant_discovery_endpoint")&&n.hasOwnProperty("metadata")}/*! @azure/msal-common v15.2.0 2025-02-18 */function RQ(n){return n.hasOwnProperty("error")&&n.hasOwnProperty("error_description")}/*! @azure/msal-common v15.2.0 2025-02-18 */const Ee={AcquireTokenByCode:"acquireTokenByCode",AcquireTokenByRefreshToken:"acquireTokenByRefreshToken",AcquireTokenSilent:"acquireTokenSilent",AcquireTokenSilentAsync:"acquireTokenSilentAsync",AcquireTokenPopup:"acquireTokenPopup",AcquireTokenPreRedirect:"acquireTokenPreRedirect",AcquireTokenRedirect:"acquireTokenRedirect",CryptoOptsGetPublicKeyThumbprint:"cryptoOptsGetPublicKeyThumbprint",CryptoOptsSignJwt:"cryptoOptsSignJwt",SilentCacheClientAcquireToken:"silentCacheClientAcquireToken",SilentIframeClientAcquireToken:"silentIframeClientAcquireToken",AwaitConcurrentIframe:"awaitConcurrentIframe",SilentRefreshClientAcquireToken:"silentRefreshClientAcquireToken",SsoSilent:"ssoSilent",StandardInteractionClientGetDiscoveredAuthority:"standardInteractionClientGetDiscoveredAuthority",FetchAccountIdWithNativeBroker:"fetchAccountIdWithNativeBroker",NativeInteractionClientAcquireToken:"nativeInteractionClientAcquireToken",BaseClientCreateTokenRequestHeaders:"baseClientCreateTokenRequestHeaders",NetworkClientSendPostRequestAsync:"networkClientSendPostRequestAsync",RefreshTokenClientExecutePostToTokenEndpoint:"refreshTokenClientExecutePostToTokenEndpoint",AuthorizationCodeClientExecutePostToTokenEndpoint:"authorizationCodeClientExecutePostToTokenEndpoint",BrokerHandhshake:"brokerHandshake",AcquireTokenByRefreshTokenInBroker:"acquireTokenByRefreshTokenInBroker",AcquireTokenByBroker:"acquireTokenByBroker",RefreshTokenClientExecuteTokenRequest:"refreshTokenClientExecuteTokenRequest",RefreshTokenClientAcquireToken:"refreshTokenClientAcquireToken",RefreshTokenClientAcquireTokenWithCachedRefreshToken:"refreshTokenClientAcquireTokenWithCachedRefreshToken",RefreshTokenClientAcquireTokenByRefreshToken:"refreshTokenClientAcquireTokenByRefreshToken",RefreshTokenClientCreateTokenRequestBody:"refreshTokenClientCreateTokenRequestBody",AcquireTokenFromCache:"acquireTokenFromCache",SilentFlowClientAcquireCachedToken:"silentFlowClientAcquireCachedToken",SilentFlowClientGenerateResultFromCacheRecord:"silentFlowClientGenerateResultFromCacheRecord",AcquireTokenBySilentIframe:"acquireTokenBySilentIframe",InitializeBaseRequest:"initializeBaseRequest",InitializeSilentRequest:"initializeSilentRequest",InitializeClientApplication:"initializeClientApplication",InitializeCache:"initializeCache",SilentIframeClientTokenHelper:"silentIframeClientTokenHelper",SilentHandlerInitiateAuthRequest:"silentHandlerInitiateAuthRequest",SilentHandlerMonitorIframeForHash:"silentHandlerMonitorIframeForHash",SilentHandlerLoadFrame:"silentHandlerLoadFrame",SilentHandlerLoadFrameSync:"silentHandlerLoadFrameSync",StandardInteractionClientCreateAuthCodeClient:"standardInteractionClientCreateAuthCodeClient",StandardInteractionClientGetClientConfiguration:"standardInteractionClientGetClientConfiguration",StandardInteractionClientInitializeAuthorizationRequest:"standardInteractionClientInitializeAuthorizationRequest",StandardInteractionClientInitializeAuthorizationCodeRequest:"standardInteractionClientInitializeAuthorizationCodeRequest",GetAuthCodeUrl:"getAuthCodeUrl",HandleCodeResponseFromServer:"handleCodeResponseFromServer",HandleCodeResponse:"handleCodeResponse",UpdateTokenEndpointAuthority:"updateTokenEndpointAuthority",AuthClientAcquireToken:"authClientAcquireToken",AuthClientExecuteTokenRequest:"authClientExecuteTokenRequest",AuthClientCreateTokenRequestBody:"authClientCreateTokenRequestBody",AuthClientCreateQueryString:"authClientCreateQueryString",PopTokenGenerateCnf:"popTokenGenerateCnf",PopTokenGenerateKid:"popTokenGenerateKid",HandleServerTokenResponse:"handleServerTokenResponse",DeserializeResponse:"deserializeResponse",AuthorityFactoryCreateDiscoveredInstance:"authorityFactoryCreateDiscoveredInstance",AuthorityResolveEndpointsAsync:"authorityResolveEndpointsAsync",AuthorityResolveEndpointsFromLocalSources:"authorityResolveEndpointsFromLocalSources",AuthorityGetCloudDiscoveryMetadataFromNetwork:"authorityGetCloudDiscoveryMetadataFromNetwork",AuthorityUpdateCloudDiscoveryMetadata:"authorityUpdateCloudDiscoveryMetadata",AuthorityGetEndpointMetadataFromNetwork:"authorityGetEndpointMetadataFromNetwork",AuthorityUpdateEndpointMetadata:"authorityUpdateEndpointMetadata",AuthorityUpdateMetadataWithRegionalInformation:"authorityUpdateMetadataWithRegionalInformation",RegionDiscoveryDetectRegion:"regionDiscoveryDetectRegion",RegionDiscoveryGetRegionFromIMDS:"regionDiscoveryGetRegionFromIMDS",RegionDiscoveryGetCurrentVersion:"regionDiscoveryGetCurrentVersion",AcquireTokenByCodeAsync:"acquireTokenByCodeAsync",GetEndpointMetadataFromNetwork:"getEndpointMetadataFromNetwork",GetCloudDiscoveryMetadataFromNetworkMeasurement:"getCloudDiscoveryMetadataFromNetworkMeasurement",HandleRedirectPromiseMeasurement:"handleRedirectPromise",HandleNativeRedirectPromiseMeasurement:"handleNativeRedirectPromise",UpdateCloudDiscoveryMetadataMeasurement:"updateCloudDiscoveryMetadataMeasurement",UsernamePasswordClientAcquireToken:"usernamePasswordClientAcquireToken",NativeMessageHandlerHandshake:"nativeMessageHandlerHandshake",NativeGenerateAuthResult:"nativeGenerateAuthResult",RemoveHiddenIframe:"removeHiddenIframe",ClearTokensAndKeysWithClaims:"clearTokensAndKeysWithClaims",CacheManagerGetRefreshToken:"cacheManagerGetRefreshToken",ImportExistingCache:"importExistingCache",SetUserData:"setUserData",LocalStorageUpdated:"localStorageUpdated",GeneratePkceCodes:"generatePkceCodes",GenerateCodeVerifier:"generateCodeVerifier",GenerateCodeChallengeFromVerifier:"generateCodeChallengeFromVerifier",Sha256Digest:"sha256Digest",GetRandomValues:"getRandomValues",GenerateHKDF:"generateHKDF",GenerateBaseKey:"generateBaseKey",Base64Decode:"base64Decode",UrlEncodeArr:"urlEncodeArr",Encrypt:"encrypt",Decrypt:"decrypt"},MQ={NotStarted:0,InProgress:1,Completed:2};/*! @azure/msal-common v15.2.0 2025-02-18 */const I0=(n,e,t,i,s)=>(...r)=>{t.trace(`Executing function ${e}`);const a=i==null?void 0:i.startMeasurement(e,s);if(s){const o=e+"CallCount";i==null||i.incrementFields({[o]:1},s)}try{const o=n(...r);return a==null||a.end({success:!0}),t.trace(`Returning result from ${e}`),o}catch(o){t.trace(`Error occurred in ${e}`);try{t.trace(JSON.stringify(o))}catch{t.trace("Unable to print error message.")}throw a==null||a.end({success:!1},o),o}},dt=(n,e,t,i,s)=>(...r)=>{t.trace(`Executing function ${e}`);const a=i==null?void 0:i.startMeasurement(e,s);if(s){const o=e+"CallCount";i==null||i.incrementFields({[o]:1},s)}return i==null||i.setPreQueueTime(e,s),n(...r).then(o=>(t.trace(`Returning result from ${e}`),a==null||a.end({success:!0}),o)).catch(o=>{t.trace(`Error occurred in ${e}`);try{t.trace(JSON.stringify(o))}catch{t.trace("Unable to print error message.")}throw a==null||a.end({success:!1},o),o})};/*! @azure/msal-common v15.2.0 2025-02-18 */class Sy{constructor(e,t,i,s){this.networkInterface=e,this.logger=t,this.performanceClient=i,this.correlationId=s}async detectRegion(e,t){var s;(s=this.performanceClient)==null||s.addQueueMeasurement(Ee.RegionDiscoveryDetectRegion,this.correlationId);let i=e;if(i)t.region_source=Cf.ENVIRONMENT_VARIABLE;else{const r=Sy.IMDS_OPTIONS;try{const a=await dt(this.getRegionFromIMDS.bind(this),Ee.RegionDiscoveryGetRegionFromIMDS,this.logger,this.performanceClient,this.correlationId)(Ge.IMDS_VERSION,r);if(a.status===b9.httpSuccess&&(i=a.body,t.region_source=Cf.IMDS),a.status===b9.httpBadRequest){const o=await dt(this.getCurrentVersion.bind(this),Ee.RegionDiscoveryGetCurrentVersion,this.logger,this.performanceClient,this.correlationId)(r);if(!o)return t.region_source=Cf.FAILED_AUTO_DETECTION,null;const l=await dt(this.getRegionFromIMDS.bind(this),Ee.RegionDiscoveryGetRegionFromIMDS,this.logger,this.performanceClient,this.correlationId)(o,r);l.status===b9.httpSuccess&&(i=l.body,t.region_source=Cf.IMDS)}}catch{return t.region_source=Cf.FAILED_AUTO_DETECTION,null}}return i||(t.region_source=Cf.FAILED_AUTO_DETECTION),i||null}async getRegionFromIMDS(e,t){var i;return(i=this.performanceClient)==null||i.addQueueMeasurement(Ee.RegionDiscoveryGetRegionFromIMDS,this.correlationId),this.networkInterface.sendGetRequestAsync(`${Ge.IMDS_ENDPOINT}?api-version=${e}&format=text`,t,Ge.IMDS_TIMEOUT)}async getCurrentVersion(e){var t;(t=this.performanceClient)==null||t.addQueueMeasurement(Ee.RegionDiscoveryGetCurrentVersion,this.correlationId);try{const i=await this.networkInterface.sendGetRequestAsync(`${Ge.IMDS_ENDPOINT}?format=json`,e);return i.status===b9.httpBadRequest&&i.body&&i.body["newest-versions"]&&i.body["newest-versions"].length>0?i.body["newest-versions"][0]:null}catch{return null}}}Sy.IMDS_OPTIONS={headers:{Metadata:"true"}};/*! @azure/msal-common v15.2.0 2025-02-18 */class Rr{constructor(e,t,i,s,r,a,o,l){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t,this.cacheManager=i,this.authorityOptions=s,this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.logger=r,this.performanceClient=o,this.correlationId=a,this.managedIdentity=l||!1,this.regionDiscovery=new Sy(t,this.logger,this.performanceClient,this.correlationId)}getAuthorityType(e){if(e.HostNameAndPort.endsWith(Ge.CIAM_AUTH_URL))return Zo.Ciam;const t=e.PathSegments;if(t.length)switch(t[0].toLowerCase()){case Ge.ADFS:return Zo.Adfs;case Ge.DSTS:return Zo.Dsts}return Zo.Default}get authorityType(){return this.getAuthorityType(this.canonicalAuthorityUrlComponents)}get protocolMode(){return this.authorityOptions.protocolMode}get options(){return this.authorityOptions}get canonicalAuthority(){return this._canonicalAuthority.urlString}set canonicalAuthority(e){this._canonicalAuthority=new Zn(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null}get canonicalAuthorityUrlComponents(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents}get hostnameAndPort(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()}get tenant(){return this.canonicalAuthorityUrlComponents.PathSegments[0]}get authorizationEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.authorization_endpoint);throw ut(vc)}get tokenEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint);throw ut(vc)}get deviceCodeEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));throw ut(vc)}get endSessionEndpoint(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw ut(nN);return this.replacePath(this.metadata.end_session_endpoint)}else throw ut(vc)}get selfSignedJwtAudience(){if(this.discoveryComplete())return this.replacePath(this.metadata.issuer);throw ut(vc)}get jwksUri(){if(this.discoveryComplete())return this.replacePath(this.metadata.jwks_uri);throw ut(vc)}canReplaceTenant(e){return e.PathSegments.length===1&&!Rr.reservedTenantDomains.has(e.PathSegments[0])&&this.getAuthorityType(e)===Zo.Default&&this.protocolMode===p0.AAD}replaceTenant(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)}replacePath(e){let t=e;const s=new Zn(this.metadata.canonical_authority).getUrlComponents(),r=s.PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach((o,l)=>{let c=r[l];if(l===0&&this.canReplaceTenant(s)){const h=new Zn(this.metadata.authorization_endpoint).getUrlComponents().PathSegments[0];c!==h&&(this.logger.verbose(`Replacing tenant domain name ${c} with id ${h}`),c=h)}o!==c&&(t=t.replace(`/${c}/`,`/${o}/`))}),this.replaceTenant(t)}get defaultOpenIdConfigurationEndpoint(){const e=this.hostnameAndPort;return this.canonicalAuthority.endsWith("v2.0/")||this.authorityType===Zo.Adfs||this.protocolMode!==p0.AAD&&!this.isAliasOfKnownMicrosoftAuthority(e)?`${this.canonicalAuthority}.well-known/openid-configuration`:`${this.canonicalAuthority}v2.0/.well-known/openid-configuration`}discoveryComplete(){return!!this.metadata}async resolveEndpointsAsync(){var s,r;(s=this.performanceClient)==null||s.addQueueMeasurement(Ee.AuthorityResolveEndpointsAsync,this.correlationId);const e=this.getCurrentMetadataEntity(),t=await dt(this.updateCloudDiscoveryMetadata.bind(this),Ee.AuthorityUpdateCloudDiscoveryMetadata,this.logger,this.performanceClient,this.correlationId)(e);this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,e.preferred_network);const i=await dt(this.updateEndpointMetadata.bind(this),Ee.AuthorityUpdateEndpointMetadata,this.logger,this.performanceClient,this.correlationId)(e);this.updateCachedMetadata(e,t,{source:i}),(r=this.performanceClient)==null||r.addFields({cloudDiscoverySource:t,authorityEndpointSource:i},this.correlationId)}getCurrentMetadataEntity(){let e=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort);return e||(e={aliases:[],preferred_cache:this.hostnameAndPort,preferred_network:this.hostnameAndPort,canonical_authority:this.canonicalAuthority,authorization_endpoint:"",token_endpoint:"",end_session_endpoint:"",issuer:"",aliasesFromNetwork:!1,endpointsFromNetwork:!1,expiresAt:LC(),jwks_uri:""}),e}updateCachedMetadata(e,t,i){t!==Aa.CACHE&&(i==null?void 0:i.source)!==Aa.CACHE&&(e.expiresAt=LC(),e.canonical_authority=this.canonicalAuthority);const s=this.cacheManager.generateAuthorityMetadataCacheKey(e.preferred_cache);this.cacheManager.setAuthorityMetadata(s,e),this.metadata=e}async updateEndpointMetadata(e){var s,r,a;(s=this.performanceClient)==null||s.addQueueMeasurement(Ee.AuthorityUpdateEndpointMetadata,this.correlationId);const t=this.updateEndpointMetadataFromLocalSources(e);if(t){if(t.source===Aa.HARDCODED_VALUES&&(r=this.authorityOptions.azureRegionConfiguration)!=null&&r.azureRegion&&t.metadata){const o=await dt(this.updateMetadataWithRegionalInformation.bind(this),Ee.AuthorityUpdateMetadataWithRegionalInformation,this.logger,this.performanceClient,this.correlationId)(t.metadata);x9(e,o,!1),e.canonical_authority=this.canonicalAuthority}return t.source}let i=await dt(this.getEndpointMetadataFromNetwork.bind(this),Ee.AuthorityGetEndpointMetadataFromNetwork,this.logger,this.performanceClient,this.correlationId)();if(i)return(a=this.authorityOptions.azureRegionConfiguration)!=null&&a.azureRegion&&(i=await dt(this.updateMetadataWithRegionalInformation.bind(this),Ee.AuthorityUpdateMetadataWithRegionalInformation,this.logger,this.performanceClient,this.correlationId)(i)),x9(e,i,!0),Aa.NETWORK;throw ut(GP,this.defaultOpenIdConfigurationEndpoint)}updateEndpointMetadataFromLocalSources(e){this.logger.verbose("Attempting to get endpoint metadata from authority configuration");const t=this.getEndpointMetadataFromConfig();if(t)return this.logger.verbose("Found endpoint metadata in authority configuration"),x9(e,t,!1),{source:Aa.CONFIG};if(this.logger.verbose("Did not find endpoint metadata in the config... Attempting to get endpoint metadata from the hardcoded values."),this.authorityOptions.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get endpoint metadata from the network metadata cache.");else{const s=this.getEndpointMetadataFromHardcodedValues();if(s)return x9(e,s,!1),{source:Aa.HARDCODED_VALUES,metadata:s};this.logger.verbose("Did not find endpoint metadata in hardcoded values... Attempting to get endpoint metadata from the network metadata cache.")}const i=BC(e);return this.isAuthoritySameType(e)&&e.endpointsFromNetwork&&!i?(this.logger.verbose("Found endpoint metadata in the cache."),{source:Aa.CACHE}):(i&&this.logger.verbose("The metadata entity is expired."),null)}isAuthoritySameType(e){return new Zn(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length}getEndpointMetadataFromConfig(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch{throw ki(gN)}return null}async getEndpointMetadataFromNetwork(){var i;(i=this.performanceClient)==null||i.addQueueMeasurement(Ee.AuthorityGetEndpointMetadataFromNetwork,this.correlationId);const e={},t=this.defaultOpenIdConfigurationEndpoint;this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: attempting to retrieve OAuth endpoints from ${t}`);try{const s=await this.networkInterface.sendGetRequestAsync(t,e);return EQ(s.body)?s.body:(this.logger.verbose("Authority.getEndpointMetadataFromNetwork: could not parse response as OpenID configuration"),null)}catch(s){return this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: ${s}`),null}}getEndpointMetadataFromHardcodedValues(){return this.hostnameAndPort in HC?HC[this.hostnameAndPort]:null}async updateMetadataWithRegionalInformation(e){var i,s,r;(i=this.performanceClient)==null||i.addQueueMeasurement(Ee.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId);const t=(s=this.authorityOptions.azureRegionConfiguration)==null?void 0:s.azureRegion;if(t){if(t!==Ge.AZURE_REGION_AUTO_DISCOVER_FLAG)return this.regionDiscoveryMetadata.region_outcome=Xw.CONFIGURED_NO_AUTO_DETECTION,this.regionDiscoveryMetadata.region_used=t,Rr.replaceWithRegionalInformation(e,t);const a=await dt(this.regionDiscovery.detectRegion.bind(this.regionDiscovery),Ee.RegionDiscoveryDetectRegion,this.logger,this.performanceClient,this.correlationId)((r=this.authorityOptions.azureRegionConfiguration)==null?void 0:r.environmentRegion,this.regionDiscoveryMetadata);if(a)return this.regionDiscoveryMetadata.region_outcome=Xw.AUTO_DETECTION_REQUESTED_SUCCESSFUL,this.regionDiscoveryMetadata.region_used=a,Rr.replaceWithRegionalInformation(e,a);this.regionDiscoveryMetadata.region_outcome=Xw.AUTO_DETECTION_REQUESTED_FAILED}return e}async updateCloudDiscoveryMetadata(e){var s;(s=this.performanceClient)==null||s.addQueueMeasurement(Ee.AuthorityUpdateCloudDiscoveryMetadata,this.correlationId);const t=this.updateCloudDiscoveryMetadataFromLocalSources(e);if(t)return t;const i=await dt(this.getCloudDiscoveryMetadataFromNetwork.bind(this),Ee.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.logger,this.performanceClient,this.correlationId)();if(i)return Yw(e,i,!0),Aa.NETWORK;throw ki(mN)}updateCloudDiscoveryMetadataFromLocalSources(e){this.logger.verbose("Attempting to get cloud discovery metadata  from authority configuration"),this.logger.verbosePii(`Known Authorities: ${this.authorityOptions.knownAuthorities||Ge.NOT_APPLICABLE}`),this.logger.verbosePii(`Authority Metadata: ${this.authorityOptions.authorityMetadata||Ge.NOT_APPLICABLE}`),this.logger.verbosePii(`Canonical Authority: ${e.canonical_authority||Ge.NOT_APPLICABLE}`);const t=this.getCloudDiscoveryMetadataFromConfig();if(t)return this.logger.verbose("Found cloud discovery metadata in authority configuration"),Yw(e,t,!1),Aa.CONFIG;if(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the hardcoded values."),this.options.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded cloud discovery metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get cloud discovery metadata from the network metadata cache.");else{const s=OZ(this.hostnameAndPort);if(s)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),Yw(e,s,!1),Aa.HARDCODED_VALUES;this.logger.verbose("Did not find cloud discovery metadata in hardcoded values... Attempting to get cloud discovery metadata from the network metadata cache.")}const i=BC(e);return this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!i?(this.logger.verbose("Found cloud discovery metadata in the cache."),Aa.CACHE):(i&&this.logger.verbose("The metadata entity is expired."),null)}getCloudDiscoveryMetadataFromConfig(){if(this.authorityType===Zo.Ciam)return this.logger.verbose("CIAM authorities do not support cloud discovery metadata, generate the aliases from authority host."),Rr.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort);if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");const e=JSON.parse(this.authorityOptions.cloudDiscoveryMetadata),t=s5(e.metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),t)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),t;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch{throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),ki(w_)}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),Rr.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null}async getCloudDiscoveryMetadataFromNetwork(){var s;(s=this.performanceClient)==null||s.addQueueMeasurement(Ee.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.correlationId);const e=`${Ge.AAD_INSTANCE_DISCOVERY_ENDPT}${this.canonicalAuthority}oauth2/v2.0/authorize`,t={};let i=null;try{const r=await this.networkInterface.sendGetRequestAsync(e,t);let a,o;if(TQ(r.body))a=r.body,o=a.metadata,this.logger.verbosePii(`tenant_discovery_endpoint is: ${a.tenant_discovery_endpoint}`);else if(RQ(r.body)){if(this.logger.warning(`A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: ${r.status}`),a=r.body,a.error===Ge.INVALID_INSTANCE)return this.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),null;this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error is ${a.error}`),this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error description is ${a.error_description}`),this.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),o=[]}else return this.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),null;this.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),i=s5(o,this.hostnameAndPort)}catch(r){if(r instanceof zi)this.logger.error(`There was a network error while attempting to get the cloud discovery instance metadata.
Error: ${r.errorCode}
Error Description: ${r.errorMessage}`);else{const a=r;this.logger.error(`A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.
Error: ${a.name}
Error Description: ${a.message}`)}return null}return i||(this.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),this.logger.verbose("Creating custom Authority for custom domain scenario."),i=Rr.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),i}isInKnownAuthorities(){return this.authorityOptions.knownAuthorities.filter(t=>t&&Zn.getDomainFromUrl(t).toLowerCase()===this.hostnameAndPort).length>0}static generateAuthority(e,t){let i;if(t&&t.azureCloudInstance!==p_.None){const s=t.tenant?t.tenant:Ge.DEFAULT_COMMON_TENANT;i=`${t.azureCloudInstance}/${s}/`}return i||e}static createCloudDiscoveryMetadataFromHost(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}}getPreferredCache(){if(this.managedIdentity)return Ge.DEFAULT_AUTHORITY_HOST;if(this.discoveryComplete())return this.metadata.preferred_cache;throw ut(vc)}isAlias(e){return this.metadata.aliases.indexOf(e)>-1}isAliasOfKnownMicrosoftAuthority(e){return kN.has(e)}static isPublicCloudAuthority(e){return Ge.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0}static buildRegionalAuthorityString(e,t,i){const s=new Zn(e);s.validateAsUri();const r=s.getUrlComponents();let a=`${t}.${r.HostNameAndPort}`;this.isPublicCloudAuthority(r.HostNameAndPort)&&(a=`${t}.${Ge.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX}`);const o=Zn.constructAuthorityUriFromObject({...s.getUrlComponents(),HostNameAndPort:a}).urlString;return i?`${o}?${i}`:o}static replaceWithRegionalInformation(e,t){const i={...e};return i.authorization_endpoint=Rr.buildRegionalAuthorityString(i.authorization_endpoint,t),i.token_endpoint=Rr.buildRegionalAuthorityString(i.token_endpoint,t),i.end_session_endpoint&&(i.end_session_endpoint=Rr.buildRegionalAuthorityString(i.end_session_endpoint,t)),i}static transformCIAMAuthority(e){let t=e;const s=new Zn(e).getUrlComponents();if(s.PathSegments.length===0&&s.HostNameAndPort.endsWith(Ge.CIAM_AUTH_URL)){const r=s.HostNameAndPort.split(".")[0];t=`${t}${r}${Ge.AAD_TENANT_DOMAIN_SUFFIX}`}return t}}Rr.reservedTenantDomains=new Set(["{tenant}","{tenantid}",zh.COMMON,zh.CONSUMERS,zh.ORGANIZATIONS]);function PQ(n){var s;const i=(s=new Zn(n).getUrlComponents().PathSegments.slice(-1)[0])==null?void 0:s.toLowerCase();switch(i){case zh.COMMON:case zh.ORGANIZATIONS:case zh.CONSUMERS:return;default:return i}}function IN(n){return n.endsWith(Ge.FORWARD_SLASH)?n:`${n}${Ge.FORWARD_SLASH}`}function NQ(n){const e=n.cloudDiscoveryMetadata;let t;if(e)try{t=JSON.parse(e)}catch{throw ki(w_)}return{canonicalAuthority:n.authority?IN(n.authority):void 0,knownAuthorities:n.knownAuthorities,cloudDiscoveryMetadata:t}}/*! @azure/msal-common v15.2.0 2025-02-18 */async function EN(n,e,t,i,s,r,a){a==null||a.addQueueMeasurement(Ee.AuthorityFactoryCreateDiscoveredInstance,r);const o=Rr.transformCIAMAuthority(IN(n)),l=new Rr(o,e,t,i,s,r,a);try{return await dt(l.resolveEndpointsAsync.bind(l),Ee.AuthorityResolveEndpointsAsync,s,a,r)(),l}catch{throw ut(vc)}}/*! @azure/msal-common v15.2.0 2025-02-18 */class Yh extends zi{constructor(e,t,i,s,r){super(e,t,i),this.name="ServerError",this.errorNo=s,this.status=r,Object.setPrototypeOf(this,Yh.prototype)}}/*! @azure/msal-common v15.2.0 2025-02-18 */class ec{static generateThrottlingStorageKey(e){return`${Rp.THROTTLING_PREFIX}.${JSON.stringify(e)}`}static preProcess(e,t){var r;const i=ec.generateThrottlingStorageKey(t),s=e.getThrottlingCache(i);if(s){if(s.throttleTime<Date.now()){e.removeItem(i);return}throw new Yh(((r=s.errorCodes)==null?void 0:r.join(" "))||Ge.EMPTY_STRING,s.errorMessage,s.subError)}}static postProcess(e,t,i){if(ec.checkResponseStatus(i)||ec.checkResponseForRetryAfter(i)){const s={throttleTime:ec.calculateThrottleTime(parseInt(i.headers[Kr.RETRY_AFTER])),error:i.body.error,errorCodes:i.body.error_codes,errorMessage:i.body.error_description,subError:i.body.suberror};e.setThrottlingCache(ec.generateThrottlingStorageKey(t),s)}}static checkResponseStatus(e){return e.status===429||e.status>=500&&e.status<600}static checkResponseForRetryAfter(e){return e.headers?e.headers.hasOwnProperty(Kr.RETRY_AFTER)&&(e.status<200||e.status>=300):!1}static calculateThrottleTime(e){const t=e<=0?0:e,i=Date.now()/1e3;return Math.floor(Math.min(i+(t||Rp.DEFAULT_THROTTLE_TIME_SECONDS),i+Rp.DEFAULT_MAX_THROTTLE_TIME_SECONDS)*1e3)}static removeThrottle(e,t,i,s){const r={clientId:t,authority:i.authority,scopes:i.scopes,homeAccountIdentifier:s,claims:i.claims,authenticationScheme:i.authenticationScheme,resourceRequestMethod:i.resourceRequestMethod,resourceRequestUri:i.resourceRequestUri,shrClaims:i.shrClaims,sshKid:i.sshKid},a=this.generateThrottlingStorageKey(r);e.removeItem(a)}}/*! @azure/msal-common v15.2.0 2025-02-18 */class Iy extends zi{constructor(e,t,i){super(e.errorCode,e.errorMessage,e.subError),Object.setPrototypeOf(this,Iy.prototype),this.name="NetworkError",this.error=e,this.httpStatus=t,this.responseHeaders=i}}function WC(n,e,t){return new Iy(n,e,t)}/*! @azure/msal-common v15.2.0 2025-02-18 */class I_{constructor(e,t){this.config=GZ(e),this.logger=new Xh(this.config.loggerOptions,iN,m_),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=t}createTokenRequestHeaders(e){const t={};if(t[Kr.CONTENT_TYPE]=Ge.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case Ja.HOME_ACCOUNT_ID:try{const i=qf(e.credential);t[Kr.CCS_HEADER]=`Oid:${i.uid}@${i.utid}`}catch(i){this.logger.verbose("Could not parse home account ID for CCS Header: "+i)}break;case Ja.UPN:t[Kr.CCS_HEADER]=`UPN: ${e.credential}`;break}return t}async executePostToTokenEndpoint(e,t,i,s,r,a){var l;a&&((l=this.performanceClient)==null||l.addQueueMeasurement(a,r));const o=await this.sendPostRequest(s,e,{body:t,headers:i},r);return this.config.serverTelemetryManager&&o.status<500&&o.status!==429&&this.config.serverTelemetryManager.clearTelemetryCache(),o}async sendPostRequest(e,t,i,s){var a,o,l;ec.preProcess(this.cacheManager,e);let r;try{r=await dt(this.networkClient.sendPostRequestAsync.bind(this.networkClient),Ee.NetworkClientSendPostRequestAsync,this.logger,this.performanceClient,s)(t,i);const c=r.headers||{};(o=this.performanceClient)==null||o.addFields({refreshTokenSize:((a=r.body.refresh_token)==null?void 0:a.length)||0,httpVerToken:c[Kr.X_MS_HTTP_VERSION]||"",requestId:c[Kr.X_MS_REQUEST_ID]||""},s)}catch(c){if(c instanceof Iy){const h=c.responseHeaders;throw h&&((l=this.performanceClient)==null||l.addFields({httpVerToken:h[Kr.X_MS_HTTP_VERSION]||"",requestId:h[Kr.X_MS_REQUEST_ID]||"",contentTypeHeader:h[Kr.CONTENT_TYPE]||void 0,contentLengthHeader:h[Kr.CONTENT_LENGTH]||void 0,httpStatus:c.httpStatus},s)),c.error}throw c instanceof zi?c:ut(jP)}return ec.postProcess(this.cacheManager,e,r),r}async updateAuthority(e,t){var r;(r=this.performanceClient)==null||r.addQueueMeasurement(Ee.UpdateTokenEndpointAuthority,t);const i=`https://${e}/${this.authority.tenant}/`,s=await EN(i,this.networkClient,this.cacheManager,this.authority.options,this.logger,t,this.performanceClient);this.authority=s}createTokenQueryParameters(e){const t=new Pp(e.correlationId,this.performanceClient);return e.embeddedClientId&&t.addBrokerParameters({brokerClientId:this.config.authOptions.clientId,brokerRedirectUri:this.config.authOptions.redirectUri}),e.tokenQueryParameters&&t.addExtraQueryParameters(e.tokenQueryParameters),t.addCorrelationId(e.correlationId),t.createQueryString()}}/*! @azure/msal-common v15.2.0 2025-02-18 */const r5="no_tokens_found",TN="native_account_unavailable",E_="refresh_token_expired",OQ="interaction_required",DQ="consent_required",FQ="login_required",Ey="bad_token";/*! @azure/msal-common v15.2.0 2025-02-18 */const KC=[OQ,DQ,FQ,Ey],LQ=["message_only","additional_action","basic_action","user_password_expired","consent_required","bad_token"],BQ={[r5]:"No refresh token found in the cache. Please sign-in.",[TN]:"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API.",[E_]:"Refresh token has expired.",[Ey]:"Identity provider returned bad_token due to an expired or invalid refresh token. Please invoke an interactive API to resolve."};class hl extends zi{constructor(e,t,i,s,r,a,o,l){super(e,t,i),Object.setPrototypeOf(this,hl.prototype),this.timestamp=s||Ge.EMPTY_STRING,this.traceId=r||Ge.EMPTY_STRING,this.correlationId=a||Ge.EMPTY_STRING,this.claims=o||Ge.EMPTY_STRING,this.name="InteractionRequiredAuthError",this.errorNo=l}}function XC(n,e,t){const i=!!n&&KC.indexOf(n)>-1,s=!!t&&LQ.indexOf(t)>-1,r=!!e&&KC.some(a=>e.indexOf(a)>-1);return i||r||s}function G6(n){return new hl(n,BQ[n])}/*! @azure/msal-common v15.2.0 2025-02-18 */class ol{static setRequestState(e,t,i){const s=ol.generateLibraryState(e,i);return t?`${s}${Ge.RESOURCE_DELIM}${t}`:s}static generateLibraryState(e,t){if(!e)throw ut(L6);const i={id:e.createNewGuid()};t&&(i.meta=t);const s=JSON.stringify(i);return e.base64Encode(s)}static parseRequestState(e,t){if(!e)throw ut(L6);if(!t)throw ut(Gg);try{const i=t.split(Ge.RESOURCE_DELIM),s=i[0],r=i.length>1?i.slice(1).join(Ge.RESOURCE_DELIM):Ge.EMPTY_STRING,a=e.base64Decode(s),o=JSON.parse(a);return{userRequestState:r||Ge.EMPTY_STRING,libraryState:o}}catch{throw ut(Gg)}}}/*! @azure/msal-common v15.2.0 2025-02-18 */const UQ={SW:"sw",UHW:"uhw"};class Vg{constructor(e,t){this.cryptoUtils=e,this.performanceClient=t}async generateCnf(e,t){var r;(r=this.performanceClient)==null||r.addQueueMeasurement(Ee.PopTokenGenerateCnf,e.correlationId);const i=await dt(this.generateKid.bind(this),Ee.PopTokenGenerateCnf,t,this.performanceClient,e.correlationId)(e),s=this.cryptoUtils.base64UrlEncode(JSON.stringify(i));return{kid:i.kid,reqCnfString:s}}async generateKid(e){var i;return(i=this.performanceClient)==null||i.addQueueMeasurement(Ee.PopTokenGenerateKid,e.correlationId),{kid:await this.cryptoUtils.getPublicKeyThumbprint(e),xms_ksl:UQ.SW}}async signPopToken(e,t,i){return this.signPayload(e,t,i)}async signPayload(e,t,i,s){const{resourceRequestMethod:r,resourceRequestUri:a,shrClaims:o,shrNonce:l,shrOptions:c}=i,h=a?new Zn(a):void 0,u=h==null?void 0:h.getUrlComponents();return this.cryptoUtils.signJwt({at:e,ts:dc(),m:r==null?void 0:r.toUpperCase(),u:u==null?void 0:u.HostNameAndPort,nonce:l||this.cryptoUtils.createNewGuid(),p:u==null?void 0:u.AbsolutePath,q:u!=null&&u.QueryString?[[],u.QueryString]:void 0,client_claims:o||void 0,...s},t,c,i.correlationId)}}/*! @azure/msal-common v15.2.0 2025-02-18 */class HQ{constructor(e,t){this.cache=e,this.hasChanged=t}get cacheHasChanged(){return this.hasChanged}get tokenCache(){return this.cache}}/*! @azure/msal-common v15.2.0 2025-02-18 */function zQ(n){var i,s;const e="code=",t=(i=n.error_uri)==null?void 0:i.lastIndexOf(e);return t&&t>=0?(s=n.error_uri)==null?void 0:s.substring(t+e.length):void 0}class af{constructor(e,t,i,s,r,a,o){this.clientId=e,this.cacheStorage=t,this.cryptoObj=i,this.logger=s,this.serializableCache=r,this.persistencePlugin=a,this.performanceClient=o}validateServerAuthorizationCodeResponse(e,t){if(!e.state||!t)throw e.state?ut(e5,"Cached State"):ut(e5,"Server State");let i,s;try{i=decodeURIComponent(e.state)}catch{throw ut(Gg,e.state)}try{s=decodeURIComponent(t)}catch{throw ut(Gg,e.state)}if(i!==s)throw ut(qP);if(e.error||e.error_description||e.suberror){const r=zQ(e);throw XC(e.error,e.error_description,e.suberror)?new hl(e.error||"",e.error_description,e.suberror,e.timestamp||"",e.trace_id||"",e.correlation_id||"",e.claims||"",r):new Yh(e.error||"",e.error_description,e.suberror,r)}}validateTokenResponse(e,t){var i;if(e.error||e.error_description||e.suberror){const s=`Error(s): ${e.error_codes||Ge.NOT_AVAILABLE} - Timestamp: ${e.timestamp||Ge.NOT_AVAILABLE} - Description: ${e.error_description||Ge.NOT_AVAILABLE} - Correlation ID: ${e.correlation_id||Ge.NOT_AVAILABLE} - Trace ID: ${e.trace_id||Ge.NOT_AVAILABLE}`,r=(i=e.error_codes)!=null&&i.length?e.error_codes[0]:void 0,a=new Yh(e.error,s,e.suberror,r,e.status);if(t&&e.status&&e.status>=g9.SERVER_ERROR_RANGE_START&&e.status<=g9.SERVER_ERROR_RANGE_END){this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently unavailable and the access token is unable to be refreshed.
${a}`);return}else if(t&&e.status&&e.status>=g9.CLIENT_ERROR_RANGE_START&&e.status<=g9.CLIENT_ERROR_RANGE_END){this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently available but is unable to refresh the access token.
${a}`);return}throw XC(e.error,e.error_description,e.suberror)?new hl(e.error,e.error_description,e.suberror,e.timestamp||Ge.EMPTY_STRING,e.trace_id||Ge.EMPTY_STRING,e.correlation_id||Ge.EMPTY_STRING,e.claims||Ge.EMPTY_STRING,r):a}}async handleServerTokenResponse(e,t,i,s,r,a,o,l,c){var g;(g=this.performanceClient)==null||g.addQueueMeasurement(Ee.HandleServerTokenResponse,e.correlation_id);let h;if(e.id_token){if(h=sm(e.id_token||Ge.EMPTY_STRING,this.cryptoObj.base64Decode),r&&r.nonce&&h.nonce!==r.nonce)throw ut(WP);if(s.maxAge||s.maxAge===0){const m=h.auth_time;if(!m)throw ut(h_);sN(m,s.maxAge)}}this.homeAccountIdentifier=$r.generateHomeAccountId(e.client_info||Ge.EMPTY_STRING,t.authorityType,this.logger,this.cryptoObj,h);let u;r&&r.state&&(u=ol.parseRequestState(this.cryptoObj,r.state)),e.key_id=e.key_id||s.sshKid||void 0;const d=this.generateCacheRecord(e,t,i,s,h,a,r);let f;try{if(this.persistencePlugin&&this.serializableCache&&(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),f=new HQ(this.serializableCache,!0),await this.persistencePlugin.beforeCacheAccess(f)),o&&!l&&d.account){const m=d.account.generateAccountKey();if(!this.cacheStorage.getAccount(m))return this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),await af.generateAuthenticationResult(this.cryptoObj,t,d,!1,s,h,u,void 0,c)}await this.cacheStorage.saveCacheRecord(d,s.correlationId,s.storeInCache)}finally{this.persistencePlugin&&this.serializableCache&&f&&(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),await this.persistencePlugin.afterCacheAccess(f))}return af.generateAuthenticationResult(this.cryptoObj,t,d,!1,s,h,u,e,c)}generateCacheRecord(e,t,i,s,r,a,o){const l=t.getPreferredCache();if(!l)throw ut(d_);const c=wN(r);let h,u;e.id_token&&r&&(h=ky(this.homeAccountIdentifier,l,e.id_token,this.clientId,c||""),u=T_(this.cacheStorage,t,this.homeAccountIdentifier,this.cryptoObj.base64Decode,r,e.client_info,l,c,o,void 0,this.logger));let d=null;if(e.access_token){const m=e.scope?cs.fromString(e.scope):new cs(s.scopes||[]),b=(typeof e.expires_in=="string"?parseInt(e.expires_in,10):e.expires_in)||0,p=(typeof e.ext_expires_in=="string"?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,y=(typeof e.refresh_in=="string"?parseInt(e.refresh_in,10):e.refresh_in)||void 0,w=i+b,_=w+p,v=y&&y>0?i+y:void 0;d=Cy(this.homeAccountIdentifier,l,e.access_token,this.clientId,c||t.tenant||"",m.printScopes(),w,_,this.cryptoObj.base64Decode,v,e.token_type,a,e.key_id,s.claims,s.requestedClaimsHash)}let f=null;if(e.refresh_token){let m;if(e.refresh_token_expires_in){const b=typeof e.refresh_token_expires_in=="string"?parseInt(e.refresh_token_expires_in,10):e.refresh_token_expires_in;m=i+b}f=rN(this.homeAccountIdentifier,l,e.refresh_token,this.clientId,e.foci,a,m)}let g=null;return e.foci&&(g={clientId:this.clientId,environment:l,familyId:e.foci}),{account:u,idToken:h,accessToken:d,refreshToken:f,appMetadata:g}}static async generateAuthenticationResult(e,t,i,s,r,a,o,l,c){var w,_,v,C,k;let h=Ge.EMPTY_STRING,u=[],d=null,f,g,m=Ge.EMPTY_STRING;if(i.accessToken){if(i.accessToken.tokenType===pi.POP&&!r.popKid){const I=new Vg(e),{secret:E,keyId:T}=i.accessToken;if(!T)throw ut(f_);h=await I.signPopToken(E,T,r)}else h=i.accessToken.secret;u=cs.fromString(i.accessToken.target).asArray(),d=new Date(Number(i.accessToken.expiresOn)*1e3),f=new Date(Number(i.accessToken.extendedExpiresOn)*1e3),i.accessToken.refreshOn&&(g=new Date(Number(i.accessToken.refreshOn)*1e3))}i.appMetadata&&(m=i.appMetadata.familyId===Tp?Tp:"");const b=(a==null?void 0:a.oid)||(a==null?void 0:a.sub)||"",p=(a==null?void 0:a.tid)||"";l!=null&&l.spa_accountid&&i.account&&(i.account.nativeAccountId=l==null?void 0:l.spa_accountid);const y=i.account?k_(i.account.getAccountInfo(),void 0,a,(w=i.idToken)==null?void 0:w.secret):null;return{authority:t.canonicalAuthority,uniqueId:b,tenantId:p,scopes:u,account:y,idToken:((_=i==null?void 0:i.idToken)==null?void 0:_.secret)||"",idTokenClaims:a||{},accessToken:h,fromCache:s,expiresOn:d,extExpiresOn:f,refreshOn:g,correlationId:r.correlationId,requestId:c||Ge.EMPTY_STRING,familyId:m,tokenType:((v=i.accessToken)==null?void 0:v.tokenType)||Ge.EMPTY_STRING,state:o?o.userRequestState:Ge.EMPTY_STRING,cloudGraphHostName:((C=i.account)==null?void 0:C.cloudGraphHostName)||Ge.EMPTY_STRING,msGraphHost:((k=i.account)==null?void 0:k.msGraphHost)||Ge.EMPTY_STRING,code:l==null?void 0:l.spa_code,fromNativeBroker:!1}}}function T_(n,e,t,i,s,r,a,o,l,c,h){h==null||h.verbose("setCachedAccount called");const d=n.getAccountKeys().find(p=>p.startsWith(t));let f=null;d&&(f=n.getAccount(d));const g=f||$r.createAccount({homeAccountId:t,idTokenClaims:s,clientInfo:r,environment:a,cloudGraphHostName:l==null?void 0:l.cloud_graph_host_name,msGraphHost:l==null?void 0:l.msgraph_host,nativeAccountId:c},e,i),m=g.tenantProfiles||[],b=o||g.realm;if(b&&!m.find(p=>p.tenantId===b)){const p=v_(t,g.localAccountId,b,s);m.push(p)}return g.tenantProfiles=m,g}/*! @azure/msal-common v15.2.0 2025-02-18 */async function RN(n,e,t){return typeof n=="string"?n:n({clientId:e,tokenEndpoint:t})}/*! @azure/msal-common v15.2.0 2025-02-18 */class MN extends I_{constructor(e,t){var i;super(e,t),this.includeRedirectUri=!0,this.oidcDefaultScopes=(i=this.config.authOptions.authority.options.OIDCOptions)==null?void 0:i.defaultScopes}async getAuthCodeUrl(e){var i;(i=this.performanceClient)==null||i.addQueueMeasurement(Ee.GetAuthCodeUrl,e.correlationId);const t=await dt(this.createAuthCodeUrlQueryString.bind(this),Ee.AuthClientCreateQueryString,this.logger,this.performanceClient,e.correlationId)(e);return Zn.appendQueryString(this.authority.authorizationEndpoint,t)}async acquireToken(e,t){var o,l;if((o=this.performanceClient)==null||o.addQueueMeasurement(Ee.AuthClientAcquireToken,e.correlationId),!e.code)throw ut(YP);const i=dc(),s=await dt(this.executeTokenRequest.bind(this),Ee.AuthClientExecuteTokenRequest,this.logger,this.performanceClient,e.correlationId)(this.authority,e),r=(l=s.headers)==null?void 0:l[Kr.X_MS_REQUEST_ID],a=new af(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin,this.performanceClient);return a.validateTokenResponse(s.body),dt(a.handleServerTokenResponse.bind(a),Ee.HandleServerTokenResponse,this.logger,this.performanceClient,e.correlationId)(s.body,this.authority,i,e,t,void 0,void 0,void 0,r)}handleFragmentResponse(e,t){if(new af(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,null,null).validateServerAuthorizationCodeResponse(e,t),!e.code)throw ut(eN);return e}getLogoutUri(e){if(!e)throw ki(dN);const t=this.createLogoutUrlQueryString(e);return Zn.appendQueryString(this.authority.endSessionEndpoint,t)}async executeTokenRequest(e,t){var c,h;(c=this.performanceClient)==null||c.addQueueMeasurement(Ee.AuthClientExecuteTokenRequest,t.correlationId);const i=this.createTokenQueryParameters(t),s=Zn.appendQueryString(e.tokenEndpoint,i),r=await dt(this.createTokenRequestBody.bind(this),Ee.AuthClientCreateTokenRequestBody,this.logger,this.performanceClient,t.correlationId)(t);let a;if(t.clientInfo)try{const u=n5(t.clientInfo,this.cryptoUtils.base64Decode);a={credential:`${u.uid}${Mr.CLIENT_INFO_SEPARATOR}${u.utid}`,type:Ja.HOME_ACCOUNT_ID}}catch(u){this.logger.verbose("Could not parse client info for CCS Header: "+u)}const o=this.createTokenRequestHeaders(a||t.ccsCredential),l={clientId:((h=t.tokenBodyParameters)==null?void 0:h.clientId)||this.config.authOptions.clientId,authority:e.canonicalAuthority,scopes:t.scopes,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid};return dt(this.executePostToTokenEndpoint.bind(this),Ee.AuthorizationCodeClientExecutePostToTokenEndpoint,this.logger,this.performanceClient,t.correlationId)(s,r,o,l,t.correlationId,Ee.AuthorizationCodeClientExecutePostToTokenEndpoint)}async createTokenRequestBody(e){var s,r;(s=this.performanceClient)==null||s.addQueueMeasurement(Ee.AuthClientCreateTokenRequestBody,e.correlationId);const t=new Pp(e.correlationId,this.performanceClient);if(t.addClientId(e.embeddedClientId||((r=e.tokenBodyParameters)==null?void 0:r[rf])||this.config.authOptions.clientId),this.includeRedirectUri?t.addRedirectUri(e.redirectUri):Uf.validateRedirectUri(e.redirectUri),t.addScopes(e.scopes,!0,this.oidcDefaultScopes),t.addAuthorizationCode(e.code),t.addLibraryInfo(this.config.libraryInfo),t.addApplicationTelemetry(this.config.telemetry.application),t.addThrottling(),this.serverTelemetryManager&&!z6(this.config)&&t.addServerTelemetry(this.serverTelemetryManager),e.codeVerifier&&t.addCodeVerifier(e.codeVerifier),this.config.clientCredentials.clientSecret&&t.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const a=this.config.clientCredentials.clientAssertion;t.addClientAssertion(await RN(a.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),t.addClientAssertionType(a.assertionType)}if(t.addGrantType(BP.AUTHORIZATION_CODE_GRANT),t.addClientInfo(),e.authenticationScheme===pi.POP){const a=new Vg(this.cryptoUtils,this.performanceClient);let o;e.popKid?o=this.cryptoUtils.encodeKid(e.popKid):o=(await dt(a.generateCnf.bind(a),Ee.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,t.addPopToken(o)}else if(e.authenticationScheme===pi.SSH)if(e.sshJwk)t.addSshJwk(e.sshJwk);else throw ki(Ay);(!oc.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities);let i;if(e.clientInfo)try{const a=n5(e.clientInfo,this.cryptoUtils.base64Decode);i={credential:`${a.uid}${Mr.CLIENT_INFO_SEPARATOR}${a.utid}`,type:Ja.HOME_ACCOUNT_ID}}catch(a){this.logger.verbose("Could not parse client info for CCS Header: "+a)}else i=e.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&i)switch(i.type){case Ja.HOME_ACCOUNT_ID:try{const a=qf(i.credential);t.addCcsOid(a)}catch(a){this.logger.verbose("Could not parse home account ID for CCS Header: "+a)}break;case Ja.UPN:t.addCcsUpn(i.credential);break}return e.embeddedClientId&&t.addBrokerParameters({brokerClientId:this.config.authOptions.clientId,brokerRedirectUri:this.config.authOptions.redirectUri}),e.tokenBodyParameters&&t.addExtraQueryParameters(e.tokenBodyParameters),e.enableSpaAuthorizationCode&&(!e.tokenBodyParameters||!e.tokenBodyParameters[qC])&&t.addExtraQueryParameters({[qC]:"1"}),t.createQueryString()}async createAuthCodeUrlQueryString(e){var r,a,o,l,c,h,u,d,f,g;const t=e.correlationId||this.config.cryptoInterface.createNewGuid();(r=this.performanceClient)==null||r.addQueueMeasurement(Ee.AuthClientCreateQueryString,t);const i=new Pp(t,this.performanceClient);i.addClientId(e.embeddedClientId||((a=e.extraQueryParameters)==null?void 0:a[rf])||this.config.authOptions.clientId);const s=[...e.scopes||[],...e.extraScopesToConsent||[]];if(i.addScopes(s,!0,this.oidcDefaultScopes),i.addRedirectUri(e.redirectUri),i.addCorrelationId(t),i.addResponseMode(e.responseMode),i.addResponseTypeCode(),i.addLibraryInfo(this.config.libraryInfo),z6(this.config)||i.addApplicationTelemetry(this.config.telemetry.application),i.addClientInfo(),e.codeChallenge&&e.codeChallengeMethod&&i.addCodeChallengeParams(e.codeChallenge,e.codeChallengeMethod),e.prompt&&i.addPrompt(e.prompt),e.domainHint&&(i.addDomainHint(e.domainHint),(o=this.performanceClient)==null||o.addFields({domainHintFromRequest:!0},t)),(l=this.performanceClient)==null||l.addFields({prompt:e.prompt},t),e.prompt!==Vs.SELECT_ACCOUNT)if(e.sid&&e.prompt===Vs.NONE)this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),i.addSid(e.sid),(c=this.performanceClient)==null||c.addFields({sidFromRequest:!0},t);else if(e.account){const m=this.extractAccountSid(e.account);let b=this.extractLoginHint(e.account);if(b&&e.domainHint&&(this.logger.warning('AuthorizationCodeClient.createAuthCodeUrlQueryString: "domainHint" param is set, skipping opaque "login_hint" claim. Please consider not passing domainHint'),b=null),b){this.logger.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),i.addLoginHint(b),(h=this.performanceClient)==null||h.addFields({loginHintFromClaim:!0},t);try{const p=qf(e.account.homeAccountId);i.addCcsOid(p)}catch{this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(m&&e.prompt===Vs.NONE){this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),i.addSid(m),(u=this.performanceClient)==null||u.addFields({sidFromClaim:!0},t);try{const p=qf(e.account.homeAccountId);i.addCcsOid(p)}catch{this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(e.loginHint)this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),i.addLoginHint(e.loginHint),i.addCcsUpn(e.loginHint),(d=this.performanceClient)==null||d.addFields({loginHintFromRequest:!0},t);else if(e.account.username){this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),i.addLoginHint(e.account.username),(f=this.performanceClient)==null||f.addFields({loginHintFromUpn:!0},t);try{const p=qf(e.account.homeAccountId);i.addCcsOid(p)}catch{this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else e.loginHint&&(this.logger.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),i.addLoginHint(e.loginHint),i.addCcsUpn(e.loginHint),(g=this.performanceClient)==null||g.addFields({loginHintFromRequest:!0},t));else this.logger.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");if(e.nonce&&i.addNonce(e.nonce),e.state&&i.addState(e.state),(e.claims||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&i.addClaims(e.claims,this.config.authOptions.clientCapabilities),e.embeddedClientId&&i.addBrokerParameters({brokerClientId:this.config.authOptions.clientId,brokerRedirectUri:this.config.authOptions.redirectUri}),this.addExtraQueryParams(e,i),e.platformBroker&&(i.addNativeBroker(),e.authenticationScheme===pi.POP)){const m=new Vg(this.cryptoUtils);let b;e.popKid?b=this.cryptoUtils.encodeKid(e.popKid):b=(await dt(m.generateCnf.bind(m),Ee.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,i.addPopToken(b)}return i.createQueryString()}createLogoutUrlQueryString(e){const t=new Pp(e.correlationId,this.performanceClient);return e.postLogoutRedirectUri&&t.addPostLogoutRedirectUri(e.postLogoutRedirectUri),e.correlationId&&t.addCorrelationId(e.correlationId),e.idTokenHint&&t.addIdTokenHint(e.idTokenHint),e.state&&t.addState(e.state),e.logoutHint&&t.addLogoutHint(e.logoutHint),this.addExtraQueryParams(e,t),t.createQueryString()}addExtraQueryParams(e,t){!(e.extraQueryParameters&&e.extraQueryParameters.hasOwnProperty("instance_aware"))&&this.config.authOptions.instanceAware&&(e.extraQueryParameters=e.extraQueryParameters||{},e.extraQueryParameters.instance_aware="true"),e.extraQueryParameters&&t.addExtraQueryParameters(e.extraQueryParameters)}extractAccountSid(e){var t;return((t=e.idTokenClaims)==null?void 0:t.sid)||null}extractLoginHint(e){var t;return((t=e.idTokenClaims)==null?void 0:t.login_hint)||null}}/*! @azure/msal-common v15.2.0 2025-02-18 */const jQ=300;class GQ extends I_{constructor(e,t){super(e,t)}async acquireToken(e){var a,o;(a=this.performanceClient)==null||a.addQueueMeasurement(Ee.RefreshTokenClientAcquireToken,e.correlationId);const t=dc(),i=await dt(this.executeTokenRequest.bind(this),Ee.RefreshTokenClientExecuteTokenRequest,this.logger,this.performanceClient,e.correlationId)(e,this.authority),s=(o=i.headers)==null?void 0:o[Kr.X_MS_REQUEST_ID],r=new af(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return r.validateTokenResponse(i.body),dt(r.handleServerTokenResponse.bind(r),Ee.HandleServerTokenResponse,this.logger,this.performanceClient,e.correlationId)(i.body,this.authority,t,e,void 0,void 0,!0,e.forceCache,s)}async acquireTokenByRefreshToken(e){var i;if(!e)throw ki(uN);if((i=this.performanceClient)==null||i.addQueueMeasurement(Ee.RefreshTokenClientAcquireTokenByRefreshToken,e.correlationId),!e.account)throw ut(u_);if(this.cacheManager.isAppMetadataFOCI(e.account.environment))try{return await dt(this.acquireTokenWithCachedRefreshToken.bind(this),Ee.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!0)}catch(s){const r=s instanceof hl&&s.errorCode===r5,a=s instanceof Yh&&s.errorCode===NC.INVALID_GRANT_ERROR&&s.subError===NC.CLIENT_MISMATCH_ERROR;if(r||a)return dt(this.acquireTokenWithCachedRefreshToken.bind(this),Ee.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!1);throw s}return dt(this.acquireTokenWithCachedRefreshToken.bind(this),Ee.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!1)}async acquireTokenWithCachedRefreshToken(e,t){var r,a,o;(r=this.performanceClient)==null||r.addQueueMeasurement(Ee.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId);const i=I0(this.cacheManager.getRefreshToken.bind(this.cacheManager),Ee.CacheManagerGetRefreshToken,this.logger,this.performanceClient,e.correlationId)(e.account,t,void 0,this.performanceClient,e.correlationId);if(!i)throw G6(r5);if(i.expiresOn&&U6(i.expiresOn,e.refreshTokenExpirationOffsetSeconds||jQ))throw(a=this.performanceClient)==null||a.addFields({rtExpiresOnMs:Number(i.expiresOn)},e.correlationId),G6(E_);const s={...e,refreshToken:i.secret,authenticationScheme:e.authenticationScheme||pi.BEARER,ccsCredential:{credential:e.account.homeAccountId,type:Ja.HOME_ACCOUNT_ID}};try{return await dt(this.acquireToken.bind(this),Ee.RefreshTokenClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(s)}catch(l){if(l instanceof hl&&((o=this.performanceClient)==null||o.addFields({rtExpiresOnMs:Number(i.expiresOn)},e.correlationId),l.subError===Ey)){this.logger.verbose("acquireTokenWithRefreshToken: bad refresh token, removing from cache");const c=Mp(i);this.cacheManager.removeRefreshToken(c)}throw l}}async executeTokenRequest(e,t){var l,c;(l=this.performanceClient)==null||l.addQueueMeasurement(Ee.RefreshTokenClientExecuteTokenRequest,e.correlationId);const i=this.createTokenQueryParameters(e),s=Zn.appendQueryString(t.tokenEndpoint,i),r=await dt(this.createTokenRequestBody.bind(this),Ee.RefreshTokenClientCreateTokenRequestBody,this.logger,this.performanceClient,e.correlationId)(e),a=this.createTokenRequestHeaders(e.ccsCredential),o={clientId:((c=e.tokenBodyParameters)==null?void 0:c.clientId)||this.config.authOptions.clientId,authority:t.canonicalAuthority,scopes:e.scopes,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid};return dt(this.executePostToTokenEndpoint.bind(this),Ee.RefreshTokenClientExecutePostToTokenEndpoint,this.logger,this.performanceClient,e.correlationId)(s,r,a,o,e.correlationId,Ee.RefreshTokenClientExecutePostToTokenEndpoint)}async createTokenRequestBody(e){var s,r,a;(s=this.performanceClient)==null||s.addQueueMeasurement(Ee.RefreshTokenClientCreateTokenRequestBody,e.correlationId);const t=e.correlationId,i=new Pp(t,this.performanceClient);if(i.addClientId(e.embeddedClientId||((r=e.tokenBodyParameters)==null?void 0:r[rf])||this.config.authOptions.clientId),e.redirectUri&&i.addRedirectUri(e.redirectUri),i.addScopes(e.scopes,!0,(a=this.config.authOptions.authority.options.OIDCOptions)==null?void 0:a.defaultScopes),i.addGrantType(BP.REFRESH_TOKEN_GRANT),i.addClientInfo(),i.addLibraryInfo(this.config.libraryInfo),i.addApplicationTelemetry(this.config.telemetry.application),i.addThrottling(),this.serverTelemetryManager&&!z6(this.config)&&i.addServerTelemetry(this.serverTelemetryManager),i.addRefreshToken(e.refreshToken),this.config.clientCredentials.clientSecret&&i.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const o=this.config.clientCredentials.clientAssertion;i.addClientAssertion(await RN(o.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),i.addClientAssertionType(o.assertionType)}if(e.authenticationScheme===pi.POP){const o=new Vg(this.cryptoUtils,this.performanceClient);let l;e.popKid?l=this.cryptoUtils.encodeKid(e.popKid):l=(await dt(o.generateCnf.bind(o),Ee.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,i.addPopToken(l)}else if(e.authenticationScheme===pi.SSH)if(e.sshJwk)i.addSshJwk(e.sshJwk);else throw ki(Ay);if((!oc.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&i.addClaims(e.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&e.ccsCredential)switch(e.ccsCredential.type){case Ja.HOME_ACCOUNT_ID:try{const o=qf(e.ccsCredential.credential);i.addCcsOid(o)}catch(o){this.logger.verbose("Could not parse home account ID for CCS Header: "+o)}break;case Ja.UPN:i.addCcsUpn(e.ccsCredential.credential);break}return e.embeddedClientId&&i.addBrokerParameters({brokerClientId:this.config.authOptions.clientId,brokerRedirectUri:this.config.authOptions.redirectUri}),e.tokenBodyParameters&&i.addExtraQueryParameters(e.tokenBodyParameters),i.createQueryString()}}/*! @azure/msal-common v15.2.0 2025-02-18 */class VQ extends I_{constructor(e,t){super(e,t)}async acquireCachedToken(e){var l;(l=this.performanceClient)==null||l.addQueueMeasurement(Ee.SilentFlowClientAcquireCachedToken,e.correlationId);let t=bu.NOT_APPLICABLE;if(e.forceRefresh||!this.config.cacheOptions.claimsBasedCachingEnabled&&!oc.isEmptyObj(e.claims))throw this.setCacheOutcome(bu.FORCE_REFRESH_OR_CLAIMS,e.correlationId),ut(jh);if(!e.account)throw ut(u_);const i=e.account.tenantId||PQ(e.authority),s=this.cacheManager.getTokenKeys(),r=this.cacheManager.getAccessToken(e.account,e,s,i,this.performanceClient,e.correlationId);if(r){if(mZ(r.cachedAt)||U6(r.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw this.setCacheOutcome(bu.CACHED_ACCESS_TOKEN_EXPIRED,e.correlationId),ut(jh);r.refreshOn&&U6(r.refreshOn,0)&&(t=bu.PROACTIVELY_REFRESHED)}else throw this.setCacheOutcome(bu.NO_CACHED_ACCESS_TOKEN,e.correlationId),ut(jh);const a=e.authority||this.authority.getPreferredCache(),o={account:this.cacheManager.readAccountFromCache(e.account),accessToken:r,idToken:this.cacheManager.getIdToken(e.account,s,i,this.performanceClient,e.correlationId),refreshToken:null,appMetadata:this.cacheManager.readAppMetadataFromCache(a)};return this.setCacheOutcome(t,e.correlationId),this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[await dt(this.generateResultFromCacheRecord.bind(this),Ee.SilentFlowClientGenerateResultFromCacheRecord,this.logger,this.performanceClient,e.correlationId)(o,e),t]}setCacheOutcome(e,t){var i,s;(i=this.serverTelemetryManager)==null||i.setCacheOutcome(e),(s=this.performanceClient)==null||s.addFields({cacheOutcome:e},t),e!==bu.NOT_APPLICABLE&&this.logger.info(`Token refresh is required due to cache outcome: ${e}`)}async generateResultFromCacheRecord(e,t){var s;(s=this.performanceClient)==null||s.addQueueMeasurement(Ee.SilentFlowClientGenerateResultFromCacheRecord,t.correlationId);let i;if(e.idToken&&(i=sm(e.idToken.secret,this.config.cryptoInterface.base64Decode)),t.maxAge||t.maxAge===0){const r=i==null?void 0:i.auth_time;if(!r)throw ut(h_);sN(r,t.maxAge)}return af.generateAuthenticationResult(this.cryptoUtils,this.authority,e,!0,t,i)}}/*! @azure/msal-common v15.2.0 2025-02-18 */const qQ={sendGetRequestAsync:()=>Promise.reject(ut(On)),sendPostRequestAsync:()=>Promise.reject(ut(On))};/*! @azure/msal-common v15.2.0 2025-02-18 */const YC=",",PN="|";function WQ(n){const{skus:e,libraryName:t,libraryVersion:i,extensionName:s,extensionVersion:r}=n,a=new Map([[0,[t,i]],[2,[s,r]]]);let o=[];if(e!=null&&e.length){if(o=e.split(YC),o.length<4)return e}else o=Array.from({length:4},()=>PN);return a.forEach((l,c)=>{var h,u;l.length===2&&((h=l[0])!=null&&h.length)&&((u=l[1])!=null&&u.length)&&KQ({skuArr:o,index:c,skuName:l[0],skuVersion:l[1]})}),o.join(YC)}function KQ(n){const{skuArr:e,index:t,skuName:i,skuVersion:s}=n;t>=e.length||(e[t]=[i,s].join(PN))}class c2{constructor(e,t){this.cacheOutcome=bu.NOT_APPLICABLE,this.cacheManager=t,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||Ge.EMPTY_STRING,this.wrapperVer=e.wrapperVer||Ge.EMPTY_STRING,this.telemetryCacheKey=sr.CACHE_KEY+Mr.CACHE_KEY_SEPARATOR+e.clientId}generateCurrentRequestHeaderValue(){const e=`${this.apiId}${sr.VALUE_SEPARATOR}${this.cacheOutcome}`,t=[this.wrapperSKU,this.wrapperVer],i=this.getNativeBrokerErrorCode();i!=null&&i.length&&t.push(`broker_error=${i}`);const s=t.join(sr.VALUE_SEPARATOR),r=this.getRegionDiscoveryFields(),a=[e,r].join(sr.VALUE_SEPARATOR);return[sr.SCHEMA_VERSION,a,s].join(sr.CATEGORY_SEPARATOR)}generateLastRequestHeaderValue(){const e=this.getLastRequests(),t=c2.maxErrorsToSend(e),i=e.failedRequests.slice(0,2*t).join(sr.VALUE_SEPARATOR),s=e.errors.slice(0,t).join(sr.VALUE_SEPARATOR),r=e.errors.length,a=t<r?sr.OVERFLOW_TRUE:sr.OVERFLOW_FALSE,o=[r,a].join(sr.VALUE_SEPARATOR);return[sr.SCHEMA_VERSION,e.cacheHits,i,s,o].join(sr.CATEGORY_SEPARATOR)}cacheFailedRequest(e){const t=this.getLastRequests();t.errors.length>=sr.MAX_CACHED_ERRORS&&(t.failedRequests.shift(),t.failedRequests.shift(),t.errors.shift()),t.failedRequests.push(this.apiId,this.correlationId),e instanceof Error&&e&&e.toString()?e instanceof zi?e.subError?t.errors.push(e.subError):e.errorCode?t.errors.push(e.errorCode):t.errors.push(e.toString()):t.errors.push(e.toString()):t.errors.push(sr.UNKNOWN_ERROR),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)}incrementCacheHits(){const e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e),e.cacheHits}getLastRequests(){const e={failedRequests:[],errors:[],cacheHits:0};return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||e}clearTelemetryCache(){const e=this.getLastRequests(),t=c2.maxErrorsToSend(e),i=e.errors.length;if(t===i)this.cacheManager.removeItem(this.telemetryCacheKey);else{const s={failedRequests:e.failedRequests.slice(t*2),errors:e.errors.slice(t),cacheHits:0};this.cacheManager.setServerTelemetry(this.telemetryCacheKey,s)}}static maxErrorsToSend(e){let t,i=0,s=0;const r=e.errors.length;for(t=0;t<r;t++){const a=e.failedRequests[2*t]||Ge.EMPTY_STRING,o=e.failedRequests[2*t+1]||Ge.EMPTY_STRING,l=e.errors[t]||Ge.EMPTY_STRING;if(s+=a.toString().length+o.toString().length+l.length+3,s<sr.MAX_LAST_HEADER_BYTES)i+=1;else break}return i}getRegionDiscoveryFields(){const e=[];return e.push(this.regionUsed||Ge.EMPTY_STRING),e.push(this.regionSource||Ge.EMPTY_STRING),e.push(this.regionOutcome||Ge.EMPTY_STRING),e.join(",")}updateRegionDiscoveryMetadata(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome}setCacheOutcome(e){this.cacheOutcome=e}setNativeBrokerErrorCode(e){const t=this.getLastRequests();t.nativeBrokerErrorCode=e,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)}getNativeBrokerErrorCode(){return this.getLastRequests().nativeBrokerErrorCode}clearNativeBrokerErrorCode(){const e=this.getLastRequests();delete e.nativeBrokerErrorCode,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e)}static makeExtraSkuString(e){return WQ(e)}}/*! @azure/msal-common v15.2.0 2025-02-18 */const NN="missing_kid_error",ON="missing_alg_error";/*! @azure/msal-common v15.2.0 2025-02-18 */const XQ={[NN]:"The JOSE Header for the requested JWT, JWS or JWK object requires a keyId to be configured as the 'kid' header claim. No 'kid' value was provided.",[ON]:"The JOSE Header for the requested JWT, JWS or JWK object requires an algorithm to be specified as the 'alg' header claim. No 'alg' value was provided."};class R_ extends zi{constructor(e,t){super(e,t),this.name="JoseHeaderError",Object.setPrototypeOf(this,R_.prototype)}}function JC(n){return new R_(n,XQ[n])}/*! @azure/msal-common v15.2.0 2025-02-18 */class M_{constructor(e){this.typ=e.typ,this.alg=e.alg,this.kid=e.kid}static getShrHeaderString(e){if(!e.kid)throw JC(NN);if(!e.alg)throw JC(ON);const t=new M_({typ:e.typ||$J.Pop,kid:e.kid,alg:e.alg});return JSON.stringify(t)}}/*! @azure/msal-common v15.2.0 2025-02-18 */class ZC{startMeasurement(){}endMeasurement(){}flushMeasurement(){return null}}class YQ{generateId(){return"callback-id"}startMeasurement(e,t){return{end:()=>null,discard:()=>{},add:()=>{},increment:()=>{},event:{eventId:this.generateId(),status:MQ.InProgress,authority:"",libraryName:"",libraryVersion:"",clientId:"",name:e,startTimeMs:Date.now(),correlationId:t||""},measurement:new ZC}}startPerformanceMeasurement(){return new ZC}calculateQueuedTime(){return 0}addQueueMeasurement(){}setPreQueueTime(){}endMeasurement(){return null}discardMeasurements(){}removePerformanceCallback(){return!0}addPerformanceCallback(){return""}emitEvents(){}addFields(){}incrementFields(){}cacheEventByCorrelationId(){}}/*! @azure/msal-browser v4.5.0 2025-02-26 */const P_="pkce_not_created",V6="crypto_nonexistent",Ty="empty_navigate_uri",DN="hash_empty_error",N_="no_state_in_hash",FN="hash_does_not_contain_known_properties",LN="unable_to_parse_state",BN="state_interaction_type_mismatch",UN="interaction_in_progress",HN="popup_window_error",zN="empty_window_error",of="user_cancelled",JQ="monitor_popup_timeout",jN="monitor_window_timeout",GN="redirect_in_iframe",VN="block_iframe_reload",qN="block_nested_popups",ZQ="iframe_closed_prematurely",Ry="silent_logout_unsupported",WN="no_account_error",QQ="silent_prompt_value_error",KN="no_token_request_cache_error",XN="unable_to_parse_token_request_cache_error",O_="no_cached_authority_error",$Q="auth_request_not_set_error",e$="invalid_cache_type",My="non_browser_environment",Hf="database_not_open",a5="no_network_connectivity",YN="post_request_failed",JN="get_request_failed",q6="failed_to_parse_response",ZN="unable_to_load_token",D_="crypto_key_not_found",QN="auth_code_required",$N="auth_code_or_nativeAccountId_required",eO="spa_code_and_nativeAccountId_present",F_="database_unavailable",tO="unable_to_acquire_token_from_native_platform",nO="native_handshake_timeout",iO="native_extension_not_installed",Tx="native_connection_not_established",o5="uninitialized_public_client_application",sO="native_prompt_not_supported",rO="invalid_base64_string",aO="invalid_pop_token_request",oO="failed_to_build_headers",lO="failed_to_parse_headers";/*! @azure/msal-browser v4.5.0 2025-02-26 */const pc="For more visit: aka.ms/msaljs/browser-errors",t$={[P_]:"The PKCE code challenge and verifier could not be generated.",[V6]:"The crypto object or function is not available.",[Ty]:"Navigation URI is empty. Please check stack trace for more info.",[DN]:`Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash. ${pc}`,[N_]:"Hash does not contain state. Please verify that the request originated from msal.",[FN]:`Hash does not contain known properites. Please verify that your redirectUri is not changing the hash.  ${pc}`,[LN]:"Unable to parse state. Please verify that the request originated from msal.",[BN]:"Hash contains state but the interaction type does not match the caller.",[UN]:`Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.   ${pc}`,[HN]:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser.",[zN]:"window.open returned null or undefined window object.",[of]:"User cancelled the flow.",[JQ]:`Token acquisition in popup failed due to timeout.  ${pc}`,[jN]:`Token acquisition in iframe failed due to timeout.  ${pc}`,[GN]:"Redirects are not supported for iframed or brokered applications. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs.",[VN]:`Request was blocked inside an iframe because MSAL detected an authentication response.  ${pc}`,[qN]:"Request was blocked inside a popup because MSAL detected it was running in a popup.",[ZQ]:"The iframe being monitored was closed prematurely.",[Ry]:"Silent logout not supported. Please call logoutRedirect or logoutPopup instead.",[WN]:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request.",[QQ]:"The value given for the prompt value is not valid for silent requests - must be set to 'none' or 'no_session'.",[KN]:"No token request found in cache.",[XN]:"The cached token request could not be parsed.",[O_]:"No cached authority found.",[$Q]:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler",[e$]:"Invalid cache type",[My]:"Login and token requests are not supported in non-browser environments.",[Hf]:"Database is not open!",[a5]:"No network connectivity. Check your internet connection.",[YN]:"Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'",[JN]:"Network request failed. Please check the network trace to determine root cause.",[q6]:"Failed to parse network response. Check network trace.",[ZN]:"Error loading token to cache.",[D_]:"Cryptographic Key or Keypair not found in browser storage.",[QN]:"An authorization code must be provided (as the `code` property on the request) to this flow.",[$N]:"An authorization code or nativeAccountId must be provided to this flow.",[eO]:"Request cannot contain both spa code and native account id.",[F_]:"IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts.",[tO]:`Unable to acquire token from native platform.  ${pc}`,[nO]:"Timed out while attempting to establish connection to browser extension",[iO]:"Native extension is not installed. If you think this is a mistake call the initialize function.",[Tx]:`Connection to native platform has not been established. Please install a compatible browser extension and run initialize().  ${pc}`,[o5]:`You must call and await the initialize function before attempting to call any other MSAL API.  ${pc}`,[sO]:"The provided prompt is not supported by the native platform. This request should be routed to the web based flow.",[rO]:"Invalid base64 encoded string.",[aO]:"Invalid PoP token request. The request should not have both a popKid value and signPopToken set to true.",[oO]:"Failed to build request headers object.",[lO]:"Failed to parse response headers"};class Rx extends zi{constructor(e,t){super(e,t$[e],t),Object.setPrototypeOf(this,Rx.prototype),this.name="BrowserAuthError"}}function Bt(n,e){return new Rx(n,e)}/*! @azure/msal-browser v4.5.0 2025-02-26 */const Ka={INTERACTION_IN_PROGRESS_VALUE:"interaction_in_progress",INVALID_GRANT_ERROR:"invalid_grant",POPUP_WIDTH:483,POPUP_HEIGHT:600,POPUP_NAME_PREFIX:"msal",DEFAULT_POLL_INTERVAL_MS:30,MSAL_SKU:"msal.js.browser"},Wf={CHANNEL_ID:"53ee284d-920a-4b59-9d30-a60315b26836",PREFERRED_EXTENSION_ID:"ppnbnpeolgkicgegkbkbjmhlideopiji",MATS_TELEMETRY:"MATS"},Eu={HandshakeRequest:"Handshake",HandshakeResponse:"HandshakeResponse",GetToken:"GetToken",Response:"Response"},pr={LocalStorage:"localStorage",SessionStorage:"sessionStorage",MemoryStorage:"memoryStorage"},QC={GET:"GET",POST:"POST"},ui={AUTHORITY:"authority",ACQUIRE_TOKEN_ACCOUNT:"acquireToken.account",SESSION_STATE:"session.state",REQUEST_STATE:"request.state",NONCE_IDTOKEN:"nonce.id_token",ORIGIN_URI:"request.origin",RENEW_STATUS:"token.renew.status",URL_HASH:"urlHash",REQUEST_PARAMS:"request.params",SCOPES:"scopes",INTERACTION_STATUS_KEY:"interaction.status",CCS_CREDENTIAL:"ccs.credential",CORRELATION_ID:"request.correlationId",NATIVE_REQUEST:"request.native",REDIRECT_CONTEXT:"request.redirect.context"},Hh={ACCOUNT_KEYS:"msal.account.keys",TOKEN_KEYS:"msal.token.keys"},y9={WRAPPER_SKU:"wrapper.sku",WRAPPER_VER:"wrapper.version"},Ti={acquireTokenRedirect:861,acquireTokenPopup:862,ssoSilent:863,acquireTokenSilent_authCode:864,handleRedirectPromise:865,acquireTokenByCode:866,acquireTokenSilent_silentFlow:61,logout:961,logoutPopup:962};var an;(function(n){n.Redirect="redirect",n.Popup="popup",n.Silent="silent",n.None="none"})(an||(an={}));const $C={scopes:Ix},cO="jwk",W6="msal.db",n$=1,i$=`${W6}.keys`,Ia={Default:0,AccessToken:1,AccessTokenAndRefreshToken:2,RefreshToken:3,RefreshTokenAndNetwork:4,Skip:5},s$=[Ia.Default,Ia.Skip,Ia.RefreshTokenAndNetwork],r$="msal.browser.log.level",a$="msal.browser.log.pii";/*! @azure/msal-browser v4.5.0 2025-02-26 */function w9(n){return encodeURIComponent(L_(n).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"))}function lf(n){return hO(n).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function L_(n){return hO(new TextEncoder().encode(n))}function hO(n){const e=Array.from(n,t=>String.fromCodePoint(t)).join("");return btoa(e)}/*! @azure/msal-browser v4.5.0 2025-02-26 */function b0(n){return new TextDecoder().decode(l5(n))}function l5(n){let e=n.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw Bt(rO)}const t=atob(e);return Uint8Array.from(t,i=>i.codePointAt(0)||0)}/*! @azure/msal-browser v4.5.0 2025-02-26 */const o$="RSASSA-PKCS1-v1_5",Py="AES-GCM",uO="HKDF",B_="SHA-256",l$=2048,c$=new Uint8Array([1,0,1]),eA="0123456789abcdef",tA=new Uint32Array(1),dO="raw",fO="encrypt",gO="decrypt",h$="deriveKey",u$="crypto_subtle_undefined",U_={name:o$,hash:B_,modulusLength:l$,publicExponent:c$};function d$(n){if(!window)throw Bt(My);if(!window.crypto)throw Bt(V6);if(!n&&!window.crypto.subtle)throw Bt(V6,u$)}async function mO(n,e,t){e==null||e.addQueueMeasurement(Ee.Sha256Digest,t);const s=new TextEncoder().encode(n);return window.crypto.subtle.digest(B_,s)}function f$(n){return window.crypto.getRandomValues(n)}function Zw(){return window.crypto.getRandomValues(tA),tA[0]}function ul(){const n=Date.now(),e=Zw()*1024+(Zw()&1023),t=new Uint8Array(16),i=Math.trunc(e/2**30),s=e&2**30-1,r=Zw();t[0]=n/2**40,t[1]=n/2**32,t[2]=n/2**24,t[3]=n/2**16,t[4]=n/2**8,t[5]=n,t[6]=112|i>>>8,t[7]=i,t[8]=128|s>>>24,t[9]=s>>>16,t[10]=s>>>8,t[11]=s,t[12]=r>>>24,t[13]=r>>>16,t[14]=r>>>8,t[15]=r;let a="";for(let o=0;o<t.length;o++)a+=eA.charAt(t[o]>>>4),a+=eA.charAt(t[o]&15),(o===3||o===5||o===7||o===9)&&(a+="-");return a}async function g$(n,e){return window.crypto.subtle.generateKey(U_,n,e)}async function Qw(n){return window.crypto.subtle.exportKey(cO,n)}async function m$(n,e,t){return window.crypto.subtle.importKey(cO,n,U_,e,t)}async function p$(n,e){return window.crypto.subtle.sign(U_,n,e)}async function b$(){const n=await window.crypto.subtle.generateKey({name:Py,length:256},!0,[fO,gO]);return window.crypto.subtle.exportKey(dO,n)}async function nA(n){return window.crypto.subtle.importKey(dO,n,uO,!1,[h$])}async function pO(n,e,t){return window.crypto.subtle.deriveKey({name:uO,salt:e,hash:B_,info:new TextEncoder().encode(t)},n,{name:Py,length:256},!1,[fO,gO])}async function x$(n,e,t){const i=new TextEncoder().encode(e),s=window.crypto.getRandomValues(new Uint8Array(16)),r=await pO(n,s,t),a=await window.crypto.subtle.encrypt({name:Py,iv:new Uint8Array(12)},r,i);return{data:lf(new Uint8Array(a)),nonce:lf(s)}}async function y$(n,e,t,i){const s=l5(i),r=await pO(n,l5(e),t),a=await window.crypto.subtle.decrypt({name:Py,iv:new Uint8Array(12)},r,s);return new TextDecoder().decode(a)}async function bO(n){const e=await mO(n),t=new Uint8Array(e);return lf(t)}/*! @azure/msal-browser v4.5.0 2025-02-26 */const h2="storage_not_supported",K6="stubbed_public_client_application_called",c5="in_mem_redirect_unavailable";/*! @azure/msal-browser v4.5.0 2025-02-26 */const b3={[h2]:"Given storage configuration option was not supported.",[K6]:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors",[c5]:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."};b3[h2],b3[K6],b3[c5];class H_ extends zi{constructor(e,t){super(e,t),this.name="BrowserConfigurationAuthError",Object.setPrototypeOf(this,H_.prototype)}}function z_(n){return new H_(n,b3[n])}/*! @azure/msal-browser v4.5.0 2025-02-26 */function w$(n){n.location.hash="",typeof n.history.replaceState=="function"&&n.history.replaceState(null,"",`${n.location.origin}${n.location.pathname}${n.location.search}`)}function _$(n){const e=n.split("#");e.shift(),window.location.hash=e.length>0?e.join("#"):""}function j_(){return window.parent!==window}function v$(){return typeof window<"u"&&!!window.opener&&window.opener!==window&&typeof window.name=="string"&&window.name.indexOf(`${Ka.POPUP_NAME_PREFIX}.`)===0}function c0(){return typeof window<"u"&&window.location?window.location.href.split("?")[0].split("#")[0]:""}function k$(){const e=new Zn(window.location.href).getUrlComponents();return`${e.Protocol}//${e.HostNameAndPort}/`}function C$(){if(Zn.hashContainsKnownProperties(window.location.hash)&&j_())throw Bt(VN)}function A$(n){if(j_()&&!n)throw Bt(GN)}function S$(){if(v$())throw Bt(qN)}function xO(){if(typeof window>"u")throw Bt(My)}function yO(n){if(!n)throw Bt(o5)}function G_(n){xO(),C$(),S$(),yO(n)}function iA(n,e){if(G_(n),A$(e.system.allowRedirectInIframe),e.cache.cacheLocation===pr.MemoryStorage&&!e.cache.storeAuthStateInCookie)throw z_(c5)}function wO(n){const e=document.createElement("link");e.rel="preconnect",e.href=new URL(n).origin,e.crossOrigin="anonymous",document.head.appendChild(e),window.setTimeout(()=>{try{document.head.removeChild(e)}catch{}},1e4)}function I$(){return ul()}/*! @azure/msal-browser v4.5.0 2025-02-26 */class h5{navigateInternal(e,t){return h5.defaultNavigateWindow(e,t)}navigateExternal(e,t){return h5.defaultNavigateWindow(e,t)}static defaultNavigateWindow(e,t){return t.noHistory?window.location.replace(e):window.location.assign(e),new Promise(i=>{setTimeout(()=>{i(!0)},t.timeout)})}}/*! @azure/msal-browser v4.5.0 2025-02-26 */class E${async sendGetRequestAsync(e,t){let i,s={},r=0;const a=sA(t);try{i=await fetch(e,{method:QC.GET,headers:a})}catch{throw Bt(window.navigator.onLine?JN:a5)}s=rA(i.headers);try{return r=i.status,{headers:s,body:await i.json(),status:r}}catch{throw WC(Bt(q6),r,s)}}async sendPostRequestAsync(e,t){const i=t&&t.body||"",s=sA(t);let r,a=0,o={};try{r=await fetch(e,{method:QC.POST,headers:s,body:i})}catch{throw Bt(window.navigator.onLine?YN:a5)}o=rA(r.headers);try{return a=r.status,{headers:o,body:await r.json(),status:a}}catch{throw WC(Bt(q6),a,o)}}}function sA(n){try{const e=new Headers;if(!(n&&n.headers))return e;const t=n.headers;return Object.entries(t).forEach(([i,s])=>{e.append(i,s)}),e}catch{throw Bt(oO)}}function rA(n){try{const e={};return n.forEach((t,i)=>{e[i]=t}),e}catch{throw Bt(lO)}}/*! @azure/msal-browser v4.5.0 2025-02-26 */const T$=6e4,X6=1e4,R$=3e4,M$=2e3;function P$({auth:n,cache:e,system:t,telemetry:i},s){const r={clientId:Ge.EMPTY_STRING,authority:`${Ge.DEFAULT_AUTHORITY}`,knownAuthorities:[],cloudDiscoveryMetadata:Ge.EMPTY_STRING,authorityMetadata:Ge.EMPTY_STRING,redirectUri:typeof window<"u"?c0():"",postLogoutRedirectUri:Ge.EMPTY_STRING,navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:p0.AAD,OIDCOptions:{serverResponseType:Ex.FRAGMENT,defaultScopes:[Ge.OPENID_SCOPE,Ge.PROFILE_SCOPE,Ge.OFFLINE_ACCESS_SCOPE]},azureCloudOptions:{azureCloudInstance:p_.None,tenant:Ge.EMPTY_STRING},skipAuthorityMetadataCache:!1,supportsNestedAppAuth:!1,instanceAware:!1},a={cacheLocation:pr.SessionStorage,temporaryCacheLocation:pr.SessionStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!!(e&&e.cacheLocation===pr.LocalStorage),claimsBasedCachingEnabled:!1},o={loggerCallback:()=>{},logLevel:Di.Info,piiLoggingEnabled:!1},c={...{...AN,loggerOptions:o,networkClient:s?new E$:qQ,navigationClient:new h5,loadFrameTimeout:0,windowHashTimeout:(t==null?void 0:t.loadFrameTimeout)||T$,iframeHashTimeout:(t==null?void 0:t.loadFrameTimeout)||X6,navigateFrameWait:0,redirectNavigationTimeout:R$,asyncPopups:!1,allowRedirectInIframe:!1,allowPlatformBroker:!1,nativeBrokerHandshakeTimeout:(t==null?void 0:t.nativeBrokerHandshakeTimeout)||M$,pollIntervalMilliseconds:Ka.DEFAULT_POLL_INTERVAL_MS},...t,loggerOptions:(t==null?void 0:t.loggerOptions)||o},h={application:{appName:Ge.EMPTY_STRING,appVersion:Ge.EMPTY_STRING},client:new YQ};if((n==null?void 0:n.protocolMode)!==p0.OIDC&&(n!=null&&n.OIDCOptions)&&new Xh(c.loggerOptions).warning(JSON.stringify(ki(bN))),n!=null&&n.protocolMode&&n.protocolMode!==p0.AAD&&(c!=null&&c.allowPlatformBroker))throw ki(xN);return{auth:{...r,...n,OIDCOptions:{...r.OIDCOptions,...n==null?void 0:n.OIDCOptions}},cache:{...a,...e},system:c,telemetry:{...h,...i}}}/*! @azure/msal-browser v4.5.0 2025-02-26 */const N$="@azure/msal-browser",Ny="4.5.0";/*! @azure/msal-browser v4.5.0 2025-02-26 */class V_{static loggerCallback(e,t){switch(e){case Di.Error:console.error(t);return;case Di.Info:console.info(t);return;case Di.Verbose:return;case Di.Warning:console.warn(t);return;default:return}}constructor(e){var l;this.browserEnvironment=typeof window<"u",this.config=P$(e,this.browserEnvironment);let t;try{t=window[pr.SessionStorage]}catch{}const i=t==null?void 0:t.getItem(r$),s=(l=t==null?void 0:t.getItem(a$))==null?void 0:l.toLowerCase(),r=s==="true"?!0:s==="false"?!1:void 0,a={...this.config.system.loggerOptions},o=i&&Object.keys(Di).includes(i)?Di[i]:void 0;o&&(a.loggerCallback=V_.loggerCallback,a.logLevel=o),r!==void 0&&(a.piiLoggingEnabled=r),this.logger=new Xh(a,N$,Ny),this.available=!1}getConfig(){return this.config}getLogger(){return this.logger}isAvailable(){return this.available}isBrowserEnvironment(){return this.browserEnvironment}}/*! @azure/msal-browser v4.5.0 2025-02-26 */class cf extends V_{getModuleName(){return cf.MODULE_NAME}getId(){return cf.ID}async initialize(){return this.available=typeof window<"u",this.available}}cf.MODULE_NAME="";cf.ID="StandardOperatingContext";/*! @azure/msal-browser v4.5.0 2025-02-26 */class O${constructor(){this.dbName=W6,this.version=n$,this.tableName=i$,this.dbOpen=!1}async open(){return new Promise((e,t)=>{const i=window.indexedDB.open(this.dbName,this.version);i.addEventListener("upgradeneeded",s=>{s.target.result.createObjectStore(this.tableName)}),i.addEventListener("success",s=>{const r=s;this.db=r.target.result,this.dbOpen=!0,e()}),i.addEventListener("error",()=>t(Bt(F_)))})}closeConnection(){const e=this.db;e&&this.dbOpen&&(e.close(),this.dbOpen=!1)}async validateDbIsOpen(){if(!this.dbOpen)return this.open()}async getItem(e){return await this.validateDbIsOpen(),new Promise((t,i)=>{if(!this.db)return i(Bt(Hf));const a=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).get(e);a.addEventListener("success",o=>{const l=o;this.closeConnection(),t(l.target.result)}),a.addEventListener("error",o=>{this.closeConnection(),i(o)})})}async setItem(e,t){return await this.validateDbIsOpen(),new Promise((i,s)=>{if(!this.db)return s(Bt(Hf));const o=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).put(t,e);o.addEventListener("success",()=>{this.closeConnection(),i()}),o.addEventListener("error",l=>{this.closeConnection(),s(l)})})}async removeItem(e){return await this.validateDbIsOpen(),new Promise((t,i)=>{if(!this.db)return i(Bt(Hf));const a=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).delete(e);a.addEventListener("success",()=>{this.closeConnection(),t()}),a.addEventListener("error",o=>{this.closeConnection(),i(o)})})}async getKeys(){return await this.validateDbIsOpen(),new Promise((e,t)=>{if(!this.db)return t(Bt(Hf));const r=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).getAllKeys();r.addEventListener("success",a=>{const o=a;this.closeConnection(),e(o.target.result)}),r.addEventListener("error",a=>{this.closeConnection(),t(a)})})}async containsKey(e){return await this.validateDbIsOpen(),new Promise((t,i)=>{if(!this.db)return i(Bt(Hf));const a=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).count(e);a.addEventListener("success",o=>{const l=o;this.closeConnection(),t(l.target.result===1)}),a.addEventListener("error",o=>{this.closeConnection(),i(o)})})}async deleteDatabase(){return this.db&&this.dbOpen&&this.closeConnection(),new Promise((e,t)=>{const i=window.indexedDB.deleteDatabase(W6),s=setTimeout(()=>t(!1),200);i.addEventListener("success",()=>(clearTimeout(s),e(!0))),i.addEventListener("blocked",()=>(clearTimeout(s),e(!0))),i.addEventListener("error",()=>(clearTimeout(s),t(!1)))})}}/*! @azure/msal-browser v4.5.0 2025-02-26 */class Oy{constructor(){this.cache=new Map}async initialize(){}getItem(e){return this.cache.get(e)||null}getUserData(e){return this.getItem(e)}setItem(e,t){this.cache.set(e,t)}async setUserData(e,t){this.setItem(e,t)}removeItem(e){this.cache.delete(e)}getKeys(){const e=[];return this.cache.forEach((t,i)=>{e.push(i)}),e}containsKey(e){return this.cache.has(e)}clear(){this.cache.clear()}}/*! @azure/msal-browser v4.5.0 2025-02-26 */class D${constructor(e){this.inMemoryCache=new Oy,this.indexedDBCache=new O$,this.logger=e}handleDatabaseAccessError(e){if(e instanceof Rx&&e.errorCode===F_)this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.");else throw e}async getItem(e){const t=this.inMemoryCache.getItem(e);if(!t)try{return this.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.getItem(e)}catch(i){this.handleDatabaseAccessError(i)}return t}async setItem(e,t){this.inMemoryCache.setItem(e,t);try{await this.indexedDBCache.setItem(e,t)}catch(i){this.handleDatabaseAccessError(i)}}async removeItem(e){this.inMemoryCache.removeItem(e);try{await this.indexedDBCache.removeItem(e)}catch(t){this.handleDatabaseAccessError(t)}}async getKeys(){const e=this.inMemoryCache.getKeys();if(e.length===0)try{return this.logger.verbose("In-memory cache is empty, now querying persistent storage."),await this.indexedDBCache.getKeys()}catch(t){this.handleDatabaseAccessError(t)}return e}async containsKey(e){const t=this.inMemoryCache.containsKey(e);if(!t)try{return this.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.containsKey(e)}catch(i){this.handleDatabaseAccessError(i)}return t}clearInMemory(){this.logger.verbose("Deleting in-memory keystore"),this.inMemoryCache.clear(),this.logger.verbose("In-memory keystore deleted")}async clearPersistent(){try{this.logger.verbose("Deleting persistent keystore");const e=await this.indexedDBCache.deleteDatabase();return e&&this.logger.verbose("Persistent keystore deleted"),e}catch(e){return this.handleDatabaseAccessError(e),!1}}}/*! @azure/msal-browser v4.5.0 2025-02-26 */class qg{constructor(e,t,i){this.logger=e,d$(i??!1),this.cache=new D$(this.logger),this.performanceClient=t}createNewGuid(){return ul()}base64Encode(e){return L_(e)}base64Decode(e){return b0(e)}base64UrlEncode(e){return w9(e)}encodeKid(e){return this.base64UrlEncode(JSON.stringify({kid:e}))}async getPublicKeyThumbprint(e){var h;const t=(h=this.performanceClient)==null?void 0:h.startMeasurement(Ee.CryptoOptsGetPublicKeyThumbprint,e.correlationId),i=await g$(qg.EXTRACTABLE,qg.POP_KEY_USAGES),s=await Qw(i.publicKey),r={e:s.e,kty:s.kty,n:s.n},a=aA(r),o=await this.hashString(a),l=await Qw(i.privateKey),c=await m$(l,!1,["sign"]);return await this.cache.setItem(o,{privateKey:c,publicKey:i.publicKey,requestMethod:e.resourceRequestMethod,requestUri:e.resourceRequestUri}),t&&t.end({success:!0}),o}async removeTokenBindingKey(e){return await this.cache.removeItem(e),!await this.cache.containsKey(e)}async clearKeystore(){this.cache.clearInMemory();try{return await this.cache.clearPersistent(),!0}catch(e){return e instanceof Error?this.logger.error(`Clearing keystore failed with error: ${e.message}`):this.logger.error("Clearing keystore failed with unknown error"),!1}}async signJwt(e,t,i,s){var w;const r=(w=this.performanceClient)==null?void 0:w.startMeasurement(Ee.CryptoOptsSignJwt,s),a=await this.cache.getItem(t);if(!a)throw Bt(D_);const o=await Qw(a.publicKey),l=aA(o),c=w9(JSON.stringify({kid:t})),h=M_.getShrHeaderString({...i==null?void 0:i.header,alg:o.alg,kid:c}),u=w9(h);e.cnf={jwk:JSON.parse(l)};const d=w9(JSON.stringify(e)),f=`${u}.${d}`,m=new TextEncoder().encode(f),b=await p$(a.privateKey,m),p=lf(new Uint8Array(b)),y=`${f}.${p}`;return r&&r.end({success:!0}),y}async hashString(e){return bO(e)}}qg.POP_KEY_USAGES=["sign","verify"];qg.EXTRACTABLE=!0;function aA(n){return JSON.stringify(n,Object.keys(n).sort())}/*! @azure/msal-browser v4.5.0 2025-02-26 */const F$=24*60*60*1e3,Y6={Lax:"Lax",None:"None"};class _O{initialize(){return Promise.resolve()}getItem(e){const t=`${encodeURIComponent(e)}`,i=document.cookie.split(";");for(let s=0;s<i.length;s++){const r=i[s],[a,...o]=decodeURIComponent(r).trim().split("="),l=o.join("=");if(a===t)return l}return""}getUserData(){throw ut(On)}setItem(e,t,i,s=!0,r=Y6.Lax){let a=`${encodeURIComponent(e)}=${encodeURIComponent(t)};path=/;SameSite=${r};`;if(i){const o=L$(i);a+=`expires=${o};`}(s||r===Y6.None)&&(a+="Secure;"),document.cookie=a}async setUserData(){return Promise.reject(ut(On))}removeItem(e){this.setItem(e,"",-1)}getKeys(){const e=document.cookie.split(";"),t=[];return e.forEach(i=>{const s=decodeURIComponent(i).trim().split("=");t.push(s[0])}),t}containsKey(e){return this.getKeys().includes(e)}}function L$(n){const e=new Date;return new Date(e.getTime()+n*F$).toUTCString()}/*! @azure/msal-browser v4.5.0 2025-02-26 */function J6(n){const e=n.getItem(Hh.ACCOUNT_KEYS);return e?JSON.parse(e):[]}function Z6(n,e){const t=e.getItem(`${Hh.TOKEN_KEYS}.${n}`);if(t){const i=JSON.parse(t);if(i&&i.hasOwnProperty("idToken")&&i.hasOwnProperty("accessToken")&&i.hasOwnProperty("refreshToken"))return i}return{idToken:[],accessToken:[],refreshToken:[]}}/*! @azure/msal-browser v4.5.0 2025-02-26 */const oA="msal.cache.encryption",B$="msal.broadcast.cache";class U${constructor(e,t,i){if(!window.localStorage)throw z_(h2);this.memoryStorage=new Oy,this.initialized=!1,this.clientId=e,this.logger=t,this.performanceClient=i,this.broadcast=new BroadcastChannel(B$)}async initialize(e){this.initialized=!0;const t=new _O,i=t.getItem(oA);let s={key:"",id:""};if(i)try{s=JSON.parse(i)}catch{}if(s.key&&s.id){const r=I0(l5,Ee.Base64Decode,this.logger,this.performanceClient,e)(s.key);this.encryptionCookie={id:s.id,key:await dt(nA,Ee.GenerateHKDF,this.logger,this.performanceClient,e)(r)},await dt(this.importExistingCache.bind(this),Ee.ImportExistingCache,this.logger,this.performanceClient,e)(e)}else{this.clear();const r=ul(),a=await dt(b$,Ee.GenerateBaseKey,this.logger,this.performanceClient,e)(),o=I0(lf,Ee.UrlEncodeArr,this.logger,this.performanceClient,e)(new Uint8Array(a));this.encryptionCookie={id:r,key:await dt(nA,Ee.GenerateHKDF,this.logger,this.performanceClient,e)(a)};const l={id:r,key:o};t.setItem(oA,JSON.stringify(l),0,!0,Y6.None)}this.broadcast.addEventListener("message",this.updateCache.bind(this))}getItem(e){return window.localStorage.getItem(e)}getUserData(e){if(!this.initialized)throw Bt(o5);return this.memoryStorage.getItem(e)}setItem(e,t){window.localStorage.setItem(e,t)}async setUserData(e,t,i){if(!this.initialized||!this.encryptionCookie)throw Bt(o5);const{data:s,nonce:r}=await dt(x$,Ee.Encrypt,this.logger,this.performanceClient,i)(this.encryptionCookie.key,t,this.getContext(e)),a={id:this.encryptionCookie.id,nonce:r,data:s};this.memoryStorage.setItem(e,t),this.setItem(e,JSON.stringify(a)),this.broadcast.postMessage({key:e,value:t,context:this.getContext(e)})}removeItem(e){this.memoryStorage.containsKey(e)&&(this.memoryStorage.removeItem(e),this.broadcast.postMessage({key:e,value:null,context:this.getContext(e)})),window.localStorage.removeItem(e)}getKeys(){return Object.keys(window.localStorage)}containsKey(e){return window.localStorage.hasOwnProperty(e)}clear(){this.memoryStorage.clear(),J6(this).forEach(i=>this.removeItem(i));const t=Z6(this.clientId,this);t.idToken.forEach(i=>this.removeItem(i)),t.accessToken.forEach(i=>this.removeItem(i)),t.refreshToken.forEach(i=>this.removeItem(i)),this.getKeys().forEach(i=>{(i.startsWith(Ge.CACHE_PREFIX)||i.indexOf(this.clientId)!==-1)&&this.removeItem(i)})}async importExistingCache(e){if(!this.encryptionCookie)return;let t=J6(this);t=await this.importArray(t,e),this.setItem(Hh.ACCOUNT_KEYS,JSON.stringify(t));const i=Z6(this.clientId,this);i.idToken=await this.importArray(i.idToken,e),i.accessToken=await this.importArray(i.accessToken,e),i.refreshToken=await this.importArray(i.refreshToken,e),this.setItem(`${Hh.TOKEN_KEYS}.${this.clientId}`,JSON.stringify(i))}async getItemFromEncryptedCache(e,t){if(!this.encryptionCookie)return null;const i=this.getItem(e);if(!i)return null;let s;try{s=JSON.parse(i)}catch{return null}return!s.id||!s.nonce||!s.data?(this.performanceClient.incrementFields({unencryptedCacheCount:1},t),null):s.id!==this.encryptionCookie.id?(this.performanceClient.incrementFields({encryptedCacheExpiredCount:1},t),null):dt(y$,Ee.Decrypt,this.logger,this.performanceClient,t)(this.encryptionCookie.key,s.nonce,this.getContext(e),s.data)}async importArray(e,t){const i=[],s=[];return e.forEach(r=>{const a=this.getItemFromEncryptedCache(r,t).then(o=>{o?(this.memoryStorage.setItem(r,o),i.push(r)):this.removeItem(r)});s.push(a)}),await Promise.all(s),i}getContext(e){let t="";return e.includes(this.clientId)&&(t=this.clientId),t}updateCache(e){this.logger.trace("Updating internal cache from broadcast event");const t=this.performanceClient.startMeasurement(Ee.LocalStorageUpdated);t.add({isBackground:!0});const{key:i,value:s,context:r}=e.data;if(!i){this.logger.error("Broadcast event missing key"),t.end({success:!1,errorCode:"noKey"});return}if(r&&r!==this.clientId){this.logger.trace(`Ignoring broadcast event from clientId: ${r}`),t.end({success:!1,errorCode:"contextMismatch"});return}s?(this.memoryStorage.setItem(i,s),this.logger.verbose("Updated item in internal cache")):(this.memoryStorage.removeItem(i),this.logger.verbose("Removed item from internal cache")),t.end({success:!0})}}/*! @azure/msal-browser v4.5.0 2025-02-26 */class H${constructor(){if(!window.sessionStorage)throw z_(h2)}async initialize(){}getItem(e){return window.sessionStorage.getItem(e)}getUserData(e){return this.getItem(e)}setItem(e,t){window.sessionStorage.setItem(e,t)}async setUserData(e,t){this.setItem(e,t)}removeItem(e){window.sessionStorage.removeItem(e)}getKeys(){return Object.keys(window.sessionStorage)}containsKey(e){return window.sessionStorage.hasOwnProperty(e)}}/*! @azure/msal-browser v4.5.0 2025-02-26 */function vO(n,e){if(!e)return null;try{return ol.parseRequestState(n,e).libraryState.meta}catch{throw ut(Gg)}}/*! @azure/msal-browser v4.5.0 2025-02-26 */const ln={INITIALIZE_START:"msal:initializeStart",INITIALIZE_END:"msal:initializeEnd",ACCOUNT_ADDED:"msal:accountAdded",ACCOUNT_REMOVED:"msal:accountRemoved",ACTIVE_ACCOUNT_CHANGED:"msal:activeAccountChanged",LOGIN_START:"msal:loginStart",LOGIN_SUCCESS:"msal:loginSuccess",LOGIN_FAILURE:"msal:loginFailure",ACQUIRE_TOKEN_START:"msal:acquireTokenStart",ACQUIRE_TOKEN_SUCCESS:"msal:acquireTokenSuccess",ACQUIRE_TOKEN_FAILURE:"msal:acquireTokenFailure",ACQUIRE_TOKEN_NETWORK_START:"msal:acquireTokenFromNetworkStart",SSO_SILENT_START:"msal:ssoSilentStart",SSO_SILENT_SUCCESS:"msal:ssoSilentSuccess",SSO_SILENT_FAILURE:"msal:ssoSilentFailure",ACQUIRE_TOKEN_BY_CODE_START:"msal:acquireTokenByCodeStart",ACQUIRE_TOKEN_BY_CODE_SUCCESS:"msal:acquireTokenByCodeSuccess",ACQUIRE_TOKEN_BY_CODE_FAILURE:"msal:acquireTokenByCodeFailure",HANDLE_REDIRECT_START:"msal:handleRedirectStart",HANDLE_REDIRECT_END:"msal:handleRedirectEnd",POPUP_OPENED:"msal:popupOpened",LOGOUT_START:"msal:logoutStart",LOGOUT_SUCCESS:"msal:logoutSuccess",LOGOUT_FAILURE:"msal:logoutFailure",LOGOUT_END:"msal:logoutEnd",RESTORE_FROM_BFCACHE:"msal:restoreFromBFCache"};/*! @azure/msal-browser v4.5.0 2025-02-26 */class Q6 extends H6{constructor(e,t,i,s,r,a,o){super(e,i,s,o),this.cacheConfig=t,this.logger=s,this.internalStorage=new Oy,this.browserStorage=lA(e,t.cacheLocation,s,r),this.temporaryCacheStorage=lA(e,t.temporaryCacheLocation,s,r),this.cookieStorage=new _O,this.performanceClient=r,this.eventHandler=a}async initialize(e){await this.browserStorage.initialize(e)}validateAndParseJson(e){try{const t=JSON.parse(e);return t&&typeof t=="object"?t:null}catch{return null}}getAccount(e){this.logger.trace("BrowserCacheManager.getAccount called");const t=this.browserStorage.getUserData(e);if(!t)return this.removeAccountKeyFromMap(e),null;const i=this.validateAndParseJson(t);return!i||!$r.isAccountEntity(i)?(this.removeAccountKeyFromMap(e),null):H6.toObject(new $r,i)}async setAccount(e,t){this.logger.trace("BrowserCacheManager.setAccount called");const i=e.generateAccountKey();await dt(this.browserStorage.setUserData.bind(this.browserStorage),Ee.SetUserData,this.logger,this.performanceClient)(i,JSON.stringify(e),t);const s=this.addAccountKeyToMap(i);this.cacheConfig.cacheLocation===pr.LocalStorage&&s&&this.eventHandler.emitEvent(ln.ACCOUNT_ADDED,void 0,e.getAccountInfo())}getAccountKeys(){return J6(this.browserStorage)}addAccountKeyToMap(e){this.logger.trace("BrowserCacheManager.addAccountKeyToMap called"),this.logger.tracePii(`BrowserCacheManager.addAccountKeyToMap called with key: ${e}`);const t=this.getAccountKeys();return t.indexOf(e)===-1?(t.push(e),this.browserStorage.setItem(Hh.ACCOUNT_KEYS,JSON.stringify(t)),this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key added"),!0):(this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key already exists in map"),!1)}removeAccountKeyFromMap(e){this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap called"),this.logger.tracePii(`BrowserCacheManager.removeAccountKeyFromMap called with key: ${e}`);const t=this.getAccountKeys(),i=t.indexOf(e);i>-1?(t.splice(i,1),this.browserStorage.setItem(Hh.ACCOUNT_KEYS,JSON.stringify(t)),this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap account key removed")):this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap key not found in existing map")}async removeAccount(e){super.removeAccount(e),this.removeAccountKeyFromMap(e)}async removeAccountContext(e){await super.removeAccountContext(e),this.cacheConfig.cacheLocation===pr.LocalStorage&&this.eventHandler.emitEvent(ln.ACCOUNT_REMOVED,void 0,e.getAccountInfo())}removeIdToken(e){super.removeIdToken(e),this.removeTokenKey(e,An.ID_TOKEN)}async removeAccessToken(e){super.removeAccessToken(e),this.removeTokenKey(e,An.ACCESS_TOKEN)}removeRefreshToken(e){super.removeRefreshToken(e),this.removeTokenKey(e,An.REFRESH_TOKEN)}getTokenKeys(){return Z6(this.clientId,this.browserStorage)}addTokenKey(e,t){this.logger.trace("BrowserCacheManager addTokenKey called");const i=this.getTokenKeys();switch(t){case An.ID_TOKEN:i.idToken.indexOf(e)===-1&&(this.logger.info("BrowserCacheManager: addTokenKey - idToken added to map"),i.idToken.push(e));break;case An.ACCESS_TOKEN:i.accessToken.indexOf(e)===-1&&(this.logger.info("BrowserCacheManager: addTokenKey - accessToken added to map"),i.accessToken.push(e));break;case An.REFRESH_TOKEN:i.refreshToken.indexOf(e)===-1&&(this.logger.info("BrowserCacheManager: addTokenKey - refreshToken added to map"),i.refreshToken.push(e));break;default:throw this.logger.error(`BrowserCacheManager:addTokenKey - CredentialType provided invalid. CredentialType: ${t}`),ut(B6)}this.browserStorage.setItem(`${Hh.TOKEN_KEYS}.${this.clientId}`,JSON.stringify(i))}removeTokenKey(e,t){this.logger.trace("BrowserCacheManager removeTokenKey called");const i=this.getTokenKeys();switch(t){case An.ID_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove idToken with key: ${e} from map`);const s=i.idToken.indexOf(e);s>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - idToken removed from map"),i.idToken.splice(s,1)):this.logger.info("BrowserCacheManager: removeTokenKey - idToken does not exist in map. Either it was previously removed or it was never added.");break;case An.ACCESS_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove accessToken with key: ${e} from map`);const r=i.accessToken.indexOf(e);r>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - accessToken removed from map"),i.accessToken.splice(r,1)):this.logger.info("BrowserCacheManager: removeTokenKey - accessToken does not exist in map. Either it was previously removed or it was never added.");break;case An.REFRESH_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove refreshToken with key: ${e} from map`);const a=i.refreshToken.indexOf(e);a>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken removed from map"),i.refreshToken.splice(a,1)):this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken does not exist in map. Either it was previously removed or it was never added.");break;default:throw this.logger.error(`BrowserCacheManager:removeTokenKey - CredentialType provided invalid. CredentialType: ${t}`),ut(B6)}this.browserStorage.setItem(`${Hh.TOKEN_KEYS}.${this.clientId}`,JSON.stringify(i))}getIdTokenCredential(e){const t=this.browserStorage.getUserData(e);if(!t)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(e,An.ID_TOKEN),null;const i=this.validateAndParseJson(t);return!i||!bZ(i)?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(e,An.ID_TOKEN),null):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),i)}async setIdTokenCredential(e,t){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");const i=Mp(e);await dt(this.browserStorage.setUserData.bind(this.browserStorage),Ee.SetUserData,this.logger,this.performanceClient)(i,JSON.stringify(e),t),this.addTokenKey(i,An.ID_TOKEN)}getAccessTokenCredential(e){const t=this.browserStorage.getUserData(e);if(!t)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,An.ACCESS_TOKEN),null;const i=this.validateAndParseJson(t);return!i||!pZ(i)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,An.ACCESS_TOKEN),null):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),i)}async setAccessTokenCredential(e,t){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");const i=Mp(e);await dt(this.browserStorage.setUserData.bind(this.browserStorage),Ee.SetUserData,this.logger,this.performanceClient)(i,JSON.stringify(e),t),this.addTokenKey(i,An.ACCESS_TOKEN)}getRefreshTokenCredential(e){const t=this.browserStorage.getUserData(e);if(!t)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,An.REFRESH_TOKEN),null;const i=this.validateAndParseJson(t);return!i||!xZ(i)?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,An.REFRESH_TOKEN),null):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),i)}async setRefreshTokenCredential(e,t){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");const i=Mp(e);await dt(this.browserStorage.setUserData.bind(this.browserStorage),Ee.SetUserData,this.logger,this.performanceClient)(i,JSON.stringify(e),t),this.addTokenKey(i,An.REFRESH_TOKEN)}getAppMetadata(e){const t=this.browserStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;const i=this.validateAndParseJson(t);return!i||!IZ(e,i)?(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),i)}setAppMetadata(e){this.logger.trace("BrowserCacheManager.setAppMetadata called");const t=SZ(e);this.browserStorage.setItem(t,JSON.stringify(e))}getServerTelemetry(e){const t=this.browserStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;const i=this.validateAndParseJson(t);return!i||!CZ(e,i)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),i)}setServerTelemetry(e,t){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.browserStorage.setItem(e,JSON.stringify(t))}getAuthorityMetadata(e){const t=this.internalStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;const i=this.validateAndParseJson(t);return i&&EZ(e,i)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),i):null}getAuthorityMetadataKeys(){return this.internalStorage.getKeys().filter(t=>this.isAuthorityMetadata(t))}setWrapperMetadata(e,t){this.internalStorage.setItem(y9.WRAPPER_SKU,e),this.internalStorage.setItem(y9.WRAPPER_VER,t)}getWrapperMetadata(){const e=this.internalStorage.getItem(y9.WRAPPER_SKU)||Ge.EMPTY_STRING,t=this.internalStorage.getItem(y9.WRAPPER_VER)||Ge.EMPTY_STRING;return[e,t]}setAuthorityMetadata(e,t){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(e,JSON.stringify(t))}getActiveAccount(){const e=this.generateCacheKey(MC.ACTIVE_ACCOUNT_FILTERS),t=this.browserStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getActiveAccount: No active account filters found"),null;const i=this.validateAndParseJson(t);return i?(this.logger.trace("BrowserCacheManager.getActiveAccount: Active account filters schema found"),this.getAccountInfoFilteredBy({homeAccountId:i.homeAccountId,localAccountId:i.localAccountId,tenantId:i.tenantId})):(this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null)}setActiveAccount(e){const t=this.generateCacheKey(MC.ACTIVE_ACCOUNT_FILTERS);if(e){this.logger.verbose("setActiveAccount: Active account set");const i={homeAccountId:e.homeAccountId,localAccountId:e.localAccountId,tenantId:e.tenantId};this.browserStorage.setItem(t,JSON.stringify(i))}else this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(t);this.eventHandler.emitEvent(ln.ACTIVE_ACCOUNT_CHANGED)}getThrottlingCache(e){const t=this.browserStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;const i=this.validateAndParseJson(t);return!i||!AZ(e,i)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),i)}setThrottlingCache(e,t){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.browserStorage.setItem(e,JSON.stringify(t))}getTemporaryCache(e,t){const i=t?this.generateCacheKey(e):e;if(this.cacheConfig.storeAuthStateInCookie){const r=this.cookieStorage.getItem(i);if(r)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),r}const s=this.temporaryCacheStorage.getItem(i);if(!s){if(this.cacheConfig.cacheLocation===pr.LocalStorage){const r=this.browserStorage.getItem(i);if(r)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),r}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),s}setTemporaryCache(e,t,i){const s=i?this.generateCacheKey(e):e;this.temporaryCacheStorage.setItem(s,t),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.cookieStorage.setItem(s,t,void 0,this.cacheConfig.secureCookies))}removeItem(e){this.browserStorage.removeItem(e)}removeTemporaryItem(e){this.temporaryCacheStorage.removeItem(e),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.cookieStorage.removeItem(e))}getKeys(){return this.browserStorage.getKeys()}async clear(){await this.removeAllAccounts(),this.removeAppMetadata(),this.temporaryCacheStorage.getKeys().forEach(e=>{(e.indexOf(Ge.CACHE_PREFIX)!==-1||e.indexOf(this.clientId)!==-1)&&this.removeTemporaryItem(e)}),this.browserStorage.getKeys().forEach(e=>{(e.indexOf(Ge.CACHE_PREFIX)!==-1||e.indexOf(this.clientId)!==-1)&&this.browserStorage.removeItem(e)}),this.internalStorage.clear()}async clearTokensAndKeysWithClaims(e,t){e.addQueueMeasurement(Ee.ClearTokensAndKeysWithClaims,t);const i=this.getTokenKeys(),s=[];i.accessToken.forEach(r=>{const a=this.getAccessTokenCredential(r);a!=null&&a.requestedClaimsHash&&r.includes(a.requestedClaimsHash.toLowerCase())&&s.push(this.removeAccessToken(r))}),await Promise.all(s),s.length>0&&this.logger.warning(`${s.length} access tokens with claims in the cache keys have been removed from the cache.`)}generateCacheKey(e){return this.validateAndParseJson(e)?JSON.stringify(e):oc.startsWith(e,Ge.CACHE_PREFIX)?e:`${Ge.CACHE_PREFIX}.${this.clientId}.${e}`}generateAuthorityKey(e){const{libraryState:{id:t}}=ol.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${ui.AUTHORITY}.${t}`)}generateNonceKey(e){const{libraryState:{id:t}}=ol.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${ui.NONCE_IDTOKEN}.${t}`)}generateStateKey(e){const{libraryState:{id:t}}=ol.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${ui.REQUEST_STATE}.${t}`)}getCachedAuthority(e){const t=this.generateStateKey(e),i=this.getTemporaryCache(t);if(!i)return null;const s=this.generateAuthorityKey(i);return this.getTemporaryCache(s)}updateCacheEntries(e,t,i,s,r){this.logger.trace("BrowserCacheManager.updateCacheEntries called");const a=this.generateStateKey(e);this.setTemporaryCache(a,e,!1);const o=this.generateNonceKey(e);this.setTemporaryCache(o,t,!1);const l=this.generateAuthorityKey(e);if(this.setTemporaryCache(l,i,!1),r){const c={credential:r.homeAccountId,type:Ja.HOME_ACCOUNT_ID};this.setTemporaryCache(ui.CCS_CREDENTIAL,JSON.stringify(c),!0)}else if(s){const c={credential:s,type:Ja.UPN};this.setTemporaryCache(ui.CCS_CREDENTIAL,JSON.stringify(c),!0)}}resetRequestCache(e){this.logger.trace("BrowserCacheManager.resetRequestCache called"),e&&(this.temporaryCacheStorage.getKeys().forEach(t=>{t.indexOf(e)!==-1&&this.removeTemporaryItem(t)}),this.removeTemporaryItem(this.generateStateKey(e)),this.removeTemporaryItem(this.generateNonceKey(e)),this.removeTemporaryItem(this.generateAuthorityKey(e))),this.removeTemporaryItem(this.generateCacheKey(ui.REQUEST_PARAMS)),this.removeTemporaryItem(this.generateCacheKey(ui.ORIGIN_URI)),this.removeTemporaryItem(this.generateCacheKey(ui.URL_HASH)),this.removeTemporaryItem(this.generateCacheKey(ui.CORRELATION_ID)),this.removeTemporaryItem(this.generateCacheKey(ui.CCS_CREDENTIAL)),this.removeTemporaryItem(this.generateCacheKey(ui.NATIVE_REQUEST)),this.setInteractionInProgress(!1)}cleanRequestByState(e){if(this.logger.trace("BrowserCacheManager.cleanRequestByState called"),e){const t=this.generateStateKey(e),i=this.temporaryCacheStorage.getItem(t);this.logger.infoPii(`BrowserCacheManager.cleanRequestByState: Removing temporary cache items for state: ${i}`),this.resetRequestCache(i||Ge.EMPTY_STRING)}}cleanRequestByInteractionType(e){this.logger.trace("BrowserCacheManager.cleanRequestByInteractionType called"),this.temporaryCacheStorage.getKeys().forEach(t=>{if(t.indexOf(ui.REQUEST_STATE)===-1)return;const i=this.temporaryCacheStorage.getItem(t);if(!i)return;const s=vO(this.cryptoImpl,i);s&&s.interactionType===e&&(this.logger.infoPii(`BrowserCacheManager.cleanRequestByInteractionType: Removing temporary cache items for state: ${i}`),this.resetRequestCache(i))}),this.setInteractionInProgress(!1)}cacheCodeRequest(e){this.logger.trace("BrowserCacheManager.cacheCodeRequest called");const t=L_(JSON.stringify(e));this.setTemporaryCache(ui.REQUEST_PARAMS,t,!0)}getCachedRequest(e){this.logger.trace("BrowserCacheManager.getCachedRequest called");const t=this.getTemporaryCache(ui.REQUEST_PARAMS,!0);if(!t)throw Bt(KN);let i;try{i=JSON.parse(b0(t))}catch(s){throw this.logger.errorPii(`Attempted to parse: ${t}`),this.logger.error(`Parsing cached token request threw with error: ${s}`),Bt(XN)}if(this.removeTemporaryItem(this.generateCacheKey(ui.REQUEST_PARAMS)),!i.authority){const s=this.generateAuthorityKey(e),r=this.getTemporaryCache(s);if(!r)throw Bt(O_);i.authority=r}return i}getCachedNativeRequest(){this.logger.trace("BrowserCacheManager.getCachedNativeRequest called");const e=this.getTemporaryCache(ui.NATIVE_REQUEST,!0);if(!e)return this.logger.trace("BrowserCacheManager.getCachedNativeRequest: No cached native request found"),null;const t=this.validateAndParseJson(e);return t||(this.logger.error("BrowserCacheManager.getCachedNativeRequest: Unable to parse native request"),null)}isInteractionInProgress(e){const t=this.getInteractionInProgress();return e?t===this.clientId:!!t}getInteractionInProgress(){const e=`${Ge.CACHE_PREFIX}.${ui.INTERACTION_STATUS_KEY}`;return this.getTemporaryCache(e,!1)}setInteractionInProgress(e){const t=`${Ge.CACHE_PREFIX}.${ui.INTERACTION_STATUS_KEY}`;if(e){if(this.getInteractionInProgress())throw Bt(UN);this.setTemporaryCache(t,this.clientId,!1)}else!e&&this.getInteractionInProgress()===this.clientId&&this.removeTemporaryItem(t)}async hydrateCache(e,t){var o,l,c;const i=ky((o=e.account)==null?void 0:o.homeAccountId,(l=e.account)==null?void 0:l.environment,e.idToken,this.clientId,e.tenantId);let s;t.claims&&(s=await this.cryptoImpl.hashString(t.claims));const r=Cy((c=e.account)==null?void 0:c.homeAccountId,e.account.environment,e.accessToken,this.clientId,e.tenantId,e.scopes.join(" "),e.expiresOn?e.expiresOn.getTime()/1e3:0,e.extExpiresOn?e.extExpiresOn.getTime()/1e3:0,b0,void 0,e.tokenType,void 0,t.sshKid,t.claims,s),a={idToken:i,accessToken:r};return this.saveCacheRecord(a,e.correlationId)}async saveCacheRecord(e,t,i){try{await super.saveCacheRecord(e,t,i)}catch(s){if(s instanceof f1&&this.performanceClient&&t)try{const r=this.getTokenKeys();this.performanceClient.addFields({cacheRtCount:r.refreshToken.length,cacheIdCount:r.idToken.length,cacheAtCount:r.accessToken.length},t)}catch{}throw s}}}function lA(n,e,t,i){try{switch(e){case pr.LocalStorage:return new U$(n,t,i);case pr.SessionStorage:return new H$;case pr.MemoryStorage:default:break}}catch(s){t.error(s)}return new Oy}const z$=(n,e,t,i)=>{const s={cacheLocation:pr.MemoryStorage,temporaryCacheLocation:pr.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1};return new Q6(n,s,t5,e,t,i)};/*! @azure/msal-browser v4.5.0 2025-02-26 */function j$(n,e,t,i){return n.verbose("getAllAccounts called"),t?e.getAllAccounts(i):[]}function G$(n,e,t){if(e.trace("getAccount called"),Object.keys(n).length===0)return e.warning("getAccount: No accountFilter provided"),null;const i=t.getAccountInfoFilteredBy(n);return i?(e.verbose("getAccount: Account matching provided filter found, returning"),i):(e.verbose("getAccount: No matching account found, returning null"),null)}function V$(n,e,t){if(e.trace("getAccountByUsername called"),!n)return e.warning("getAccountByUsername: No username provided"),null;const i=t.getAccountInfoFilteredBy({username:n});return i?(e.verbose("getAccountByUsername: Account matching username found, returning"),e.verbosePii(`getAccountByUsername: Returning signed-in accounts matching username: ${n}`),i):(e.verbose("getAccountByUsername: No matching account found, returning null"),null)}function q$(n,e,t){if(e.trace("getAccountByHomeId called"),!n)return e.warning("getAccountByHomeId: No homeAccountId provided"),null;const i=t.getAccountInfoFilteredBy({homeAccountId:n});return i?(e.verbose("getAccountByHomeId: Account matching homeAccountId found, returning"),e.verbosePii(`getAccountByHomeId: Returning signed-in accounts matching homeAccountId: ${n}`),i):(e.verbose("getAccountByHomeId: No matching account found, returning null"),null)}function W$(n,e,t){if(e.trace("getAccountByLocalId called"),!n)return e.warning("getAccountByLocalId: No localAccountId provided"),null;const i=t.getAccountInfoFilteredBy({localAccountId:n});return i?(e.verbose("getAccountByLocalId: Account matching localAccountId found, returning"),e.verbosePii(`getAccountByLocalId: Returning signed-in accounts matching localAccountId: ${n}`),i):(e.verbose("getAccountByLocalId: No matching account found, returning null"),null)}function K$(n,e){e.setActiveAccount(n)}function X$(n){return n.getActiveAccount()}/*! @azure/msal-browser v4.5.0 2025-02-26 */const Y$="msal.broadcast.event";class J${constructor(e){this.eventCallbacks=new Map,this.logger=e||new Xh({}),this.broadcastChannel=new BroadcastChannel(Y$),this.invokeCrossTabCallbacks=this.invokeCrossTabCallbacks.bind(this)}addEventCallback(e,t,i){if(typeof window<"u"){const s=i||I$();return this.eventCallbacks.has(s)?(this.logger.error(`Event callback with id: ${s} is already registered. Please provide a unique id or remove the existing callback and try again.`),null):(this.eventCallbacks.set(s,[e,t||[]]),this.logger.verbose(`Event callback registered with id: ${s}`),s)}return null}removeEventCallback(e){this.eventCallbacks.delete(e),this.logger.verbose(`Event callback ${e} removed.`)}emitEvent(e,t,i,s){const r={eventType:e,interactionType:t||null,payload:i||null,error:s||null,timestamp:Date.now()};switch(e){case ln.ACCOUNT_ADDED:case ln.ACCOUNT_REMOVED:case ln.ACTIVE_ACCOUNT_CHANGED:this.broadcastChannel.postMessage(r);break;default:this.invokeCallbacks(r);break}}invokeCallbacks(e){this.eventCallbacks.forEach(([t,i],s)=>{(i.length===0||i.includes(e.eventType))&&(this.logger.verbose(`Emitting event to callback ${s}: ${e.eventType}`),t.apply(null,[e]))})}invokeCrossTabCallbacks(e){const t=e.data;this.invokeCallbacks(t)}subscribeCrossTab(){this.broadcastChannel.addEventListener("message",this.invokeCrossTabCallbacks)}unsubscribeCrossTab(){this.broadcastChannel.removeEventListener("message",this.invokeCrossTabCallbacks)}}/*! @azure/msal-browser v4.5.0 2025-02-26 */class kO{constructor(e,t,i,s,r,a,o,l,c){this.config=e,this.browserStorage=t,this.browserCrypto=i,this.networkClient=this.config.system.networkClient,this.eventHandler=r,this.navigationClient=a,this.nativeMessageHandler=l,this.correlationId=c||ul(),this.logger=s.clone(Ka.MSAL_SKU,Ny,this.correlationId),this.performanceClient=o}async clearCacheOnLogout(e){if(e){$r.accountInfoIsEqual(e,this.browserStorage.getActiveAccount(),!1)&&(this.logger.verbose("Setting active account to null"),this.browserStorage.setActiveAccount(null));try{await this.browserStorage.removeAccount($r.generateAccountCacheKey(e)),this.logger.verbose("Cleared cache items belonging to the account provided in the logout request.")}catch{this.logger.error("Account provided in logout request was not found. Local cache unchanged.")}}else try{this.logger.verbose("No account provided in logout request, clearing all cache items.",this.correlationId),await this.browserStorage.clear(),await this.browserCrypto.clearKeystore()}catch{this.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged.")}}getRedirectUri(e){this.logger.verbose("getRedirectUri called");const t=e||this.config.auth.redirectUri;return Zn.getAbsoluteUrl(t,c0())}initializeServerTelemetryManager(e,t){this.logger.verbose("initializeServerTelemetryManager called");const i={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:e,forceRefresh:t||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]};return new c2(i,this.browserStorage)}async getDiscoveredAuthority(e){const{account:t}=e,i=e.requestExtraQueryParameters&&e.requestExtraQueryParameters.hasOwnProperty("instance_aware")?e.requestExtraQueryParameters.instance_aware:void 0;this.performanceClient.addQueueMeasurement(Ee.StandardInteractionClientGetDiscoveredAuthority,this.correlationId);const s={protocolMode:this.config.auth.protocolMode,OIDCOptions:this.config.auth.OIDCOptions,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},r=e.requestAuthority||this.config.auth.authority,a=i!=null&&i.length?i==="true":this.config.auth.instanceAware,o=t&&a?this.config.auth.authority.replace(Zn.getDomainFromUrl(r),t.environment):r,l=Rr.generateAuthority(o,e.requestAzureCloudOptions||this.config.auth.azureCloudOptions),c=await dt(EN,Ee.AuthorityFactoryCreateDiscoveredInstance,this.logger,this.performanceClient,this.correlationId)(l,this.config.system.networkClient,this.browserStorage,s,this.logger,this.correlationId,this.performanceClient);if(t&&!c.isAlias(t.environment))throw ki(yN);return c}}/*! @azure/msal-browser v4.5.0 2025-02-26 */const Z$=32;async function CO(n,e,t){n.addQueueMeasurement(Ee.GeneratePkceCodes,t);const i=I0(Q$,Ee.GenerateCodeVerifier,e,n,t)(n,e,t),s=await dt($$,Ee.GenerateCodeChallengeFromVerifier,e,n,t)(i,n,e,t);return{verifier:i,challenge:s}}function Q$(n,e,t){try{const i=new Uint8Array(Z$);return I0(f$,Ee.GetRandomValues,e,n,t)(i),lf(i)}catch{throw Bt(P_)}}async function $$(n,e,t,i){e.addQueueMeasurement(Ee.GenerateCodeChallengeFromVerifier,i);try{const s=await dt(mO,Ee.Sha256Digest,t,e,i)(n,e,i);return lf(new Uint8Array(s))}catch{throw Bt(P_)}}/*! @azure/msal-browser v4.5.0 2025-02-26 */async function q_(n,e,t,i){t.addQueueMeasurement(Ee.InitializeBaseRequest,n.correlationId);const s=n.authority||e.auth.authority,r=[...n&&n.scopes||[]],a={...n,correlationId:n.correlationId,authority:s,scopes:r};if(!a.authenticationScheme)a.authenticationScheme=pi.BEARER,i.verbose(`Authentication Scheme wasn't explicitly set in request, defaulting to "Bearer" request`);else{if(a.authenticationScheme===pi.SSH){if(!n.sshJwk)throw ki(Ay);if(!n.sshKid)throw ki(pN)}i.verbose(`Authentication Scheme set to "${a.authenticationScheme}" as configured in Auth request`)}return e.cache.claimsBasedCachingEnabled&&n.claims&&!oc.isEmptyObj(n.claims)&&(a.requestedClaimsHash=await bO(n.claims)),a}async function eee(n,e,t,i,s){i.addQueueMeasurement(Ee.InitializeSilentRequest,n.correlationId);const r=await dt(q_,Ee.InitializeBaseRequest,s,i,n.correlationId)(n,t,i,s);return{...n,...r,account:e,forceRefresh:n.forceRefresh||!1}}/*! @azure/msal-browser v4.5.0 2025-02-26 */class rm extends kO{async initializeAuthorizationCodeRequest(e,t){this.performanceClient.addQueueMeasurement(Ee.StandardInteractionClientInitializeAuthorizationCodeRequest,this.correlationId);const i=t||await dt(CO,Ee.GeneratePkceCodes,this.logger,this.performanceClient,this.correlationId)(this.performanceClient,this.logger,this.correlationId),s={...e,redirectUri:e.redirectUri,code:Ge.EMPTY_STRING,codeVerifier:i.verifier};return e.codeChallenge=i.challenge,e.codeChallengeMethod=Ge.S256_CODE_CHALLENGE_METHOD,s}initializeLogoutRequest(e){this.logger.verbose("initializeLogoutRequest called",e==null?void 0:e.correlationId);const t={correlationId:this.correlationId||ul(),...e};if(e)if(e.logoutHint)this.logger.verbose("logoutHint has already been set in logoutRequest");else if(e.account){const i=this.getLogoutHintFromIdTokenClaims(e.account);i&&(this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided"),t.logoutHint=i)}else this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set");else this.logger.verbose("logoutHint will not be set since no logout request was configured");return!e||e.postLogoutRedirectUri!==null?e&&e.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",t.correlationId),t.postLogoutRedirectUri=Zn.getAbsoluteUrl(e.postLogoutRedirectUri,c0())):this.config.auth.postLogoutRedirectUri===null?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",t.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",t.correlationId),t.postLogoutRedirectUri=Zn.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,c0())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",t.correlationId),t.postLogoutRedirectUri=Zn.getAbsoluteUrl(c0(),c0())):this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",t.correlationId),t}getLogoutHintFromIdTokenClaims(e){const t=e.idTokenClaims;if(t){if(t.login_hint)return t.login_hint;this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}else this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request");return null}async createAuthCodeClient(e){this.performanceClient.addQueueMeasurement(Ee.StandardInteractionClientCreateAuthCodeClient,this.correlationId);const t=await dt(this.getClientConfiguration.bind(this),Ee.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)(e);return new MN(t,this.performanceClient)}async getClientConfiguration(e){const{serverTelemetryManager:t,requestAuthority:i,requestAzureCloudOptions:s,requestExtraQueryParameters:r,account:a}=e;this.performanceClient.addQueueMeasurement(Ee.StandardInteractionClientGetClientConfiguration,this.correlationId);const o=await dt(this.getDiscoveredAuthority.bind(this),Ee.StandardInteractionClientGetDiscoveredAuthority,this.logger,this.performanceClient,this.correlationId)({requestAuthority:i,requestAzureCloudOptions:s,requestExtraQueryParameters:r,account:a}),l=this.config.system.loggerOptions;return{authOptions:{clientId:this.config.auth.clientId,authority:o,clientCapabilities:this.config.auth.clientCapabilities,redirectUri:this.config.auth.redirectUri},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:l.loggerCallback,piiLoggingEnabled:l.piiLoggingEnabled,logLevel:l.logLevel,correlationId:this.correlationId},cacheOptions:{claimsBasedCachingEnabled:this.config.cache.claimsBasedCachingEnabled},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:t,libraryInfo:{sku:Ka.MSAL_SKU,version:Ny,cpu:Ge.EMPTY_STRING,os:Ge.EMPTY_STRING},telemetry:this.config.telemetry}}async initializeAuthorizationRequest(e,t){this.performanceClient.addQueueMeasurement(Ee.StandardInteractionClientInitializeAuthorizationRequest,this.correlationId);const i=this.getRedirectUri(e.redirectUri),s={interactionType:t},r=ol.setRequestState(this.browserCrypto,e&&e.state||Ge.EMPTY_STRING,s),o={...await dt(q_,Ee.InitializeBaseRequest,this.logger,this.performanceClient,this.correlationId)({...e,correlationId:this.correlationId},this.config,this.performanceClient,this.logger),redirectUri:i,state:r,nonce:e.nonce||ul(),responseMode:this.config.auth.OIDCOptions.serverResponseType};if(e.loginHint||e.sid)return o;const l=e.account||this.browserStorage.getActiveAccount();return l&&(this.logger.verbose("Setting validated request account",this.correlationId),this.logger.verbosePii(`Setting validated request account: ${l.homeAccountId}`,this.correlationId),o.account=l),o}}/*! @azure/msal-browser v4.5.0 2025-02-26 */const tee="ContentError",AO="user_switch";/*! @azure/msal-browser v4.5.0 2025-02-26 */const nee="USER_INTERACTION_REQUIRED",iee="USER_CANCEL",see="NO_NETWORK",ree="PERSISTENT_ERROR",aee="DISABLED",oee="ACCOUNT_UNAVAILABLE";/*! @azure/msal-browser v4.5.0 2025-02-26 */const lee=-2147186943,cee={[AO]:"User attempted to switch accounts in the native broker, which is not allowed. All new accounts must sign-in through the standard web flow first, please try again."};class tc extends zi{constructor(e,t,i){super(e,t),Object.setPrototypeOf(this,tc.prototype),this.name="NativeAuthError",this.ext=i}}function zf(n){if(n.ext&&n.ext.status&&(n.ext.status===ree||n.ext.status===aee)||n.ext&&n.ext.error&&n.ext.error===lee)return!0;switch(n.errorCode){case tee:return!0;default:return!1}}function $6(n,e,t){if(t&&t.status)switch(t.status){case oee:return G6(TN);case nee:return new hl(n,e);case iee:return Bt(of);case see:return Bt(a5)}return new tc(n,cee[n]||e,t)}/*! @azure/msal-browser v4.5.0 2025-02-26 */class SO extends rm{async acquireToken(e){this.performanceClient.addQueueMeasurement(Ee.SilentCacheClientAcquireToken,e.correlationId);const t=this.initializeServerTelemetryManager(Ti.acquireTokenSilent_silentFlow),i=await dt(this.getClientConfiguration.bind(this),Ee.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:t,requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,account:e.account}),s=new VQ(i,this.performanceClient);this.logger.verbose("Silent auth client created");try{const a=(await dt(s.acquireCachedToken.bind(s),Ee.SilentFlowClientAcquireCachedToken,this.logger,this.performanceClient,e.correlationId)(e))[0];return this.performanceClient.addFields({fromCache:!0},e.correlationId),a}catch(r){throw r instanceof Rx&&r.errorCode===D_&&this.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),r}}logout(e){this.logger.verbose("logoutRedirect called");const t=this.initializeLogoutRequest(e);return this.clearCacheOnLogout(t==null?void 0:t.account)}}/*! @azure/msal-browser v4.5.0 2025-02-26 */class g1 extends kO{constructor(e,t,i,s,r,a,o,l,c,h,u,d){var g;super(e,t,i,s,r,a,l,c,d),this.apiId=o,this.accountId=h,this.nativeMessageHandler=c,this.nativeStorageManager=u,this.silentCacheClient=new SO(e,this.nativeStorageManager,i,s,r,a,l,c,d);const f=this.nativeMessageHandler.getExtensionId()===Wf.PREFERRED_EXTENSION_ID?"chrome":(g=this.nativeMessageHandler.getExtensionId())!=null&&g.length?"unknown":void 0;this.skus=c2.makeExtraSkuString({libraryName:Ka.MSAL_SKU,libraryVersion:Ny,extensionName:f,extensionVersion:this.nativeMessageHandler.getExtensionVersion()})}addRequestSKUs(e){e.extraParameters={...e.extraParameters,[SQ]:this.skus}}async acquireToken(e){this.performanceClient.addQueueMeasurement(Ee.NativeInteractionClientAcquireToken,e.correlationId),this.logger.trace("NativeInteractionClient - acquireToken called.");const t=this.performanceClient.startMeasurement(Ee.NativeInteractionClientAcquireToken,e.correlationId),i=dc(),s=this.initializeServerTelemetryManager(this.apiId);try{const r=await this.initializeNativeRequest(e);try{const h=await this.acquireTokensFromCache(this.accountId,r);return t.end({success:!0,isNativeBroker:!1,fromCache:!0}),h}catch{this.logger.info("MSAL internal Cache does not contain tokens, proceed to make a native call")}const{...a}=r,o={method:Eu.GetToken,request:a},l=await this.nativeMessageHandler.sendMessage(o),c=this.validateNativeResponse(l);return await this.handleNativeResponse(c,r,i).then(h=>(t.end({success:!0,isNativeBroker:!0,requestId:h.requestId}),s.clearNativeBrokerErrorCode(),h)).catch(h=>{throw t.end({success:!1,errorCode:h.errorCode,subErrorCode:h.subError,isNativeBroker:!0}),h})}catch(r){throw r instanceof tc&&s.setNativeBrokerErrorCode(r.errorCode),r}}createSilentCacheRequest(e,t){return{authority:e.authority,correlationId:this.correlationId,scopes:cs.fromString(e.scope).asArray(),account:t,forceRefresh:!1}}async acquireTokensFromCache(e,t){if(!e)throw this.logger.warning("NativeInteractionClient:acquireTokensFromCache - No nativeAccountId provided"),ut(F6);const i=this.browserStorage.getBaseAccountInfo({nativeAccountId:e});if(!i)throw ut(F6);try{const s=this.createSilentCacheRequest(t,i),r=await this.silentCacheClient.acquireToken(s),a={...i,idTokenClaims:r==null?void 0:r.idTokenClaims,idToken:r==null?void 0:r.idToken};return{...r,account:a}}catch(s){throw s}}async acquireTokenRedirect(e,t){this.logger.trace("NativeInteractionClient - acquireTokenRedirect called.");const{...i}=e;delete i.onRedirectNavigate;const s=await this.initializeNativeRequest(i),r={method:Eu.GetToken,request:s};try{const l=await this.nativeMessageHandler.sendMessage(r);this.validateNativeResponse(l)}catch(l){if(l instanceof tc&&(this.initializeServerTelemetryManager(this.apiId).setNativeBrokerErrorCode(l.errorCode),zf(l)))throw l}this.browserStorage.setTemporaryCache(ui.NATIVE_REQUEST,JSON.stringify(s),!0);const a={apiId:Ti.acquireTokenRedirect,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},o=this.config.auth.navigateToLoginRequestUrl?window.location.href:this.getRedirectUri(e.redirectUri);t.end({success:!0}),await this.navigationClient.navigateExternal(o,a)}async handleRedirectPromise(e,t){if(this.logger.trace("NativeInteractionClient - handleRedirectPromise called."),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;const i=this.browserStorage.getCachedNativeRequest();if(!i)return this.logger.verbose("NativeInteractionClient - handleRedirectPromise called but there is no cached request, returning null."),e&&t&&(e==null||e.addFields({errorCode:"no_cached_request"},t)),null;const{prompt:s,...r}=i;s&&this.logger.verbose("NativeInteractionClient - handleRedirectPromise called and prompt was included in the original request, removing prompt from cached request to prevent second interaction with native broker window."),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(ui.NATIVE_REQUEST));const a={method:Eu.GetToken,request:r},o=dc();try{this.logger.verbose("NativeInteractionClient - handleRedirectPromise sending message to native broker.");const l=await this.nativeMessageHandler.sendMessage(a);this.validateNativeResponse(l);const c=this.handleNativeResponse(l,r,o);this.browserStorage.setInteractionInProgress(!1);const h=await c;return this.initializeServerTelemetryManager(this.apiId).clearNativeBrokerErrorCode(),h}catch(l){throw this.browserStorage.setInteractionInProgress(!1),l}}logout(){return this.logger.trace("NativeInteractionClient - logout called."),Promise.reject("Logout not implemented yet")}async handleNativeResponse(e,t,i){var h;this.logger.trace("NativeInteractionClient - handleNativeResponse called.");const s=sm(e.id_token,b0),r=this.createHomeAccountIdentifier(e,s),a=(h=this.browserStorage.getAccountInfoFilteredBy({nativeAccountId:t.accountId}))==null?void 0:h.homeAccountId;if(r!==a&&e.account.id!==t.accountId)throw $6(AO);const o=await this.getDiscoveredAuthority({requestAuthority:t.authority}),l=T_(this.browserStorage,o,r,b0,s,e.client_info,void 0,s.tid,void 0,e.account.id,this.logger),c=await this.generateAuthenticationResult(e,t,s,l,o.canonicalAuthority,i);return await this.cacheAccount(l),await this.cacheNativeTokens(e,t,r,s,e.access_token,c.tenantId,i),c}createHomeAccountIdentifier(e,t){return $r.generateHomeAccountId(e.client_info||Ge.EMPTY_STRING,Zo.Default,this.logger,this.browserCrypto,t)}generateScopes(e,t){return e.scope?cs.fromString(e.scope):cs.fromString(t.scope)}async generatePopAccessToken(e,t){if(t.tokenType===pi.POP&&t.signPopToken){if(e.shr)return this.logger.trace("handleNativeServerResponse: SHR is enabled in native layer"),e.shr;const i=new Vg(this.browserCrypto),s={resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,shrNonce:t.shrNonce};if(!t.keyId)throw ut(f_);return i.signPopToken(e.access_token,t.keyId,s)}else return e.access_token}async generateAuthenticationResult(e,t,i,s,r,a){const o=this.addTelemetryFromNativeResponse(e),l=e.scope?cs.fromString(e.scope):cs.fromString(t.scope),c=e.account.properties||{},h=c.UID||i.oid||i.sub||Ge.EMPTY_STRING,u=c.TenantId||i.tid||Ge.EMPTY_STRING,d=k_(s.getAccountInfo(),void 0,i,e.id_token);d.nativeAccountId!==e.account.id&&(d.nativeAccountId=e.account.id);const f=await this.generatePopAccessToken(e,t),g=t.tokenType===pi.POP?pi.POP:pi.BEARER;return{authority:r,uniqueId:h,tenantId:u,scopes:l.asArray(),account:d,idToken:e.id_token,idTokenClaims:i,accessToken:f,fromCache:o?this.isResponseFromCache(o):!1,expiresOn:new Date(Number(a+e.expires_in)*1e3),tokenType:g,correlationId:this.correlationId,state:e.state,fromNativeBroker:!0}}async cacheAccount(e){await this.browserStorage.setAccount(e,this.correlationId),this.browserStorage.removeAccountContext(e).catch(t=>{this.logger.error(`Error occurred while removing account context from browser storage. ${t}`)})}cacheNativeTokens(e,t,i,s,r,a,o){const l=ky(i,t.authority,e.id_token||"",t.clientId,s.tid||""),c=t.tokenType===pi.POP?Ge.SHR_NONCE_VALIDITY:(typeof e.expires_in=="string"?parseInt(e.expires_in,10):e.expires_in)||0,h=o+c,u=this.generateScopes(e,t),d=Cy(i,t.authority,r,t.clientId,s.tid||a,u.printScopes(),h,0,b0,void 0,t.tokenType,void 0,t.keyId),f={idToken:l,accessToken:d};return this.nativeStorageManager.saveCacheRecord(f,this.correlationId,t.storeInCache)}addTelemetryFromNativeResponse(e){const t=this.getMATSFromResponse(e);return t?(this.performanceClient.addFields({extensionId:this.nativeMessageHandler.getExtensionId(),extensionVersion:this.nativeMessageHandler.getExtensionVersion(),matsBrokerVersion:t.broker_version,matsAccountJoinOnStart:t.account_join_on_start,matsAccountJoinOnEnd:t.account_join_on_end,matsDeviceJoin:t.device_join,matsPromptBehavior:t.prompt_behavior,matsApiErrorCode:t.api_error_code,matsUiVisible:t.ui_visible,matsSilentCode:t.silent_code,matsSilentBiSubCode:t.silent_bi_sub_code,matsSilentMessage:t.silent_message,matsSilentStatus:t.silent_status,matsHttpStatus:t.http_status,matsHttpEventCount:t.http_event_count},this.correlationId),t):null}validateNativeResponse(e){if(e.hasOwnProperty("access_token")&&e.hasOwnProperty("id_token")&&e.hasOwnProperty("client_info")&&e.hasOwnProperty("account")&&e.hasOwnProperty("scope")&&e.hasOwnProperty("expires_in"))return e;throw UP(o_,"Response missing expected properties.")}getMATSFromResponse(e){if(e.properties.MATS)try{return JSON.parse(e.properties.MATS)}catch{this.logger.error("NativeInteractionClient - Error parsing MATS telemetry, returning null instead")}return null}isResponseFromCache(e){return typeof e.is_cached>"u"?(this.logger.verbose("NativeInteractionClient - MATS telemetry does not contain field indicating if response was served from cache. Returning false."),!1):!!e.is_cached}async initializeNativeRequest(e){this.logger.trace("NativeInteractionClient - initializeNativeRequest called");const t=e.authority||this.config.auth.authority;e.account&&await this.getDiscoveredAuthority({requestAuthority:t,requestAzureCloudOptions:e.azureCloudOptions,account:e.account});const i=new Zn(t);i.validateAsUri();const{scopes:s,...r}=e,a=new cs(s||[]);a.appendScopes(Ix);const o=()=>{switch(this.apiId){case Ti.ssoSilent:case Ti.acquireTokenSilent_silentFlow:return this.logger.trace("initializeNativeRequest: silent request sets prompt to none"),Vs.NONE}if(!e.prompt){this.logger.trace("initializeNativeRequest: prompt was not provided");return}switch(e.prompt){case Vs.NONE:case Vs.CONSENT:case Vs.LOGIN:return this.logger.trace("initializeNativeRequest: prompt is compatible with native flow"),e.prompt;default:throw this.logger.trace(`initializeNativeRequest: prompt = ${e.prompt} is not compatible with native flow`),Bt(sO)}},l={...r,accountId:this.accountId,clientId:this.config.auth.clientId,authority:i.urlString,scope:a.printScopes(),redirectUri:this.getRedirectUri(e.redirectUri),prompt:o(),correlationId:this.correlationId,tokenType:e.authenticationScheme,windowTitleSubstring:document.title,extraParameters:{...e.extraQueryParameters,...e.tokenQueryParameters},extendedExpiryToken:!1,keyId:e.popKid};if(l.signPopToken&&e.popKid)throw Bt(aO);if(this.handleExtraBrokerParams(l),l.extraParameters=l.extraParameters||{},l.extraParameters.telemetry=Wf.MATS_TELEMETRY,e.authenticationScheme===pi.POP){const c={resourceRequestUri:e.resourceRequestUri,resourceRequestMethod:e.resourceRequestMethod,shrClaims:e.shrClaims,shrNonce:e.shrNonce},h=new Vg(this.browserCrypto);let u;if(l.keyId)u=this.browserCrypto.base64UrlEncode(JSON.stringify({kid:l.keyId})),l.signPopToken=!1;else{const d=await dt(h.generateCnf.bind(h),Ee.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(c,this.logger);u=d.reqCnfString,l.keyId=d.kid,l.signPopToken=!0}l.reqCnf=u}return this.addRequestSKUs(l),l}handleExtraBrokerParams(e){var r;const t=e.extraParameters&&e.extraParameters.hasOwnProperty(S_)&&e.extraParameters.hasOwnProperty(j6)&&e.extraParameters.hasOwnProperty(rf);if(!e.embeddedClientId&&!t)return;let i="";const s=e.redirectUri;e.embeddedClientId?(e.redirectUri=this.config.auth.redirectUri,i=e.embeddedClientId):e.extraParameters&&(e.redirectUri=e.extraParameters[j6],i=e.extraParameters[rf]),e.extraParameters={child_client_id:i,child_redirect_uri:s},(r=this.performanceClient)==null||r.addFields({embeddedClientId:i,embeddedRedirectUri:s},e.correlationId)}}/*! @azure/msal-browser v4.5.0 2025-02-26 */class nc{constructor(e,t,i,s){this.logger=e,this.handshakeTimeoutMs=t,this.extensionId=s,this.resolvers=new Map,this.handshakeResolvers=new Map,this.messageChannel=new MessageChannel,this.windowListener=this.onWindowMessage.bind(this),this.performanceClient=i,this.handshakeEvent=i.startMeasurement(Ee.NativeMessageHandlerHandshake)}async sendMessage(e){this.logger.trace("NativeMessageHandler - sendMessage called.");const t={channel:Wf.CHANNEL_ID,extensionId:this.extensionId,responseId:ul(),body:e};return this.logger.trace("NativeMessageHandler - Sending request to browser extension"),this.logger.tracePii(`NativeMessageHandler - Sending request to browser extension: ${JSON.stringify(t)}`),this.messageChannel.port1.postMessage(t),new Promise((i,s)=>{this.resolvers.set(t.responseId,{resolve:i,reject:s})})}static async createProvider(e,t,i){e.trace("NativeMessageHandler - createProvider called.");try{const s=new nc(e,t,i,Wf.PREFERRED_EXTENSION_ID);return await s.sendHandshakeRequest(),s}catch{const r=new nc(e,t,i);return await r.sendHandshakeRequest(),r}}async sendHandshakeRequest(){this.logger.trace("NativeMessageHandler - sendHandshakeRequest called."),window.addEventListener("message",this.windowListener,!1);const e={channel:Wf.CHANNEL_ID,extensionId:this.extensionId,responseId:ul(),body:{method:Eu.HandshakeRequest}};return this.handshakeEvent.add({extensionId:this.extensionId,extensionHandshakeTimeoutMs:this.handshakeTimeoutMs}),this.messageChannel.port1.onmessage=t=>{this.onChannelMessage(t)},window.postMessage(e,window.origin,[this.messageChannel.port2]),new Promise((t,i)=>{this.handshakeResolvers.set(e.responseId,{resolve:t,reject:i}),this.timeoutId=window.setTimeout(()=>{window.removeEventListener("message",this.windowListener,!1),this.messageChannel.port1.close(),this.messageChannel.port2.close(),this.handshakeEvent.end({extensionHandshakeTimedOut:!0,success:!1}),i(Bt(nO)),this.handshakeResolvers.delete(e.responseId)},this.handshakeTimeoutMs)})}onWindowMessage(e){if(this.logger.trace("NativeMessageHandler - onWindowMessage called"),e.source!==window)return;const t=e.data;if(!(!t.channel||t.channel!==Wf.CHANNEL_ID)&&!(t.extensionId&&t.extensionId!==this.extensionId)&&t.body.method===Eu.HandshakeRequest){const i=this.handshakeResolvers.get(t.responseId);if(!i){this.logger.trace(`NativeMessageHandler.onWindowMessage - resolver can't be found for request ${t.responseId}`);return}this.logger.verbose(t.extensionId?`Extension with id: ${t.extensionId} not installed`:"No extension installed"),clearTimeout(this.timeoutId),this.messageChannel.port1.close(),this.messageChannel.port2.close(),window.removeEventListener("message",this.windowListener,!1),this.handshakeEvent.end({success:!1,extensionInstalled:!1}),i.reject(Bt(iO))}}onChannelMessage(e){this.logger.trace("NativeMessageHandler - onChannelMessage called.");const t=e.data,i=this.resolvers.get(t.responseId),s=this.handshakeResolvers.get(t.responseId);try{const r=t.body.method;if(r===Eu.Response){if(!i)return;const a=t.body.response;if(this.logger.trace("NativeMessageHandler - Received response from browser extension"),this.logger.tracePii(`NativeMessageHandler - Received response from browser extension: ${JSON.stringify(a)}`),a.status!=="Success")i.reject($6(a.code,a.description,a.ext));else if(a.result)a.result.code&&a.result.description?i.reject($6(a.result.code,a.result.description,a.result.ext)):i.resolve(a.result);else throw UP(o_,"Event does not contain result.");this.resolvers.delete(t.responseId)}else if(r===Eu.HandshakeResponse){if(!s){this.logger.trace(`NativeMessageHandler.onChannelMessage - resolver can't be found for request ${t.responseId}`);return}clearTimeout(this.timeoutId),window.removeEventListener("message",this.windowListener,!1),this.extensionId=t.extensionId,this.extensionVersion=t.body.version,this.logger.verbose(`NativeMessageHandler - Received HandshakeResponse from extension: ${this.extensionId}`),this.handshakeEvent.end({extensionInstalled:!0,success:!0}),s.resolve(),this.handshakeResolvers.delete(t.responseId)}}catch(r){this.logger.error("Error parsing response from WAM Extension"),this.logger.errorPii(`Error parsing response from WAM Extension: ${r}`),this.logger.errorPii(`Unable to parse ${e}`),i?i.reject(r):s&&s.reject(r)}}getExtensionId(){return this.extensionId}getExtensionVersion(){return this.extensionVersion}static isPlatformBrokerAvailable(e,t,i,s){if(t.trace("isPlatformBrokerAvailable called"),!e.system.allowPlatformBroker)return t.trace("isPlatformBrokerAvailable: allowPlatformBroker is not enabled, returning false"),!1;if(!i)return t.trace("isPlatformBrokerAvailable: Platform extension provider is not initialized, returning false"),!1;if(s)switch(s){case pi.BEARER:case pi.POP:return t.trace("isPlatformBrokerAvailable: authenticationScheme is supported, returning true"),!0;default:return t.trace("isPlatformBrokerAvailable: authenticationScheme is not supported, returning false"),!1}return!0}}/*! @azure/msal-browser v4.5.0 2025-02-26 */class W_{constructor(e,t,i,s,r){this.authModule=e,this.browserStorage=t,this.authCodeRequest=i,this.logger=s,this.performanceClient=r}async handleCodeResponse(e,t){this.performanceClient.addQueueMeasurement(Ee.HandleCodeResponse,t.correlationId);let i;try{i=this.authModule.handleFragmentResponse(e,t.state)}catch(s){throw s instanceof Yh&&s.subError===of?Bt(of):s}return dt(this.handleCodeResponseFromServer.bind(this),Ee.HandleCodeResponseFromServer,this.logger,this.performanceClient,t.correlationId)(i,t)}async handleCodeResponseFromServer(e,t,i=!0){if(this.performanceClient.addQueueMeasurement(Ee.HandleCodeResponseFromServer,t.correlationId),this.logger.trace("InteractionHandler.handleCodeResponseFromServer called"),this.authCodeRequest.code=e.code,e.cloud_instance_host_name&&await dt(this.authModule.updateAuthority.bind(this.authModule),Ee.UpdateTokenEndpointAuthority,this.logger,this.performanceClient,t.correlationId)(e.cloud_instance_host_name,t.correlationId),i&&(e.nonce=t.nonce||void 0),e.state=t.state,e.client_info)this.authCodeRequest.clientInfo=e.client_info;else{const r=this.createCcsCredentials(t);r&&(this.authCodeRequest.ccsCredential=r)}return await dt(this.authModule.acquireToken.bind(this.authModule),Ee.AuthClientAcquireToken,this.logger,this.performanceClient,t.correlationId)(this.authCodeRequest,e)}createCcsCredentials(e){return e.account?{credential:e.account.homeAccountId,type:Ja.HOME_ACCOUNT_ID}:e.loginHint?{credential:e.loginHint,type:Ja.UPN}:null}}/*! @azure/msal-browser v4.5.0 2025-02-26 */function IO(n,e,t){const i=i5(n);if(!i)throw _N(n)?(t.error(`A ${e} is present in the iframe but it does not contain known properties. It's likely that the ${e} has been replaced by code running on the redirectUri page.`),t.errorPii(`The ${e} detected is: ${n}`),Bt(FN)):(t.error(`The request has returned to the redirectUri but a ${e} is not present. It's likely that the ${e} has been removed or the page has been redirected by code running on the redirectUri page.`),Bt(DN));return i}function hee(n,e,t){if(!n.state)throw Bt(N_);const i=vO(e,n.state);if(!i)throw Bt(LN);if(i.interactionType!==t)throw Bt(BN)}/*! @azure/msal-browser v4.5.0 2025-02-26 */class uee extends rm{constructor(e,t,i,s,r,a,o,l,c,h){super(e,t,i,s,r,a,o,c,h),this.unloadWindow=this.unloadWindow.bind(this),this.nativeStorage=l}acquireToken(e,t){try{const s={popupName:this.generatePopupName(e.scopes||Ix,e.authority||this.config.auth.authority),popupWindowAttributes:e.popupWindowAttributes||{},popupWindowParent:e.popupWindowParent??window};return this.performanceClient.addFields({isAsyncPopup:this.config.system.asyncPopups},this.correlationId),this.config.system.asyncPopups?(this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(e,s,t)):(this.logger.verbose("asyncPopup set to false, opening popup before acquiring token"),s.popup=this.openSizedPopup("about:blank",s),this.acquireTokenPopupAsync(e,s,t))}catch(i){return Promise.reject(i)}}logout(e){try{this.logger.verbose("logoutPopup called");const t=this.initializeLogoutRequest(e),i={popupName:this.generateLogoutPopupName(t),popupWindowAttributes:(e==null?void 0:e.popupWindowAttributes)||{},popupWindowParent:(e==null?void 0:e.popupWindowParent)??window},s=e&&e.authority,r=e&&e.mainWindowRedirectUri;return this.config.system.asyncPopups?(this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(t,i,s,r)):(this.logger.verbose("asyncPopup set to false, opening popup"),i.popup=this.openSizedPopup("about:blank",i),this.logoutPopupAsync(t,i,s,r))}catch(t){return Promise.reject(t)}}async acquireTokenPopupAsync(e,t,i){var a;this.logger.verbose("acquireTokenPopupAsync called");const s=this.initializeServerTelemetryManager(Ti.acquireTokenPopup),r=await dt(this.initializeAuthorizationRequest.bind(this),Ee.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,this.correlationId)(e,an.Popup);t.popup&&wO(r.authority);try{const o=await dt(this.initializeAuthorizationCodeRequest.bind(this),Ee.StandardInteractionClientInitializeAuthorizationCodeRequest,this.logger,this.performanceClient,this.correlationId)(r,i),l=await dt(this.createAuthCodeClient.bind(this),Ee.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:s,requestAuthority:r.authority,requestAzureCloudOptions:r.azureCloudOptions,requestExtraQueryParameters:r.extraQueryParameters,account:r.account}),c=nc.isPlatformBrokerAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme);let h;c&&(h=this.performanceClient.startMeasurement(Ee.FetchAccountIdWithNativeBroker,e.correlationId));const u=await l.getAuthCodeUrl({...r,platformBroker:c}),d=new W_(l,this.browserStorage,o,this.logger,this.performanceClient),f=this.initiateAuthRequest(u,t);this.eventHandler.emitEvent(ln.POPUP_OPENED,an.Popup,{popupWindow:f},null);const g=await this.monitorPopupForHash(f,t.popupWindowParent),m=I0(IO,Ee.DeserializeResponse,this.logger,this.performanceClient,this.correlationId)(g,this.config.auth.OIDCOptions.serverResponseType,this.logger);if(ec.removeThrottle(this.browserStorage,this.config.auth.clientId,o),m.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),h&&h.end({success:!0,isNativeBroker:!0}),!this.nativeMessageHandler)throw Bt(Tx);const p=new g1(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Ti.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,m.accountId,this.nativeStorage,r.correlationId),{userRequestState:y}=ol.parseRequestState(this.browserCrypto,r.state);return await p.acquireToken({...r,state:y,prompt:void 0})}return await d.handleCodeResponse(m,r)}catch(o){throw(a=t.popup)==null||a.close(),o instanceof zi&&(o.setCorrelationId(this.correlationId),s.cacheFailedRequest(o)),o}}async logoutPopupAsync(e,t,i,s){var a,o,l,c;this.logger.verbose("logoutPopupAsync called"),this.eventHandler.emitEvent(ln.LOGOUT_START,an.Popup,e);const r=this.initializeServerTelemetryManager(Ti.logoutPopup);try{await this.clearCacheOnLogout(e.account);const h=await dt(this.createAuthCodeClient.bind(this),Ee.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:r,requestAuthority:i,account:e.account||void 0});try{h.authority.endSessionEndpoint}catch{if((a=e.account)!=null&&a.homeAccountId&&e.postLogoutRedirectUri&&h.authority.protocolMode===p0.OIDC){if(this.browserStorage.removeAccount((o=e.account)==null?void 0:o.homeAccountId),this.eventHandler.emitEvent(ln.LOGOUT_SUCCESS,an.Popup,e),s){const f={apiId:Ti.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},g=Zn.getAbsoluteUrl(s,c0());await this.navigationClient.navigateInternal(g,f)}(l=t.popup)==null||l.close();return}}const u=h.getLogoutUri(e);this.eventHandler.emitEvent(ln.LOGOUT_SUCCESS,an.Popup,e);const d=this.openPopup(u,t);if(this.eventHandler.emitEvent(ln.POPUP_OPENED,an.Popup,{popupWindow:d},null),await this.monitorPopupForHash(d,t.popupWindowParent).catch(()=>{}),s){const f={apiId:Ti.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},g=Zn.getAbsoluteUrl(s,c0());this.logger.verbose("Redirecting main window to url specified in the request"),this.logger.verbosePii(`Redirecting main window to: ${g}`),await this.navigationClient.navigateInternal(g,f)}else this.logger.verbose("No main window navigation requested")}catch(h){throw(c=t.popup)==null||c.close(),h instanceof zi&&(h.setCorrelationId(this.correlationId),r.cacheFailedRequest(h)),this.browserStorage.setInteractionInProgress(!1),this.eventHandler.emitEvent(ln.LOGOUT_FAILURE,an.Popup,null,h),this.eventHandler.emitEvent(ln.LOGOUT_END,an.Popup),h}this.eventHandler.emitEvent(ln.LOGOUT_END,an.Popup)}initiateAuthRequest(e,t){if(e)return this.logger.infoPii(`Navigate to: ${e}`),this.openPopup(e,t);throw this.logger.error("Navigate url is empty"),Bt(Ty)}monitorPopupForHash(e,t){return new Promise((i,s)=>{this.logger.verbose("PopupHandler.monitorPopupForHash - polling started");const r=setInterval(()=>{if(e.closed){this.logger.error("PopupHandler.monitorPopupForHash - window closed"),clearInterval(r),s(Bt(of));return}let a="";try{a=e.location.href}catch{}if(!a||a==="about:blank")return;clearInterval(r);let o="";const l=this.config.auth.OIDCOptions.serverResponseType;e&&(l===Ex.QUERY?o=e.location.search:o=e.location.hash),this.logger.verbose("PopupHandler.monitorPopupForHash - popup window is on same origin as caller"),i(o)},this.config.system.pollIntervalMilliseconds)}).finally(()=>{this.cleanPopup(e,t)})}openPopup(e,t){try{let i;if(t.popup?(i=t.popup,this.logger.verbosePii(`Navigating popup window to: ${e}`),i.location.assign(e)):typeof t.popup>"u"&&(this.logger.verbosePii(`Opening popup window to: ${e}`),i=this.openSizedPopup(e,t)),!i)throw Bt(zN);return i.focus&&i.focus(),this.currentWindow=i,t.popupWindowParent.addEventListener("beforeunload",this.unloadWindow),i}catch(i){throw this.logger.error("error opening popup "+i.message),this.browserStorage.setInteractionInProgress(!1),Bt(HN)}}openSizedPopup(e,{popupName:t,popupWindowAttributes:i,popupWindowParent:s}){var f,g,m,b;const r=s.screenLeft?s.screenLeft:s.screenX,a=s.screenTop?s.screenTop:s.screenY,o=s.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,l=s.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;let c=(f=i.popupSize)==null?void 0:f.width,h=(g=i.popupSize)==null?void 0:g.height,u=(m=i.popupPosition)==null?void 0:m.top,d=(b=i.popupPosition)==null?void 0:b.left;return(!c||c<0||c>o)&&(this.logger.verbose("Default popup window width used. Window width not configured or invalid."),c=Ka.POPUP_WIDTH),(!h||h<0||h>l)&&(this.logger.verbose("Default popup window height used. Window height not configured or invalid."),h=Ka.POPUP_HEIGHT),(!u||u<0||u>l)&&(this.logger.verbose("Default popup window top position used. Window top not configured or invalid."),u=Math.max(0,l/2-Ka.POPUP_HEIGHT/2+a)),(!d||d<0||d>o)&&(this.logger.verbose("Default popup window left position used. Window left not configured or invalid."),d=Math.max(0,o/2-Ka.POPUP_WIDTH/2+r)),s.open(e,t,`width=${c}, height=${h}, top=${u}, left=${d}, scrollbars=yes`)}unloadWindow(e){this.browserStorage.cleanRequestByInteractionType(an.Popup),this.currentWindow&&this.currentWindow.close(),e.preventDefault()}cleanPopup(e,t){e.close(),t.removeEventListener("beforeunload",this.unloadWindow),this.browserStorage.setInteractionInProgress(!1)}generatePopupName(e,t){return`${Ka.POPUP_NAME_PREFIX}.${this.config.auth.clientId}.${e.join("-")}.${t}.${this.correlationId}`}generateLogoutPopupName(e){const t=e.account&&e.account.homeAccountId;return`${Ka.POPUP_NAME_PREFIX}.${this.config.auth.clientId}.${t}.${this.correlationId}`}}/*! @azure/msal-browser v4.5.0 2025-02-26 */class cA{constructor(e,t,i,s,r){this.authModule=e,this.browserStorage=t,this.authCodeRequest=i,this.logger=s,this.performanceClient=r}async initiateAuthRequest(e,t){if(this.logger.verbose("RedirectHandler.initiateAuthRequest called"),e){t.redirectStartPage&&(this.logger.verbose("RedirectHandler.initiateAuthRequest: redirectStartPage set, caching start page"),this.browserStorage.setTemporaryCache(ui.ORIGIN_URI,t.redirectStartPage,!0)),this.browserStorage.setTemporaryCache(ui.CORRELATION_ID,this.authCodeRequest.correlationId,!0),this.browserStorage.cacheCodeRequest(this.authCodeRequest),this.logger.infoPii(`RedirectHandler.initiateAuthRequest: Navigate to: ${e}`);const i={apiId:Ti.acquireTokenRedirect,timeout:t.redirectTimeout,noHistory:!1};if(typeof t.onRedirectNavigate=="function")if(this.logger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback"),t.onRedirectNavigate(e)!==!1){this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),await t.navigationClient.navigateExternal(e,i);return}else{this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation");return}else{this.logger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),await t.navigationClient.navigateExternal(e,i);return}}else throw this.logger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),Bt(Ty)}async handleCodeResponse(e,t){this.logger.verbose("RedirectHandler.handleCodeResponse called"),this.browserStorage.setInteractionInProgress(!1);const i=this.browserStorage.generateStateKey(t),s=this.browserStorage.getTemporaryCache(i);if(!s)throw ut(e5,"Cached State");let r;try{r=this.authModule.handleFragmentResponse(e,s)}catch(c){throw c instanceof Yh&&c.subError===of?Bt(of):c}const a=this.browserStorage.generateNonceKey(s),o=this.browserStorage.getTemporaryCache(a);if(this.authCodeRequest.code=r.code,r.cloud_instance_host_name&&await dt(this.authModule.updateAuthority.bind(this.authModule),Ee.UpdateTokenEndpointAuthority,this.logger,this.performanceClient,this.authCodeRequest.correlationId)(r.cloud_instance_host_name,this.authCodeRequest.correlationId),r.nonce=o||void 0,r.state=s,r.client_info)this.authCodeRequest.clientInfo=r.client_info;else{const c=this.checkCcsCredentials();c&&(this.authCodeRequest.ccsCredential=c)}const l=await this.authModule.acquireToken(this.authCodeRequest,r);return this.browserStorage.cleanRequestByState(t),l}checkCcsCredentials(){const e=this.browserStorage.getTemporaryCache(ui.CCS_CREDENTIAL,!0);if(e)try{return JSON.parse(e)}catch{this.authModule.logger.error("Cache credential could not be parsed"),this.authModule.logger.errorPii(`Cache credential could not be parsed: ${e}`)}return null}}/*! @azure/msal-browser v4.5.0 2025-02-26 */function dee(){if(typeof window>"u"||typeof window.performance>"u"||typeof window.performance.getEntriesByType!="function")return;const n=window.performance.getEntriesByType("navigation"),e=n.length?n[0]:void 0;return e==null?void 0:e.type}class fee extends rm{constructor(e,t,i,s,r,a,o,l,c,h){super(e,t,i,s,r,a,o,c,h),this.nativeStorage=l}async acquireToken(e){const t=await dt(this.initializeAuthorizationRequest.bind(this),Ee.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,this.correlationId)(e,an.Redirect);this.browserStorage.updateCacheEntries(t.state,t.nonce,t.authority,t.loginHint||"",t.account||null);const i=this.initializeServerTelemetryManager(Ti.acquireTokenRedirect),s=r=>{r.persisted&&(this.logger.verbose("Page was restored from back/forward cache. Clearing temporary cache."),this.browserStorage.cleanRequestByState(t.state),this.eventHandler.emitEvent(ln.RESTORE_FROM_BFCACHE,an.Redirect))};try{const r=await dt(this.initializeAuthorizationCodeRequest.bind(this),Ee.StandardInteractionClientInitializeAuthorizationCodeRequest,this.logger,this.performanceClient,this.correlationId)(t),a=await dt(this.createAuthCodeClient.bind(this),Ee.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:i,requestAuthority:t.authority,requestAzureCloudOptions:t.azureCloudOptions,requestExtraQueryParameters:t.extraQueryParameters,account:t.account}),o=new cA(a,this.browserStorage,r,this.logger,this.performanceClient),l=await a.getAuthCodeUrl({...t,platformBroker:nc.isPlatformBrokerAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme)}),c=this.getRedirectStartPage(e.redirectStartPage);return this.logger.verbosePii(`Redirect start page: ${c}`),window.addEventListener("pageshow",s),await o.initiateAuthRequest(l,{navigationClient:this.navigationClient,redirectTimeout:this.config.system.redirectNavigationTimeout,redirectStartPage:c,onRedirectNavigate:e.onRedirectNavigate||this.config.auth.onRedirectNavigate})}catch(r){throw r instanceof zi&&(r.setCorrelationId(this.correlationId),i.cacheFailedRequest(r)),window.removeEventListener("pageshow",s),this.browserStorage.cleanRequestByState(t.state),r}}async handleRedirectPromise(e="",t){const i=this.initializeServerTelemetryManager(Ti.handleRedirectPromise);try{if(!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;const[s,r]=this.getRedirectResponse(e||"");if(!s)return this.logger.info("handleRedirectPromise did not detect a response as a result of a redirect. Cleaning temporary cache."),this.browserStorage.cleanRequestByInteractionType(an.Redirect),dee()!=="back_forward"?t.event.errorCode="no_server_response":this.logger.verbose("Back navigation event detected. Muting no_server_response error"),null;const a=this.browserStorage.getTemporaryCache(ui.ORIGIN_URI,!0)||Ge.EMPTY_STRING,o=Zn.removeHashFromUrl(a),l=Zn.removeHashFromUrl(window.location.href);if(o===l&&this.config.auth.navigateToLoginRequestUrl)return this.logger.verbose("Current page is loginRequestUrl, handling response"),a.indexOf("#")>-1&&_$(a),await this.handleResponse(s,i);if(this.config.auth.navigateToLoginRequestUrl){if(!j_()||this.config.system.allowRedirectInIframe){this.browserStorage.setTemporaryCache(ui.URL_HASH,r,!0);const c={apiId:Ti.handleRedirectPromise,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0};let h=!0;if(!a||a==="null"){const u=k$();this.browserStorage.setTemporaryCache(ui.ORIGIN_URI,u,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),h=await this.navigationClient.navigateInternal(u,c)}else this.logger.verbose(`Navigating to loginRequestUrl: ${a}`),h=await this.navigationClient.navigateInternal(a,c);if(!h)return await this.handleResponse(s,i)}}else return this.logger.verbose("NavigateToLoginRequestUrl set to false, handling response"),await this.handleResponse(s,i);return null}catch(s){throw s instanceof zi&&(s.setCorrelationId(this.correlationId),i.cacheFailedRequest(s)),this.browserStorage.cleanRequestByInteractionType(an.Redirect),s}}getRedirectResponse(e){this.logger.verbose("getRedirectResponseHash called");let t=e;t||(this.config.auth.OIDCOptions.serverResponseType===Ex.QUERY?t=window.location.search:t=window.location.hash);let i=i5(t);if(i){try{hee(i,this.browserCrypto,an.Redirect)}catch(r){return r instanceof zi&&this.logger.error(`Interaction type validation failed due to ${r.errorCode}: ${r.errorMessage}`),[null,""]}return w$(window),this.logger.verbose("Hash contains known properties, returning response hash"),[i,t]}const s=this.browserStorage.getTemporaryCache(ui.URL_HASH,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(ui.URL_HASH)),s&&(i=i5(s),i)?(this.logger.verbose("Hash does not contain known properties, returning cached hash"),[i,s]):[null,""]}async handleResponse(e,t){const i=e.state;if(!i)throw Bt(N_);const s=this.browserStorage.getCachedRequest(i);if(this.logger.verbose("handleResponse called, retrieved cached request"),e.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw Bt(Tx);const l=new g1(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Ti.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,e.accountId,this.nativeStorage,s.correlationId),{userRequestState:c}=ol.parseRequestState(this.browserCrypto,i);return l.acquireToken({...s,state:c,prompt:void 0}).finally(()=>{this.browserStorage.cleanRequestByState(i)})}const r=this.browserStorage.getCachedAuthority(i);if(!r)throw Bt(O_);const a=await dt(this.createAuthCodeClient.bind(this),Ee.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:t,requestAuthority:r});return ec.removeThrottle(this.browserStorage,this.config.auth.clientId,s),new cA(a,this.browserStorage,s,this.logger,this.performanceClient).handleCodeResponse(e,i)}async logout(e){var s,r;this.logger.verbose("logoutRedirect called");const t=this.initializeLogoutRequest(e),i=this.initializeServerTelemetryManager(Ti.logout);try{this.eventHandler.emitEvent(ln.LOGOUT_START,an.Redirect,e),await this.clearCacheOnLogout(t.account);const a={apiId:Ti.logout,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},o=await dt(this.createAuthCodeClient.bind(this),Ee.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:i,requestAuthority:e&&e.authority,requestExtraQueryParameters:e==null?void 0:e.extraQueryParameters,account:e&&e.account||void 0});if(o.authority.protocolMode===p0.OIDC)try{o.authority.endSessionEndpoint}catch{if((s=t.account)!=null&&s.homeAccountId){this.browserStorage.removeAccount((r=t.account)==null?void 0:r.homeAccountId),this.eventHandler.emitEvent(ln.LOGOUT_SUCCESS,an.Redirect,t);return}}const l=o.getLogoutUri(t);if(this.eventHandler.emitEvent(ln.LOGOUT_SUCCESS,an.Redirect,t),e&&typeof e.onRedirectNavigate=="function")if(e.onRedirectNavigate(l)!==!1){this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),await this.navigationClient.navigateExternal(l,a);return}else this.browserStorage.setInteractionInProgress(!1),this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation");else{this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),await this.navigationClient.navigateExternal(l,a);return}}catch(a){throw a instanceof zi&&(a.setCorrelationId(this.correlationId),i.cacheFailedRequest(a)),this.eventHandler.emitEvent(ln.LOGOUT_FAILURE,an.Redirect,null,a),this.eventHandler.emitEvent(ln.LOGOUT_END,an.Redirect),a}this.eventHandler.emitEvent(ln.LOGOUT_END,an.Redirect)}getRedirectStartPage(e){const t=e||window.location.href;return Zn.getAbsoluteUrl(t,c0())}}/*! @azure/msal-browser v4.5.0 2025-02-26 */async function gee(n,e,t,i,s){if(e.addQueueMeasurement(Ee.SilentHandlerInitiateAuthRequest,i),!n)throw t.info("Navigate url is empty"),Bt(Ty);return s?dt(pee,Ee.SilentHandlerLoadFrame,t,e,i)(n,s,e,i):I0(bee,Ee.SilentHandlerLoadFrameSync,t,e,i)(n)}async function mee(n,e,t,i,s,r,a){return i.addQueueMeasurement(Ee.SilentHandlerMonitorIframeForHash,r),new Promise((o,l)=>{e<X6&&s.warning(`system.loadFrameTimeout or system.iframeHashTimeout set to lower (${e}ms) than the default (${X6}ms). This may result in timeouts.`);const c=window.setTimeout(()=>{window.clearInterval(h),l(Bt(jN))},e),h=window.setInterval(()=>{let u="";const d=n.contentWindow;try{u=d?d.location.href:""}catch{}if(!u||u==="about:blank")return;let f="";d&&(a===Ex.QUERY?f=d.location.search:f=d.location.hash),window.clearTimeout(c),window.clearInterval(h),o(f)},t)}).finally(()=>{I0(xee,Ee.RemoveHiddenIframe,s,i,r)(n)})}function pee(n,e,t,i){return t.addQueueMeasurement(Ee.SilentHandlerLoadFrame,i),new Promise((s,r)=>{const a=EO();window.setTimeout(()=>{if(!a){r("Unable to load iframe");return}a.src=n,s(a)},e)})}function bee(n){const e=EO();return e.src=n,e}function EO(){const n=document.createElement("iframe");return n.className="msalSilentIframe",n.style.visibility="hidden",n.style.position="absolute",n.style.width=n.style.height="0",n.style.border="0",n.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.body.appendChild(n),n}function xee(n){document.body===n.parentNode&&document.body.removeChild(n)}/*! @azure/msal-browser v4.5.0 2025-02-26 */class yee extends rm{constructor(e,t,i,s,r,a,o,l,c,h,u){super(e,t,i,s,r,a,l,h,u),this.apiId=o,this.nativeStorage=c}async acquireToken(e){this.performanceClient.addQueueMeasurement(Ee.SilentIframeClientAcquireToken,e.correlationId),!e.loginHint&&!e.sid&&(!e.account||!e.account.username)&&this.logger.warning("No user hint provided. The authorization server may need more information to complete this request.");const t={...e};t.prompt?t.prompt!==Vs.NONE&&t.prompt!==Vs.NO_SESSION&&(this.logger.warning(`SilentIframeClient. Replacing invalid prompt ${t.prompt} with ${Vs.NONE}`),t.prompt=Vs.NONE):t.prompt=Vs.NONE;const i=await dt(this.initializeAuthorizationRequest.bind(this),Ee.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,e.correlationId)(t,an.Silent);wO(i.authority);const s=this.initializeServerTelemetryManager(this.apiId);let r;try{return r=await dt(this.createAuthCodeClient.bind(this),Ee.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,e.correlationId)({serverTelemetryManager:s,requestAuthority:i.authority,requestAzureCloudOptions:i.azureCloudOptions,requestExtraQueryParameters:i.extraQueryParameters,account:i.account}),await dt(this.silentTokenHelper.bind(this),Ee.SilentIframeClientTokenHelper,this.logger,this.performanceClient,e.correlationId)(r,i)}catch(a){if(a instanceof zi&&(a.setCorrelationId(this.correlationId),s.cacheFailedRequest(a)),!r||!(a instanceof zi)||a.errorCode!==Ka.INVALID_GRANT_ERROR)throw a;this.performanceClient.addFields({retryError:a.errorCode},this.correlationId);const o=await dt(this.initializeAuthorizationRequest.bind(this),Ee.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,e.correlationId)(t,an.Silent);return await dt(this.silentTokenHelper.bind(this),Ee.SilentIframeClientTokenHelper,this.logger,this.performanceClient,this.correlationId)(r,o)}}logout(){return Promise.reject(Bt(Ry))}async silentTokenHelper(e,t){const i=t.correlationId;this.performanceClient.addQueueMeasurement(Ee.SilentIframeClientTokenHelper,i);const s=await dt(this.initializeAuthorizationCodeRequest.bind(this),Ee.StandardInteractionClientInitializeAuthorizationCodeRequest,this.logger,this.performanceClient,i)(t),r=await dt(e.getAuthCodeUrl.bind(e),Ee.GetAuthCodeUrl,this.logger,this.performanceClient,i)({...t,platformBroker:nc.isPlatformBrokerAvailable(this.config,this.logger,this.nativeMessageHandler,t.authenticationScheme)}),a=new W_(e,this.browserStorage,s,this.logger,this.performanceClient),o=await dt(gee,Ee.SilentHandlerInitiateAuthRequest,this.logger,this.performanceClient,i)(r,this.performanceClient,this.logger,i,this.config.system.navigateFrameWait),l=this.config.auth.OIDCOptions.serverResponseType,c=await dt(mee,Ee.SilentHandlerMonitorIframeForHash,this.logger,this.performanceClient,i)(o,this.config.system.iframeHashTimeout,this.config.system.pollIntervalMilliseconds,this.performanceClient,this.logger,i,l),h=I0(IO,Ee.DeserializeResponse,this.logger,this.performanceClient,this.correlationId)(c,l,this.logger);if(h.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw Bt(Tx);const u=new g1(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.apiId,this.performanceClient,this.nativeMessageHandler,h.accountId,this.browserStorage,i),{userRequestState:d}=ol.parseRequestState(this.browserCrypto,t.state);return dt(u.acquireToken.bind(u),Ee.NativeInteractionClientAcquireToken,this.logger,this.performanceClient,i)({...t,state:d,prompt:t.prompt||Vs.NONE})}return dt(a.handleCodeResponse.bind(a),Ee.HandleCodeResponse,this.logger,this.performanceClient,i)(h,t)}}/*! @azure/msal-browser v4.5.0 2025-02-26 */class wee extends rm{async acquireToken(e){this.performanceClient.addQueueMeasurement(Ee.SilentRefreshClientAcquireToken,e.correlationId);const t=await dt(q_,Ee.InitializeBaseRequest,this.logger,this.performanceClient,e.correlationId)(e,this.config,this.performanceClient,this.logger),i={...e,...t};e.redirectUri&&(i.redirectUri=this.getRedirectUri(e.redirectUri));const s=this.initializeServerTelemetryManager(Ti.acquireTokenSilent_silentFlow),r=await this.createRefreshTokenClient({serverTelemetryManager:s,authorityUrl:i.authority,azureCloudOptions:i.azureCloudOptions,account:i.account});return dt(r.acquireTokenByRefreshToken.bind(r),Ee.RefreshTokenClientAcquireTokenByRefreshToken,this.logger,this.performanceClient,e.correlationId)(i).catch(a=>{throw a.setCorrelationId(this.correlationId),s.cacheFailedRequest(a),a})}logout(){return Promise.reject(Bt(Ry))}async createRefreshTokenClient(e){const t=await dt(this.getClientConfiguration.bind(this),Ee.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:e.serverTelemetryManager,requestAuthority:e.authorityUrl,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account});return new GQ(t,this.performanceClient)}}/*! @azure/msal-browser v4.5.0 2025-02-26 */class _ee{constructor(e,t,i,s){this.isBrowserEnvironment=typeof window<"u",this.config=e,this.storage=t,this.logger=i,this.cryptoObj=s}async loadExternalTokens(e,t,i){if(!this.isBrowserEnvironment)throw Bt(My);const s=e.correlationId||ul(),r=t.id_token?sm(t.id_token,b0):void 0,a={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},o=e.authority?new Rr(Rr.generateAuthority(e.authority,e.azureCloudOptions),this.config.system.networkClient,this.storage,a,this.logger,e.correlationId||ul()):void 0,l=await this.loadAccount(e,i.clientInfo||t.client_info||"",s,r,o),c=await this.loadIdToken(t,l.homeAccountId,l.environment,l.realm,s),h=await this.loadAccessToken(e,t,l.homeAccountId,l.environment,l.realm,i,s),u=await this.loadRefreshToken(t,l.homeAccountId,l.environment,s);return this.generateAuthenticationResult(e,{account:l,idToken:c,accessToken:h,refreshToken:u},r,o)}async loadAccount(e,t,i,s,r){if(this.logger.verbose("TokenCache - loading account"),e.account){const c=$r.createFromAccountInfo(e.account);return await this.storage.setAccount(c,i),c}else if(!r||!t&&!s)throw this.logger.error("TokenCache - if an account is not provided on the request, authority and either clientInfo or idToken must be provided instead."),Bt(ZN);const a=$r.generateHomeAccountId(t,r.authorityType,this.logger,this.cryptoObj,s),o=s==null?void 0:s.tid,l=T_(this.storage,r,a,b0,s,t,r.hostnameAndPort,o,void 0,void 0,this.logger);return await this.storage.setAccount(l,i),l}async loadIdToken(e,t,i,s,r){if(!e.id_token)return this.logger.verbose("TokenCache - no id token found in response"),null;this.logger.verbose("TokenCache - loading id token");const a=ky(t,i,e.id_token,this.config.auth.clientId,s);return await this.storage.setIdTokenCredential(a,r),a}async loadAccessToken(e,t,i,s,r,a,o){if(t.access_token)if(t.expires_in){if(!t.scope&&(!e.scopes||!e.scopes.length))return this.logger.error("TokenCache - scopes not specified in the request or response. Cannot add token to the cache."),null}else return this.logger.error("TokenCache - no expiration set on the access token. Cannot add it to the cache."),null;else return this.logger.verbose("TokenCache - no access token found in response"),null;this.logger.verbose("TokenCache - loading access token");const l=t.scope?cs.fromString(t.scope):new cs(e.scopes),c=a.expiresOn||t.expires_in+new Date().getTime()/1e3,h=a.extendedExpiresOn||(t.ext_expires_in||t.expires_in)+new Date().getTime()/1e3,u=Cy(i,s,t.access_token,this.config.auth.clientId,r,l.printScopes(),c,h,b0);return await this.storage.setAccessTokenCredential(u,o),u}async loadRefreshToken(e,t,i,s){if(!e.refresh_token)return this.logger.verbose("TokenCache - no refresh token found in response"),null;this.logger.verbose("TokenCache - loading refresh token");const r=rN(t,i,e.refresh_token,this.config.auth.clientId,e.foci,void 0,e.refresh_token_expires_in);return await this.storage.setRefreshTokenCredential(r,s),r}generateAuthenticationResult(e,t,i,s){var h,u,d;let r="",a=[],o=null,l;t!=null&&t.accessToken&&(r=t.accessToken.secret,a=cs.fromString(t.accessToken.target).asArray(),o=new Date(Number(t.accessToken.expiresOn)*1e3),l=new Date(Number(t.accessToken.extendedExpiresOn)*1e3));const c=t.account;return{authority:s?s.canonicalAuthority:"",uniqueId:t.account.localAccountId,tenantId:t.account.realm,scopes:a,account:c.getAccountInfo(),idToken:((h=t.idToken)==null?void 0:h.secret)||"",idTokenClaims:i||{},accessToken:r,fromCache:!0,expiresOn:o,correlationId:e.correlationId||"",requestId:"",extExpiresOn:l,familyId:((u=t.refreshToken)==null?void 0:u.familyId)||"",tokenType:((d=t==null?void 0:t.accessToken)==null?void 0:d.tokenType)||"",state:e.state||"",cloudGraphHostName:c.cloudGraphHostName||"",msGraphHost:c.msGraphHost||"",fromNativeBroker:!1}}}/*! @azure/msal-browser v4.5.0 2025-02-26 */class vee extends MN{constructor(e){super(e),this.includeRedirectUri=!1}}/*! @azure/msal-browser v4.5.0 2025-02-26 */class kee extends rm{constructor(e,t,i,s,r,a,o,l,c,h){super(e,t,i,s,r,a,l,c,h),this.apiId=o}async acquireToken(e){if(!e.code)throw Bt(QN);const t=await dt(this.initializeAuthorizationRequest.bind(this),Ee.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,e.correlationId)(e,an.Silent),i=this.initializeServerTelemetryManager(this.apiId);try{const s={...t,code:e.code},r=await dt(this.getClientConfiguration.bind(this),Ee.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,e.correlationId)({serverTelemetryManager:i,requestAuthority:t.authority,requestAzureCloudOptions:t.azureCloudOptions,requestExtraQueryParameters:t.extraQueryParameters,account:t.account}),a=new vee(r);this.logger.verbose("Auth code client created");const o=new W_(a,this.browserStorage,s,this.logger,this.performanceClient);return await dt(o.handleCodeResponseFromServer.bind(o),Ee.HandleCodeResponseFromServer,this.logger,this.performanceClient,e.correlationId)({code:e.code,msgraph_host:e.msGraphHost,cloud_graph_host_name:e.cloudGraphHostName,cloud_instance_host_name:e.cloudInstanceHostName},t,!1)}catch(s){throw s instanceof zi&&(s.setCorrelationId(this.correlationId),i.cacheFailedRequest(s)),s}}logout(){return Promise.reject(Bt(Ry))}}/*! @azure/msal-browser v4.5.0 2025-02-26 */function Cl(n){const e=n==null?void 0:n.idTokenClaims;if(e!=null&&e.tfp||e!=null&&e.acr)return"B2C";if(e!=null&&e.tid){if((e==null?void 0:e.tid)==="9188040d-6c67-4c5b-b112-36a304b66dad")return"MSA"}else return;return"AAD"}function _9(n,e){try{G_(n)}catch(t){throw e.end({success:!1},t),t}}class Dy{constructor(e){this.operatingContext=e,this.isBrowserEnvironment=this.operatingContext.isBrowserEnvironment(),this.config=e.getConfig(),this.initialized=!1,this.logger=this.operatingContext.getLogger(),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.performanceClient=this.config.telemetry.client,this.browserCrypto=this.isBrowserEnvironment?new qg(this.logger,this.performanceClient):t5,this.eventHandler=new J$(this.logger),this.browserStorage=this.isBrowserEnvironment?new Q6(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger,this.performanceClient,this.eventHandler,NQ(this.config.auth)):z$(this.config.auth.clientId,this.logger,this.performanceClient,this.eventHandler);const t={cacheLocation:pr.MemoryStorage,temporaryCacheLocation:pr.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1};this.nativeInternalStorage=new Q6(this.config.auth.clientId,t,this.browserCrypto,this.logger,this.performanceClient,this.eventHandler),this.tokenCache=new _ee(this.config,this.browserStorage,this.logger,this.browserCrypto),this.activeSilentTokenRequests=new Map,this.trackPageVisibility=this.trackPageVisibility.bind(this),this.trackPageVisibilityWithMeasurement=this.trackPageVisibilityWithMeasurement.bind(this)}static async createController(e,t){const i=new Dy(e);return await i.initialize(t),i}trackPageVisibility(e){e&&(this.logger.info("Perf: Visibility change detected"),this.performanceClient.incrementFields({visibilityChangeCount:1},e))}async initialize(e){if(this.logger.trace("initialize called"),this.initialized){this.logger.info("initialize has already been called, exiting early.");return}if(!this.isBrowserEnvironment){this.logger.info("in non-browser environment, exiting early."),this.initialized=!0,this.eventHandler.emitEvent(ln.INITIALIZE_END);return}const t=(e==null?void 0:e.correlationId)||this.getRequestCorrelationId(),i=this.config.system.allowPlatformBroker,s=this.performanceClient.startMeasurement(Ee.InitializeClientApplication,t);if(this.eventHandler.emitEvent(ln.INITIALIZE_START),await dt(this.browserStorage.initialize.bind(this.browserStorage),Ee.InitializeCache,this.logger,this.performanceClient,t)(t),i)try{this.nativeExtensionProvider=await nc.createProvider(this.logger,this.config.system.nativeBrokerHandshakeTimeout,this.performanceClient)}catch(r){this.logger.verbose(r)}this.config.cache.claimsBasedCachingEnabled||(this.logger.verbose("Claims-based caching is disabled. Clearing the previous cache with claims"),await dt(this.browserStorage.clearTokensAndKeysWithClaims.bind(this.browserStorage),Ee.ClearTokensAndKeysWithClaims,this.logger,this.performanceClient,t)(this.performanceClient,t)),this.config.system.asyncPopups&&await this.preGeneratePkceCodes(t),this.initialized=!0,this.eventHandler.emitEvent(ln.INITIALIZE_END),s.end({allowPlatformBroker:i,success:!0})}async handleRedirectPromise(e){if(this.logger.verbose("handleRedirectPromise called"),yO(this.initialized),this.isBrowserEnvironment){const t=e||"";let i=this.redirectResponse.get(t);return typeof i>"u"?(i=this.handleRedirectPromiseInternal(e),this.redirectResponse.set(t,i),this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise")):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),i}return this.logger.verbose("handleRedirectPromise returns null, not browser environment"),null}async handleRedirectPromiseInternal(e){const t=this.getAllAccounts(),i=this.browserStorage.getCachedNativeRequest(),s=i&&nc.isPlatformBrokerAvailable(this.config,this.logger,this.nativeExtensionProvider)&&this.nativeExtensionProvider&&!e,r=s?i==null?void 0:i.correlationId:this.browserStorage.getTemporaryCache(ui.CORRELATION_ID,!0)||"",a=this.performanceClient.startMeasurement(Ee.AcquireTokenRedirect,r);this.eventHandler.emitEvent(ln.HANDLE_REDIRECT_START,an.Redirect);let o;if(s&&this.nativeExtensionProvider){this.logger.trace("handleRedirectPromise - acquiring token from native platform");const l=new g1(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Ti.handleRedirectPromise,this.performanceClient,this.nativeExtensionProvider,i.accountId,this.nativeInternalStorage,i.correlationId);o=dt(l.handleRedirectPromise.bind(l),Ee.HandleNativeRedirectPromiseMeasurement,this.logger,this.performanceClient,a.event.correlationId)(this.performanceClient,a.event.correlationId)}else{this.logger.trace("handleRedirectPromise - acquiring token from web flow");const l=this.createRedirectClient(r);o=dt(l.handleRedirectPromise.bind(l),Ee.HandleRedirectPromiseMeasurement,this.logger,this.performanceClient,a.event.correlationId)(e,a)}return o.then(l=>(l?(t.length<this.getAllAccounts().length?(this.eventHandler.emitEvent(ln.LOGIN_SUCCESS,an.Redirect,l),this.logger.verbose("handleRedirectResponse returned result, login success")):(this.eventHandler.emitEvent(ln.ACQUIRE_TOKEN_SUCCESS,an.Redirect,l),this.logger.verbose("handleRedirectResponse returned result, acquire token success")),a.end({success:!0,accountType:Cl(l.account)})):a.event.errorCode?a.end({success:!1}):a.discard(),this.eventHandler.emitEvent(ln.HANDLE_REDIRECT_END,an.Redirect),l)).catch(l=>{const c=l;throw t.length>0?this.eventHandler.emitEvent(ln.ACQUIRE_TOKEN_FAILURE,an.Redirect,null,c):this.eventHandler.emitEvent(ln.LOGIN_FAILURE,an.Redirect,null,c),this.eventHandler.emitEvent(ln.HANDLE_REDIRECT_END,an.Redirect),a.end({success:!1},c),l})}async acquireTokenRedirect(e){const t=this.getRequestCorrelationId(e);this.logger.verbose("acquireTokenRedirect called",t);const i=this.performanceClient.startMeasurement(Ee.AcquireTokenPreRedirect,t);i.add({accountType:Cl(e.account),scenarioId:e.scenarioId});const s=e.onRedirectNavigate;if(s)e.onRedirectNavigate=a=>{const o=typeof s=="function"?s(a):void 0;return o!==!1?i.end({success:!0}):i.discard(),o};else{const a=this.config.auth.onRedirectNavigate;this.config.auth.onRedirectNavigate=o=>{const l=typeof a=="function"?a(o):void 0;return l!==!1?i.end({success:!0}):i.discard(),l}}const r=this.getAllAccounts().length>0;try{iA(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0),r?this.eventHandler.emitEvent(ln.ACQUIRE_TOKEN_START,an.Redirect,e):this.eventHandler.emitEvent(ln.LOGIN_START,an.Redirect,e);let a;return this.nativeExtensionProvider&&this.canUsePlatformBroker(e)?a=new g1(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Ti.acquireTokenRedirect,this.performanceClient,this.nativeExtensionProvider,this.getNativeAccountId(e),this.nativeInternalStorage,t).acquireTokenRedirect(e,i).catch(l=>{if(l instanceof tc&&zf(l))return this.nativeExtensionProvider=void 0,this.createRedirectClient(t).acquireToken(e);if(l instanceof hl)return this.logger.verbose("acquireTokenRedirect - Resolving interaction required error thrown by native broker by falling back to web flow"),this.createRedirectClient(t).acquireToken(e);throw this.browserStorage.setInteractionInProgress(!1),l}):a=this.createRedirectClient(t).acquireToken(e),await a}catch(a){throw i.end({success:!1},a),r?this.eventHandler.emitEvent(ln.ACQUIRE_TOKEN_FAILURE,an.Redirect,null,a):this.eventHandler.emitEvent(ln.LOGIN_FAILURE,an.Redirect,null,a),a}}acquireTokenPopup(e){const t=this.getRequestCorrelationId(e),i=this.performanceClient.startMeasurement(Ee.AcquireTokenPopup,t);i.add({scenarioId:e.scenarioId,accountType:Cl(e.account)});try{this.logger.verbose("acquireTokenPopup called",t),_9(this.initialized,i),this.browserStorage.setInteractionInProgress(!0)}catch(o){return Promise.reject(o)}const s=this.getAllAccounts();s.length>0?this.eventHandler.emitEvent(ln.ACQUIRE_TOKEN_START,an.Popup,e):this.eventHandler.emitEvent(ln.LOGIN_START,an.Popup,e);let r;const a=this.getPreGeneratedPkceCodes(t);return this.canUsePlatformBroker(e)?r=this.acquireTokenNative({...e,correlationId:t},Ti.acquireTokenPopup).then(o=>(this.browserStorage.setInteractionInProgress(!1),i.end({success:!0,isNativeBroker:!0,accountType:Cl(o.account)}),o)).catch(o=>{if(o instanceof tc&&zf(o))return this.nativeExtensionProvider=void 0,this.createPopupClient(t).acquireToken(e,a);if(o instanceof hl)return this.logger.verbose("acquireTokenPopup - Resolving interaction required error thrown by native broker by falling back to web flow"),this.createPopupClient(t).acquireToken(e,a);throw this.browserStorage.setInteractionInProgress(!1),o}):r=this.createPopupClient(t).acquireToken(e,a),r.then(o=>(s.length<this.getAllAccounts().length?this.eventHandler.emitEvent(ln.LOGIN_SUCCESS,an.Popup,o):this.eventHandler.emitEvent(ln.ACQUIRE_TOKEN_SUCCESS,an.Popup,o),i.end({success:!0,accessTokenSize:o.accessToken.length,idTokenSize:o.idToken.length,accountType:Cl(o.account)}),o)).catch(o=>(s.length>0?this.eventHandler.emitEvent(ln.ACQUIRE_TOKEN_FAILURE,an.Popup,null,o):this.eventHandler.emitEvent(ln.LOGIN_FAILURE,an.Popup,null,o),i.end({success:!1},o),Promise.reject(o))).finally(()=>this.config.system.asyncPopups&&this.preGeneratePkceCodes(t))}trackPageVisibilityWithMeasurement(){const e=this.ssoSilentMeasurement||this.acquireTokenByCodeAsyncMeasurement;e&&(this.logger.info("Perf: Visibility change detected in ",e.event.name),e.increment({visibilityChangeCount:1}))}async ssoSilent(e){var r,a;const t=this.getRequestCorrelationId(e),i={...e,prompt:e.prompt,correlationId:t};this.ssoSilentMeasurement=this.performanceClient.startMeasurement(Ee.SsoSilent,t),(r=this.ssoSilentMeasurement)==null||r.add({scenarioId:e.scenarioId,accountType:Cl(e.account)}),_9(this.initialized,this.ssoSilentMeasurement),(a=this.ssoSilentMeasurement)==null||a.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),this.logger.verbose("ssoSilent called",t),this.eventHandler.emitEvent(ln.SSO_SILENT_START,an.Silent,i);let s;return this.canUsePlatformBroker(i)?s=this.acquireTokenNative(i,Ti.ssoSilent).catch(o=>{if(o instanceof tc&&zf(o))return this.nativeExtensionProvider=void 0,this.createSilentIframeClient(i.correlationId).acquireToken(i);throw o}):s=this.createSilentIframeClient(i.correlationId).acquireToken(i),s.then(o=>{var l;return this.eventHandler.emitEvent(ln.SSO_SILENT_SUCCESS,an.Silent,o),(l=this.ssoSilentMeasurement)==null||l.end({success:!0,isNativeBroker:o.fromNativeBroker,accessTokenSize:o.accessToken.length,idTokenSize:o.idToken.length,accountType:Cl(o.account)}),o}).catch(o=>{var l;throw this.eventHandler.emitEvent(ln.SSO_SILENT_FAILURE,an.Silent,null,o),(l=this.ssoSilentMeasurement)==null||l.end({success:!1},o),o}).finally(()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)})}async acquireTokenByCode(e){const t=this.getRequestCorrelationId(e);this.logger.trace("acquireTokenByCode called",t);const i=this.performanceClient.startMeasurement(Ee.AcquireTokenByCode,t);_9(this.initialized,i),this.eventHandler.emitEvent(ln.ACQUIRE_TOKEN_BY_CODE_START,an.Silent,e),i.add({scenarioId:e.scenarioId});try{if(e.code&&e.nativeAccountId)throw Bt(eO);if(e.code){const s=e.code;let r=this.hybridAuthCodeResponses.get(s);return r?(this.logger.verbose("Existing acquireTokenByCode request found",t),i.discard()):(this.logger.verbose("Initiating new acquireTokenByCode request",t),r=this.acquireTokenByCodeAsync({...e,correlationId:t}).then(a=>(this.eventHandler.emitEvent(ln.ACQUIRE_TOKEN_BY_CODE_SUCCESS,an.Silent,a),this.hybridAuthCodeResponses.delete(s),i.end({success:!0,isNativeBroker:a.fromNativeBroker,accessTokenSize:a.accessToken.length,idTokenSize:a.idToken.length,accountType:Cl(a.account)}),a)).catch(a=>{throw this.hybridAuthCodeResponses.delete(s),this.eventHandler.emitEvent(ln.ACQUIRE_TOKEN_BY_CODE_FAILURE,an.Silent,null,a),i.end({success:!1},a),a}),this.hybridAuthCodeResponses.set(s,r)),await r}else if(e.nativeAccountId)if(this.canUsePlatformBroker(e,e.nativeAccountId)){const s=await this.acquireTokenNative({...e,correlationId:t},Ti.acquireTokenByCode,e.nativeAccountId).catch(r=>{throw r instanceof tc&&zf(r)&&(this.nativeExtensionProvider=void 0),r});return i.end({accountType:Cl(s.account),success:!0}),s}else throw Bt(tO);else throw Bt($N)}catch(s){throw this.eventHandler.emitEvent(ln.ACQUIRE_TOKEN_BY_CODE_FAILURE,an.Silent,null,s),i.end({success:!1},s),s}}async acquireTokenByCodeAsync(e){var s;return this.logger.trace("acquireTokenByCodeAsync called",e.correlationId),this.acquireTokenByCodeAsyncMeasurement=this.performanceClient.startMeasurement(Ee.AcquireTokenByCodeAsync,e.correlationId),(s=this.acquireTokenByCodeAsyncMeasurement)==null||s.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),await this.createSilentAuthCodeClient(e.correlationId).acquireToken(e).then(r=>{var a;return(a=this.acquireTokenByCodeAsyncMeasurement)==null||a.end({success:!0,fromCache:r.fromCache,isNativeBroker:r.fromNativeBroker}),r}).catch(r=>{var a;throw(a=this.acquireTokenByCodeAsyncMeasurement)==null||a.end({success:!1},r),r}).finally(()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)})}async acquireTokenFromCache(e,t){switch(this.performanceClient.addQueueMeasurement(Ee.AcquireTokenFromCache,e.correlationId),t){case Ia.Default:case Ia.AccessToken:case Ia.AccessTokenAndRefreshToken:const i=this.createSilentCacheClient(e.correlationId);return dt(i.acquireToken.bind(i),Ee.SilentCacheClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e);default:throw ut(jh)}}async acquireTokenByRefreshToken(e,t){switch(this.performanceClient.addQueueMeasurement(Ee.AcquireTokenByRefreshToken,e.correlationId),t){case Ia.Default:case Ia.AccessTokenAndRefreshToken:case Ia.RefreshToken:case Ia.RefreshTokenAndNetwork:const i=this.createSilentRefreshClient(e.correlationId);return dt(i.acquireToken.bind(i),Ee.SilentRefreshClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e);default:throw ut(jh)}}async acquireTokenBySilentIframe(e){this.performanceClient.addQueueMeasurement(Ee.AcquireTokenBySilentIframe,e.correlationId);const t=this.createSilentIframeClient(e.correlationId);return dt(t.acquireToken.bind(t),Ee.SilentIframeClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e)}async logout(e){const t=this.getRequestCorrelationId(e);return this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead.",t),this.logoutRedirect({correlationId:t,...e})}async logoutRedirect(e){const t=this.getRequestCorrelationId(e);return iA(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0),this.createRedirectClient(t).logout(e)}logoutPopup(e){try{const t=this.getRequestCorrelationId(e);return G_(this.initialized),this.browserStorage.setInteractionInProgress(!0),this.createPopupClient(t).logout(e)}catch(t){return Promise.reject(t)}}async clearCache(e){if(!this.isBrowserEnvironment){this.logger.info("in non-browser environment, returning early.");return}const t=this.getRequestCorrelationId(e);return this.createSilentCacheClient(t).logout(e)}getAllAccounts(e){return j$(this.logger,this.browserStorage,this.isBrowserEnvironment,e)}getAccount(e){return G$(e,this.logger,this.browserStorage)}getAccountByUsername(e){return V$(e,this.logger,this.browserStorage)}getAccountByHomeId(e){return q$(e,this.logger,this.browserStorage)}getAccountByLocalId(e){return W$(e,this.logger,this.browserStorage)}setActiveAccount(e){K$(e,this.browserStorage)}getActiveAccount(){return X$(this.browserStorage)}async hydrateCache(e,t){this.logger.verbose("hydrateCache called");const i=$r.createFromAccountInfo(e.account,e.cloudGraphHostName,e.msGraphHost);return await this.browserStorage.setAccount(i,e.correlationId),e.fromNativeBroker?(this.logger.verbose("Response was from native broker, storing in-memory"),this.nativeInternalStorage.hydrateCache(e,t)):this.browserStorage.hydrateCache(e,t)}async acquireTokenNative(e,t,i){if(this.logger.trace("acquireTokenNative called"),!this.nativeExtensionProvider)throw Bt(Tx);return new g1(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,t,this.performanceClient,this.nativeExtensionProvider,i||this.getNativeAccountId(e),this.nativeInternalStorage,e.correlationId).acquireToken(e)}canUsePlatformBroker(e,t){if(this.logger.trace("canUsePlatformBroker called"),!nc.isPlatformBrokerAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme))return this.logger.trace("canUsePlatformBroker: isPlatformBrokerAvailable returned false, returning false"),!1;if(e.prompt)switch(e.prompt){case Vs.NONE:case Vs.CONSENT:case Vs.LOGIN:this.logger.trace("canUsePlatformBroker: prompt is compatible with platform broker flow");break;default:return this.logger.trace(`canUsePlatformBroker: prompt = ${e.prompt} is not compatible with platform broker flow, returning false`),!1}return!t&&!this.getNativeAccountId(e)?(this.logger.trace("canUsePlatformBroker: nativeAccountId is not available, returning false"),!1):!0}getNativeAccountId(e){const t=e.account||this.getAccount({loginHint:e.loginHint,sid:e.sid})||this.getActiveAccount();return t&&t.nativeAccountId||""}createPopupClient(e){return new uee(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createRedirectClient(e){return new fee(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createSilentIframeClient(e){return new yee(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Ti.ssoSilent,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createSilentCacheClient(e){return new SO(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)}createSilentRefreshClient(e){return new wee(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)}createSilentAuthCodeClient(e){return new kee(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Ti.acquireTokenByCode,this.performanceClient,this.nativeExtensionProvider,e)}addEventCallback(e,t){return this.eventHandler.addEventCallback(e,t)}removeEventCallback(e){this.eventHandler.removeEventCallback(e)}addPerformanceCallback(e){return xO(),this.performanceClient.addPerformanceCallback(e)}removePerformanceCallback(e){return this.performanceClient.removePerformanceCallback(e)}enableAccountStorageEvents(){if(this.config.cache.cacheLocation!==pr.LocalStorage){this.logger.info("Account storage events are only available when cacheLocation is set to localStorage");return}this.eventHandler.subscribeCrossTab()}disableAccountStorageEvents(){if(this.config.cache.cacheLocation!==pr.LocalStorage){this.logger.info("Account storage events are only available when cacheLocation is set to localStorage");return}this.eventHandler.unsubscribeCrossTab()}getTokenCache(){return this.tokenCache}getLogger(){return this.logger}setLogger(e){this.logger=e}initializeWrapperLibrary(e,t){this.browserStorage.setWrapperMetadata(e,t)}setNavigationClient(e){this.navigationClient=e}getConfiguration(){return this.config}getPerformanceClient(){return this.performanceClient}isBrowserEnv(){return this.isBrowserEnvironment}getRequestCorrelationId(e){return e!=null&&e.correlationId?e.correlationId:this.isBrowserEnvironment?ul():Ge.EMPTY_STRING}async loginRedirect(e){const t=this.getRequestCorrelationId(e);return this.logger.verbose("loginRedirect called",t),this.acquireTokenRedirect({correlationId:t,...e||$C})}loginPopup(e){const t=this.getRequestCorrelationId(e);return this.logger.verbose("loginPopup called",t),this.acquireTokenPopup({correlationId:t,...e||$C})}async acquireTokenSilent(e){const t=this.getRequestCorrelationId(e),i=this.performanceClient.startMeasurement(Ee.AcquireTokenSilent,t);i.add({cacheLookupPolicy:e.cacheLookupPolicy,scenarioId:e.scenarioId}),_9(this.initialized,i),this.logger.verbose("acquireTokenSilent called",t);const s=e.account||this.getActiveAccount();if(!s)throw Bt(WN);i.add({accountType:Cl(s)});const r={clientId:this.config.auth.clientId,authority:e.authority||Ge.EMPTY_STRING,scopes:e.scopes,homeAccountIdentifier:s.homeAccountId,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid,shrOptions:e.shrOptions},a=JSON.stringify(r),o=this.activeSilentTokenRequests.get(a);if(typeof o>"u"){this.logger.verbose("acquireTokenSilent called for the first time, storing active request",t);const l=dt(this.acquireTokenSilentAsync.bind(this),Ee.AcquireTokenSilentAsync,this.logger,this.performanceClient,t)({...e,correlationId:t},s).then(c=>(this.activeSilentTokenRequests.delete(a),i.end({success:!0,fromCache:c.fromCache,isNativeBroker:c.fromNativeBroker,cacheLookupPolicy:e.cacheLookupPolicy,accessTokenSize:c.accessToken.length,idTokenSize:c.idToken.length}),c)).catch(c=>{throw this.activeSilentTokenRequests.delete(a),i.end({success:!1},c),c});return this.activeSilentTokenRequests.set(a,l),{...await l,state:e.state}}else return this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",t),i.discard(),{...await o,state:e.state}}async acquireTokenSilentAsync(e,t){const i=()=>this.trackPageVisibility(e.correlationId);this.performanceClient.addQueueMeasurement(Ee.AcquireTokenSilentAsync,e.correlationId),this.eventHandler.emitEvent(ln.ACQUIRE_TOKEN_START,an.Silent,e),e.correlationId&&this.performanceClient.incrementFields({visibilityChangeCount:0},e.correlationId),document.addEventListener("visibilitychange",i);const s=await dt(eee,Ee.InitializeSilentRequest,this.logger,this.performanceClient,e.correlationId)(e,t,this.config,this.performanceClient,this.logger),r=e.cacheLookupPolicy||Ia.Default;return this.acquireTokenSilentNoIframe(s,r).catch(async o=>{if(Cee(o,r))if(this.activeIframeRequest)if(r!==Ia.Skip){const[c,h]=this.activeIframeRequest;this.logger.verbose(`Iframe request is already in progress, awaiting resolution for request with correlationId: ${h}`,s.correlationId);const u=this.performanceClient.startMeasurement(Ee.AwaitConcurrentIframe,s.correlationId);u.add({awaitIframeCorrelationId:h});const d=await c;if(u.end({success:d}),d)return this.logger.verbose(`Parallel iframe request with correlationId: ${h} succeeded. Retrying cache and/or RT redemption`,s.correlationId),this.acquireTokenSilentNoIframe(s,r);throw this.logger.info(`Iframe request with correlationId: ${h} failed. Interaction is required.`),o}else return this.logger.warning("Another iframe request is currently in progress and CacheLookupPolicy is set to Skip. This may result in degraded performance and/or reliability for both calls. Please consider changing the CacheLookupPolicy to take advantage of request queuing and token cache.",s.correlationId),dt(this.acquireTokenBySilentIframe.bind(this),Ee.AcquireTokenBySilentIframe,this.logger,this.performanceClient,s.correlationId)(s);else{let c;return this.activeIframeRequest=[new Promise(h=>{c=h}),s.correlationId],this.logger.verbose("Refresh token expired/invalid or CacheLookupPolicy is set to Skip, attempting acquire token by iframe.",s.correlationId),dt(this.acquireTokenBySilentIframe.bind(this),Ee.AcquireTokenBySilentIframe,this.logger,this.performanceClient,s.correlationId)(s).then(h=>(c(!0),h)).catch(h=>{throw c(!1),h}).finally(()=>{this.activeIframeRequest=void 0})}else throw o}).then(o=>(this.eventHandler.emitEvent(ln.ACQUIRE_TOKEN_SUCCESS,an.Silent,o),e.correlationId&&this.performanceClient.addFields({fromCache:o.fromCache,isNativeBroker:o.fromNativeBroker},e.correlationId),o)).catch(o=>{throw this.eventHandler.emitEvent(ln.ACQUIRE_TOKEN_FAILURE,an.Silent,null,o),o}).finally(()=>{document.removeEventListener("visibilitychange",i)})}async acquireTokenSilentNoIframe(e,t){return nc.isPlatformBrokerAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme)&&e.account.nativeAccountId?(this.logger.verbose("acquireTokenSilent - attempting to acquire token from native platform"),this.acquireTokenNative(e,Ti.acquireTokenSilent_silentFlow).catch(async i=>{throw i instanceof tc&&zf(i)?(this.logger.verbose("acquireTokenSilent - native platform unavailable, falling back to web flow"),this.nativeExtensionProvider=void 0,ut(jh)):i})):(this.logger.verbose("acquireTokenSilent - attempting to acquire token from web flow"),dt(this.acquireTokenFromCache.bind(this),Ee.AcquireTokenFromCache,this.logger,this.performanceClient,e.correlationId)(e,t).catch(i=>{if(t===Ia.AccessToken)throw i;return this.eventHandler.emitEvent(ln.ACQUIRE_TOKEN_NETWORK_START,an.Silent,e),dt(this.acquireTokenByRefreshToken.bind(this),Ee.AcquireTokenByRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,t)}))}async preGeneratePkceCodes(e){return this.logger.verbose("Generating new PKCE codes"),this.pkceCode=await dt(CO,Ee.GeneratePkceCodes,this.logger,this.performanceClient,e)(this.performanceClient,this.logger,e),Promise.resolve()}getPreGeneratedPkceCodes(e){this.logger.verbose("Attempting to pick up pre-generated PKCE codes");const t=this.pkceCode?{...this.pkceCode}:void 0;return this.pkceCode=void 0,this.logger.verbose(`${t?"Found":"Did not find"} pre-generated PKCE codes`),this.performanceClient.addFields({usePreGeneratedPkce:!!t},e),t}}function Cee(n,e){const t=!(n instanceof hl&&n.subError!==Ey),i=n.errorCode===Ka.INVALID_GRANT_ERROR||n.errorCode===jh,s=t&&i||n.errorCode===r5||n.errorCode===E_,r=s$.includes(e);return s&&r}/*! @azure/msal-browser v4.5.0 2025-02-26 */async function Aee(n,e){const t=new cf(n);return await t.initialize(),Dy.createController(t,e)}/*! @azure/msal-browser v4.5.0 2025-02-26 */class K_{static async createPublicClientApplication(e){const t=await Aee(e);return new K_(e,t)}constructor(e,t){this.controller=t||new Dy(new cf(e))}async initialize(e){return this.controller.initialize(e)}async acquireTokenPopup(e){return this.controller.acquireTokenPopup(e)}acquireTokenRedirect(e){return this.controller.acquireTokenRedirect(e)}acquireTokenSilent(e){return this.controller.acquireTokenSilent(e)}acquireTokenByCode(e){return this.controller.acquireTokenByCode(e)}addEventCallback(e,t){return this.controller.addEventCallback(e,t)}removeEventCallback(e){return this.controller.removeEventCallback(e)}addPerformanceCallback(e){return this.controller.addPerformanceCallback(e)}removePerformanceCallback(e){return this.controller.removePerformanceCallback(e)}enableAccountStorageEvents(){this.controller.enableAccountStorageEvents()}disableAccountStorageEvents(){this.controller.disableAccountStorageEvents()}getAccount(e){return this.controller.getAccount(e)}getAccountByHomeId(e){return this.controller.getAccountByHomeId(e)}getAccountByLocalId(e){return this.controller.getAccountByLocalId(e)}getAccountByUsername(e){return this.controller.getAccountByUsername(e)}getAllAccounts(e){return this.controller.getAllAccounts(e)}handleRedirectPromise(e){return this.controller.handleRedirectPromise(e)}loginPopup(e){return this.controller.loginPopup(e)}loginRedirect(e){return this.controller.loginRedirect(e)}logout(e){return this.controller.logout(e)}logoutRedirect(e){return this.controller.logoutRedirect(e)}logoutPopup(e){return this.controller.logoutPopup(e)}ssoSilent(e){return this.controller.ssoSilent(e)}getTokenCache(){return this.controller.getTokenCache()}getLogger(){return this.controller.getLogger()}setLogger(e){this.controller.setLogger(e)}setActiveAccount(e){this.controller.setActiveAccount(e)}getActiveAccount(){return this.controller.getActiveAccount()}initializeWrapperLibrary(e,t){return this.controller.initializeWrapperLibrary(e,t)}setNavigationClient(e){this.controller.setNavigationClient(e)}getConfiguration(){return this.controller.getConfiguration()}async hydrateCache(e,t){return this.controller.hydrateCache(e,t)}clearCache(e){return this.controller.clearCache(e)}}const Su=class Su{constructor(){Ue(this,"clientId","");Ue(this,"sharepointUrl","");Ue(this,"sharepointTenantId","");Ue(this,"msalInstance",null);Ue(this,"currentAuthorityType","personal")}static getInstance(){return Su.instance||(Su.instance=new Su),Su.instance}async initialize(e){e&&this.currentAuthorityType!==e&&(this.currentAuthorityType=e,this.msalInstance=null),await this.getCredentials()}async ensureInitialized(e){await this.initialize(e)}async getCredentials(){var o,l,c;const t=await fetch("/api/config",{headers:{"Content-Type":"application/json"},credentials:"include"});if(!t.ok)throw new Error("Failed to fetch OneDrive credentials");const i=await t.json(),s=(o=i.onedrive)==null?void 0:o.client_id,r=(l=i.onedrive)==null?void 0:l.sharepoint_url,a=(c=i.onedrive)==null?void 0:c.sharepoint_tenant_id;if(!s)throw new Error("OneDrive configuration is incomplete");this.clientId=s,this.sharepointUrl=r,this.sharepointTenantId=a}async getMsalInstance(e){if(await this.ensureInitialized(e),!this.msalInstance){const i={auth:{authority:`https://login.microsoftonline.com/${this.currentAuthorityType==="organizations"?this.sharepointTenantId||"common":"consumers"}`,clientId:this.clientId}};this.msalInstance=new K_(i),this.msalInstance.initialize&&await this.msalInstance.initialize()}return this.msalInstance}getAuthorityType(){return this.currentAuthorityType}getSharepointUrl(){return this.sharepointUrl}getSharepointTenantId(){return this.sharepointTenantId}getBaseUrl(){if(this.currentAuthorityType==="organizations"){if(!this.sharepointUrl||this.sharepointUrl==="")throw new Error("Sharepoint URL not configured");let e=this.sharepointUrl.replace(/^https?:\/\//,"");return e=e.replace(/\/$/,""),`https://${e}`}else return"https://onedrive.live.com/picker"}};Ue(Su,"instance");let u2=Su;async function e4(n,e){const t=u2.getInstance();await t.ensureInitialized(e);const r={scopes:t.getAuthorityType()==="organizations"?[`${n||t.getBaseUrl()}/.default`]:["OneDrive.ReadWrite"]};let a="";try{a=(await(await t.getMsalInstance(e)).acquireTokenSilent(r)).accessToken}catch{const l=await t.getMsalInstance(e);try{const c=await l.loginPopup(r);l.setActiveAccount(c.account),c.idToken&&(a=(await l.acquireTokenSilent(r)).accessToken)}catch(c){throw new Error("Failed to login: "+(c instanceof Error?c.message:String(c)))}}if(!a)throw new Error("Failed to acquire access token");return a}function See(){var i;const n=Rl(),e=u2.getInstance(),t={sdk:"8.0",entry:{oneDrive:{}},authentication:{},messaging:{origin:((i=window==null?void 0:window.location)==null?void 0:i.origin)||"",channelId:n},typesAndSources:{mode:"files",pivots:{oneDrive:!0,recent:!0}}};return e.getAuthorityType()!=="organizations"&&(t.entry.oneDrive={files:{}}),t}async function Iee(n,e){const t=await e4(void 0,e);if(!t)throw new Error("Unable to retrieve OneDrive access token.");const i=`${n["@sharePoint.endpoint"]}/drives/${n.parentReference.driveId}/items/${n.id}`,s=await fetch(i,{headers:{Authorization:`Bearer ${t}`}});if(!s.ok)throw new Error(`Failed to fetch file information: ${s.status} ${s.statusText}`);const a=(await s.json())["@content.downloadUrl"];if(!a)throw new Error("Download URL not found in file data");const o=await fetch(a);if(!o.ok)throw new Error(`Failed to download file: ${o.status} ${o.statusText}`);return await o.blob()}async function Eee(n){if(typeof window>"u")throw new Error("Not in browser environment");const e=u2.getInstance();return await e.initialize(n),new Promise((t,i)=>{let s=null,r=null;const a=See(),o=e.getBaseUrl(),l=d=>{var g;if(d.source!==s)return;const f=d.data;if((f==null?void 0:f.type)==="initialize"&&(f==null?void 0:f.channelId)===a.messaging.channelId){if(r=(g=d.ports)==null?void 0:g[0],!r)return;r.addEventListener("message",c),r.start(),r.postMessage({type:"activate"})}},c=async d=>{const f=d.data;switch(f.type){case"notification":break;case"command":{r==null||r.postMessage({type:"acknowledge",id:f.id});const g=f.data;switch(g.command){case"authenticate":{try{const m=e.getAuthorityType()==="organizations"?g.resource:void 0,b=await e4(m,n);if(b)r==null||r.postMessage({type:"result",id:f.id,data:{result:"token",token:b}});else throw new Error("Could not retrieve auth token")}catch{r==null||r.postMessage({type:"result",id:f.id,data:{result:"error",error:{code:"tokenError",message:"Failed to get token"}}})}break}case"close":{h(),t(null);break}case"pick":{r==null||r.postMessage({type:"result",id:f.id,data:{result:"success"}}),h(),t(g);break}default:{r==null||r.postMessage({result:"error",error:{code:"unsupportedCommand",message:g.command},isExpected:!0});break}}break}}};function h(){window.removeEventListener("message",l),r&&r.removeEventListener("message",c),s&&(s.close(),s=null)}(async()=>{try{const d=await e4(void 0,n);if(!d)return i(new Error("Failed to acquire access token"));if(s=window.open("","OneDrivePicker","width=800,height=600"),!s)return i(new Error("Failed to open OneDrive picker window"));const f=new URLSearchParams({filePicker:JSON.stringify(a)});let g="";e.getAuthorityType()==="organizations"?g=o+`/_layouts/15/FilePicker.aspx?${f}`:g=o+`?${f}`;const m=s.document.createElement("form");m.setAttribute("action",g),m.setAttribute("method","POST");const b=s.document.createElement("input");b.setAttribute("type","hidden"),b.setAttribute("name","access_token"),b.setAttribute("value",d),m.appendChild(b),s.document.body.appendChild(m),m.submit(),window.addEventListener("message",l)}catch(d){s&&s.close(),i(d)}})()})}async function Tee(n){const e=await Eee(n);if(!e||!e.items||e.items.length===0)return null;const t=e.items[0];return{blob:await Iee(t,n),name:t.name}}function hA(n,e,t){const i=n.slice();return i[34]=e[t],i}function Ree(n){let e;const t=n[20].default,i=Xs(t,n,n[31],null);return{c(){i&&i.c()},l(s){i&&i.l(s)},m(s,r){i&&i.m(s,r),e=!0},p(s,r){i&&i.p&&(!e||r[1]&1)&&Ys(i,t,s,s[31],e?Zs(t,s[31],r,null):Js(s[31]),null)},i(s){e||(L(i,s),e=!0)},o(s){j(i,s),e=!1},d(s){i&&i.d(s)}}}function Mee(n){let e,t;return e=new Ci({props:{content:n[12].t("More"),$$slots:{default:[Ree]},$$scope:{ctx:n}}}),{c(){pe(e.$$.fragment)},l(i){ye(e.$$.fragment,i)},m(i,s){be(e,i,s),t=!0},p(i,s){const r={};s[0]&4096&&(r.content=i[12].t("More")),s[1]&1&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(L(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){xe(e,i)}}}function uA(n){let e,t,i,s=Object.keys(n[9]).length>3,r,a,o,l=Qn(Object.keys(n[9])),c=[];for(let d=0;d<l.length;d+=1)c[d]=dA(hA(n,l,d));const h=d=>j(c[d],1,1,()=>{c[d]=null});let u=s&&fA(n);return{c(){e=te("div");for(let d=0;d<c.length;d+=1)c[d].c();i=Ae(),u&&u.c(),r=Ae(),a=te("hr"),this.h()},l(d){e=ne(d,"DIV",{class:!0});var f=V(e);for(let g=0;g<c.length;g+=1)c[g].l(f);f.forEach(S),i=Se(d),u&&u.l(d),r=Se(d),a=ne(d,"HR",{class:!0}),this.h()},h(){A(e,"class",t=(n[10]?"":"max-h-28")+" overflow-y-auto scrollbar-thin"),A(a,"class","border-black/5 dark:border-white/5 my-1")},m(d,f){ee(d,e,f);for(let g=0;g<c.length;g+=1)c[g]&&c[g].m(e,null);ee(d,i,f),u&&u.m(d,f),ee(d,r,f),ee(d,a,f),o=!0},p(d,f){if(f[0]&513){l=Qn(Object.keys(d[9]));let g;for(g=0;g<l.length;g+=1){const m=hA(d,l,g);c[g]?(c[g].p(m,f),L(c[g],1)):(c[g]=dA(m),c[g].c(),L(c[g],1),c[g].m(e,null))}for(ot(),g=l.length;g<c.length;g+=1)h(g);lt()}(!o||f[0]&1024&&t!==(t=(d[10]?"":"max-h-28")+" overflow-y-auto scrollbar-thin"))&&A(e,"class",t),f[0]&512&&(s=Object.keys(d[9]).length>3),s?u?u.p(d,f):(u=fA(d),u.c(),u.m(r.parentNode,r)):u&&(u.d(1),u=null)},i(d){if(!o){for(let f=0;f<l.length;f+=1)L(c[f]);o=!0}},o(d){c=c.filter(Boolean);for(let f=0;f<c.length;f+=1)j(c[f]);o=!1},d(d){d&&(S(e),S(i),S(r),S(a)),To(c,d),u&&u.d(d)}}}function Pee(n){let e,t,i,s,r=n[9][n[34]].name+"",a,o;return t=new CF({}),{c(){e=te("div"),pe(t.$$.fragment),i=Ae(),s=te("div"),a=_t(r),this.h()},l(l){e=ne(l,"DIV",{class:!0});var c=V(e);ye(t.$$.fragment,c),c.forEach(S),i=Se(l),s=ne(l,"DIV",{class:!0});var h=V(s);a=vt(h,r),h.forEach(S),this.h()},h(){A(e,"class","shrink-0"),A(s,"class","truncate")},m(l,c){ee(l,e,c),be(t,e,null),ee(l,i,c),ee(l,s,c),q(s,a),o=!0},p(l,c){(!o||c[0]&512)&&r!==(r=l[9][l[34]].name+"")&&St(a,r)},i(l){o||(L(t.$$.fragment,l),o=!0)},o(l){j(t.$$.fragment,l),o=!1},d(l){l&&(S(e),S(i),S(s)),xe(t)}}}function dA(n){var f;let e,t,i,s,r,a,o,l,c,h;i=new Ci({props:{content:((f=n[9][n[34]])==null?void 0:f.description)??"",placement:"top-start",className:"flex flex-1 gap-2 items-center",$$slots:{default:[Pee]},$$scope:{ctx:n}}});function u(...g){return n[21](n[34],...g)}a=new kF({props:{state:n[9][n[34]].enabled}}),a.$on("change",u);function d(){return n[22](n[34])}return{c(){e=te("button"),t=te("div"),pe(i.$$.fragment),s=Ae(),r=te("div"),pe(a.$$.fragment),o=Ae(),this.h()},l(g){e=ne(g,"BUTTON",{class:!0});var m=V(e);t=ne(m,"DIV",{class:!0});var b=V(t);ye(i.$$.fragment,b),b.forEach(S),s=Se(m),r=ne(m,"DIV",{class:!0});var p=V(r);ye(a.$$.fragment,p),p.forEach(S),o=Se(m),m.forEach(S),this.h()},h(){A(t,"class","flex-1 truncate"),A(r,"class","shrink-0"),A(e,"class","flex w-full justify-between gap-2 items-center px-3 py-2 text-sm font-medium cursor-pointer rounded-xl")},m(g,m){ee(g,e,m),q(e,t),be(i,t,null),q(e,s),q(e,r),be(a,r,null),q(e,o),l=!0,c||(h=pt(e,"click",d),c=!0)},p(g,m){var y;n=g;const b={};m[0]&512&&(b.content=((y=n[9][n[34]])==null?void 0:y.description)??""),m[0]&512|m[1]&1&&(b.$$scope={dirty:m,ctx:n}),i.$set(b);const p={};m[0]&512&&(p.state=n[9][n[34]].enabled),a.$set(p)},i(g){l||(L(i.$$.fragment,g),L(a.$$.fragment,g),l=!0)},o(g){j(i.$$.fragment,g),j(a.$$.fragment,g),l=!1},d(g){g&&S(e),xe(i),xe(a),c=!1,h()}}}function fA(n){let e,t,i,s,r,a,o;return{c(){e=te("button"),t=nt("svg"),i=nt("path"),this.h()},l(l){e=ne(l,"BUTTON",{class:!0,title:!0});var c=V(e);t=it(c,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var h=V(t);i=it(h,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),V(i).forEach(S),h.forEach(S),c.forEach(S),this.h()},h(){A(i,"stroke-linecap","round"),A(i,"stroke-linejoin","round"),A(i,"d","m19.5 8.25-7.5 7.5-7.5-7.5"),A(t,"xmlns","http://www.w3.org/2000/svg"),A(t,"fill","none"),A(t,"viewBox","0 0 24 24"),A(t,"stroke-width","2.5"),A(t,"stroke","currentColor"),A(t,"class",s="size-3 transition-transform duration-200 "+(n[10]?"rotate-180":"")+" text-gray-300 dark:text-gray-600"),A(e,"class","flex w-full justify-center items-center text-sm font-medium cursor-pointer rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800"),A(e,"title",r=n[10]?n[12].t("Show Less"):n[12].t("Show All"))},m(l,c){ee(l,e,c),q(e,t),q(t,i),a||(o=pt(e,"click",n[23]),a=!0)},p(l,c){c[0]&1024&&s!==(s="size-3 transition-transform duration-200 "+(l[10]?"rotate-180":"")+" text-gray-300 dark:text-gray-600")&&A(t,"class",s),c[0]&5120&&r!==(r=l[10]?l[12].t("Show Less"):l[12].t("Show All"))&&A(e,"title",r)},d(l){l&&S(e),a=!1,o()}}}function Nee(n){let e,t,i,s=n[12].t("Capture")+"",r,a;return e=new ID({}),{c(){pe(e.$$.fragment),t=Ae(),i=te("div"),r=_t(s),this.h()},l(o){ye(e.$$.fragment,o),t=Se(o),i=ne(o,"DIV",{class:!0});var l=V(i);r=vt(l,s),l.forEach(S),this.h()},h(){A(i,"class","line-clamp-1")},m(o,l){be(e,o,l),ee(o,t,l),ee(o,i,l),q(i,r),a=!0},p(o,l){(!a||l[0]&4096)&&s!==(s=o[12].t("Capture")+"")&&St(r,s)},i(o){a||(L(e.$$.fragment,o),a=!0)},o(o){j(e.$$.fragment,o),a=!1},d(o){o&&(S(t),S(i)),xe(e,o)}}}function Oee(n){let e,t;return e=new ba({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  font-medium cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800  rounded-xl "+(n[11]?"":"opacity-50"),$$slots:{default:[Nee]},$$scope:{ctx:n}}}),e.$on("click",n[24]),{c(){pe(e.$$.fragment)},l(i){ye(e.$$.fragment,i)},m(i,s){be(e,i,s),t=!0},p(i,s){const r={};s[0]&2048&&(r.class="flex gap-2 items-center px-3 py-2 text-sm  font-medium cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800  rounded-xl "+(i[11]?"":"opacity-50")),s[0]&4096|s[1]&1&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(L(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){xe(e,i)}}}function Dee(n){let e,t,i,s=n[12].t("Upload Files")+"",r,a;return e=new ED({}),{c(){pe(e.$$.fragment),t=Ae(),i=te("div"),r=_t(s),this.h()},l(o){ye(e.$$.fragment,o),t=Se(o),i=ne(o,"DIV",{class:!0});var l=V(i);r=vt(l,s),l.forEach(S),this.h()},h(){A(i,"class","line-clamp-1")},m(o,l){be(e,o,l),ee(o,t,l),ee(o,i,l),q(i,r),a=!0},p(o,l){(!a||l[0]&4096)&&s!==(s=o[12].t("Upload Files")+"")&&St(r,s)},i(o){a||(L(e.$$.fragment,o),a=!0)},o(o){j(e.$$.fragment,o),a=!1},d(o){o&&(S(t),S(i)),xe(e,o)}}}function Fee(n){let e,t;return e=new ba({props:{class:"flex gap-2 items-center px-3 py-2 text-sm font-medium cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl "+(n[11]?"":"opacity-50"),$$slots:{default:[Dee]},$$scope:{ctx:n}}}),e.$on("click",n[25]),{c(){pe(e.$$.fragment)},l(i){ye(e.$$.fragment,i)},m(i,s){be(e,i,s),t=!0},p(i,s){const r={};s[0]&2048&&(r.class="flex gap-2 items-center px-3 py-2 text-sm font-medium cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl "+(i[11]?"":"opacity-50")),s[0]&4096|s[1]&1&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(L(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){xe(e,i)}}}function gA(n){var a,o,l,c;let e,t,i,s=((o=(a=n[13])==null?void 0:a.features)==null?void 0:o.enable_google_drive_integration)&&mA(n),r=((c=(l=n[13])==null?void 0:l.features)==null?void 0:c.enable_onedrive_integration)&&pA(n);return{c(){s&&s.c(),e=Ae(),r&&r.c(),t=Ut()},l(h){s&&s.l(h),e=Se(h),r&&r.l(h),t=Ut()},m(h,u){s&&s.m(h,u),ee(h,e,u),r&&r.m(h,u),ee(h,t,u),i=!0},p(h,u){var d,f,g,m;(f=(d=h[13])==null?void 0:d.features)!=null&&f.enable_google_drive_integration?s?(s.p(h,u),u[0]&8192&&L(s,1)):(s=mA(h),s.c(),L(s,1),s.m(e.parentNode,e)):s&&(ot(),j(s,1,1,()=>{s=null}),lt()),(m=(g=h[13])==null?void 0:g.features)!=null&&m.enable_onedrive_integration?r?(r.p(h,u),u[0]&8192&&L(r,1)):(r=pA(h),r.c(),L(r,1),r.m(t.parentNode,t)):r&&(ot(),j(r,1,1,()=>{r=null}),lt())},i(h){i||(L(s),L(r),i=!0)},o(h){j(s),j(r),i=!1},d(h){h&&(S(e),S(t)),s&&s.d(h),r&&r.d(h)}}}function mA(n){let e,t;return e=new ba({props:{class:"flex gap-2 items-center px-3 py-2 text-sm font-medium cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl",$$slots:{default:[Lee]},$$scope:{ctx:n}}}),e.$on("click",n[26]),{c(){pe(e.$$.fragment)},l(i){ye(e.$$.fragment,i)},m(i,s){be(e,i,s),t=!0},p(i,s){const r={};s[0]&4096|s[1]&1&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(L(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){xe(e,i)}}}function Lee(n){let e,t,i,s,r,a,o,l,c,h=n[12].t("Google Drive")+"",u;return{c(){e=nt("svg"),t=nt("path"),i=nt("path"),s=nt("path"),r=nt("path"),a=nt("path"),o=nt("path"),l=Ae(),c=te("div"),u=_t(h),this.h()},l(d){e=it(d,"svg",{xmlns:!0,viewBox:!0,class:!0});var f=V(e);t=it(f,"path",{d:!0,fill:!0}),V(t).forEach(S),i=it(f,"path",{d:!0,fill:!0}),V(i).forEach(S),s=it(f,"path",{d:!0,fill:!0}),V(s).forEach(S),r=it(f,"path",{d:!0,fill:!0}),V(r).forEach(S),a=it(f,"path",{d:!0,fill:!0}),V(a).forEach(S),o=it(f,"path",{d:!0,fill:!0}),V(o).forEach(S),f.forEach(S),l=Se(d),c=ne(d,"DIV",{class:!0});var g=V(c);u=vt(g,h),g.forEach(S),this.h()},h(){A(t,"d","m6.6 66.85 3.85 6.65c.8 1.4 1.95 2.5 3.3 3.3l13.75-23.8h-27.5c0 1.55.4 3.1 1.2 4.5z"),A(t,"fill","#0066da"),A(i,"d","m43.65 25-13.75-23.8c-1.35.8-2.5 1.9-3.3 3.3l-25.4 44a9.06 9.06 0 0 0 -1.2 4.5h27.5z"),A(i,"fill","#00ac47"),A(s,"d","m73.55 76.8c1.35-.8 2.5-1.9 3.3-3.3l1.6-2.75 7.65-13.25c.8-1.4 1.2-2.95 1.2-4.5h-27.502l5.852 11.5z"),A(s,"fill","#ea4335"),A(r,"d","m43.65 25 13.75-23.8c-1.35-.8-2.9-1.2-4.5-1.2h-18.5c-1.6 0-3.15.45-4.5 1.2z"),A(r,"fill","#00832d"),A(a,"d","m59.8 53h-32.3l-13.75 23.8c1.35.8 2.9 1.2 4.5 1.2h50.8c1.6 0 3.15-.45 4.5-1.2z"),A(a,"fill","#2684fc"),A(o,"d","m73.4 26.5-12.7-22c-.8-1.4-1.95-2.5-3.3-3.3l-13.75 23.8 16.15 28h27.45c0-1.55-.4-3.1-1.2-4.5z"),A(o,"fill","#ffba00"),A(e,"xmlns","http://www.w3.org/2000/svg"),A(e,"viewBox","0 0 87.3 78"),A(e,"class","w-5 h-5"),A(c,"class","line-clamp-1")},m(d,f){ee(d,e,f),q(e,t),q(e,i),q(e,s),q(e,r),q(e,a),q(e,o),ee(d,l,f),ee(d,c,f),q(c,u)},p(d,f){f[0]&4096&&h!==(h=d[12].t("Google Drive")+"")&&St(u,h)},d(d){d&&(S(e),S(l),S(c))}}}function pA(n){let e,t;return e=new KI({props:{$$slots:{default:[jee]},$$scope:{ctx:n}}}),{c(){pe(e.$$.fragment)},l(i){ye(e.$$.fragment,i)},m(i,s){be(e,i,s),t=!0},p(i,s){const r={};s[0]&20544|s[1]&1&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(L(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){xe(e,i)}}}function Bee(n){let e,t,i,s,r,a,o,l,c,h,u,d,f,g,m,b,p,y,w,_,v,C,k,I=n[12].t("Microsoft OneDrive")+"",E;return{c(){e=nt("svg"),t=nt("mask"),i=nt("path"),s=nt("g"),r=nt("path"),a=nt("path"),o=nt("path"),l=nt("path"),c=nt("defs"),h=nt("linearGradient"),u=nt("stop"),d=nt("stop"),f=nt("linearGradient"),g=nt("stop"),m=nt("stop"),b=nt("linearGradient"),p=nt("stop"),y=nt("stop"),w=nt("linearGradient"),_=nt("stop"),v=nt("stop"),C=Ae(),k=te("div"),E=_t(I),this.h()},l(T){e=it(T,"svg",{xmlns:!0,viewBox:!0,class:!0,fill:!0});var M=V(e);t=it(M,"mask",{id:!0,style:!0,maskUnits:!0,x:!0,y:!0,width:!0,height:!0});var D=V(t);i=it(D,"path",{d:!0,fill:!0}),V(i).forEach(S),D.forEach(S),s=it(M,"g",{mask:!0});var H=V(s);r=it(H,"path",{d:!0,fill:!0}),V(r).forEach(S),a=it(H,"path",{d:!0,fill:!0}),V(a).forEach(S),o=it(H,"path",{d:!0,fill:!0}),V(o).forEach(S),l=it(H,"path",{d:!0,fill:!0}),V(l).forEach(S),H.forEach(S),c=it(M,"defs",{});var R=V(c);h=it(R,"linearGradient",{id:!0,x1:!0,y1:!0,x2:!0,y2:!0,gradientUnits:!0});var z=V(h);u=it(z,"stop",{"stop-color":!0}),V(u).forEach(S),d=it(z,"stop",{offset:!0,"stop-color":!0}),V(d).forEach(S),z.forEach(S),f=it(R,"linearGradient",{id:!0,x1:!0,y1:!0,x2:!0,y2:!0,gradientUnits:!0});var P=V(f);g=it(P,"stop",{"stop-color":!0}),V(g).forEach(S),m=it(P,"stop",{offset:!0,"stop-color":!0}),V(m).forEach(S),P.forEach(S),b=it(R,"linearGradient",{id:!0,x1:!0,y1:!0,x2:!0,y2:!0,gradientUnits:!0});var B=V(b);p=it(B,"stop",{"stop-color":!0}),V(p).forEach(S),y=it(B,"stop",{offset:!0,"stop-color":!0}),V(y).forEach(S),B.forEach(S),w=it(R,"linearGradient",{id:!0,x1:!0,y1:!0,x2:!0,y2:!0,gradientUnits:!0});var Z=V(w);_=it(Z,"stop",{"stop-color":!0}),V(_).forEach(S),v=it(Z,"stop",{offset:!0,"stop-color":!0}),V(v).forEach(S),Z.forEach(S),R.forEach(S),M.forEach(S),C=Se(T),k=ne(T,"DIV",{class:!0});var G=V(k);E=vt(G,I),G.forEach(S),this.h()},h(){A(i,"d","M7.82979 26C3.50549 26 0 22.5675 0 18.3333C0 14.1921 3.35322 10.8179 7.54613 10.6716C9.27535 7.87166 12.4144 6 16 6C20.6308 6 24.5169 9.12183 25.5829 13.3335C29.1316 13.3603 32 16.1855 32 19.6667C32 23.0527 29 26 25.8723 25.9914L7.82979 26Z"),A(i,"fill","#C4C4C4"),A(t,"id","mask0_87_7796"),rn(t,"mask-type","alpha"),A(t,"maskUnits","userSpaceOnUse"),A(t,"x","0"),A(t,"y","6"),A(t,"width","32"),A(t,"height","20"),A(r,"d","M7.83017 26.0001C5.37824 26.0001 3.18957 24.8966 1.75391 23.1691L18.0429 16.3335L30.7089 23.4647C29.5926 24.9211 27.9066 26.0001 26.0004 25.9915C23.1254 26.0001 12.0629 26.0001 7.83017 26.0001Z"),A(r,"fill","url(#paint0_linear_87_7796)"),A(a,"d","M25.5785 13.3149L18.043 16.3334L30.709 23.4647C31.5199 22.4065 32.0004 21.0916 32.0004 19.6669C32.0004 16.1857 29.1321 13.3605 25.5833 13.3337C25.5817 13.3274 25.5801 13.3212 25.5785 13.3149Z"),A(a,"fill","url(#paint1_linear_87_7796)"),A(o,"d","M7.06445 10.7028L18.0423 16.3333L25.5779 13.3148C24.5051 9.11261 20.6237 6 15.9997 6C12.4141 6 9.27508 7.87166 7.54586 10.6716C7.3841 10.6773 7.22358 10.6877 7.06445 10.7028Z"),A(o,"fill","url(#paint2_linear_87_7796)"),A(l,"d","M1.7535 23.1687L18.0425 16.3331L7.06471 10.7026C3.09947 11.0792 0 14.3517 0 18.3331C0 20.1665 0.657197 21.8495 1.7535 23.1687Z"),A(l,"fill","url(#paint3_linear_87_7796)"),A(s,"mask","url(#mask0_87_7796)"),A(u,"stop-color","#2086B8"),A(d,"offset","1"),A(d,"stop-color","#46D3F6"),A(h,"id","paint0_linear_87_7796"),A(h,"x1","4.42591"),A(h,"y1","24.6668"),A(h,"x2","27.2309"),A(h,"y2","23.2764"),A(h,"gradientUnits","userSpaceOnUse"),A(g,"stop-color","#1694DB"),A(m,"offset","1"),A(m,"stop-color","#62C3FE"),A(f,"id","paint1_linear_87_7796"),A(f,"x1","23.8302"),A(f,"y1","19.6668"),A(f,"x2","30.2108"),A(f,"y2","15.2082"),A(f,"gradientUnits","userSpaceOnUse"),A(p,"stop-color","#0D3D78"),A(y,"offset","1"),A(y,"stop-color","#063B83"),A(b,"id","paint2_linear_87_7796"),A(b,"x1","8.51037"),A(b,"y1","7.33333"),A(b,"x2","23.3335"),A(b,"y2","15.9348"),A(b,"gradientUnits","userSpaceOnUse"),A(_,"stop-color","#16589B"),A(v,"offset","1"),A(v,"stop-color","#1464B7"),A(w,"id","paint3_linear_87_7796"),A(w,"x1","-0.340429"),A(w,"y1","19.9998"),A(w,"x2","14.5634"),A(w,"y2","14.4649"),A(w,"gradientUnits","userSpaceOnUse"),A(e,"xmlns","http://www.w3.org/2000/svg"),A(e,"viewBox","0 0 32 32"),A(e,"class","w-5 h-5"),A(e,"fill","none"),A(k,"class","line-clamp-1")},m(T,M){ee(T,e,M),q(e,t),q(t,i),q(e,s),q(s,r),q(s,a),q(s,o),q(s,l),q(e,c),q(c,h),q(h,u),q(h,d),q(c,f),q(f,g),q(f,m),q(c,b),q(b,p),q(b,y),q(c,w),q(w,_),q(w,v),ee(T,C,M),ee(T,k,M),q(k,E)},p(T,M){M[0]&4096&&I!==(I=T[12].t("Microsoft OneDrive")+"")&&St(E,I)},d(T){T&&(S(e),S(C),S(k))}}}function Uee(n){let e,t=n[12].t("Microsoft OneDrive (personal)")+"",i;return{c(){e=te("div"),i=_t(t),this.h()},l(s){e=ne(s,"DIV",{class:!0});var r=V(e);i=vt(r,t),r.forEach(S),this.h()},h(){A(e,"class","line-clamp-1")},m(s,r){ee(s,e,r),q(e,i)},p(s,r){r[0]&4096&&t!==(t=s[12].t("Microsoft OneDrive (personal)")+"")&&St(i,t)},d(s){s&&S(e)}}}function Hee(n){let e,t,i=n[12].t("Microsoft OneDrive (work/school)")+"",s,r,a,o="Includes SharePoint";return{c(){e=te("div"),t=te("div"),s=_t(i),r=Ae(),a=te("div"),a.textContent=o,this.h()},l(l){e=ne(l,"DIV",{class:!0});var c=V(e);t=ne(c,"DIV",{class:!0});var h=V(t);s=vt(h,i),h.forEach(S),r=Se(c),a=ne(c,"DIV",{class:!0,"data-svelte-h":!0}),Ro(a)!=="svelte-1rwtj43"&&(a.textContent=o),c.forEach(S),this.h()},h(){A(t,"class","line-clamp-1"),A(a,"class","text-xs text-gray-500"),A(e,"class","flex flex-col")},m(l,c){ee(l,e,c),q(e,t),q(t,s),q(e,r),q(e,a)},p(l,c){c[0]&4096&&i!==(i=l[12].t("Microsoft OneDrive (work/school)")+"")&&St(s,i)},d(l){l&&S(e)}}}function zee(n){let e,t,i,s;return e=new ba({props:{class:"flex gap-2 items-center px-3 py-2 text-sm font-medium cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl",$$slots:{default:[Uee]},$$scope:{ctx:n}}}),e.$on("click",n[27]),i=new ba({props:{class:"flex gap-2 items-center px-3 py-2 text-sm font-medium cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl",$$slots:{default:[Hee]},$$scope:{ctx:n}}}),i.$on("click",n[28]),{c(){pe(e.$$.fragment),t=Ae(),pe(i.$$.fragment)},l(r){ye(e.$$.fragment,r),t=Se(r),ye(i.$$.fragment,r)},m(r,a){be(e,r,a),ee(r,t,a),be(i,r,a),s=!0},p(r,a){const o={};a[0]&4096|a[1]&1&&(o.$$scope={dirty:a,ctx:r}),e.$set(o);const l={};a[0]&4096|a[1]&1&&(l.$$scope={dirty:a,ctx:r}),i.$set(l)},i(r){s||(L(e.$$.fragment,r),L(i.$$.fragment,r),s=!0)},o(r){j(e.$$.fragment,r),j(i.$$.fragment,r),s=!1},d(r){r&&S(t),xe(e,r),xe(i,r)}}}function jee(n){let e,t,i,s;return e=new XI({props:{class:"flex gap-2 items-center px-3 py-2 text-sm font-medium cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl w-full",$$slots:{default:[Bee]},$$scope:{ctx:n}}}),i=new YI({props:{class:"w-[calc(100vw-2rem)] max-w-[280px] rounded-xl px-1 py-1 border border-gray-300/30 dark:border-gray-700/50 z-50 bg-white dark:bg-gray-850 dark:text-white shadow-sm",side:n[14]?"bottom":"right",sideOffset:n[14]?5:0,alignOffset:n[14]?0:-8,$$slots:{default:[zee]},$$scope:{ctx:n}}}),{c(){pe(e.$$.fragment),t=Ae(),pe(i.$$.fragment)},l(r){ye(e.$$.fragment,r),t=Se(r),ye(i.$$.fragment,r)},m(r,a){be(e,r,a),ee(r,t,a),be(i,r,a),s=!0},p(r,a){const o={};a[0]&4096|a[1]&1&&(o.$$scope={dirty:a,ctx:r}),e.$set(o);const l={};a[0]&16384&&(l.side=r[14]?"bottom":"right"),a[0]&16384&&(l.sideOffset=r[14]?5:0),a[0]&16384&&(l.alignOffset=r[14]?0:-8),a[0]&4160|a[1]&1&&(l.$$scope={dirty:a,ctx:r}),i.$set(l)},i(r){s||(L(e.$$.fragment,r),L(i.$$.fragment,r),s=!0)},o(r){j(e.$$.fragment,r),j(i.$$.fragment,r),s=!1},d(r){r&&S(t),xe(e,r),xe(i,r)}}}function Gee(n){let e=Object.keys(n[9]).length>0,t,i,s,r,a,o,l,c=e&&uA(n);i=new Ci({props:{content:n[2].length!==n[1].length?n[12].t("Model(s) do not support file upload"):n[11]?"":n[12].t("You do not have permission to upload files."),className:"w-full",$$slots:{default:[Oee]},$$scope:{ctx:n}}}),r=new Ci({props:{content:n[2].length!==n[1].length?n[12].t("Model(s) do not support file upload"):n[11]?"":n[12].t("You do not have permission to upload files."),className:"w-full",$$slots:{default:[Fee]},$$scope:{ctx:n}}});let h=n[11]&&gA(n);return{c(){c&&c.c(),t=Ae(),pe(i.$$.fragment),s=Ae(),pe(r.$$.fragment),a=Ae(),h&&h.c(),o=Ut()},l(u){c&&c.l(u),t=Se(u),ye(i.$$.fragment,u),s=Se(u),ye(r.$$.fragment,u),a=Se(u),h&&h.l(u),o=Ut()},m(u,d){c&&c.m(u,d),ee(u,t,d),be(i,u,d),ee(u,s,d),be(r,u,d),ee(u,a,d),h&&h.m(u,d),ee(u,o,d),l=!0},p(u,d){d[0]&512&&(e=Object.keys(u[9]).length>0),e?c?(c.p(u,d),d[0]&512&&L(c,1)):(c=uA(u),c.c(),L(c,1),c.m(t.parentNode,t)):c&&(ot(),j(c,1,1,()=>{c=null}),lt());const f={};d[0]&6150&&(f.content=u[2].length!==u[1].length?u[12].t("Model(s) do not support file upload"):u[11]?"":u[12].t("You do not have permission to upload files.")),d[0]&6152|d[1]&1&&(f.$$scope={dirty:d,ctx:u}),i.$set(f);const g={};d[0]&6150&&(g.content=u[2].length!==u[1].length?u[12].t("Model(s) do not support file upload"):u[11]?"":u[12].t("You do not have permission to upload files.")),d[0]&6160|d[1]&1&&(g.$$scope={dirty:d,ctx:u}),r.$set(g),u[11]?h?(h.p(u,d),d[0]&2048&&L(h,1)):(h=gA(u),h.c(),L(h,1),h.m(o.parentNode,o)):h&&(ot(),j(h,1,1,()=>{h=null}),lt())},i(u){l||(L(c),L(i.$$.fragment,u),L(r.$$.fragment,u),L(h),l=!0)},o(u){j(c),j(i.$$.fragment,u),j(r.$$.fragment,u),j(h),l=!1},d(u){u&&(S(t),S(s),S(a),S(o)),c&&c.d(u),xe(i,u),xe(r,u),h&&h.d(u)}}}function Vee(n){let e,t,i;return t=new h4({props:{class:"w-full max-w-[240px] rounded-xl px-1 py-1 border border-gray-300/30 dark:border-gray-700/50 z-50 bg-white dark:bg-gray-850 dark:text-white shadow-sm",sideOffset:10,alignOffset:-8,side:"top",align:"start",transition:Q5,$$slots:{default:[Gee]},$$scope:{ctx:n}}}),{c(){e=te("div"),pe(t.$$.fragment),this.h()},l(s){e=ne(s,"DIV",{slot:!0});var r=V(e);ye(t.$$.fragment,r),r.forEach(S),this.h()},h(){A(e,"slot","content")},m(s,r){ee(s,e,r),be(t,e,null),i=!0},p(s,r){const a={};r[0]&32383|r[1]&1&&(a.$$scope={dirty:r,ctx:s}),t.$set(a)},i(s){i||(L(t.$$.fragment,s),i=!0)},o(s){j(t.$$.fragment,s),i=!1},d(s){s&&S(e),xe(t)}}}function qee(n){let e,t,i,s,r,a,o;function l(h){n[29](h)}let c={$$slots:{content:[Vee],default:[Mee]},$$scope:{ctx:n}};return n[8]!==void 0&&(c.show=n[8]),i=new u4({props:c}),At.push(()=>qt(i,"show",l)),i.$on("change",n[30]),{c(){e=te("input"),t=Ae(),pe(i.$$.fragment),this.h()},l(h){e=ne(h,"INPUT",{id:!0,type:!0,accept:!0,capture:!0,style:!0}),t=Se(h),ye(i.$$.fragment,h),this.h()},h(){A(e,"id","camera-input"),A(e,"type","file"),A(e,"accept","image/*"),A(e,"capture","environment"),rn(e,"display","none")},m(h,u){ee(h,e,u),ee(h,t,u),be(i,h,u),r=!0,a||(o=pt(e,"change",n[17]),a=!0)},p(h,u){const d={};u[0]&32383|u[1]&1&&(d.$$scope={dirty:u,ctx:h}),!s&&u[0]&256&&(s=!0,d.show=h[8],Wt(()=>s=!1)),i.$set(d)},i(h){r||(L(i.$$.fragment,h),r=!0)},o(h){j(i.$$.fragment,h),r=!1},d(h){h&&(S(e),S(t)),xe(i,h),a=!1,o()}}}function Wee(n,e,t){let i,s,r,a,o;Pe(n,Jd,J=>t(32,i=J)),Pe(n,T0,J=>t(19,s=J)),Pe(n,$g,J=>t(13,a=J)),Pe(n,cx,J=>t(14,o=J));let{$$slots:l={},$$scope:c}=e;const h=hs("i18n");Pe(n,h,J=>t(12,r=J));let{selectedToolIds:u=[]}=e,{selectedModels:d=[]}=e,{fileUploadCapableModels:f=[]}=e,{screenCaptureHandler:g}=e,{uploadFilesHandler:m}=e,{inputFilesHandler:b}=e,{uploadGoogleDriveHandler:p}=e,{uploadOneDriveHandler:y}=e,{onClose:w}=e,_={},v=!1,C=!1,k=!0;const I=async()=>{i===null&&await Jd.set(await c4(localStorage.token)),t(9,_=i.reduce((J,se,fe,he)=>(J[se.id]={name:se.name,description:se.meta.description,enabled:u.includes(se.id)},J),{}))},E=()=>{const J=navigator.userAgent||navigator.vendor||window.opera;return/android|iphone|ipad|ipod|windows phone/i.test(J)};function T(J){var fe;const se=Array.from((fe=J.target)==null?void 0:fe.files);se&&se.length>0&&b(se)}const M=async(J,se)=>{const fe=se.detail;await hn(),fe?t(0,u=[...u,J]):t(0,u=u.filter(he=>he!==J))},D=J=>{t(9,_[J].enabled=!_[J].enabled,_)},H=()=>{t(10,C=!C)},R=()=>{if(k)if(!E())g();else{const J=document.getElementById("camera-input");J&&J.click()}},z=()=>{k&&m()},P=()=>{p()},B=()=>{y("personal")},Z=()=>{y("organizations")};function G(J){v=J,t(8,v)}const Y=J=>{J.detail===!1&&w()};return n.$$set=J=>{"selectedToolIds"in J&&t(0,u=J.selectedToolIds),"selectedModels"in J&&t(1,d=J.selectedModels),"fileUploadCapableModels"in J&&t(2,f=J.fileUploadCapableModels),"screenCaptureHandler"in J&&t(3,g=J.screenCaptureHandler),"uploadFilesHandler"in J&&t(4,m=J.uploadFilesHandler),"inputFilesHandler"in J&&t(18,b=J.inputFilesHandler),"uploadGoogleDriveHandler"in J&&t(5,p=J.uploadGoogleDriveHandler),"uploadOneDriveHandler"in J&&t(6,y=J.uploadOneDriveHandler),"onClose"in J&&t(7,w=J.onClose),"$$scope"in J&&t(31,c=J.$$scope)},n.$$.update=()=>{var J,se;n.$$.dirty[0]&256&&v&&I(),n.$$.dirty[0]&524294&&t(11,k=f.length===d.length&&((s==null?void 0:s.role)==="admin"||((se=(J=s==null?void 0:s.permissions)==null?void 0:J.chat)==null?void 0:se.file_upload)))},[u,d,f,g,m,p,y,w,v,_,C,k,r,a,o,h,E,T,b,s,l,M,D,H,R,z,P,B,Z,G,Y,c]}class Kee extends Nt{constructor(e){super(),Ot(this,e,Wee,qee,Ft,{selectedToolIds:0,selectedModels:1,fileUploadCapableModels:2,screenCaptureHandler:3,uploadFilesHandler:4,inputFilesHandler:18,uploadGoogleDriveHandler:5,uploadOneDriveHandler:6,onClose:7},null,[-1,-1])}}function bA(n,e,t){const i=n.slice();return i[9]=e[t],i}function xA(n,e,t){const i=n.slice();return i[12]=e[t],i}function yA(n,e,t){const i=n.slice();return i[15]=e[t],i}function wA(n){let e,t,i,s,r=n[3].length>0&&_A(n),a=Qn(n[1]),o=[];for(let c=0;c<a.length;c+=1)o[c]=kA(yA(n,a,c));const l=c=>j(o[c],1,1,()=>{o[c]=null});return{c(){r&&r.c(),e=Ae(),t=te("div"),i=te("div");for(let c=0;c<o.length;c+=1)o[c].c();this.h()},l(c){r&&r.l(c),e=Se(c),t=ne(c,"DIV",{class:!0});var h=V(t);i=ne(h,"DIV",{class:!0});var u=V(i);for(let d=0;d<o.length;d+=1)o[d].l(u);u.forEach(S),h.forEach(S),this.h()},h(){A(i,"class","text-sm dark:text-gray-300 mb-1"),A(t,"class","px-5 pb-3 w-full flex flex-col justify-center")},m(c,h){r&&r.m(c,h),ee(c,e,h),ee(c,t,h),q(t,i);for(let u=0;u<o.length;u+=1)o[u]&&o[u].m(i,null);s=!0},p(c,h){if(c[3].length>0?r?r.p(c,h):(r=_A(c),r.c(),r.m(e.parentNode,e)):r&&(r.d(1),r=null),h&2){a=Qn(c[1]);let u;for(u=0;u<a.length;u+=1){const d=yA(c,a,u);o[u]?(o[u].p(d,h),L(o[u],1)):(o[u]=kA(d),o[u].c(),L(o[u],1),o[u].m(i,null))}for(ot(),u=a.length;u<o.length;u+=1)l(u);lt()}},i(c){if(!s){for(let h=0;h<a.length;h+=1)L(o[h]);s=!0}},o(c){o=o.filter(Boolean);for(let h=0;h<o.length;h+=1)j(o[h]);s=!1},d(c){c&&(S(e),S(t)),r&&r.d(c),To(o,c)}}}function _A(n){let e,t,i=n[2].t("Tools")+"",s;return{c(){e=te("div"),t=te("div"),s=_t(i),this.h()},l(r){e=ne(r,"DIV",{class:!0});var a=V(e);t=ne(a,"DIV",{class:!0});var o=V(t);s=vt(o,i),o.forEach(S),a.forEach(S),this.h()},h(){A(t,"class","text-base font-medium self-center"),A(e,"class","flex justify-between dark:text-gray-300 px-5 pb-1")},m(r,a){ee(r,e,a),q(e,t),q(t,s)},p(r,a){a&4&&i!==(i=r[2].t("Tools")+"")&&St(s,i)},d(r){r&&S(e)}}}function vA(n){var s,r;let e,t=((r=(s=n[15])==null?void 0:s.meta)==null?void 0:r.description)+"",i;return{c(){e=te("div"),i=_t(t),this.h()},l(a){e=ne(a,"DIV",{class:!0});var o=V(e);i=vt(o,t),o.forEach(S),this.h()},h(){A(e,"class","text-xs text-gray-500")},m(a,o){ee(a,e,o),q(e,i)},p(a,o){var l,c;o&2&&t!==(t=((c=(l=a[15])==null?void 0:l.meta)==null?void 0:c.description)+"")&&St(i,t)},d(a){a&&S(e)}}}function Xee(n){var l,c,h;let e,t,i=((l=n[15])==null?void 0:l.name)+"",s,r,a,o=((h=(c=n[15])==null?void 0:c.meta)==null?void 0:h.description)&&vA(n);return{c(){e=te("div"),t=te("div"),s=_t(i),r=Ae(),o&&o.c(),a=Ae(),this.h()},l(u){e=ne(u,"DIV",{});var d=V(e);t=ne(d,"DIV",{class:!0});var f=V(t);s=vt(f,i),f.forEach(S),r=Se(d),o&&o.l(d),d.forEach(S),a=Se(u),this.h()},h(){A(t,"class","text-sm font-medium dark:text-gray-100 text-gray-800")},m(u,d){ee(u,e,d),q(e,t),q(t,s),q(e,r),o&&o.m(e,null),ee(u,a,d)},p(u,d){var f,g,m;d&2&&i!==(i=((f=u[15])==null?void 0:f.name)+"")&&St(s,i),(m=(g=u[15])==null?void 0:g.meta)!=null&&m.description?o?o.p(u,d):(o=vA(u),o.c(),o.m(e,null)):o&&(o.d(1),o=null)},d(u){u&&(S(e),S(a)),o&&o.d()}}}function kA(n){let e,t;return e=new Qg({props:{buttonClassName:"w-full mb-0.5",$$slots:{default:[Xee]},$$scope:{ctx:n}}}),{c(){pe(e.$$.fragment)},l(i){ye(e.$$.fragment,i)},m(i,s){be(e,i,s),t=!0},p(i,s){const r={};s&262146&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(L(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){xe(e,i)}}}function CA(n){let e,t,i=n[2].t("Tool Servers")+"",s,r,a,o,l=n[2].t("Open WebUI can use tools provided by any OpenAPI server.")+"",c,h,u,d,f=n[2].t("Learn more about OpenAPI tool servers.")+"",g,m,b,p,y=Qn(n[3]),w=[];for(let v=0;v<y.length;v+=1)w[v]=SA(bA(n,y,v));const _=v=>j(w[v],1,1,()=>{w[v]=null});return{c(){e=te("div"),t=te("div"),s=_t(i),r=Ae(),a=te("div"),o=te("div"),c=_t(l),h=Ae(),u=te("br"),d=te("a"),g=_t(f),m=Ae(),b=te("div");for(let v=0;v<w.length;v+=1)w[v].c();this.h()},l(v){e=ne(v,"DIV",{class:!0});var C=V(e);t=ne(C,"DIV",{class:!0});var k=V(t);s=vt(k,i),k.forEach(S),C.forEach(S),r=Se(v),a=ne(v,"DIV",{class:!0});var I=V(a);o=ne(I,"DIV",{class:!0});var E=V(o);c=vt(E,l),h=Se(E),u=ne(E,"BR",{}),d=ne(E,"A",{class:!0,href:!0,target:!0});var T=V(d);g=vt(T,f),T.forEach(S),E.forEach(S),m=Se(I),b=ne(I,"DIV",{class:!0});var M=V(b);for(let D=0;D<w.length;D+=1)w[D].l(M);M.forEach(S),I.forEach(S),this.h()},h(){A(t,"class","text-base font-medium self-center"),A(e,"class","flex justify-between dark:text-gray-300 px-5 pb-0.5"),A(d,"class","underline"),A(d,"href","https://github.com/open-webui/openapi-servers"),A(d,"target","_blank"),A(o,"class","text-xs text-gray-600 dark:text-gray-300 mb-2"),A(b,"class","text-sm dark:text-gray-300 mb-1"),A(a,"class","px-5 pb-5 w-full flex flex-col justify-center")},m(v,C){ee(v,e,C),q(e,t),q(t,s),ee(v,r,C),ee(v,a,C),q(a,o),q(o,c),q(o,h),q(o,u),q(o,d),q(d,g),q(a,m),q(a,b);for(let k=0;k<w.length;k+=1)w[k]&&w[k].m(b,null);p=!0},p(v,C){if((!p||C&4)&&i!==(i=v[2].t("Tool Servers")+"")&&St(s,i),(!p||C&4)&&l!==(l=v[2].t("Open WebUI can use tools provided by any OpenAPI server.")+"")&&St(c,l),(!p||C&4)&&f!==(f=v[2].t("Learn more about OpenAPI tool servers.")+"")&&St(g,f),C&8){y=Qn(v[3]);let k;for(k=0;k<y.length;k+=1){const I=bA(v,y,k);w[k]?(w[k].p(I,C),L(w[k],1)):(w[k]=SA(I),w[k].c(),L(w[k],1),w[k].m(b,null))}for(ot(),k=y.length;k<w.length;k+=1)_(k);lt()}},i(v){if(!p){for(let C=0;C<y.length;C+=1)L(w[C]);p=!0}},o(v){w=w.filter(Boolean);for(let C=0;C<w.length;C+=1)j(w[C]);p=!1},d(v){v&&(S(e),S(r),S(a)),To(w,v)}}}function Yee(n){var p,y,w,_,v,C,k,I,E,T;let e,t,i=((w=(y=(p=n[9])==null?void 0:p.openapi)==null?void 0:y.info)==null?void 0:w.title)+"",s,r,a=((C=(v=(_=n[9])==null?void 0:_.openapi)==null?void 0:v.info)==null?void 0:C.version)+"",o,l,c,h=((E=(I=(k=n[9])==null?void 0:k.openapi)==null?void 0:I.info)==null?void 0:E.description)+"",u,d,f,g=((T=n[9])==null?void 0:T.url)+"",m,b;return{c(){e=te("div"),t=te("div"),s=_t(i),r=_t(" - v"),o=_t(a),l=Ae(),c=te("div"),u=_t(h),d=Ae(),f=te("div"),m=_t(g),b=Ae(),this.h()},l(M){e=ne(M,"DIV",{});var D=V(e);t=ne(D,"DIV",{class:!0});var H=V(t);s=vt(H,i),r=vt(H," - v"),o=vt(H,a),H.forEach(S),l=Se(D),c=ne(D,"DIV",{class:!0});var R=V(c);u=vt(R,h),R.forEach(S),d=Se(D),f=ne(D,"DIV",{class:!0});var z=V(f);m=vt(z,g),z.forEach(S),D.forEach(S),b=Se(M),this.h()},h(){A(t,"class","text-sm font-medium dark:text-gray-100 text-gray-800"),A(c,"class","text-xs text-gray-500"),A(f,"class","text-xs text-gray-500")},m(M,D){ee(M,e,D),q(e,t),q(t,s),q(t,r),q(t,o),q(e,l),q(e,c),q(c,u),q(e,d),q(e,f),q(f,m),ee(M,b,D)},p(M,D){var H,R,z,P,B,Z,G,Y,J,se;D&8&&i!==(i=((z=(R=(H=M[9])==null?void 0:H.openapi)==null?void 0:R.info)==null?void 0:z.title)+"")&&St(s,i),D&8&&a!==(a=((Z=(B=(P=M[9])==null?void 0:P.openapi)==null?void 0:B.info)==null?void 0:Z.version)+"")&&St(o,a),D&8&&h!==(h=((J=(Y=(G=M[9])==null?void 0:G.openapi)==null?void 0:Y.info)==null?void 0:J.description)+"")&&St(u,h),D&8&&g!==(g=((se=M[9])==null?void 0:se.url)+"")&&St(m,g)},d(M){M&&(S(e),S(b))}}}function AA(n){var c,h;let e,t,i=((c=n[12])==null?void 0:c.name)+"",s,r,a,o=((h=n[12])==null?void 0:h.description)+"",l;return{c(){e=te("div"),t=te("div"),s=_t(i),r=Ae(),a=te("div"),l=_t(o),this.h()},l(u){e=ne(u,"DIV",{class:!0});var d=V(e);t=ne(d,"DIV",{class:!0});var f=V(t);s=vt(f,i),f.forEach(S),r=Se(d),a=ne(d,"DIV",{});var g=V(a);l=vt(g,o),g.forEach(S),d.forEach(S),this.h()},h(){A(t,"class","font-medium text-gray-800 dark:text-gray-100"),A(e,"class","my-1")},m(u,d){ee(u,e,d),q(e,t),q(t,s),q(e,r),q(e,a),q(a,l)},p(u,d){var f,g;d&8&&i!==(i=((f=u[12])==null?void 0:f.name)+"")&&St(s,i),d&8&&o!==(o=((g=u[12])==null?void 0:g.description)+"")&&St(l,o)},d(u){u&&S(e)}}}function Jee(n){var r;let e,t,i=Qn(((r=n[9])==null?void 0:r.specs)??[]),s=[];for(let a=0;a<i.length;a+=1)s[a]=AA(xA(n,i,a));return{c(){e=te("div");for(let a=0;a<s.length;a+=1)s[a].c();t=Ae(),this.h()},l(a){e=ne(a,"DIV",{slot:!0});var o=V(e);for(let l=0;l<s.length;l+=1)s[l].l(o);t=Se(o),o.forEach(S),this.h()},h(){A(e,"slot","content")},m(a,o){ee(a,e,o);for(let l=0;l<s.length;l+=1)s[l]&&s[l].m(e,null);q(e,t)},p(a,o){var l;if(o&8){i=Qn(((l=a[9])==null?void 0:l.specs)??[]);let c;for(c=0;c<i.length;c+=1){const h=xA(a,i,c);s[c]?s[c].p(h,o):(s[c]=AA(h),s[c].c(),s[c].m(e,t))}for(;c<s.length;c+=1)s[c].d(1);s.length=i.length}},d(a){a&&S(e),To(s,a)}}}function SA(n){let e,t;return e=new Qg({props:{buttonClassName:"w-full",chevron:!0,$$slots:{content:[Jee],default:[Yee]},$$scope:{ctx:n}}}),{c(){pe(e.$$.fragment)},l(i){ye(e.$$.fragment,i)},m(i,s){be(e,i,s),t=!0},p(i,s){const r={};s&262152&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(L(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){xe(e,i)}}}function Zee(n){let e,t,i,s=n[2].t("Available Tools")+"",r,a,o,l,c,h,u,d,f;l=new ux({props:{className:"size-5"}});let g=n[1].length>0&&wA(n),m=n[3].length>0&&CA(n);return{c(){e=te("div"),t=te("div"),i=te("div"),r=_t(s),a=Ae(),o=te("button"),pe(l.$$.fragment),c=Ae(),g&&g.c(),h=Ae(),m&&m.c(),this.h()},l(b){e=ne(b,"DIV",{});var p=V(e);t=ne(p,"DIV",{class:!0});var y=V(t);i=ne(y,"DIV",{class:!0});var w=V(i);r=vt(w,s),w.forEach(S),a=Se(y),o=ne(y,"BUTTON",{class:!0});var _=V(o);ye(l.$$.fragment,_),_.forEach(S),y.forEach(S),c=Se(p),g&&g.l(p),h=Se(p),m&&m.l(p),p.forEach(S),this.h()},h(){A(i,"class","text-lg font-medium self-center"),A(o,"class","self-center"),A(t,"class","flex justify-between dark:text-gray-300 px-5 pt-4 pb-0.5")},m(b,p){ee(b,e,p),q(e,t),q(t,i),q(i,r),q(t,a),q(t,o),be(l,o,null),q(e,c),g&&g.m(e,null),q(e,h),m&&m.m(e,null),u=!0,d||(f=pt(o,"click",n[7]),d=!0)},p(b,p){(!u||p&4)&&s!==(s=b[2].t("Available Tools")+"")&&St(r,s),b[1].length>0?g?(g.p(b,p),p&2&&L(g,1)):(g=wA(b),g.c(),L(g,1),g.m(e,h)):g&&(ot(),j(g,1,1,()=>{g=null}),lt()),b[3].length>0?m?(m.p(b,p),p&8&&L(m,1)):(m=CA(b),m.c(),L(m,1),m.m(e,null)):m&&(ot(),j(m,1,1,()=>{m=null}),lt())},i(b){u||(L(l.$$.fragment,b),L(g),L(m),u=!0)},o(b){j(l.$$.fragment,b),j(g),j(m),u=!1},d(b){b&&S(e),xe(l),g&&g.d(),m&&m.d(),d=!1,f()}}}function Qee(n){let e,t,i;function s(a){n[8](a)}let r={size:"md",$$slots:{default:[Zee]},$$scope:{ctx:n}};return n[0]!==void 0&&(r.show=n[0]),e=new TF({props:r}),At.push(()=>qt(e,"show",s)),{c(){pe(e.$$.fragment)},l(a){ye(e.$$.fragment,a)},m(a,o){be(e,a,o),i=!0},p(a,[o]){const l={};o&262159&&(l.$$scope={dirty:o,ctx:a}),!t&&o&1&&(t=!0,l.show=a[0],Wt(()=>t=!1)),e.$set(l)},i(a){i||(L(e.$$.fragment,a),i=!0)},o(a){j(e.$$.fragment,a),i=!1},d(a){xe(e,a)}}}function $ee(n,e,t){let i,s,r;Pe(n,Jd,d=>t(6,i=d)),Pe(n,qI,d=>t(3,r=d));let{show:a=!1}=e,{selectedToolIds:o=[]}=e,l=[];const c=hs("i18n");Pe(n,c,d=>t(2,s=d));const h=()=>{t(0,a=!1)};function u(d){a=d,t(0,a)}return n.$$set=d=>{"show"in d&&t(0,a=d.show),"selectedToolIds"in d&&t(5,o=d.selectedToolIds)},n.$$.update=()=>{n.$$.dirty&96&&t(1,l=(i??[]).filter(d=>o.includes(d.id)))},[a,l,s,r,c,o,i,h,u]}class ete extends Nt{constructor(e){super(),Ot(this,e,$ee,Qee,Ft,{show:0,selectedToolIds:5})}}function tte(n){let e,t;return{c(){e=nt("svg"),t=nt("path"),this.h()},l(i){e=it(i,"svg",{class:!0,"stroke-width":!0,"aria-hidden":!0,xmlns:!0,fill:!0,viewBox:!0});var s=V(e);t=it(s,"path",{stroke:!0,"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),V(t).forEach(S),s.forEach(S),this.h()},h(){A(t,"stroke","currentColor"),A(t,"stroke-linecap","round"),A(t,"stroke-linejoin","round"),A(t,"stroke-width","2"),A(t,"d","m3 16 5-7 6 6.5m6.5 2.5L16 13l-4.286 6M14 10h.01M4 19h16a1 1 0 0 0 1-1V6a1 1 0 0 0-1-1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1Z"),A(e,"class",n[0]),A(e,"stroke-width",n[1]),A(e,"aria-hidden","true"),A(e,"xmlns","http://www.w3.org/2000/svg"),A(e,"fill","none"),A(e,"viewBox","0 0 24 24")},m(i,s){ee(i,e,s),q(e,t)},p(i,[s]){s&1&&A(e,"class",i[0]),s&2&&A(e,"stroke-width",i[1])},i:kt,o:kt,d(i){i&&S(e)}}}function nte(n,e,t){let{className:i="size-4"}=e,{strokeWidth:s="1.5"}=e;return n.$$set=r=>{"className"in r&&t(0,i=r.className),"strokeWidth"in r&&t(1,s=r.strokeWidth)},[i,s]}class ite extends Nt{constructor(e){super(),Ot(this,e,nte,tte,Ft,{className:0,strokeWidth:1})}}function ste(n){let e,t,i;return{c(){e=nt("svg"),t=nt("path"),i=nt("path"),this.h()},l(s){e=it(s,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,"aria-hidden":!0,stroke:!0,class:!0});var r=V(e);t=it(r,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),V(t).forEach(S),i=it(r,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),V(i).forEach(S),r.forEach(S),this.h()},h(){A(t,"stroke-linecap","round"),A(t,"stroke-linejoin","round"),A(t,"d","M21.75 6.75a4.5 4.5 0 0 1-4.884 4.484c-1.076-.091-2.264.071-2.95.904l-7.152 8.684a2.548 2.548 0 1 1-3.586-3.586l8.684-7.152c.833-.686.995-1.874.904-2.95a4.5 4.5 0 0 1 6.336-4.486l-3.276 3.276a3.004 3.004 0 0 0 2.25 2.25l3.276-3.276c.256.565.398 1.192.398 1.852Z"),A(i,"stroke-linecap","round"),A(i,"stroke-linejoin","round"),A(i,"d","M4.867 19.125h.008v.008h-.008v-.008Z"),A(e,"xmlns","http://www.w3.org/2000/svg"),A(e,"fill","none"),A(e,"viewBox","0 0 24 24"),A(e,"stroke-width",n[1]),A(e,"aria-hidden","true"),A(e,"stroke","currentColor"),A(e,"class",n[0])},m(s,r){ee(s,e,r),q(e,t),q(e,i)},p(s,[r]){r&2&&A(e,"stroke-width",s[1]),r&1&&A(e,"class",s[0])},i:kt,o:kt,d(s){s&&S(e)}}}function rte(n,e,t){let{className:i="w-4 h-4"}=e,{strokeWidth:s="1.5"}=e;return n.$$set=r=>{"className"in r&&t(0,i=r.className),"strokeWidth"in r&&t(1,s=r.strokeWidth)},[i,s]}class ate extends Nt{constructor(e){super(),Ot(this,e,rte,ste,Ft,{className:0,strokeWidth:1})}}function ote(n){let e,t,i,s,r,a;return{c(){e=nt("svg"),t=nt("path"),i=nt("path"),s=nt("path"),r=nt("path"),a=nt("path"),this.h()},l(o){e=it(o,"svg",{"aria-hidden":!0,xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var l=V(e);t=it(l,"path",{d:!0,"stroke-linecap":!0,"stroke-linejoin":!0}),V(t).forEach(S),i=it(l,"path",{d:!0,"stroke-linecap":!0,"stroke-linejoin":!0}),V(i).forEach(S),s=it(l,"path",{d:!0,"stroke-linecap":!0,"stroke-linejoin":!0}),V(s).forEach(S),r=it(l,"path",{d:!0,"stroke-linecap":!0,"stroke-linejoin":!0}),V(r).forEach(S),a=it(l,"path",{d:!0,"stroke-linecap":!0,"stroke-linejoin":!0}),V(a).forEach(S),l.forEach(S),this.h()},h(){A(t,"d","M12 4L12 20"),A(t,"stroke-linecap","round"),A(t,"stroke-linejoin","round"),A(i,"d","M8 9L8 15"),A(i,"stroke-linecap","round"),A(i,"stroke-linejoin","round"),A(s,"d","M20 10L20 14"),A(s,"stroke-linecap","round"),A(s,"stroke-linejoin","round"),A(r,"d","M4 10L4 14"),A(r,"stroke-linecap","round"),A(r,"stroke-linejoin","round"),A(a,"d","M16 7L16 17"),A(a,"stroke-linecap","round"),A(a,"stroke-linejoin","round"),A(e,"aria-hidden","true"),A(e,"xmlns","http://www.w3.org/2000/svg"),A(e,"fill","currentColor"),A(e,"viewBox","0 0 24 24"),A(e,"stroke-width",n[1]),A(e,"stroke","currentColor"),A(e,"class",n[0])},m(o,l){ee(o,e,l),q(e,t),q(e,i),q(e,s),q(e,r),q(e,a)},p(o,[l]){l&2&&A(e,"stroke-width",o[1]),l&1&&A(e,"class",o[0])},i:kt,o:kt,d(o){o&&S(e)}}}function lte(n,e,t){let{className:i="w-4 h-4"}=e,{strokeWidth:s="1.5"}=e;return n.$$set=r=>{"className"in r&&t(0,i=r.className),"strokeWidth"in r&&t(1,s=r.strokeWidth)},[i,s]}class cte extends Nt{constructor(e){super(),Ot(this,e,lte,ote,Ft,{className:0,strokeWidth:1})}}function IA(n,e,t){const i=n.slice();return i[125]=e[t],i[127]=t,i}function EA(n,e,t){const i=n.slice();return i[128]=e[t],i[130]=t,i}function TA(n){var R;let e,t,i,s,r,a,o,l,c,h,u,d,f,g,m,b,p,y,w,_,v,C,k=n[8]===!1&&((R=n[14])==null?void 0:R.currentId)&&RA(n),I=n[0]!==void 0&&MA(n);function E(z){n[70](z)}let T={show:n[9],command:n[18],insertTextHandler:n[51],onUpload:n[67],onSelect:n[68]};n[2]!==void 0&&(T.files=n[2]),l=new RD({props:T}),n[69](l),At.push(()=>qt(l,"files",E));const M=[ute,hte],D=[];function H(z,P){return z[28]?0:1}return p=H(n),y=D[p]=M[p](n),{c(){e=te("div"),t=te("div"),i=te("div"),s=te("div"),k&&k.c(),r=Ae(),a=te("div"),I&&I.c(),o=Ae(),pe(l.$$.fragment),u=Ae(),d=te("div"),f=te("div"),g=te("div"),m=te("input"),b=Ae(),y.c(),this.h()},l(z){e=ne(z,"DIV",{class:!0});var P=V(e);t=ne(P,"DIV",{class:!0});var B=V(t);i=ne(B,"DIV",{class:!0});var Z=V(i);s=ne(Z,"DIV",{class:!0});var G=V(s);k&&k.l(G),G.forEach(S),r=Se(Z),a=ne(Z,"DIV",{class:!0});var Y=V(a);I&&I.l(Y),o=Se(Y),ye(l.$$.fragment,Y),Y.forEach(S),Z.forEach(S),B.forEach(S),u=Se(P),d=ne(P,"DIV",{class:!0});var J=V(d);f=ne(J,"DIV",{class:!0});var se=V(f);g=ne(se,"DIV",{class:!0});var fe=V(g);m=ne(fe,"INPUT",{type:!0}),b=Se(fe),y.l(fe),fe.forEach(S),se.forEach(S),J.forEach(S),P.forEach(S),this.h()},h(){var z,P;A(s,"class","relative"),A(a,"class","w-full relative"),A(i,"class",h="flex flex-col px-3 "+(((z=n[43])==null?void 0:z.widescreenMode)??null?"max-w-full":"max-w-6xl")+" w-full"),A(t,"class","mx-auto inset-x-0 bg-transparent flex justify-center"),A(m,"type","file"),m.hidden=!0,m.multiple=!0,A(g,"class",""),A(f,"class",w=(((P=n[43])==null?void 0:P.widescreenMode)??null?"max-w-full":"max-w-6xl")+" px-2.5 mx-auto inset-x-0"),A(d,"class","bg-transparent"),A(e,"class","w-full font-primary")},m(z,P){ee(z,e,P),q(e,t),q(t,i),q(i,s),k&&k.m(s,null),q(i,r),q(i,a),I&&I.m(a,null),q(a,o),be(l,a,null),q(e,u),q(e,d),q(d,f),q(f,g),q(g,m),n[71](m),q(g,b),D[p].m(g,null),_=!0,v||(C=[pt(m,"change",n[72]),pt(m,"change",n[73])],v=!0)},p(z,P){var G,Y,J;z[8]===!1&&((G=z[14])!=null&&G.currentId)?k?k.p(z,P):(k=RA(z),k.c(),k.m(s,null)):k&&(k.d(1),k=null),z[0]!==void 0?I?(I.p(z,P),P[0]&1&&L(I,1)):(I=MA(z),I.c(),L(I,1),I.m(a,o)):I&&(ot(),j(I,1,1,()=>{I=null}),lt());const B={};P[0]&512&&(B.show=z[9]),P[0]&262144&&(B.command=z[18]),P[0]&4&&(B.onUpload=z[67]),P[0]&1&&(B.onSelect=z[68]),!c&&P[0]&4&&(c=!0,B.files=z[2],Wt(()=>c=!1)),l.$set(B),(!_||P[1]&4096&&h!==(h="flex flex-col px-3 "+(((Y=z[43])==null?void 0:Y.widescreenMode)??null?"max-w-full":"max-w-6xl")+" w-full"))&&A(i,"class",h);let Z=p;p=H(z),p===Z?D[p].p(z,P):(ot(),j(D[Z],1,1,()=>{D[Z]=null}),lt(),y=D[p],y?y.p(z,P):(y=D[p]=M[p](z),y.c()),L(y,1),y.m(g,null)),(!_||P[1]&4096&&w!==(w=(((J=z[43])==null?void 0:J.widescreenMode)??null?"max-w-full":"max-w-6xl")+" px-2.5 mx-auto inset-x-0"))&&A(f,"class",w)},i(z){_||(L(I),L(l.$$.fragment,z),L(y),_=!0)},o(z){j(I),j(l.$$.fragment,z),j(y),_=!1},d(z){z&&S(e),k&&k.d(),I&&I.d(),n[69](null),xe(l),n[71](null),D[p].d(),v=!1,ia(C)}}}function RA(n){let e,t,i='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5"><path fill-rule="evenodd" d="M10 3a.75.75 0 01.75.75v10.638l3.96-4.158a.75.75 0 111.08 1.04l-5.25 5.5a.75.75 0 01-1.08 0l-5.25-5.5a.75.75 0 111.08-1.04l3.96 4.158V3.75A.75.75 0 0110 3z" clip-rule="evenodd"></path></svg>',s,r;return{c(){e=te("div"),t=te("button"),t.innerHTML=i,this.h()},l(a){e=ne(a,"DIV",{class:!0});var o=V(e);t=ne(o,"BUTTON",{class:!0,"data-svelte-h":!0}),Ro(t)!=="svelte-h8r9o0"&&(t.innerHTML=i),o.forEach(S),this.h()},h(){A(t,"class","bg-white border border-gray-100 dark:border-none dark:bg-white/20 p-1.5 rounded-full pointer-events-auto"),A(e,"class","absolute -top-12 left-0 right-0 flex justify-center z-30 pointer-events-none")},m(a,o){ee(a,e,o),q(e,t),s||(r=pt(t,"click",n[64]),s=!0)},p:kt,d(a){a&&S(e),s=!1,r()}}}function MA(n){let e,t,i,s,r,a,o,l,c,h=n[0].name+"",u,d,f,g,m,b,p,y;return m=new ux({}),{c(){e=te("div"),t=te("div"),i=te("div"),s=te("img"),a=Ae(),o=te("div"),l=_t("Talking to "),c=te("span"),u=_t(h),d=Ae(),f=te("div"),g=te("button"),pe(m.$$.fragment),this.h()},l(w){e=ne(w,"DIV",{class:!0});var _=V(e);t=ne(_,"DIV",{class:!0});var v=V(t);i=ne(v,"DIV",{class:!0});var C=V(i);s=ne(C,"IMG",{crossorigin:!0,alt:!0,class:!0,src:!0}),a=Se(C),o=ne(C,"DIV",{class:!0});var k=V(o);l=vt(k,"Talking to "),c=ne(k,"SPAN",{class:!0});var I=V(c);u=vt(I,h),I.forEach(S),k.forEach(S),C.forEach(S),d=Se(v),f=ne(v,"DIV",{});var E=V(f);g=ne(E,"BUTTON",{class:!0});var T=V(g);ye(m.$$.fragment,T),T.forEach(S),E.forEach(S),v.forEach(S),_.forEach(S),this.h()},h(){var w,_,v;A(s,"crossorigin","anonymous"),A(s,"alt","model profile"),A(s,"class","size-3.5 max-w-[28px] object-cover rounded-full"),k0(s.src,r=((v=(_=(w=n[21].find(n[65]))==null?void 0:w.info)==null?void 0:_.meta)==null?void 0:v.profile_image_url)??(n[44].language==="dg-DG"?`${tl}/doge.png`:`${tl}/static/favicon.png`))||A(s,"src",r),A(c,"class","font-medium"),A(o,"class","translate-y-[0.5px]"),A(i,"class","pl-[1px] flex items-center gap-2 text-sm dark:text-gray-500"),A(g,"class","flex items-center dark:text-gray-500"),A(t,"class","flex items-center justify-between w-full"),A(e,"class","px-3 pb-0.5 pt-1.5 text-left w-full flex flex-col absolute bottom-0 left-0 right-0 bg-linear-to-t from-white dark:from-gray-900 z-10")},m(w,_){ee(w,e,_),q(e,t),q(t,i),q(i,s),q(i,a),q(i,o),q(o,l),q(o,c),q(c,u),q(t,d),q(t,f),q(f,g),be(m,g,null),b=!0,p||(y=pt(g,"click",n[66]),p=!0)},p(w,_){var v,C,k;(!b||_[0]&2097153|_[1]&8192&&!k0(s.src,r=((k=(C=(v=w[21].find(w[65]))==null?void 0:v.info)==null?void 0:C.meta)==null?void 0:k.profile_image_url)??(w[44].language==="dg-DG"?`${tl}/doge.png`:`${tl}/static/favicon.png`)))&&A(s,"src",r),(!b||_[0]&1)&&h!==(h=w[0].name+"")&&St(u,h)},i(w){b||(L(m.$$.fragment,w),b=!0)},o(w){j(m.$$.fragment,w),b=!1},d(w){w&&S(e),xe(m),p=!1,y()}}}function hte(n){var J,se,fe,he,de,ge;let e,t,i,s,r,a,o,l,c,h,u,d,f,g,m,b,p,y,w,_,v,C,k=n[2].length>0&&PA(n);const I=[pte,mte],E=[];function T(N,K){var oe;return((oe=N[43])==null?void 0:oe.richTextInput)??!0?0:1}r=T(n),a=E[r]=I[r](n);function M(N){n[102](N)}let D={selectedModels:n[0]?[n[0].id]:n[13],fileUploadCapableModels:n[37],screenCaptureHandler:n[53],inputFilesHandler:n[55],uploadFilesHandler:n[98],uploadGoogleDriveHandler:n[99],uploadOneDriveHandler:n[100],onClose:n[101],$$slots:{default:[bte]},$$scope:{ctx:n}};n[3]!==void 0&&(D.selectedToolIds=n[3]),h=new Kee({props:D}),At.push(()=>qt(h,"selectedToolIds",M));let H=n[20]&&(n[39]||n[38]&&n[38].length>0||n[40]||n[41]||n[42])&&FA(n),R=(!((J=n[14])!=null&&J.currentId)||((se=n[14].messages[n[14].currentId])==null?void 0:se.done)==!0)&&(((fe=n[20])==null?void 0:fe.role)==="admin"||(((ge=(de=(he=n[20])==null?void 0:he.permissions)==null?void 0:de.chat)==null?void 0:ge.stt)??!0))&&jA(n);const z=[Ete,Ite,Ste],P=[];function B(N,K){var oe,W,le,ce,Ce;return N[15]&&N[15].length>0||N[14].currentId&&((oe=N[14].messages[N[14].currentId])==null?void 0:oe.done)!=!0||N[12]?0:N[1]===""&&N[2].length===0&&(((W=N[20])==null?void 0:W.role)==="admin"||(((Ce=(ce=(le=N[20])==null?void 0:le.permissions)==null?void 0:ce.chat)==null?void 0:Ce.call)??!0))?1:2}b=B(n),p=P[b]=z[b](n);function Z(N,K){var oe,W;return(W=(oe=N[19])==null?void 0:oe.license_metadata)!=null&&W.input_footer?Nte:Pte}let G=Z(n),Y=G(n);return{c(){e=te("form"),t=te("div"),k&&k.c(),i=Ae(),s=te("div"),a.c(),o=Ae(),l=te("div"),c=te("div"),pe(h.$$.fragment),d=Ae(),H&&H.c(),f=Ae(),g=te("div"),R&&R.c(),m=Ae(),p.c(),w=Ae(),Y.c(),this.h()},l(N){e=ne(N,"FORM",{class:!0});var K=V(e);t=ne(K,"DIV",{class:!0,dir:!0});var oe=V(t);k&&k.l(oe),i=Se(oe),s=ne(oe,"DIV",{class:!0});var W=V(s);a.l(W),W.forEach(S),o=Se(oe),l=ne(oe,"DIV",{class:!0,dir:!0});var le=V(l);c=ne(le,"DIV",{class:!0});var ce=V(c);ye(h.$$.fragment,ce),d=Se(ce),H&&H.l(ce),ce.forEach(S),f=Se(le),g=ne(le,"DIV",{class:!0});var Ce=V(g);R&&R.l(Ce),m=Se(Ce),p.l(Ce),Ce.forEach(S),le.forEach(S),oe.forEach(S),w=Se(K),Y.l(K),K.forEach(S),this.h()},h(){var N;A(s,"class","px-2.5"),A(c,"class","ml-1 self-end flex items-center flex-1 max-w-[80%]"),A(g,"class","self-end flex space-x-1 mr-1 shrink-0"),A(l,"class","flex justify-between mt-0.5 mb-2.5 mx-0.5 max-w-full"),A(l,"dir","ltr"),A(t,"class","flex-1 flex flex-col relative w-full shadow-lg rounded-3xl border border-gray-50 dark:border-gray-850 hover:border-gray-100 focus-within:border-gray-100 hover:dark:border-gray-800 focus-within:dark:border-gray-800 transition px-1 bg-white/90 dark:bg-gray-400/5 dark:text-gray-100"),A(t,"dir",y=((N=n[43])==null?void 0:N.chatDirection)??"auto"),A(e,"class","w-full flex flex-col gap-1.5")},m(N,K){ee(N,e,K),q(e,t),k&&k.m(t,null),q(t,i),q(t,s),E[r].m(s,null),q(t,o),q(t,l),q(l,c),be(h,c,null),q(c,d),H&&H.m(c,null),q(l,f),q(l,g),R&&R.m(g,null),q(g,m),P[b].m(g,null),q(e,w),Y.m(e,null),_=!0,v||(C=pt(e,"submit",Zg(n[111])),v=!0)},p(N,K){var ce,Ce,X,Ke,qe,He,Me;N[2].length>0?k?(k.p(N,K),K[0]&4&&L(k,1)):(k=PA(N),k.c(),L(k,1),k.m(t,i)):k&&(ot(),j(k,1,1,()=>{k=null}),lt());let oe=r;r=T(N),r===oe?E[r].p(N,K):(ot(),j(E[oe],1,1,()=>{E[oe]=null}),lt(),a=E[r],a?a.p(N,K):(a=E[r]=I[r](N),a.c()),L(a,1),a.m(s,null));const W={};K[0]&8193&&(W.selectedModels=N[0]?[N[0].id]:N[13]),K[1]&64&&(W.fileUploadCapableModels=N[37]),K[1]&1&&(W.uploadFilesHandler=N[98]),K[1]&8192&&(W.uploadGoogleDriveHandler=N[99]),K[4]&128&&(W.$$scope={dirty:K,ctx:N}),!u&&K[0]&8&&(u=!0,W.selectedToolIds=N[3],Wt(()=>u=!1)),h.$set(W),N[20]&&(N[39]||N[38]&&N[38].length>0||N[40]||N[41]||N[42])?H?(H.p(N,K),K[0]&1048576|K[1]&3968&&L(H,1)):(H=FA(N),H.c(),L(H,1),H.m(c,null)):H&&(ot(),j(H,1,1,()=>{H=null}),lt()),(!((ce=N[14])!=null&&ce.currentId)||((Ce=N[14].messages[N[14].currentId])==null?void 0:Ce.done)==!0)&&(((X=N[20])==null?void 0:X.role)==="admin"||(((He=(qe=(Ke=N[20])==null?void 0:Ke.permissions)==null?void 0:qe.chat)==null?void 0:He.stt)??!0))?R?(R.p(N,K),K[0]&1064960&&L(R,1)):(R=jA(N),R.c(),L(R,1),R.m(g,m)):R&&(ot(),j(R,1,1,()=>{R=null}),lt());let le=b;b=B(N),b===le?P[b].p(N,K):(ot(),j(P[le],1,1,()=>{P[le]=null}),lt(),p=P[b],p?p.p(N,K):(p=P[b]=z[b](N),p.c()),L(p,1),p.m(g,null)),(!_||K[1]&4096&&y!==(y=((Me=N[43])==null?void 0:Me.chatDirection)??"auto"))&&A(t,"dir",y),G===(G=Z(N))&&Y?Y.p(N,K):(Y.d(1),Y=G(N),Y&&(Y.c(),Y.m(e,null)))},i(N){_||(L(k),L(a),L(h.$$.fragment,N),L(H),L(R),L(p),_=!0)},o(N){j(k),j(a),j(h.$$.fragment,N),j(H),j(R),j(p),_=!1},d(N){N&&S(e),k&&k.d(),E[r].d(),xe(h),H&&H.d(),R&&R.d(),P[b].d(),Y.d(),v=!1,C()}}}function ute(n){let e,t,i;function s(a){n[76](a)}let r={onCancel:n[74],onConfirm:n[75]};return n[28]!==void 0&&(r.recording=n[28]),e=new AF({props:r}),At.push(()=>qt(e,"recording",s)),{c(){pe(e.$$.fragment)},l(a){ye(e.$$.fragment,a)},m(a,o){be(e,a,o),i=!0},p(a,o){const l={};o[0]&268435456&&(l.onCancel=a[74]),o[0]&268435458|o[1]&4096&&(l.onConfirm=a[75]),!t&&o[0]&268435456&&(t=!0,l.recording=a[28],Wt(()=>t=!1)),e.$set(l)},i(a){i||(L(e.$$.fragment,a),i=!0)},o(a){j(e.$$.fragment,a),i=!1},d(a){xe(e,a)}}}function PA(n){let e,t,i=Qn(n[2]),s=[];for(let a=0;a<i.length;a+=1)s[a]=OA(EA(n,i,a));const r=a=>j(s[a],1,1,()=>{s[a]=null});return{c(){e=te("div");for(let a=0;a<s.length;a+=1)s[a].c();this.h()},l(a){e=ne(a,"DIV",{class:!0});var o=V(e);for(let l=0;l<s.length;l+=1)s[l].l(o);o.forEach(S),this.h()},h(){A(e,"class","mx-2 mt-2.5 -mb-1 flex items-center flex-wrap gap-2")},m(a,o){ee(a,e,o);for(let l=0;l<s.length;l+=1)s[l]&&s[l].m(e,null);t=!0},p(a,o){if(o[0]&8197|o[1]&12320){i=Qn(a[2]);let l;for(l=0;l<i.length;l+=1){const c=EA(a,i,l);s[l]?(s[l].p(c,o),L(s[l],1)):(s[l]=OA(c),s[l].c(),L(s[l],1),s[l].m(e,null))}for(ot(),l=i.length;l<s.length;l+=1)r(l);lt()}},i(a){if(!t){for(let o=0;o<i.length;o+=1)L(s[o]);t=!0}},o(a){s=s.filter(Boolean);for(let o=0;o<s.length;o+=1)j(s[o]);t=!1},d(a){a&&S(e),To(s,a)}}}function dte(n){var r,a;let e,t;function i(){return n[79](n[130])}function s(){return n[80](n[128])}return e=new JI({props:{item:n[128],name:n[128].name,type:n[128].type,size:(r=n[128])==null?void 0:r.size,loading:n[128].status==="uploading",dismissible:!0,edit:!0,modal:["file","collection"].includes((a=n[128])==null?void 0:a.type)}}),e.$on("dismiss",i),e.$on("click",s),{c(){pe(e.$$.fragment)},l(o){ye(e.$$.fragment,o)},m(o,l){be(e,o,l),t=!0},p(o,l){var h,u;n=o;const c={};l[0]&4&&(c.item=n[128]),l[0]&4&&(c.name=n[128].name),l[0]&4&&(c.type=n[128].type),l[0]&4&&(c.size=(h=n[128])==null?void 0:h.size),l[0]&4&&(c.loading=n[128].status==="uploading"),l[0]&4&&(c.modal=["file","collection"].includes((u=n[128])==null?void 0:u.type)),e.$set(c)},i(o){t||(L(e.$$.fragment,o),t=!0)},o(o){j(e.$$.fragment,o),t=!1},d(o){xe(e,o)}}}function fte(n){let e,t,i,s,r,a,o,l,c,h,u,d,f,g,m;i=new vD({props:{src:n[128].url,alt:"",imageClassName:" size-14 rounded-xl object-cover"}});let b=(n[0]?n[36].length===0:n[13].length!==n[36].length)&&NA(n);function p(){return n[78](n[130])}return{c(){e=te("div"),t=te("div"),pe(i.$$.fragment),s=Ae(),b&&b.c(),r=Ae(),a=te("div"),o=te("button"),l=nt("svg"),c=nt("path"),d=Ae(),this.h()},l(y){e=ne(y,"DIV",{class:!0});var w=V(e);t=ne(w,"DIV",{class:!0});var _=V(t);ye(i.$$.fragment,_),s=Se(_),b&&b.l(_),_.forEach(S),r=Se(w),a=ne(w,"DIV",{class:!0});var v=V(a);o=ne(v,"BUTTON",{class:!0,type:!0,"aria-label":!0});var C=V(o);l=it(C,"svg",{xmlns:!0,viewBox:!0,fill:!0,"aria-hidden":!0,class:!0});var k=V(l);c=it(k,"path",{d:!0}),V(c).forEach(S),k.forEach(S),C.forEach(S),v.forEach(S),d=Se(w),w.forEach(S),this.h()},h(){var y;A(t,"class","relative flex items-center"),A(c,"d","M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"),A(l,"xmlns","http://www.w3.org/2000/svg"),A(l,"viewBox","0 0 20 20"),A(l,"fill","currentColor"),A(l,"aria-hidden","true"),A(l,"class","size-4"),A(o,"class",h="bg-white text-black border border-white rounded-full "+(((y=n[43])==null?void 0:y.highContrastMode)??!1?"":"outline-hidden focus:outline-hidden group-hover:visible invisible transition")),A(o,"type","button"),A(o,"aria-label",u=n[44].t("Remove file")),A(a,"class","absolute -top-1 -right-1"),A(e,"class","relative group")},m(y,w){ee(y,e,w),q(e,t),be(i,t,null),q(t,s),b&&b.m(t,null),q(e,r),q(e,a),q(a,o),q(o,l),q(l,c),q(e,d),f=!0,g||(m=pt(o,"click",p),g=!0)},p(y,w){var v;n=y;const _={};w[0]&4&&(_.src=n[128].url),i.$set(_),(n[0]?n[36].length===0:n[13].length!==n[36].length)?b?(b.p(n,w),w[0]&8193|w[1]&32&&L(b,1)):(b=NA(n),b.c(),L(b,1),b.m(t,null)):b&&(ot(),j(b,1,1,()=>{b=null}),lt()),(!f||w[1]&4096&&h!==(h="bg-white text-black border border-white rounded-full "+(((v=n[43])==null?void 0:v.highContrastMode)??!1?"":"outline-hidden focus:outline-hidden group-hover:visible invisible transition")))&&A(o,"class",h),(!f||w[1]&8192&&u!==(u=n[44].t("Remove file")))&&A(o,"aria-label",u)},i(y){f||(L(i.$$.fragment,y),L(b),f=!0)},o(y){j(i.$$.fragment,y),j(b),f=!1},d(y){y&&S(e),xe(i),b&&b.d(),g=!1,m()}}}function NA(n){let e,t;return e=new Ci({props:{className:" absolute top-1 left-1",content:n[44].t("{{ models }}",{models:[...n[0]?[n[0]]:n[13]].filter(n[77]).join(", ")}),$$slots:{default:[gte]},$$scope:{ctx:n}}}),{c(){pe(e.$$.fragment)},l(i){ye(e.$$.fragment,i)},m(i,s){be(e,i,s),t=!0},p(i,s){const r={};s[0]&8193|s[1]&8224&&(r.content=i[44].t("{{ models }}",{models:[...i[0]?[i[0]]:i[13]].filter(i[77]).join(", ")})),s[4]&128&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(L(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){xe(e,i)}}}function gte(n){let e,t;return{c(){e=nt("svg"),t=nt("path"),this.h()},l(i){e=it(i,"svg",{xmlns:!0,viewBox:!0,fill:!0,"aria-hidden":!0,class:!0});var s=V(e);t=it(s,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),V(t).forEach(S),s.forEach(S),this.h()},h(){A(t,"fill-rule","evenodd"),A(t,"d","M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003ZM12 8.25a.75.75 0 0 1 .75.75v3.75a.75.75 0 0 1-1.5 0V9a.75.75 0 0 1 .75-.75Zm0 8.25a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Z"),A(t,"clip-rule","evenodd"),A(e,"xmlns","http://www.w3.org/2000/svg"),A(e,"viewBox","0 0 24 24"),A(e,"fill","currentColor"),A(e,"aria-hidden","true"),A(e,"class","size-4 fill-yellow-300")},m(i,s){ee(i,e,s),q(e,t)},p:kt,d(i){i&&S(e)}}}function OA(n){let e,t,i,s;const r=[fte,dte],a=[];function o(l,c){return l[128].type==="image"?0:1}return e=o(n),t=a[e]=r[e](n),{c(){t.c(),i=Ut()},l(l){t.l(l),i=Ut()},m(l,c){a[e].m(l,c),ee(l,i,c),s=!0},p(l,c){let h=e;e=o(l),e===h?a[e].p(l,c):(ot(),j(a[h],1,1,()=>{a[h]=null}),lt(),t=a[e],t?t.p(l,c):(t=a[e]=r[e](l),t.c()),L(t,1),t.m(i.parentNode,i))},i(l){s||(L(t),s=!0)},o(l){j(t),s=!1},d(l){l&&S(i),a[e].d(l)}}}function mte(n){let e,t,i,s,r;return{c(){e=te("textarea"),this.h()},l(a){e=ne(a,"TEXTAREA",{id:!0,dir:!0,class:!0,placeholder:!0,rows:!0}),V(e).forEach(S),this.h()},h(){var a;A(e,"id","chat-input"),A(e,"dir",t=((a=n[43])==null?void 0:a.chatDirection)??"auto"),A(e,"class","scrollbar-hidden bg-transparent dark:text-gray-200 outline-hidden w-full pt-4 pb-1 px-1 resize-none"),A(e,"placeholder",i=n[17]?n[17]:n[44].t("Send a Message")),A(e,"rows","1")},m(a,o){ee(a,e,o),n[88](e),So(e,n[1]),s||(r=[pt(e,"input",n[89]),pt(e,"input",n[90]),pt(e,"click",n[91]),pt(e,"compositionstart",n[92]),pt(e,"compositionend",n[93]),pt(e,"keydown",n[94]),pt(e,"input",n[95]),pt(e,"focus",n[96]),pt(e,"paste",n[97])],s=!0)},p(a,o){var l;o[1]&4096&&t!==(t=((l=a[43])==null?void 0:l.chatDirection)??"auto")&&A(e,"dir",t),o[0]&131072|o[1]&8192&&i!==(i=a[17]?a[17]:a[44].t("Send a Message"))&&A(e,"placeholder",i),o[0]&2&&So(e,a[1])},i:kt,o:kt,d(a){a&&S(e),n[88](null),s=!1,ia(r)}}}function pte(n){var r;let e,t=((r=n[43])==null?void 0:r.showFormattingToolbar)??!1,i,s=DA(n);return{c(){e=te("div"),s.c(),this.h()},l(a){e=ne(a,"DIV",{class:!0,id:!0});var o=V(e);s.l(o),o.forEach(S),this.h()},h(){A(e,"class","scrollbar-hidden rtl:text-right ltr:text-left bg-transparent dark:text-gray-100 outline-hidden w-full pt-2.5 pb-[5px] px-1 resize-none h-fit max-h-80 overflow-auto"),A(e,"id","chat-input-container")},m(a,o){ee(a,e,o),s.m(e,null),i=!0},p(a,o){var l;o[1]&4096&&Ft(t,t=((l=a[43])==null?void 0:l.showFormattingToolbar)??!1)?(ot(),j(s,1,1,kt),lt(),s=DA(a),s.c(),L(s,1),s.m(e,null)):s.p(a,o)},i(a){i||(L(s),i=!0)},o(a){j(s),i=!1},d(a){a&&S(e),s.d(a)}}}function DA(n){var s,r,a,o,l,c,h;let e,t,i={id:"chat-input",onChange:n[81],json:!0,messageInput:!0,showFormattingToolbar:((s=n[43])==null?void 0:s.showFormattingToolbar)??!1,floatingMenuPlacement:"top-start",insertPromptAsRichText:((r=n[43])==null?void 0:r.insertPromptAsRichText)??!1,shiftEnter:!(((a=n[43])==null?void 0:a.ctrlEnterToSend)??!1)&&(!n[45]||!("ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0)),placeholder:n[17]?n[17]:n[44].t("Send a Message"),largeTextAsFile:(((o=n[43])==null?void 0:o.largeTextAsFile)??!1)&&!n[35],autocomplete:((c=(l=n[19])==null?void 0:l.features)==null?void 0:c.enable_autocomplete_generation)&&(((h=n[43])==null?void 0:h.promptAutocomplete)??!1),generateAutoCompletion:n[82],oncompositionstart:n[83],oncompositionend:n[84]};return e=new SF({props:i}),n[85](e),e.$on("keydown",n[86]),e.$on("paste",n[87]),{c(){pe(e.$$.fragment)},l(u){ye(e.$$.fragment,u)},m(u,d){be(e,u,d),t=!0},p(u,d){var g,m,b,p,y,w,_;const f={};d[0]&262146&&(f.onChange=u[81]),d[1]&4096&&(f.showFormattingToolbar=((g=u[43])==null?void 0:g.showFormattingToolbar)??!1),d[1]&4096&&(f.insertPromptAsRichText=((m=u[43])==null?void 0:m.insertPromptAsRichText)??!1),d[1]&20480&&(f.shiftEnter=!(((b=u[43])==null?void 0:b.ctrlEnterToSend)??!1)&&(!u[45]||!("ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0))),d[0]&131072|d[1]&8192&&(f.placeholder=u[17]?u[17]:u[44].t("Send a Message")),d[1]&4112&&(f.largeTextAsFile=(((p=u[43])==null?void 0:p.largeTextAsFile)??!1)&&!u[35]),d[0]&524288|d[1]&4096&&(f.autocomplete=((w=(y=u[19])==null?void 0:y.features)==null?void 0:w.enable_autocomplete_generation)&&(((_=u[43])==null?void 0:_.promptAutocomplete)??!1)),d[0]&4210688|d[1]&8192&&(f.generateAutoCompletion=u[82]),d[0]&536870912&&(f.oncompositionstart=u[83]),d[0]&536870912&&(f.oncompositionend=u[84]),e.$set(f)},i(u){t||(L(e.$$.fragment,u),t=!0)},o(u){j(e.$$.fragment,u),t=!1},d(u){n[85](null),xe(e,u)}}}function bte(n){let e,t='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" aria-hidden="true" fill="currentColor" class="size-5"><path d="M10.75 4.75a.75.75 0 0 0-1.5 0v4.5h-4.5a.75.75 0 0 0 0 1.5h4.5v4.5a.75.75 0 0 0 1.5 0v-4.5h4.5a.75.75 0 0 0 0-1.5h-4.5v-4.5Z"></path></svg>';return{c(){e=te("div"),e.innerHTML=t,this.h()},l(i){e=ne(i,"DIV",{class:!0,"data-svelte-h":!0}),Ro(e)!=="svelte-cdbbcu"&&(e.innerHTML=t),this.h()},h(){A(e,"class","bg-transparent hover:bg-gray-100 text-gray-800 dark:text-white dark:hover:bg-gray-800 rounded-full p-1.5 outline-hidden focus:outline-hidden")},m(i,s){ee(i,e,s)},p:kt,d(i){i&&S(e)}}}function FA(n){let e,t,i,s,r=[],a=new Map,o,l,c,h,u=n[39]&&LA(n),d=Qn(n[38]);const f=p=>p[125].id;for(let p=0;p<d.length;p+=1){let y=IA(n,d,p),w=f(y);a.set(w,r[p]=BA(w,y))}let g=n[40]&&UA(n),m=n[41]&&HA(n),b=n[42]&&zA(n);return{c(){e=te("div"),t=Ae(),i=te("div"),u&&u.c(),s=Ae();for(let p=0;p<r.length;p+=1)r[p].c();o=Ae(),g&&g.c(),l=Ae(),m&&m.c(),c=Ae(),b&&b.c(),this.h()},l(p){e=ne(p,"DIV",{class:!0}),V(e).forEach(S),t=Se(p),i=ne(p,"DIV",{class:!0});var y=V(i);u&&u.l(y),s=Se(y);for(let w=0;w<r.length;w+=1)r[w].l(y);o=Se(y),g&&g.l(y),l=Se(y),m&&m.l(y),c=Se(y),b&&b.l(y),y.forEach(S),this.h()},h(){A(e,"class","flex self-center w-[1px] h-4 mx-1.5 bg-gray-50 dark:bg-gray-800"),A(i,"class","flex gap-1 items-center overflow-x-auto scrollbar-none flex-1")},m(p,y){ee(p,e,y),ee(p,t,y),ee(p,i,y),u&&u.m(i,null),q(i,s);for(let w=0;w<r.length;w+=1)r[w]&&r[w].m(i,null);q(i,o),g&&g.m(i,null),q(i,l),m&&m.m(i,null),q(i,c),b&&b.m(i,null),h=!0},p(p,y){p[39]?u?(u.p(p,y),y[1]&256&&L(u,1)):(u=LA(p),u.c(),L(u,1),u.m(i,s)):u&&(ot(),j(u,1,1,()=>{u=null}),lt()),y[0]&16|y[1]&128&&(d=Qn(p[38]),ot(),r=hx(r,y,f,1,p,d,a,i,Z5,BA,o,IA),lt()),p[40]?g?(g.p(p,y),y[1]&512&&L(g,1)):(g=UA(p),g.c(),L(g,1),g.m(i,l)):g&&(ot(),j(g,1,1,()=>{g=null}),lt()),p[41]?m?(m.p(p,y),y[1]&1024&&L(m,1)):(m=HA(p),m.c(),L(m,1),m.m(i,c)):m&&(ot(),j(m,1,1,()=>{m=null}),lt()),p[42]?b?(b.p(p,y),y[1]&2048&&L(b,1)):(b=zA(p),b.c(),L(b,1),b.m(i,null)):b&&(ot(),j(b,1,1,()=>{b=null}),lt())},i(p){if(!h){L(u);for(let y=0;y<d.length;y+=1)L(r[y]);L(g),L(m),L(b),h=!0}},o(p){j(u);for(let y=0;y<r.length;y+=1)j(r[y]);j(g),j(m),j(b),h=!1},d(p){p&&(S(e),S(t),S(i)),u&&u.d();for(let y=0;y<r.length;y+=1)r[y].d();g&&g.d(),m&&m.d(),b&&b.d()}}}function LA(n){let e,t;return e=new Ci({props:{content:n[44].t("{{COUNT}} Available Tools",{COUNT:n[16].length+n[3].length}),$$slots:{default:[xte]},$$scope:{ctx:n}}}),{c(){pe(e.$$.fragment)},l(i){ye(e.$$.fragment,i)},m(i,s){be(e,i,s),t=!0},p(i,s){const r={};s[0]&65544|s[1]&8192&&(r.content=i[44].t("{{COUNT}} Available Tools",{COUNT:i[16].length+i[3].length})),s[0]&67174408|s[4]&128&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(L(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){xe(e,i)}}}function xte(n){let e,t,i,s,r=n[16].length+n[3].length+"",a,o,l,c;return t=new ate({props:{className:"size-4",strokeWidth:"1.75"}}),{c(){e=te("button"),pe(t.$$.fragment),i=Ae(),s=te("span"),a=_t(r),this.h()},l(h){e=ne(h,"BUTTON",{class:!0,"aria-label":!0,type:!0});var u=V(e);ye(t.$$.fragment,u),i=Se(u),s=ne(u,"SPAN",{class:!0});var d=V(s);a=vt(d,r),d.forEach(S),u.forEach(S),this.h()},h(){A(s,"class","text-sm font-medium text-gray-600 dark:text-gray-300"),A(e,"class","translate-y-[0.5px] flex gap-1 items-center text-gray-600 dark:text-gray-300 hover:text-gray-700 dark:hover:text-gray-200 rounded-lg p-1 self-center transition"),A(e,"aria-label","Available Tools"),A(e,"type","button")},m(h,u){ee(h,e,u),be(t,e,null),q(e,i),q(e,s),q(s,a),o=!0,l||(c=pt(e,"click",n[103]),l=!0)},p(h,u){(!o||u[0]&65544)&&r!==(r=h[16].length+h[3].length+"")&&St(a,r)},i(h){o||(L(t.$$.fragment,h),o=!0)},o(h){j(t.$$.fragment,h),o=!1},d(h){h&&S(e),xe(t),l=!1,c()}}}function yte(n){let e,t;return e=new MF({props:{className:"size-4",strokeWidth:"1.75"}}),{c(){pe(e.$$.fragment)},l(i){ye(e.$$.fragment,i)},m(i,s){be(e,i,s),t=!0},p:kt,i(i){t||(L(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){xe(e,i)}}}function wte(n){let e,t,i,s,r;return{c(){e=te("div"),t=te("img"),this.h()},l(a){e=ne(a,"DIV",{class:!0});var o=V(e);t=ne(o,"IMG",{src:!0,class:!0,style:!0,alt:!0}),o.forEach(S),this.h()},h(){k0(t.src,i=n[125].icon)||A(t,"src",i),A(t,"class",s="size-3.5 "+(n[125].icon.includes("svg")?"dark:invert-[80%]":"")),rn(t,"fill","currentColor"),A(t,"alt",r=n[125].name),A(e,"class","size-4 items-center flex justify-center")},m(a,o){ee(a,e,o),q(e,t)},p(a,o){o[1]&128&&!k0(t.src,i=a[125].icon)&&A(t,"src",i),o[1]&128&&s!==(s="size-3.5 "+(a[125].icon.includes("svg")?"dark:invert-[80%]":""))&&A(t,"class",s),o[1]&128&&r!==(r=a[125].name)&&A(t,"alt",r)},i:kt,o:kt,d(a){a&&S(e)}}}function _te(n){var b;let e,t,i,s,r,a=((b=n[125])==null?void 0:b.name)+"",o,l,c,h,u;const d=[wte,yte],f=[];function g(p,y){var w;return(w=p[125])!=null&&w.icon?0:1}t=g(n),i=f[t]=d[t](n);function m(){return n[104](n[125])}return{c(){e=te("button"),i.c(),s=Ae(),r=te("span"),o=_t(a),this.h()},l(p){e=ne(p,"BUTTON",{type:!0,class:!0});var y=V(e);i.l(y),s=Se(y),r=ne(y,"SPAN",{class:!0});var w=V(r);o=vt(w,a),w.forEach(S),y.forEach(S),this.h()},h(){A(r,"class","hidden @xl:block whitespace-nowrap overflow-hidden text-ellipsis leading-none pr-0.5"),A(e,"type","button"),A(e,"class",l="px-2 @xl:px-2.5 py-2 flex gap-1.5 items-center text-sm rounded-full transition-colors duration-300 focus:outline-hidden max-w-full overflow-hidden hover:bg-gray-50 dark:hover:bg-gray-800 "+(n[4].includes(n[125].id)?"text-sky-500 dark:text-sky-300 bg-sky-50 dark:bg-sky-200/5":"bg-transparent text-gray-600 dark:text-gray-300  ")+" capitalize")},m(p,y){ee(p,e,y),f[t].m(e,null),q(e,s),q(e,r),q(r,o),c=!0,h||(u=pt(e,"click",Zg(m)),h=!0)},p(p,y){var _;n=p;let w=t;t=g(n),t===w?f[t].p(n,y):(ot(),j(f[w],1,1,()=>{f[w]=null}),lt(),i=f[t],i?i.p(n,y):(i=f[t]=d[t](n),i.c()),L(i,1),i.m(e,s)),(!c||y[1]&128)&&a!==(a=((_=n[125])==null?void 0:_.name)+"")&&St(o,a),(!c||y[0]&16|y[1]&128&&l!==(l="px-2 @xl:px-2.5 py-2 flex gap-1.5 items-center text-sm rounded-full transition-colors duration-300 focus:outline-hidden max-w-full overflow-hidden hover:bg-gray-50 dark:hover:bg-gray-800 "+(n[4].includes(n[125].id)?"text-sky-500 dark:text-sky-300 bg-sky-50 dark:bg-sky-200/5":"bg-transparent text-gray-600 dark:text-gray-300  ")+" capitalize"))&&A(e,"class",l)},i(p){c||(L(i),c=!0)},o(p){j(i),c=!1},d(p){p&&S(e),f[t].d(),h=!1,u()}}}function BA(n,e){var r;let t,i,s;return i=new Ci({props:{content:(r=e[125])==null?void 0:r.description,placement:"top",$$slots:{default:[_te]},$$scope:{ctx:e}}}),{key:n,first:null,c(){t=Ut(),pe(i.$$.fragment),this.h()},l(a){t=Ut(),ye(i.$$.fragment,a),this.h()},h(){this.first=t},m(a,o){ee(a,t,o),be(i,a,o),s=!0},p(a,o){var c;e=a;const l={};o[1]&128&&(l.content=(c=e[125])==null?void 0:c.description),o[0]&16|o[1]&128|o[4]&128&&(l.$$scope={dirty:o,ctx:e}),i.$set(l)},i(a){s||(L(i.$$.fragment,a),s=!0)},o(a){j(i.$$.fragment,a),s=!1},d(a){a&&S(t),xe(i,a)}}}function UA(n){let e,t;return e=new Ci({props:{content:n[44].t("Search the internet"),placement:"top",$$slots:{default:[vte]},$$scope:{ctx:n}}}),{c(){pe(e.$$.fragment)},l(i){ye(e.$$.fragment,i)},m(i,s){be(e,i,s),t=!0},p(i,s){const r={};s[1]&8192&&(r.content=i[44].t("Search the internet")),s[0]&64|s[1]&12288|s[4]&128&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(L(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){xe(e,i)}}}function vte(n){let e,t,i,s,r=n[44].t("Web Search")+"",a,o,l,c,h;return t=new RF({props:{className:"size-4",strokeWidth:"1.75"}}),{c(){e=te("button"),pe(t.$$.fragment),i=Ae(),s=te("span"),a=_t(r),this.h()},l(u){e=ne(u,"BUTTON",{type:!0,class:!0});var d=V(e);ye(t.$$.fragment,d),i=Se(d),s=ne(d,"SPAN",{class:!0});var f=V(s);a=vt(f,r),f.forEach(S),d.forEach(S),this.h()},h(){var u;A(s,"class","hidden @xl:block whitespace-nowrap overflow-hidden text-ellipsis leading-none pr-0.5"),A(e,"type","button"),A(e,"class",o="px-2 @xl:px-2.5 py-2 flex gap-1.5 items-center text-sm rounded-full transition-colors duration-300 focus:outline-hidden max-w-full overflow-hidden hover:bg-gray-50 dark:hover:bg-gray-800 "+(n[6]||(((u=n[43])==null?void 0:u.webSearch)??!1)==="always"?" text-sky-500 dark:text-sky-300 bg-sky-50 dark:bg-sky-200/5":"bg-transparent text-gray-600 dark:text-gray-300 "))},m(u,d){ee(u,e,d),be(t,e,null),q(e,i),q(e,s),q(s,a),l=!0,c||(h=pt(e,"click",Zg(n[105])),c=!0)},p(u,d){var f;(!l||d[1]&8192)&&r!==(r=u[44].t("Web Search")+"")&&St(a,r),(!l||d[0]&64|d[1]&4096&&o!==(o="px-2 @xl:px-2.5 py-2 flex gap-1.5 items-center text-sm rounded-full transition-colors duration-300 focus:outline-hidden max-w-full overflow-hidden hover:bg-gray-50 dark:hover:bg-gray-800 "+(u[6]||(((f=u[43])==null?void 0:f.webSearch)??!1)==="always"?" text-sky-500 dark:text-sky-300 bg-sky-50 dark:bg-sky-200/5":"bg-transparent text-gray-600 dark:text-gray-300 ")))&&A(e,"class",o)},i(u){l||(L(t.$$.fragment,u),l=!0)},o(u){j(t.$$.fragment,u),l=!1},d(u){u&&S(e),xe(t),c=!1,h()}}}function HA(n){let e,t;return e=new Ci({props:{content:n[44].t("Generate an image"),placement:"top",$$slots:{default:[kte]},$$scope:{ctx:n}}}),{c(){pe(e.$$.fragment)},l(i){ye(e.$$.fragment,i)},m(i,s){be(e,i,s),t=!0},p(i,s){const r={};s[1]&8192&&(r.content=i[44].t("Generate an image")),s[0]&32|s[1]&8192|s[4]&128&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(L(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){xe(e,i)}}}function kte(n){let e,t,i,s,r=n[44].t("Image")+"",a,o,l,c,h;return t=new ite({props:{className:"size-4",strokeWidth:"1.75"}}),{c(){e=te("button"),pe(t.$$.fragment),i=Ae(),s=te("span"),a=_t(r),this.h()},l(u){e=ne(u,"BUTTON",{type:!0,class:!0});var d=V(e);ye(t.$$.fragment,d),i=Se(d),s=ne(d,"SPAN",{class:!0});var f=V(s);a=vt(f,r),f.forEach(S),d.forEach(S),this.h()},h(){A(s,"class","hidden @xl:block whitespace-nowrap overflow-hidden text-ellipsis leading-none pr-0.5"),A(e,"type","button"),A(e,"class",o="px-2 @xl:px-2.5 py-2 flex gap-1.5 items-center text-sm rounded-full transition-colors duration-300 focus:outline-hidden max-w-full overflow-hidden hover:bg-gray-50 dark:hover:bg-gray-800 "+(n[5]?" text-sky-500 dark:text-sky-300 bg-sky-50 dark:bg-sky-200/5":"bg-transparent text-gray-600 dark:text-gray-300 "))},m(u,d){ee(u,e,d),be(t,e,null),q(e,i),q(e,s),q(s,a),l=!0,c||(h=pt(e,"click",Zg(n[106])),c=!0)},p(u,d){(!l||d[1]&8192)&&r!==(r=u[44].t("Image")+"")&&St(a,r),(!l||d[0]&32&&o!==(o="px-2 @xl:px-2.5 py-2 flex gap-1.5 items-center text-sm rounded-full transition-colors duration-300 focus:outline-hidden max-w-full overflow-hidden hover:bg-gray-50 dark:hover:bg-gray-800 "+(u[5]?" text-sky-500 dark:text-sky-300 bg-sky-50 dark:bg-sky-200/5":"bg-transparent text-gray-600 dark:text-gray-300 ")))&&A(e,"class",o)},i(u){l||(L(t.$$.fragment,u),l=!0)},o(u){j(t.$$.fragment,u),l=!1},d(u){u&&S(e),xe(t),c=!1,h()}}}function zA(n){let e,t;return e=new Ci({props:{content:n[44].t("Execute code for analysis"),placement:"top",$$slots:{default:[Cte]},$$scope:{ctx:n}}}),{c(){pe(e.$$.fragment)},l(i){ye(e.$$.fragment,i)},m(i,s){be(e,i,s),t=!0},p(i,s){const r={};s[1]&8192&&(r.content=i[44].t("Execute code for analysis")),s[0]&128|s[1]&12288|s[4]&128&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(L(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){xe(e,i)}}}function Cte(n){let e,t,i,s,r=n[44].t("Code Interpreter")+"",a,o,l,c,h,u;return t=new _D({props:{className:"size-4",strokeWidth:"1.75"}}),{c(){e=te("button"),pe(t.$$.fragment),i=Ae(),s=te("span"),a=_t(r),this.h()},l(d){e=ne(d,"BUTTON",{"aria-label":!0,"aria-pressed":!0,type:!0,class:!0});var f=V(e);ye(t.$$.fragment,f),i=Se(f),s=ne(f,"SPAN",{class:!0});var g=V(s);a=vt(g,r),g.forEach(S),f.forEach(S),this.h()},h(){var d;A(s,"class","hidden @xl:block whitespace-nowrap overflow-hidden text-ellipsis leading-none pr-0.5"),A(e,"aria-label",o=n[7]?n[44].t("Disable Code Interpreter"):n[44].t("Enable Code Interpreter")),A(e,"aria-pressed",n[7]),A(e,"type","button"),A(e,"class",l="px-2 @xl:px-2.5 py-2 flex gap-1.5 items-center text-sm transition-colors duration-300 max-w-full overflow-hidden hover:bg-gray-50 dark:hover:bg-gray-800 "+(n[7]?" text-sky-500 dark:text-sky-300 bg-sky-50 dark:bg-sky-200/5":"bg-transparent text-gray-600 dark:text-gray-300 ")+" "+(((d=n[43])==null?void 0:d.highContrastMode)??!1?"m-1":"focus:outline-hidden rounded-full"))},m(d,f){ee(d,e,f),be(t,e,null),q(e,i),q(e,s),q(s,a),c=!0,h||(u=pt(e,"click",Zg(n[107])),h=!0)},p(d,f){var g;(!c||f[1]&8192)&&r!==(r=d[44].t("Code Interpreter")+"")&&St(a,r),(!c||f[0]&128|f[1]&8192&&o!==(o=d[7]?d[44].t("Disable Code Interpreter"):d[44].t("Enable Code Interpreter")))&&A(e,"aria-label",o),(!c||f[0]&128)&&A(e,"aria-pressed",d[7]),(!c||f[0]&128|f[1]&4096&&l!==(l="px-2 @xl:px-2.5 py-2 flex gap-1.5 items-center text-sm transition-colors duration-300 max-w-full overflow-hidden hover:bg-gray-50 dark:hover:bg-gray-800 "+(d[7]?" text-sky-500 dark:text-sky-300 bg-sky-50 dark:bg-sky-200/5":"bg-transparent text-gray-600 dark:text-gray-300 ")+" "+(((g=d[43])==null?void 0:g.highContrastMode)??!1?"m-1":"focus:outline-hidden rounded-full")))&&A(e,"class",l)},i(d){c||(L(t.$$.fragment,d),c=!0)},o(d){j(t.$$.fragment,d),c=!1},d(d){d&&S(e),xe(t),h=!1,u()}}}function jA(n){let e,t;return e=new Ci({props:{content:n[44].t("Dictate"),$$slots:{default:[Ate]},$$scope:{ctx:n}}}),{c(){pe(e.$$.fragment)},l(i){ye(e.$$.fragment,i)},m(i,s){be(e,i,s),t=!0},p(i,s){const r={};s[1]&8192&&(r.content=i[44].t("Dictate")),s[0]&268435456|s[1]&8192|s[4]&128&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(L(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){xe(e,i)}}}function Ate(n){let e,t='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5 translate-y-[0.5px]"><path d="M7 4a3 3 0 016 0v6a3 3 0 11-6 0V4z"></path><path d="M5.5 9.643a.75.75 0 00-1.5 0V10c0 3.06 2.29 5.585 5.25 5.954V17.5h-1.5a.75.75 0 000 1.5h4.5a.75.75 0 000-1.5h-1.5v-1.546A6.001 6.001 0 0016 10v-.357a.75.75 0 00-1.5 0V10a4.5 4.5 0 01-9 0v-.357z"></path></svg>',i,s;return{c(){e=te("button"),e.innerHTML=t,this.h()},l(r){e=ne(r,"BUTTON",{id:!0,class:!0,type:!0,"aria-label":!0,"data-svelte-h":!0}),Ro(e)!=="svelte-4nqm9k"&&(e.innerHTML=t),this.h()},h(){A(e,"id","voice-input-button"),A(e,"class","text-gray-600 dark:text-gray-300 hover:text-gray-700 dark:hover:text-gray-200 transition rounded-full p-1.5 mr-0.5 self-center"),A(e,"type","button"),A(e,"aria-label","Voice Input")},m(r,a){ee(r,e,a),i||(s=pt(e,"click",n[108]),i=!0)},p:kt,d(r){r&&S(e),i=!1,s()}}}function Ste(n){let e,t,i;return t=new Ci({props:{content:n[44].t("Send message"),$$slots:{default:[Tte]},$$scope:{ctx:n}}}),{c(){e=te("div"),pe(t.$$.fragment),this.h()},l(s){e=ne(s,"DIV",{class:!0});var r=V(e);ye(t.$$.fragment,r),r.forEach(S),this.h()},h(){A(e,"class","flex items-center")},m(s,r){ee(s,e,r),be(t,e,null),i=!0},p(s,r){const a={};r[1]&8192&&(a.content=s[44].t("Send message")),r[0]&6|r[4]&128&&(a.$$scope={dirty:r,ctx:s}),t.$set(a)},i(s){i||(L(t.$$.fragment,s),i=!0)},o(s){j(t.$$.fragment,s),i=!1},d(s){s&&S(e),xe(t)}}}function Ite(n){let e,t,i;return t=new Ci({props:{content:n[44].t("Voice mode"),$$slots:{default:[Rte]},$$scope:{ctx:n}}}),{c(){e=te("div"),pe(t.$$.fragment),this.h()},l(s){e=ne(s,"DIV",{class:!0});var r=V(e);ye(t.$$.fragment,r),r.forEach(S),this.h()},h(){A(e,"class","flex items-center")},m(s,r){ee(s,e,r),be(t,e,null),i=!0},p(s,r){const a={};r[1]&8192&&(a.content=s[44].t("Voice mode")),r[0]&532480|r[1]&45056|r[4]&128&&(a.$$scope={dirty:r,ctx:s}),t.$set(a)},i(s){i||(L(t.$$.fragment,s),i=!0)},o(s){j(t.$$.fragment,s),i=!1},d(s){s&&S(e),xe(t)}}}function Ete(n){let e,t,i;return t=new Ci({props:{content:n[44].t("Stop"),$$slots:{default:[Mte]},$$scope:{ctx:n}}}),{c(){e=te("div"),pe(t.$$.fragment),this.h()},l(s){e=ne(s,"DIV",{class:!0});var r=V(e);ye(t.$$.fragment,r),r.forEach(S),this.h()},h(){A(e,"class","flex items-center")},m(s,r){ee(s,e,r),be(t,e,null),i=!0},p(s,r){const a={};r[1]&8192&&(a.content=s[44].t("Stop")),r[0]&2048|r[4]&128&&(a.$$scope={dirty:r,ctx:s}),t.$set(a)},i(s){i||(L(t.$$.fragment,s),i=!0)},o(s){j(t.$$.fragment,s),i=!1},d(s){s&&S(e),xe(t)}}}function Tte(n){let e,t,i,s,r;return{c(){e=te("button"),t=nt("svg"),i=nt("path"),this.h()},l(a){e=ne(a,"BUTTON",{id:!0,class:!0,type:!0});var o=V(e);t=it(o,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var l=V(t);i=it(l,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),V(i).forEach(S),l.forEach(S),o.forEach(S),this.h()},h(){A(i,"fill-rule","evenodd"),A(i,"d","M8 14a.75.75 0 0 1-.75-.75V4.56L4.03 7.78a.75.75 0 0 1-1.06-1.06l4.5-4.5a.75.75 0 0 1 1.06 0l4.5 4.5a.75.75 0 0 1-1.06 1.06L8.75 4.56v8.69A.75.75 0 0 1 8 14Z"),A(i,"clip-rule","evenodd"),A(t,"xmlns","http://www.w3.org/2000/svg"),A(t,"viewBox","0 0 16 16"),A(t,"fill","currentColor"),A(t,"class","size-5"),A(e,"id","send-message-button"),A(e,"class",s=(n[1]===""&&n[2].length===0?"text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled":"bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 ")+" transition rounded-full p-1.5 self-center"),A(e,"type","submit"),e.disabled=r=n[1]===""&&n[2].length===0},m(a,o){ee(a,e,o),q(e,t),q(t,i)},p(a,o){o[0]&6&&s!==(s=(a[1]===""&&a[2].length===0?"text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled":"bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 ")+" transition rounded-full p-1.5 self-center")&&A(e,"class",s),o[0]&6&&r!==(r=a[1]===""&&a[2].length===0)&&(e.disabled=r)},d(a){a&&S(e)}}}function Rte(n){let e,t,i,s,r,a;return t=new cte({props:{className:"size-5",strokeWidth:"2.5"}}),{c(){e=te("button"),pe(t.$$.fragment),this.h()},l(o){e=ne(o,"BUTTON",{class:!0,type:!0,"aria-label":!0});var l=V(e);ye(t.$$.fragment,l),l.forEach(S),this.h()},h(){A(e,"class","bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full p-1.5 self-center"),A(e,"type","button"),A(e,"aria-label",i=n[44].t("Voice mode"))},m(o,l){ee(o,e,l),be(t,e,null),s=!0,r||(a=pt(e,"click",n[110]),r=!0)},p(o,l){(!s||l[1]&8192&&i!==(i=o[44].t("Voice mode")))&&A(e,"aria-label",i)},i(o){s||(L(t.$$.fragment,o),s=!0)},o(o){j(t.$$.fragment,o),s=!1},d(o){o&&S(e),xe(t),r=!1,a()}}}function Mte(n){let e,t='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="size-5"><path fill-rule="evenodd" d="M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12zm6-2.438c0-.724.588-1.312 1.313-1.312h4.874c.725 0 1.313.588 1.313 1.313v4.874c0 .725-.588 1.313-1.313 1.313H9.564a1.312 1.312 0 01-1.313-1.313V9.564z" clip-rule="evenodd"></path></svg>',i,s;return{c(){e=te("button"),e.innerHTML=t,this.h()},l(r){e=ne(r,"BUTTON",{class:!0,"data-svelte-h":!0}),Ro(e)!=="svelte-nqxd5x"&&(e.innerHTML=t),this.h()},h(){A(e,"class","bg-white hover:bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-white dark:hover:bg-gray-800 transition rounded-full p-1.5")},m(r,a){ee(r,e,a),i||(s=pt(e,"click",n[109]),i=!0)},p:kt,d(r){r&&S(e),i=!1,s()}}}function Pte(n){let e;return{c(){e=te("div"),this.h()},l(t){e=ne(t,"DIV",{class:!0}),V(e).forEach(S),this.h()},h(){A(e,"class","mb-1")},m(t,i){ee(t,e,i)},p:kt,d(t){t&&S(e)}}}function Nte(n){var s,r;let e,t,i=_3.sanitize(Pg((r=(s=n[19])==null?void 0:s.license_metadata)==null?void 0:r.input_footer))+"";return{c(){e=te("div"),t=new r4(!1),this.h()},l(a){e=ne(a,"DIV",{class:!0});var o=V(e);t=a4(o,!1),o.forEach(S),this.h()},h(){t.a=null,A(e,"class","text-xs text-gray-500 text-center line-clamp-1 marked")},m(a,o){ee(a,e,o),t.m(i,e)},p(a,o){var l,c;o[0]&524288&&i!==(i=_3.sanitize(Pg((c=(l=a[19])==null?void 0:l.license_metadata)==null?void 0:c.input_footer))+"")&&t.p(i)},d(a){a&&S(e)}}}function Ote(n){let e,t,i,s,r,a,o,l,c,h;e=new EF({props:{show:n[34]}});function u(b){n[61](b)}let d={selectedToolIds:n[3]};n[26]!==void 0&&(d.show=n[26]),i=new ete({props:d}),At.push(()=>qt(i,"show",u));function f(b){n[63](b)}let g={variables:n[24],onSave:n[62]};n[23]!==void 0&&(g.show=n[23]),a=new TD({props:g}),At.push(()=>qt(a,"show",f));let m=n[27]&&TA(n);return{c(){pe(e.$$.fragment),t=Ae(),pe(i.$$.fragment),r=Ae(),pe(a.$$.fragment),l=Ae(),m&&m.c(),c=Ut()},l(b){ye(e.$$.fragment,b),t=Se(b),ye(i.$$.fragment,b),r=Se(b),ye(a.$$.fragment,b),l=Se(b),m&&m.l(b),c=Ut()},m(b,p){be(e,b,p),ee(b,t,p),be(i,b,p),ee(b,r,p),be(a,b,p),ee(b,l,p),m&&m.m(b,p),ee(b,c,p),h=!0},p(b,p){const y={};p[1]&8&&(y.show=b[34]),e.$set(y);const w={};p[0]&8&&(w.selectedToolIds=b[3]),!s&&p[0]&67108864&&(s=!0,w.show=b[26],Wt(()=>s=!1)),i.$set(w);const _={};p[0]&16777216&&(_.variables=b[24]),p[0]&33554432&&(_.onSave=b[62]),!o&&p[0]&8388608&&(o=!0,_.show=b[23],Wt(()=>o=!1)),a.$set(_),b[27]?m?(m.p(b,p),p[0]&134217728&&L(m,1)):(m=TA(b),m.c(),L(m,1),m.m(c.parentNode,c)):m&&(ot(),j(m,1,1,()=>{m=null}),lt())},i(b){h||(L(e.$$.fragment,b),L(i.$$.fragment,b),L(a.$$.fragment,b),L(m),h=!0)},o(b){j(e.$$.fragment,b),j(i.$$.fragment,b),j(a.$$.fragment,b),j(m),h=!1},d(b){b&&(S(t),S(r),S(l),S(c)),xe(e,b),xe(i,b),xe(a,b),m&&m.d(b)}}}function Dte(n,e,t){let i,s,r,a,o,l,c,h;Pe(n,$g,$=>t(19,i=$)),Pe(n,Ya,$=>t(43,s=$)),Pe(n,Gd,$=>t(113,a=$)),Pe(n,T0,$=>t(20,o=$)),Pe(n,em,$=>t(21,l=$)),Pe(n,cx,$=>t(45,c=$)),Pe(n,r8,$=>t(46,h=$)),Ql.workerSrc=import.meta.url+"pdfjs-dist/build/pdf.worker.mjs";const u=eo(),d=hs("i18n");Pe(n,d,$=>t(44,r=$));let{onChange:f=()=>{}}=e,{createMessagePair:g}=e,{stopResponse:m}=e,{autoScroll:b=!1}=e,{generating:p=!1}=e,{atSelectedModel:y=void 0}=e,{selectedModels:w}=e,_=[],{history:v}=e,{taskIds:C=null}=e,{prompt:k=""}=e,{files:I=[]}=e,{toolServers:E=[]}=e,{selectedToolIds:T=[]}=e,{selectedFilterIds:M=[]}=e,{imageGenerationEnabled:D=!1}=e,{webSearchEnabled:H=!1}=e,{codeInterpreterEnabled:R=!1}=e,z=!1,P={},B={};const Z=async $=>{t(24,P=YD($)),Object.keys(P).length>0&&t(23,z=!0)},G=async $=>{if($.includes("{{CLIPBOARD}}")){const Ve=await navigator.clipboard.readText().catch(Ze=>(Jt.error(r.t("Failed to read clipboard contents")),"{{CLIPBOARD}}")),xt=await navigator.clipboard.read();let wt=null;for(const Ze of xt)for(const Tt of Ze.types)if(Tt.startsWith("image/")){const ii=await Ze.getType(Tt);wt=URL.createObjectURL(ii)}wt&&t(2,I=[...I,{type:"image",url:wt}]),$=$.replaceAll("{{CLIPBOARD}}",Ve)}if($.includes("{{USER_LOCATION}}")){let Ve;try{Ve=await jD()}catch{Jt.error(r.t("Location access not allowed")),Ve="LOCATION_UNKNOWN"}$=$.replaceAll("{{USER_LOCATION}}",String(Ve))}if($.includes("{{USER_NAME}}")){const Ve=(o==null?void 0:o.name)||"User";$=$.replaceAll("{{USER_NAME}}",Ve)}if($.includes("{{USER_LANGUAGE}}")){const Ve=localStorage.getItem("locale")||"en-US";$=$.replaceAll("{{USER_LANGUAGE}}",Ve)}if($.includes("{{CURRENT_DATE}}")){const Ve=GD();$=$.replaceAll("{{CURRENT_DATE}}",Ve)}if($.includes("{{CURRENT_TIME}}")){const Ve=VD();$=$.replaceAll("{{CURRENT_TIME}}",Ve)}if($.includes("{{CURRENT_DATETIME}}")){const Ve=qD();$=$.replaceAll("{{CURRENT_DATETIME}}",Ve)}if($.includes("{{CURRENT_TIMEZONE}}")){const Ve=WD();$=$.replaceAll("{{CURRENT_TIMEZONE}}",Ve)}if($.includes("{{CURRENT_WEEKDAY}}")){const Ve=KD();$=$.replaceAll("{{CURRENT_WEEKDAY}}",Ve)}return Z($),$},Y=$=>{const Ve=document.getElementById("chat-input");if(Ve)if((s==null?void 0:s.richTextInput)??!0)le.replaceVariables($),le.focus();else{const wt=(Ve.value||"").replace(/{{\s*([^|}]+)(?:\|[^}]*)?\s*}}/g,(Ze,Tt)=>{const ii=Tt.trim();return $.hasOwnProperty(ii)?String($[ii]):Ze});Ve.value=wt,Ve.focus(),Ve.dispatchEvent(new Event("input",{bubbles:!0}))}},J=async $=>{const Ve=document.getElementById("chat-input");Ve&&($=await G($||""),(s==null?void 0:s.richTextInput)??!0?(le==null||le.setText($),le==null||le.focus()):(Ve.value=$,t(1,k=$),Ve.focus(),Ve.dispatchEvent(new Event("input"))))},se=()=>{const $=(wt,Ze)=>{var wi,ai;if(typeof wt!="string"||Ze==null)return"";const Tt=wt.slice(0,Ze),ii=wt.slice(Ze),fs=((wi=Tt.match(/(?:^|\s)([^\s]*)$/))==null?void 0:wi[1])||"",_r=((ai=ii.match(/^([^\s]*)/))==null?void 0:ai[1])||"";return fs+_r},Ve=document.getElementById("chat-input");let xt="";if(Ve)if((s==null?void 0:s.richTextInput)??!0)xt=le==null?void 0:le.getWordAtDocPos();else{const wt=Ve?Ve.selectionStart:k.length;xt=$(k,wt)}return xt},fe=$=>{const Ve=(wt,Ze)=>{let Tt=Ze,ii=Ze;for(;Tt>0&&!/\s/.test(wt[Tt-1]);)--Tt;for(;ii<wt.length&&!/\s/.test(wt[ii]);)++ii;return{start:Tt,end:ii}},xt=document.getElementById("chat-input");if(xt)if((s==null?void 0:s.richTextInput)??!0)le==null||le.replaceCommandWithText($);else{const wt=xt.selectionStart,{start:Ze,end:Tt}=Ve(k,wt);t(1,k=k.slice(0,Ze)+$+k.slice(Tt)),xt.focus(),xt.setSelectionRange(Ze+$.length,Ze+$.length)}},he=async $=>{const Ve=document.getElementById("chat-input");if(!Ve)return;if($=await G($),de)fe($);else if((s==null?void 0:s.richTextInput)??!0)le==null||le.insertContent($);else{const wt=Ve.selectionStart;t(1,k=k.slice(0,wt)+$+k.slice(wt)),Ve.focus(),Ve.setSelectionRange(wt+$.length,wt+$.length)}await hn();const xt=document.getElementById("chat-input-container");if(xt&&(xt.scrollTop=xt.scrollHeight),await hn(),Ve){Ve.focus(),Ve.dispatchEvent(new Event("input"));const wt=xv(k);if(wt.length>0){const Ze=wt.at(0);if(await hn(),!((s==null?void 0:s.richTextInput)??!0)){Ve.setSelectionRange(Ze.startIndex,Ze.endIndex+1),Ve.focus();const Tt=((Ze==null?void 0:Ze.startIndex)-(Ze==null?void 0:Ze.startIndex)%Ve.cols)/Ve.cols,ii=Ve.clientHeight/Ve.rows;Ve.scrollTop=ii*Tt}}else Ve.scrollTop=Ve.scrollHeight}};let de="",{showCommands:ge=!1}=e,N=!1,K=!1,oe=!1,W=!1,le,ce,Ce,X,Ke=!1,qe=!1,{placeholder:He=""}=e,Me=[],Ne=[],Qe=[],gt=[],mt=[],Xe=[],rt=!1,me=!1,Rt=!1,ct=!1;const at=()=>{const $=document.getElementById("messages-container");$.scrollTo({top:$.scrollHeight,behavior:"smooth"})},ze=async()=>{try{const $=await navigator.mediaDevices.getDisplayMedia({video:{cursor:"never"},audio:!1}),Ve=document.createElement("video");Ve.srcObject=$,await Ve.play();const xt=document.createElement("canvas");xt.width=Ve.videoWidth,xt.height=Ve.videoHeight,xt.getContext("2d").drawImage(Ve,0,0,xt.width,xt.height),$.getTracks().forEach(Tt=>Tt.stop()),window.focus();const Ze=xt.toDataURL("image/png");t(2,I=[...I,{type:"image",url:Ze}]),Ve.srcObject=null}catch($){console.error("Error capturing screen:",$)}},Ht=async($,Ve=!1)=>{var Ze,Tt,ii,fs,_r,wi,ai,ci,jn;if((o==null?void 0:o.role)!=="admin"&&!(((Tt=(Ze=o==null?void 0:o.permissions)==null?void 0:Ze.chat)==null?void 0:Tt.file_upload)??!0))return Jt.error(r.t("You do not have permission to upload files.")),null;if(Ne.length!==w.length)return Jt.error(r.t("Model(s) do not support file upload")),null;const xt=Rl(),wt={type:"file",file:"",id:null,url:"",name:$.name,collection_name:"",status:"uploading",size:$.size,error:"",itemId:xt,...Ve?{context:"full"}:{}};if(wt.size==0)return Jt.error(r.t("You cannot upload an empty file.")),null;if(t(2,I=[...I,wt]),a){const Q=await zD($,pdfjsLib).catch(we=>(Jt.error(r.t("Failed to extract content from the file: {{error}}",{error:we})),null));if(Q===null)return Jt.error(r.t("Failed to extract content from the file.")),t(2,I=I.filter(we=>(we==null?void 0:we.itemId)!==xt)),null;$.name,$.size,wt.status="uploaded",wt.type="text",wt.content=Q,wt.id=Rl(),t(2,I)}else try{let Q=null;($.type.startsWith("audio/")||$.type.startsWith("video/"))&&((fs=(ii=s==null?void 0:s.audio)==null?void 0:ii.stt)!=null&&fs.language)&&(Q={language:(wi=(_r=s==null?void 0:s.audio)==null?void 0:_r.stt)==null?void 0:wi.language});const we=await _F(localStorage.token,$,Q);if(we){if(we.id,wt.name,(ai=we==null?void 0:we.meta)==null||ai.collection_name,we.error&&(console.warn("File upload warning:",we.error),Jt.warning(we.error)),wt.status="uploaded",wt.file=we,wt.id=we.id,wt.collection_name=((ci=we==null?void 0:we.meta)==null?void 0:ci.collection_name)||(we==null?void 0:we.collection_name),wt.url=`${OD}/files/${we.id}`,t(2,I),$.type.startsWith("audio/")&&((jn=we.data)!=null&&jn.content)){const Fe=we.data.content.replace(/(SPEAKER_\d{2}:)/g,`
$1`).trim();J(Fe+`
`)}}else t(2,I=I.filter(Fe=>(Fe==null?void 0:Fe.itemId)!==xt))}catch(Q){Jt.error(`${Q}`),t(2,I=I.filter(we=>(we==null?void 0:we.itemId)!==xt))}},on=async $=>{var Ve,xt,wt;if((((Ve=i==null?void 0:i.file)==null?void 0:Ve.max_count)??null)!==null&&I.length+$.length>((xt=i==null?void 0:i.file)==null?void 0:xt.max_count)){Jt.error(r.t("You can only chat with a maximum of {{maxCount}} file(s) at a time.",{maxCount:(wt=i==null?void 0:i.file)==null?void 0:wt.max_count}));return}$.forEach(async Ze=>{var Tt,ii,fs,_r;if(Ze.name,Ze.type,Ze.size,Ze.name.split(".").at(-1),(((Tt=i==null?void 0:i.file)==null?void 0:Tt.max_size)??null)!==null&&Ze.size>(((ii=i==null?void 0:i.file)==null?void 0:ii.max_size)??0)*1024*1024){Ze.size,(((fs=i==null?void 0:i.file)==null?void 0:fs.max_size)??0)*1024*1024,Jt.error(r.t("File size should not exceed {{maxSize}} MB.",{maxSize:(_r=i==null?void 0:i.file)==null?void 0:_r.max_size}));return}if(Ze.type.startsWith("image/")){if(Me.length===0){Jt.error(r.t("Selected model(s) do not support image inputs"));return}const wi=async(ci,jn={},Q={})=>{var It,Vt,Pt,Un,In,pn;const we=(jn==null?void 0:jn.imageCompression)??!1,Fe=((Vt=(It=Q==null?void 0:Q.file)==null?void 0:It.image_compression)==null?void 0:Vt.width)??null,bt=((Un=(Pt=Q==null?void 0:Q.file)==null?void 0:Pt.image_compression)==null?void 0:Un.height)??null;if(!we&&!Fe&&!bt)return ci;let st=null,$e=null;return we&&(st=((In=jn==null?void 0:jn.imageCompressionSize)==null?void 0:In.width)??null,$e=((pn=jn==null?void 0:jn.imageCompressionSize)==null?void 0:pn.height)??null),Fe&&(st===null||st>Fe)&&(st=Fe),bt&&($e===null||$e>bt)&&($e=bt),st||$e?await XD(ci,st,$e):ci};let ai=new FileReader;ai.onload=async ci=>{let jn=ci.target.result;jn=await wi(jn,s,i),t(2,I=[...I,{type:"image",url:`${jn}`}])},ai.readAsDataURL(Ze.type==="image/heic"?await MD({blob:Ze,toType:"image/jpeg"}):Ze)}else Ht(Ze)})},Re=$=>{var Ve,xt;$.preventDefault(),(xt=(Ve=$.dataTransfer)==null?void 0:Ve.types)!=null&&xt.includes("Files")?t(34,Ke=!0):t(34,Ke=!1)},Mt=()=>{t(34,Ke=!1)},yt=async $=>{var Ve,xt;if($.preventDefault(),(Ve=$.dataTransfer)!=null&&Ve.files){const wt=Array.from((xt=$.dataTransfer)==null?void 0:xt.files);wt&&wt.length>0&&on(wt)}t(34,Ke=!1)},Gt=$=>{$.key==="Shift"&&t(35,qe=!0),$.key==="Escape"&&t(34,Ke=!1)},un=$=>{$.key==="Shift"&&t(35,qe=!1)},Kn=()=>{},di=()=>{t(35,qe=!1)};fl(async()=>{t(27,K=!0),window.setTimeout(()=>{const Ve=document.getElementById("chat-input");Ve==null||Ve.focus()},0),window.addEventListener("keydown",Gt),window.addEventListener("keyup",un),window.addEventListener("focus",Kn),window.addEventListener("blur",di),await hn();const $=document.getElementById("chat-container");$==null||$.addEventListener("dragover",Re),$==null||$.addEventListener("drop",yt),$==null||$.addEventListener("dragleave",Mt)}),$h(()=>{window.removeEventListener("keydown",Gt),window.removeEventListener("keyup",un),window.removeEventListener("focus",Kn),window.removeEventListener("blur",di);const $=document.getElementById("chat-container");$&&($==null||$.removeEventListener("dragover",Re),$==null||$.removeEventListener("drop",yt),$==null||$.removeEventListener("dragleave",Mt))});function qi($){N=$,t(26,N)}const Cs=$=>{t(25,B={...B,...$}),Y(B)};function Wi($){z=$,t(23,z)}const Ms=()=>{t(8,b=!0),at()},Ki=$=>$.id===y.id,yi=()=>{t(0,y=void 0)},yr=$=>{const{type:Ve,data:xt}=$;if(Ve==="file"){if(I.find(wt=>wt.id===xt.id))return;t(2,I=[...I,{...xt,status:"processed"}])}else u("upload",$)},Ps=$=>{var wt;const{type:Ve,data:xt}=$;Ve==="model"&&t(0,y=xt),(wt=document.getElementById("chat-input"))==null||wt.focus()};function Ns($){At[$?"unshift":"push"](()=>{Ce=$,t(32,Ce)})}function Oe($){I=$,t(2,I)}function je($){At[$?"unshift":"push"](()=>{ce=$,t(31,ce)})}function ht(){X=this.files,t(33,X)}const Xt=async()=>{if(X&&X.length>0){const $=Array.from(X);on($)}else Jt.error(r.t("File not found."));t(31,ce.value="",ce)},tn=async()=>{var $;t(28,oe=!1),await hn(),($=document.getElementById("chat-input"))==null||$.focus()},En=async $=>{var wt;const{text:Ve,filename:xt}=$;t(28,oe=!1),await hn(),he(Ve),await hn(),(wt=document.getElementById("chat-input"))==null||wt.focus(),((s==null?void 0:s.speechAutoSend)??!1)&&u("submit",k)};function mn($){oe=$,t(28,oe)}const Pn=$=>!Me.includes($),Bn=$=>{I.splice($,1),t(2,I)},xl=async $=>{I.splice($,1),t(2,I)},wr=$=>{},om=$=>{t(1,k=$.md),t(18,de=se())},lm=async $=>{(_.length===0||!_.at(0))&&Jt.error(r.t("Please select a model first."));const Ve=await hF(localStorage.token,_.at(0),$,v!=null&&v.currentId?da(v,v.currentId):null).catch(xt=>null);return Ve},cm=()=>t(29,W=!0),hm=()=>t(29,W=!1);function um($){At[$?"unshift":"push"](()=>{le=$,t(30,le)})}const dm=async $=>{var wt;$=$.detail.event;const Ve=$.ctrlKey||$.metaKey,xt=document.getElementById("commands-container");if($.key==="Escape"&&m(),Ve&&$.key==="Enter"&&$.shiftKey&&($.preventDefault(),g(k)),k===""&&Ve&&$.key.toLowerCase()==="r"){$.preventDefault();const Ze=[...document.getElementsByClassName("regenerate-response-button")].at(-1);Ze==null||Ze.click()}if(k===""&&$.key=="ArrowUp"){$.preventDefault();const Ze=[...document.getElementsByClassName("user-message")].at(-1);if(Ze){Ze.scrollIntoView({block:"center"});const Tt=[...document.getElementsByClassName("edit-user-message-button")].at(-1);Tt==null||Tt.click()}}if(xt){if(xt&&$.key==="ArrowUp"&&($.preventDefault(),Ce.selectUp(),[...document.getElementsByClassName("selected-command-option-button")].at(-1).scrollIntoView({block:"center"})),xt&&$.key==="ArrowDown"&&($.preventDefault(),Ce.selectDown(),[...document.getElementsByClassName("selected-command-option-button")].at(-1).scrollIntoView({block:"center"})),xt&&$.key==="Tab"){$.preventDefault();const Ze=[...document.getElementsByClassName("selected-command-option-button")].at(-1);Ze==null||Ze.click()}if(xt&&$.key==="Enter"){$.preventDefault();const Ze=[...document.getElementsByClassName("selected-command-option-button")].at(-1);Ze?Ze==null||Ze.click():(wt=document.getElementById("send-message-button"))==null||wt.click()}}else if(!c||!("ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0)){if(W)return;((s==null?void 0:s.ctrlEnterToSend)??!1?($.key==="Enter"||$.keyCode===13)&&Ve:($.key==="Enter"||$.keyCode===13)&&!$.shiftKey)&&($.preventDefault(),(k!==""||I.length>0)&&u("submit",k))}$.key==="Escape"&&(t(0,y=void 0),t(3,T=[]),t(4,M=[]),t(6,H=!1),t(5,D=!1),t(7,R=!1))},fm=async $=>{$=$.detail.event;const Ve=$.clipboardData||window.clipboardData;if(Ve&&Ve.items){for(const xt of Ve.items)if(xt.type.indexOf("image")!==-1){const wt=xt.getAsFile(),Ze=new FileReader;Ze.onload=function(Tt){t(2,I=[...I,{type:"image",url:`${Tt.target.result}`}])},Ze.readAsDataURL(wt)}else if((xt==null?void 0:xt.kind)==="file"){const wt=xt.getAsFile();wt&&(await on([wt]),$.preventDefault())}else if(xt.type==="text/plain"&&((s==null?void 0:s.largeTextAsFile)??!1)&&!qe){const wt=Ve.getData("text/plain");if(wt.length>pv){$.preventDefault();const Ze=new Blob([wt],{type:"text/plain"}),Tt=new File([Ze],`Pasted_Text_${Date.now()}.txt`,{type:"text/plain"});await Ht(Tt,!0)}}}};function gm($){At[$?"unshift":"push"](()=>{le=$,t(30,le)})}function mm(){k=this.value,t(1,k)}const pm=()=>{t(18,de=se())},bm=()=>{t(18,de=se())},xm=()=>t(29,W=!0),ym=()=>t(29,W=!1),wm=async $=>{var wt;const Ve=$.ctrlKey||$.metaKey,xt=document.getElementById("commands-container");if($.key==="Escape"&&m(),Ve&&$.key==="Enter"&&$.shiftKey&&($.preventDefault(),g(k)),k===""&&Ve&&$.key.toLowerCase()==="r"){$.preventDefault();const Ze=[...document.getElementsByClassName("regenerate-response-button")].at(-1);Ze==null||Ze.click()}if(k===""&&$.key=="ArrowUp"){$.preventDefault();const Ze=[...document.getElementsByClassName("user-message")].at(-1),Tt=[...document.getElementsByClassName("edit-user-message-button")].at(-1);Ze==null||Ze.scrollIntoView({block:"center"}),Tt==null||Tt.click()}if(xt){if(xt&&$.key==="ArrowUp"){$.preventDefault(),Ce.selectUp();const Ze=document.getElementById("command-options-container"),Tt=[...document.getElementsByClassName("selected-command-option-button")].at(-1);if(Tt&&Ze){const ii=Tt.offsetTop,fs=Tt.offsetHeight,_r=Ze.clientHeight;Ze.scrollTop=ii-_r/2+fs/2}}if(xt&&$.key==="ArrowDown"){$.preventDefault(),Ce.selectDown();const Ze=document.getElementById("command-options-container"),Tt=[...document.getElementsByClassName("selected-command-option-button")].at(-1);if(Tt&&Ze){const ii=Tt.offsetTop,fs=Tt.offsetHeight,_r=Ze.clientHeight;Ze.scrollTop=ii-_r/2+fs/2}}if(xt&&$.key==="Enter"){$.preventDefault();const Ze=[...document.getElementsByClassName("selected-command-option-button")].at(-1);$.shiftKey?t(1,k=`${k}
`):Ze?Ze==null||Ze.click():(wt=document.getElementById("send-message-button"))==null||wt.click()}if(xt&&$.key==="Tab"){$.preventDefault();const Ze=[...document.getElementsByClassName("selected-command-option-button")].at(-1);Ze==null||Ze.click()}}else if(!c||!("ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0)){if(W)return;const Ze=$.ctrlKey||$.metaKey,Tt=(s==null?void 0:s.ctrlEnterToSend)??!1?($.key==="Enter"||$.keyCode===13)&&Ze:($.key==="Enter"||$.keyCode===13)&&!$.shiftKey;Tt&&$.preventDefault(),(k!==""||I.length>0)&&Tt&&u("submit",k)}if($.key==="Tab"){const Ze=xv(k);if(Ze.length>0){const Tt=Ze.at(0);if(Tt&&$.target instanceof HTMLTextAreaElement){$.preventDefault(),$.target.setSelectionRange(Tt==null?void 0:Tt.startIndex,Tt.endIndex+1),$.target.focus();const ii=((Tt==null?void 0:Tt.startIndex)-(Tt==null?void 0:Tt.startIndex)%$.target.cols)/$.target.cols,fs=$.target.clientHeight/$.target.rows;$.target.scrollTop=fs*ii}}$.target.style.height="",$.target.style.height=Math.min($.target.scrollHeight,320)+"px"}$.key==="Escape"&&(t(0,y=void 0),t(3,T=[]),t(4,M=[]),t(6,H=!1),t(5,D=!1),t(7,R=!1))},_m=async $=>{$.target.style.height="",$.target.style.height=Math.min($.target.scrollHeight,320)+"px"},ke=async $=>{$.target.style.height="",$.target.style.height=Math.min($.target.scrollHeight,320)+"px"},Gy=async $=>{const Ve=$.clipboardData||window.clipboardData;if(Ve&&Ve.items){for(const xt of Ve.items)if(xt.type.indexOf("image")!==-1){const wt=xt.getAsFile(),Ze=new FileReader;Ze.onload=function(Tt){t(2,I=[...I,{type:"image",url:`${Tt.target.result}`}])},Ze.readAsDataURL(wt)}else if((xt==null?void 0:xt.kind)==="file"){const wt=xt.getAsFile();wt&&(await on([wt]),$.preventDefault())}else if(xt.type==="text/plain"&&((s==null?void 0:s.largeTextAsFile)??!1)&&!qe){const wt=Ve.getData("text/plain");if(wt.length>pv){$.preventDefault();const Ze=new Blob([wt],{type:"text/plain"}),Tt=new File([Ze],`Pasted_Text_${Date.now()}.txt`,{type:"text/plain"});await Ht(Tt,!0)}}}},Vy=()=>{ce.click()},qy=async()=>{try{const $=await JJ();if($){const Ve=new File([$.blob],$.name,{type:$.blob.type});await Ht(Ve)}}catch($){console.error("Google Drive Error:",$),Jt.error(r.t("Error accessing Google Drive: {{error}}",{error:$.message}))}},Wy=async $=>{try{const Ve=await Tee($);if(Ve){const xt=new File([Ve.blob],Ve.name,{type:Ve.blob.type||"application/octet-stream"});await Ht(xt)}}catch(Ve){console.error("OneDrive Error:",Ve)}},Ky=async()=>{await hn();const $=document.getElementById("chat-input");$==null||$.focus()};function Xy($){T=$,t(3,T)}const Yy=()=>{t(26,N=!N)},Jy=$=>{M.includes($.id)?t(4,M=M.filter(Ve=>Ve!==$.id)):t(4,M=[...M,$.id])},Zy=()=>t(6,H=!H),Qy=()=>t(5,D=!D),$y=()=>t(7,R=!R),ew=async()=>{try{let $=await navigator.mediaDevices.getUserMedia({audio:!0}).catch(function(Ve){return Jt.error(r.t("Permission denied when accessing microphone: {{error}}",{error:Ve})),null});$&&(t(28,oe=!0),$.getTracks().forEach(xt=>xt.stop())),$=null}catch{Jt.error(r.t("Permission denied when accessing microphone"))}},tw=()=>{m()},nw=async()=>{var $,Ve,xt,wt,Ze;if(w.length>1){Jt.error(r.t("Select only one model to call"));return}if(i.audio.stt.engine==="web"){Jt.error(r.t("Call feature is not supported when using Web STT engine"));return}try{let Tt=await navigator.mediaDevices.getUserMedia({audio:!0});Tt&&Tt.getTracks().forEach(fs=>fs.stop()),Tt=null,((Ve=($=s.audio)==null?void 0:$.tts)==null?void 0:Ve.engine)==="browser-kokoro"&&(h||(await r8.set(new PF({dtype:((Ze=(wt=(xt=s.audio)==null?void 0:xt.tts)==null?void 0:wt.engineConfig)==null?void 0:Ze.dtype)??"fp32"})),await h.init())),Va.set(!0),Qi.set(!0)}catch{Jt.error(r.t("Permission denied when accessing media devices"))}},iw=()=>{u("submit",k)};return n.$$set=$=>{"onChange"in $&&t(56,f=$.onChange),"createMessagePair"in $&&t(10,g=$.createMessagePair),"stopResponse"in $&&t(11,m=$.stopResponse),"autoScroll"in $&&t(8,b=$.autoScroll),"generating"in $&&t(12,p=$.generating),"atSelectedModel"in $&&t(0,y=$.atSelectedModel),"selectedModels"in $&&t(13,w=$.selectedModels),"history"in $&&t(14,v=$.history),"taskIds"in $&&t(15,C=$.taskIds),"prompt"in $&&t(1,k=$.prompt),"files"in $&&t(2,I=$.files),"toolServers"in $&&t(16,E=$.toolServers),"selectedToolIds"in $&&t(3,T=$.selectedToolIds),"selectedFilterIds"in $&&t(4,M=$.selectedFilterIds),"imageGenerationEnabled"in $&&t(5,D=$.imageGenerationEnabled),"webSearchEnabled"in $&&t(6,H=$.webSearchEnabled),"codeInterpreterEnabled"in $&&t(7,R=$.codeInterpreterEnabled),"showCommands"in $&&t(9,ge=$.showCommands),"placeholder"in $&&t(17,He=$.placeholder)},n.$$.update=()=>{var $,Ve,xt,wt,Ze,Tt,ii,fs,_r;n.$$.dirty[0]&8193&&t(22,_=y!==void 0?[y.id]:w),n.$$.dirty[0]&254|n.$$.dirty[1]&33554432&&f({prompt:k,files:I.filter(wi=>wi.type!=="image").map(wi=>({...wi,user:void 0,access_control:void 0})),selectedToolIds:T,selectedFilterIds:M,imageGenerationEnabled:D,webSearchEnabled:H,codeInterpreterEnabled:R}),n.$$.dirty[0]&262144&&t(9,ge=["/","#","@"].includes(de==null?void 0:de.charAt(0))||(de==null?void 0:de.slice(0,2))==="\\#"),n.$$.dirty[0]&2105345&&t(36,Me=(y!=null&&y.id?[y.id]:w).filter(wi=>{var ai,ci,jn,Q;return((Q=(jn=(ci=(ai=l.find(we=>we.id===wi))==null?void 0:ai.info)==null?void 0:ci.meta)==null?void 0:jn.capabilities)==null?void 0:Q.vision)??!0})),n.$$.dirty[0]&2105345&&t(37,Ne=(y!=null&&y.id?[y.id]:w).filter(wi=>{var ai,ci,jn,Q;return((Q=(jn=(ci=(ai=l.find(we=>we.id===wi))==null?void 0:ai.info)==null?void 0:ci.meta)==null?void 0:jn.capabilities)==null?void 0:Q.file_upload)??!0})),n.$$.dirty[0]&2105345&&t(58,Qe=(y!=null&&y.id?[y.id]:w).filter(wi=>{var ai,ci,jn,Q;return((Q=(jn=(ci=(ai=l.find(we=>we.id===wi))==null?void 0:ai.info)==null?void 0:ci.meta)==null?void 0:jn.capabilities)==null?void 0:Q.web_search)??!0})),n.$$.dirty[0]&2105345&&t(59,gt=(y!=null&&y.id?[y.id]:w).filter(wi=>{var ai,ci,jn,Q;return((Q=(jn=(ci=(ai=l.find(we=>we.id===wi))==null?void 0:ai.info)==null?void 0:ci.meta)==null?void 0:jn.capabilities)==null?void 0:Q.image_generation)??!0})),n.$$.dirty[0]&2105345&&t(60,mt=(y!=null&&y.id?[y.id]:w).filter(wi=>{var ai,ci,jn,Q;return((Q=(jn=(ci=(ai=l.find(we=>we.id===wi))==null?void 0:ai.info)==null?void 0:ci.meta)==null?void 0:jn.capabilities)==null?void 0:Q.code_interpreter)??!0})),n.$$.dirty[0]&2105345&&t(38,Xe=(y!=null&&y.id?[y.id]:w).map(wi=>{var ai;return((ai=l.find(ci=>ci.id===wi)||{})==null?void 0:ai.filters)??[]}).reduce((wi,ai)=>wi.filter(ci=>ai.some(jn=>jn.id===ci.id)))),n.$$.dirty[0]&65544&&t(39,rt=E.length+T.length>0),n.$$.dirty[0]&1581057|n.$$.dirty[1]&134217728&&t(40,me=(y!=null&&y.id?[y.id]:w).length===Qe.length&&(($=i==null?void 0:i.features)==null?void 0:$.enable_web_search)&&(o.role==="admin"||((xt=(Ve=o==null?void 0:o.permissions)==null?void 0:Ve.features)==null?void 0:xt.web_search))),n.$$.dirty[0]&1581057|n.$$.dirty[1]&268435456&&t(41,Rt=(y!=null&&y.id?[y.id]:w).length===gt.length&&((wt=i==null?void 0:i.features)==null?void 0:wt.enable_image_generation)&&(o.role==="admin"||((Tt=(Ze=o==null?void 0:o.permissions)==null?void 0:Ze.features)==null?void 0:Tt.image_generation))),n.$$.dirty[0]&1581057|n.$$.dirty[1]&536870912&&t(42,ct=(y!=null&&y.id?[y.id]:w).length===mt.length&&((ii=i==null?void 0:i.features)==null?void 0:ii.enable_code_interpreter)&&(o.role==="admin"||((_r=(fs=o==null?void 0:o.permissions)==null?void 0:fs.features)==null?void 0:_r.code_interpreter)))},[y,k,I,T,M,D,H,R,b,ge,g,m,p,w,v,C,E,He,de,i,o,l,_,z,P,B,N,K,oe,W,le,ce,Ce,X,Ke,qe,Me,Ne,Xe,rt,me,Rt,ct,s,r,c,h,u,d,Y,se,he,at,ze,Ht,on,f,J,Qe,gt,mt,qi,Cs,Wi,Ms,Ki,yi,yr,Ps,Ns,Oe,je,ht,Xt,tn,En,mn,Pn,Bn,xl,wr,om,lm,cm,hm,um,dm,fm,gm,mm,pm,bm,xm,ym,wm,_m,ke,Gy,Vy,qy,Wy,Ky,Xy,Yy,Jy,Zy,Qy,$y,ew,tw,nw,iw]}class TO extends Nt{constructor(e){super(),Ot(this,e,Dte,Ote,Ft,{onChange:56,createMessagePair:10,stopResponse:11,autoScroll:8,generating:12,atSelectedModel:0,selectedModels:13,history:14,taskIds:15,prompt:1,files:2,toolServers:16,selectedToolIds:3,selectedFilterIds:4,imageGenerationEnabled:5,webSearchEnabled:6,codeInterpreterEnabled:7,setText:57,showCommands:9,placeholder:17},null,[-1,-1,-1,-1,-1])}get setText(){return this.$$.ctx[57]}}function GA(n,e,t){const i=n.slice();return i[13]=e[t],i[14]=e,i[15]=t,i}function VA(n){let e,t,i,s;const r=[Lte,Fte],a=[];function o(l,c){return l[15]===0?0:1}return e=o(n),t=a[e]=r[e](n),{c(){t.c(),i=Ut()},l(l){t.l(l),i=Ut()},m(l,c){a[e].m(l,c),ee(l,i,c),s=!0},p(l,c){t.p(l,c)},i(l){s||(L(t),s=!0)},o(l){j(t),s=!1},d(l){l&&S(i),a[e].d(l)}}}function Fte(n){let e,t,i;return t=new Ci({props:{content:n[5].t("Remove Model"),$$slots:{default:[Bte]},$$scope:{ctx:n}}}),{c(){e=te("div"),pe(t.$$.fragment),this.h()},l(s){e=ne(s,"DIV",{class:!0});var r=V(e);ye(t.$$.fragment,r),r.forEach(S),this.h()},h(){A(e,"class","self-center mx-1 disabled:text-gray-600 disabled:hover:text-gray-600 -translate-y-[0.5px]")},m(s,r){ee(s,e,r),be(t,e,null),i=!0},p(s,r){const a={};r&32&&(a.content=s[5].t("Remove Model")),r&65539&&(a.$$scope={dirty:r,ctx:s}),t.$set(a)},i(s){i||(L(t.$$.fragment,s),i=!0)},o(s){j(t.$$.fragment,s),i=!1},d(s){s&&S(e),xe(t)}}}function Lte(n){let e,t,i;return t=new Ci({props:{content:n[5].t("Add Model"),$$slots:{default:[Ute]},$$scope:{ctx:n}}}),{c(){e=te("div"),pe(t.$$.fragment),this.h()},l(s){e=ne(s,"DIV",{class:!0});var r=V(e);ye(t.$$.fragment,r),r.forEach(S),this.h()},h(){A(e,"class","self-center mx-1 disabled:text-gray-600 disabled:hover:text-gray-600 -translate-y-[0.5px]")},m(s,r){ee(s,e,r),be(t,e,null),i=!0},p(s,r){const a={};r&32&&(a.content=s[5].t("Add Model")),r&65539&&(a.$$scope={dirty:r,ctx:s}),t.$set(a)},i(s){i||(L(t.$$.fragment,s),i=!0)},o(s){j(t.$$.fragment,s),i=!1},d(s){s&&S(e),xe(t)}}}function Bte(n){let e,t,i,s,r;function a(){return n[12](n[15])}return{c(){e=te("button"),t=nt("svg"),i=nt("path"),this.h()},l(o){e=ne(o,"BUTTON",{"aria-label":!0});var l=V(e);t=it(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var c=V(t);i=it(c,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),V(i).forEach(S),c.forEach(S),l.forEach(S),this.h()},h(){A(i,"stroke-linecap","round"),A(i,"stroke-linejoin","round"),A(i,"d","M19.5 12h-15"),A(t,"xmlns","http://www.w3.org/2000/svg"),A(t,"fill","none"),A(t,"viewBox","0 0 24 24"),A(t,"stroke-width","2"),A(t,"stroke","currentColor"),A(t,"class","size-3"),e.disabled=n[1],A(e,"aria-label","Remove Model")},m(o,l){ee(o,e,l),q(e,t),q(t,i),s||(r=pt(e,"click",a),s=!0)},p(o,l){n=o,l&2&&(e.disabled=n[1])},d(o){o&&S(e),s=!1,r()}}}function Ute(n){let e,t,i,s,r;return{c(){e=te("button"),t=nt("svg"),i=nt("path"),this.h()},l(a){e=ne(a,"BUTTON",{class:!0,"aria-label":!0});var o=V(e);t=it(o,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var l=V(t);i=it(l,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),V(i).forEach(S),l.forEach(S),o.forEach(S),this.h()},h(){A(i,"stroke-linecap","round"),A(i,"stroke-linejoin","round"),A(i,"d","M12 6v12m6-6H6"),A(t,"xmlns","http://www.w3.org/2000/svg"),A(t,"fill","none"),A(t,"viewBox","0 0 24 24"),A(t,"stroke-width","2"),A(t,"stroke","currentColor"),A(t,"class","size-3.5"),A(e,"class",""),e.disabled=n[1],A(e,"aria-label","Add Model")},m(a,o){ee(a,e,o),q(e,t),q(t,i),s||(r=pt(e,"click",n[11]),s=!0)},p(a,o){o&2&&(e.disabled=a[1])},d(a){a&&S(e),s=!1,r()}}}function qA(n){var f,g,m,b,p,y,w,_,v,C,k;let e,t,i,s,r,a,o,l,c;function h(I){n[10](I,n[13],n[14],n[15])}let u={id:`${n[15]}`,placeholder:n[5].t("Select a model"),items:n[3].map(KA),showTemporaryChatControl:((f=n[6])==null?void 0:f.role)==="user"?(((b=(m=(g=n[6])==null?void 0:g.permissions)==null?void 0:m.chat)==null?void 0:b.temporary)??!0)&&!(((w=(y=(p=n[6])==null?void 0:p.permissions)==null?void 0:y.chat)==null?void 0:w.temporary_enforced)??!1):!0,pinModelHandler:n[9]};n[13]!==void 0&&(u.value=n[13]),s=new zF({props:u}),At.push(()=>qt(s,"value",h));let d=(((_=n[6])==null?void 0:_.role)==="admin"||(((k=(C=(v=n[6])==null?void 0:v.permissions)==null?void 0:C.chat)==null?void 0:k.multiple_models)??!0))&&VA(n);return{c(){e=te("div"),t=te("div"),i=te("div"),pe(s.$$.fragment),o=Ae(),d&&d.c(),l=Ae(),this.h()},l(I){e=ne(I,"DIV",{class:!0});var E=V(e);t=ne(E,"DIV",{class:!0});var T=V(t);i=ne(T,"DIV",{class:!0});var M=V(i);ye(s.$$.fragment,M),M.forEach(S),T.forEach(S),o=Se(E),d&&d.l(E),l=Se(E),E.forEach(S),this.h()},h(){var I;A(i,"class",a="max-w-full "+(((I=n[4])==null?void 0:I.highContrastMode)??!1?"m-1":"mr-1")),A(t,"class","overflow-hidden w-full"),A(e,"class","flex w-full max-w-fit")},m(I,E){ee(I,e,E),q(e,t),q(t,i),be(s,i,null),q(e,o),d&&d.m(e,null),q(e,l),c=!0},p(I,E){var M,D,H,R,z,P,B,Z,G,Y,J,se;n=I;const T={};E&32&&(T.placeholder=n[5].t("Select a model")),E&8&&(T.items=n[3].map(KA)),E&64&&(T.showTemporaryChatControl=((M=n[6])==null?void 0:M.role)==="user"?(((R=(H=(D=n[6])==null?void 0:D.permissions)==null?void 0:H.chat)==null?void 0:R.temporary)??!0)&&!(((B=(P=(z=n[6])==null?void 0:z.permissions)==null?void 0:P.chat)==null?void 0:B.temporary_enforced)??!1):!0),!r&&E&1&&(r=!0,T.value=n[13],Wt(()=>r=!1)),s.$set(T),(!c||E&16&&a!==(a="max-w-full "+(((Z=n[4])==null?void 0:Z.highContrastMode)??!1?"m-1":"mr-1")))&&A(i,"class",a),((G=n[6])==null?void 0:G.role)==="admin"||(((se=(J=(Y=n[6])==null?void 0:Y.permissions)==null?void 0:J.chat)==null?void 0:se.multiple_models)??!0)?d?(d.p(n,E),E&64&&L(d,1)):(d=VA(n),d.c(),L(d,1),d.m(e,l)):d&&(ot(),j(d,1,1,()=>{d=null}),lt())},i(I){c||(L(s.$$.fragment,I),L(d),c=!0)},o(I){j(s.$$.fragment,I),j(d),c=!1},d(I){I&&S(e),xe(s),d&&d.d()}}}function WA(n){let e,t,i=n[5].t("Set as default")+"",s,r,a;return{c(){e=te("div"),t=te("button"),s=_t(i),this.h()},l(o){e=ne(o,"DIV",{class:!0});var l=V(e);t=ne(l,"BUTTON",{});var c=V(t);s=vt(c,i),c.forEach(S),l.forEach(S),this.h()},h(){A(e,"class","absolute text-left mt-[1px] ml-1 text-[0.7rem] text-gray-600 dark:text-gray-400 font-primary")},m(o,l){ee(o,e,l),q(e,t),q(t,s),r||(a=pt(t,"click",n[8]),r=!0)},p(o,l){l&32&&i!==(i=o[5].t("Set as default")+"")&&St(s,i)},d(o){o&&S(e),r=!1,a()}}}function Hte(n){let e,t,i,s,r=Qn(n[0]),a=[];for(let c=0;c<r.length;c+=1)a[c]=qA(GA(n,r,c));const o=c=>j(a[c],1,1,()=>{a[c]=null});let l=n[2]&&WA(n);return{c(){e=te("div");for(let c=0;c<a.length;c+=1)a[c].c();t=Ae(),l&&l.c(),i=Ut(),this.h()},l(c){e=ne(c,"DIV",{class:!0});var h=V(e);for(let u=0;u<a.length;u+=1)a[u].l(h);h.forEach(S),t=Se(c),l&&l.l(c),i=Ut(),this.h()},h(){A(e,"class","flex flex-col w-full items-start")},m(c,h){ee(c,e,h);for(let u=0;u<a.length;u+=1)a[u]&&a[u].m(e,null);ee(c,t,h),l&&l.m(c,h),ee(c,i,h),s=!0},p(c,[h]){if(h&635){r=Qn(c[0]);let u;for(u=0;u<r.length;u+=1){const d=GA(c,r,u);a[u]?(a[u].p(d,h),L(a[u],1)):(a[u]=qA(d),a[u].c(),L(a[u],1),a[u].m(e,null))}for(ot(),u=r.length;u<a.length;u+=1)o(u);lt()}c[2]?l?l.p(c,h):(l=WA(c),l.c(),l.m(i.parentNode,i)):l&&(l.d(1),l=null)},i(c){if(!s){for(let h=0;h<r.length;h+=1)L(a[h]);s=!0}},o(c){a=a.filter(Boolean);for(let h=0;h<a.length;h+=1)j(a[h]);s=!1},d(c){c&&(S(e),S(t),S(i)),To(a,c),l&&l.d(c)}}}const KA=n=>({value:n.id,label:n.name,model:n});function zte(n,e,t){let i,s,r,a;Pe(n,em,b=>t(3,i=b)),Pe(n,Ya,b=>t(4,s=b)),Pe(n,T0,b=>t(6,a=b));const o=hs("i18n");Pe(n,o,b=>t(5,r=b));let{selectedModels:l=[""]}=e,{disabled:c=!1}=e,{showSetDefault:h=!0}=e;const u=async()=>{if(l.filter(p=>p==="").length){Jt.error(r.t("Choose a model before saving..."));return}Ya.set({...s,models:l}),await yv(localStorage.token,{ui:s}),Jt.success(r.t("Default model updated"))},d=async b=>{let p=(s==null?void 0:s.pinnedModels)??[];p.includes(b)?p=p.filter(y=>y!==b):p=[...new Set([...p,b])],Ya.set({...s,pinnedModels:p}),await yv(localStorage.token,{ui:s})};function f(b,p,y,w){y[w]=b,t(0,l),t(3,i)}const g=()=>{t(0,l=[...l,""])},m=b=>{l.splice(b,1),t(0,l),t(3,i)};return n.$$set=b=>{"selectedModels"in b&&t(0,l=b.selectedModels),"disabled"in b&&t(1,c=b.disabled),"showSetDefault"in b&&t(2,h=b.showSetDefault)},n.$$.update=()=>{n.$$.dirty&9&&l.length>0&&i.length>0&&t(0,l=l.map(b=>i.map(p=>p.id).includes(b)?b:""))},[l,c,h,i,s,r,a,o,u,d,f,g,m]}class jte extends Nt{constructor(e){super(),Ot(this,e,zte,Hte,Ft,{selectedModels:0,disabled:1,showSetDefault:2})}}function Gte(n){let e,t;return{c(){e=nt("svg"),t=nt("path"),this.h()},l(i){e=it(i,"svg",{xmlns:!0,viewBox:!0,stroke:!0,fill:!0,class:!0,"stroke-width":!0});var s=V(e);t=it(s,"path",{d:!0}),V(t).forEach(S),s.forEach(S),this.h()},h(){A(t,"d","M18.75 12.75h1.5a.75.75 0 0 0 0-1.5h-1.5a.75.75 0 0 0 0 1.5ZM12 6a.75.75 0 0 1 .75-.75h7.5a.75.75 0 0 1 0 1.5h-7.5A.75.75 0 0 1 12 6ZM12 18a.75.75 0 0 1 .75-.75h7.5a.75.75 0 0 1 0 1.5h-7.5A.75.75 0 0 1 12 18ZM3.75 6.75h1.5a.75.75 0 1 0 0-1.5h-1.5a.75.75 0 0 0 0 1.5ZM5.25 18.75h-1.5a.75.75 0 0 1 0-1.5h1.5a.75.75 0 0 1 0 1.5ZM3 12a.75.75 0 0 1 .75-.75h7.5a.75.75 0 0 1 0 1.5h-7.5A.75.75 0 0 1 3 12ZM9 3.75a2.25 2.25 0 1 0 0 4.5 2.25 2.25 0 0 0 0-4.5ZM12.75 12a2.25 2.25 0 1 1 4.5 0 2.25 2.25 0 0 1-4.5 0ZM9 15.75a2.25 2.25 0 1 0 0 4.5 2.25 2.25 0 0 0 0-4.5Z"),A(e,"xmlns","http://www.w3.org/2000/svg"),A(e,"viewBox","0 0 24 24"),A(e,"stroke","currentColor"),A(e,"fill","currentColor"),A(e,"class",n[0]),A(e,"stroke-width",n[1])},m(i,s){ee(i,e,s),q(e,t)},p(i,[s]){s&1&&A(e,"class",i[0]),s&2&&A(e,"stroke-width",i[1])},i:kt,o:kt,d(i){i&&S(e)}}}function Vte(n,e,t){let{className:i="w-4 h-4"}=e,{strokeWidth:s="1.5"}=e;return n.$$set=r=>{"className"in r&&t(0,i=r.className),"strokeWidth"in r&&t(1,s=r.strokeWidth)},[i,s]}class RO extends Nt{constructor(e){super(),Ot(this,e,Vte,Gte,Ft,{className:0,strokeWidth:1})}}function qte(n){let e;const t=n[14].default,i=Xs(t,n,n[24],null);return{c(){i&&i.c()},l(s){i&&i.l(s)},m(s,r){i&&i.m(s,r),e=!0},p(s,r){i&&i.p&&(!e||r&16777216)&&Ys(i,t,s,s[24],e?Zs(t,s[24],r,null):Js(s[24]),null)},i(s){e||(L(i,s),e=!0)},o(s){j(i,s),e=!1},d(s){i&&i.d(s)}}}function XA(n){let e,t;return e=new ba({props:{class:"flex gap-2 items-center px-3 py-2 text-sm cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md select-none w-full",id:"chat-controls-button",$$slots:{default:[Wte]},$$scope:{ctx:n}}}),e.$on("click",n[15]),{c(){pe(e.$$.fragment)},l(i){ye(e.$$.fragment,i)},m(i,s){be(e,i,s),t=!0},p(i,s){const r={};s&16777248&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(L(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){xe(e,i)}}}function Wte(n){let e,t,i,s=n[5].t("Controls")+"",r,a;return e=new RO({props:{className:" size-4",strokeWidth:"0.5"}}),{c(){pe(e.$$.fragment),t=Ae(),i=te("div"),r=_t(s),this.h()},l(o){ye(e.$$.fragment,o),t=Se(o),i=ne(o,"DIV",{class:!0});var l=V(i);r=vt(l,s),l.forEach(S),this.h()},h(){A(i,"class","flex items-center")},m(o,l){be(e,o,l),ee(o,t,l),ee(o,i,l),q(i,r),a=!0},p(o,l){(!a||l&32)&&s!==(s=o[5].t("Controls")+"")&&St(r,s)},i(o){a||(L(e.$$.fragment,o),a=!0)},o(o){j(e.$$.fragment,o),a=!1},d(o){o&&(S(t),S(i)),xe(e,o)}}}function YA(n){let e,t;return e=new ba({props:{class:"flex gap-2 items-center px-3 py-2 text-sm cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md select-none w-full",id:"chat-share-button",$$slots:{default:[Kte]},$$scope:{ctx:n}}}),e.$on("click",n[16]),{c(){pe(e.$$.fragment)},l(i){ye(e.$$.fragment,i)},m(i,s){be(e,i,s),t=!0},p(i,s){const r={};s&16777248&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(L(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){xe(e,i)}}}function Kte(n){let e,t,i,s,r=n[5].t("Share")+"",a;return{c(){e=nt("svg"),t=nt("path"),i=Ae(),s=te("div"),a=_t(r),this.h()},l(o){e=it(o,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var l=V(e);t=it(l,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),V(t).forEach(S),l.forEach(S),i=Se(o),s=ne(o,"DIV",{class:!0});var c=V(s);a=vt(c,r),c.forEach(S),this.h()},h(){A(t,"fill-rule","evenodd"),A(t,"d","M15.75 4.5a3 3 0 1 1 .825 2.066l-8.421 4.679a3.002 3.002 0 0 1 0 1.51l8.421 4.679a3 3 0 1 1-.729 1.31l-8.421-4.678a3 3 0 1 1 0-4.132l8.421-4.679a3 3 0 0 1-.096-.755Z"),A(t,"clip-rule","evenodd"),A(e,"xmlns","http://www.w3.org/2000/svg"),A(e,"viewBox","0 0 24 24"),A(e,"fill","currentColor"),A(e,"class","size-4"),A(s,"class","flex items-center")},m(o,l){ee(o,e,l),q(e,t),ee(o,i,l),ee(o,s,l),q(s,a)},p(o,l){l&32&&r!==(r=o[5].t("Share")+"")&&St(a,r)},d(o){o&&(S(e),S(i),S(s))}}}function Xte(n){let e,t,i,s=n[5].t("Overview")+"",r,a;return e=new GF({props:{className:" size-4",strokeWidth:"1.5"}}),{c(){pe(e.$$.fragment),t=Ae(),i=te("div"),r=_t(s),this.h()},l(o){ye(e.$$.fragment,o),t=Se(o),i=ne(o,"DIV",{class:!0});var l=V(i);r=vt(l,s),l.forEach(S),this.h()},h(){A(i,"class","flex items-center")},m(o,l){be(e,o,l),ee(o,t,l),ee(o,i,l),q(i,r),a=!0},p(o,l){(!a||l&32)&&s!==(s=o[5].t("Overview")+"")&&St(r,s)},i(o){a||(L(e.$$.fragment,o),a=!0)},o(o){j(e.$$.fragment,o),a=!1},d(o){o&&(S(t),S(i)),xe(e,o)}}}function Yte(n){let e,t,i,s=n[5].t("Artifacts")+"",r,a;return e=new kD({props:{className:" size-4",strokeWidth:"1.5"}}),{c(){pe(e.$$.fragment),t=Ae(),i=te("div"),r=_t(s),this.h()},l(o){ye(e.$$.fragment,o),t=Se(o),i=ne(o,"DIV",{class:!0});var l=V(i);r=vt(l,s),l.forEach(S),this.h()},h(){A(i,"class","flex items-center")},m(o,l){be(e,o,l),ee(o,t,l),ee(o,i,l),q(i,r),a=!0},p(o,l){(!a||l&32)&&s!==(s=o[5].t("Artifacts")+"")&&St(r,s)},i(o){a||(L(e.$$.fragment,o),a=!0)},o(o){j(e.$$.fragment,o),a=!1},d(o){o&&(S(t),S(i)),xe(e,o)}}}function Jte(n){let e,t,i,s,r=n[5].t("Download")+"",a;return{c(){e=nt("svg"),t=nt("path"),i=Ae(),s=te("div"),a=_t(r),this.h()},l(o){e=it(o,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var l=V(e);t=it(l,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),V(t).forEach(S),l.forEach(S),i=Se(o),s=ne(o,"DIV",{class:!0});var c=V(s);a=vt(c,r),c.forEach(S),this.h()},h(){A(t,"stroke-linecap","round"),A(t,"stroke-linejoin","round"),A(t,"d","M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"),A(e,"xmlns","http://www.w3.org/2000/svg"),A(e,"fill","none"),A(e,"viewBox","0 0 24 24"),A(e,"stroke-width","1.5"),A(e,"stroke","currentColor"),A(e,"class","size-4"),A(s,"class","flex items-center")},m(o,l){ee(o,e,l),q(e,t),ee(o,i,l),ee(o,s,l),q(s,a)},p(o,l){l&32&&r!==(r=o[5].t("Download")+"")&&St(a,r)},d(o){o&&(S(e),S(i),S(s))}}}function JA(n){let e,t;return e=new ba({props:{class:"flex gap-2 items-center px-3 py-2 text-sm cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md select-none w-full",$$slots:{default:[Zte]},$$scope:{ctx:n}}}),e.$on("click",n[19]),{c(){pe(e.$$.fragment)},l(i){ye(e.$$.fragment,i)},m(i,s){be(e,i,s),t=!0},p(i,s){const r={};s&16777248&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(L(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){xe(e,i)}}}function Zte(n){let e,t=n[5].t("Export chat (.json)")+"",i;return{c(){e=te("div"),i=_t(t),this.h()},l(s){e=ne(s,"DIV",{class:!0});var r=V(e);i=vt(r,t),r.forEach(S),this.h()},h(){A(e,"class","flex items-center line-clamp-1")},m(s,r){ee(s,e,r),q(e,i)},p(s,r){r&32&&t!==(t=s[5].t("Export chat (.json)")+"")&&St(i,t)},d(s){s&&S(e)}}}function Qte(n){let e,t=n[5].t("Plain text (.txt)")+"",i;return{c(){e=te("div"),i=_t(t),this.h()},l(s){e=ne(s,"DIV",{class:!0});var r=V(e);i=vt(r,t),r.forEach(S),this.h()},h(){A(e,"class","flex items-center line-clamp-1")},m(s,r){ee(s,e,r),q(e,i)},p(s,r){r&32&&t!==(t=s[5].t("Plain text (.txt)")+"")&&St(i,t)},d(s){s&&S(e)}}}function $te(n){let e,t=n[5].t("PDF document (.pdf)")+"",i;return{c(){e=te("div"),i=_t(t),this.h()},l(s){e=ne(s,"DIV",{class:!0});var r=V(e);i=vt(r,t),r.forEach(S),this.h()},h(){A(e,"class","flex items-center line-clamp-1")},m(s,r){ee(s,e,r),q(e,i)},p(s,r){r&32&&t!==(t=s[5].t("PDF document (.pdf)")+"")&&St(i,t)},d(s){s&&S(e)}}}function ene(n){var o,l,c;let e,t,i,s,r,a=(((o=n[6])==null?void 0:o.role)==="admin"||(((c=(l=n[6].permissions)==null?void 0:l.chat)==null?void 0:c.export)??!0))&&JA(n);return t=new ba({props:{class:"flex gap-2 items-center px-3 py-2 text-sm cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md select-none w-full",$$slots:{default:[Qte]},$$scope:{ctx:n}}}),t.$on("click",n[20]),s=new ba({props:{class:"flex gap-2 items-center px-3 py-2 text-sm cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md select-none w-full",$$slots:{default:[$te]},$$scope:{ctx:n}}}),s.$on("click",n[21]),{c(){a&&a.c(),e=Ae(),pe(t.$$.fragment),i=Ae(),pe(s.$$.fragment)},l(h){a&&a.l(h),e=Se(h),ye(t.$$.fragment,h),i=Se(h),ye(s.$$.fragment,h)},m(h,u){a&&a.m(h,u),ee(h,e,u),be(t,h,u),ee(h,i,u),be(s,h,u),r=!0},p(h,u){var g,m,b;((g=h[6])==null?void 0:g.role)==="admin"||(((b=(m=h[6].permissions)==null?void 0:m.chat)==null?void 0:b.export)??!0)?a?(a.p(h,u),u&64&&L(a,1)):(a=JA(h),a.c(),L(a,1),a.m(e.parentNode,e)):a&&(ot(),j(a,1,1,()=>{a=null}),lt());const d={};u&16777248&&(d.$$scope={dirty:u,ctx:h}),t.$set(d);const f={};u&16777248&&(f.$$scope={dirty:u,ctx:h}),s.$set(f)},i(h){r||(L(a),L(t.$$.fragment,h),L(s.$$.fragment,h),r=!0)},o(h){j(a),j(t.$$.fragment,h),j(s.$$.fragment,h),r=!1},d(h){h&&(S(e),S(i)),a&&a.d(h),xe(t,h),xe(s,h)}}}function tne(n){let e,t,i,s;return e=new XI({props:{class:"flex gap-2 items-center px-3 py-2 text-sm cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md select-none w-full",$$slots:{default:[Jte]},$$scope:{ctx:n}}}),i=new YI({props:{class:"w-full rounded-xl px-1 py-1.5 z-50 bg-white dark:bg-gray-850 dark:text-white shadow-lg",transition:Q5,sideOffset:8,$$slots:{default:[ene]},$$scope:{ctx:n}}}),{c(){pe(e.$$.fragment),t=Ae(),pe(i.$$.fragment)},l(r){ye(e.$$.fragment,r),t=Se(r),ye(i.$$.fragment,r)},m(r,a){be(e,r,a),ee(r,t,a),be(i,r,a),s=!0},p(r,a){const o={};a&16777248&&(o.$$scope={dirty:a,ctx:r}),e.$set(o);const l={};a&16777312&&(l.$$scope={dirty:a,ctx:r}),i.$set(l)},i(r){s||(L(e.$$.fragment,r),L(i.$$.fragment,r),s=!0)},o(r){j(e.$$.fragment,r),j(i.$$.fragment,r),s=!1},d(r){r&&S(t),xe(e,r),xe(i,r)}}}function nne(n){let e,t,i,s=n[5].t("Copy")+"",r,a;return e=new CD({props:{className:" size-4",strokeWidth:"1.5"}}),{c(){pe(e.$$.fragment),t=Ae(),i=te("div"),r=_t(s),this.h()},l(o){ye(e.$$.fragment,o),t=Se(o),i=ne(o,"DIV",{class:!0});var l=V(i);r=vt(l,s),l.forEach(S),this.h()},h(){A(i,"class","flex items-center")},m(o,l){be(e,o,l),ee(o,t,l),ee(o,i,l),q(i,r),a=!0},p(o,l){(!a||l&32)&&s!==(s=o[5].t("Copy")+"")&&St(r,s)},i(o){a||(L(e.$$.fragment,o),a=!0)},o(o){j(e.$$.fragment,o),a=!1},d(o){o&&(S(t),S(i)),xe(e,o)}}}function ZA(n){let e,t,i,s,r;return s=new DF({props:{chatId:n[1].id}}),{c(){e=te("hr"),t=Ae(),i=te("div"),pe(s.$$.fragment),this.h()},l(a){e=ne(a,"HR",{class:!0}),t=Se(a),i=ne(a,"DIV",{class:!0});var o=V(i);ye(s.$$.fragment,o),o.forEach(S),this.h()},h(){A(e,"class","border-gray-100 dark:border-gray-850 my-0.5"),A(i,"class","flex p-1")},m(a,o){ee(a,e,o),ee(a,t,o),ee(a,i,o),be(s,i,null),r=!0},p(a,o){const l={};o&2&&(l.chatId=a[1].id),s.$set(l)},i(a){r||(L(s.$$.fragment,a),r=!0)},o(a){j(s.$$.fragment,a),r=!1},d(a){a&&(S(e),S(t),S(i)),xe(s)}}}function ine(n){var b,p,y;let e,t,i,s,r,a,o,l,c,h,u,d,f=n[4]&&XA(n),g=!n[3]&&(((b=n[6])==null?void 0:b.role)==="admin"||(((y=(p=n[6].permissions)==null?void 0:p.chat)==null?void 0:y.share)??!0))&&YA(n);i=new ba({props:{class:"flex gap-2 items-center px-3 py-2 text-sm cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md select-none w-full",id:"chat-overview-button",$$slots:{default:[Xte]},$$scope:{ctx:n}}}),i.$on("click",n[17]),r=new ba({props:{class:"flex gap-2 items-center px-3 py-2 text-sm cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md select-none w-full",id:"chat-overview-button",$$slots:{default:[Yte]},$$scope:{ctx:n}}}),r.$on("click",n[18]),o=new KI({props:{$$slots:{default:[tne]},$$scope:{ctx:n}}}),c=new ba({props:{class:"flex gap-2 items-center px-3 py-2 text-sm cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md select-none w-full",id:"chat-copy-button",$$slots:{default:[nne]},$$scope:{ctx:n}}}),c.$on("click",n[22]);let m=!n[3]&&ZA(n);return{c(){f&&f.c(),e=Ae(),g&&g.c(),t=Ae(),pe(i.$$.fragment),s=Ae(),pe(r.$$.fragment),a=Ae(),pe(o.$$.fragment),l=Ae(),pe(c.$$.fragment),h=Ae(),m&&m.c(),u=Ut()},l(w){f&&f.l(w),e=Se(w),g&&g.l(w),t=Se(w),ye(i.$$.fragment,w),s=Se(w),ye(r.$$.fragment,w),a=Se(w),ye(o.$$.fragment,w),l=Se(w),ye(c.$$.fragment,w),h=Se(w),m&&m.l(w),u=Ut()},m(w,_){f&&f.m(w,_),ee(w,e,_),g&&g.m(w,_),ee(w,t,_),be(i,w,_),ee(w,s,_),be(r,w,_),ee(w,a,_),be(o,w,_),ee(w,l,_),be(c,w,_),ee(w,h,_),m&&m.m(w,_),ee(w,u,_),d=!0},p(w,_){var E,T,M;w[4]?f?(f.p(w,_),_&16&&L(f,1)):(f=XA(w),f.c(),L(f,1),f.m(e.parentNode,e)):f&&(ot(),j(f,1,1,()=>{f=null}),lt()),!w[3]&&(((E=w[6])==null?void 0:E.role)==="admin"||(((M=(T=w[6].permissions)==null?void 0:T.chat)==null?void 0:M.share)??!0))?g?(g.p(w,_),_&72&&L(g,1)):(g=YA(w),g.c(),L(g,1),g.m(t.parentNode,t)):g&&(ot(),j(g,1,1,()=>{g=null}),lt());const v={};_&16777248&&(v.$$scope={dirty:_,ctx:w}),i.$set(v);const C={};_&16777248&&(C.$$scope={dirty:_,ctx:w}),r.$set(C);const k={};_&16777312&&(k.$$scope={dirty:_,ctx:w}),o.$set(k);const I={};_&16777248&&(I.$$scope={dirty:_,ctx:w}),c.$set(I),w[3]?m&&(ot(),j(m,1,1,()=>{m=null}),lt()):m?(m.p(w,_),_&8&&L(m,1)):(m=ZA(w),m.c(),L(m,1),m.m(u.parentNode,u))},i(w){d||(L(f),L(g),L(i.$$.fragment,w),L(r.$$.fragment,w),L(o.$$.fragment,w),L(c.$$.fragment,w),L(m),d=!0)},o(w){j(f),j(g),j(i.$$.fragment,w),j(r.$$.fragment,w),j(o.$$.fragment,w),j(c.$$.fragment,w),j(m),d=!1},d(w){w&&(S(e),S(t),S(s),S(a),S(l),S(h),S(u)),f&&f.d(w),g&&g.d(w),xe(i,w),xe(r,w),xe(o,w),xe(c,w),m&&m.d(w)}}}function sne(n){let e,t,i;return t=new h4({props:{class:"w-full max-w-[200px] rounded-xl px-1 py-1.5  z-50 bg-white dark:bg-gray-850 dark:text-white shadow-lg",sideOffset:8,side:"bottom",align:"end",transition:Q5,$$slots:{default:[ine]},$$scope:{ctx:n}}}),{c(){e=te("div"),pe(t.$$.fragment),this.h()},l(s){e=ne(s,"DIV",{slot:!0});var r=V(e);ye(t.$$.fragment,r),r.forEach(S),this.h()},h(){A(e,"slot","content")},m(s,r){ee(s,e,r),be(t,e,null),i=!0},p(s,r){const a={};r&16777339&&(a.$$scope={dirty:r,ctx:s}),t.$set(a)},i(s){i||(L(t.$$.fragment,s),i=!0)},o(s){j(t.$$.fragment,s),i=!1},d(s){s&&S(e),xe(t)}}}function rne(n){let e,t;return e=new u4({props:{$$slots:{content:[sne],default:[qte]},$$scope:{ctx:n}}}),e.$on("change",n[23]),{c(){pe(e.$$.fragment)},l(i){ye(e.$$.fragment,i)},m(i,s){be(e,i,s),t=!0},p(i,[s]){const r={};s&16777339&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(L(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){xe(e,i)}}}function ane(n,e,t){let i,s,r,a,o;Pe(n,Gd,R=>t(3,i=R)),Pe(n,Ya,R=>t(25,s=R)),Pe(n,cx,R=>t(4,r=R)),Pe(n,T0,R=>t(6,o=R));let{$$slots:l={},$$scope:c}=e;const{saveAs:h}=ZI,u=hs("i18n");Pe(n,u,R=>t(5,a=R));let{shareEnabled:d=!1}=e,{shareHandler:f}=e,{downloadHandler:g}=e,{chat:m}=e,{onClose:b=()=>{}}=e;const p=async()=>{const R=m.chat.history;return da(R,R.currentId).reduce((B,Z,G,Y)=>`${B}### ${Z.role.toUpperCase()}
${Z.content}

`,"").trim()},y=async()=>{const R=await p();let z=new Blob([R],{type:"text/plain"});h(z,`chat-${m.chat.title}.txt`)},w=async()=>{if((s==null?void 0:s.stylizedPdfExport)??!0){const R=document.getElementById("messages-container");if(R)try{const z=document.documentElement.classList.contains("dark"),P=800,B=1200,Z=R.cloneNode(!0);Z.classList.add("text-black"),Z.classList.add("dark:text-white"),Z.style.width=`${P}px`,Z.style.position="absolute",Z.style.left="-9999px",Z.style.height="auto",document.body.appendChild(Z);const G=Z.scrollHeight;let Y=0,J=0;const se=new vv("p","mm","a4"),fe=210,he=297;for(;Y<G;){Z.scrollTop=Y,Z.style.maxHeight=`${B}px`;const de=await vF(Z,{backgroundColor:z?"#000":"#fff",useCORS:!0,scale:2,width:P,height:Math.min(B,G-Y),windowWidth:P}),ge=de.toDataURL("image/png"),N=de.height*fe/de.width,K=0;J>0&&se.addPage(),z&&(se.setFillColor(0,0,0),se.rect(0,0,fe,he,"F")),se.addImage(ge,"PNG",0,K,fe,N),Y+=B,J++}document.body.removeChild(Z),se.save(`chat-${m.chat.title}.pdf`)}catch(z){console.error("Error generating PDF",z)}}else{const R=await p(),z=new vv,P=15,B=20,Z=15,G=20,Y=z.internal.pageSize.getWidth(),J=z.internal.pageSize.getHeight(),se=Y-P-Z,fe=8;z.setFontSize(fe);const he=fe*1,de=R.split(`
`);let ge=B;for(let N of de){const K=z.splitTextToSize(N,se);for(let oe of K)ge+he>J-G&&(z.addPage(),ge=B),z.text(oe,P,ge),ge+=he*.5;ge+=he*.1}z.save(`chat-${m.chat.title}.pdf`)}},_=async()=>{if(m.id){let R=null;m.id==="local"||i?R=m:R=await o8(localStorage.token,m.id);let z=new Blob([JSON.stringify([R])],{type:"application/json"});h(z,`chat-export-${Date.now()}.json`)}},v=async()=>{await Qi.set(!0),await u0.set(!1),await ic.set(!1)},C=()=>{f()},k=async()=>{await Qi.set(!0),await u0.set(!0),await ic.set(!1)},I=async()=>{await Qi.set(!0),await ic.set(!0),await u0.set(!1)},E=()=>{_()},T=()=>{y()},M=()=>{w()},D=async()=>{await l4(await p()).catch(z=>{console.error(z)})&&Jt.success(a.t("Copied to clipboard"))},H=R=>{R.detail===!1&&b()};return n.$$set=R=>{"shareEnabled"in R&&t(12,d=R.shareEnabled),"shareHandler"in R&&t(0,f=R.shareHandler),"downloadHandler"in R&&t(13,g=R.downloadHandler),"chat"in R&&t(1,m=R.chat),"onClose"in R&&t(2,b=R.onClose),"$$scope"in R&&t(24,c=R.$$scope)},[f,m,b,i,r,a,o,u,p,y,w,_,d,g,l,v,C,k,I,E,T,M,D,H,c]}class one extends Nt{constructor(e){super(),Ot(this,e,ane,rne,Ft,{shareEnabled:12,shareHandler:0,downloadHandler:13,chat:1,onClose:2})}}function QA(n,e,t){const i=n.slice();return i[33]=e[t],i}function $A(n){let e,t,i;return t=new Ci({props:{content:n[12]?n[13].t("Close Sidebar"):n[13].t("Open Sidebar"),$$slots:{default:[lne]},$$scope:{ctx:n}}}),{c(){e=te("div"),pe(t.$$.fragment),this.h()},l(s){e=ne(s,"DIV",{class:!0});var r=V(e);ye(t.$$.fragment,r),r.forEach(S),this.h()},h(){A(e,"class","-translate-x-0.5 mr-1 mt-1 self-start flex flex-none items-center text-gray-600 dark:text-gray-400")},m(s,r){ee(s,e,r),be(t,e,null),i=!0},p(s,r){const a={};r[0]&12288&&(a.content=s[12]?s[13].t("Close Sidebar"):s[13].t("Open Sidebar")),r[0]&4096|r[1]&32&&(a.$$scope={dirty:r,ctx:s}),t.$set(a)},i(s){i||(L(t.$$.fragment,s),i=!0)},o(s){j(t.$$.fragment,s),i=!1},d(s){s&&S(e),xe(t)}}}function lne(n){let e,t,i,s,r,a;return i=new WF({}),{c(){e=te("button"),t=te("div"),pe(i.$$.fragment),this.h()},l(o){e=ne(o,"BUTTON",{class:!0});var l=V(e);t=ne(l,"DIV",{class:!0});var c=V(t);ye(i.$$.fragment,c),c.forEach(S),l.forEach(S),this.h()},h(){A(t,"class","self-center p-1.5"),A(e,"class","cursor-pointer flex rounded-lg hover:bg-gray-100 dark:hover:bg-gray-850 transition")},m(o,l){ee(o,e,l),q(e,t),be(i,t,null),s=!0,r||(a=pt(e,"click",n[23]),r=!0)},p:kt,i(o){s||(L(i.$$.fragment,o),s=!0)},o(o){j(i.$$.fragment,o),s=!1},d(o){o&&S(e),xe(i),r=!1,a()}}}function eS(n){let e,t,i;function s(a){n[24](a)}let r={showSetDefault:!n[2]};return n[0]!==void 0&&(r.selectedModels=n[0]),e=new jte({props:r}),At.push(()=>qt(e,"selectedModels",s)),{c(){pe(e.$$.fragment)},l(a){ye(e.$$.fragment,a)},m(a,o){be(e,a,o),i=!0},p(a,o){const l={};o[0]&4&&(l.showSetDefault=!a[2]),!t&&o[0]&1&&(t=!0,l.selectedModels=a[0],Wt(()=>t=!1)),e.$set(l)},i(a){i||(L(e.$$.fragment,a),i=!0)},o(a){j(e.$$.fragment,a),i=!1},d(a){xe(e,a)}}}function tS(n){let e,t;return e=new one({props:{chat:n[3],shareEnabled:n[2],shareHandler:n[25],downloadHandler:n[26],$$slots:{default:[cne]},$$scope:{ctx:n}}}),{c(){pe(e.$$.fragment)},l(i){ye(e.$$.fragment,i)},m(i,s){be(e,i,s),t=!0},p(i,s){const r={};s[0]&8&&(r.chat=i[3]),s[0]&4&&(r.shareEnabled=i[2]),s[0]&256&&(r.shareHandler=i[25]),s[0]&512&&(r.downloadHandler=i[26]),s[1]&32&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(L(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){xe(e,i)}}}function cne(n){let e,t='<div class="m-auto self-center"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5"><path stroke-linecap="round" stroke-linejoin="round" d="M6.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM12.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM18.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Z"></path></svg></div>';return{c(){e=te("button"),e.innerHTML=t,this.h()},l(i){e=ne(i,"BUTTON",{class:!0,id:!0,"data-svelte-h":!0}),Ro(e)!=="svelte-1cq3yl7"&&(e.innerHTML=t),this.h()},h(){A(e,"class","flex cursor-pointer px-2 py-2 rounded-xl hover:bg-gray-50 dark:hover:bg-gray-850 transition"),A(e,"id","chat-context-menu-button")},m(i,s){ee(i,e,s)},p:kt,d(i){i&&S(e)}}}function nS(n){let e,t;return e=new Ci({props:{content:n[13].t("Controls"),$$slots:{default:[hne]},$$scope:{ctx:n}}}),{c(){pe(e.$$.fragment)},l(i){ye(e.$$.fragment,i)},m(i,s){be(e,i,s),t=!0},p(i,s){const r={};s[0]&8192&&(r.content=i[13].t("Controls")),s[0]&65536|s[1]&32&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(L(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){xe(e,i)}}}function hne(n){let e,t,i,s,r,a;return i=new RO({props:{className:" size-5",strokeWidth:"0.5"}}),{c(){e=te("button"),t=te("div"),pe(i.$$.fragment),this.h()},l(o){e=ne(o,"BUTTON",{class:!0,"aria-label":!0});var l=V(e);t=ne(l,"DIV",{class:!0});var c=V(t);ye(i.$$.fragment,c),c.forEach(S),l.forEach(S),this.h()},h(){A(t,"class","m-auto self-center"),A(e,"class","flex cursor-pointer px-2 py-2 rounded-xl hover:bg-gray-50 dark:hover:bg-gray-850 transition"),A(e,"aria-label","Controls")},m(o,l){ee(o,e,l),q(e,t),be(i,t,null),s=!0,r||(a=pt(e,"click",n[27]),r=!0)},p:kt,i(o){s||(L(i.$$.fragment,o),s=!0)},o(o){j(i.$$.fragment,o),s=!1},d(o){o&&S(e),xe(i),r=!1,a()}}}function iS(n){let e,t;return e=new Ci({props:{content:n[13].t("New Chat"),$$slots:{default:[une]},$$scope:{ctx:n}}}),{c(){pe(e.$$.fragment)},l(i){ye(e.$$.fragment,i)},m(i,s){be(e,i,s),t=!0},p(i,s){const r={};s[0]&8192&&(r.content=i[13].t("New Chat")),s[0]&4098|s[1]&32&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(L(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){xe(e,i)}}}function une(n){let e,t,i,s,r,a,o;return i=new qF({props:{className:" size-5",strokeWidth:"2"}}),{c(){e=te("button"),t=te("div"),pe(i.$$.fragment),this.h()},l(l){e=ne(l,"BUTTON",{class:!0,"aria-label":!0});var c=V(e);t=ne(c,"DIV",{class:!0});var h=V(t);ye(i.$$.fragment,h),h.forEach(S),c.forEach(S),this.h()},h(){A(t,"class","m-auto self-center"),A(e,"class",s="flex "+(n[12]?"md:hidden":"")+" cursor-pointer px-2 py-2 rounded-xl text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-850 transition"),A(e,"aria-label","New Chat")},m(l,c){ee(l,e,c),q(e,t),be(i,t,null),r=!0,a||(o=pt(e,"click",n[28]),a=!0)},p(l,c){(!r||c[0]&4096&&s!==(s="flex "+(l[12]?"md:hidden":"")+" cursor-pointer px-2 py-2 rounded-xl text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-850 transition"))&&A(e,"class",s)},i(l){r||(L(i.$$.fragment,l),r=!0)},o(l){j(i.$$.fragment,l),r=!1},d(l){l&&S(e),xe(i),a=!1,o()}}}function sS(n){var i;let e,t;return e=new VF({props:{className:"max-w-[240px]",role:(i=n[15])==null?void 0:i.role,help:!0,$$slots:{default:[dne]},$$scope:{ctx:n}}}),e.$on("show",n[29]),{c(){pe(e.$$.fragment)},l(s){ye(e.$$.fragment,s)},m(s,r){be(e,s,r),t=!0},p(s,r){var o;const a={};r[0]&32768&&(a.role=(o=s[15])==null?void 0:o.role),r[0]&40960|r[1]&32&&(a.$$scope={dirty:r,ctx:s}),e.$set(a)},i(s){t||(L(e.$$.fragment,s),t=!0)},o(s){j(e.$$.fragment,s),t=!1},d(s){xe(e,s)}}}function dne(n){let e,t,i,s=n[13].t("User menu")+"",r,a,o,l;return{c(){e=te("div"),t=te("div"),i=te("span"),r=_t(s),a=Ae(),o=te("img"),this.h()},l(c){e=ne(c,"DIV",{class:!0});var h=V(e);t=ne(h,"DIV",{class:!0});var u=V(t);i=ne(u,"SPAN",{class:!0});var d=V(i);r=vt(d,s),d.forEach(S),a=Se(u),o=ne(u,"IMG",{src:!0,class:!0,alt:!0,draggable:!0}),u.forEach(S),h.forEach(S),this.h()},h(){var c;A(i,"class","sr-only"),k0(o.src,l=(c=n[15])==null?void 0:c.profile_image_url)||A(o,"src",l),A(o,"class","size-6 object-cover rounded-full"),A(o,"alt",""),A(o,"draggable","false"),A(t,"class","self-center"),A(e,"class","select-none flex rounded-xl p-1.5 w-full hover:bg-gray-50 dark:hover:bg-gray-850 transition")},m(c,h){ee(c,e,h),q(e,t),q(t,i),q(i,r),q(t,a),q(t,o)},p(c,h){var u;h[0]&8192&&s!==(s=c[13].t("User menu")+"")&&St(r,s),h[0]&32768&&!k0(o.src,l=(u=c[15])==null?void 0:u.profile_image_url)&&A(o,"src",l)},d(c){c&&S(e)}}}function rS(n){let e,t,i=n[13].t("Temporary Chat")+"",s;return{c(){e=te("div"),t=te("div"),s=_t(i),this.h()},l(r){e=ne(r,"DIV",{class:!0});var a=V(e);t=ne(a,"DIV",{class:!0});var o=V(t);s=vt(o,i),o.forEach(S),a.forEach(S),this.h()},h(){A(t,"class","text-xs text-gray-500"),A(e,"class","w-full z-30 text-center")},m(r,a){ee(r,e,a),q(e,t),q(t,s)},p(r,a){a[0]&8192&&i!==(i=r[13].t("Temporary Chat")+"")&&St(s,i)},d(r){r&&S(e)}}}function aS(n){var c,h,u,d,f,g,m;let e,t,i,s,r,a=(((h=(c=n[18])==null?void 0:c.license_metadata)==null?void 0:h.type)??null)==="trial"&&oS(n),o=(((d=(u=n[18])==null?void 0:u.license_metadata)==null?void 0:d.seats)??null)!==null&&((f=n[18])==null?void 0:f.user_count)>((m=(g=n[18])==null?void 0:g.license_metadata)==null?void 0:m.seats)&&lS(n),l=n[6]&&cS(n);return{c(){e=te("div"),t=te("div"),a&&a.c(),i=Ae(),o&&o.c(),s=Ae(),l&&l.c(),this.h()},l(b){e=ne(b,"DIV",{class:!0});var p=V(e);t=ne(p,"DIV",{class:!0});var y=V(t);a&&a.l(y),i=Se(y),o&&o.l(y),s=Se(y),l&&l.l(y),y.forEach(S),p.forEach(S),this.h()},h(){A(t,"class","flex flex-col gap-1 w-full"),A(e,"class","w-full z-30 mt-5")},m(b,p){ee(b,e,p),q(e,t),a&&a.m(t,null),q(t,i),o&&o.m(t,null),q(t,s),l&&l.m(t,null),r=!0},p(b,p){var y,w,_,v,C,k,I;(((w=(y=b[18])==null?void 0:y.license_metadata)==null?void 0:w.type)??null)==="trial"?a?(a.p(b,p),p[0]&262144&&L(a,1)):(a=oS(b),a.c(),L(a,1),a.m(t,i)):a&&(ot(),j(a,1,1,()=>{a=null}),lt()),(((v=(_=b[18])==null?void 0:_.license_metadata)==null?void 0:v.seats)??null)!==null&&((C=b[18])==null?void 0:C.user_count)>((I=(k=b[18])==null?void 0:k.license_metadata)==null?void 0:I.seats)?o?(o.p(b,p),p[0]&262144&&L(o,1)):(o=lS(b),o.c(),L(o,1),o.m(t,s)):o&&(ot(),j(o,1,1,()=>{o=null}),lt()),b[6]?l?(l.p(b,p),p[0]&64&&L(l,1)):(l=cS(b),l.c(),L(l,1),l.m(t,null)):l&&(ot(),j(l,1,1,()=>{l=null}),lt())},i(b){r||(L(a),L(o),L(l),r=!0)},o(b){j(a),j(o),j(l),r=!1},d(b){b&&S(e),a&&a.d(),o&&o.d(),l&&l.d()}}}function oS(n){let e,t;return e=new d4({props:{banner:{type:"info",title:"Trial License",content:n[13].t("You are currently using a trial license. Please contact support to upgrade your license.")}}}),{c(){pe(e.$$.fragment)},l(i){ye(e.$$.fragment,i)},m(i,s){be(e,i,s),t=!0},p(i,s){const r={};s[0]&8192&&(r.banner={type:"info",title:"Trial License",content:i[13].t("You are currently using a trial license. Please contact support to upgrade your license.")}),e.$set(r)},i(i){t||(L(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){xe(e,i)}}}function lS(n){let e,t;return e=new d4({props:{banner:{type:"error",title:"License Error",content:n[13].t("Exceeded the number of seats in your license. Please contact support to increase the number of seats.")}}}),{c(){pe(e.$$.fragment)},l(i){ye(e.$$.fragment,i)},m(i,s){be(e,i,s),t=!0},p(i,s){const r={};s[0]&8192&&(r.banner={type:"error",title:"License Error",content:i[13].t("Exceeded the number of seats in your license. Please contact support to increase the number of seats.")}),e.$set(r)},i(i){t||(L(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){xe(e,i)}}}function cS(n){let e,t,i=Qn(n[17].filter(n[30])),s=[];for(let a=0;a<i.length;a+=1)s[a]=hS(QA(n,i,a));const r=a=>j(s[a],1,1,()=>{s[a]=null});return{c(){for(let a=0;a<s.length;a+=1)s[a].c();e=Ut()},l(a){for(let o=0;o<s.length;o+=1)s[o].l(a);e=Ut()},m(a,o){for(let l=0;l<s.length;l+=1)s[l]&&s[l].m(a,o);ee(a,e,o),t=!0},p(a,o){if(o[0]&131200){i=Qn(a[17].filter(a[30]));let l;for(l=0;l<i.length;l+=1){const c=QA(a,i,l);s[l]?(s[l].p(c,o),L(s[l],1)):(s[l]=hS(c),s[l].c(),L(s[l],1),s[l].m(e.parentNode,e))}for(ot(),l=i.length;l<s.length;l+=1)r(l);lt()}},i(a){if(!t){for(let o=0;o<i.length;o+=1)L(s[o]);t=!0}},o(a){s=s.filter(Boolean);for(let o=0;o<s.length;o+=1)j(s[o]);t=!1},d(a){a&&S(e),To(s,a)}}}function hS(n){let e,t;function i(...s){return n[31](n[33],...s)}return e=new d4({props:{banner:n[33]}}),e.$on("dismiss",i),{c(){pe(e.$$.fragment)},l(s){ye(e.$$.fragment,s)},m(s,r){be(e,s,r),t=!0},p(s,r){n=s;const a={};r[0]&131200&&(a.banner=n[33]),e.$set(a)},i(s){t||(L(e.$$.fragment,s),t=!0)},o(s){j(e.$$.fragment,s),t=!1},d(s){xe(e,s)}}}function fne(n){var Y,J,se,fe,he,de,ge,N,K,oe;let e,t,i,s,r,a,o,l,c,h,u,d,f,g,m,b,p,y,w,_,v,C,k,I,E;function T(W){n[21](W)}let M={chatId:n[10]};n[8]!==void 0&&(M.show=n[8]),e=new FF({props:M}),At.push(()=>qt(e,"show",T));let D=n[11]&&!n[12]&&$A(n),H=n[5]&&eS(n),R=n[2]&&n[3]&&(n[3].id||n[14])&&tS(n),z=(((Y=n[15])==null?void 0:Y.role)==="admin"||(((se=(J=n[15])==null?void 0:J.permissions.chat)==null?void 0:se.controls)??!0))&&nS(n),P=n[11]&&iS(n),B=n[15]!==void 0&&n[15]!==null&&sS(n),Z=n[14]&&n[10]==="local"&&rS(n),G=!n[4].currentId&&!n[10]&&(n[17].length>0||(((he=(fe=n[18])==null?void 0:fe.license_metadata)==null?void 0:he.type)??null)==="trial"||(((ge=(de=n[18])==null?void 0:de.license_metadata)==null?void 0:ge.seats)??null)!==null&&((N=n[18])==null?void 0:N.user_count)>((oe=(K=n[18])==null?void 0:K.license_metadata)==null?void 0:oe.seats))&&aS(n);return{c(){pe(e.$$.fragment),i=Ae(),s=te("button"),r=Ae(),a=te("nav"),o=te("div"),l=te("div"),c=Ae(),h=te("div"),u=te("div"),D&&D.c(),d=Ae(),f=te("div"),H&&H.c(),m=Ae(),b=te("div"),R&&R.c(),p=Ae(),z&&z.c(),y=Ae(),P&&P.c(),w=Ae(),B&&B.c(),_=Ae(),Z&&Z.c(),v=Ae(),C=te("div"),G&&G.c(),this.h()},l(W){ye(e.$$.fragment,W),i=Se(W),s=ne(W,"BUTTON",{id:!0,class:!0,"aria-label":!0}),V(s).forEach(S),r=Se(W),a=ne(W,"NAV",{class:!0});var le=V(a);o=ne(le,"DIV",{class:!0});var ce=V(o);l=ne(ce,"DIV",{class:!0}),V(l).forEach(S),c=Se(ce),h=ne(ce,"DIV",{class:!0});var Ce=V(h);u=ne(Ce,"DIV",{class:!0});var X=V(u);D&&D.l(X),d=Se(X),f=ne(X,"DIV",{class:!0});var Ke=V(f);H&&H.l(Ke),Ke.forEach(S),m=Se(X),b=ne(X,"DIV",{class:!0});var qe=V(b);R&&R.l(qe),p=Se(qe),z&&z.l(qe),y=Se(qe),P&&P.l(qe),w=Se(qe),B&&B.l(qe),qe.forEach(S),X.forEach(S),Ce.forEach(S),ce.forEach(S),_=Se(le),Z&&Z.l(le),v=Se(le),C=ne(le,"DIV",{class:!0});var He=V(C);G&&G.l(He),He.forEach(S),le.forEach(S),this.h()},h(){A(s,"id","new-chat-button"),A(s,"class","hidden"),A(s,"aria-label","New Chat"),A(l,"class","bg-linear-to-b via-50% from-white via-white to-transparent dark:from-gray-900 dark:via-gray-900 dark:to-transparent pointer-events-none absolute inset-0 -bottom-7 z-[-1]"),A(f,"class",g="flex-1 overflow-hidden max-w-full py-0.5 "+(n[12]?"ml-1":"")),A(b,"class","self-start flex flex-none items-center text-gray-600 dark:text-gray-400"),A(u,"class","flex items-center w-full max-w-full"),A(h,"class","flex max-w-full w-full mx-auto px-1.5 md:px-2 pt-0.5 bg-transparent"),A(o,"class","flex items-center w-full pl-1.5 pr-1"),A(C,"class","absolute top-[100%] left-0 right-0 h-fit"),A(a,"class","sticky top-0 z-30 w-full py-1 -mb-8 flex flex-col-row items-center drag-region")},m(W,le){be(e,W,le),ee(W,i,le),ee(W,s,le),ee(W,r,le),ee(W,a,le),q(a,o),q(o,l),q(o,c),q(o,h),q(h,u),D&&D.m(u,null),q(u,d),q(u,f),H&&H.m(f,null),q(u,m),q(u,b),R&&R.m(b,null),q(b,p),z&&z.m(b,null),q(b,y),P&&P.m(b,null),q(b,w),B&&B.m(b,null),q(a,_),Z&&Z.m(a,null),q(a,v),q(a,C),G&&G.m(C,null),k=!0,I||(E=pt(s,"click",n[22]),I=!0)},p(W,le){var Ce,X,Ke,qe,He,Me,Ne,Qe,gt,mt;const ce={};le[0]&1024&&(ce.chatId=W[10]),!t&&le[0]&256&&(t=!0,ce.show=W[8],Wt(()=>t=!1)),e.$set(ce),W[11]&&!W[12]?D?(D.p(W,le),le[0]&6144&&L(D,1)):(D=$A(W),D.c(),L(D,1),D.m(u,d)):D&&(ot(),j(D,1,1,()=>{D=null}),lt()),W[5]?H?(H.p(W,le),le[0]&32&&L(H,1)):(H=eS(W),H.c(),L(H,1),H.m(f,null)):H&&(ot(),j(H,1,1,()=>{H=null}),lt()),(!k||le[0]&4096&&g!==(g="flex-1 overflow-hidden max-w-full py-0.5 "+(W[12]?"ml-1":"")))&&A(f,"class",g),W[2]&&W[3]&&(W[3].id||W[14])?R?(R.p(W,le),le[0]&16396&&L(R,1)):(R=tS(W),R.c(),L(R,1),R.m(b,p)):R&&(ot(),j(R,1,1,()=>{R=null}),lt()),((Ce=W[15])==null?void 0:Ce.role)==="admin"||(((Ke=(X=W[15])==null?void 0:X.permissions.chat)==null?void 0:Ke.controls)??!0)?z?(z.p(W,le),le[0]&32768&&L(z,1)):(z=nS(W),z.c(),L(z,1),z.m(b,y)):z&&(ot(),j(z,1,1,()=>{z=null}),lt()),W[11]?P?(P.p(W,le),le[0]&2048&&L(P,1)):(P=iS(W),P.c(),L(P,1),P.m(b,w)):P&&(ot(),j(P,1,1,()=>{P=null}),lt()),W[15]!==void 0&&W[15]!==null?B?(B.p(W,le),le[0]&32768&&L(B,1)):(B=sS(W),B.c(),L(B,1),B.m(b,null)):B&&(ot(),j(B,1,1,()=>{B=null}),lt()),W[14]&&W[10]==="local"?Z?Z.p(W,le):(Z=rS(W),Z.c(),Z.m(a,v)):Z&&(Z.d(1),Z=null),!W[4].currentId&&!W[10]&&(W[17].length>0||(((He=(qe=W[18])==null?void 0:qe.license_metadata)==null?void 0:He.type)??null)==="trial"||(((Ne=(Me=W[18])==null?void 0:Me.license_metadata)==null?void 0:Ne.seats)??null)!==null&&((Qe=W[18])==null?void 0:Qe.user_count)>((mt=(gt=W[18])==null?void 0:gt.license_metadata)==null?void 0:mt.seats))?G?(G.p(W,le),le[0]&394256&&L(G,1)):(G=aS(W),G.c(),L(G,1),G.m(C,null)):G&&(ot(),j(G,1,1,()=>{G=null}),lt())},i(W){k||(L(e.$$.fragment,W),L(D),L(H),L(R),L(z),L(P),L(B),L(G),k=!0)},o(W){j(e.$$.fragment,W),j(D),j(H),j(R),j(z),j(P),j(B),j(G),k=!1},d(W){W&&(S(i),S(s),S(r),S(a)),xe(e,W),D&&D.d(),H&&H.d(),R&&R.d(),z&&z.d(),P&&P.d(),B&&B.d(),Z&&Z.d(),G&&G.d(),I=!1,E()}}}function gne(n,e,t){let i,s,r,a,o,l,c,h,u,d;Pe(n,WI,Y=>t(32,i=Y)),Pe(n,xu,Y=>t(10,s=Y)),Pe(n,cx,Y=>t(11,r=Y)),Pe(n,a8,Y=>t(12,a=Y)),Pe(n,Gd,Y=>t(14,l=Y)),Pe(n,T0,Y=>t(15,c=Y)),Pe(n,Qi,Y=>t(16,h=Y)),Pe(n,DD,Y=>t(17,u=Y)),Pe(n,$g,Y=>t(18,d=Y));const f=hs("i18n");Pe(n,f,Y=>t(13,o=Y));let{initNewChat:g}=e,{title:m=i}=e,{shareEnabled:b=!1}=e,{chat:p}=e,{history:y}=e,{selectedModels:w}=e,{showModelSelector:_=!0}=e,{showBanners:v=!0}=e,C=[],k=!1,I=!1;function E(Y){k=Y,t(8,k)}const T=()=>{g()},M=()=>{a8.set(!a)};function D(Y){w=Y,t(0,w)}const H=()=>{t(8,k=!k)},R=()=>{t(9,I=!I)},z=async()=>{await Qi.set(!h)},P=()=>{g()},B=Y=>{Y.detail==="archived-chat"&&FD.set(!0)},Z=Y=>![...JSON.parse(localStorage.getItem("dismissedBannerIds")??"[]"),...C].includes(Y.id),G=(Y,J)=>{const se=J.detail;Y.dismissible?localStorage.setItem("dismissedBannerIds",JSON.stringify([se,...JSON.parse(localStorage.getItem("dismissedBannerIds")??"[]")].filter(fe=>u.find(he=>he.id===fe)))):t(7,C=[...C,se])};return n.$$set=Y=>{"initNewChat"in Y&&t(1,g=Y.initNewChat),"title"in Y&&t(20,m=Y.title),"shareEnabled"in Y&&t(2,b=Y.shareEnabled),"chat"in Y&&t(3,p=Y.chat),"history"in Y&&t(4,y=Y.history),"selectedModels"in Y&&t(0,w=Y.selectedModels),"showModelSelector"in Y&&t(5,_=Y.showModelSelector),"showBanners"in Y&&t(6,v=Y.showBanners)},[w,g,b,p,y,_,v,C,k,I,s,r,a,o,l,c,h,u,d,f,m,E,T,M,D,H,R,z,P,B,Z,G]}class mne extends Nt{constructor(e){super(),Ot(this,e,gne,fne,Ft,{initNewChat:1,title:20,shareEnabled:2,chat:3,history:4,selectedModels:0,showModelSelector:5,showBanners:6},null,[-1,-1])}}function Ri(n){if(typeof n=="string"||typeof n=="number")return""+n;let e="";if(Array.isArray(n))for(let t=0,i;t<n.length;t++)(i=Ri(n[t]))!==""&&(e+=(e&&" ")+i);else for(let t in n)n[t]&&(e+=(e&&" ")+t);return e}const Mx={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:n=>`Node type "${n}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:n=>`The old edge with id=${n} does not exist.`,error009:n=>`Marker type "${n}" doesn't exist.`,error008:(n,{id:e,sourceHandle:t,targetHandle:i})=>`Couldn't create edge for ${n} handle id: "${n==="source"?t:i}", edge id: ${e}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:n=>`Edge type "${n}" not found. Using fallback type "default".`,error012:n=>`Node with id "${n}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(n="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${n}/dist/style.css' or base.css to make sure everything is working properly.`},u5=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]];var hf;(function(n){n.Strict="strict",n.Loose="loose"})(hf||(hf={}));var lc;(function(n){n.Free="free",n.Vertical="vertical",n.Horizontal="horizontal"})(lc||(lc={}));var d5;(function(n){n.Partial="partial",n.Full="full"})(d5||(d5={}));const t4={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null};var m1;(function(n){n.Bezier="default",n.Straight="straight",n.Step="step",n.SmoothStep="smoothstep",n.SimpleBezier="simplebezier"})(m1||(m1={}));var f5;(function(n){n.Arrow="arrow",n.ArrowClosed="arrowclosed"})(f5||(f5={}));var xn;(function(n){n.Left="left",n.Top="top",n.Right="right",n.Bottom="bottom"})(xn||(xn={}));const uS={[xn.Left]:xn.Right,[xn.Right]:xn.Left,[xn.Top]:xn.Bottom,[xn.Bottom]:xn.Top};function pne(n,e){if(!n&&!e)return!0;if(!n||!e||n.size!==e.size)return!1;if(!n.size&&!e.size)return!0;for(const t of n.keys())if(!e.has(t))return!1;return!0}function dS(n,e,t){if(!t)return;const i=[];n.forEach((s,r)=>{e!=null&&e.has(r)||i.push(s)}),i.length&&t(i)}function fS(n){return n===null?null:n?"valid":"invalid"}const bne=n=>"id"in n&&"source"in n&&"target"in n,xne=n=>"id"in n&&"position"in n&&!("source"in n)&&!("target"in n),X_=n=>"id"in n&&"internals"in n&&!("source"in n)&&!("target"in n),Fy=(n,e=[0,0])=>{const{width:t,height:i}=am(n),s=n.origin??e,r=t*s[0],a=i*s[1];return{x:n.position.x-r,y:n.position.y-a}},yne=(n,e={nodeOrigin:[0,0],nodeLookup:void 0})=>{if(n.length===0)return{x:0,y:0,width:0,height:0};const t=n.reduce((i,s)=>{const r=typeof s=="string";let a=!e.nodeLookup&&!r?s:void 0;e.nodeLookup&&(a=r?e.nodeLookup.get(s):X_(s)?s:e.nodeLookup.get(s.id));const o=a?g5(a,e.nodeOrigin):{x:0,y:0,x2:0,y2:0};return By(i,o)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return Uy(t)},Ly=(n,e={})=>{if(n.size===0)return{x:0,y:0,width:0,height:0};let t={x:1/0,y:1/0,x2:-1/0,y2:-1/0};return n.forEach(i=>{if(e.filter===void 0||e.filter(i)){const s=g5(i);t=By(t,s)}}),Uy(t)},MO=(n,e,[t,i,s]=[0,0,1],r=!1,a=!1)=>{const o={...Px(e,[t,i,s]),width:e.width/s,height:e.height/s},l=[];for(const c of n.values()){const{measured:h,selectable:u=!0,hidden:d=!1}=c;if(a&&!u||d)continue;const f=h.width??c.width??c.initialWidth??null,g=h.height??c.height??c.initialHeight??null,m=d2(o,Xg(c)),b=(f??0)*(g??0),p=r&&m>0;(!c.internals.handleBounds||p||m>=b||c.dragging)&&l.push(c)}return l},n4=(n,e)=>{const t=new Set;return n.forEach(i=>{t.add(i.id)}),e.filter(i=>t.has(i.source)||t.has(i.target))};function gS(n,e){const t=new Map,i=e!=null&&e.nodes?new Set(e.nodes.map(s=>s.id)):null;return n.forEach(s=>{s.measured.width&&s.measured.height&&((e==null?void 0:e.includeHiddenNodes)||!s.hidden)&&(!i||i.has(s.id))&&t.set(s.id,s)}),t}async function mS({nodes:n,width:e,height:t,panZoom:i,minZoom:s,maxZoom:r},a){if(n.size===0)return Promise.resolve(!1);const o=Ly(n),l=J_(o,e,t,(a==null?void 0:a.minZoom)??s,(a==null?void 0:a.maxZoom)??r,(a==null?void 0:a.padding)??.1);return await i.setViewport(l,{duration:a==null?void 0:a.duration}),Promise.resolve(!0)}function wne({nodeId:n,nextPosition:e,nodeLookup:t,nodeOrigin:i=[0,0],nodeExtent:s,onError:r}){const a=t.get(n),o=a.parentId?t.get(a.parentId):void 0,{x:l,y:c}=o?o.internals.positionAbsolute:{x:0,y:0},h=a.origin??i;let u=s;if(a.extent==="parent"&&!a.expandParent)if(!o)r==null||r("005",Mx.error005());else{const f=o.measured.width,g=o.measured.height;f&&g&&(u=[[l,c],[l+f,c+g]])}else o&&f2(a.extent)&&(u=[[a.extent[0][0]+l,a.extent[0][1]+c],[a.extent[1][0]+l,a.extent[1][1]+c]]);const d=f2(u)?Kg(e,u,a.measured):e;return{position:{x:d.x-l+a.measured.width*h[0],y:d.y-c+a.measured.height*h[1]},positionAbsolute:d}}async function PO({nodesToRemove:n=[],edgesToRemove:e=[],nodes:t,edges:i,onBeforeDelete:s}){const r=new Set(n.map(d=>d.id)),a=[];for(const d of t){if(d.deletable===!1)continue;const f=r.has(d.id),g=!f&&d.parentId&&a.find(m=>m.id===d.parentId);(f||g)&&a.push(d)}const o=new Set(e.map(d=>d.id)),l=i.filter(d=>d.deletable!==!1),h=n4(a,l);for(const d of l)o.has(d.id)&&!h.find(g=>g.id===d.id)&&h.push(d);if(!s)return{edges:h,nodes:a};const u=await s({nodes:a,edges:h});return typeof u=="boolean"?u?{edges:h,nodes:a}:{edges:[],nodes:[]}:u}const Wg=(n,e=0,t=1)=>Math.min(Math.max(n,e),t),Kg=(n={x:0,y:0},e,t)=>({x:Wg(n.x,e[0][0],e[1][0]-((t==null?void 0:t.width)??0)),y:Wg(n.y,e[0][1],e[1][1]-((t==null?void 0:t.height)??0))});function NO(n,e,t){const{width:i,height:s}=am(t),{x:r,y:a}=t.internals.positionAbsolute;return Kg(n,[[r,a],[r+i,a+s]],e)}const pS=(n,e,t)=>n<e?Wg(Math.abs(n-e),1,e)/e:n>t?-Wg(Math.abs(n-t),1,e)/e:0,OO=(n,e,t=15,i=40)=>{const s=pS(n.x,i,e.width-i)*t,r=pS(n.y,i,e.height-i)*t;return[s,r]},By=(n,e)=>({x:Math.min(n.x,e.x),y:Math.min(n.y,e.y),x2:Math.max(n.x2,e.x2),y2:Math.max(n.y2,e.y2)}),i4=({x:n,y:e,width:t,height:i})=>({x:n,y:e,x2:n+t,y2:e+i}),Uy=({x:n,y:e,x2:t,y2:i})=>({x:n,y:e,width:t-n,height:i-e}),Xg=(n,e=[0,0])=>{var s,r;const{x:t,y:i}=X_(n)?n.internals.positionAbsolute:Fy(n,e);return{x:t,y:i,width:((s=n.measured)==null?void 0:s.width)??n.width??n.initialWidth??0,height:((r=n.measured)==null?void 0:r.height)??n.height??n.initialHeight??0}},g5=(n,e=[0,0])=>{var s,r;const{x:t,y:i}=X_(n)?n.internals.positionAbsolute:Fy(n,e);return{x:t,y:i,x2:t+(((s=n.measured)==null?void 0:s.width)??n.width??n.initialWidth??0),y2:i+(((r=n.measured)==null?void 0:r.height)??n.height??n.initialHeight??0)}},_ne=(n,e)=>Uy(By(i4(n),i4(e))),d2=(n,e)=>{const t=Math.max(0,Math.min(n.x+n.width,e.x+e.width)-Math.max(n.x,e.x)),i=Math.max(0,Math.min(n.y+n.height,e.y+e.height)-Math.max(n.y,e.y));return Math.ceil(t*i)},bS=n=>il(n.width)&&il(n.height)&&il(n.x)&&il(n.y),il=n=>!isNaN(n)&&isFinite(n),vne=(n,e)=>{},Y_=(n,e=[1,1])=>({x:e[0]*Math.round(n.x/e[0]),y:e[1]*Math.round(n.y/e[1])}),Px=({x:n,y:e},[t,i,s],r=!1,a=[1,1])=>{const o={x:(n-t)/s,y:(e-i)/s};return r?Y_(o,a):o},DO=({x:n,y:e},[t,i,s])=>({x:n*s+t,y:e*s+i}),J_=(n,e,t,i,s,r)=>{const a=e/(n.width*(1+r)),o=t/(n.height*(1+r)),l=Math.min(a,o),c=Wg(l,i,s),h=n.x+n.width/2,u=n.y+n.height/2,d=e/2-h*c,f=t/2-u*c;return{x:d,y:f,zoom:c}},m5=()=>{var n;return typeof navigator<"u"&&((n=navigator==null?void 0:navigator.userAgent)==null?void 0:n.indexOf("Mac"))>=0};function f2(n){return n!==void 0&&n!=="parent"}function am(n){var e,t;return{width:((e=n.measured)==null?void 0:e.width)??n.width??n.initialWidth??0,height:((t=n.measured)==null?void 0:t.height)??n.height??n.initialHeight??0}}function xS(n){var e,t;return(((e=n.measured)==null?void 0:e.width)??n.width??n.initialWidth)!==void 0&&(((t=n.measured)==null?void 0:t.height)??n.height??n.initialHeight)!==void 0}function kne(n,e={width:0,height:0},t,i,s){let r=t;const a={...n};for(;r;){const o=i.get(r);if(r=o==null?void 0:o.parentId,o){const l=o.origin||s;a.x+=o.internals.positionAbsolute.x-(e.width??0)*l[0],a.y+=o.internals.positionAbsolute.y-(e.height??0)*l[1]}}return a}function $w(n,{snapGrid:e=[0,0],snapToGrid:t=!1,transform:i}){const{x:s,y:r}=x0(n),a=Px({x:s,y:r},i),{x:o,y:l}=t?Y_(a,e):a;return{xSnapped:o,ySnapped:l,...a}}const FO=n=>({width:n.offsetWidth,height:n.offsetHeight}),Cne=n=>{var e;return((e=n.getRootNode)==null?void 0:e.call(n))||(window==null?void 0:window.document)},Ane=["INPUT","SELECT","TEXTAREA"];function Sne(n){var i,s;const e=((s=(i=n.composedPath)==null?void 0:i.call(n))==null?void 0:s[0])||n.target;return Ane.includes(e==null?void 0:e.nodeName)||(e==null?void 0:e.hasAttribute("contenteditable"))||!!(e!=null&&e.closest(".nokey"))}const LO=n=>"clientX"in n,x0=(n,e)=>{var r,a;const t=LO(n),i=t?n.clientX:(r=n.touches)==null?void 0:r[0].clientX,s=t?n.clientY:(a=n.touches)==null?void 0:a[0].clientY;return{x:i-((e==null?void 0:e.left)??0),y:s-((e==null?void 0:e.top)??0)}},yS=(n,e,t,i,s)=>{const r=e.querySelectorAll(`.${n}`);return!r||!r.length?null:Array.from(r).map(a=>{const o=a.getBoundingClientRect();return{id:a.getAttribute("data-handleid"),type:n,nodeId:s,position:a.getAttribute("data-handlepos"),x:(o.left-t.left)/i,y:(o.top-t.top)/i,...FO(a)}})};function Ine({sourceX:n,sourceY:e,targetX:t,targetY:i,sourceControlX:s,sourceControlY:r,targetControlX:a,targetControlY:o}){const l=n*.125+s*.375+a*.375+t*.125,c=e*.125+r*.375+o*.375+i*.125,h=Math.abs(l-n),u=Math.abs(c-e);return[l,c,h,u]}function v9(n,e){return n>=0?.5*n:e*25*Math.sqrt(-n)}function wS({pos:n,x1:e,y1:t,x2:i,y2:s,c:r}){switch(n){case xn.Left:return[e-v9(e-i,r),t];case xn.Right:return[e+v9(i-e,r),t];case xn.Top:return[e,t-v9(t-s,r)];case xn.Bottom:return[e,t+v9(s-t,r)]}}function BO({sourceX:n,sourceY:e,sourcePosition:t=xn.Bottom,targetX:i,targetY:s,targetPosition:r=xn.Top,curvature:a=.25}){const[o,l]=wS({pos:t,x1:n,y1:e,x2:i,y2:s,c:a}),[c,h]=wS({pos:r,x1:i,y1:s,x2:n,y2:e,c:a}),[u,d,f,g]=Ine({sourceX:n,sourceY:e,targetX:i,targetY:s,sourceControlX:o,sourceControlY:l,targetControlX:c,targetControlY:h});return[`M${n},${e} C${o},${l} ${c},${h} ${i},${s}`,u,d,f,g]}function UO({sourceX:n,sourceY:e,targetX:t,targetY:i}){const s=Math.abs(t-n)/2,r=t<n?t+s:t-s,a=Math.abs(i-e)/2,o=i<e?i+a:i-a;return[r,o,s,a]}function Ene({sourceNode:n,targetNode:e,selected:t=!1,zIndex:i=0,elevateOnSelect:s=!1}){if(!s)return i;const r=t||e.selected||n.selected,a=Math.max(n.internals.z||0,e.internals.z||0,1e3);return i+(r?a:0)}function Tne({sourceNode:n,targetNode:e,width:t,height:i,transform:s}){const r=By(g5(n),g5(e));r.x===r.x2&&(r.x2+=1),r.y===r.y2&&(r.y2+=1);const a={x:-s[0]/s[2],y:-s[1]/s[2],width:t/s[2],height:i/s[2]};return d2(a,Uy(r))>0}const Rne=({source:n,sourceHandle:e,target:t,targetHandle:i})=>`xy-edge__${n}${e||""}-${t}${i||""}`,Mne=(n,e)=>e.some(t=>t.source===n.source&&t.target===n.target&&(t.sourceHandle===n.sourceHandle||!t.sourceHandle&&!n.sourceHandle)&&(t.targetHandle===n.targetHandle||!t.targetHandle&&!n.targetHandle)),Pne=(n,e)=>{if(!n.source||!n.target)return e;let t;return bne(n)?t={...n}:t={...n,id:Rne(n)},Mne(t,e)?e:(t.sourceHandle===null&&delete t.sourceHandle,t.targetHandle===null&&delete t.targetHandle,e.concat(t))};function HO({sourceX:n,sourceY:e,targetX:t,targetY:i}){const[s,r,a,o]=UO({sourceX:n,sourceY:e,targetX:t,targetY:i});return[`M ${n},${e}L ${t},${i}`,s,r,a,o]}const _S={[xn.Left]:{x:-1,y:0},[xn.Right]:{x:1,y:0},[xn.Top]:{x:0,y:-1},[xn.Bottom]:{x:0,y:1}},Nne=({source:n,sourcePosition:e=xn.Bottom,target:t})=>e===xn.Left||e===xn.Right?n.x<t.x?{x:1,y:0}:{x:-1,y:0}:n.y<t.y?{x:0,y:1}:{x:0,y:-1},vS=(n,e)=>Math.sqrt(Math.pow(e.x-n.x,2)+Math.pow(e.y-n.y,2));function One({source:n,sourcePosition:e=xn.Bottom,target:t,targetPosition:i=xn.Top,center:s,offset:r}){const a=_S[e],o=_S[i],l={x:n.x+a.x*r,y:n.y+a.y*r},c={x:t.x+o.x*r,y:t.y+o.y*r},h=Nne({source:l,sourcePosition:e,target:c}),u=h.x!==0?"x":"y",d=h[u];let f=[],g,m;const b={x:0,y:0},p={x:0,y:0},[y,w,_,v]=UO({sourceX:n.x,sourceY:n.y,targetX:t.x,targetY:t.y});if(a[u]*o[u]===-1){g=s.x??y,m=s.y??w;const k=[{x:g,y:l.y},{x:g,y:c.y}],I=[{x:l.x,y:m},{x:c.x,y:m}];a[u]===d?f=u==="x"?k:I:f=u==="x"?I:k}else{const k=[{x:l.x,y:c.y}],I=[{x:c.x,y:l.y}];if(u==="x"?f=a.x===d?I:k:f=a.y===d?k:I,e===i){const H=Math.abs(n[u]-t[u]);if(H<=r){const R=Math.min(r-1,r-H);a[u]===d?b[u]=(l[u]>n[u]?-1:1)*R:p[u]=(c[u]>t[u]?-1:1)*R}}if(e!==i){const H=u==="x"?"y":"x",R=a[u]===o[H],z=l[H]>c[H],P=l[H]<c[H];(a[u]===1&&(!R&&z||R&&P)||a[u]!==1&&(!R&&P||R&&z))&&(f=u==="x"?k:I)}const E={x:l.x+b.x,y:l.y+b.y},T={x:c.x+p.x,y:c.y+p.y},M=Math.max(Math.abs(E.x-f[0].x),Math.abs(T.x-f[0].x)),D=Math.max(Math.abs(E.y-f[0].y),Math.abs(T.y-f[0].y));M>=D?(g=(E.x+T.x)/2,m=f[0].y):(g=f[0].x,m=(E.y+T.y)/2)}return[[n,{x:l.x+b.x,y:l.y+b.y},...f,{x:c.x+p.x,y:c.y+p.y},t],g,m,_,v]}function Dne(n,e,t,i){const s=Math.min(vS(n,e)/2,vS(e,t)/2,i),{x:r,y:a}=e;if(n.x===r&&r===t.x||n.y===a&&a===t.y)return`L${r} ${a}`;if(n.y===a){const c=n.x<t.x?-1:1,h=n.y<t.y?1:-1;return`L ${r+s*c},${a}Q ${r},${a} ${r},${a+s*h}`}const o=n.x<t.x?1:-1,l=n.y<t.y?-1:1;return`L ${r},${a+s*l}Q ${r},${a} ${r+s*o},${a}`}function p5({sourceX:n,sourceY:e,sourcePosition:t=xn.Bottom,targetX:i,targetY:s,targetPosition:r=xn.Top,borderRadius:a=5,centerX:o,centerY:l,offset:c=20}){const[h,u,d,f,g]=One({source:{x:n,y:e},sourcePosition:t,target:{x:i,y:s},targetPosition:r,center:{x:o,y:l},offset:c});return[h.reduce((b,p,y)=>{let w="";return y>0&&y<h.length-1?w=Dne(h[y-1],p,h[y+1],a):w=`${y===0?"M":"L"}${p.x} ${p.y}`,b+=w,b},""),u,d,f,g]}function kS(n){var e;return n&&!!(n.internals.handleBounds||(e=n.handles)!=null&&e.length)&&!!(n.measured.width||n.width||n.initialWidth)}function Fne(n){var u;const{sourceNode:e,targetNode:t}=n;if(!kS(e)||!kS(t))return null;const i=e.internals.handleBounds||CS(e.handles),s=t.internals.handleBounds||CS(t.handles),r=AS((i==null?void 0:i.source)??[],n.sourceHandle),a=AS(n.connectionMode===hf.Strict?(s==null?void 0:s.target)??[]:((s==null?void 0:s.target)??[]).concat((s==null?void 0:s.source)??[]),n.targetHandle);if(!r||!a)return(u=n.onError)==null||u.call(n,"008",Mx.error008(r?"target":"source",{id:n.id,sourceHandle:n.sourceHandle,targetHandle:n.targetHandle})),null;const o=(r==null?void 0:r.position)||xn.Bottom,l=(a==null?void 0:a.position)||xn.Top,c=g2(e,r,o),h=g2(t,a,l);return{sourceX:c.x,sourceY:c.y,targetX:h.x,targetY:h.y,sourcePosition:o,targetPosition:l}}function CS(n){if(!n)return null;const e=[],t=[];for(const i of n)i.width=i.width??1,i.height=i.height??1,i.type==="source"?e.push(i):i.type==="target"&&t.push(i);return{source:e,target:t}}function g2(n,e,t=xn.Left,i=!1){const s=((e==null?void 0:e.x)??0)+n.internals.positionAbsolute.x,r=((e==null?void 0:e.y)??0)+n.internals.positionAbsolute.y,{width:a,height:o}=e??am(n);if(i)return{x:s+a/2,y:r+o/2};switch((e==null?void 0:e.position)??t){case xn.Top:return{x:s+a/2,y:r};case xn.Right:return{x:s+a,y:r+o/2};case xn.Bottom:return{x:s+a/2,y:r+o};case xn.Left:return{x:s,y:r+o/2}}}function AS(n,e){return n&&(e?n.find(t=>t.id===e):n[0])||null}function s4(n,e){return n?typeof n=="string"?n:`${e?`${e}__`:""}${Object.keys(n).sort().map(i=>`${i}=${n[i]}`).join("&")}`:""}function Lne(n,{id:e,defaultColor:t,defaultMarkerStart:i,defaultMarkerEnd:s}){const r=new Set;return n.reduce((a,o)=>([o.markerStart||i,o.markerEnd||s].forEach(l=>{if(l&&typeof l=="object"){const c=s4(l,e);r.has(c)||(a.push({id:c,color:l.color||t,...l}),r.add(c))}}),a),[]).sort((a,o)=>a.id.localeCompare(o.id))}const zO={nodeOrigin:[0,0],nodeExtent:u5,elevateNodesOnSelect:!0,defaults:{}},Bne={...zO,checkEquality:!0};function jO(n,e){const t={...n};for(const i in e)e[i]!==void 0&&(t[i]=e[i]);return t}function GO(n,e,t,i){var o,l;const s=jO(Bne,i),r=new Map(e),a=s!=null&&s.elevateNodesOnSelect?1e3:0;e.clear(),t.clear();for(const c of n){let h=r.get(c.id);if(s.checkEquality&&c===(h==null?void 0:h.internals.userNode))e.set(c.id,h);else{const u=Fy(c,s.nodeOrigin),d=f2(c.extent)?c.extent:s.nodeExtent,f=Kg(u,d,am(c));h={...s.defaults,...c,measured:{width:(o=c.measured)==null?void 0:o.width,height:(l=c.measured)==null?void 0:l.height},internals:{positionAbsolute:f,handleBounds:c.measured?h==null?void 0:h.internals.handleBounds:void 0,z:qO(c,a),userNode:c}},e.set(c.id,h)}c.parentId&&VO(h,e,t,i)}}function Une(n,e){if(!n.parentId)return;const t=e.get(n.parentId);t?t.set(n.id,n):e.set(n.parentId,new Map([[n.id,n]]))}function VO(n,e,t,i){const{elevateNodesOnSelect:s,nodeOrigin:r,nodeExtent:a}=jO(zO,i),o=n.parentId,l=e.get(o);if(!l){console.warn(`Parent node ${o} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}Une(n,t);const c=s?1e3:0,{x:h,y:u,z:d}=Hne(n,l,r,a,c),{positionAbsolute:f}=n.internals,g=h!==f.x||u!==f.y;(g||d!==n.internals.z)&&(n.internals={...n.internals,positionAbsolute:g?{x:h,y:u}:f,z:d})}function qO(n,e){return(il(n.zIndex)?n.zIndex:0)+(n.selected?e:0)}function Hne(n,e,t,i,s){const{x:r,y:a}=e.internals.positionAbsolute,o=am(n),l=Fy(n,t),c=f2(n.extent)?Kg(l,n.extent,o):l;let h=Kg({x:r+c.x,y:a+c.y},i,o);n.extent==="parent"&&(h=NO(h,o,e));const u=qO(n,s),d=e.internals.z??0;return{x:h.x,y:h.y,z:d>u?d:u}}function zne(n,e,t,i=[0,0]){var a;const s=[],r=new Map;for(const o of n){const l=e.get(o.parentId);if(!l)continue;const c=((a=r.get(o.parentId))==null?void 0:a.expandedRect)??Xg(l),h=_ne(c,o.rect);r.set(o.parentId,{expandedRect:h,parent:l})}return r.size>0&&r.forEach(({expandedRect:o,parent:l},c)=>{var w;const h=l.internals.positionAbsolute,u=am(l),d=l.origin??i,f=o.x<h.x?Math.round(Math.abs(h.x-o.x)):0,g=o.y<h.y?Math.round(Math.abs(h.y-o.y)):0,m=Math.max(u.width,Math.round(o.width)),b=Math.max(u.height,Math.round(o.height)),p=(m-u.width)*d[0],y=(b-u.height)*d[1];(f>0||g>0||p||y)&&(s.push({id:c,type:"position",position:{x:l.position.x-f+p,y:l.position.y-g+y}}),(w=t.get(c))==null||w.forEach(_=>{n.some(v=>v.id===_.id)||s.push({id:_.id,type:"position",position:{x:_.position.x+f,y:_.position.y+g}})})),(u.width<o.width||u.height<o.height||f||g)&&s.push({id:c,type:"dimensions",setAttributes:!0,dimensions:{width:m+(f?d[0]*f-p:0),height:b+(g?d[1]*g-y:0)}})}),s}function jne(n,e,t,i,s,r){const a=i==null?void 0:i.querySelector(".xyflow__viewport");let o=!1;if(!a)return{changes:[],updatedInternals:o};const l=[],c=window.getComputedStyle(a),{m22:h}=new window.DOMMatrixReadOnly(c.transform),u=[];for(const d of n.values()){const f=e.get(d.id);if(f)if(f.hidden)f.internals={...f.internals,handleBounds:void 0},o=!0;else{const g=FO(d.nodeElement),m=f.measured.width!==g.width||f.measured.height!==g.height;if(!!(g.width&&g.height&&(m||!f.internals.handleBounds||d.force))){const p=d.nodeElement.getBoundingClientRect(),y=f2(f.extent)?f.extent:r;let{positionAbsolute:w}=f.internals;f.parentId&&f.extent==="parent"?w=NO(w,g,e.get(f.parentId)):y&&(w=Kg(w,y,g)),f.measured=g,f.internals={...f.internals,positionAbsolute:w,handleBounds:{source:yS("source",d.nodeElement,p,h,f.id),target:yS("target",d.nodeElement,p,h,f.id)}},f.parentId&&VO(f,e,t,{nodeOrigin:s}),o=!0,m&&(l.push({id:f.id,type:"dimensions",dimensions:g}),f.expandParent&&f.parentId&&u.push({id:f.id,parentId:f.parentId,rect:Xg(f,s)}))}}}if(u.length>0){const d=zne(u,e,t,s);l.push(...d)}return{changes:l,updatedInternals:o}}async function Gne({delta:n,panZoom:e,transform:t,translateExtent:i,width:s,height:r}){if(!e||!n.x&&!n.y)return Promise.resolve(!1);const a=await e.setViewportConstrained({x:t[0]+n.x,y:t[1]+n.y,zoom:t[2]},[[0,0],[s,r]],i),o=!!a&&(a.x!==t[0]||a.y!==t[1]||a.k!==t[2]);return Promise.resolve(o)}function WO(n,e,t){n.clear(),e.clear();for(const i of t){const{source:s,target:r,sourceHandle:a=null,targetHandle:o=null}=i,l=`${s}-source-${a}`,c=`${r}-target-${o}`,h=n.get(l)||new Map,u=n.get(c)||new Map,d={edgeId:i.id,source:s,target:r,sourceHandle:a,targetHandle:o};e.set(i.id,i),n.set(l,h.set(`${r}-${o}`,d)),n.set(c,u.set(`${s}-${a}`,d))}}function KO(n,e){if(!n.parentId)return!1;const t=e.get(n.parentId);return t?t.selected?!0:KO(t,e):!1}function SS(n,e,t){let i=n;do{if(i!=null&&i.matches(e))return!0;if(i===t)return!1;i=i.parentElement}while(i);return!1}function Vne(n,e,t,i){const s=new Map;for(const[r,a]of n)if((a.selected||a.id===i)&&(!a.parentId||!KO(a,n))&&(a.draggable||e&&typeof a.draggable>"u")){const o=n.get(r);o&&s.set(r,{id:r,position:o.position||{x:0,y:0},distance:{x:t.x-o.internals.positionAbsolute.x,y:t.y-o.internals.positionAbsolute.y},extent:o.extent,parentId:o.parentId,origin:o.origin,expandParent:o.expandParent,internals:{positionAbsolute:o.internals.positionAbsolute||{x:0,y:0}},measured:{width:o.measured.width??0,height:o.measured.height??0}})}return s}function e8({nodeId:n,dragItems:e,nodeLookup:t,dragging:i=!0}){var a,o;const s=[];for(const[l,c]of e){const h=(a=t.get(l))==null?void 0:a.internals.userNode;h&&s.push({...h,position:c.position,dragging:i})}if(!n)return[s[0],s];const r=t.get(n).internals.userNode;return[{...r,position:((o=e.get(n))==null?void 0:o.position)||r.position,dragging:i},s]}function qne({onNodeMouseDown:n,getStoreItems:e,onDragStart:t,onDrag:i,onDragStop:s}){let r={x:null,y:null},a=0,o=new Map,l=!1,c={x:0,y:0},h=null,u=!1,d=null,f=!1;function g({noDragClassName:b,handleSelector:p,domNode:y,isSelectable:w,nodeId:_,nodeClickDistance:v=0}){d=$o(y);function C({x:T,y:M},D){const{nodeLookup:H,nodeExtent:R,snapGrid:z,snapToGrid:P,nodeOrigin:B,onNodeDrag:Z,onSelectionDrag:G,onError:Y,updateNodePositions:J}=e();r={x:T,y:M};let se=!1,fe={x:0,y:0,x2:0,y2:0};if(o.size>1&&R){const he=Ly(o);fe=i4(he)}for(const[he,de]of o){let ge={x:T-de.distance.x,y:M-de.distance.y};P&&(ge=Y_(ge,z));let N=[[R[0][0],R[0][1]],[R[1][0],R[1][1]]];if(o.size>1&&R&&!de.extent){const{positionAbsolute:W}=de.internals,le=W.x-fe.x+R[0][0],ce=W.x+de.measured.width-fe.x2+R[1][0],Ce=W.y-fe.y+R[0][1],X=W.y+de.measured.height-fe.y2+R[1][1];N=[[le,Ce],[ce,X]]}const{position:K,positionAbsolute:oe}=wne({nodeId:he,nextPosition:ge,nodeLookup:H,nodeExtent:N,nodeOrigin:B,onError:Y});se=se||de.position.x!==K.x||de.position.y!==K.y,de.position=K,de.internals.positionAbsolute=oe}if(se&&(J(o,!0),D&&(i||Z||!_&&G))){const[he,de]=e8({nodeId:_,dragItems:o,nodeLookup:H});i==null||i(D,o,he,de),Z==null||Z(D,he,de),_||G==null||G(D,de)}}async function k(){if(!h)return;const{transform:T,panBy:M,autoPanSpeed:D}=e(),[H,R]=OO(c,h,D);(H!==0||R!==0)&&(r.x=(r.x??0)-H/T[2],r.y=(r.y??0)-R/T[2],await M({x:H,y:R})&&C(r,null)),a=requestAnimationFrame(k)}function I(T){var se;const{nodeLookup:M,multiSelectionActive:D,nodesDraggable:H,transform:R,snapGrid:z,snapToGrid:P,selectNodesOnDrag:B,onNodeDragStart:Z,onSelectionDragStart:G,unselectNodesAndEdges:Y}=e();u=!0,(!B||!w)&&!D&&_&&((se=M.get(_))!=null&&se.selected||Y()),w&&B&&_&&(n==null||n(_));const J=$w(T.sourceEvent,{transform:R,snapGrid:z,snapToGrid:P});if(r=J,o=Vne(M,H,J,_),o.size>0&&(t||Z||!_&&G)){const[fe,he]=e8({nodeId:_,dragItems:o,nodeLookup:M});t==null||t(T.sourceEvent,o,fe,he),Z==null||Z(T.sourceEvent,fe,he),_||G==null||G(T.sourceEvent,he)}}const E=uL().clickDistance(v).on("start",T=>{const{domNode:M,nodeDragThreshold:D,transform:H,snapGrid:R,snapToGrid:z}=e();f=!1,D===0&&I(T),r=$w(T.sourceEvent,{transform:H,snapGrid:R,snapToGrid:z}),h=(M==null?void 0:M.getBoundingClientRect())||null,c=x0(T.sourceEvent,h)}).on("drag",T=>{const{autoPanOnNodeDrag:M,transform:D,snapGrid:H,snapToGrid:R,nodeDragThreshold:z}=e(),P=$w(T.sourceEvent,{transform:D,snapGrid:H,snapToGrid:R});if(T.sourceEvent.type==="touchmove"&&T.sourceEvent.touches.length>1&&(f=!0),!f){if(!l&&M&&u&&(l=!0,k()),!u){const B=P.xSnapped-(r.x??0),Z=P.ySnapped-(r.y??0);Math.sqrt(B*B+Z*Z)>z&&I(T)}(r.x!==P.xSnapped||r.y!==P.ySnapped)&&o&&u&&(c=x0(T.sourceEvent,h),C(P,T.sourceEvent))}}).on("end",T=>{if(!(!u||f)&&(l=!1,u=!1,cancelAnimationFrame(a),o.size>0)){const{nodeLookup:M,updateNodePositions:D,onNodeDragStop:H,onSelectionDragStop:R}=e();if(D(o,!1),s||H||!_&&R){const[z,P]=e8({nodeId:_,dragItems:o,nodeLookup:M,dragging:!1});s==null||s(T.sourceEvent,o,z,P),H==null||H(T.sourceEvent,z,P),_||R==null||R(T.sourceEvent,P)}}}).filter(T=>{const M=T.target;return!T.button&&(!b||!SS(M,`.${b}`,y))&&(!p||SS(M,p,y))});d.call(E)}function m(){d==null||d.on(".drag",null)}return{update:g,destroy:m}}function Wne(n,e,t){const i=[],s={x:n.x-t,y:n.y-t,width:t*2,height:t*2};for(const r of e.values())d2(s,Xg(r))>0&&i.push(r);return i}const Kne=250;function Xne(n,e,t,i){var o,l;let s=[],r=1/0;const a=Wne(n,t,e+Kne);for(const c of a){const h=[...((o=c.internals.handleBounds)==null?void 0:o.source)??[],...((l=c.internals.handleBounds)==null?void 0:l.target)??[]];for(const u of h){if(i.nodeId===u.nodeId&&i.type===u.type&&i.id===u.id)continue;const{x:d,y:f}=g2(c,u,u.position,!0),g=Math.sqrt(Math.pow(d-n.x,2)+Math.pow(f-n.y,2));g>e||(g<r?(s=[{...u,x:d,y:f}],r=g):g===r&&s.push({...u,x:d,y:f}))}}if(!s.length)return null;if(s.length>1){const c=i.type==="source"?"target":"source";return s.find(h=>h.type===c)??s[0]}return s[0]}function XO(n,e,t,i,s,r=!1){var c,h,u;const a=i.get(n);if(!a)return null;const o=s==="strict"?(c=a.internals.handleBounds)==null?void 0:c[e]:[...((h=a.internals.handleBounds)==null?void 0:h.source)??[],...((u=a.internals.handleBounds)==null?void 0:u.target)??[]],l=(t?o==null?void 0:o.find(d=>d.id===t):o==null?void 0:o[0])??null;return l&&r?{...l,...g2(a,l,l.position,!0)}:l}function YO(n,e){return n||(e!=null&&e.classList.contains("target")?"target":e!=null&&e.classList.contains("source")?"source":null)}function Yne(n,e){let t=null;return e?t=!0:n&&!e&&(t=!1),t}const JO=()=>!0;function Jne(n,{connectionMode:e,connectionRadius:t,handleId:i,nodeId:s,edgeUpdaterType:r,isTarget:a,domNode:o,nodeLookup:l,lib:c,autoPanOnConnect:h,flowId:u,panBy:d,cancelConnection:f,onConnectStart:g,onConnect:m,onConnectEnd:b,isValidConnection:p=JO,onReconnectEnd:y,updateConnection:w,getTransform:_,getFromHandle:v,autoPanSpeed:C}){const k=Cne(n.target);let I=0,E;const{x:T,y:M}=x0(n),D=k==null?void 0:k.elementFromPoint(T,M),H=YO(r,D),R=o==null?void 0:o.getBoundingClientRect();if(!R||!H)return;const z=XO(s,H,i,l,e);if(!z)return;let P=x0(n,R),B=!1,Z=null,G=!1,Y=null;function J(){if(!h||!R)return;const[oe,W]=OO(P,R,C);d({x:oe,y:W}),I=requestAnimationFrame(J)}const se={...z,nodeId:s,type:H,position:z.position},fe=l.get(s),de={inProgress:!0,isValid:null,from:g2(fe,se,xn.Left,!0),fromHandle:se,fromPosition:se.position,fromNode:fe,to:P,toHandle:null,toPosition:uS[se.position],toNode:null};w(de);let ge=de;g==null||g(n,{nodeId:s,handleId:i,handleType:H});function N(oe){if(!v()||!se){K(oe);return}const W=_();P=x0(oe,R),E=Xne(Px(P,W,!1,[1,1]),t,l,se),B||(J(),B=!0);const le=ZO(oe,{handle:E,connectionMode:e,fromNodeId:s,fromHandleId:i,fromType:a?"target":"source",isValidConnection:p,doc:k,lib:c,flowId:u,nodeLookup:l});Y=le.handleDomNode,Z=le.connection,G=Yne(!!E,le.isValid);const ce={...ge,isValid:G,to:E&&G?DO({x:E.x,y:E.y},W):P,toHandle:le.toHandle,toPosition:G&&le.toHandle?le.toHandle.position:uS[se.position],toNode:le.toHandle?l.get(le.toHandle.nodeId):null};G&&E&&ge.toHandle&&ce.toHandle&&ge.toHandle.type===ce.toHandle.type&&ge.toHandle.nodeId===ce.toHandle.nodeId&&ge.toHandle.id===ce.toHandle.id&&ge.to.x===ce.to.x&&ge.to.y===ce.to.y||(w(ce),ge=ce)}function K(oe){(E||Y)&&Z&&G&&(m==null||m(Z));const{inProgress:W,...le}=ge,ce={...le,toPosition:ge.toHandle?ge.toPosition:null};b==null||b(oe,ce),r&&(y==null||y(oe,ce)),f(),cancelAnimationFrame(I),B=!1,G=!1,Z=null,Y=null,k.removeEventListener("mousemove",N),k.removeEventListener("mouseup",K),k.removeEventListener("touchmove",N),k.removeEventListener("touchend",K)}k.addEventListener("mousemove",N),k.addEventListener("mouseup",K),k.addEventListener("touchmove",N),k.addEventListener("touchend",K)}function ZO(n,{handle:e,connectionMode:t,fromNodeId:i,fromHandleId:s,fromType:r,doc:a,lib:o,flowId:l,isValidConnection:c=JO,nodeLookup:h}){const u=r==="target",d=e?a.querySelector(`.${o}-flow__handle[data-id="${l}-${e==null?void 0:e.nodeId}-${e==null?void 0:e.id}-${e==null?void 0:e.type}"]`):null,{x:f,y:g}=x0(n),m=a.elementFromPoint(f,g),b=m!=null&&m.classList.contains(`${o}-flow__handle`)?m:d,p={handleDomNode:b,isValid:!1,connection:null,toHandle:null};if(b){const y=YO(void 0,b),w=b.getAttribute("data-nodeid"),_=b.getAttribute("data-handleid"),v=b.classList.contains("connectable"),C=b.classList.contains("connectableend");if(!w||!y)return p;const k={source:u?w:i,sourceHandle:u?_:s,target:u?i:w,targetHandle:u?s:_};p.connection=k;const E=v&&C&&(t===hf.Strict?u&&y==="source"||!u&&y==="target":w!==i||_!==s);p.isValid=E&&c(k),p.toHandle=XO(w,y,_,h,t,!1)}return p}const Zne={onPointerDown:Jne,isValid:ZO},Qne=(n,e)=>n.x!==e.x||n.y!==e.y||n.zoom!==e.k,Hy=n=>({x:n.x,y:n.y,zoom:n.k}),t8=({x:n,y:e,zoom:t})=>o4.translate(n,e).scale(t),Kf=(n,e)=>n.target.closest(`.${e}`),QO=(n,e)=>e===2&&Array.isArray(n)&&n.includes(2),n8=(n,e=0,t=()=>{})=>{const i=typeof e=="number"&&e>0;return i||t(),i?n.transition().duration(e).on("end",t):n},$O=n=>{const e=n.ctrlKey&&m5()?10:1;return-n.deltaY*(n.deltaMode===1?.05:n.deltaMode?1:.002)*e};function $ne({zoomPanValues:n,noWheelClassName:e,d3Selection:t,d3Zoom:i,panOnScrollMode:s,panOnScrollSpeed:r,zoomOnPinch:a,onPanZoomStart:o,onPanZoom:l,onPanZoomEnd:c}){return h=>{if(Kf(h,e))return!1;h.preventDefault(),h.stopImmediatePropagation();const u=t.property("__zoom").k||1;if(h.ctrlKey&&a){const b=Ml(h),p=$O(h),y=u*Math.pow(2,p);i.scaleTo(t,y,b,h);return}const d=h.deltaMode===1?20:1;let f=s===lc.Vertical?0:h.deltaX*d,g=s===lc.Horizontal?0:h.deltaY*d;!m5()&&h.shiftKey&&s!==lc.Vertical&&(f=h.deltaY*d,g=0),i.translateBy(t,-(f/u)*r,-(g/u)*r,{internal:!0});const m=Hy(t.property("__zoom"));clearTimeout(n.panScrollTimeout),n.isPanScrolling||(n.isPanScrolling=!0,o==null||o(h,m)),n.isPanScrolling&&(l==null||l(h,m),n.panScrollTimeout=setTimeout(()=>{c==null||c(h,m),n.isPanScrolling=!1},150))}}function eie({noWheelClassName:n,preventScrolling:e,d3ZoomHandler:t}){return function(i,s){if(!e&&i.type==="wheel"&&!i.ctrlKey||Kf(i,n))return null;i.preventDefault(),t.call(this,i,s)}}function tie({zoomPanValues:n,onDraggingChange:e,onPanZoomStart:t}){return i=>{var r,a,o;if((r=i.sourceEvent)!=null&&r.internal)return;const s=Hy(i.transform);n.mouseButton=((a=i.sourceEvent)==null?void 0:a.button)||0,n.isZoomingOrPanning=!0,n.prevViewport=s,((o=i.sourceEvent)==null?void 0:o.type)==="mousedown"&&e(!0),t&&(t==null||t(i.sourceEvent,s))}}function nie({zoomPanValues:n,panOnDrag:e,onPaneContextMenu:t,onTransformChange:i,onPanZoom:s}){return r=>{var a,o;n.usedRightMouseButton=!!(t&&QO(e,n.mouseButton??0)),(a=r.sourceEvent)!=null&&a.sync||i([r.transform.x,r.transform.y,r.transform.k]),s&&!((o=r.sourceEvent)!=null&&o.internal)&&(s==null||s(r.sourceEvent,Hy(r.transform)))}}function iie({zoomPanValues:n,panOnDrag:e,panOnScroll:t,onDraggingChange:i,onPanZoomEnd:s,onPaneContextMenu:r}){return a=>{var o;if(!((o=a.sourceEvent)!=null&&o.internal)&&(n.isZoomingOrPanning=!1,r&&QO(e,n.mouseButton??0)&&!n.usedRightMouseButton&&a.sourceEvent&&r(a.sourceEvent),n.usedRightMouseButton=!1,i(!1),s&&Qne(n.prevViewport,a.transform))){const l=Hy(a.transform);n.prevViewport=l,clearTimeout(n.timerId),n.timerId=setTimeout(()=>{s==null||s(a.sourceEvent,l)},t?150:0)}}}function sie({zoomActivationKeyPressed:n,zoomOnScroll:e,zoomOnPinch:t,panOnDrag:i,panOnScroll:s,zoomOnDoubleClick:r,userSelectionActive:a,noWheelClassName:o,noPanClassName:l,lib:c}){return h=>{var g;const u=n||e,d=t&&h.ctrlKey;if(h.button===1&&h.type==="mousedown"&&(Kf(h,`${c}-flow__node`)||Kf(h,`${c}-flow__edge`)))return!0;if(!i&&!u&&!s&&!r&&!t||a||Kf(h,o)&&h.type==="wheel"||Kf(h,l)&&(h.type!=="wheel"||s&&h.type==="wheel"&&!n)||!t&&h.ctrlKey&&h.type==="wheel")return!1;if(!t&&h.type==="touchstart"&&((g=h.touches)==null?void 0:g.length)>1)return h.preventDefault(),!1;if(!u&&!s&&!d&&h.type==="wheel"||!i&&(h.type==="mousedown"||h.type==="touchstart")||Array.isArray(i)&&!i.includes(h.button)&&h.type==="mousedown")return!1;const f=Array.isArray(i)&&i.includes(h.button)||!h.button||h.button<=1;return(!h.ctrlKey||h.type==="wheel")&&f}}function rie({domNode:n,minZoom:e,maxZoom:t,paneClickDistance:i,translateExtent:s,viewport:r,onPanZoom:a,onPanZoomStart:o,onPanZoomEnd:l,onDraggingChange:c}){const h={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{x:0,y:0,zoom:0},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},u=n.getBoundingClientRect(),d=vL().clickDistance(!il(i)||i<0?0:i).scaleExtent([e,t]).translateExtent(s),f=$o(n).call(d);w({x:r.x,y:r.y,zoom:Wg(r.zoom,e,t)},[[0,0],[u.width,u.height]],s);const g=f.on("wheel.zoom"),m=f.on("dblclick.zoom");d.wheelDelta($O);function b(D,H){return f?new Promise(R=>{d==null||d.transform(n8(f,H==null?void 0:H.duration,()=>R(!0)),D)}):Promise.resolve(!1)}function p({noWheelClassName:D,noPanClassName:H,onPaneContextMenu:R,userSelectionActive:z,panOnScroll:P,panOnDrag:B,panOnScrollMode:Z,panOnScrollSpeed:G,preventScrolling:Y,zoomOnPinch:J,zoomOnScroll:se,zoomOnDoubleClick:fe,zoomActivationKeyPressed:he,lib:de,onTransformChange:ge}){z&&!h.isZoomingOrPanning&&y();const K=P&&!he&&!z?$ne({zoomPanValues:h,noWheelClassName:D,d3Selection:f,d3Zoom:d,panOnScrollMode:Z,panOnScrollSpeed:G,zoomOnPinch:J,onPanZoomStart:o,onPanZoom:a,onPanZoomEnd:l}):eie({noWheelClassName:D,preventScrolling:Y,d3ZoomHandler:g});if(f.on("wheel.zoom",K,{passive:!1}),!z){const W=tie({zoomPanValues:h,onDraggingChange:c,onPanZoomStart:o});d.on("start",W);const le=nie({zoomPanValues:h,panOnDrag:B,onPaneContextMenu:!!R,onPanZoom:a,onTransformChange:ge});d.on("zoom",le);const ce=iie({zoomPanValues:h,panOnDrag:B,panOnScroll:P,onPaneContextMenu:R,onPanZoomEnd:l,onDraggingChange:c});d.on("end",ce)}const oe=sie({zoomActivationKeyPressed:he,panOnDrag:B,zoomOnScroll:se,panOnScroll:P,zoomOnDoubleClick:fe,zoomOnPinch:J,userSelectionActive:z,noPanClassName:H,noWheelClassName:D,lib:de});d.filter(oe),fe?f.on("dblclick.zoom",m):f.on("dblclick.zoom",null)}function y(){d.on("zoom",null)}async function w(D,H,R){const z=t8(D),P=d==null?void 0:d.constrain()(z,H,R);return P&&await b(P),new Promise(B=>B(P))}async function _(D,H){const R=t8(D);return await b(R,H),new Promise(z=>z(R))}function v(D){if(f){const H=t8(D),R=f.property("__zoom");(R.k!==D.zoom||R.x!==D.x||R.y!==D.y)&&(d==null||d.transform(f,H,null,{sync:!0}))}}function C(){const D=f?AD(f.node()):{x:0,y:0,k:1};return{x:D.x,y:D.y,zoom:D.k}}function k(D,H){return f?new Promise(R=>{d==null||d.scaleTo(n8(f,H==null?void 0:H.duration,()=>R(!0)),D)}):Promise.resolve(!1)}function I(D,H){return f?new Promise(R=>{d==null||d.scaleBy(n8(f,H==null?void 0:H.duration,()=>R(!0)),D)}):Promise.resolve(!1)}function E(D){d==null||d.scaleExtent(D)}function T(D){d==null||d.translateExtent(D)}function M(D){const H=!il(D)||D<0?0:D;d==null||d.clickDistance(H)}return{update:p,destroy:y,setViewport:_,setViewportConstrained:w,getViewport:C,scaleTo:k,scaleBy:I,setScaleExtent:E,setTranslateExtent:T,syncViewport:v,setClickDistance:M}}var IS;(function(n){n.Line="line",n.Handle="handle"})(IS||(IS={}));function aie(n){let e,t,i,s,r,a;const o=n[45].default,l=Xs(o,n,n[44],null);return{c(){e=te("div"),l&&l.c(),this.h()},l(c){e=ne(c,"DIV",{"data-handleid":!0,"data-nodeid":!0,"data-handlepos":!0,"data-id":!0,class:!0,style:!0,role:!0,tabindex:!0});var h=V(e);l&&l.l(h),h.forEach(S),this.h()},h(){A(e,"data-handleid",n[6]),A(e,"data-nodeid",n[14]),A(e,"data-handlepos",n[2]),A(e,"data-id",t=n[13]+"-"+n[14]+"-"+(n[0]||null)+"-"+n[1]),A(e,"class",i=Ri(["svelte-flow__handle",`svelte-flow__handle-${n[2]}`,"nodrag","nopan",n[2],n[4]])),A(e,"style",n[3]),A(e,"role","button"),A(e,"tabindex","-1"),bn(e,"valid",n[7]),bn(e,"connectingto",n[5]),bn(e,"connectingfrom",n[9]),bn(e,"source",!n[11]),bn(e,"target",n[11]),bn(e,"connectablestart",n[12]),bn(e,"connectableend",n[12]),bn(e,"connectable",n[12]),bn(e,"connectionindicator",n[12]&&(!n[10]||n[8]))},m(c,h){ee(c,e,h),l&&l.m(e,null),s=!0,r||(a=[pt(e,"mousedown",n[32]),pt(e,"touchstart",n[32])],r=!0)},p(c,h){l&&l.p&&(!s||h[1]&8192)&&Ys(l,o,c,c[44],s?Zs(o,c[44],h,null):Js(c[44]),null),(!s||h[0]&64)&&A(e,"data-handleid",c[6]),(!s||h[0]&4)&&A(e,"data-handlepos",c[2]),(!s||h[0]&8195&&t!==(t=c[13]+"-"+c[14]+"-"+(c[0]||null)+"-"+c[1]))&&A(e,"data-id",t),(!s||h[0]&20&&i!==(i=Ri(["svelte-flow__handle",`svelte-flow__handle-${c[2]}`,"nodrag","nopan",c[2],c[4]])))&&A(e,"class",i),(!s||h[0]&8)&&A(e,"style",c[3]),(!s||h[0]&148)&&bn(e,"valid",c[7]),(!s||h[0]&52)&&bn(e,"connectingto",c[5]),(!s||h[0]&532)&&bn(e,"connectingfrom",c[9]),(!s||h[0]&2068)&&bn(e,"source",!c[11]),(!s||h[0]&2068)&&bn(e,"target",c[11]),(!s||h[0]&4116)&&bn(e,"connectablestart",c[12]),(!s||h[0]&4116)&&bn(e,"connectableend",c[12]),(!s||h[0]&4116)&&bn(e,"connectable",c[12]),(!s||h[0]&5396)&&bn(e,"connectionindicator",c[12]&&(!c[10]||c[8]))},i(c){s||(L(l,c),s=!0)},o(c){j(l,c),s=!1},d(c){c&&S(e),l&&l.d(c),r=!1,ia(a)}}}function oie(n,e,t){let i,s,r,a,o,l,c,h,u,d,f,g,m,b,p,y,w,_,v,C,k,I,E,T,M,{$$slots:D={},$$scope:H}=e,{id:R=void 0}=e,{type:z="source"}=e,{position:P=xn.Top}=e,{style:B=void 0}=e,{isValidConnection:Z=void 0}=e,{onconnect:G=void 0}=e,{ondisconnect:Y=void 0}=e,{isConnectable:J=void 0}=e,{class:se=void 0}=e;const fe=hs("svelteflow__node_id"),he=hs("svelteflow__node_connectable");Pe(n,he,ze=>t(43,M=ze));const de=rs(),{connectionMode:ge,domNode:N,nodeLookup:K,connectionRadius:oe,viewport:W,isValidConnection:le,lib:ce,addEdge:Ce,onedgecreate:X,panBy:Ke,cancelConnection:qe,updateConnection:He,autoPanOnConnect:Me,edges:Ne,connectionLookup:Qe,onconnect:gt,onconnectstart:mt,onconnectend:Xe,flowId:rt,connection:me}=de;Pe(n,ge,ze=>t(40,d=ze)),Pe(n,N,ze=>t(55,E=ze)),Pe(n,K,ze=>t(54,I=ze)),Pe(n,oe,ze=>t(56,T=ze)),Pe(n,W,ze=>t(46,m=ze)),Pe(n,le,ze=>t(51,_=ze)),Pe(n,ce,ze=>t(53,k=ze)),Pe(n,X,ze=>t(50,w=ze)),Pe(n,Me,ze=>t(52,C=ze)),Pe(n,Ne,ze=>t(42,g=ze)),Pe(n,Qe,ze=>t(41,f=ze)),Pe(n,gt,ze=>t(49,y=ze)),Pe(n,mt,ze=>t(48,p=ze)),Pe(n,Xe,ze=>t(47,b=ze)),Pe(n,rt,ze=>t(13,v=ze)),Pe(n,me,ze=>t(39,u=ze));function Rt(ze){const Ht=LO(ze);(Ht&&ze.button===0||!Ht)&&Zne.onPointerDown(ze,{handleId:r,nodeId:fe,isTarget:i,connectionRadius:T,domNode:E,nodeLookup:I,connectionMode:d,lib:k,autoPanOnConnect:C,flowId:v,isValidConnection:Z??_,updateConnection:He,cancelConnection:qe,panBy:Ke,onConnect:on=>{const Re=w?w(on):on;Re&&(Ce(Re),y==null||y(on))},onConnectStart:(on,Re)=>{p==null||p(on,{nodeId:Re.nodeId,handleId:Re.handleId,handleType:Re.handleType})},onConnectEnd:(on,Re)=>{b==null||b(on,Re)},getTransform:()=>[m.x,m.y,m.zoom],getFromHandle:()=>u.fromHandle})}let ct=null,at;return n.$$set=ze=>{"id"in ze&&t(0,R=ze.id),"type"in ze&&t(1,z=ze.type),"position"in ze&&t(2,P=ze.position),"style"in ze&&t(3,B=ze.style),"isValidConnection"in ze&&t(33,Z=ze.isValidConnection),"onconnect"in ze&&t(34,G=ze.onconnect),"ondisconnect"in ze&&t(35,Y=ze.ondisconnect),"isConnectable"in ze&&t(36,J=ze.isConnectable),"class"in ze&&t(4,se=ze.class),"$$scope"in ze&&t(44,H=ze.$$scope)},n.$$.update=()=>{var ze,Ht,on,Re,Mt,yt,Gt,un,Kn;if(n.$$.dirty[0]&2&&t(11,i=z==="target"),n.$$.dirty[1]&4128&&t(12,s=J!==void 0?J:M),n.$$.dirty[0]&1&&t(6,r=R||null),n.$$.dirty[0]&3|n.$$.dirty[1]&3096&&(G||Y)&&t(38,at=f.get(`${fe}-${z}-${R||null}`)),n.$$.dirty[1]&216){if(ct&&!pne(at,ct)){const di=at??new Map;dS(ct,di,Y),dS(di,ct,G)}t(37,ct=at??new Map)}n.$$.dirty[1]&256&&t(10,a=!!u.fromHandle),n.$$.dirty[0]&66|n.$$.dirty[1]&256&&t(9,o=((ze=u.fromHandle)==null?void 0:ze.nodeId)===fe&&((Ht=u.fromHandle)==null?void 0:Ht.type)===z&&((on=u.fromHandle)==null?void 0:on.id)===r),n.$$.dirty[0]&66|n.$$.dirty[1]&256&&t(5,l=((Re=u.toHandle)==null?void 0:Re.nodeId)===fe&&((Mt=u.toHandle)==null?void 0:Mt.type)===z&&((yt=u.toHandle)==null?void 0:yt.id)===r),n.$$.dirty[0]&66|n.$$.dirty[1]&768&&t(8,c=d===hf.Strict?((Gt=u.fromHandle)==null?void 0:Gt.type)!==z:fe!==((un=u.fromHandle)==null?void 0:un.nodeId)||r!==((Kn=u.fromHandle)==null?void 0:Kn.id)),n.$$.dirty[0]&32|n.$$.dirty[1]&256&&t(7,h=l&&u.isValid)},[R,z,P,B,se,l,r,h,c,o,a,i,s,v,fe,he,ge,N,K,oe,W,le,ce,X,Me,Ne,Qe,gt,mt,Xe,rt,me,Rt,Z,G,Y,J,ct,at,u,d,f,g,M,H,D]}class Yg extends Nt{constructor(e){super(),Ot(this,e,oie,aie,Ft,{id:0,type:1,position:2,style:3,isValidConnection:33,onconnect:34,ondisconnect:35,isConnectable:36,class:4},null,[-1,-1])}}function lie(n){var l;let e,t,i=((l=n[0])==null?void 0:l.label)+"",s,r,a,o;return e=new Yg({props:{type:"target",position:n[1]??xn.Top}}),a=new Yg({props:{type:"source",position:n[2]??xn.Bottom}}),{c(){pe(e.$$.fragment),t=Ae(),s=_t(i),r=Ae(),pe(a.$$.fragment)},l(c){ye(e.$$.fragment,c),t=Se(c),s=vt(c,i),r=Se(c),ye(a.$$.fragment,c)},m(c,h){be(e,c,h),ee(c,t,h),ee(c,s,h),ee(c,r,h),be(a,c,h),o=!0},p(c,[h]){var f;const u={};h&2&&(u.position=c[1]??xn.Top),e.$set(u),(!o||h&1)&&i!==(i=((f=c[0])==null?void 0:f.label)+"")&&St(s,i);const d={};h&4&&(d.position=c[2]??xn.Bottom),a.$set(d)},i(c){o||(L(e.$$.fragment,c),L(a.$$.fragment,c),o=!0)},o(c){j(e.$$.fragment,c),j(a.$$.fragment,c),o=!1},d(c){c&&(S(t),S(s),S(r)),xe(e,c),xe(a,c)}}}function cie(n,e,t){const i=["data","targetPosition","sourcePosition"];is(e,i);let{data:s={label:"Node"}}=e,{targetPosition:r=void 0}=e,{sourcePosition:a=void 0}=e;return n.$$set=o=>{e=li(li({},e),gl(o)),t(3,is(e,i)),"data"in o&&t(0,s=o.data),"targetPosition"in o&&t(1,r=o.targetPosition),"sourcePosition"in o&&t(2,a=o.sourcePosition)},[s,r,a]}class eD extends Nt{constructor(e){super(),Ot(this,e,cie,lie,Ft,{data:0,targetPosition:1,sourcePosition:2})}}function hie(n){var a;let e=((a=n[0])==null?void 0:a.label)+"",t,i,s,r;return s=new Yg({props:{type:"source",position:n[1]??xn.Bottom}}),{c(){t=_t(e),i=Ae(),pe(s.$$.fragment)},l(o){t=vt(o,e),i=Se(o),ye(s.$$.fragment,o)},m(o,l){ee(o,t,l),ee(o,i,l),be(s,o,l),r=!0},p(o,[l]){var h;(!r||l&1)&&e!==(e=((h=o[0])==null?void 0:h.label)+"")&&St(t,e);const c={};l&2&&(c.position=o[1]??xn.Bottom),s.$set(c)},i(o){r||(L(s.$$.fragment,o),r=!0)},o(o){j(s.$$.fragment,o),r=!1},d(o){o&&(S(t),S(i)),xe(s,o)}}}function uie(n,e,t){const i=["data","sourcePosition"];is(e,i);let{data:s={label:"Node"}}=e,{sourcePosition:r=void 0}=e;return n.$$set=a=>{e=li(li({},e),gl(a)),t(2,is(e,i)),"data"in a&&t(0,s=a.data),"sourcePosition"in a&&t(1,r=a.sourcePosition)},[s,r]}class die extends Nt{constructor(e){super(),Ot(this,e,uie,hie,Ft,{data:0,sourcePosition:1})}}function fie(n){var a;let e=((a=n[0])==null?void 0:a.label)+"",t,i,s,r;return s=new Yg({props:{type:"target",position:n[1]??xn.Top}}),{c(){t=_t(e),i=Ae(),pe(s.$$.fragment)},l(o){t=vt(o,e),i=Se(o),ye(s.$$.fragment,o)},m(o,l){ee(o,t,l),ee(o,i,l),be(s,o,l),r=!0},p(o,[l]){var h;(!r||l&1)&&e!==(e=((h=o[0])==null?void 0:h.label)+"")&&St(t,e);const c={};l&2&&(c.position=o[1]??xn.Top),s.$set(c)},i(o){r||(L(s.$$.fragment,o),r=!0)},o(o){j(s.$$.fragment,o),r=!1},d(o){o&&(S(t),S(i)),xe(s,o)}}}function gie(n,e,t){const i=["data","targetPosition"];is(e,i);let{data:s={label:"Node"}}=e,{targetPosition:r=void 0}=e;return n.$$set=a=>{e=li(li({},e),gl(a)),t(2,is(e,i)),"data"in a&&t(0,s=a.data),"targetPosition"in a&&t(1,r=a.targetPosition)},[s,r]}class mie extends Nt{constructor(e){super(),Ot(this,e,gie,fie,Ft,{data:0,targetPosition:1})}}function pie(n,e,t){const i=[];return is(e,i),n.$$set=s=>{e=li(li({},e),gl(s)),t(0,is(e,i))},[]}class bie extends Nt{constructor(e){super(),Ot(this,e,pie,null,Ft,{})}}function ES(n,e,t){if(!e)return;const i=t?e.querySelector(t):e;i&&i.appendChild(n)}function xie(n,{target:e,domNode:t}){return ES(n,t,e),{async update({target:i,domNode:s}){ES(n,s,i)},destroy(){n.parentNode&&n.parentNode.removeChild(n)}}}function yie(n){let e,t,i,s,r;const a=n[3].default,o=Xs(a,n,n[2],null);return{c(){e=te("div"),o&&o.c()},l(l){e=ne(l,"DIV",{});var c=V(e);o&&o.l(c),c.forEach(S)},m(l,c){ee(l,e,c),o&&o.m(e,null),i=!0,s||(r=ua(t=xie.call(null,e,{target:".svelte-flow__edgelabel-renderer",domNode:n[0]})),s=!0)},p(l,[c]){o&&o.p&&(!i||c&4)&&Ys(o,a,l,l[2],i?Zs(a,l[2],c,null):Js(l[2]),null),t&&js(t.update)&&c&1&&t.update.call(null,{target:".svelte-flow__edgelabel-renderer",domNode:l[0]})},i(l){i||(L(o,l),i=!0)},o(l){j(o,l),i=!1},d(l){l&&S(e),o&&o.d(l),s=!1,r()}}}function wie(n,e,t){let i,{$$slots:s={},$$scope:r}=e;const{domNode:a}=rs();return Pe(n,a,o=>t(0,i=o)),n.$$set=o=>{"$$scope"in o&&t(2,r=o.$$scope)},[i,a,r,s]}class _ie extends Nt{constructor(e){super(),Ot(this,e,wie,yie,Ft,{})}}function tD(){const{edgeLookup:n,selectionRect:e,selectionRectMode:t,multiselectionKeyPressed:i,addSelectedEdges:s,unselectNodesAndEdges:r,elementsSelectable:a}=rs();return o=>{const l=Ye(n).get(o);if(!l){console.warn("012",Mx.error012(o));return}(l.selectable||Ye(a)&&typeof l.selectable>"u")&&(e.set(null),t.set(null),l.selected?l.selected&&Ye(i)&&r({nodes:[],edges:[l]}):s([o]))}}function vie(n){let e,t,i=`translate(-50%, -50%) translate(${n[1]}px,${n[2]}px)`,s,r,a;const o=n[5].default,l=Xs(o,n,n[7],null);return{c(){e=te("div"),l&&l.c(),this.h()},l(c){e=ne(c,"DIV",{class:!0,style:!0,role:!0,tabindex:!0});var h=V(e);l&&l.l(h),h.forEach(S),this.h()},h(){A(e,"class","svelte-flow__edge-label"),A(e,"style",t="pointer-events: all;"+n[0]),A(e,"role","button"),A(e,"tabindex","-1"),rn(e,"transform",i)},m(c,h){ee(c,e,h),l&&l.m(e,null),s=!0,r||(a=[pt(e,"keyup",Cie),pt(e,"click",n[6])],r=!0)},p(c,h){l&&l.p&&(!s||h&128)&&Ys(l,o,c,c[7],s?Zs(o,c[7],h,null):Js(c[7]),null),(!s||h&1&&t!==(t="pointer-events: all;"+c[0]))&&A(e,"style",t);const u=h&1;(h&7&&i!==(i=`translate(-50%, -50%) translate(${c[1]}px,${c[2]}px)`)||u)&&rn(e,"transform",i)},i(c){s||(L(l,c),s=!0)},o(c){j(l,c),s=!1},d(c){c&&S(e),l&&l.d(c),r=!1,ia(a)}}}function kie(n){let e,t;return e=new _ie({props:{$$slots:{default:[vie]},$$scope:{ctx:n}}}),{c(){pe(e.$$.fragment)},l(i){ye(e.$$.fragment,i)},m(i,s){be(e,i,s),t=!0},p(i,[s]){const r={};s&135&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(L(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){xe(e,i)}}}const Cie=()=>{};function Aie(n,e,t){let{$$slots:i={},$$scope:s}=e,{style:r=void 0}=e,{x:a=void 0}=e,{y:o=void 0}=e;const l=tD(),c=hs("svelteflow__edge_id"),h=()=>{c&&l(c)};return n.$$set=u=>{"style"in u&&t(0,r=u.style),"x"in u&&t(1,a=u.x),"y"in u&&t(2,o=u.y),"$$scope"in u&&t(7,s=u.$$scope)},[r,a,o,l,c,i,h,s]}class Sie extends Nt{constructor(e){super(),Ot(this,e,Aie,kie,Ft,{style:0,x:1,y:2})}}function Iie(n){let e;return{c(){e=nt("path"),this.h()},l(t){e=it(t,"path",{d:!0,"stroke-opacity":!0,"stroke-width":!0,fill:!0,class:!0}),V(e).forEach(S),this.h()},h(){A(e,"d",n[1]),A(e,"stroke-opacity",0),A(e,"stroke-width",n[10]),A(e,"fill","none"),A(e,"class","svelte-flow__edge-interaction")},m(t,i){ee(t,e,i)},p(t,i){i&2&&A(e,"d",t[1])},d(t){t&&S(e)}}}function TS(n){let e,t;return e=new Sie({props:{x:n[3],y:n[4],style:n[5],$$slots:{default:[Eie]},$$scope:{ctx:n}}}),{c(){pe(e.$$.fragment)},l(i){ye(e.$$.fragment,i)},m(i,s){be(e,i,s),t=!0},p(i,s){const r={};s&8&&(r.x=i[3]),s&16&&(r.y=i[4]),s&32&&(r.style=i[5]),s&4100&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(L(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){xe(e,i)}}}function Eie(n){let e;return{c(){e=_t(n[2])},l(t){e=vt(t,n[2])},m(t,i){ee(t,e,i)},p(t,i){i&4&&St(e,t[2])},d(t){t&&S(e)}}}function Tie(n){let e,t,i,s,r,a,o=n[10]&&Iie(n),l=n[2]&&TS(n);return{c(){e=nt("path"),i=Ae(),o&&o.c(),s=Ae(),l&&l.c(),r=Ut(),this.h()},l(c){e=it(c,"path",{id:!0,d:!0,class:!0,"marker-start":!0,"marker-end":!0,fill:!0,style:!0}),V(e).forEach(S),i=Se(c),o&&o.l(c),s=Se(c),l&&l.l(c),r=Ut(),this.h()},h(){A(e,"id",n[0]),A(e,"d",n[1]),A(e,"class",t=Ri(["svelte-flow__edge-path",n[9]])),A(e,"marker-start",n[6]),A(e,"marker-end",n[7]),A(e,"fill","none"),A(e,"style",n[8])},m(c,h){ee(c,e,h),ee(c,i,h),o&&o.m(c,h),ee(c,s,h),l&&l.m(c,h),ee(c,r,h),a=!0},p(c,[h]){(!a||h&1)&&A(e,"id",c[0]),(!a||h&2)&&A(e,"d",c[1]),(!a||h&512&&t!==(t=Ri(["svelte-flow__edge-path",c[9]])))&&A(e,"class",t),(!a||h&64)&&A(e,"marker-start",c[6]),(!a||h&128)&&A(e,"marker-end",c[7]),(!a||h&256)&&A(e,"style",c[8]),c[10]&&o.p(c,h),c[2]?l?(l.p(c,h),h&4&&L(l,1)):(l=TS(c),l.c(),L(l,1),l.m(r.parentNode,r)):l&&(ot(),j(l,1,1,()=>{l=null}),lt())},i(c){a||(L(l),a=!0)},o(c){j(l),a=!1},d(c){c&&(S(e),S(i),S(s),S(r)),o&&o.d(c),l&&l.d(c)}}}function Rie(n,e,t){let{id:i=void 0}=e,{path:s}=e,{label:r=void 0}=e,{labelX:a=void 0}=e,{labelY:o=void 0}=e,{labelStyle:l=void 0}=e,{markerStart:c=void 0}=e,{markerEnd:h=void 0}=e,{style:u=void 0}=e,{interactionWidth:d=20}=e,{class:f=void 0}=e,g=d===void 0?20:d;return n.$$set=m=>{"id"in m&&t(0,i=m.id),"path"in m&&t(1,s=m.path),"label"in m&&t(2,r=m.label),"labelX"in m&&t(3,a=m.labelX),"labelY"in m&&t(4,o=m.labelY),"labelStyle"in m&&t(5,l=m.labelStyle),"markerStart"in m&&t(6,c=m.markerStart),"markerEnd"in m&&t(7,h=m.markerEnd),"style"in m&&t(8,u=m.style),"interactionWidth"in m&&t(11,d=m.interactionWidth),"class"in m&&t(9,f=m.class)},[i,s,r,a,o,l,c,h,u,f,g,d]}class zy extends Nt{constructor(e){super(),Ot(this,e,Rie,Tie,Ft,{id:0,path:1,label:2,labelX:3,labelY:4,labelStyle:5,markerStart:6,markerEnd:7,style:8,interactionWidth:11,class:9})}}function Mie(n){let e,t;return e=new zy({props:{path:n[8],labelX:n[7],labelY:n[6],label:n[0],labelStyle:n[1],markerStart:n[3],markerEnd:n[4],interactionWidth:n[5],style:n[2]}}),{c(){pe(e.$$.fragment)},l(i){ye(e.$$.fragment,i)},m(i,s){be(e,i,s),t=!0},p(i,[s]){const r={};s&256&&(r.path=i[8]),s&128&&(r.labelX=i[7]),s&64&&(r.labelY=i[6]),s&1&&(r.label=i[0]),s&2&&(r.labelStyle=i[1]),s&8&&(r.markerStart=i[3]),s&16&&(r.markerEnd=i[4]),s&32&&(r.interactionWidth=i[5]),s&4&&(r.style=i[2]),e.$set(r)},i(i){t||(L(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){xe(e,i)}}}function Pie(n,e,t){let i,s,r;const a=["label","labelStyle","style","markerStart","markerEnd","interactionWidth","sourceX","sourceY","sourcePosition","targetX","targetY","targetPosition"];is(e,a);let{label:o=void 0}=e,{labelStyle:l=void 0}=e,{style:c=void 0}=e,{markerStart:h=void 0}=e,{markerEnd:u=void 0}=e,{interactionWidth:d=void 0}=e,{sourceX:f}=e,{sourceY:g}=e,{sourcePosition:m}=e,{targetX:b}=e,{targetY:p}=e,{targetPosition:y}=e;return n.$$set=w=>{e=li(li({},e),gl(w)),t(15,is(e,a)),"label"in w&&t(0,o=w.label),"labelStyle"in w&&t(1,l=w.labelStyle),"style"in w&&t(2,c=w.style),"markerStart"in w&&t(3,h=w.markerStart),"markerEnd"in w&&t(4,u=w.markerEnd),"interactionWidth"in w&&t(5,d=w.interactionWidth),"sourceX"in w&&t(9,f=w.sourceX),"sourceY"in w&&t(10,g=w.sourceY),"sourcePosition"in w&&t(11,m=w.sourcePosition),"targetX"in w&&t(12,b=w.targetX),"targetY"in w&&t(13,p=w.targetY),"targetPosition"in w&&t(14,y=w.targetPosition)},n.$$.update=()=>{n.$$.dirty&32256&&t(8,[i,s,r]=BO({sourceX:f,sourceY:g,targetX:b,targetY:p,sourcePosition:m,targetPosition:y}),i,(t(7,s),t(9,f),t(10,g),t(12,b),t(13,p),t(11,m),t(14,y)),(t(6,r),t(9,f),t(10,g),t(12,b),t(13,p),t(11,m),t(14,y)))},[o,l,c,h,u,d,r,s,i,f,g,m,b,p,y]}class nD extends Nt{constructor(e){super(),Ot(this,e,Pie,Mie,Ft,{label:0,labelStyle:1,style:2,markerStart:3,markerEnd:4,interactionWidth:5,sourceX:9,sourceY:10,sourcePosition:11,targetX:12,targetY:13,targetPosition:14})}}function Nie(n){let e,t;return e=new zy({props:{path:n[8],labelX:n[7],labelY:n[6],label:n[0],labelStyle:n[1],markerStart:n[3],markerEnd:n[4],interactionWidth:n[5],style:n[2]}}),{c(){pe(e.$$.fragment)},l(i){ye(e.$$.fragment,i)},m(i,s){be(e,i,s),t=!0},p(i,[s]){const r={};s&256&&(r.path=i[8]),s&128&&(r.labelX=i[7]),s&64&&(r.labelY=i[6]),s&1&&(r.label=i[0]),s&2&&(r.labelStyle=i[1]),s&8&&(r.markerStart=i[3]),s&16&&(r.markerEnd=i[4]),s&32&&(r.interactionWidth=i[5]),s&4&&(r.style=i[2]),e.$set(r)},i(i){t||(L(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){xe(e,i)}}}function Oie(n,e,t){let i,s,r;const a=["label","labelStyle","style","markerStart","markerEnd","interactionWidth","sourceX","sourceY","sourcePosition","targetX","targetY","targetPosition"];is(e,a);let{label:o=void 0}=e,{labelStyle:l=void 0}=e,{style:c=void 0}=e,{markerStart:h=void 0}=e,{markerEnd:u=void 0}=e,{interactionWidth:d=void 0}=e,{sourceX:f}=e,{sourceY:g}=e,{sourcePosition:m}=e,{targetX:b}=e,{targetY:p}=e,{targetPosition:y}=e;return n.$$set=w=>{e=li(li({},e),gl(w)),t(15,is(e,a)),"label"in w&&t(0,o=w.label),"labelStyle"in w&&t(1,l=w.labelStyle),"style"in w&&t(2,c=w.style),"markerStart"in w&&t(3,h=w.markerStart),"markerEnd"in w&&t(4,u=w.markerEnd),"interactionWidth"in w&&t(5,d=w.interactionWidth),"sourceX"in w&&t(9,f=w.sourceX),"sourceY"in w&&t(10,g=w.sourceY),"sourcePosition"in w&&t(11,m=w.sourcePosition),"targetX"in w&&t(12,b=w.targetX),"targetY"in w&&t(13,p=w.targetY),"targetPosition"in w&&t(14,y=w.targetPosition)},n.$$.update=()=>{n.$$.dirty&32256&&t(8,[i,s,r]=p5({sourceX:f,sourceY:g,targetX:b,targetY:p,sourcePosition:m,targetPosition:y}),i,(t(7,s),t(9,f),t(10,g),t(12,b),t(13,p),t(11,m),t(14,y)),(t(6,r),t(9,f),t(10,g),t(12,b),t(13,p),t(11,m),t(14,y)))},[o,l,c,h,u,d,r,s,i,f,g,m,b,p,y]}class Die extends Nt{constructor(e){super(),Ot(this,e,Oie,Nie,Ft,{label:0,labelStyle:1,style:2,markerStart:3,markerEnd:4,interactionWidth:5,sourceX:9,sourceY:10,sourcePosition:11,targetX:12,targetY:13,targetPosition:14})}}function Fie(n){let e,t;return e=new zy({props:{path:n[8],labelX:n[7],labelY:n[6],label:n[0],labelStyle:n[1],markerStart:n[3],markerEnd:n[4],interactionWidth:n[5],style:n[2]}}),{c(){pe(e.$$.fragment)},l(i){ye(e.$$.fragment,i)},m(i,s){be(e,i,s),t=!0},p(i,[s]){const r={};s&256&&(r.path=i[8]),s&128&&(r.labelX=i[7]),s&64&&(r.labelY=i[6]),s&1&&(r.label=i[0]),s&2&&(r.labelStyle=i[1]),s&8&&(r.markerStart=i[3]),s&16&&(r.markerEnd=i[4]),s&32&&(r.interactionWidth=i[5]),s&4&&(r.style=i[2]),e.$set(r)},i(i){t||(L(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){xe(e,i)}}}function Lie(n,e,t){let i,s,r;const a=["label","labelStyle","style","markerStart","markerEnd","interactionWidth","sourceX","sourceY","targetX","targetY"];is(e,a);let{label:o=void 0}=e,{labelStyle:l=void 0}=e,{style:c=void 0}=e,{markerStart:h=void 0}=e,{markerEnd:u=void 0}=e,{interactionWidth:d=void 0}=e,{sourceX:f}=e,{sourceY:g}=e,{targetX:m}=e,{targetY:b}=e;return n.$$set=p=>{e=li(li({},e),gl(p)),t(13,is(e,a)),"label"in p&&t(0,o=p.label),"labelStyle"in p&&t(1,l=p.labelStyle),"style"in p&&t(2,c=p.style),"markerStart"in p&&t(3,h=p.markerStart),"markerEnd"in p&&t(4,u=p.markerEnd),"interactionWidth"in p&&t(5,d=p.interactionWidth),"sourceX"in p&&t(9,f=p.sourceX),"sourceY"in p&&t(10,g=p.sourceY),"targetX"in p&&t(11,m=p.targetX),"targetY"in p&&t(12,b=p.targetY)},n.$$.update=()=>{n.$$.dirty&7680&&t(8,[i,s,r]=HO({sourceX:f,sourceY:g,targetX:m,targetY:b}),i,(t(7,s),t(9,f),t(10,g),t(11,m),t(12,b)),(t(6,r),t(9,f),t(10,g),t(11,m),t(12,b)))},[o,l,c,h,u,d,r,s,i,f,g,m,b]}class Bie extends Nt{constructor(e){super(),Ot(this,e,Lie,Fie,Ft,{label:0,labelStyle:1,style:2,markerStart:3,markerEnd:4,interactionWidth:5,sourceX:9,sourceY:10,targetX:11,targetY:12})}}function Uie(n){let e,t;return e=new zy({props:{path:n[8],labelX:n[7],labelY:n[6],label:n[0],labelStyle:n[1],markerStart:n[3],markerEnd:n[4],interactionWidth:n[5],style:n[2]}}),{c(){pe(e.$$.fragment)},l(i){ye(e.$$.fragment,i)},m(i,s){be(e,i,s),t=!0},p(i,[s]){const r={};s&256&&(r.path=i[8]),s&128&&(r.labelX=i[7]),s&64&&(r.labelY=i[6]),s&1&&(r.label=i[0]),s&2&&(r.labelStyle=i[1]),s&8&&(r.markerStart=i[3]),s&16&&(r.markerEnd=i[4]),s&32&&(r.interactionWidth=i[5]),s&4&&(r.style=i[2]),e.$set(r)},i(i){t||(L(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){xe(e,i)}}}function Hie(n,e,t){let i,s,r;const a=["label","labelStyle","style","markerStart","markerEnd","interactionWidth","sourceX","sourceY","sourcePosition","targetX","targetY","targetPosition"];is(e,a);let{label:o=void 0}=e,{labelStyle:l=void 0}=e,{style:c=void 0}=e,{markerStart:h=void 0}=e,{markerEnd:u=void 0}=e,{interactionWidth:d=void 0}=e,{sourceX:f}=e,{sourceY:g}=e,{sourcePosition:m}=e,{targetX:b}=e,{targetY:p}=e,{targetPosition:y}=e;return n.$$set=w=>{e=li(li({},e),gl(w)),t(15,is(e,a)),"label"in w&&t(0,o=w.label),"labelStyle"in w&&t(1,l=w.labelStyle),"style"in w&&t(2,c=w.style),"markerStart"in w&&t(3,h=w.markerStart),"markerEnd"in w&&t(4,u=w.markerEnd),"interactionWidth"in w&&t(5,d=w.interactionWidth),"sourceX"in w&&t(9,f=w.sourceX),"sourceY"in w&&t(10,g=w.sourceY),"sourcePosition"in w&&t(11,m=w.sourcePosition),"targetX"in w&&t(12,b=w.targetX),"targetY"in w&&t(13,p=w.targetY),"targetPosition"in w&&t(14,y=w.targetPosition)},n.$$.update=()=>{n.$$.dirty&32256&&t(8,[i,s,r]=p5({sourceX:f,sourceY:g,targetX:b,targetY:p,sourcePosition:m,targetPosition:y,borderRadius:0}),i,(t(7,s),t(9,f),t(10,g),t(12,b),t(13,p),t(11,m),t(14,y)),(t(6,r),t(9,f),t(10,g),t(12,b),t(13,p),t(11,m),t(14,y)))},[o,l,c,h,u,d,r,s,i,f,g,m,b,p,y]}class zie extends Nt{constructor(e){super(),Ot(this,e,Hie,Uie,Ft,{label:0,labelStyle:1,style:2,markerStart:3,markerEnd:4,interactionWidth:5,sourceX:9,sourceY:10,sourcePosition:11,targetX:12,targetY:13,targetPosition:14})}}function jie(n,e){const t=n.set,i=e.set,s=Ye(n),r=Ye(e);let o=s.length===0&&r.length>0?r:s;n.set(o);const l=c=>{const h=t(c);return o=h,i(o),h};n.set=e.set=l,n.update=e.update=c=>l(c(o))}function Gie(n,e){const t=n.set,i=e.set;let s=Ye(e);n.set(s);const r=a=>{t(a),i(a),s=a};n.set=e.set=r,n.update=e.update=a=>r(a(s))}const Vie=(n,e,t)=>{if(!t)return;const i=Ye(n),s=e.set,r=t.set;let a=t?Ye(t):{x:0,y:0,zoom:1};e.set(a),e.set=o=>(s(o),r(o),a=o,o),t.set=o=>(i==null||i.syncViewport(o),s(o),r(o),a=o,o),e.update=o=>{e.set(o(a))},t.update=o=>{t.set(o(a))}},qie=(n,e,t,i=[0,0],s=u5)=>{const{subscribe:r,set:a,update:o}=nn([]);let l=n,c={},h=!0;const u=m=>(GO(m,e,t,{elevateNodesOnSelect:h,nodeOrigin:i,nodeExtent:s,defaults:c,checkEquality:!1}),l=m,a(l),l),d=m=>u(m(l)),f=m=>{c=m},g=m=>{h=m.elevateNodesOnSelect??h};return u(l),{subscribe:r,set:u,update:d,setDefaultOptions:f,setOptions:g}},Wie=(n,e,t,i)=>{const{subscribe:s,set:r,update:a}=nn([]);let o=n,l={};const c=d=>{const f=l?d.map(g=>({...l,...g})):d;WO(e,t,f),o=f,r(o)},h=d=>c(d(o)),u=d=>{l=d};return c(o),{subscribe:s,set:c,update:h,setDefaultOptions:u}},iD={input:die,output:mie,default:eD,group:bie},sD={straight:Bie,smoothstep:Die,default:nD,step:zie},Kie=({nodes:n=[],edges:e=[],width:t,height:i,fitView:s,nodeOrigin:r,nodeExtent:a})=>{const o=new Map,l=new Map,c=new Map,h=new Map,u=r??[0,0],d=a??u5;GO(n,o,l,{nodeExtent:d,nodeOrigin:u,elevateNodesOnSelect:!1,checkEquality:!1}),WO(c,h,e);let f={x:0,y:0,zoom:1};if(s&&t&&i){const g=Ly(o,{filter:m=>!!((m.width||m.initialWidth)&&(m.height||m.initialHeight))});f=J_(g,t,i,.5,2,.1)}return{flowId:nn(null),nodes:qie(n,o,l,u,d),nodeLookup:No(o),parentLookup:No(l),edgeLookup:No(h),visibleNodes:No([]),edges:Wie(e,c,h),visibleEdges:No([]),connectionLookup:No(c),height:nn(500),width:nn(500),minZoom:nn(.5),maxZoom:nn(2),nodeOrigin:nn(u),nodeDragThreshold:nn(1),nodeExtent:nn(d),translateExtent:nn(u5),autoPanOnNodeDrag:nn(!0),autoPanOnConnect:nn(!0),fitViewOnInit:nn(!1),fitViewOnInitDone:nn(!1),fitViewOptions:nn(void 0),panZoom:nn(null),snapGrid:nn(null),dragging:nn(!1),selectionRect:nn(null),selectionKeyPressed:nn(!1),multiselectionKeyPressed:nn(!1),deleteKeyPressed:nn(!1),panActivationKeyPressed:nn(!1),zoomActivationKeyPressed:nn(!1),selectionRectMode:nn(null),selectionMode:nn(d5.Partial),nodeTypes:nn(iD),edgeTypes:nn(sD),viewport:nn(f),connectionMode:nn(hf.Strict),domNode:nn(null),connection:No(t4),connectionLineType:nn(m1.Bezier),connectionRadius:nn(20),isValidConnection:nn(()=>!0),nodesDraggable:nn(!0),nodesConnectable:nn(!0),elementsSelectable:nn(!0),selectNodesOnDrag:nn(!0),markers:No([]),defaultMarkerColor:nn("#b1b1b7"),lib:No("svelte"),onlyRenderVisibleElements:nn(!1),onerror:nn(vne),ondelete:nn(void 0),onedgecreate:nn(void 0),onconnect:nn(void 0),onconnectstart:nn(void 0),onconnectend:nn(void 0),onbeforedelete:nn(void 0),nodesInitialized:nn(!1),edgesInitialized:nn(!1),viewportInitialized:nn(!1),initialized:No(!1)}};function Xie(n){const e=t1([n.edges,n.nodes,n.nodeLookup,n.onlyRenderVisibleElements,n.viewport,n.width,n.height],([t,,i,s,r,a,o])=>s&&a&&o?t.filter(c=>{const h=i.get(c.source),u=i.get(c.target);return h&&u&&Tne({sourceNode:h,targetNode:u,width:a,height:o,transform:[r.x,r.y,r.zoom]})}):t);return t1([e,n.nodes,n.nodeLookup,n.connectionMode,n.onerror],([t,,i,s,r])=>t.reduce((o,l)=>{const c=i.get(l.source),h=i.get(l.target);if(!c||!h)return o;const u=Fne({id:l.id,sourceNode:c,targetNode:h,sourceHandle:l.sourceHandle||null,targetHandle:l.targetHandle||null,connectionMode:s,onError:r});return u&&o.push({...l,zIndex:Ene({selected:l.selected,zIndex:l.zIndex,sourceNode:c,targetNode:h,elevateOnSelect:!1}),...u}),o},[]))}function Yie(n){return t1([n.nodeLookup,n.onlyRenderVisibleElements,n.width,n.height,n.viewport,n.nodes],([e,t,i,s,r])=>{const a=[r.x,r.y,r.zoom];return t?MO(e,{x:0,y:0,width:i,height:s},a,!0):Array.from(e.values())})}const jy=Symbol();function rD({nodes:n,edges:e,width:t,height:i,fitView:s,nodeOrigin:r,nodeExtent:a}){const o=Kie({nodes:n,edges:e,width:t,height:i,fitView:s,nodeOrigin:r,nodeExtent:a});function l(P){o.nodeTypes.set({...iD,...P})}function c(P){o.edgeTypes.set({...sD,...P})}function h(P){const B=Ye(o.edges);o.edges.set(Pne(P,B))}const u=(P,B=!1)=>{var G;const Z=Ye(o.nodeLookup);for(const[Y,J]of P){const se=(G=Z.get(Y))==null?void 0:G.internals.userNode;se&&(se.position=J.position,se.dragging=B)}o.nodes.update(Y=>Y)};function d(P){var Y,J,se;const B=Ye(o.nodeLookup),{changes:Z,updatedInternals:G}=jne(P,B,Ye(o.parentLookup),Ye(o.domNode),Ye(o.nodeOrigin));if(G){if(!Ye(o.fitViewOnInitDone)&&Ye(o.fitViewOnInit)){const fe=Ye(o.fitViewOptions),he=g({...fe,nodes:fe==null?void 0:fe.nodes});o.fitViewOnInitDone.set(he)}for(const fe of Z){const he=(Y=B.get(fe.id))==null?void 0:Y.internals.userNode;if(he)switch(fe.type){case"dimensions":{const de={...he.measured,...fe.dimensions};fe.setAttributes&&(he.width=((J=fe.dimensions)==null?void 0:J.width)??he.width,he.height=((se=fe.dimensions)==null?void 0:se.height)??he.height),he.measured=de;break}case"position":he.position=fe.position??he.position;break}}o.nodes.update(fe=>fe),Ye(o.nodesInitialized)||o.nodesInitialized.set(!0)}}function f(P){const B=Ye(o.panZoom);if(!B)return Promise.resolve(!1);const Z=gS(Ye(o.nodeLookup),P);return mS({nodes:Z,width:Ye(o.width),height:Ye(o.height),minZoom:Ye(o.minZoom),maxZoom:Ye(o.maxZoom),panZoom:B},P)}function g(P){const B=Ye(o.panZoom);if(!B)return!1;const Z=gS(Ye(o.nodeLookup),P);return mS({nodes:Z,width:Ye(o.width),height:Ye(o.height),minZoom:Ye(o.minZoom),maxZoom:Ye(o.maxZoom),panZoom:B},P),Z.size>0}function m(P,B){const Z=Ye(o.panZoom);return Z?Z.scaleBy(P,B):Promise.resolve(!1)}function b(P){return m(1.2,P)}function p(P){return m(1/1.2,P)}function y(P){const B=Ye(o.panZoom);B&&(B.setScaleExtent([P,Ye(o.maxZoom)]),o.minZoom.set(P))}function w(P){const B=Ye(o.panZoom);B&&(B.setScaleExtent([Ye(o.minZoom),P]),o.maxZoom.set(P))}function _(P){const B=Ye(o.panZoom);B&&(B.setTranslateExtent(P),o.translateExtent.set(P))}function v(P){let B=!1;return P.forEach(Z=>{Z.selected&&(Z.selected=!1,B=!0)}),B}function C(P){var B;(B=Ye(o.panZoom))==null||B.setClickDistance(P)}function k(P){v((P==null?void 0:P.nodes)||Ye(o.nodes))&&o.nodes.set(Ye(o.nodes)),v((P==null?void 0:P.edges)||Ye(o.edges))&&o.edges.set(Ye(o.edges))}o.deleteKeyPressed.subscribe(async P=>{var B;if(P){const Z=Ye(o.nodes),G=Ye(o.edges),Y=Z.filter(he=>he.selected),J=G.filter(he=>he.selected),{nodes:se,edges:fe}=await PO({nodesToRemove:Y,edgesToRemove:J,nodes:Z,edges:G,onBeforeDelete:Ye(o.onbeforedelete)});(se.length||fe.length)&&(o.nodes.update(he=>he.filter(de=>!se.some(ge=>ge.id===de.id))),o.edges.update(he=>he.filter(de=>!fe.some(ge=>ge.id===de.id))),(B=Ye(o.ondelete))==null||B({nodes:se,edges:fe}))}});function I(P){const B=Ye(o.multiselectionKeyPressed);o.nodes.update(Z=>Z.map(G=>{const Y=P.includes(G.id),J=B&&G.selected||Y;return G.selected=J,G})),B||o.edges.update(Z=>Z.map(G=>(G.selected=!1,G)))}function E(P){const B=Ye(o.multiselectionKeyPressed);o.edges.update(Z=>Z.map(G=>{const Y=P.includes(G.id),J=B&&G.selected||Y;return G.selected=J,G})),B||o.nodes.update(Z=>Z.map(G=>(G.selected=!1,G)))}function T(P){var Z;const B=(Z=Ye(o.nodes))==null?void 0:Z.find(G=>G.id===P);if(!B){console.warn("012",Mx.error012(P));return}o.selectionRect.set(null),o.selectionRectMode.set(null),B.selected?B.selected&&Ye(o.multiselectionKeyPressed)&&k({nodes:[B],edges:[]}):I([P])}function M(P){const B=Ye(o.viewport);return Gne({delta:P,panZoom:Ye(o.panZoom),transform:[B.x,B.y,B.zoom],translateExtent:Ye(o.translateExtent),width:Ye(o.width),height:Ye(o.height)})}const D=nn(t4),H=P=>{D.set({...P})};function R(){D.set(t4)}function z(){o.fitViewOnInitDone.set(!1),o.selectionRect.set(null),o.selectionRectMode.set(null),o.snapGrid.set(null),o.isValidConnection.set(()=>!0),k(),R()}return{...o,visibleEdges:Xie(o),visibleNodes:Yie(o),connection:t1([D,o.viewport],([P,B])=>P.inProgress?{...P,to:Px(P.to,[B.x,B.y,B.zoom])}:{...P}),markers:t1([o.edges,o.defaultMarkerColor,o.flowId],([P,B,Z])=>Lne(P,{defaultColor:B,id:Z})),initialized:(()=>{let P=!1;const B=Ye(o.nodes).length,Z=Ye(o.edges).length;return t1([o.nodesInitialized,o.edgesInitialized,o.viewportInitialized],([G,Y,J])=>P||(B===0?P=J:Z===0?P=J&&G:P=J&&G&&Y,P))})(),syncNodeStores:P=>jie(o.nodes,P),syncEdgeStores:P=>Gie(o.edges,P),syncViewport:P=>Vie(o.panZoom,o.viewport,P),setNodeTypes:l,setEdgeTypes:c,addEdge:h,updateNodePositions:u,updateNodeInternals:d,zoomIn:b,zoomOut:p,fitView:P=>f(P),setMinZoom:y,setMaxZoom:w,setTranslateExtent:_,setPaneClickDistance:C,unselectNodesAndEdges:k,addSelectedNodes:I,addSelectedEdges:E,handleNodeSelection:T,panBy:M,updateConnection:H,cancelConnection:R,reset:z}}function rs(){const n=hs(jy);if(!n)throw new Error("In order to use useStore you need to wrap your component in a <SvelteFlowProvider />");return n.getStore()}function Jie({nodes:n,edges:e,width:t,height:i,fitView:s,nodeOrigin:r,nodeExtent:a}){const o=rD({nodes:n,edges:e,width:t,height:i,fitView:s,nodeOrigin:r,nodeExtent:a});return Dp(jy,{getStore:()=>o}),o}function Zie(n,e){const{panZoom:t,minZoom:i,maxZoom:s,initialViewport:r,viewport:a,dragging:o,translateExtent:l,paneClickDistance:c}=e,h=rie({domNode:n,minZoom:i,maxZoom:s,translateExtent:l,viewport:r,paneClickDistance:c,onDraggingChange:o.set}),u=h.getViewport();return a.set(u),t.set(h),h.update(e),{update(d){h.update(d)}}}function Qie(n){let e,t,i,s,r;const a=n[35].default,o=Xs(a,n,n[34],null);return{c(){e=te("div"),o&&o.c(),this.h()},l(l){e=ne(l,"DIV",{class:!0});var c=V(e);o&&o.l(c),c.forEach(S),this.h()},h(){A(e,"class","svelte-flow__zoom svelte-4xkw84")},m(l,c){ee(l,e,c),o&&o.m(e,null),i=!0,s||(r=ua(t=Zie.call(null,e,{viewport:n[18],minZoom:n[12],maxZoom:n[13],initialViewport:n[11],dragging:n[23],panZoom:n[19],onPanZoomStart:n[0],onPanZoom:n[1],onPanZoomEnd:n[2],zoomOnScroll:n[5],zoomOnDoubleClick:n[6],zoomOnPinch:n[7],panOnScroll:n[9],panOnDrag:n[10],panOnScrollSpeed:.5,panOnScrollMode:n[3]||lc.Free,zoomActivationKeyPressed:n[14],preventScrolling:typeof n[4]=="boolean"?n[4]:!0,noPanClassName:"nopan",noWheelClassName:"nowheel",userSelectionActive:!!n[15],translateExtent:n[16],lib:n[17],paneClickDistance:n[8],onTransformChange:n[29]})),s=!0)},p(l,c){o&&o.p&&(!i||c[1]&8)&&Ys(o,a,l,l[34],i?Zs(a,l[34],c,null):Js(l[34]),null),t&&js(t.update)&&c[0]&262143&&t.update.call(null,{viewport:l[18],minZoom:l[12],maxZoom:l[13],initialViewport:l[11],dragging:l[23],panZoom:l[19],onPanZoomStart:l[0],onPanZoom:l[1],onPanZoomEnd:l[2],zoomOnScroll:l[5],zoomOnDoubleClick:l[6],zoomOnPinch:l[7],panOnScroll:l[9],panOnDrag:l[10],panOnScrollSpeed:.5,panOnScrollMode:l[3]||lc.Free,zoomActivationKeyPressed:l[14],preventScrolling:typeof l[4]=="boolean"?l[4]:!0,noPanClassName:"nopan",noWheelClassName:"nowheel",userSelectionActive:!!l[15],translateExtent:l[16],lib:l[17],paneClickDistance:l[8],onTransformChange:l[29]})},i(l){i||(L(o,l),i=!0)},o(l){j(o,l),i=!1},d(l){l&&S(e),o&&o.d(l),s=!1,r()}}}function $ie(n,e,t){let i,s,r,a,o,l,c,h,u,d,f,{$$slots:g={},$$scope:m}=e,{initialViewport:b=void 0}=e,{onMoveStart:p=void 0}=e,{onMove:y=void 0}=e,{onMoveEnd:w=void 0}=e,{panOnScrollMode:_}=e,{preventScrolling:v}=e,{zoomOnScroll:C}=e,{zoomOnDoubleClick:k}=e,{zoomOnPinch:I}=e,{panOnDrag:E}=e,{panOnScroll:T}=e,{paneClickDistance:M}=e;const{viewport:D,panZoom:H,selectionRect:R,minZoom:z,maxZoom:P,dragging:B,translateExtent:Z,lib:G,panActivationKeyPressed:Y,zoomActivationKeyPressed:J,viewportInitialized:se}=rs();Pe(n,R,he=>t(15,u=he)),Pe(n,z,he=>t(12,l=he)),Pe(n,P,he=>t(13,c=he)),Pe(n,Z,he=>t(16,d=he)),Pe(n,G,he=>t(17,f=he)),Pe(n,Y,he=>t(33,o=he)),Pe(n,J,he=>t(14,h=he)),Pe(n,se,he=>t(36,a=he));const fe=he=>D.set({x:he[0],y:he[1],zoom:he[2]});return fl(()=>{x3(se,a=!0,a)}),n.$$set=he=>{"initialViewport"in he&&t(30,b=he.initialViewport),"onMoveStart"in he&&t(0,p=he.onMoveStart),"onMove"in he&&t(1,y=he.onMove),"onMoveEnd"in he&&t(2,w=he.onMoveEnd),"panOnScrollMode"in he&&t(3,_=he.panOnScrollMode),"preventScrolling"in he&&t(4,v=he.preventScrolling),"zoomOnScroll"in he&&t(5,C=he.zoomOnScroll),"zoomOnDoubleClick"in he&&t(6,k=he.zoomOnDoubleClick),"zoomOnPinch"in he&&t(7,I=he.zoomOnPinch),"panOnDrag"in he&&t(31,E=he.panOnDrag),"panOnScroll"in he&&t(32,T=he.panOnScroll),"paneClickDistance"in he&&t(8,M=he.paneClickDistance),"$$scope"in he&&t(34,m=he.$$scope)},n.$$.update=()=>{n.$$.dirty[0]&1073741824&&t(11,i=b||{x:0,y:0,zoom:1}),n.$$.dirty[1]&5&&t(10,s=o||E),n.$$.dirty[1]&6&&t(9,r=o||T)},[p,y,w,_,v,C,k,I,M,r,s,i,l,c,h,u,d,f,D,H,R,z,P,B,Z,G,Y,J,se,fe,b,E,T,o,m,g]}class ese extends Nt{constructor(e){super(),Ot(this,e,$ie,Qie,Ft,{initialViewport:30,onMoveStart:0,onMove:1,onMoveEnd:2,panOnScrollMode:3,preventScrolling:4,zoomOnScroll:5,zoomOnDoubleClick:6,zoomOnPinch:7,panOnDrag:31,panOnScroll:32,paneClickDistance:8},null,[-1,-1])}}function tse(n){let e,t,i,s;const r=n[28].default,a=Xs(r,n,n[27],null);return{c(){e=te("div"),a&&a.c(),this.h()},l(o){e=ne(o,"DIV",{class:!0});var l=V(e);a&&a.l(l),l.forEach(S),this.h()},h(){A(e,"class","svelte-flow__pane svelte-1esy7hx"),bn(e,"draggable",n[0]===!0||Array.isArray(n[0])&&n[0].includes(0)),bn(e,"dragging",n[4]),bn(e,"selection",n[1])},m(o,l){ee(o,e,l),a&&a.m(e,null),n[29](e),t=!0,i||(s=[pt(e,"click",function(){js(n[3]?void 0:k9(n[15],n[2]))&&(n[3]?void 0:k9(n[15],n[2])).apply(this,arguments)}),pt(e,"pointerdown",function(){js(n[3]?n[16]:void 0)&&(n[3]?n[16]:void 0).apply(this,arguments)}),pt(e,"pointermove",function(){js(n[3]?n[17]:void 0)&&(n[3]?n[17]:void 0).apply(this,arguments)}),pt(e,"pointerup",function(){js(n[3]?n[18]:void 0)&&(n[3]?n[18]:void 0).apply(this,arguments)}),pt(e,"contextmenu",function(){js(k9(n[19],n[2]))&&k9(n[19],n[2]).apply(this,arguments)})],i=!0)},p(o,l){n=o,a&&a.p&&(!t||l[0]&134217728)&&Ys(a,r,n,n[27],t?Zs(r,n[27],l,null):Js(n[27]),null),(!t||l[0]&1)&&bn(e,"draggable",n[0]===!0||Array.isArray(n[0])&&n[0].includes(0)),(!t||l[0]&16)&&bn(e,"dragging",n[4]),(!t||l[0]&2)&&bn(e,"selection",n[1])},i(o){t||(L(a,o),t=!0)},o(o){j(a,o),t=!1},d(o){o&&S(e),a&&a.d(o),n[29](null),i=!1,ia(s)}}}function k9(n,e){return t=>{t.target===e&&(n==null||n(t))}}function RS(n){return e=>{const t=n.includes(e.id);return e.selected!==t&&(e.selected=t),e}}function nse(n,e,t){let i,s,r,a,o,l,c,h,u,d,f,g,m,{$$slots:b={},$$scope:p}=e,{panOnDrag:y=void 0}=e,{selectionOnDrag:w=void 0}=e;const _=eo(),{nodes:v,nodeLookup:C,edges:k,viewport:I,dragging:E,elementsSelectable:T,selectionRect:M,selectionRectMode:D,selectionKeyPressed:H,selectionMode:R,panActivationKeyPressed:z,unselectNodesAndEdges:P}=rs();Pe(n,C,N=>t(36,u=N)),Pe(n,k,N=>t(33,l=N)),Pe(n,I,N=>t(35,h=N)),Pe(n,E,N=>t(4,m=N)),Pe(n,T,N=>t(25,f=N)),Pe(n,M,N=>t(24,d=N)),Pe(n,D,N=>t(23,o=N)),Pe(n,H,N=>t(22,a=N)),Pe(n,R,N=>t(34,c=N)),Pe(n,z,N=>t(26,g=N));let B,Z=null,G=[],Y=!1;function J(N){if(Y){Y=!1;return}_("paneclick",{event:N}),P(),D.set(null)}function se(N){var W,le;if(Z=B.getBoundingClientRect(),!T||!s||N.button!==0||N.target!==B||!Z)return;(le=(W=N.target)==null?void 0:W.setPointerCapture)==null||le.call(W,N.pointerId);const{x:K,y:oe}=x0(N,Z);P(),M.set({width:0,height:0,startX:K,startY:oe,x:K,y:oe})}function fe(N){if(!s||!Z||!d)return;Y=!0;const K=x0(N,Z),oe=d.startX??0,W=d.startY??0,le={...d,x:K.x<oe?K.x:oe,y:K.y<W?K.y:W,width:Math.abs(K.x-oe),height:Math.abs(K.y-W)},ce=G.map(qe=>qe.id),Ce=n4(G,l).map(qe=>qe.id);G=MO(u,le,[h.x,h.y,h.zoom],c===d5.Partial,!0);const X=n4(G,l).map(qe=>qe.id),Ke=G.map(qe=>qe.id);(ce.length!==Ke.length||Ke.some(qe=>!ce.includes(qe)))&&v.update(qe=>qe.map(RS(Ke))),(Ce.length!==X.length||X.some(qe=>!Ce.includes(qe)))&&k.update(qe=>qe.map(RS(X))),D.set("user"),M.set(le)}function he(N){var K,oe;N.button===0&&((oe=(K=N.target)==null?void 0:K.releasePointerCapture)==null||oe.call(K,N.pointerId),!s&&o==="user"&&N.target===B&&(J==null||J(N)),M.set(null),G.length>0&&x3(D,o="nodes",o),a&&(Y=!1))}const de=N=>{if(Array.isArray(i)&&(i!=null&&i.includes(2))){N.preventDefault();return}_("panecontextmenu",{event:N})};function ge(N){At[N?"unshift":"push"](()=>{B=N,t(2,B)})}return n.$$set=N=>{"panOnDrag"in N&&t(0,y=N.panOnDrag),"selectionOnDrag"in N&&t(20,w=N.selectionOnDrag),"$$scope"in N&&t(27,p=N.$$scope)},n.$$.update=()=>{n.$$.dirty[0]&67108865&&t(21,i=g||y),n.$$.dirty[0]&24117248&&t(1,s=a||d||w&&i!==!0),n.$$.dirty[0]&41943042&&t(3,r=f&&(s||o==="user"))},[y,s,B,r,m,C,k,I,E,T,M,D,H,R,z,J,se,fe,he,de,w,i,a,o,d,f,g,p,b,ge]}class ise extends Nt{constructor(e){super(),Ot(this,e,nse,tse,Ft,{panOnDrag:0,selectionOnDrag:20},null,[-1,-1])}}function sse(n){let e,t;const i=n[3].default,s=Xs(i,n,n[2],null);return{c(){e=te("div"),s&&s.c(),this.h()},l(r){e=ne(r,"DIV",{class:!0,style:!0});var a=V(e);s&&s.l(a),a.forEach(S),this.h()},h(){A(e,"class","svelte-flow__viewport xyflow__viewport svelte-1floaup"),rn(e,"transform","translate("+n[0].x+"px, "+n[0].y+"px) scale("+n[0].zoom+")")},m(r,a){ee(r,e,a),s&&s.m(e,null),t=!0},p(r,[a]){s&&s.p&&(!t||a&4)&&Ys(s,i,r,r[2],t?Zs(i,r[2],a,null):Js(r[2]),null),(!t||a&1)&&rn(e,"transform","translate("+r[0].x+"px, "+r[0].y+"px) scale("+r[0].zoom+")")},i(r){t||(L(s,r),t=!0)},o(r){j(s,r),t=!1},d(r){r&&S(e),s&&s.d(r)}}}function rse(n,e,t){let i,{$$slots:s={},$$scope:r}=e;const{viewport:a}=rs();return Pe(n,a,o=>t(0,i=o)),n.$$set=o=>{"$$scope"in o&&t(2,r=o.$$scope)},[i,a,r,s]}class ase extends Nt{constructor(e){super(),Ot(this,e,rse,sse,Ft,{})}}function aD(n,e){const{store:t,onDrag:i,onDragStart:s,onDragStop:r,onNodeMouseDown:a}=e,o=qne({onDrag:i,onDragStart:s,onDragStop:r,onNodeMouseDown:a,getStoreItems:()=>{const c=Ye(t.snapGrid),h=Ye(t.viewport);return{nodes:Ye(t.nodes),nodeLookup:Ye(t.nodeLookup),edges:Ye(t.edges),nodeExtent:Ye(t.nodeExtent),snapGrid:c||[0,0],snapToGrid:!!c,nodeOrigin:Ye(t.nodeOrigin),multiSelectionActive:Ye(t.multiselectionKeyPressed),domNode:Ye(t.domNode),transform:[h.x,h.y,h.zoom],autoPanOnNodeDrag:Ye(t.autoPanOnNodeDrag),nodesDraggable:Ye(t.nodesDraggable),selectNodesOnDrag:Ye(t.selectNodesOnDrag),nodeDragThreshold:Ye(t.nodeDragThreshold),unselectNodesAndEdges:t.unselectNodesAndEdges,updateNodePositions:t.updateNodePositions,panBy:t.panBy}}});function l(c,h){if(h.disabled){o.destroy();return}o.update({domNode:c,noDragClassName:h.noDragClass,handleSelector:h.handleSelector,nodeId:h.nodeId,isSelectable:h.isSelectable,nodeClickDistance:h.nodeClickDistance})}return l(n,e),{update(c){l(n,c)},destroy(){o.destroy()}}}function ose({width:n,height:e,initialWidth:t,initialHeight:i,measuredWidth:s,measuredHeight:r}){if(s===void 0&&r===void 0){const a=n??t,o=e??i;return{width:a?`width:${a}px;`:"",height:o?`height:${o}px;`:""}}return{width:n?`width:${n}px;`:"",height:e?`height:${e}px;`:""}}function MS(n){let e,t,i,s,r,a=`translate(${n[12]}px, ${n[13]}px)`,o,l,c;var h=n[27];function u(d,f){return{props:{data:d[2],id:d[1],selected:d[3],selectable:d[5],deletable:d[7],sourcePosition:d[14],targetPosition:d[15],zIndex:d[16],dragging:d[9],draggable:d[4],dragHandle:d[19],parentId:d[21],type:d[25],isConnectable:d[28],positionAbsoluteX:d[12],positionAbsoluteY:d[13],width:d[17],height:d[18]}}}return h&&(t=y3(h,u(n))),{c(){e=te("div"),t&&pe(t.$$.fragment),this.h()},l(d){e=ne(d,"DIV",{"data-id":!0,class:!0,style:!0});var f=V(e);t&&ye(t.$$.fragment,f),f.forEach(S),this.h()},h(){A(e,"data-id",n[1]),A(e,"class",i=Ri(["svelte-flow__node",`svelte-flow__node-${n[25]}`,n[23]])),A(e,"style",s=(n[10]??"")+";"+n[26].width+n[26].height),bn(e,"dragging",n[9]),bn(e,"selected",n[3]),bn(e,"draggable",n[4]),bn(e,"connectable",n[6]),bn(e,"selectable",n[5]),bn(e,"nopan",n[4]),bn(e,"parent",n[11]),rn(e,"z-index",n[16]),rn(e,"transform",a),rn(e,"visibility",n[20]?"visible":"hidden")},m(d,f){ee(d,e,f),t&&be(t,e,null),n[50](e),o=!0,l||(c=[ua(r=aD.call(null,e,{nodeId:n[1],isSelectable:n[5],disabled:!1,handleSelector:n[19],noDragClass:"nodrag",nodeClickDistance:n[22],onNodeMouseDown:n[31],onDrag:n[47],onDragStart:n[48],onDragStop:n[49],store:n[29]})),pt(e,"click",n[34]),pt(e,"mouseenter",n[51]),pt(e,"mouseleave",n[52]),pt(e,"mousemove",n[53]),pt(e,"contextmenu",n[54])],l=!0)},p(d,f){if(f[0]&134217728&&h!==(h=d[27])){if(t){ot();const m=t;j(m.$$.fragment,1,0,()=>{xe(m,1)}),lt()}h?(t=y3(h,u(d)),pe(t.$$.fragment),L(t.$$.fragment,1),be(t,e,null)):t=null}else if(h){const m={};f[0]&4&&(m.data=d[2]),f[0]&2&&(m.id=d[1]),f[0]&8&&(m.selected=d[3]),f[0]&32&&(m.selectable=d[5]),f[0]&128&&(m.deletable=d[7]),f[0]&16384&&(m.sourcePosition=d[14]),f[0]&32768&&(m.targetPosition=d[15]),f[0]&65536&&(m.zIndex=d[16]),f[0]&512&&(m.dragging=d[9]),f[0]&16&&(m.draggable=d[4]),f[0]&524288&&(m.dragHandle=d[19]),f[0]&2097152&&(m.parentId=d[21]),f[0]&33554432&&(m.type=d[25]),f[0]&268435456&&(m.isConnectable=d[28]),f[0]&4096&&(m.positionAbsoluteX=d[12]),f[0]&8192&&(m.positionAbsoluteY=d[13]),f[0]&131072&&(m.width=d[17]),f[0]&262144&&(m.height=d[18]),t.$set(m)}(!o||f[0]&2)&&A(e,"data-id",d[1]),(!o||f[0]&41943040&&i!==(i=Ri(["svelte-flow__node",`svelte-flow__node-${d[25]}`,d[23]])))&&A(e,"class",i),(!o||f[0]&67109888&&s!==(s=(d[10]??"")+";"+d[26].width+d[26].height))&&A(e,"style",s),r&&js(r.update)&&f[0]&4718626&&r.update.call(null,{nodeId:d[1],isSelectable:d[5],disabled:!1,handleSelector:d[19],noDragClass:"nodrag",nodeClickDistance:d[22],onNodeMouseDown:d[31],onDrag:d[47],onDragStart:d[48],onDragStop:d[49],store:d[29]}),(!o||f[0]&41943552)&&bn(e,"dragging",d[9]),(!o||f[0]&41943048)&&bn(e,"selected",d[3]),(!o||f[0]&41943056)&&bn(e,"draggable",d[4]),(!o||f[0]&41943104)&&bn(e,"connectable",d[6]),(!o||f[0]&41943072)&&bn(e,"selectable",d[5]),(!o||f[0]&41943056)&&bn(e,"nopan",d[4]),(!o||f[0]&41945088)&&bn(e,"parent",d[11]);const g=f[0]&67109888;(f[0]&67175424||g)&&rn(e,"z-index",d[16]),(f[0]&67122176&&a!==(a=`translate(${d[12]}px, ${d[13]}px)`)||g)&&rn(e,"transform",a),(f[0]&68158464||g)&&rn(e,"visibility",d[20]?"visible":"hidden")},i(d){o||(t&&L(t.$$.fragment,d),o=!0)},o(d){t&&j(t.$$.fragment,d),o=!1},d(d){d&&S(e),t&&xe(t),n[50](null),l=!1,ia(c)}}}function lse(n){let e,t,i=!n[8]&&MS(n);return{c(){i&&i.c(),e=Ut()},l(s){i&&i.l(s),e=Ut()},m(s,r){i&&i.m(s,r),ee(s,e,r),t=!0},p(s,r){s[8]?i&&(ot(),j(i,1,1,()=>{i=null}),lt()):i?(i.p(s,r),r[0]&256&&L(i,1)):(i=MS(s),i.c(),L(i,1),i.m(e.parentNode,e))},i(s){t||(L(i),t=!0)},o(s){j(i),t=!1},d(s){s&&S(e),i&&i.d(s)}}}function cse(n,e,t){let i,s,r,a,o,l,{node:c}=e,{id:h}=e,{data:u={}}=e,{selected:d=!1}=e,{draggable:f=void 0}=e,{selectable:g=void 0}=e,{connectable:m=!0}=e,{deletable:b=!0}=e,{hidden:p=!1}=e,{dragging:y=!1}=e,{resizeObserver:w=null}=e,{style:_=void 0}=e,{type:v="default"}=e,{isParent:C=!1}=e,{positionX:k}=e,{positionY:I}=e,{sourcePosition:E=void 0}=e,{targetPosition:T=void 0}=e,{zIndex:M}=e,{measuredWidth:D=void 0}=e,{measuredHeight:H=void 0}=e,{initialWidth:R=void 0}=e,{initialHeight:z=void 0}=e,{width:P=void 0}=e,{height:B=void 0}=e,{dragHandle:Z=void 0}=e,{initialized:G=!1}=e,{parentId:Y=void 0}=e,{nodeClickDistance:J=void 0}=e,{class:se=""}=e;const fe=rs(),{nodeTypes:he,nodeDragThreshold:de,selectNodesOnDrag:ge,handleNodeSelection:N,updateNodeInternals:K}=fe;Pe(n,he,me=>t(46,o=me));let oe,W=null;const le=eo(),ce=nn(m);Pe(n,ce,me=>t(28,l=me));let Ce,X,Ke;Dp("svelteflow__node_id",h),Dp("svelteflow__node_connectable",ce),$h(()=>{W&&(w==null||w.unobserve(W))});function qe(me){g&&(!Ye(ge)||!f||Ye(de)>0)&&N(h),le("nodeclick",{node:c.internals.userNode,event:me})}const He=(me,Rt,ct,at)=>{le("nodedrag",{event:me,targetNode:ct,nodes:at})},Me=(me,Rt,ct,at)=>{le("nodedragstart",{event:me,targetNode:ct,nodes:at})},Ne=(me,Rt,ct,at)=>{le("nodedragstop",{event:me,targetNode:ct,nodes:at})};function Qe(me){At[me?"unshift":"push"](()=>{oe=me,t(24,oe)})}const gt=me=>le("nodemouseenter",{node:c,event:me}),mt=me=>le("nodemouseleave",{node:c,event:me}),Xe=me=>le("nodemousemove",{node:c,event:me}),rt=me=>le("nodecontextmenu",{node:c,event:me});return n.$$set=me=>{"node"in me&&t(0,c=me.node),"id"in me&&t(1,h=me.id),"data"in me&&t(2,u=me.data),"selected"in me&&t(3,d=me.selected),"draggable"in me&&t(4,f=me.draggable),"selectable"in me&&t(5,g=me.selectable),"connectable"in me&&t(6,m=me.connectable),"deletable"in me&&t(7,b=me.deletable),"hidden"in me&&t(8,p=me.hidden),"dragging"in me&&t(9,y=me.dragging),"resizeObserver"in me&&t(35,w=me.resizeObserver),"style"in me&&t(10,_=me.style),"type"in me&&t(36,v=me.type),"isParent"in me&&t(11,C=me.isParent),"positionX"in me&&t(12,k=me.positionX),"positionY"in me&&t(13,I=me.positionY),"sourcePosition"in me&&t(14,E=me.sourcePosition),"targetPosition"in me&&t(15,T=me.targetPosition),"zIndex"in me&&t(16,M=me.zIndex),"measuredWidth"in me&&t(37,D=me.measuredWidth),"measuredHeight"in me&&t(38,H=me.measuredHeight),"initialWidth"in me&&t(39,R=me.initialWidth),"initialHeight"in me&&t(40,z=me.initialHeight),"width"in me&&t(17,P=me.width),"height"in me&&t(18,B=me.height),"dragHandle"in me&&t(19,Z=me.dragHandle),"initialized"in me&&t(20,G=me.initialized),"parentId"in me&&t(21,Y=me.parentId),"nodeClickDistance"in me&&t(22,J=me.nodeClickDistance),"class"in me&&t(23,se=me.class)},n.$$.update=()=>{n.$$.dirty[1]&32&&t(25,i=v||"default"),n.$$.dirty[0]&33554432|n.$$.dirty[1]&32768&&t(45,s=!!o[i]),n.$$.dirty[0]&33554432|n.$$.dirty[1]&32768&&t(27,r=o[i]||eD),n.$$.dirty[1]&16416&&(s||console.warn("003",Mx.error003(v))),n.$$.dirty[0]&393216|n.$$.dirty[1]&960&&t(26,a=ose({width:P,height:B,initialWidth:R,initialHeight:z,measuredWidth:D,measuredHeight:H})),n.$$.dirty[0]&64&&ce.set(!!m),n.$$.dirty[0]&50380802|n.$$.dirty[1]&14336&&((Ce&&i!==Ce||X&&E!==X||Ke&&T!==Ke)&&requestAnimationFrame(()=>K(new Map([[h,{id:h,nodeElement:oe,force:!0}]]))),t(42,Ce=i),t(43,X=E),t(44,Ke=T)),n.$$.dirty[0]&17825792|n.$$.dirty[1]&1040&&w&&(oe!==W||!G)&&(W&&w.unobserve(W),oe&&w.observe(oe),t(41,W=oe))},[c,h,u,d,f,g,m,b,p,y,_,C,k,I,E,T,M,P,B,Z,G,Y,J,se,oe,i,a,r,l,fe,he,N,le,ce,qe,w,v,D,H,R,z,W,Ce,X,Ke,s,o,He,Me,Ne,Qe,gt,mt,Xe,rt]}class hse extends Nt{constructor(e){super(),Ot(this,e,cse,lse,zI,{node:0,id:1,data:2,selected:3,draggable:4,selectable:5,connectable:6,deletable:7,hidden:8,dragging:9,resizeObserver:35,style:10,type:36,isParent:11,positionX:12,positionY:13,sourcePosition:14,targetPosition:15,zIndex:16,measuredWidth:37,measuredHeight:38,initialWidth:39,initialHeight:40,width:17,height:18,dragHandle:19,initialized:20,parentId:21,nodeClickDistance:22,class:23},null,[-1,-1])}}const{Map:use}=jI;function PS(n,e,t){const i=n.slice();return i[21]=e[t],i}function NS(n,e){let t,i,s;return i=new hse({props:{node:e[21],id:e[21].id,data:e[21].data,selected:!!e[21].selected,hidden:!!e[21].hidden,draggable:!!(e[21].draggable||e[2]&&typeof e[21].draggable>"u"),selectable:!!(e[21].selectable||e[3]&&typeof e[21].selectable>"u"),connectable:!!(e[21].connectable||e[4]&&typeof e[21].connectable>"u"),deletable:e[21].deletable??!0,positionX:e[21].internals.positionAbsolute.x,positionY:e[21].internals.positionAbsolute.y,isParent:e[5].has(e[21].id),style:e[21].style,class:e[21].class,type:e[21].type??"default",sourcePosition:e[21].sourcePosition,targetPosition:e[21].targetPosition,dragging:e[21].dragging,zIndex:e[21].internals.z??0,dragHandle:e[21].dragHandle,initialized:xS(e[21]),width:e[21].width,height:e[21].height,initialWidth:e[21].initialWidth,initialHeight:e[21].initialHeight,measuredWidth:e[21].measured.width,measuredHeight:e[21].measured.height,parentId:e[21].parentId,resizeObserver:e[11],nodeClickDistance:e[0]}}),i.$on("nodeclick",e[12]),i.$on("nodemouseenter",e[13]),i.$on("nodemousemove",e[14]),i.$on("nodemouseleave",e[15]),i.$on("nodedrag",e[16]),i.$on("nodedragstart",e[17]),i.$on("nodedragstop",e[18]),i.$on("nodecontextmenu",e[19]),{key:n,first:null,c(){t=Ut(),pe(i.$$.fragment),this.h()},l(r){t=Ut(),ye(i.$$.fragment,r),this.h()},h(){this.first=t},m(r,a){ee(r,t,a),be(i,r,a),s=!0},p(r,a){e=r;const o={};a&2&&(o.node=e[21]),a&2&&(o.id=e[21].id),a&2&&(o.data=e[21].data),a&2&&(o.selected=!!e[21].selected),a&2&&(o.hidden=!!e[21].hidden),a&6&&(o.draggable=!!(e[21].draggable||e[2]&&typeof e[21].draggable>"u")),a&10&&(o.selectable=!!(e[21].selectable||e[3]&&typeof e[21].selectable>"u")),a&18&&(o.connectable=!!(e[21].connectable||e[4]&&typeof e[21].connectable>"u")),a&2&&(o.deletable=e[21].deletable??!0),a&2&&(o.positionX=e[21].internals.positionAbsolute.x),a&2&&(o.positionY=e[21].internals.positionAbsolute.y),a&34&&(o.isParent=e[5].has(e[21].id)),a&2&&(o.style=e[21].style),a&2&&(o.class=e[21].class),a&2&&(o.type=e[21].type??"default"),a&2&&(o.sourcePosition=e[21].sourcePosition),a&2&&(o.targetPosition=e[21].targetPosition),a&2&&(o.dragging=e[21].dragging),a&2&&(o.zIndex=e[21].internals.z??0),a&2&&(o.dragHandle=e[21].dragHandle),a&2&&(o.initialized=xS(e[21])),a&2&&(o.width=e[21].width),a&2&&(o.height=e[21].height),a&2&&(o.initialWidth=e[21].initialWidth),a&2&&(o.initialHeight=e[21].initialHeight),a&2&&(o.measuredWidth=e[21].measured.width),a&2&&(o.measuredHeight=e[21].measured.height),a&2&&(o.parentId=e[21].parentId),a&1&&(o.nodeClickDistance=e[0]),i.$set(o)},i(r){s||(L(i.$$.fragment,r),s=!0)},o(r){j(i.$$.fragment,r),s=!1},d(r){r&&S(t),xe(i,r)}}}function dse(n){let e,t=[],i=new use,s,r=Qn(n[1]);const a=o=>o[21].id;for(let o=0;o<r.length;o+=1){let l=PS(n,r,o),c=a(l);i.set(c,t[o]=NS(c,l))}return{c(){e=te("div");for(let o=0;o<t.length;o+=1)t[o].c();this.h()},l(o){e=ne(o,"DIV",{class:!0});var l=V(e);for(let c=0;c<t.length;c+=1)t[c].l(l);l.forEach(S),this.h()},h(){A(e,"class","svelte-flow__nodes svelte-tf4uy4")},m(o,l){ee(o,e,l);for(let c=0;c<t.length;c+=1)t[c]&&t[c].m(e,null);s=!0},p(o,[l]){l&2111&&(r=Qn(o[1]),ot(),t=hx(t,l,a,1,o,r,i,e,Z5,NS,null,PS),lt())},i(o){if(!s){for(let l=0;l<r.length;l+=1)L(t[l]);s=!0}},o(o){for(let l=0;l<t.length;l+=1)j(t[l]);s=!1},d(o){o&&S(e);for(let l=0;l<t.length;l+=1)t[l].d()}}}function fse(n,e,t){let i,s,r,a,o,{nodeClickDistance:l=0}=e;const{visibleNodes:c,nodesDraggable:h,nodesConnectable:u,elementsSelectable:d,updateNodeInternals:f,parentLookup:g}=rs();Pe(n,c,I=>t(1,i=I)),Pe(n,h,I=>t(2,s=I)),Pe(n,u,I=>t(4,a=I)),Pe(n,d,I=>t(3,r=I)),Pe(n,g,I=>t(5,o=I));const m=typeof ResizeObserver>"u"?null:new ResizeObserver(I=>{const E=new Map;I.forEach(T=>{const M=T.target.getAttribute("data-id");E.set(M,{id:M,nodeElement:T.target,force:!0})}),f(E)});$h(()=>{m==null||m.disconnect()});function b(I){Yn.call(this,n,I)}function p(I){Yn.call(this,n,I)}function y(I){Yn.call(this,n,I)}function w(I){Yn.call(this,n,I)}function _(I){Yn.call(this,n,I)}function v(I){Yn.call(this,n,I)}function C(I){Yn.call(this,n,I)}function k(I){Yn.call(this,n,I)}return n.$$set=I=>{"nodeClickDistance"in I&&t(0,l=I.nodeClickDistance)},[l,i,s,r,a,o,c,h,u,d,g,m,b,p,y,w,_,v,C,k]}class gse extends Nt{constructor(e){super(),Ot(this,e,fse,dse,Ft,{nodeClickDistance:0})}}function OS(n){let e,t,i,s,r,a,o,l;var c=n[27];function h(u,d){return{props:{id:u[0],source:u[1],target:u[2],sourceX:u[14],sourceY:u[15],targetX:u[16],targetY:u[17],sourcePosition:u[18],targetPosition:u[19],animated:u[6],selected:u[7],label:u[10],labelStyle:u[11],data:u[3],style:u[4],interactionWidth:u[21],selectable:u[24],deletable:u[8]??!0,type:u[23],sourceHandleId:u[12],targetHandleId:u[13],markerStart:u[26],markerEnd:u[25]}}}return c&&(i=y3(c,h(n))),{c(){e=nt("svg"),t=nt("g"),i&&pe(i.$$.fragment),this.h()},l(u){e=it(u,"svg",{});var d=V(e);t=it(d,"g",{class:!0,"data-id":!0,"aria-label":!0,role:!0});var f=V(t);i&&ye(i.$$.fragment,f),f.forEach(S),d.forEach(S),this.h()},h(){A(t,"class",s=Ri(["svelte-flow__edge",n[22]])),A(t,"data-id",n[0]),A(t,"aria-label",r=n[20]===null?void 0:n[20]?n[20]:`Edge from ${n[1]} to ${n[2]}`),A(t,"role","img"),bn(t,"animated",n[6]),bn(t,"selected",n[7]),bn(t,"selectable",n[24]),rn(e,"z-index",n[5])},m(u,d){ee(u,e,d),q(e,t),i&&be(i,t,null),a=!0,o||(l=[pt(t,"click",n[32]),pt(t,"contextmenu",n[41]),pt(t,"mouseenter",n[42]),pt(t,"mouseleave",n[43])],o=!0)},p(u,d){if(d[0]&134217728&&c!==(c=u[27])){if(i){ot();const f=i;j(f.$$.fragment,1,0,()=>{xe(f,1)}),lt()}c?(i=y3(c,h(u)),pe(i.$$.fragment),L(i.$$.fragment,1),be(i,t,null)):i=null}else if(c){const f={};d[0]&1&&(f.id=u[0]),d[0]&2&&(f.source=u[1]),d[0]&4&&(f.target=u[2]),d[0]&16384&&(f.sourceX=u[14]),d[0]&32768&&(f.sourceY=u[15]),d[0]&65536&&(f.targetX=u[16]),d[0]&131072&&(f.targetY=u[17]),d[0]&262144&&(f.sourcePosition=u[18]),d[0]&524288&&(f.targetPosition=u[19]),d[0]&64&&(f.animated=u[6]),d[0]&128&&(f.selected=u[7]),d[0]&1024&&(f.label=u[10]),d[0]&2048&&(f.labelStyle=u[11]),d[0]&8&&(f.data=u[3]),d[0]&16&&(f.style=u[4]),d[0]&2097152&&(f.interactionWidth=u[21]),d[0]&16777216&&(f.selectable=u[24]),d[0]&256&&(f.deletable=u[8]??!0),d[0]&8388608&&(f.type=u[23]),d[0]&4096&&(f.sourceHandleId=u[12]),d[0]&8192&&(f.targetHandleId=u[13]),d[0]&67108864&&(f.markerStart=u[26]),d[0]&33554432&&(f.markerEnd=u[25]),i.$set(f)}(!a||d[0]&4194304&&s!==(s=Ri(["svelte-flow__edge",u[22]])))&&A(t,"class",s),(!a||d[0]&1)&&A(t,"data-id",u[0]),(!a||d[0]&1048582&&r!==(r=u[20]===null?void 0:u[20]?u[20]:`Edge from ${u[1]} to ${u[2]}`))&&A(t,"aria-label",r),(!a||d[0]&4194368)&&bn(t,"animated",u[6]),(!a||d[0]&4194432)&&bn(t,"selected",u[7]),(!a||d[0]&20971520)&&bn(t,"selectable",u[24]),d[0]&32&&rn(e,"z-index",u[5])},i(u){a||(i&&L(i.$$.fragment,u),a=!0)},o(u){i&&j(i.$$.fragment,u),a=!1},d(u){u&&S(e),i&&xe(i),o=!1,ia(l)}}}function mse(n){let e,t,i=!n[9]&&OS(n);return{c(){i&&i.c(),e=Ut()},l(s){i&&i.l(s),e=Ut()},m(s,r){i&&i.m(s,r),ee(s,e,r),t=!0},p(s,r){s[9]?i&&(ot(),j(i,1,1,()=>{i=null}),lt()):i?(i.p(s,r),r[0]&512&&L(i,1)):(i=OS(s),i.c(),L(i,1),i.m(e.parentNode,e))},i(s){t||(L(i),t=!0)},o(s){j(i),t=!1},d(s){s&&S(e),i&&i.d(s)}}}function pse(n,e,t){let i,s,r,a,o,l,c,h,u,{id:d}=e,{type:f="default"}=e,{source:g=""}=e,{target:m=""}=e,{data:b={}}=e,{style:p=void 0}=e,{zIndex:y=void 0}=e,{animated:w=!1}=e,{selected:_=!1}=e,{selectable:v=void 0}=e,{deletable:C=void 0}=e,{hidden:k=!1}=e,{label:I=void 0}=e,{labelStyle:E=void 0}=e,{markerStart:T=void 0}=e,{markerEnd:M=void 0}=e,{sourceHandle:D=void 0}=e,{targetHandle:H=void 0}=e,{sourceX:R}=e,{sourceY:z}=e,{targetX:P}=e,{targetY:B}=e,{sourcePosition:Z}=e,{targetPosition:G}=e,{ariaLabel:Y=void 0}=e,{interactionWidth:J=void 0}=e,{class:se=""}=e;Dp("svelteflow__edge_id",d);const{edgeLookup:fe,edgeTypes:he,flowId:de,elementsSelectable:ge}=rs();Pe(n,fe,X=>t(44,l=X)),Pe(n,he,X=>t(40,u=X)),Pe(n,de,X=>t(39,h=X)),Pe(n,ge,X=>t(38,c=X));const N=eo(),K=tD();function oe(X){const Ke=l.get(d);Ke&&(K(d),N("edgeclick",{event:X,edge:Ke}))}function W(X,Ke){const qe=l.get(d);qe&&N(Ke,{event:X,edge:qe})}const le=X=>{W(X,"edgecontextmenu")},ce=X=>{W(X,"edgemouseenter")},Ce=X=>{W(X,"edgemouseleave")};return n.$$set=X=>{"id"in X&&t(0,d=X.id),"type"in X&&t(34,f=X.type),"source"in X&&t(1,g=X.source),"target"in X&&t(2,m=X.target),"data"in X&&t(3,b=X.data),"style"in X&&t(4,p=X.style),"zIndex"in X&&t(5,y=X.zIndex),"animated"in X&&t(6,w=X.animated),"selected"in X&&t(7,_=X.selected),"selectable"in X&&t(35,v=X.selectable),"deletable"in X&&t(8,C=X.deletable),"hidden"in X&&t(9,k=X.hidden),"label"in X&&t(10,I=X.label),"labelStyle"in X&&t(11,E=X.labelStyle),"markerStart"in X&&t(36,T=X.markerStart),"markerEnd"in X&&t(37,M=X.markerEnd),"sourceHandle"in X&&t(12,D=X.sourceHandle),"targetHandle"in X&&t(13,H=X.targetHandle),"sourceX"in X&&t(14,R=X.sourceX),"sourceY"in X&&t(15,z=X.sourceY),"targetX"in X&&t(16,P=X.targetX),"targetY"in X&&t(17,B=X.targetY),"sourcePosition"in X&&t(18,Z=X.sourcePosition),"targetPosition"in X&&t(19,G=X.targetPosition),"ariaLabel"in X&&t(20,Y=X.ariaLabel),"interactionWidth"in X&&t(21,J=X.interactionWidth),"class"in X&&t(22,se=X.class)},n.$$.update=()=>{n.$$.dirty[1]&8&&t(23,i=f||"default"),n.$$.dirty[0]&8388608|n.$$.dirty[1]&512&&t(27,s=u[i]||nD),n.$$.dirty[1]&288&&t(26,r=T?`url('#${s4(T,h)}')`:void 0),n.$$.dirty[1]&320&&t(25,a=M?`url('#${s4(M,h)}')`:void 0),n.$$.dirty[1]&144&&t(24,o=v??c)},[d,g,m,b,p,y,w,_,C,k,I,E,D,H,R,z,P,B,Z,G,Y,J,se,i,o,a,r,s,fe,he,de,ge,oe,W,f,v,T,M,c,h,u,le,ce,Ce]}class bse extends Nt{constructor(e){super(),Ot(this,e,pse,mse,zI,{id:0,type:34,source:1,target:2,data:3,style:4,zIndex:5,animated:6,selected:7,selectable:35,deletable:8,hidden:9,label:10,labelStyle:11,markerStart:36,markerEnd:37,sourceHandle:12,targetHandle:13,sourceX:14,sourceY:15,targetX:16,targetY:17,sourcePosition:18,targetPosition:19,ariaLabel:20,interactionWidth:21,class:22},null,[-1,-1])}}function xse(n,e,t){let{onMount:i=void 0}=e,{onDestroy:s=void 0}=e;return fl(()=>(i==null||i(),s)),n.$$set=r=>{"onMount"in r&&t(0,i=r.onMount),"onDestroy"in r&&t(1,s=r.onDestroy)},[i,s]}class yse extends Nt{constructor(e){super(),Ot(this,e,xse,null,Ft,{onMount:0,onDestroy:1})}}function DS(n,e,t){const i=n.slice();return i[2]=e[t],i}function FS(n,e){let t,i,s;const r=[e[2]];let a={};for(let o=0;o<r.length;o+=1)a=li(a,r[o]);return i=new Ise({props:a}),{key:n,first:null,c(){t=Ut(),pe(i.$$.fragment),this.h()},l(o){t=Ut(),ye(i.$$.fragment,o),this.h()},h(){this.first=t},m(o,l){ee(o,t,l),be(i,o,l),s=!0},p(o,l){e=o;const c=l&1?Gh(r,[Fp(e[2])]):{};i.$set(c)},i(o){s||(L(i.$$.fragment,o),s=!0)},o(o){j(i.$$.fragment,o),s=!1},d(o){o&&S(t),xe(i,o)}}}function wse(n){let e,t=[],i=new Map,s,r=Qn(n[0]);const a=o=>o[2].id;for(let o=0;o<r.length;o+=1){let l=DS(n,r,o),c=a(l);i.set(c,t[o]=FS(c,l))}return{c(){e=nt("defs");for(let o=0;o<t.length;o+=1)t[o].c()},l(o){e=it(o,"defs",{});var l=V(e);for(let c=0;c<t.length;c+=1)t[c].l(l);l.forEach(S)},m(o,l){ee(o,e,l);for(let c=0;c<t.length;c+=1)t[c]&&t[c].m(e,null);s=!0},p(o,[l]){l&1&&(r=Qn(o[0]),ot(),t=hx(t,l,a,1,o,r,i,e,Z5,FS,null,DS),lt())},i(o){if(!s){for(let l=0;l<r.length;l+=1)L(t[l]);s=!0}},o(o){for(let l=0;l<t.length;l+=1)j(t[l]);s=!1},d(o){o&&S(e);for(let l=0;l<t.length;l+=1)t[l].d()}}}function _se(n,e,t){let i;const{markers:s}=rs();return Pe(n,s,r=>t(0,i=r)),[i,s]}class vse extends Nt{constructor(e){super(),Ot(this,e,_se,wse,Ft,{})}}function kse(n){let e;return{c(){e=nt("polyline"),this.h()},l(t){e=it(t,"polyline",{stroke:!0,"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,fill:!0,points:!0}),V(e).forEach(S),this.h()},h(){A(e,"stroke",n[6]),A(e,"stroke-linecap","round"),A(e,"stroke-linejoin","round"),A(e,"stroke-width",n[7]),A(e,"fill",n[6]),A(e,"points","-5,-4 0,0 -5,4 -5,-4")},m(t,i){ee(t,e,i)},p(t,i){i&64&&A(e,"stroke",t[6]),i&128&&A(e,"stroke-width",t[7]),i&64&&A(e,"fill",t[6])},d(t){t&&S(e)}}}function Cse(n){let e;return{c(){e=nt("polyline"),this.h()},l(t){e=it(t,"polyline",{stroke:!0,"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,fill:!0,points:!0}),V(e).forEach(S),this.h()},h(){A(e,"stroke",n[6]),A(e,"stroke-linecap","round"),A(e,"stroke-linejoin","round"),A(e,"stroke-width",n[7]),A(e,"fill","none"),A(e,"points","-5,-4 0,0 -5,4")},m(t,i){ee(t,e,i)},p(t,i){i&64&&A(e,"stroke",t[6]),i&128&&A(e,"stroke-width",t[7])},d(t){t&&S(e)}}}function Ase(n){let e,t,i;function s(o,l){if(o[1]===f5.Arrow)return Cse;if(o[1]===f5.ArrowClosed)return kse}let r=s(n),a=r&&r(n);return{c(){e=nt("marker"),a&&a.c(),this.h()},l(o){e=it(o,"marker",{class:!0,id:!0,markerWidth:!0,markerHeight:!0,viewBox:!0,markerUnits:!0,orient:!0,refX:!0,refY:!0});var l=V(e);a&&a.l(l),l.forEach(S),this.h()},h(){A(e,"class","svelte-flow__arrowhead"),A(e,"id",n[0]),A(e,"markerWidth",t=`${n[2]}`),A(e,"markerHeight",i=`${n[3]}`),A(e,"viewBox","-10 -10 20 20"),A(e,"markerUnits",n[4]),A(e,"orient",n[5]),A(e,"refX","0"),A(e,"refY","0")},m(o,l){ee(o,e,l),a&&a.m(e,null)},p(o,[l]){r===(r=s(o))&&a?a.p(o,l):(a&&a.d(1),a=r&&r(o),a&&(a.c(),a.m(e,null))),l&1&&A(e,"id",o[0]),l&4&&t!==(t=`${o[2]}`)&&A(e,"markerWidth",t),l&8&&i!==(i=`${o[3]}`)&&A(e,"markerHeight",i),l&16&&A(e,"markerUnits",o[4]),l&32&&A(e,"orient",o[5])},i:kt,o:kt,d(o){o&&S(e),a&&a.d()}}}function Sse(n,e,t){let{id:i}=e,{type:s}=e,{width:r=12.5}=e,{height:a=12.5}=e,{markerUnits:o="strokeWidth"}=e,{orient:l="auto-start-reverse"}=e,{color:c=void 0}=e,{strokeWidth:h=void 0}=e;return n.$$set=u=>{"id"in u&&t(0,i=u.id),"type"in u&&t(1,s=u.type),"width"in u&&t(2,r=u.width),"height"in u&&t(3,a=u.height),"markerUnits"in u&&t(4,o=u.markerUnits),"orient"in u&&t(5,l=u.orient),"color"in u&&t(6,c=u.color),"strokeWidth"in u&&t(7,h=u.strokeWidth)},[i,s,r,a,o,l,c,h]}class Ise extends Nt{constructor(e){super(),Ot(this,e,Sse,Ase,Ft,{id:0,type:1,width:2,height:3,markerUnits:4,orient:5,color:6,strokeWidth:7})}}function LS(n,e,t){const i=n.slice();return i[14]=e[t],i}function BS(n,e){let t,i,s;return i=new bse({props:{id:e[14].id,source:e[14].source,target:e[14].target,data:e[14].data,style:e[14].style,animated:e[14].animated,selected:e[14].selected,selectable:e[14].selectable??e[1],deletable:e[14].deletable,hidden:e[14].hidden,label:e[14].label,labelStyle:e[14].labelStyle,markerStart:e[14].markerStart,markerEnd:e[14].markerEnd,sourceHandle:e[14].sourceHandle,targetHandle:e[14].targetHandle,sourceX:e[14].sourceX,sourceY:e[14].sourceY,targetX:e[14].targetX,targetY:e[14].targetY,sourcePosition:e[14].sourcePosition,targetPosition:e[14].targetPosition,ariaLabel:e[14].ariaLabel,interactionWidth:e[14].interactionWidth,class:e[14].class,type:e[14].type||"default",zIndex:e[14].zIndex}}),i.$on("edgeclick",e[7]),i.$on("edgecontextmenu",e[8]),i.$on("edgemouseenter",e[9]),i.$on("edgemouseleave",e[10]),{key:n,first:null,c(){t=Ut(),pe(i.$$.fragment),this.h()},l(r){t=Ut(),ye(i.$$.fragment,r),this.h()},h(){this.first=t},m(r,a){ee(r,t,a),be(i,r,a),s=!0},p(r,a){e=r;const o={};a&1&&(o.id=e[14].id),a&1&&(o.source=e[14].source),a&1&&(o.target=e[14].target),a&1&&(o.data=e[14].data),a&1&&(o.style=e[14].style),a&1&&(o.animated=e[14].animated),a&1&&(o.selected=e[14].selected),a&3&&(o.selectable=e[14].selectable??e[1]),a&1&&(o.deletable=e[14].deletable),a&1&&(o.hidden=e[14].hidden),a&1&&(o.label=e[14].label),a&1&&(o.labelStyle=e[14].labelStyle),a&1&&(o.markerStart=e[14].markerStart),a&1&&(o.markerEnd=e[14].markerEnd),a&1&&(o.sourceHandle=e[14].sourceHandle),a&1&&(o.targetHandle=e[14].targetHandle),a&1&&(o.sourceX=e[14].sourceX),a&1&&(o.sourceY=e[14].sourceY),a&1&&(o.targetX=e[14].targetX),a&1&&(o.targetY=e[14].targetY),a&1&&(o.sourcePosition=e[14].sourcePosition),a&1&&(o.targetPosition=e[14].targetPosition),a&1&&(o.ariaLabel=e[14].ariaLabel),a&1&&(o.interactionWidth=e[14].interactionWidth),a&1&&(o.class=e[14].class),a&1&&(o.type=e[14].type||"default"),a&1&&(o.zIndex=e[14].zIndex),i.$set(o)},i(r){s||(L(i.$$.fragment,r),s=!0)},o(r){j(i.$$.fragment,r),s=!1},d(r){r&&S(t),xe(i,r)}}}function US(n){let e,t;return e=new yse({props:{onMount:n[11],onDestroy:n[12]}}),{c(){pe(e.$$.fragment)},l(i){ye(e.$$.fragment,i)},m(i,s){be(e,i,s),t=!0},p(i,s){const r={};s&4&&(r.onMount=i[11]),s&4&&(r.onDestroy=i[12]),e.$set(r)},i(i){t||(L(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){xe(e,i)}}}function Ese(n){let e,t,i,s,r=[],a=new Map,o,l;i=new vse({});let c=Qn(n[0]);const h=d=>d[14].id;for(let d=0;d<c.length;d+=1){let f=LS(n,c,d),g=h(f);a.set(g,r[d]=BS(g,f))}let u=n[0].length>0&&US(n);return{c(){e=te("div"),t=nt("svg"),pe(i.$$.fragment),s=Ae();for(let d=0;d<r.length;d+=1)r[d].c();o=Ae(),u&&u.c(),this.h()},l(d){e=ne(d,"DIV",{class:!0});var f=V(e);t=it(f,"svg",{class:!0});var g=V(t);ye(i.$$.fragment,g),g.forEach(S),s=Se(f);for(let m=0;m<r.length;m+=1)r[m].l(f);o=Se(f),u&&u.l(f),f.forEach(S),this.h()},h(){A(t,"class","svelte-flow__marker"),A(e,"class","svelte-flow__edges")},m(d,f){ee(d,e,f),q(e,t),be(i,t,null),q(e,s);for(let g=0;g<r.length;g+=1)r[g]&&r[g].m(e,null);q(e,o),u&&u.m(e,null),l=!0},p(d,[f]){f&3&&(c=Qn(d[0]),ot(),r=hx(r,f,h,1,d,c,a,e,Z5,BS,o,LS),lt()),d[0].length>0?u?(u.p(d,f),f&1&&L(u,1)):(u=US(d),u.c(),L(u,1),u.m(e,null)):u&&(ot(),j(u,1,1,()=>{u=null}),lt())},i(d){if(!l){L(i.$$.fragment,d);for(let f=0;f<c.length;f+=1)L(r[f]);L(u),l=!0}},o(d){j(i.$$.fragment,d);for(let f=0;f<r.length;f+=1)j(r[f]);j(u),l=!1},d(d){d&&S(e),xe(i);for(let f=0;f<r.length;f+=1)r[f].d();u&&u.d()}}}function Tse(n,e,t){let i,s,r,{defaultEdgeOptions:a}=e;const{visibleEdges:o,edgesInitialized:l,edges:{setDefaultOptions:c},elementsSelectable:h}=rs();Pe(n,o,p=>t(0,i=p)),Pe(n,l,p=>t(2,r=p)),Pe(n,h,p=>t(1,s=p)),fl(()=>{a&&c(a)});function u(p){Yn.call(this,n,p)}function d(p){Yn.call(this,n,p)}function f(p){Yn.call(this,n,p)}function g(p){Yn.call(this,n,p)}const m=()=>{x3(l,r=!0,r)},b=()=>{x3(l,r=!1,r)};return n.$$set=p=>{"defaultEdgeOptions"in p&&t(6,a=p.defaultEdgeOptions)},[i,s,r,o,l,h,a,u,d,f,g,m,b]}class Rse extends Nt{constructor(e){super(),Ot(this,e,Tse,Ese,Ft,{defaultEdgeOptions:6})}}function HS(n){let e;return{c(){e=te("div"),this.h()},l(t){e=ne(t,"DIV",{class:!0}),V(e).forEach(S),this.h()},h(){A(e,"class","svelte-flow__selection svelte-1iugwpu"),rn(e,"width",typeof n[2]=="string"?n[2]:`${n[2]}px`),rn(e,"height",typeof n[3]=="string"?n[3]:`${n[3]}px`),rn(e,"transform",`translate(${n[0]}px, ${n[1]}px)`)},m(t,i){ee(t,e,i)},p(t,i){i&4&&rn(e,"width",typeof t[2]=="string"?t[2]:`${t[2]}px`),i&8&&rn(e,"height",typeof t[3]=="string"?t[3]:`${t[3]}px`),i&3&&rn(e,"transform",`translate(${t[0]}px, ${t[1]}px)`)},d(t){t&&S(e)}}}function Mse(n){let e,t=n[4]&&HS(n);return{c(){t&&t.c(),e=Ut()},l(i){t&&t.l(i),e=Ut()},m(i,s){t&&t.m(i,s),ee(i,e,s)},p(i,[s]){i[4]?t?t.p(i,s):(t=HS(i),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:kt,o:kt,d(i){i&&S(e),t&&t.d(i)}}}function Pse(n,e,t){let{x:i=0}=e,{y:s=0}=e,{width:r=0}=e,{height:a=0}=e,{isVisible:o=!0}=e;return n.$$set=l=>{"x"in l&&t(0,i=l.x),"y"in l&&t(1,s=l.y),"width"in l&&t(2,r=l.width),"height"in l&&t(3,a=l.height),"isVisible"in l&&t(4,o=l.isVisible)},[i,s,r,a,o]}class oD extends Nt{constructor(e){super(),Ot(this,e,Pse,Mse,Ft,{x:0,y:1,width:2,height:3,isVisible:4})}}function Nse(n){var i,s,r,a;let e,t;return e=new oD({props:{isVisible:!!(n[0]&&n[1]==="user"),width:(i=n[0])==null?void 0:i.width,height:(s=n[0])==null?void 0:s.height,x:(r=n[0])==null?void 0:r.x,y:(a=n[0])==null?void 0:a.y}}),{c(){pe(e.$$.fragment)},l(o){ye(e.$$.fragment,o)},m(o,l){be(e,o,l),t=!0},p(o,[l]){var h,u,d,f;const c={};l&3&&(c.isVisible=!!(o[0]&&o[1]==="user")),l&1&&(c.width=(h=o[0])==null?void 0:h.width),l&1&&(c.height=(u=o[0])==null?void 0:u.height),l&1&&(c.x=(d=o[0])==null?void 0:d.x),l&1&&(c.y=(f=o[0])==null?void 0:f.y),e.$set(c)},i(o){t||(L(e.$$.fragment,o),t=!0)},o(o){j(e.$$.fragment,o),t=!1},d(o){xe(e,o)}}}function Ose(n,e,t){let i,s;const{selectionRect:r,selectionRectMode:a}=rs();return Pe(n,r,o=>t(0,i=o)),Pe(n,a,o=>t(1,s=o)),[i,s,r,a]}class Dse extends Nt{constructor(e){super(),Ot(this,e,Ose,Nse,Ft,{})}}function zS(n){let e,t,i,s,r;return t=new oD({props:{width:"100%",height:"100%",x:0,y:0}}),{c(){e=te("div"),pe(t.$$.fragment),this.h()},l(a){e=ne(a,"DIV",{class:!0,style:!0,role:!0,tabindex:!0});var o=V(e);ye(t.$$.fragment,o),o.forEach(S),this.h()},h(){A(e,"class","selection-wrapper nopan svelte-5pxri"),rn(e,"width",n[1].width+"px"),rn(e,"height",n[1].height+"px"),rn(e,"transform","translate("+n[1].x+"px, "+n[1].y+"px)"),A(e,"role","button"),A(e,"tabindex","-1")},m(a,o){ee(a,e,o),be(t,e,null),i=!0,s||(r=[ua(aD.call(null,e,{disabled:!1,store:n[2],onDrag:n[11],onDragStart:n[12],onDragStop:n[13]})),pt(e,"contextmenu",n[7]),pt(e,"click",n[8]),pt(e,"keyup",Lse)],s=!0)},p(a,o){(!i||o&2)&&rn(e,"width",a[1].width+"px"),(!i||o&2)&&rn(e,"height",a[1].height+"px"),(!i||o&2)&&rn(e,"transform","translate("+a[1].x+"px, "+a[1].y+"px)")},i(a){i||(L(t.$$.fragment,a),i=!0)},o(a){j(t.$$.fragment,a),i=!1},d(a){a&&S(e),xe(t),s=!1,ia(r)}}}function Fse(n){let e=n[0]==="nodes"&&n[1]&&il(n[1].x)&&il(n[1].y),t,i,s=e&&zS(n);return{c(){s&&s.c(),t=Ut()},l(r){s&&s.l(r),t=Ut()},m(r,a){s&&s.m(r,a),ee(r,t,a),i=!0},p(r,[a]){a&3&&(e=r[0]==="nodes"&&r[1]&&il(r[1].x)&&il(r[1].y)),e?s?(s.p(r,a),a&3&&L(s,1)):(s=zS(r),s.c(),L(s,1),s.m(t.parentNode,t)):s&&(ot(),j(s,1,1,()=>{s=null}),lt())},i(r){i||(L(s),i=!0)},o(r){j(s),i=!1},d(r){r&&S(t),s&&s.d(r)}}}const Lse=()=>{};function Bse(n,e,t){let i,s,r;const a=rs(),{selectionRectMode:o,nodes:l,nodeLookup:c}=a;Pe(n,o,p=>t(0,r=p)),Pe(n,l,p=>t(9,i=p)),Pe(n,c,p=>t(10,s=p));const h=eo();let u=null;function d(p){const y=i.filter(w=>w.selected);h("selectioncontextmenu",{nodes:y,event:p})}function f(p){const y=i.filter(w=>w.selected);h("selectionclick",{nodes:y,event:p})}const g=(p,y,w,_)=>{h("nodedrag",{event:p,targetNode:null,nodes:_})},m=(p,y,w,_)=>{h("nodedragstart",{event:p,targetNode:null,nodes:_})},b=(p,y,w,_)=>{h("nodedragstop",{event:p,targetNode:null,nodes:_})};return n.$$.update=()=>{n.$$.dirty&1537&&r==="nodes"&&t(1,u=Ly(s,{filter:p=>!!p.selected}))},[r,u,a,o,l,c,h,d,f,i,s,g,m,b]}class Use extends Nt{constructor(e){super(),Ot(this,e,Bse,Fse,Ft,{})}}function Al(n,e){let{enabled:t=!0,trigger:i,type:s="keydown"}=e;function r(a){const o=Array.isArray(i)?i:[i],l={alt:a.altKey,ctrl:a.ctrlKey,shift:a.shiftKey,meta:a.metaKey};for(const c of o){const h={modifier:[],preventDefault:!1,enabled:!0,...c},{modifier:u,key:d,callback:f,preventDefault:g,enabled:m}=h;if(m){if(u.length&&!(Array.isArray(u)?u:[u]).map(y=>typeof y=="string"?[y]:y).some(y=>y.every(w=>l[w])))continue;if(a.key===d){g&&a.preventDefault();const b={node:n,trigger:h,originalEvent:a};n.dispatchEvent(new CustomEvent("shortcut",{detail:b})),f==null||f(b)}}}}return t&&n.addEventListener(s,r),{update:a=>{const{enabled:o=!0,type:l="keydown"}=a;t&&(!o||s!==l)?n.removeEventListener(s,r):!t&&o&&n.addEventListener(l,r),t=o,s=l,i=a.trigger},destroy:()=>{n.removeEventListener(s,r)}}}function Hse(n){let e,t,i,s,r,a,o,l,c,h,u,d;return{c:kt,l:kt,m(f,g){u||(d=[ua(e=Al.call(null,window,{trigger:ps(n[0],n[11]),type:"keydown"})),ua(t=Al.call(null,window,{trigger:ps(n[0],n[12]),type:"keyup"})),ua(i=Al.call(null,window,{trigger:ps(n[1],n[13]),type:"keydown"})),ua(s=Al.call(null,window,{trigger:ps(n[1],n[14]),type:"keyup"})),ua(r=Al.call(null,window,{trigger:ps(n[2],n[15]),type:"keydown"})),ua(a=Al.call(null,window,{trigger:ps(n[2],n[16]),type:"keyup"})),ua(o=Al.call(null,window,{trigger:ps(n[3],n[17]),type:"keydown"})),ua(l=Al.call(null,window,{trigger:ps(n[3],n[18]),type:"keyup"})),ua(c=Al.call(null,window,{trigger:ps(n[4],n[19]),type:"keydown"})),ua(h=Al.call(null,window,{trigger:ps(n[4],n[20]),type:"keyup"})),pt(window,"blur",n[10]),pt(window,"contextmenu",n[10])],u=!0)},p(f,[g]){e&&js(e.update)&&g&1&&e.update.call(null,{trigger:ps(f[0],f[11]),type:"keydown"}),t&&js(t.update)&&g&1&&t.update.call(null,{trigger:ps(f[0],f[12]),type:"keyup"}),i&&js(i.update)&&g&2&&i.update.call(null,{trigger:ps(f[1],f[13]),type:"keydown"}),s&&js(s.update)&&g&2&&s.update.call(null,{trigger:ps(f[1],f[14]),type:"keyup"}),r&&js(r.update)&&g&4&&r.update.call(null,{trigger:ps(f[2],f[15]),type:"keydown"}),a&&js(a.update)&&g&4&&a.update.call(null,{trigger:ps(f[2],f[16]),type:"keyup"}),o&&js(o.update)&&g&8&&o.update.call(null,{trigger:ps(f[3],f[17]),type:"keydown"}),l&&js(l.update)&&g&8&&l.update.call(null,{trigger:ps(f[3],f[18]),type:"keyup"}),c&&js(c.update)&&g&16&&c.update.call(null,{trigger:ps(f[4],f[19]),type:"keydown"}),h&&js(h.update)&&g&16&&h.update.call(null,{trigger:ps(f[4],f[20]),type:"keyup"})},i:kt,o:kt,d(f){u=!1,ia(d)}}}function lD(n){return n!==null&&typeof n=="object"}function zse(n){return lD(n)?n.modifier||[]:[]}function jse(n){return n==null?"":lD(n)?n.key:n}function ps(n,e){return(Array.isArray(n)?n:[n]).map(i=>{const s=jse(i);return{key:s,modifier:zse(i),enabled:s!==null,callback:e}})}function Gse(n,e,t){let{selectionKey:i="Shift"}=e,{multiSelectionKey:s=m5()?"Meta":"Control"}=e,{deleteKey:r="Backspace"}=e,{panActivationKey:a=" "}=e,{zoomActivationKey:o=m5()?"Meta":"Control"}=e;const{selectionKeyPressed:l,multiselectionKeyPressed:c,deleteKeyPressed:h,panActivationKeyPressed:u,zoomActivationKeyPressed:d,selectionRect:f}=rs();function g(){f.set(null),l.set(!1),c.set(!1),h.set(!1),u.set(!1),d.set(!1)}const m=()=>l.set(!0),b=()=>l.set(!1),p=()=>c.set(!0),y=()=>c.set(!1),w=E=>{!(E.originalEvent.ctrlKey||E.originalEvent.metaKey||E.originalEvent.shiftKey)&&!Sne(E.originalEvent)&&h.set(!0)},_=()=>h.set(!1),v=()=>u.set(!0),C=()=>u.set(!1),k=()=>d.set(!0),I=()=>d.set(!1);return n.$$set=E=>{"selectionKey"in E&&t(0,i=E.selectionKey),"multiSelectionKey"in E&&t(1,s=E.multiSelectionKey),"deleteKey"in E&&t(2,r=E.deleteKey),"panActivationKey"in E&&t(3,a=E.panActivationKey),"zoomActivationKey"in E&&t(4,o=E.zoomActivationKey)},[i,s,r,a,o,l,c,h,u,d,g,m,b,p,y,w,_,v,C,k,I]}class Vse extends Nt{constructor(e){super(),Ot(this,e,Gse,Hse,Ft,{selectionKey:0,multiSelectionKey:1,deleteKey:2,panActivationKey:3,zoomActivationKey:4})}}const qse=n=>({}),jS=n=>({});function GS(n){let e,t,i,s;const r=n[13].connectionLine,a=Xs(r,n,n[12],jS);let o=!n[2]&&VS(n);return{c(){e=nt("svg"),t=nt("g"),a&&a.c(),o&&o.c(),this.h()},l(l){e=it(l,"svg",{width:!0,height:!0,class:!0,style:!0});var c=V(e);t=it(c,"g",{class:!0});var h=V(t);a&&a.l(h),o&&o.l(h),h.forEach(S),c.forEach(S),this.h()},h(){A(t,"class",i=Ri(["svelte-flow__connection",fS(n[3].isValid)])),A(e,"width",n[5]),A(e,"height",n[6]),A(e,"class","svelte-flow__connectionline"),A(e,"style",n[0])},m(l,c){ee(l,e,c),q(e,t),a&&a.m(t,null),o&&o.m(t,null),s=!0},p(l,c){a&&a.p&&(!s||c&4096)&&Ys(a,r,l,l[12],s?Zs(r,l[12],c,qse):Js(l[12]),jS),l[2]?o&&(o.d(1),o=null):o?o.p(l,c):(o=VS(l),o.c(),o.m(t,null)),(!s||c&8&&i!==(i=Ri(["svelte-flow__connection",fS(l[3].isValid)])))&&A(t,"class",i),(!s||c&32)&&A(e,"width",l[5]),(!s||c&64)&&A(e,"height",l[6]),(!s||c&1)&&A(e,"style",l[0])},i(l){s||(L(a,l),s=!0)},o(l){j(a,l),s=!1},d(l){l&&S(e),a&&a.d(l),o&&o.d()}}}function VS(n){let e;return{c(){e=nt("path"),this.h()},l(t){e=it(t,"path",{d:!0,style:!0,fill:!0,class:!0}),V(e).forEach(S),this.h()},h(){A(e,"d",n[4]),A(e,"style",n[1]),A(e,"fill","none"),A(e,"class","svelte-flow__connection-path")},m(t,i){ee(t,e,i)},p(t,i){i&16&&A(e,"d",t[4]),i&2&&A(e,"style",t[1])},d(t){t&&S(e)}}}function Wse(n){let e,t,i=n[3].inProgress&&GS(n);return{c(){i&&i.c(),e=Ut()},l(s){i&&i.l(s),e=Ut()},m(s,r){i&&i.m(s,r),ee(s,e,r),t=!0},p(s,[r]){s[3].inProgress?i?(i.p(s,r),r&8&&L(i,1)):(i=GS(s),i.c(),L(i,1),i.m(e.parentNode,e)):i&&(ot(),j(i,1,1,()=>{i=null}),lt())},i(s){t||(L(i),t=!0)},o(s){j(i),t=!1},d(s){s&&S(e),i&&i.d(s)}}}function Kse(n,e,t){let i,s,r,a,{$$slots:o={},$$scope:l}=e,{containerStyle:c=""}=e,{style:h=""}=e,{isCustomComponent:u=!1}=e;const{width:d,height:f,connection:g,connectionLineType:m}=rs();Pe(n,d,p=>t(5,r=p)),Pe(n,f,p=>t(6,a=p)),Pe(n,g,p=>t(3,s=p)),Pe(n,m,p=>t(11,i=p));let b=null;return n.$$set=p=>{"containerStyle"in p&&t(0,c=p.containerStyle),"style"in p&&t(1,h=p.style),"isCustomComponent"in p&&t(2,u=p.isCustomComponent),"$$scope"in p&&t(12,l=p.$$scope)},n.$$.update=()=>{if(n.$$.dirty&2060&&s.inProgress&&!u){const{from:p,to:y,fromPosition:w,toPosition:_}=s,v={sourceX:p.x,sourceY:p.y,sourcePosition:w,targetX:y.x,targetY:y.y,targetPosition:_};switch(i){case m1.Bezier:t(4,[b]=BO(v),b);break;case m1.Step:t(4,[b]=p5({...v,borderRadius:0}),b);break;case m1.SmoothStep:t(4,[b]=p5(v),b);break;default:t(4,[b]=HO(v),b)}}},[c,h,u,s,b,r,a,d,f,g,m,i,l,o]}class Xse extends Nt{constructor(e){super(),Ot(this,e,Kse,Wse,Ft,{containerStyle:0,style:1,isCustomComponent:2})}}function Yse(n){let e,t,i;const s=n[8].default,r=Xs(s,n,n[7],null);let a=[{class:t=Ri(["svelte-flow__panel",n[1],...n[2]])},{style:n[0]},n[5]],o={};for(let l=0;l<a.length;l+=1)o=li(o,a[l]);return{c(){e=te("div"),r&&r.c(),this.h()},l(l){e=ne(l,"DIV",{class:!0,style:!0});var c=V(e);r&&r.l(c),c.forEach(S),this.h()},h(){Mg(e,o),rn(e,"pointer-events",n[3]?"none":"")},m(l,c){ee(l,e,c),r&&r.m(e,null),i=!0},p(l,[c]){r&&r.p&&(!i||c&128)&&Ys(r,s,l,l[7],i?Zs(s,l[7],c,null):Js(l[7]),null),Mg(e,o=Gh(a,[(!i||c&6&&t!==(t=Ri(["svelte-flow__panel",l[1],...l[2]])))&&{class:t},(!i||c&1)&&{style:l[0]},c&32&&l[5]])),rn(e,"pointer-events",l[3]?"none":"")},i(l){i||(L(r,l),i=!0)},o(l){j(r,l),i=!1},d(l){l&&S(e),r&&r.d(l)}}}function Jse(n,e,t){let i;const s=["position","style","class"];let r=is(e,s),a,{$$slots:o={},$$scope:l}=e,{position:c="top-right"}=e,{style:h=void 0}=e,{class:u=void 0}=e;const{selectionRectMode:d}=rs();return Pe(n,d,f=>t(3,a=f)),n.$$set=f=>{e=li(li({},e),gl(f)),t(5,r=is(e,s)),"position"in f&&t(6,c=f.position),"style"in f&&t(0,h=f.style),"class"in f&&t(1,u=f.class),"$$scope"in f&&t(7,l=f.$$scope)},n.$$.update=()=>{n.$$.dirty&64&&t(2,i=`${c}`.split("-"))},[h,u,i,a,d,r,c,l,o]}class cD extends Nt{constructor(e){super(),Ot(this,e,Jse,Yse,Ft,{position:6,style:0,class:1})}}function qS(n){let e,t;return e=new cD({props:{position:n[1],class:"svelte-flow__attribution","data-message":"Feel free to remove the attribution or check out how you could support us: https://svelteflow.dev/support-us",$$slots:{default:[Zse]},$$scope:{ctx:n}}}),{c(){pe(e.$$.fragment)},l(i){ye(e.$$.fragment,i)},m(i,s){be(e,i,s),t=!0},p(i,s){const r={};s&2&&(r.position=i[1]),s&4&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(L(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){xe(e,i)}}}function Zse(n){let e,t="Svelte Flow";return{c(){e=te("a"),e.textContent=t,this.h()},l(i){e=ne(i,"A",{href:!0,target:!0,rel:!0,"aria-label":!0,"data-svelte-h":!0}),Ro(e)!=="svelte-2vm8e4"&&(e.textContent=t),this.h()},h(){A(e,"href","https://svelteflow.dev"),A(e,"target","_blank"),A(e,"rel","noopener noreferrer"),A(e,"aria-label","Svelte Flow attribution")},m(i,s){ee(i,e,s)},p:kt,d(i){i&&S(e)}}}function Qse(n){var s;let e,t,i=!((s=n[0])!=null&&s.hideAttribution)&&qS(n);return{c(){i&&i.c(),e=Ut()},l(r){i&&i.l(r),e=Ut()},m(r,a){i&&i.m(r,a),ee(r,e,a),t=!0},p(r,[a]){var o;(o=r[0])!=null&&o.hideAttribution?i&&(ot(),j(i,1,1,()=>{i=null}),lt()):i?(i.p(r,a),a&1&&L(i,1)):(i=qS(r),i.c(),L(i,1),i.m(e.parentNode,e))},i(r){t||(L(i),t=!0)},o(r){j(i),t=!1},d(r){r&&S(e),i&&i.d(r)}}}function $se(n,e,t){let{proOptions:i=void 0}=e,{position:s="bottom-right"}=e;return n.$$set=r=>{"proOptions"in r&&t(0,i=r.proOptions),"position"in r&&t(1,s=r.position)},[i,s]}class ere extends Nt{constructor(e){super(),Ot(this,e,$se,Qse,Ft,{proOptions:0,position:1})}}function WS(n,{nodeTypes:e,edgeTypes:t,minZoom:i,maxZoom:s,translateExtent:r,paneClickDistance:a}){e!==void 0&&n.setNodeTypes(e),t!==void 0&&n.setEdgeTypes(t),i!==void 0&&n.setMinZoom(i),s!==void 0&&n.setMaxZoom(s),r!==void 0&&n.setTranslateExtent(r),a!==void 0&&n.setPaneClickDistance(a)}const tre=n=>Object.keys(n);function nre(n,e){tre(e).forEach(t=>{const i=e[t];i!==void 0&&n[t].set(i)})}function ire(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function sre(n="light"){return No("light",t=>{if(n!=="system"){t(n);return}const i=ire(),s=()=>t(i!=null&&i.matches?"dark":"light");return t(i!=null&&i.matches?"dark":"light"),i==null||i.addEventListener("change",s),()=>{i==null||i.removeEventListener("change",s)}})}const rre=n=>({}),KS=n=>({slot:"connectionLine"});function are(n){let e;const t=n[75].connectionLine,i=Xs(t,n,n[99],KS);return{c(){i&&i.c()},l(s){i&&i.l(s)},m(s,r){i&&i.m(s,r),e=!0},p(s,r){i&&i.p&&(!e||r[3]&64)&&Ys(i,t,s,s[99],e?Zs(t,s[99],r,rre):Js(s[99]),KS)},i(s){e||(L(i,s),e=!0)},o(s){j(i,s),e=!1},d(s){i&&i.d(s)}}}function ore(n){let e,t,i,s,r,a,o,l,c,h,u,d;return e=new Rse({props:{defaultEdgeOptions:n[21]}}),e.$on("edgeclick",n[78]),e.$on("edgecontextmenu",n[79]),e.$on("edgemouseenter",n[80]),e.$on("edgemouseleave",n[81]),i=new Xse({props:{containerStyle:n[7],style:n[6],isCustomComponent:n[34].connectionLine,$$slots:{connectionLine:[are]},$$scope:{ctx:n}}}),c=new gse({props:{nodeClickDistance:n[23]}}),c.$on("nodeclick",n[82]),c.$on("nodemouseenter",n[83]),c.$on("nodemousemove",n[84]),c.$on("nodemouseleave",n[85]),c.$on("nodedragstart",n[86]),c.$on("nodedrag",n[87]),c.$on("nodedragstop",n[88]),c.$on("nodecontextmenu",n[89]),u=new Use({}),u.$on("selectionclick",n[90]),u.$on("selectioncontextmenu",n[91]),u.$on("nodedragstart",n[92]),u.$on("nodedrag",n[93]),u.$on("nodedragstop",n[94]),{c(){pe(e.$$.fragment),t=Ae(),pe(i.$$.fragment),s=Ae(),r=te("div"),a=Ae(),o=te("div"),l=Ae(),pe(c.$$.fragment),h=Ae(),pe(u.$$.fragment),this.h()},l(f){ye(e.$$.fragment,f),t=Se(f),ye(i.$$.fragment,f),s=Se(f),r=ne(f,"DIV",{class:!0}),V(r).forEach(S),a=Se(f),o=ne(f,"DIV",{class:!0}),V(o).forEach(S),l=Se(f),ye(c.$$.fragment,f),h=Se(f),ye(u.$$.fragment,f),this.h()},h(){A(r,"class","svelte-flow__edgelabel-renderer"),A(o,"class","svelte-flow__viewport-portal")},m(f,g){be(e,f,g),ee(f,t,g),be(i,f,g),ee(f,s,g),ee(f,r,g),ee(f,a,g),ee(f,o,g),ee(f,l,g),be(c,f,g),ee(f,h,g),be(u,f,g),d=!0},p(f,g){const m={};g[0]&2097152&&(m.defaultEdgeOptions=f[21]),e.$set(m);const b={};g[0]&128&&(b.containerStyle=f[7]),g[0]&64&&(b.style=f[6]),g[1]&8&&(b.isCustomComponent=f[34].connectionLine),g[3]&64&&(b.$$scope={dirty:g,ctx:f}),i.$set(b);const p={};g[0]&8388608&&(p.nodeClickDistance=f[23]),c.$set(p)},i(f){d||(L(e.$$.fragment,f),L(i.$$.fragment,f),L(c.$$.fragment,f),L(u.$$.fragment,f),d=!0)},o(f){j(e.$$.fragment,f),j(i.$$.fragment,f),j(c.$$.fragment,f),j(u.$$.fragment,f),d=!1},d(f){f&&(S(t),S(s),S(r),S(a),S(o),S(l),S(h)),xe(e,f),xe(i,f),xe(c,f),xe(u,f)}}}function lre(n){let e,t,i,s;return e=new ase({props:{$$slots:{default:[ore]},$$scope:{ctx:n}}}),i=new Dse({}),{c(){pe(e.$$.fragment),t=Ae(),pe(i.$$.fragment)},l(r){ye(e.$$.fragment,r),t=Se(r),ye(i.$$.fragment,r)},m(r,a){be(e,r,a),ee(r,t,a),be(i,r,a),s=!0},p(r,a){const o={};a[0]&10485952|a[1]&8|a[3]&64&&(o.$$scope={dirty:a,ctx:r}),e.$set(o)},i(r){s||(L(e.$$.fragment,r),L(i.$$.fragment,r),s=!0)},o(r){j(e.$$.fragment,r),j(i.$$.fragment,r),s=!1},d(r){r&&S(t),xe(e,r),xe(i,r)}}}function cre(n){let e,t;return e=new ise({props:{panOnDrag:n[17]===void 0?!0:n[17],selectionOnDrag:n[18],$$slots:{default:[lre]},$$scope:{ctx:n}}}),e.$on("paneclick",n[95]),e.$on("panecontextmenu",n[96]),{c(){pe(e.$$.fragment)},l(i){ye(e.$$.fragment,i)},m(i,s){be(e,i,s),t=!0},p(i,s){const r={};s[0]&131072&&(r.panOnDrag=i[17]===void 0?!0:i[17]),s[0]&262144&&(r.selectionOnDrag=i[18]),s[0]&10485952|s[1]&8|s[3]&64&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(L(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){xe(e,i)}}}function hre(n){let e,t,i,s,r,a,o,l,c,h,u,d;t=new Vse({props:{selectionKey:n[1],deleteKey:n[5],panActivationKey:n[2],multiSelectionKey:n[3],zoomActivationKey:n[4]}}),s=new ese({props:{initialViewport:n[31],onMoveStart:n[8],onMove:n[9],onMoveEnd:n[10],panOnScrollMode:n[11]===void 0?lc.Free:n[11],preventScrolling:n[12]===void 0?!0:n[12],zoomOnScroll:n[13]===void 0?!0:n[13],zoomOnDoubleClick:n[14]===void 0?!0:n[14],zoomOnPinch:n[15]===void 0?!0:n[15],panOnScroll:n[16]===void 0?!1:n[16],panOnDrag:n[17]===void 0?!0:n[17],paneClickDistance:n[22]===void 0?0:n[22],$$slots:{default:[cre]},$$scope:{ctx:n}}}),a=new ere({props:{proOptions:n[20],position:n[19]}});const f=n[75].default,g=Xs(f,n,n[99],null);let m=[{style:n[24]},{class:l=Ri(["svelte-flow",n[25],n[30]])},{"data-testid":"svelte-flow__wrapper"},n[33],{role:"application"}],b={};for(let p=0;p<m.length;p+=1)b=li(b,m[p]);return{c(){e=te("div"),pe(t.$$.fragment),i=Ae(),pe(s.$$.fragment),r=Ae(),pe(a.$$.fragment),o=Ae(),g&&g.c(),this.h()},l(p){e=ne(p,"DIV",{style:!0,class:!0,"data-testid":!0,role:!0});var y=V(e);ye(t.$$.fragment,y),i=Se(y),ye(s.$$.fragment,y),r=Se(y),ye(a.$$.fragment,y),o=Se(y),g&&g.l(y),y.forEach(S),this.h()},h(){Mg(e,b),h0(()=>n[98].call(e)),bn(e,"svelte-12wlba6",!0)},m(p,y){ee(p,e,y),be(t,e,null),q(e,i),be(s,e,null),q(e,r),be(a,e,null),q(e,o),g&&g.m(e,null),n[97](e),c=bD(e,n[98].bind(e)),h=!0,u||(d=[pt(e,"dragover",n[76]),pt(e,"drop",n[77])],u=!0)},p(p,y){const w={};y[0]&2&&(w.selectionKey=p[1]),y[0]&32&&(w.deleteKey=p[5]),y[0]&4&&(w.panActivationKey=p[2]),y[0]&8&&(w.multiSelectionKey=p[3]),y[0]&16&&(w.zoomActivationKey=p[4]),t.$set(w);const _={};y[0]&256&&(_.onMoveStart=p[8]),y[0]&512&&(_.onMove=p[9]),y[0]&1024&&(_.onMoveEnd=p[10]),y[0]&2048&&(_.panOnScrollMode=p[11]===void 0?lc.Free:p[11]),y[0]&4096&&(_.preventScrolling=p[12]===void 0?!0:p[12]),y[0]&8192&&(_.zoomOnScroll=p[13]===void 0?!0:p[13]),y[0]&16384&&(_.zoomOnDoubleClick=p[14]===void 0?!0:p[14]),y[0]&32768&&(_.zoomOnPinch=p[15]===void 0?!0:p[15]),y[0]&65536&&(_.panOnScroll=p[16]===void 0?!1:p[16]),y[0]&131072&&(_.panOnDrag=p[17]===void 0?!0:p[17]),y[0]&4194304&&(_.paneClickDistance=p[22]===void 0?0:p[22]),y[0]&10879168|y[1]&8|y[3]&64&&(_.$$scope={dirty:y,ctx:p}),s.$set(_);const v={};y[0]&1048576&&(v.proOptions=p[20]),y[0]&524288&&(v.position=p[19]),a.$set(v),g&&g.p&&(!h||y[3]&64)&&Ys(g,f,p,p[99],h?Zs(f,p[99],y,null):Js(p[99]),null),Mg(e,b=Gh(m,[(!h||y[0]&16777216)&&{style:p[24]},(!h||y[0]&1107296256&&l!==(l=Ri(["svelte-flow",p[25],p[30]])))&&{class:l},{"data-testid":"svelte-flow__wrapper"},y[1]&4&&p[33],{role:"application"}])),bn(e,"svelte-12wlba6",!0)},i(p){h||(L(t.$$.fragment,p),L(s.$$.fragment,p),L(a.$$.fragment,p),L(g,p),h=!0)},o(p){j(t.$$.fragment,p),j(s.$$.fragment,p),j(a.$$.fragment,p),j(g,p),h=!1},d(p){p&&S(e),xe(t),xe(s),xe(a),g&&g.d(p),n[97](null),c(),u=!1,ia(d)}}}function ure(n,e,t){let i;const s=["id","nodes","edges","fitView","fitViewOptions","minZoom","maxZoom","initialViewport","viewport","nodeTypes","edgeTypes","selectionKey","selectionMode","panActivationKey","multiSelectionKey","zoomActivationKey","nodesDraggable","nodesConnectable","nodeDragThreshold","elementsSelectable","snapGrid","deleteKey","connectionRadius","connectionLineType","connectionMode","connectionLineStyle","connectionLineContainerStyle","onMoveStart","onMove","onMoveEnd","isValidConnection","translateExtent","nodeExtent","onlyRenderVisibleElements","panOnScrollMode","preventScrolling","zoomOnScroll","zoomOnDoubleClick","zoomOnPinch","panOnScroll","panOnDrag","selectionOnDrag","autoPanOnConnect","autoPanOnNodeDrag","onerror","ondelete","onedgecreate","attributionPosition","proOptions","defaultEdgeOptions","width","height","colorMode","onconnect","onconnectstart","onconnectend","onbeforedelete","oninit","nodeOrigin","paneClickDistance","nodeClickDistance","defaultMarkerColor","style","class"];let r=is(e,s),a,o,l=kt,c=()=>(l(),l=uv(I,ke=>t(100,o=ke)),I),h,u=kt,d=()=>(u(),u=uv(i,ke=>t(30,h=ke)),i);n.$$.on_destroy.push(()=>l()),n.$$.on_destroy.push(()=>u());let{$$slots:f={},$$scope:g}=e;const m=xD(f);let{id:b="1"}=e,{nodes:p}=e,{edges:y}=e,{fitView:w=void 0}=e,{fitViewOptions:_=void 0}=e,{minZoom:v=void 0}=e,{maxZoom:C=void 0}=e,{initialViewport:k=void 0}=e,{viewport:I=void 0}=e;c();let{nodeTypes:E=void 0}=e,{edgeTypes:T=void 0}=e,{selectionKey:M=void 0}=e,{selectionMode:D=void 0}=e,{panActivationKey:H=void 0}=e,{multiSelectionKey:R=void 0}=e,{zoomActivationKey:z=void 0}=e,{nodesDraggable:P=void 0}=e,{nodesConnectable:B=void 0}=e,{nodeDragThreshold:Z=void 0}=e,{elementsSelectable:G=void 0}=e,{snapGrid:Y=void 0}=e,{deleteKey:J=void 0}=e,{connectionRadius:se=void 0}=e,{connectionLineType:fe=void 0}=e,{connectionMode:he=hf.Strict}=e,{connectionLineStyle:de=""}=e,{connectionLineContainerStyle:ge=""}=e,{onMoveStart:N=void 0}=e,{onMove:K=void 0}=e,{onMoveEnd:oe=void 0}=e,{isValidConnection:W=void 0}=e,{translateExtent:le=void 0}=e,{nodeExtent:ce=void 0}=e,{onlyRenderVisibleElements:Ce=void 0}=e,{panOnScrollMode:X=lc.Free}=e,{preventScrolling:Ke=!0}=e,{zoomOnScroll:qe=!0}=e,{zoomOnDoubleClick:He=!0}=e,{zoomOnPinch:Me=!0}=e,{panOnScroll:Ne=!1}=e,{panOnDrag:Qe=!0}=e,{selectionOnDrag:gt=void 0}=e,{autoPanOnConnect:mt=!0}=e,{autoPanOnNodeDrag:Xe=!0}=e,{onerror:rt=void 0}=e,{ondelete:me=void 0}=e,{onedgecreate:Rt=void 0}=e,{attributionPosition:ct=void 0}=e,{proOptions:at=void 0}=e,{defaultEdgeOptions:ze=void 0}=e,{width:Ht=void 0}=e,{height:on=void 0}=e,{colorMode:Re="light"}=e,{onconnect:Mt=void 0}=e,{onconnectstart:yt=void 0}=e,{onconnectend:Gt=void 0}=e,{onbeforedelete:un=void 0}=e,{oninit:Kn=void 0}=e,{nodeOrigin:di=void 0}=e,{paneClickDistance:qi=0}=e,{nodeClickDistance:Cs=0}=e,{defaultMarkerColor:Wi="#b1b1b7"}=e,{style:Ms=void 0}=e,{class:Ki=void 0}=e,yi,yr,Ps;const Ns=o||k,Oe=yD(jy)?rs():Jie({nodes:Ye(p),edges:Ye(y),width:Ht,height:on,fitView:w,nodeOrigin:di,nodeExtent:ce});fl(()=>(Oe.width.set(yr),Oe.height.set(Ps),Oe.domNode.set(yi),Oe.syncNodeStores(p),Oe.syncEdgeStores(y),Oe.syncViewport(I),w!==void 0&&Oe.fitViewOnInit.set(w),_&&Oe.fitViewOptions.set(_),WS(Oe,{nodeTypes:E,edgeTypes:T,minZoom:v,maxZoom:C,translateExtent:le,paneClickDistance:qi}),()=>{Oe.reset()}));const{initialized:je}=Oe;Pe(n,je,ke=>t(74,a=ke));let ht=!1;function Xt(ke){Yn.call(this,n,ke)}function tn(ke){Yn.call(this,n,ke)}function En(ke){Yn.call(this,n,ke)}function mn(ke){Yn.call(this,n,ke)}function Pn(ke){Yn.call(this,n,ke)}function Bn(ke){Yn.call(this,n,ke)}function xl(ke){Yn.call(this,n,ke)}function wr(ke){Yn.call(this,n,ke)}function om(ke){Yn.call(this,n,ke)}function lm(ke){Yn.call(this,n,ke)}function cm(ke){Yn.call(this,n,ke)}function hm(ke){Yn.call(this,n,ke)}function um(ke){Yn.call(this,n,ke)}function dm(ke){Yn.call(this,n,ke)}function fm(ke){Yn.call(this,n,ke)}function gm(ke){Yn.call(this,n,ke)}function mm(ke){Yn.call(this,n,ke)}function pm(ke){Yn.call(this,n,ke)}function bm(ke){Yn.call(this,n,ke)}function xm(ke){Yn.call(this,n,ke)}function ym(ke){Yn.call(this,n,ke)}function wm(ke){At[ke?"unshift":"push"](()=>{yi=ke,t(28,yi)})}function _m(){yr=this.clientWidth,Ps=this.clientHeight,t(26,yr),t(27,Ps)}return n.$$set=ke=>{e=li(li({},e),gl(ke)),t(33,r=is(e,s)),"id"in ke&&t(35,b=ke.id),"nodes"in ke&&t(36,p=ke.nodes),"edges"in ke&&t(37,y=ke.edges),"fitView"in ke&&t(38,w=ke.fitView),"fitViewOptions"in ke&&t(39,_=ke.fitViewOptions),"minZoom"in ke&&t(40,v=ke.minZoom),"maxZoom"in ke&&t(41,C=ke.maxZoom),"initialViewport"in ke&&t(42,k=ke.initialViewport),"viewport"in ke&&c(t(0,I=ke.viewport)),"nodeTypes"in ke&&t(43,E=ke.nodeTypes),"edgeTypes"in ke&&t(44,T=ke.edgeTypes),"selectionKey"in ke&&t(1,M=ke.selectionKey),"selectionMode"in ke&&t(45,D=ke.selectionMode),"panActivationKey"in ke&&t(2,H=ke.panActivationKey),"multiSelectionKey"in ke&&t(3,R=ke.multiSelectionKey),"zoomActivationKey"in ke&&t(4,z=ke.zoomActivationKey),"nodesDraggable"in ke&&t(46,P=ke.nodesDraggable),"nodesConnectable"in ke&&t(47,B=ke.nodesConnectable),"nodeDragThreshold"in ke&&t(48,Z=ke.nodeDragThreshold),"elementsSelectable"in ke&&t(49,G=ke.elementsSelectable),"snapGrid"in ke&&t(50,Y=ke.snapGrid),"deleteKey"in ke&&t(5,J=ke.deleteKey),"connectionRadius"in ke&&t(51,se=ke.connectionRadius),"connectionLineType"in ke&&t(52,fe=ke.connectionLineType),"connectionMode"in ke&&t(53,he=ke.connectionMode),"connectionLineStyle"in ke&&t(6,de=ke.connectionLineStyle),"connectionLineContainerStyle"in ke&&t(7,ge=ke.connectionLineContainerStyle),"onMoveStart"in ke&&t(8,N=ke.onMoveStart),"onMove"in ke&&t(9,K=ke.onMove),"onMoveEnd"in ke&&t(10,oe=ke.onMoveEnd),"isValidConnection"in ke&&t(54,W=ke.isValidConnection),"translateExtent"in ke&&t(55,le=ke.translateExtent),"nodeExtent"in ke&&t(56,ce=ke.nodeExtent),"onlyRenderVisibleElements"in ke&&t(57,Ce=ke.onlyRenderVisibleElements),"panOnScrollMode"in ke&&t(11,X=ke.panOnScrollMode),"preventScrolling"in ke&&t(12,Ke=ke.preventScrolling),"zoomOnScroll"in ke&&t(13,qe=ke.zoomOnScroll),"zoomOnDoubleClick"in ke&&t(14,He=ke.zoomOnDoubleClick),"zoomOnPinch"in ke&&t(15,Me=ke.zoomOnPinch),"panOnScroll"in ke&&t(16,Ne=ke.panOnScroll),"panOnDrag"in ke&&t(17,Qe=ke.panOnDrag),"selectionOnDrag"in ke&&t(18,gt=ke.selectionOnDrag),"autoPanOnConnect"in ke&&t(58,mt=ke.autoPanOnConnect),"autoPanOnNodeDrag"in ke&&t(59,Xe=ke.autoPanOnNodeDrag),"onerror"in ke&&t(60,rt=ke.onerror),"ondelete"in ke&&t(61,me=ke.ondelete),"onedgecreate"in ke&&t(62,Rt=ke.onedgecreate),"attributionPosition"in ke&&t(19,ct=ke.attributionPosition),"proOptions"in ke&&t(20,at=ke.proOptions),"defaultEdgeOptions"in ke&&t(21,ze=ke.defaultEdgeOptions),"width"in ke&&t(63,Ht=ke.width),"height"in ke&&t(64,on=ke.height),"colorMode"in ke&&t(65,Re=ke.colorMode),"onconnect"in ke&&t(66,Mt=ke.onconnect),"onconnectstart"in ke&&t(67,yt=ke.onconnectstart),"onconnectend"in ke&&t(68,Gt=ke.onconnectend),"onbeforedelete"in ke&&t(69,un=ke.onbeforedelete),"oninit"in ke&&t(70,Kn=ke.oninit),"nodeOrigin"in ke&&t(71,di=ke.nodeOrigin),"paneClickDistance"in ke&&t(22,qi=ke.paneClickDistance),"nodeClickDistance"in ke&&t(23,Cs=ke.nodeClickDistance),"defaultMarkerColor"in ke&&t(72,Wi=ke.defaultMarkerColor),"style"in ke&&t(24,Ms=ke.style),"class"in ke&&t(25,Ki=ke.class),"$$scope"in ke&&t(99,g=ke.$$scope)},n.$$.update=()=>{n.$$.dirty[0]&201326592&&yr!==void 0&&Ps!==void 0&&(Oe.width.set(yr),Oe.height.set(Ps)),n.$$.dirty[2]&6400&&!ht&&a&&(Kn==null||Kn(),t(73,ht=!0)),n.$$.dirty[1]&2097135632|n.$$.dirty[2]&1777&&nre(Oe,{flowId:b,connectionLineType:fe,connectionRadius:se,selectionMode:D,snapGrid:Y,defaultMarkerColor:Wi,nodesDraggable:P,nodesConnectable:B,elementsSelectable:G,onlyRenderVisibleElements:Ce,isValidConnection:W,autoPanOnConnect:mt,autoPanOnNodeDrag:Xe,onerror:rt,ondelete:me,onedgecreate:Rt,connectionMode:he,nodeDragThreshold:Z,onconnect:Mt,onconnectstart:yt,onconnectend:Gt,onbeforedelete:un,nodeOrigin:di}),n.$$.dirty[0]&4194304|n.$$.dirty[1]&16791040&&WS(Oe,{nodeTypes:E,edgeTypes:T,minZoom:v,maxZoom:C,translateExtent:le,paneClickDistance:qi}),n.$$.dirty[2]&8&&d(t(29,i=sre(Re)))},[I,M,H,R,z,J,de,ge,N,K,oe,X,Ke,qe,He,Me,Ne,Qe,gt,ct,at,ze,qi,Cs,Ms,Ki,yr,Ps,yi,i,h,Ns,je,r,m,b,p,y,w,_,v,C,k,E,T,D,P,B,Z,G,Y,se,fe,he,W,le,ce,Ce,mt,Xe,rt,me,Rt,Ht,on,Re,Mt,yt,Gt,un,Kn,di,Wi,ht,a,f,Xt,tn,En,mn,Pn,Bn,xl,wr,om,lm,cm,hm,um,dm,fm,gm,mm,pm,bm,xm,ym,wm,_m,g]}class dre extends Nt{constructor(e){super(),Ot(this,e,ure,hre,Ft,{id:35,nodes:36,edges:37,fitView:38,fitViewOptions:39,minZoom:40,maxZoom:41,initialViewport:42,viewport:0,nodeTypes:43,edgeTypes:44,selectionKey:1,selectionMode:45,panActivationKey:2,multiSelectionKey:3,zoomActivationKey:4,nodesDraggable:46,nodesConnectable:47,nodeDragThreshold:48,elementsSelectable:49,snapGrid:50,deleteKey:5,connectionRadius:51,connectionLineType:52,connectionMode:53,connectionLineStyle:6,connectionLineContainerStyle:7,onMoveStart:8,onMove:9,onMoveEnd:10,isValidConnection:54,translateExtent:55,nodeExtent:56,onlyRenderVisibleElements:57,panOnScrollMode:11,preventScrolling:12,zoomOnScroll:13,zoomOnDoubleClick:14,zoomOnPinch:15,panOnScroll:16,panOnDrag:17,selectionOnDrag:18,autoPanOnConnect:58,autoPanOnNodeDrag:59,onerror:60,ondelete:61,onedgecreate:62,attributionPosition:19,proOptions:20,defaultEdgeOptions:21,width:63,height:64,colorMode:65,onconnect:66,onconnectstart:67,onconnectend:68,onbeforedelete:69,oninit:70,nodeOrigin:71,paneClickDistance:22,nodeClickDistance:23,defaultMarkerColor:72,style:24,class:25},null,[-1,-1,-1,-1])}}function fre(n){let e;const t=n[7].default,i=Xs(t,n,n[6],null);return{c(){i&&i.c()},l(s){i&&i.l(s)},m(s,r){i&&i.m(s,r),e=!0},p(s,[r]){i&&i.p&&(!e||r&64)&&Ys(i,t,s,s[6],e?Zs(t,s[6],r,null):Js(s[6]),null)},i(s){e||(L(i,s),e=!0)},o(s){j(i,s),e=!1},d(s){i&&i.d(s)}}}function gre(n,e,t){let{$$slots:i={},$$scope:s}=e,{initialNodes:r=void 0}=e,{initialEdges:a=void 0}=e,{initialWidth:o=void 0}=e,{initialHeight:l=void 0}=e,{fitView:c=void 0}=e,{nodeOrigin:h=void 0}=e;const u=rD({nodes:r,edges:a,width:o,height:l,nodeOrigin:h,fitView:c});return Dp(jy,{getStore:()=>u}),$h(()=>{u.reset()}),n.$$set=d=>{"initialNodes"in d&&t(0,r=d.initialNodes),"initialEdges"in d&&t(1,a=d.initialEdges),"initialWidth"in d&&t(2,o=d.initialWidth),"initialHeight"in d&&t(3,l=d.initialHeight),"fitView"in d&&t(4,c=d.fitView),"nodeOrigin"in d&&t(5,h=d.nodeOrigin),"$$scope"in d&&t(6,s=d.$$scope)},[r,a,o,l,c,h,s,i]}class mre extends Nt{constructor(e){super(),Ot(this,e,gre,fre,Ft,{initialNodes:0,initialEdges:1,initialWidth:2,initialHeight:3,fitView:4,nodeOrigin:5})}}const pre=n=>({}),XS=n=>({class:"button-svg"});function bre(n){let e,t,i,s,r;const a=n[8].default,o=Xs(a,n,n[7],XS);let l=[{type:"button"},{class:t=Ri(["svelte-flow__controls-button",n[0]])},n[6]],c={};for(let h=0;h<l.length;h+=1)c=li(c,l[h]);return{c(){e=te("button"),o&&o.c(),this.h()},l(h){e=ne(h,"BUTTON",{type:!0,class:!0});var u=V(e);o&&o.l(u),u.forEach(S),this.h()},h(){Mg(e,c),rn(e,"--xy-controls-button-background-color-props",n[1]),rn(e,"--xy-controls-button-background-color-hover-props",n[2]),rn(e,"--xy-controls-button-color-props",n[3]),rn(e,"--xy-controls-button-color-hover-props",n[4]),rn(e,"--xy-controls-button-border-color-props",n[5])},m(h,u){ee(h,e,u),o&&o.m(e,null),e.autofocus&&e.focus(),i=!0,s||(r=pt(e,"click",n[9]),s=!0)},p(h,[u]){o&&o.p&&(!i||u&128)&&Ys(o,a,h,h[7],i?Zs(a,h[7],u,pre):Js(h[7]),XS),Mg(e,c=Gh(l,[{type:"button"},(!i||u&1&&t!==(t=Ri(["svelte-flow__controls-button",h[0]])))&&{class:t},u&64&&h[6]])),rn(e,"--xy-controls-button-background-color-props",h[1]),rn(e,"--xy-controls-button-background-color-hover-props",h[2]),rn(e,"--xy-controls-button-color-props",h[3]),rn(e,"--xy-controls-button-color-hover-props",h[4]),rn(e,"--xy-controls-button-border-color-props",h[5])},i(h){i||(L(o,h),i=!0)},o(h){j(o,h),i=!1},d(h){h&&S(e),o&&o.d(h),s=!1,r()}}}function xre(n,e,t){const i=["class"];let s=is(e,i),{$$slots:r={},$$scope:a}=e,{class:o=void 0}=e,l,c,h,u,d;function f(g){Yn.call(this,n,g)}return n.$$set=g=>{e=li(li({},e),gl(g)),t(6,s=is(e,i)),"class"in g&&t(0,o=g.class),"$$scope"in g&&t(7,a=g.$$scope)},[o,l,c,h,u,d,s,a,r,f]}class b5 extends Nt{constructor(e){super(),Ot(this,e,xre,bre,Ft,{class:0})}}function yre(n){let e,t;return{c(){e=nt("svg"),t=nt("path"),this.h()},l(i){e=it(i,"svg",{xmlns:!0,viewBox:!0});var s=V(e);t=it(s,"path",{d:!0}),V(t).forEach(S),s.forEach(S),this.h()},h(){A(t,"d","M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"),A(e,"xmlns","http://www.w3.org/2000/svg"),A(e,"viewBox","0 0 32 32")},m(i,s){ee(i,e,s),q(e,t)},p:kt,i:kt,o:kt,d(i){i&&S(e)}}}class wre extends Nt{constructor(e){super(),Ot(this,e,null,yre,Ft,{})}}function _re(n){let e,t;return{c(){e=nt("svg"),t=nt("path"),this.h()},l(i){e=it(i,"svg",{xmlns:!0,viewBox:!0});var s=V(e);t=it(s,"path",{d:!0}),V(t).forEach(S),s.forEach(S),this.h()},h(){A(t,"d","M0 0h32v4.2H0z"),A(e,"xmlns","http://www.w3.org/2000/svg"),A(e,"viewBox","0 0 32 5")},m(i,s){ee(i,e,s),q(e,t)},p:kt,i:kt,o:kt,d(i){i&&S(e)}}}class vre extends Nt{constructor(e){super(),Ot(this,e,null,_re,Ft,{})}}function kre(n){let e,t;return{c(){e=nt("svg"),t=nt("path"),this.h()},l(i){e=it(i,"svg",{xmlns:!0,viewBox:!0});var s=V(e);t=it(s,"path",{d:!0}),V(t).forEach(S),s.forEach(S),this.h()},h(){A(t,"d","M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"),A(e,"xmlns","http://www.w3.org/2000/svg"),A(e,"viewBox","0 0 32 30")},m(i,s){ee(i,e,s),q(e,t)},p:kt,i:kt,o:kt,d(i){i&&S(e)}}}class Cre extends Nt{constructor(e){super(),Ot(this,e,null,kre,Ft,{})}}function Are(n){let e,t;return{c(){e=nt("svg"),t=nt("path"),this.h()},l(i){e=it(i,"svg",{xmlns:!0,viewBox:!0});var s=V(e);t=it(s,"path",{d:!0}),V(t).forEach(S),s.forEach(S),this.h()},h(){A(t,"d","M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"),A(e,"xmlns","http://www.w3.org/2000/svg"),A(e,"viewBox","0 0 25 32")},m(i,s){ee(i,e,s),q(e,t)},p:kt,i:kt,o:kt,d(i){i&&S(e)}}}class Sre extends Nt{constructor(e){super(),Ot(this,e,null,Are,Ft,{})}}function Ire(n){let e,t;return{c(){e=nt("svg"),t=nt("path"),this.h()},l(i){e=it(i,"svg",{xmlns:!0,viewBox:!0});var s=V(e);t=it(s,"path",{d:!0}),V(t).forEach(S),s.forEach(S),this.h()},h(){A(t,"d","M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"),A(e,"xmlns","http://www.w3.org/2000/svg"),A(e,"viewBox","0 0 25 32")},m(i,s){ee(i,e,s),q(e,t)},p:kt,i:kt,o:kt,d(i){i&&S(e)}}}class Ere extends Nt{constructor(e){super(),Ot(this,e,null,Ire,Ft,{})}}const Tre=n=>({}),YS=n=>({}),Rre=n=>({}),JS=n=>({});function ZS(n){let e,t,i,s;const r=[{class:"svelte-flow__controls-zoomin"},{title:"zoom in"},{"aria-label":"zoom in"},{disabled:n[9]},n[17]];let a={$$slots:{default:[Mre]},$$scope:{ctx:n}};for(let c=0;c<r.length;c+=1)a=li(a,r[c]);e=new b5({props:a}),e.$on("click",n[18]);const o=[{class:"svelte-flow__controls-zoomout"},{title:"zoom out"},{"aria-label":"zoom out"},{disabled:n[10]},n[17]];let l={$$slots:{default:[Pre]},$$scope:{ctx:n}};for(let c=0;c<o.length;c+=1)l=li(l,o[c]);return i=new b5({props:l}),i.$on("click",n[19]),{c(){pe(e.$$.fragment),t=Ae(),pe(i.$$.fragment)},l(c){ye(e.$$.fragment,c),t=Se(c),ye(i.$$.fragment,c)},m(c,h){be(e,c,h),ee(c,t,h),be(i,c,h),s=!0},p(c,h){const u=h[0]&131584?Gh(r,[r[0],r[1],r[2],h[0]&512&&{disabled:c[9]},h[0]&131072&&Fp(c[17])]):{};h[1]&32&&(u.$$scope={dirty:h,ctx:c}),e.$set(u);const d=h[0]&132096?Gh(o,[o[0],o[1],o[2],h[0]&1024&&{disabled:c[10]},h[0]&131072&&Fp(c[17])]):{};h[1]&32&&(d.$$scope={dirty:h,ctx:c}),i.$set(d)},i(c){s||(L(e.$$.fragment,c),L(i.$$.fragment,c),s=!0)},o(c){j(e.$$.fragment,c),j(i.$$.fragment,c),s=!1},d(c){c&&S(t),xe(e,c),xe(i,c)}}}function Mre(n){let e,t;return e=new wre({}),{c(){pe(e.$$.fragment)},l(i){ye(e.$$.fragment,i)},m(i,s){be(e,i,s),t=!0},i(i){t||(L(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){xe(e,i)}}}function Pre(n){let e,t;return e=new vre({}),{c(){pe(e.$$.fragment)},l(i){ye(e.$$.fragment,i)},m(i,s){be(e,i,s),t=!0},i(i){t||(L(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){xe(e,i)}}}function QS(n){let e,t;const i=[{class:"svelte-flow__controls-fitview"},{title:"fit view"},{"aria-label":"fit view"},n[17]];let s={$$slots:{default:[Nre]},$$scope:{ctx:n}};for(let r=0;r<i.length;r+=1)s=li(s,i[r]);return e=new b5({props:s}),e.$on("click",n[20]),{c(){pe(e.$$.fragment)},l(r){ye(e.$$.fragment,r)},m(r,a){be(e,r,a),t=!0},p(r,a){const o=a[0]&131072?Gh(i,[i[0],i[1],i[2],Fp(r[17])]):{};a[1]&32&&(o.$$scope={dirty:a,ctx:r}),e.$set(o)},i(r){t||(L(e.$$.fragment,r),t=!0)},o(r){j(e.$$.fragment,r),t=!1},d(r){xe(e,r)}}}function Nre(n){let e,t;return e=new Cre({}),{c(){pe(e.$$.fragment)},l(i){ye(e.$$.fragment,i)},m(i,s){be(e,i,s),t=!0},i(i){t||(L(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){xe(e,i)}}}function $S(n){let e,t;const i=[{class:"svelte-flow__controls-interactive"},{title:"toggle interactivity"},{"aria-label":"toggle interactivity"},n[17]];let s={$$slots:{default:[Fre]},$$scope:{ctx:n}};for(let r=0;r<i.length;r+=1)s=li(s,i[r]);return e=new b5({props:s}),e.$on("click",n[21]),{c(){pe(e.$$.fragment)},l(r){ye(e.$$.fragment,r)},m(r,a){be(e,r,a),t=!0},p(r,a){const o=a[0]&131072?Gh(i,[i[0],i[1],i[2],Fp(r[17])]):{};a[0]&256|a[1]&32&&(o.$$scope={dirty:a,ctx:r}),e.$set(o)},i(r){t||(L(e.$$.fragment,r),t=!0)},o(r){j(e.$$.fragment,r),t=!1},d(r){xe(e,r)}}}function Ore(n){let e,t;return e=new Sre({}),{c(){pe(e.$$.fragment)},l(i){ye(e.$$.fragment,i)},m(i,s){be(e,i,s),t=!0},i(i){t||(L(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){xe(e,i)}}}function Dre(n){let e,t;return e=new Ere({}),{c(){pe(e.$$.fragment)},l(i){ye(e.$$.fragment,i)},m(i,s){be(e,i,s),t=!0},i(i){t||(L(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){xe(e,i)}}}function Fre(n){let e,t,i,s;const r=[Dre,Ore],a=[];function o(l,c){return l[8]?0:1}return e=o(n),t=a[e]=r[e](n),{c(){t.c(),i=Ut()},l(l){t.l(l),i=Ut()},m(l,c){a[e].m(l,c),ee(l,i,c),s=!0},p(l,c){let h=e;e=o(l),e!==h&&(ot(),j(a[h],1,1,()=>{a[h]=null}),lt(),t=a[e],t||(t=a[e]=r[e](l),t.c()),L(t,1),t.m(i.parentNode,i))},i(l){s||(L(t),s=!0)},o(l){j(t),s=!1},d(l){l&&S(i),a[e].d(l)}}}function Lre(n){let e,t,i,s,r,a;const o=n[35].before,l=Xs(o,n,n[36],JS);let c=n[1]&&ZS(n),h=n[2]&&QS(n),u=n[3]&&$S(n);const d=n[35].default,f=Xs(d,n,n[36],null),g=n[35].after,m=Xs(g,n,n[36],YS);return{c(){l&&l.c(),e=Ae(),c&&c.c(),t=Ae(),h&&h.c(),i=Ae(),u&&u.c(),s=Ae(),f&&f.c(),r=Ae(),m&&m.c()},l(b){l&&l.l(b),e=Se(b),c&&c.l(b),t=Se(b),h&&h.l(b),i=Se(b),u&&u.l(b),s=Se(b),f&&f.l(b),r=Se(b),m&&m.l(b)},m(b,p){l&&l.m(b,p),ee(b,e,p),c&&c.m(b,p),ee(b,t,p),h&&h.m(b,p),ee(b,i,p),u&&u.m(b,p),ee(b,s,p),f&&f.m(b,p),ee(b,r,p),m&&m.m(b,p),a=!0},p(b,p){l&&l.p&&(!a||p[1]&32)&&Ys(l,o,b,b[36],a?Zs(o,b[36],p,Rre):Js(b[36]),JS),b[1]?c?(c.p(b,p),p[0]&2&&L(c,1)):(c=ZS(b),c.c(),L(c,1),c.m(t.parentNode,t)):c&&(ot(),j(c,1,1,()=>{c=null}),lt()),b[2]?h?(h.p(b,p),p[0]&4&&L(h,1)):(h=QS(b),h.c(),L(h,1),h.m(i.parentNode,i)):h&&(ot(),j(h,1,1,()=>{h=null}),lt()),b[3]?u?(u.p(b,p),p[0]&8&&L(u,1)):(u=$S(b),u.c(),L(u,1),u.m(s.parentNode,s)):u&&(ot(),j(u,1,1,()=>{u=null}),lt()),f&&f.p&&(!a||p[1]&32)&&Ys(f,d,b,b[36],a?Zs(d,b[36],p,null):Js(b[36]),null),m&&m.p&&(!a||p[1]&32)&&Ys(m,g,b,b[36],a?Zs(g,b[36],p,Tre):Js(b[36]),YS)},i(b){a||(L(l,b),L(c),L(h),L(u),L(f,b),L(m,b),a=!0)},o(b){j(l,b),j(c),j(h),j(u),j(f,b),j(m,b),a=!1},d(b){b&&(S(e),S(t),S(i),S(s),S(r)),l&&l.d(b),c&&c.d(b),h&&h.d(b),u&&u.d(b),f&&f.d(b),m&&m.d(b)}}}function Bre(n){let e,t;return e=new cD({props:{class:Ri(["svelte-flow__controls",n[7],n[6]]),position:n[0],"data-testid":"svelte-flow__controls","aria-label":n[4]??"Svelte Flow controls",style:n[5],$$slots:{default:[Lre]},$$scope:{ctx:n}}}),{c(){pe(e.$$.fragment)},l(i){ye(e.$$.fragment,i)},m(i,s){be(e,i,s),t=!0},p(i,s){const r={};s[0]&192&&(r.class=Ri(["svelte-flow__controls",i[7],i[6]])),s[0]&1&&(r.position=i[0]),s[0]&16&&(r["aria-label"]=i[4]??"Svelte Flow controls"),s[0]&32&&(r.style=i[5]),s[0]&1806|s[1]&32&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(L(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){xe(e,i)}}}function Ure(n,e,t){let i,s,r,a,o,l,c,h,u,d,{$$slots:f={},$$scope:g}=e,{position:m="bottom-left"}=e,{showZoom:b=!0}=e,{showFitView:p=!0}=e,{showLock:y=!0}=e,{buttonBgColor:w=void 0}=e,{buttonBgColorHover:_=void 0}=e,{buttonColor:v=void 0}=e,{buttonColorHover:C=void 0}=e,{buttonBorderColor:k=void 0}=e,{ariaLabel:I=void 0}=e,{style:E=void 0}=e,{orientation:T="vertical"}=e,{fitViewOptions:M=void 0}=e,{class:D=""}=e;const{zoomIn:H,zoomOut:R,fitView:z,viewport:P,minZoom:B,maxZoom:Z,nodesDraggable:G,nodesConnectable:Y,elementsSelectable:J}=rs();Pe(n,P,N=>t(30,l=N)),Pe(n,B,N=>t(31,c=N)),Pe(n,Z,N=>t(29,o=N)),Pe(n,G,N=>t(34,d=N)),Pe(n,Y,N=>t(33,u=N)),Pe(n,J,N=>t(32,h=N));const se={bgColor:w,bgColorHover:_,color:v,colorHover:C,borderColor:k},fe=()=>{H()},he=()=>{R()},de=()=>{z(M)},ge=()=>{t(8,i=!i),G.set(i),Y.set(i),J.set(i)};return n.$$set=N=>{"position"in N&&t(0,m=N.position),"showZoom"in N&&t(1,b=N.showZoom),"showFitView"in N&&t(2,p=N.showFitView),"showLock"in N&&t(3,y=N.showLock),"buttonBgColor"in N&&t(22,w=N.buttonBgColor),"buttonBgColorHover"in N&&t(23,_=N.buttonBgColorHover),"buttonColor"in N&&t(24,v=N.buttonColor),"buttonColorHover"in N&&t(25,C=N.buttonColorHover),"buttonBorderColor"in N&&t(26,k=N.buttonBorderColor),"ariaLabel"in N&&t(4,I=N.ariaLabel),"style"in N&&t(5,E=N.style),"orientation"in N&&t(27,T=N.orientation),"fitViewOptions"in N&&t(28,M=N.fitViewOptions),"class"in N&&t(6,D=N.class),"$$scope"in N&&t(36,g=N.$$scope)},n.$$.update=()=>{n.$$.dirty[1]&14&&t(8,i=d||u||h),n.$$.dirty[0]&1073741824|n.$$.dirty[1]&1&&t(10,s=l.zoom<=c),n.$$.dirty[0]&1610612736&&t(9,r=l.zoom>=o),n.$$.dirty[0]&134217728&&t(7,a=T==="horizontal"?"horizontal":"vertical")},[m,b,p,y,I,E,D,a,i,r,s,P,B,Z,G,Y,J,se,fe,he,de,ge,w,_,v,C,k,T,M,o,l,c,h,u,d,f,g]}let Hre=class extends Nt{constructor(e){super(),Ot(this,e,Ure,Bre,Ft,{position:0,showZoom:1,showFitView:2,showLock:3,buttonBgColor:22,buttonBgColorHover:23,buttonColor:24,buttonColorHover:25,buttonBorderColor:26,ariaLabel:4,style:5,orientation:27,fitViewOptions:28,class:6},null,[-1,-1])}};var y0;(function(n){n.Lines="lines",n.Dots="dots",n.Cross="cross"})(y0||(y0={}));function zre(n){let e,t;return{c(){e=nt("circle"),this.h()},l(i){e=it(i,"circle",{cx:!0,cy:!0,r:!0,class:!0}),V(e).forEach(S),this.h()},h(){A(e,"cx",n[0]),A(e,"cy",n[0]),A(e,"r",n[0]),A(e,"class",t=Ri(["svelte-flow__background-pattern","dots",n[1]]))},m(i,s){ee(i,e,s)},p(i,[s]){s&1&&A(e,"cx",i[0]),s&1&&A(e,"cy",i[0]),s&1&&A(e,"r",i[0]),s&2&&t!==(t=Ri(["svelte-flow__background-pattern","dots",i[1]]))&&A(e,"class",t)},i:kt,o:kt,d(i){i&&S(e)}}}function jre(n,e,t){let{radius:i=5}=e,{class:s=""}=e;return n.$$set=r=>{"radius"in r&&t(0,i=r.radius),"class"in r&&t(1,s=r.class)},[i,s]}class Gre extends Nt{constructor(e){super(),Ot(this,e,jre,zre,Ft,{radius:0,class:1})}}function Vre(n){let e,t,i;return{c(){e=nt("path"),this.h()},l(s){e=it(s,"path",{"stroke-width":!0,d:!0,class:!0}),V(e).forEach(S),this.h()},h(){A(e,"stroke-width",n[0]),A(e,"d",t=`M${n[1][0]/2} 0 V${n[1][1]} M0 ${n[1][1]/2} H${n[1][0]}`),A(e,"class",i=Ri(["svelte-flow__background-pattern",n[2],n[3]]))},m(s,r){ee(s,e,r)},p(s,[r]){r&1&&A(e,"stroke-width",s[0]),r&2&&t!==(t=`M${s[1][0]/2} 0 V${s[1][1]} M0 ${s[1][1]/2} H${s[1][0]}`)&&A(e,"d",t),r&12&&i!==(i=Ri(["svelte-flow__background-pattern",s[2],s[3]]))&&A(e,"class",i)},i:kt,o:kt,d(s){s&&S(e)}}}function qre(n,e,t){let{lineWidth:i=1}=e,{dimensions:s}=e,{variant:r=void 0}=e,{class:a=""}=e;return n.$$set=o=>{"lineWidth"in o&&t(0,i=o.lineWidth),"dimensions"in o&&t(1,s=o.dimensions),"variant"in o&&t(2,r=o.variant),"class"in o&&t(3,a=o.class)},[i,s,r,a]}class Wre extends Nt{constructor(e){super(),Ot(this,e,qre,Vre,Ft,{lineWidth:0,dimensions:1,variant:2,class:3})}}function Kre(n){let e,t;return e=new Wre({props:{dimensions:n[6],variant:n[0],lineWidth:n[1],class:n[4]}}),{c(){pe(e.$$.fragment)},l(i){ye(e.$$.fragment,i)},m(i,s){be(e,i,s),t=!0},p(i,s){const r={};s&64&&(r.dimensions=i[6]),s&1&&(r.variant=i[0]),s&2&&(r.lineWidth=i[1]),s&16&&(r.class=i[4]),e.$set(r)},i(i){t||(L(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){xe(e,i)}}}function Xre(n){let e,t;return e=new Gre({props:{radius:n[7]/2,class:n[4]}}),{c(){pe(e.$$.fragment)},l(i){ye(e.$$.fragment,i)},m(i,s){be(e,i,s),t=!0},p(i,s){const r={};s&128&&(r.radius=i[7]/2),s&16&&(r.class=i[4]),e.$set(r)},i(i){t||(L(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){xe(e,i)}}}function Yre(n){let e,t,i,s,r,a,o,l,c,h,u,d,f;const g=[Xre,Kre],m=[];function b(p,y){return p[14]?0:1}return i=b(n),s=m[i]=g[i](n),{c(){e=nt("svg"),t=nt("pattern"),s.c(),h=nt("rect"),this.h()},l(p){e=it(p,"svg",{class:!0,"data-testid":!0});var y=V(e);t=it(y,"pattern",{id:!0,x:!0,y:!0,width:!0,height:!0,patternUnits:!0,patternTransform:!0});var w=V(t);s.l(w),w.forEach(S),h=it(y,"rect",{x:!0,y:!0,width:!0,height:!0,fill:!0}),V(h).forEach(S),y.forEach(S),this.h()},h(){A(t,"id",n[11]),A(t,"x",r=n[9].x%n[8][0]),A(t,"y",a=n[9].y%n[8][1]),A(t,"width",o=n[8][0]),A(t,"height",l=n[8][1]),A(t,"patternUnits","userSpaceOnUse"),A(t,"patternTransform",c=`translate(-${n[10][0]},-${n[10][1]})`),A(h,"x","0"),A(h,"y","0"),A(h,"width","100%"),A(h,"height","100%"),A(h,"fill",u=`url(#${n[11]})`),A(e,"class",d=dv(Ri(["svelte-flow__background",n[5]]))+" svelte-1r7pe8d"),A(e,"data-testid","svelte-flow__background"),rn(e,"--xy-background-color-props",n[2]),rn(e,"--xy-background-pattern-color-props",n[3])},m(p,y){ee(p,e,y),q(e,t),m[i].m(t,null),q(e,h),f=!0},p(p,[y]){s.p(p,y),(!f||y&2048)&&A(t,"id",p[11]),(!f||y&768&&r!==(r=p[9].x%p[8][0]))&&A(t,"x",r),(!f||y&768&&a!==(a=p[9].y%p[8][1]))&&A(t,"y",a),(!f||y&256&&o!==(o=p[8][0]))&&A(t,"width",o),(!f||y&256&&l!==(l=p[8][1]))&&A(t,"height",l),(!f||y&1024&&c!==(c=`translate(-${p[10][0]},-${p[10][1]})`))&&A(t,"patternTransform",c),(!f||y&2048&&u!==(u=`url(#${p[11]})`))&&A(h,"fill",u),(!f||y&32&&d!==(d=dv(Ri(["svelte-flow__background",p[5]]))+" svelte-1r7pe8d"))&&A(e,"class",d),y&4&&rn(e,"--xy-background-color-props",p[2]),y&8&&rn(e,"--xy-background-pattern-color-props",p[3])},i(p){f||(L(s),f=!0)},o(p){j(s),f=!1},d(p){p&&S(e),m[i].d()}}}const Jre={[y0.Dots]:1,[y0.Lines]:1,[y0.Cross]:6};function Zre(n,e,t){let i,s,r,a,o,l,c,{id:h=void 0}=e,{variant:u=y0.Dots}=e,{gap:d=20}=e,{size:f=1}=e,{lineWidth:g=1}=e,{bgColor:m=void 0}=e,{patternColor:b=void 0}=e,{patternClass:p=void 0}=e,{class:y=""}=e;const{viewport:w,flowId:_}=rs();Pe(n,w,E=>t(9,l=E)),Pe(n,_,E=>t(18,c=E));const v=f||Jre[u],C=u===y0.Dots,k=u===y0.Cross,I=Array.isArray(d)?d:[d,d];return n.$$set=E=>{"id"in E&&t(15,h=E.id),"variant"in E&&t(0,u=E.variant),"gap"in E&&t(16,d=E.gap),"size"in E&&t(17,f=E.size),"lineWidth"in E&&t(1,g=E.lineWidth),"bgColor"in E&&t(2,m=E.bgColor),"patternColor"in E&&t(3,b=E.patternColor),"patternClass"in E&&t(4,p=E.patternClass),"class"in E&&t(5,y=E.class)},n.$$.update=()=>{n.$$.dirty&294912&&t(11,i=`background-pattern-${c}-${h||""}`),n.$$.dirty&512&&t(8,s=[I[0]*l.zoom||1,I[1]*l.zoom||1]),n.$$.dirty&512&&t(7,r=v*l.zoom),n.$$.dirty&384&&t(6,a=k?[r,r]:s),n.$$.dirty&192&&t(10,o=C?[r/2,r/2]:[a[0]/2,a[1]/2])},[u,g,m,b,p,y,a,r,s,l,o,i,w,_,C,h,d,f,c]}class Qre extends Nt{constructor(e){super(),Ot(this,e,Zre,Yre,Ft,{id:15,variant:0,gap:16,size:17,lineWidth:1,bgColor:2,patternColor:3,patternClass:4,class:5})}}const eI=n=>xne(n);function $re(){const{zoomIn:n,zoomOut:e,fitView:t,onbeforedelete:i,snapGrid:s,viewport:r,width:a,height:o,minZoom:l,maxZoom:c,panZoom:h,nodes:u,edges:d,domNode:f,nodeLookup:g,nodeOrigin:m,edgeLookup:b,connectionLookup:p}=rs(),y=v=>{var T,M;const C=Ye(g),k=eI(v)?v:C.get(v.id),I=k.parentId?kne(k.position,k.measured,k.parentId,C,Ye(m)):k.position,E={id:k.id,position:I,width:((T=k.measured)==null?void 0:T.width)??k.width,height:((M=k.measured)==null?void 0:M.height)??k.height,data:k.data};return Xg(E)},w=(v,C,k={replace:!1})=>{var T;const I=(T=Ye(g).get(v))==null?void 0:T.internals.userNode;if(!I)return;const E=typeof C=="function"?C(I):C;k.replace?u.update(M=>M.map(D=>D.id===v?eI(E)?E:{...D,...E}:D)):(Object.assign(I,E),u.update(M=>M))},_=v=>Ye(g).get(v);return{zoomIn:n,zoomOut:e,getInternalNode:_,getNode:v=>{var C;return(C=_(v))==null?void 0:C.internals.userNode},getNodes:v=>v===void 0?Ye(u):tI(Ye(g),v),getEdge:v=>Ye(b).get(v),getEdges:v=>v===void 0?Ye(d):tI(Ye(b),v),setZoom:(v,C)=>{const k=Ye(h);return k?k.scaleTo(v,{duration:C==null?void 0:C.duration}):Promise.resolve(!1)},getZoom:()=>Ye(r).zoom,setViewport:async(v,C)=>{const k=Ye(r),I=Ye(h);return I?(await I.setViewport({x:v.x??k.x,y:v.y??k.y,zoom:v.zoom??k.zoom},{duration:C==null?void 0:C.duration}),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>Ye(r),setCenter:async(v,C,k)=>{const I=typeof(k==null?void 0:k.zoom)<"u"?k.zoom:Ye(c),E=Ye(h);return E?(await E.setViewport({x:Ye(a)/2-v*I,y:Ye(o)/2-C*I,zoom:I},{duration:k==null?void 0:k.duration}),Promise.resolve(!0)):Promise.resolve(!1)},fitView:t,fitBounds:async(v,C)=>{const k=Ye(h);if(!k)return Promise.resolve(!1);const I=J_(v,Ye(a),Ye(o),Ye(l),Ye(c),(C==null?void 0:C.padding)??.1);return await k.setViewport(I,{duration:C==null?void 0:C.duration}),Promise.resolve(!0)},getIntersectingNodes:(v,C=!0,k)=>{const I=bS(v),E=I?v:y(v);return E?(k||Ye(u)).filter(T=>{const M=Ye(g).get(T.id);if(!M||!I&&T.id===v.id)return!1;const D=Xg(M),H=d2(D,E);return C&&H>0||H>=E.width*E.height}):[]},isNodeIntersecting:(v,C,k=!0)=>{const E=bS(v)?v:y(v);if(!E)return!1;const T=d2(E,C);return k&&T>0||T>=E.width*E.height},deleteElements:async({nodes:v=[],edges:C=[]})=>{const{nodes:k,edges:I}=await PO({nodesToRemove:v,edgesToRemove:C,nodes:Ye(u),edges:Ye(d),onBeforeDelete:Ye(i)});return k&&u.update(E=>E.filter(T=>!k.some(({id:M})=>M===T.id))),I&&d.update(E=>E.filter(T=>!I.some(({id:M})=>M===T.id))),{deletedNodes:k,deletedEdges:I}},screenToFlowPosition:(v,C={snapToGrid:!0})=>{const k=Ye(f);if(!k)return v;const I=C.snapToGrid?Ye(s):!1,{x:E,y:T,zoom:M}=Ye(r),{x:D,y:H}=k.getBoundingClientRect(),R={x:v.x-D,y:v.y-H};return Px(R,[E,T,M],I!==null,I||[1,1])},flowToScreenPosition:v=>{const C=Ye(f);if(!C)return v;const{x:k,y:I,zoom:E}=Ye(r),{x:T,y:M}=C.getBoundingClientRect(),D=DO(v,[k,I,E]);return{x:D.x+T,y:D.y+M}},toObject:()=>({nodes:Ye(u).map(v=>({...v,position:{...v.position},data:{...v.data}})),edges:Ye(d).map(v=>({...v})),viewport:{...Ye(r)}}),updateNode:w,updateNodeData:(v,C,k)=>{var T;const I=(T=Ye(g).get(v))==null?void 0:T.internals.userNode;if(!I)return;const E=typeof C=="function"?C(I):C;I.data=k!=null&&k.replace?E:{...I.data,...E},u.update(M=>M)},getNodesBounds:v=>{const C=Ye(g),k=Ye(m);return yne(v,{nodeLookup:C,nodeOrigin:k})},getHandleConnections:({type:v,id:C,nodeId:k})=>{var I;return Array.from(((I=Ye(p).get(`${k}-${v}-${C??null}`))==null?void 0:I.values())??[])},viewport:r}}function tI(n,e){var i;const t=[];for(const s of e){const r=n.get(s);if(r){const a="internals"in r?(i=r.internals)==null?void 0:i.userNode:r;t.push(a)}}return t}function eae(){const{nodesInitialized:n}=rs();return{subscribe:n.subscribe}}function nI(n,e,t){const i=n.slice();return i[25]=e[t],i[27]=t,i}function iI(n,e,t){const i=n.slice();return i[22]=e[t],i[24]=t,i}function tae(n){let e,t;return e=new f4({props:{className:"size-4"}}),{c(){pe(e.$$.fragment)},l(i){ye(e.$$.fragment,i)},m(i,s){be(e,i,s),t=!0},p:kt,i(i){t||(L(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){xe(e,i)}}}function nae(n){let e,t,i,s,r,a,o,l=n[8].t("Tools")+"",c,h,u=n[8].t("Functions")+"",d,f,g,m,b,p,y,w;function _(I,E){if(I[1]==="tools")return sae;if(I[1]==="functions")return iae}let v=_(n),C=v&&v(n),k=n[2]&&aI(n);return{c(){e=te("form"),t=te("div"),i=te("div"),s=te("div"),r=te("div"),a=te("select"),o=te("option"),c=_t(l),h=te("option"),d=_t(u),f=Ae(),g=te("div"),m=te("select"),C&&C.c(),b=Ae(),k&&k.c(),this.h()},l(I){e=ne(I,"FORM",{class:!0});var E=V(e);t=ne(E,"DIV",{class:!0});var T=V(t);i=ne(T,"DIV",{class:!0});var M=V(i);s=ne(M,"DIV",{class:!0});var D=V(s);r=ne(D,"DIV",{class:!0});var H=V(r);a=ne(H,"SELECT",{class:!0,placeholder:!0});var R=V(a);o=ne(R,"OPTION",{class:!0});var z=V(o);c=vt(z,l),z.forEach(S),h=ne(R,"OPTION",{class:!0});var P=V(h);d=vt(P,u),P.forEach(S),R.forEach(S),H.forEach(S),f=Se(D),g=ne(D,"DIV",{class:!0});var B=V(g);m=ne(B,"SELECT",{class:!0});var Z=V(m);C&&C.l(Z),Z.forEach(S),B.forEach(S),D.forEach(S),M.forEach(S),b=Se(T),k&&k.l(T),T.forEach(S),E.forEach(S),this.h()},h(){o.__value="tools",So(o,o.__value),A(o,"class","bg-gray-100 dark:bg-gray-800"),h.__value="functions",So(h,h.__value),A(h,"class","bg-gray-100 dark:bg-gray-800"),A(a,"class","w-full rounded-sm text-xs py-2 px-1 bg-transparent outline-hidden"),A(a,"placeholder","Select"),n[1]===void 0&&h0(()=>n[13].call(a)),A(r,"class","flex-1"),A(m,"class","w-full rounded-sm py-2 px-1 text-xs bg-transparent outline-hidden"),n[2]===void 0&&h0(()=>n[14].call(m)),A(g,"class","flex-1"),A(s,"class","flex gap-2"),A(i,"class","space-y-1"),A(t,"class","flex flex-col"),A(e,"class","flex flex-col h-full justify-between space-y-3 text-sm")},m(I,E){ee(I,e,E),q(e,t),q(t,i),q(i,s),q(s,r),q(r,a),q(a,o),q(o,c),q(a,h),q(h,d),Ox(a,n[1],!0),q(s,f),q(s,g),q(g,m),C&&C.m(m,null),Ox(m,n[2],!0),q(t,b),k&&k.m(t,null),p=!0,y||(w=[pt(a,"change",n[13]),pt(m,"change",n[14]),pt(m,"change",n[15]),pt(e,"submit",Zg(n[18]))],y=!0)},p(I,E){(!p||E&256)&&l!==(l=I[8].t("Tools")+"")&&St(c,l),(!p||E&256)&&u!==(u=I[8].t("Functions")+"")&&St(d,u),E&2&&Ox(a,I[1]),v===(v=_(I))&&C?C.p(I,E):(C&&C.d(1),C=v&&v(I),C&&(C.c(),C.m(m,null))),E&196&&Ox(m,I[2]),I[2]?k?(k.p(I,E),E&4&&L(k,1)):(k=aI(I),k.c(),L(k,1),k.m(t,null)):k&&(ot(),j(k,1,1,()=>{k=null}),lt())},i(I){p||(L(k),p=!0)},o(I){j(k),p=!1},d(I){I&&S(e),C&&C.d(),k&&k.d(),y=!1,ia(w)}}}function iae(n){let e,t=n[8].t("Select a function")+"",i,s,r=Qn(n[7]),a=[];for(let o=0;o<r.length;o+=1)a[o]=sI(nI(n,r,o));return{c(){e=te("option"),i=_t(t);for(let o=0;o<a.length;o+=1)a[o].c();s=Ut(),this.h()},l(o){e=ne(o,"OPTION",{class:!0});var l=V(e);i=vt(l,t),l.forEach(S);for(let c=0;c<a.length;c+=1)a[c].l(o);s=Ut(),this.h()},h(){e.__value="",So(e,e.__value),e.selected=!0,e.disabled=!0,A(e,"class","bg-gray-100 dark:bg-gray-800")},m(o,l){ee(o,e,l),q(e,i);for(let c=0;c<a.length;c+=1)a[c]&&a[c].m(o,l);ee(o,s,l)},p(o,l){if(l&256&&t!==(t=o[8].t("Select a function")+"")&&St(i,t),l&128){r=Qn(o[7]);let c;for(c=0;c<r.length;c+=1){const h=nI(o,r,c);a[c]?a[c].p(h,l):(a[c]=sI(h),a[c].c(),a[c].m(s.parentNode,s))}for(;c<a.length;c+=1)a[c].d(1);a.length=r.length}},d(o){o&&(S(e),S(s)),To(a,o)}}}function sae(n){let e,t=n[8].t("Select a tool")+"",i,s,r=Qn(n[6]),a=[];for(let o=0;o<r.length;o+=1)a[o]=rI(iI(n,r,o));return{c(){e=te("option"),i=_t(t);for(let o=0;o<a.length;o+=1)a[o].c();s=Ut(),this.h()},l(o){e=ne(o,"OPTION",{class:!0});var l=V(e);i=vt(l,t),l.forEach(S);for(let c=0;c<a.length;c+=1)a[c].l(o);s=Ut(),this.h()},h(){e.__value="",So(e,e.__value),e.selected=!0,e.disabled=!0,A(e,"class","bg-gray-100 dark:bg-gray-800")},m(o,l){ee(o,e,l),q(e,i);for(let c=0;c<a.length;c+=1)a[c]&&a[c].m(o,l);ee(o,s,l)},p(o,l){if(l&256&&t!==(t=o[8].t("Select a tool")+"")&&St(i,t),l&64){r=Qn(o[6]);let c;for(c=0;c<r.length;c+=1){const h=iI(o,r,c);a[c]?a[c].p(h,l):(a[c]=rI(h),a[c].c(),a[c].m(s.parentNode,s))}for(;c<a.length;c+=1)a[c].d(1);a.length=r.length}},d(o){o&&(S(e),S(s)),To(a,o)}}}function sI(n){let e,t=n[25].name+"",i,s;return{c(){e=te("option"),i=_t(t),this.h()},l(r){e=ne(r,"OPTION",{class:!0});var a=V(e);i=vt(a,t),a.forEach(S),this.h()},h(){e.__value=s=n[25].id,So(e,e.__value),A(e,"class","bg-gray-100 dark:bg-gray-800")},m(r,a){ee(r,e,a),q(e,i)},p(r,a){a&128&&t!==(t=r[25].name+"")&&St(i,t),a&128&&s!==(s=r[25].id)&&(e.__value=s,So(e,e.__value))},d(r){r&&S(e)}}}function rI(n){let e,t=n[22].name+"",i,s;return{c(){e=te("option"),i=_t(t),this.h()},l(r){e=ne(r,"OPTION",{class:!0});var a=V(e);i=vt(a,t),a.forEach(S),this.h()},h(){e.__value=s=n[22].id,So(e,e.__value),A(e,"class","bg-gray-100 dark:bg-gray-800")},m(r,a){ee(r,e,a),q(e,i)},p(r,a){a&64&&t!==(t=r[22].name+"")&&St(i,t),a&64&&s!==(s=r[22].id)&&(e.__value=s,So(e,e.__value))},d(r){r&&S(e)}}}function aI(n){let e,t,i,s,r,a;const o=[aae,rae],l=[];function c(h,u){return h[3]?1:0}return s=c(n),r=l[s]=o[s](n),{c(){e=te("hr"),t=Ae(),i=te("div"),r.c(),this.h()},l(h){e=ne(h,"HR",{class:!0}),t=Se(h),i=ne(h,"DIV",{class:!0});var u=V(i);r.l(u),u.forEach(S),this.h()},h(){A(e,"class","border-gray-50 dark:border-gray-800 my-1 w-full"),A(i,"class","my-2 text-xs")},m(h,u){ee(h,e,u),ee(h,t,u),ee(h,i,u),l[s].m(i,null),a=!0},p(h,u){let d=s;s=c(h),s===d?l[s].p(h,u):(ot(),j(l[d],1,1,()=>{l[d]=null}),lt(),r=l[s],r?r.p(h,u):(r=l[s]=o[s](h),r.c()),L(r,1),r.m(i,null))},i(h){a||(L(r),a=!0)},o(h){j(r),a=!1},d(h){h&&(S(e),S(t),S(i)),l[s].d()}}}function rae(n){let e,t;return e=new f4({props:{className:"size-5"}}),{c(){pe(e.$$.fragment)},l(i){ye(e.$$.fragment,i)},m(i,s){be(e,i,s),t=!0},p:kt,i(i){t||(L(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){xe(e,i)}}}function aae(n){let e,t,i;function s(a){n[16](a)}let r={valvesSpec:n[4]};return n[5]!==void 0&&(r.valves=n[5]),e=new QF({props:r}),At.push(()=>qt(e,"valves",s)),e.$on("change",n[17]),{c(){pe(e.$$.fragment)},l(a){ye(e.$$.fragment,a)},m(a,o){be(e,a,o),i=!0},p(a,o){const l={};o&16&&(l.valvesSpec=a[4]),!t&&o&32&&(t=!0,l.valves=a[5],Wt(()=>t=!1)),e.$set(l)},i(a){i||(L(e.$$.fragment,a),i=!0)},o(a){j(e.$$.fragment,a),i=!1},d(a){xe(e,a)}}}function oae(n){let e,t,i,s;const r=[nae,tae],a=[];function o(l,c){return l[0]&&!l[3]?0:1}return e=o(n),t=a[e]=r[e](n),{c(){t.c(),i=Ut()},l(l){t.l(l),i=Ut()},m(l,c){a[e].m(l,c),ee(l,i,c),s=!0},p(l,[c]){let h=e;e=o(l),e===h?a[e].p(l,c):(ot(),j(a[h],1,1,()=>{a[h]=null}),lt(),t=a[e],t?t.p(l,c):(t=a[e]=r[e](l),t.c()),L(t,1),t.m(i.parentNode,i))},i(l){s||(L(t),s=!0)},o(l){j(t),s=!1},d(l){l&&S(i),a[e].d(l)}}}function lae(n,e,t){let i,s,r;Pe(n,Jd,E=>t(6,i=E)),Pe(n,bv,E=>t(7,s=E));const a=eo(),o=hs("i18n");Pe(n,o,E=>t(8,r=E));let{show:l=!1}=e,c="tools",h="",u=!1,d=null,f={},g;const m=async()=>{g&&clearTimeout(g),g=setTimeout(()=>{p()},500)},b=async()=>{var E;if(t(3,u=!0),c==="tools"?(t(5,f=await bF(localStorage.token,h)),t(4,d=await xF(localStorage.token,h))):c==="functions"&&(t(5,f=await YF(localStorage.token,h)),t(4,d=await JF(localStorage.token,h))),d)for(const T in d.properties)((E=d.properties[T])==null?void 0:E.type)==="array"&&t(5,f[T]=(f[T]??[]).join(","),f);t(3,u=!1)},p=async()=>{var E;if(d){for(const T in d.properties)((E=d.properties[T])==null?void 0:E.type)==="array"&&t(5,f[T]=(f[T]??"").split(",").map(M=>M.trim()),f);if(c==="tools"){const T=await yF(localStorage.token,h,f).catch(M=>(Jt.error(`${M}`),null));T&&(Jt.success(r.t("Valves updated")),t(5,f=T))}else if(c==="functions"){const T=await ZF(localStorage.token,h,f).catch(M=>(Jt.error(`${M}`),null));T&&(Jt.success(r.t("Valves updated")),t(5,f=T))}}},y=async()=>{t(3,u=!0),s===null&&bv.set(await XF(localStorage.token)),i===null&&Jd.set(await c4(localStorage.token)),t(3,u=!1)};function w(){c=fv(this),t(1,c)}function _(){h=fv(this),t(2,h),t(1,c)}const v=async()=>{await hn()};function C(E){f=E,t(5,f)}const k=()=>{m()},I=()=>{p(),a("save")};return n.$$set=E=>{"show"in E&&t(0,l=E.show)},n.$$.update=()=>{n.$$.dirty&2&&c&&t(2,h=""),n.$$.dirty&4&&h&&b(),n.$$.dirty&1&&l&&y()},[l,c,h,u,d,f,i,s,r,a,o,m,p,w,_,v,C,k,I]}class cae extends Nt{constructor(e){super(),Ot(this,e,lae,oae,Ft,{show:0})}}function oI(n,e,t){const i=n.slice();return i[15]=e[t],i[17]=t,i}function lI(n){var h,u,d,f,g,m,b,p,y;let e,t,i,s,r,a=n[0].length>0&&cI(n),o=(((h=n[4])==null?void 0:h.role)==="admin"||(((d=(u=n[4])==null?void 0:u.permissions.chat)==null?void 0:d.valves)??!0))&&uI(n),l=(((f=n[4])==null?void 0:f.role)==="admin"||(((m=(g=n[4])==null?void 0:g.permissions.chat)==null?void 0:m.system_prompt)??!0))&&dI(n),c=(((b=n[4])==null?void 0:b.role)==="admin"||(((y=(p=n[4])==null?void 0:p.permissions.chat)==null?void 0:y.params)??!0))&&fI(n);return{c(){e=te("div"),a&&a.c(),t=Ae(),o&&o.c(),i=Ae(),l&&l.c(),s=Ae(),c&&c.c(),this.h()},l(w){e=ne(w,"DIV",{class:!0});var _=V(e);a&&a.l(_),t=Se(_),o&&o.l(_),i=Se(_),l&&l.l(_),s=Se(_),c&&c.l(_),_.forEach(S),this.h()},h(){A(e,"class","dark:text-gray-200 text-sm font-primary py-0.5 px-0.5")},m(w,_){ee(w,e,_),a&&a.m(e,null),q(e,t),o&&o.m(e,null),q(e,i),l&&l.m(e,null),q(e,s),c&&c.m(e,null),r=!0},p(w,_){var v,C,k,I,E,T,M,D,H;w[0].length>0?a?(a.p(w,_),_&1&&L(a,1)):(a=cI(w),a.c(),L(a,1),a.m(e,t)):a&&(ot(),j(a,1,1,()=>{a=null}),lt()),((v=w[4])==null?void 0:v.role)==="admin"||(((k=(C=w[4])==null?void 0:C.permissions.chat)==null?void 0:k.valves)??!0)?o?(o.p(w,_),_&16&&L(o,1)):(o=uI(w),o.c(),L(o,1),o.m(e,i)):o&&(ot(),j(o,1,1,()=>{o=null}),lt()),((I=w[4])==null?void 0:I.role)==="admin"||(((T=(E=w[4])==null?void 0:E.permissions.chat)==null?void 0:T.system_prompt)??!0)?l?(l.p(w,_),_&16&&L(l,1)):(l=dI(w),l.c(),L(l,1),l.m(e,s)):l&&(ot(),j(l,1,1,()=>{l=null}),lt()),((M=w[4])==null?void 0:M.role)==="admin"||(((H=(D=w[4])==null?void 0:D.permissions.chat)==null?void 0:H.params)??!0)?c?(c.p(w,_),_&16&&L(c,1)):(c=fI(w),c.c(),L(c,1),c.m(e,null)):c&&(ot(),j(c,1,1,()=>{c=null}),lt())},i(w){r||(L(a),L(o),L(l),L(c),r=!0)},o(w){j(a),j(o),j(l),j(c),r=!1},d(w){w&&S(e),a&&a.d(),o&&o.d(),l&&l.d(),c&&c.d()}}}function cI(n){let e,t,i,s;return e=new Qg({props:{title:n[3].t("Files"),open:!0,buttonClassName:"w-full",$$slots:{content:[hae]},$$scope:{ctx:n}}}),{c(){pe(e.$$.fragment),t=Ae(),i=te("hr"),this.h()},l(r){ye(e.$$.fragment,r),t=Se(r),i=ne(r,"HR",{class:!0}),this.h()},h(){A(i,"class","my-2 border-gray-50 dark:border-gray-700/10")},m(r,a){be(e,r,a),ee(r,t,a),ee(r,i,a),s=!0},p(r,a){const o={};a&8&&(o.title=r[3].t("Files")),a&262145&&(o.$$scope={dirty:a,ctx:r}),e.$set(o)},i(r){s||(L(e.$$.fragment,r),s=!0)},o(r){j(e.$$.fragment,r),s=!1},d(r){r&&(S(t),S(i)),xe(e,r)}}}function hI(n){var r,a;let e,t;function i(){return n[10](n[17])}function s(){return n[11](n[15])}return e=new JI({props:{className:"w-full",item:n[15],edit:!0,url:(r=n[15])!=null&&r.url?n[15].url:null,name:n[15].name,type:n[15].type,size:(a=n[15])==null?void 0:a.size,dismissible:!0}}),e.$on("dismiss",i),e.$on("click",s),{c(){pe(e.$$.fragment)},l(o){ye(e.$$.fragment,o)},m(o,l){be(e,o,l),t=!0},p(o,l){var h,u;n=o;const c={};l&1&&(c.item=n[15]),l&1&&(c.url=(h=n[15])!=null&&h.url?n[15].url:null),l&1&&(c.name=n[15].name),l&1&&(c.type=n[15].type),l&1&&(c.size=(u=n[15])==null?void 0:u.size),e.$set(c)},i(o){t||(L(e.$$.fragment,o),t=!0)},o(o){j(e.$$.fragment,o),t=!1},d(o){xe(e,o)}}}function hae(n){let e,t,i=Qn(n[0]),s=[];for(let a=0;a<i.length;a+=1)s[a]=hI(oI(n,i,a));const r=a=>j(s[a],1,1,()=>{s[a]=null});return{c(){e=te("div");for(let a=0;a<s.length;a+=1)s[a].c();this.h()},l(a){e=ne(a,"DIV",{class:!0,slot:!0});var o=V(e);for(let l=0;l<s.length;l+=1)s[l].l(o);o.forEach(S),this.h()},h(){A(e,"class","flex flex-col gap-1 mt-1.5"),A(e,"slot","content")},m(a,o){ee(a,e,o);for(let l=0;l<s.length;l+=1)s[l]&&s[l].m(e,null);t=!0},p(a,o){if(o&1){i=Qn(a[0]);let l;for(l=0;l<i.length;l+=1){const c=oI(a,i,l);s[l]?(s[l].p(c,o),L(s[l],1)):(s[l]=hI(c),s[l].c(),L(s[l],1),s[l].m(e,null))}for(ot(),l=i.length;l<s.length;l+=1)r(l);lt()}},i(a){if(!t){for(let o=0;o<i.length;o+=1)L(s[o]);t=!0}},o(a){s=s.filter(Boolean);for(let o=0;o<s.length;o+=1)j(s[o]);t=!1},d(a){a&&S(e),To(s,a)}}}function uI(n){let e,t,i,s,r;function a(l){n[12](l)}let o={title:n[3].t("Valves"),buttonClassName:"w-full",$$slots:{content:[uae]},$$scope:{ctx:n}};return n[2]!==void 0&&(o.open=n[2]),e=new Qg({props:o}),At.push(()=>qt(e,"open",a)),{c(){pe(e.$$.fragment),i=Ae(),s=te("hr"),this.h()},l(l){ye(e.$$.fragment,l),i=Se(l),s=ne(l,"HR",{class:!0}),this.h()},h(){A(s,"class","my-2 border-gray-50 dark:border-gray-700/10")},m(l,c){be(e,l,c),ee(l,i,c),ee(l,s,c),r=!0},p(l,c){const h={};c&8&&(h.title=l[3].t("Valves")),c&262148&&(h.$$scope={dirty:c,ctx:l}),!t&&c&4&&(t=!0,h.open=l[2],Wt(()=>t=!1)),e.$set(h)},i(l){r||(L(e.$$.fragment,l),r=!0)},o(l){j(e.$$.fragment,l),r=!1},d(l){l&&(S(i),S(s)),xe(e,l)}}}function uae(n){let e,t,i;return t=new cae({props:{show:n[2]}}),{c(){e=te("div"),pe(t.$$.fragment),this.h()},l(s){e=ne(s,"DIV",{class:!0,slot:!0});var r=V(e);ye(t.$$.fragment,r),r.forEach(S),this.h()},h(){A(e,"class","text-sm"),A(e,"slot","content")},m(s,r){ee(s,e,r),be(t,e,null),i=!0},p(s,r){const a={};r&4&&(a.show=s[2]),t.$set(a)},i(s){i||(L(t.$$.fragment,s),i=!0)},o(s){j(t.$$.fragment,s),i=!1},d(s){s&&S(e),xe(t)}}}function dI(n){let e,t,i,s;return e=new Qg({props:{title:n[3].t("System Prompt"),open:!0,buttonClassName:"w-full",$$slots:{content:[dae]},$$scope:{ctx:n}}}),{c(){pe(e.$$.fragment),t=Ae(),i=te("hr"),this.h()},l(r){ye(e.$$.fragment,r),t=Se(r),i=ne(r,"HR",{class:!0}),this.h()},h(){A(i,"class","my-2 border-gray-50 dark:border-gray-700/10")},m(r,a){be(e,r,a),ee(r,t,a),ee(r,i,a),s=!0},p(r,a){const o={};a&8&&(o.title=r[3].t("System Prompt")),a&262186&&(o.$$scope={dirty:a,ctx:r}),e.$set(o)},i(r){s||(L(e.$$.fragment,r),s=!0)},o(r){j(e.$$.fragment,r),s=!1},d(r){r&&(S(t),S(i)),xe(e,r)}}}function dae(n){let e,t,i,s,r,a;return{c(){e=te("div"),t=te("textarea"),this.h()},l(o){e=ne(o,"DIV",{class:!0,slot:!0});var l=V(e);t=ne(l,"TEXTAREA",{class:!0,rows:!0,placeholder:!0}),V(t).forEach(S),l.forEach(S),this.h()},h(){A(t,"class",i="w-full text-xs outline-hidden resize-vertical "+(n[5].highContrastMode?"border-2 border-gray-300 dark:border-gray-700 rounded-lg bg-gray-50 dark:bg-gray-800 p-2.5":"py-1.5 bg-transparent")),A(t,"rows","4"),A(t,"placeholder",s=n[3].t("Enter system prompt")),A(e,"class",""),A(e,"slot","content")},m(o,l){ee(o,e,l),q(e,t),So(t,n[1].system),r||(a=pt(t,"input",n[13]),r=!0)},p(o,l){l&32&&i!==(i="w-full text-xs outline-hidden resize-vertical "+(o[5].highContrastMode?"border-2 border-gray-300 dark:border-gray-700 rounded-lg bg-gray-50 dark:bg-gray-800 p-2.5":"py-1.5 bg-transparent"))&&A(t,"class",i),l&8&&s!==(s=o[3].t("Enter system prompt"))&&A(t,"placeholder",s),l&2&&So(t,o[1].system)},d(o){o&&S(e),r=!1,a()}}}function fI(n){let e,t;return e=new Qg({props:{title:n[3].t("Advanced Params"),open:!0,buttonClassName:"w-full",$$slots:{content:[fae]},$$scope:{ctx:n}}}),{c(){pe(e.$$.fragment)},l(i){ye(e.$$.fragment,i)},m(i,s){be(e,i,s),t=!0},p(i,s){const r={};s&8&&(r.title=i[3].t("Advanced Params")),s&262162&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(L(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){xe(e,i)}}}function fae(n){var l;let e,t,i,s,r;function a(c){n[14](c)}let o={admin:((l=n[4])==null?void 0:l.role)==="admin",custom:!0};return n[1]!==void 0&&(o.params=n[1]),i=new KF({props:o}),At.push(()=>qt(i,"params",a)),{c(){e=te("div"),t=te("div"),pe(i.$$.fragment),this.h()},l(c){e=ne(c,"DIV",{class:!0,slot:!0});var h=V(e);t=ne(h,"DIV",{});var u=V(t);ye(i.$$.fragment,u),u.forEach(S),h.forEach(S),this.h()},h(){A(e,"class","text-sm mt-1.5"),A(e,"slot","content")},m(c,h){ee(c,e,h),q(e,t),be(i,t,null),r=!0},p(c,h){var d;const u={};h&16&&(u.admin=((d=c[4])==null?void 0:d.role)==="admin"),!s&&h&2&&(s=!0,u.params=c[1],Wt(()=>s=!1)),i.$set(u)},i(c){r||(L(i.$$.fragment,c),r=!0)},o(c){j(i.$$.fragment,c),r=!1},d(c){c&&S(e),xe(i)}}}function gae(n){var g,m,b;let e,t,i,s=n[3].t("Chat Controls")+"",r,a,o,l,c,h,u,d;l=new ux({props:{className:"size-3.5"}});let f=(((g=n[4])==null?void 0:g.role)==="admin"||(((b=(m=n[4])==null?void 0:m.permissions.chat)==null?void 0:b.controls)??!0))&&lI(n);return{c(){e=te("div"),t=te("div"),i=te("div"),r=_t(s),a=Ae(),o=te("button"),pe(l.$$.fragment),c=Ae(),f&&f.c(),this.h()},l(p){e=ne(p,"DIV",{class:!0});var y=V(e);t=ne(y,"DIV",{class:!0});var w=V(t);i=ne(w,"DIV",{class:!0});var _=V(i);r=vt(_,s),_.forEach(S),a=Se(w),o=ne(w,"BUTTON",{class:!0});var v=V(o);ye(l.$$.fragment,v),v.forEach(S),w.forEach(S),c=Se(y),f&&f.l(y),y.forEach(S),this.h()},h(){A(i,"class","text-lg font-medium self-center font-primary"),A(o,"class","self-center"),A(t,"class","flex items-center justify-between dark:text-gray-100 mb-2"),A(e,"class","dark:text-white")},m(p,y){ee(p,e,y),q(e,t),q(t,i),q(i,r),q(t,a),q(t,o),be(l,o,null),q(e,c),f&&f.m(e,null),h=!0,u||(d=pt(o,"click",n[9]),u=!0)},p(p,[y]){var w,_,v;(!h||y&8)&&s!==(s=p[3].t("Chat Controls")+"")&&St(r,s),((w=p[4])==null?void 0:w.role)==="admin"||(((v=(_=p[4])==null?void 0:_.permissions.chat)==null?void 0:v.controls)??!0)?f?(f.p(p,y),y&16&&L(f,1)):(f=lI(p),f.c(),L(f,1),f.m(e,null)):f&&(ot(),j(f,1,1,()=>{f=null}),lt())},i(p){h||(L(l.$$.fragment,p),L(f),h=!0)},o(p){j(l.$$.fragment,p),j(f),h=!1},d(p){p&&S(e),xe(l),f&&f.d(),u=!1,d()}}}function mae(n,e,t){let i,s,r;Pe(n,T0,y=>t(4,s=y)),Pe(n,Ya,y=>t(5,r=y));const a=eo(),o=hs("i18n");Pe(n,o,y=>t(3,i=y));let{models:l=[]}=e,{chatFiles:c=[]}=e,{params:h={}}=e,u=!1;const d=()=>{a("close")},f=y=>{c.splice(y,1),t(0,c)},g=y=>{};function m(y){u=y,t(2,u)}function b(){h.system=this.value,t(1,h)}function p(y){h=y,t(1,h)}return n.$$set=y=>{"models"in y&&t(8,l=y.models),"chatFiles"in y&&t(0,c=y.chatFiles),"params"in y&&t(1,h=y.params)},[c,h,u,i,s,r,a,o,l,d,f,g,m,b,p]}class hD extends Nt{constructor(e){super(),Ot(this,e,mae,gae,Ft,{models:8,chatFiles:0,params:1})}}function gI(n,e,t){const i=n.slice();return i[10]=e[t],i}function pae(n){let e;const t=n[4].default,i=Xs(t,n,n[8],null);return{c(){i&&i.c()},l(s){i&&i.l(s)},m(s,r){i&&i.m(s,r),e=!0},p(s,r){i&&i.p&&(!e||r&256)&&Ys(i,t,s,s[8],e?Zs(t,s[8],r,null):Js(s[8]),null)},i(s){e||(L(i,s),e=!0)},o(s){j(i,s),e=!1},d(s){i&&i.d(s)}}}function bae(n){var a;let e,t,i=(((a=n[10])==null?void 0:a.label)??"Camera")+"",s,r;return{c(){e=te("div"),t=te("div"),s=_t(i),r=Ae(),this.h()},l(o){e=ne(o,"DIV",{class:!0});var l=V(e);t=ne(l,"DIV",{class:!0});var c=V(t);s=vt(c,i),c.forEach(S),l.forEach(S),r=Se(o),this.h()},h(){A(t,"class","line-clamp-1"),A(e,"class","flex items-center")},m(o,l){ee(o,e,l),q(e,t),q(t,s),ee(o,r,l)},p(o,l){var c;l&2&&i!==(i=(((c=o[10])==null?void 0:c.label)??"Camera")+"")&&St(s,i)},d(o){o&&(S(e),S(r))}}}function mI(n){let e,t;function i(){return n[5](n[10])}return e=new ba({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",$$slots:{default:[bae]},$$scope:{ctx:n}}}),e.$on("click",i),{c(){pe(e.$$.fragment)},l(s){ye(e.$$.fragment,s)},m(s,r){be(e,s,r),t=!0},p(s,r){n=s;const a={};r&258&&(a.$$scope={dirty:r,ctx:n}),e.$set(a)},i(s){t||(L(e.$$.fragment,s),t=!0)},o(s){j(e.$$.fragment,s),t=!1},d(s){xe(e,s)}}}function xae(n){let e,t,i=Qn(n[1]),s=[];for(let a=0;a<i.length;a+=1)s[a]=mI(gI(n,i,a));const r=a=>j(s[a],1,1,()=>{s[a]=null});return{c(){for(let a=0;a<s.length;a+=1)s[a].c();e=Ut()},l(a){for(let o=0;o<s.length;o+=1)s[o].l(a);e=Ut()},m(a,o){for(let l=0;l<s.length;l+=1)s[l]&&s[l].m(a,o);ee(a,e,o),t=!0},p(a,o){if(o&10){i=Qn(a[1]);let l;for(l=0;l<i.length;l+=1){const c=gI(a,i,l);s[l]?(s[l].p(c,o),L(s[l],1)):(s[l]=mI(c),s[l].c(),L(s[l],1),s[l].m(e.parentNode,e))}for(ot(),l=i.length;l<s.length;l+=1)r(l);lt()}},i(a){if(!t){for(let o=0;o<i.length;o+=1)L(s[o]);t=!0}},o(a){s=s.filter(Boolean);for(let o=0;o<s.length;o+=1)j(s[o]);t=!1},d(a){a&&S(e),To(s,a)}}}function yae(n){let e,t,i;return t=new h4({props:{class:"w-full max-w-[180px] rounded-lg px-1 py-1.5 border border-gray-300/30 dark:border-gray-700/50 z-9999 bg-white dark:bg-gray-900 dark:text-white shadow-xs",sideOffset:6,side:"top",align:"start",transition:Q5,$$slots:{default:[xae]},$$scope:{ctx:n}}}),{c(){e=te("div"),pe(t.$$.fragment),this.h()},l(s){e=ne(s,"DIV",{slot:!0});var r=V(e);ye(t.$$.fragment,r),r.forEach(S),this.h()},h(){A(e,"slot","content")},m(s,r){ee(s,e,r),be(t,e,null),i=!0},p(s,r){const a={};r&258&&(a.$$scope={dirty:r,ctx:s}),t.$set(a)},i(s){i||(L(t.$$.fragment,s),i=!0)},o(s){j(t.$$.fragment,s),i=!1},d(s){s&&S(e),xe(t)}}}function wae(n){let e,t,i;function s(a){n[6](a)}let r={$$slots:{content:[yae],default:[pae]},$$scope:{ctx:n}};return n[2]!==void 0&&(r.show=n[2]),e=new u4({props:r}),At.push(()=>qt(e,"show",s)),e.$on("change",n[7]),{c(){pe(e.$$.fragment)},l(a){ye(e.$$.fragment,a)},m(a,o){be(e,a,o),i=!0},p(a,[o]){const l={};o&258&&(l.$$scope={dirty:o,ctx:a}),!t&&o&4&&(t=!0,l.show=a[2],Wt(()=>t=!1)),e.$set(l)},i(a){i||(L(e.$$.fragment,a),i=!0)},o(a){j(e.$$.fragment,a),i=!1},d(a){xe(e,a)}}}function _ae(n,e,t){let{$$slots:i={},$$scope:s}=e;hs("i18n");const r=eo();let{onClose:a=()=>{}}=e,{devices:o}=e,l=!1;const c=d=>{r("change",d.deviceId)};function h(d){l=d,t(2,l)}const u=d=>{d.detail===!1&&a()};return n.$$set=d=>{"onClose"in d&&t(0,a=d.onClose),"devices"in d&&t(1,o=d.devices),"$$scope"in d&&t(8,s=d.$$scope)},[a,o,l,r,i,c,h,u,s]}class vae extends Nt{constructor(e){super(),Ot(this,e,_ae,wae,Ft,{onClose:0,devices:1})}}function pI(n){let e,t,i,s,r,a,o,l,c,h,u,d,f,g,m,b='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="size-5"><path d="M6.28 5.22a.75.75 0 0 0-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 1 0 1.06 1.06L10 11.06l3.72 3.72a.75.75 0 1 0 1.06-1.06L11.06 10l3.72-3.72a.75.75 0 0 0-1.06-1.06L10 8.94 6.28 5.22Z"></path></svg>',p,y,w,_=n[4]&&bI(n);function v(R,z){return R[4]?Sae:Iae}let C=v(n),k=C(n);const I=[Pae,Mae],E=[];function T(R,z){return R[4]?0:1}o=T(n),l=E[o]=I[o](n);function M(R,z){return R[1]?Lae:R[2]?Fae:Dae}let D=M(n),H=D(n);return{c(){e=te("div"),_&&_.c(),t=Ae(),i=te("div"),k.c(),s=Ae(),r=te("div"),a=te("div"),l.c(),c=Ae(),h=te("div"),u=te("button"),d=te("div"),H.c(),f=Ae(),g=te("div"),m=te("button"),m.innerHTML=b,this.h()},l(R){e=ne(R,"DIV",{class:!0});var z=V(e);_&&_.l(z),t=Se(z),i=ne(z,"DIV",{class:!0});var P=V(i);k.l(P),P.forEach(S),s=Se(z),r=ne(z,"DIV",{class:!0});var B=V(r);a=ne(B,"DIV",{});var Z=V(a);l.l(Z),Z.forEach(S),c=Se(B),h=ne(B,"DIV",{});var G=V(h);u=ne(G,"BUTTON",{type:!0});var Y=V(u);d=ne(Y,"DIV",{class:!0});var J=V(d);H.l(J),J.forEach(S),Y.forEach(S),G.forEach(S),f=Se(B),g=ne(B,"DIV",{});var se=V(g);m=ne(se,"BUTTON",{class:!0,type:!0,"data-svelte-h":!0}),Ro(m)!=="svelte-1k5eavb"&&(m.innerHTML=b),se.forEach(S),B.forEach(S),z.forEach(S),this.h()},h(){A(i,"class","flex justify-center items-center flex-1 h-full w-full max-h-full"),A(d,"class","line-clamp-1 text-sm font-medium"),A(u,"type","button"),A(m,"class","p-3 rounded-full bg-gray-50 dark:bg-gray-900"),A(m,"type","button"),A(r,"class","flex justify-between items-center pb-2 w-full"),A(e,"class","max-w-lg w-full h-full max-h-[100dvh] flex flex-col justify-between p-3 md:p-6")},m(R,z){ee(R,e,z),_&&_.m(e,null),q(e,t),q(e,i),k.m(i,null),q(e,s),q(e,r),q(r,a),E[o].m(a,null),q(r,c),q(r,h),q(h,u),q(u,d),H.m(d,null),q(r,f),q(r,g),q(g,m),p=!0,y||(w=[pt(u,"click",n[31]),pt(m,"click",n[32])],y=!0)},p(R,z){R[4]?_?_.p(R,z):(_=bI(R),_.c(),_.m(e,t)):_&&(_.d(1),_=null),C===(C=v(R))&&k?k.p(R,z):(k.d(1),k=C(R),k&&(k.c(),k.m(i,null)));let P=o;o=T(R),o===P?E[o].p(R,z):(ot(),j(E[P],1,1,()=>{E[P]=null}),lt(),l=E[o],l?l.p(R,z):(l=E[o]=I[o](R),l.c()),L(l,1),l.m(a,null)),D===(D=M(R))&&H?H.p(R,z):(H.d(1),H=D(R),H&&(H.c(),H.m(d,null)))},i(R){p||(L(l),p=!0)},o(R){j(l),p=!1},d(R){R&&S(e),_&&_.d(),k.d(),E[o].d(),H.d(),y=!1,ia(w)}}}function bI(n){let e,t,i;function s(o,l){return o[3]?Aae:o[1]||o[2]?Cae:kae}let r=s(n),a=r(n);return{c(){e=te("button"),a.c(),this.h()},l(o){e=ne(o,"BUTTON",{type:!0,class:!0});var l=V(e);a.l(l),l.forEach(S),this.h()},h(){A(e,"type","button"),A(e,"class","flex justify-center items-center w-full h-20 min-h-20")},m(o,l){ee(o,e,l),a.m(e,null),t||(i=pt(e,"click",n[26]),t=!0)},p(o,l){r===(r=s(o))&&a?a.p(o,l):(a.d(1),a=r(o),a&&(a.c(),a.m(e,null)))},d(o){o&&S(e),a.d(),t=!1,i()}}}function kae(n){let e,t,i;return{c(){e=te("div"),this.h()},l(s){e=ne(s,"DIV",{class:!0,style:!0}),V(e).forEach(S),this.h()},h(){var s,r,a,o,l,c,h,u,d;A(e,"class",t=(n[6]*100>4?" size-[4.5rem]":n[6]*100>2?" size-16":n[6]*100>1?"size-14":"size-12")+" transition-all rounded-full "+((((a=(r=(s=n[0])==null?void 0:s.info)==null?void 0:r.meta)==null?void 0:a.profile_image_url)??"/static/favicon.png")!=="/static/favicon.png"?" bg-cover bg-center bg-no-repeat":"bg-black dark:bg-white")+" bg-black dark:bg-white"),A(e,"style",i=(((c=(l=(o=n[0])==null?void 0:o.info)==null?void 0:l.meta)==null?void 0:c.profile_image_url)??"/static/favicon.png")!=="/static/favicon.png"?`background-image: url('${(d=(u=(h=n[0])==null?void 0:h.info)==null?void 0:u.meta)==null?void 0:d.profile_image_url}');`:"")},m(s,r){ee(s,e,r)},p(s,r){var a,o,l,c,h,u,d,f,g;r[0]&65&&t!==(t=(s[6]*100>4?" size-[4.5rem]":s[6]*100>2?" size-16":s[6]*100>1?"size-14":"size-12")+" transition-all rounded-full "+((((l=(o=(a=s[0])==null?void 0:a.info)==null?void 0:o.meta)==null?void 0:l.profile_image_url)??"/static/favicon.png")!=="/static/favicon.png"?" bg-cover bg-center bg-no-repeat":"bg-black dark:bg-white")+" bg-black dark:bg-white")&&A(e,"class",t),r[0]&1&&i!==(i=(((u=(h=(c=s[0])==null?void 0:c.info)==null?void 0:h.meta)==null?void 0:u.profile_image_url)??"/static/favicon.png")!=="/static/favicon.png"?`background-image: url('${(g=(f=(d=s[0])==null?void 0:d.info)==null?void 0:f.meta)==null?void 0:g.profile_image_url}');`:"")&&A(e,"style",i)},d(s){s&&S(e)}}}function Cae(n){let e,t,i,s,r,a;return{c(){e=nt("svg"),t=nt("style"),i=_t(`.spinner_qM83 {
								animation: spinner_8HQG 1.05s infinite;
							}
							.spinner_oXPr {
								animation-delay: 0.1s;
							}
							.spinner_ZTLf {
								animation-delay: 0.2s;
							}
							@keyframes spinner_8HQG {
								0%,
								57.14% {
									animation-timing-function: cubic-bezier(0.33, 0.66, 0.66, 1);
									transform: translate(0);
								}
								28.57% {
									animation-timing-function: cubic-bezier(0.33, 0, 0.66, 0.33);
									transform: translateY(-6px);
								}
								100% {
									transform: translate(0);
								}
							}
						`),s=nt("circle"),r=nt("circle"),a=nt("circle"),this.h()},l(o){e=it(o,"svg",{class:!0,viewBox:!0,fill:!0,xmlns:!0});var l=V(e);t=it(l,"style",{});var c=V(t);i=vt(c,`.spinner_qM83 {
								animation: spinner_8HQG 1.05s infinite;
							}
							.spinner_oXPr {
								animation-delay: 0.1s;
							}
							.spinner_ZTLf {
								animation-delay: 0.2s;
							}
							@keyframes spinner_8HQG {
								0%,
								57.14% {
									animation-timing-function: cubic-bezier(0.33, 0.66, 0.66, 1);
									transform: translate(0);
								}
								28.57% {
									animation-timing-function: cubic-bezier(0.33, 0, 0.66, 0.33);
									transform: translateY(-6px);
								}
								100% {
									transform: translate(0);
								}
							}
						`),c.forEach(S),s=it(l,"circle",{class:!0,cx:!0,cy:!0,r:!0}),V(s).forEach(S),r=it(l,"circle",{class:!0,cx:!0,cy:!0,r:!0}),V(r).forEach(S),a=it(l,"circle",{class:!0,cx:!0,cy:!0,r:!0}),V(a).forEach(S),l.forEach(S),this.h()},h(){A(s,"class","spinner_qM83"),A(s,"cx","4"),A(s,"cy","12"),A(s,"r","3"),A(r,"class","spinner_qM83 spinner_oXPr"),A(r,"cx","12"),A(r,"cy","12"),A(r,"r","3"),A(a,"class","spinner_qM83 spinner_ZTLf"),A(a,"cx","20"),A(a,"cy","12"),A(a,"r","3"),A(e,"class","size-12 text-gray-900 dark:text-gray-400"),A(e,"viewBox","0 0 24 24"),A(e,"fill","currentColor"),A(e,"xmlns","http://www.w3.org/2000/svg")},m(o,l){ee(o,e,l),q(e,t),q(t,i),q(e,s),q(e,r),q(e,a)},p:kt,d(o){o&&S(e)}}}function Aae(n){let e,t;return{c(){e=te("div"),t=_t(n[3]),this.h()},l(i){e=ne(i,"DIV",{class:!0,style:!0});var s=V(e);t=vt(s,n[3]),s.forEach(S),this.h()},h(){A(e,"class","transition-all rounded-full"),rn(e,"font-size",(n[6]*100>4?"4.5":n[6]*100>2?"4.25":n[6]*100>1?"3.75":"3.5")+"rem"),rn(e,"width","100%"),rn(e,"text-align","center")},m(i,s){ee(i,e,s),q(e,t)},p(i,s){s[0]&8&&St(t,i[3]),s[0]&64&&rn(e,"font-size",(i[6]*100>4?"4.5":i[6]*100>2?"4.25":i[6]*100>1?"3.75":"3.5")+"rem")},d(i){i&&S(e)}}}function Sae(n){let e,t,i,s,r,a,o,l='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-6"><path d="M5.28 4.22a.75.75 0 0 0-1.06 1.06L6.94 8l-2.72 2.72a.75.75 0 1 0 1.06 1.06L8 9.06l2.72 2.72a.75.75 0 1 0 1.06-1.06L9.06 8l2.72-2.72a.75.75 0 0 0-1.06-1.06L8 6.94 5.28 4.22Z"></path></svg>',c,h;return{c(){e=te("div"),t=te("video"),i=Ae(),s=te("canvas"),r=Ae(),a=te("div"),o=te("button"),o.innerHTML=l,this.h()},l(u){e=ne(u,"DIV",{class:!0});var d=V(e);t=ne(d,"VIDEO",{id:!0,class:!0}),V(t).forEach(S),i=Se(d),s=ne(d,"CANVAS",{id:!0,style:!0}),V(s).forEach(S),r=Se(d),a=ne(d,"DIV",{class:!0});var f=V(a);o=ne(f,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),Ro(o)!=="svelte-16ul42n"&&(o.innerHTML=l),f.forEach(S),d.forEach(S),this.h()},h(){A(t,"id","camera-feed"),t.autoplay=!0,A(t,"class","rounded-2xl h-full min-w-full object-cover object-center"),t.playsInline=!0,A(s,"id","camera-canvas"),rn(s,"display","none"),A(o,"type","button"),A(o,"class","p-1.5 text-white cursor-pointer backdrop-blur-xl bg-black/10 rounded-full"),A(a,"class","absolute top-4 md:top-8 left-4"),A(e,"class","relative flex video-container w-full max-h-full pt-2 pb-4 md:py-6 px-2 h-full")},m(u,d){ee(u,e,d),q(e,t),q(e,i),q(e,s),q(e,r),q(e,a),q(a,o),c||(h=pt(o,"click",n[28]),c=!0)},p:kt,d(u){u&&S(e),c=!1,h()}}}function Iae(n){let e,t,i;function s(o,l){return o[3]?Rae:o[1]||o[2]?Tae:Eae}let r=s(n),a=r(n);return{c(){e=te("button"),a.c(),this.h()},l(o){e=ne(o,"BUTTON",{type:!0});var l=V(e);a.l(l),l.forEach(S),this.h()},h(){A(e,"type","button")},m(o,l){ee(o,e,l),a.m(e,null),t||(i=pt(e,"click",n[27]),t=!0)},p(o,l){r===(r=s(o))&&a?a.p(o,l):(a.d(1),a=r(o),a&&(a.c(),a.m(e,null)))},d(o){o&&S(e),a.d(),t=!1,i()}}}function Eae(n){let e,t,i;return{c(){e=te("div"),this.h()},l(s){e=ne(s,"DIV",{class:!0,style:!0}),V(e).forEach(S),this.h()},h(){var s,r,a,o,l,c,h,u,d;A(e,"class",t=(n[6]*100>4?" size-52":n[6]*100>2?"size-48":n[6]*100>1?"size-44":"size-40")+" transition-all rounded-full "+((((a=(r=(s=n[0])==null?void 0:s.info)==null?void 0:r.meta)==null?void 0:a.profile_image_url)??"/static/favicon.png")!=="/static/favicon.png"?" bg-cover bg-center bg-no-repeat":"bg-black dark:bg-white")),A(e,"style",i=(((c=(l=(o=n[0])==null?void 0:o.info)==null?void 0:l.meta)==null?void 0:c.profile_image_url)??"/static/favicon.png")!=="/static/favicon.png"?`background-image: url('${(d=(u=(h=n[0])==null?void 0:h.info)==null?void 0:u.meta)==null?void 0:d.profile_image_url}');`:"")},m(s,r){ee(s,e,r)},p(s,r){var a,o,l,c,h,u,d,f,g;r[0]&65&&t!==(t=(s[6]*100>4?" size-52":s[6]*100>2?"size-48":s[6]*100>1?"size-44":"size-40")+" transition-all rounded-full "+((((l=(o=(a=s[0])==null?void 0:a.info)==null?void 0:o.meta)==null?void 0:l.profile_image_url)??"/static/favicon.png")!=="/static/favicon.png"?" bg-cover bg-center bg-no-repeat":"bg-black dark:bg-white"))&&A(e,"class",t),r[0]&1&&i!==(i=(((u=(h=(c=s[0])==null?void 0:c.info)==null?void 0:h.meta)==null?void 0:u.profile_image_url)??"/static/favicon.png")!=="/static/favicon.png"?`background-image: url('${(g=(f=(d=s[0])==null?void 0:d.info)==null?void 0:f.meta)==null?void 0:g.profile_image_url}');`:"")&&A(e,"style",i)},d(s){s&&S(e)}}}function Tae(n){let e,t,i,s,r,a;return{c(){e=nt("svg"),t=nt("style"),i=_t(`.spinner_qM83 {
									animation: spinner_8HQG 1.05s infinite;
								}
								.spinner_oXPr {
									animation-delay: 0.1s;
								}
								.spinner_ZTLf {
									animation-delay: 0.2s;
								}
								@keyframes spinner_8HQG {
									0%,
									57.14% {
										animation-timing-function: cubic-bezier(0.33, 0.66, 0.66, 1);
										transform: translate(0);
									}
									28.57% {
										animation-timing-function: cubic-bezier(0.33, 0, 0.66, 0.33);
										transform: translateY(-6px);
									}
									100% {
										transform: translate(0);
									}
								}
							`),s=nt("circle"),r=nt("circle"),a=nt("circle"),this.h()},l(o){e=it(o,"svg",{class:!0,viewBox:!0,fill:!0,xmlns:!0});var l=V(e);t=it(l,"style",{});var c=V(t);i=vt(c,`.spinner_qM83 {
									animation: spinner_8HQG 1.05s infinite;
								}
								.spinner_oXPr {
									animation-delay: 0.1s;
								}
								.spinner_ZTLf {
									animation-delay: 0.2s;
								}
								@keyframes spinner_8HQG {
									0%,
									57.14% {
										animation-timing-function: cubic-bezier(0.33, 0.66, 0.66, 1);
										transform: translate(0);
									}
									28.57% {
										animation-timing-function: cubic-bezier(0.33, 0, 0.66, 0.33);
										transform: translateY(-6px);
									}
									100% {
										transform: translate(0);
									}
								}
							`),c.forEach(S),s=it(l,"circle",{class:!0,cx:!0,cy:!0,r:!0}),V(s).forEach(S),r=it(l,"circle",{class:!0,cx:!0,cy:!0,r:!0}),V(r).forEach(S),a=it(l,"circle",{class:!0,cx:!0,cy:!0,r:!0}),V(a).forEach(S),l.forEach(S),this.h()},h(){A(s,"class","spinner_qM83"),A(s,"cx","4"),A(s,"cy","12"),A(s,"r","3"),A(r,"class","spinner_qM83 spinner_oXPr"),A(r,"cx","12"),A(r,"cy","12"),A(r,"r","3"),A(a,"class","spinner_qM83 spinner_ZTLf"),A(a,"cx","20"),A(a,"cy","12"),A(a,"r","3"),A(e,"class","size-44 text-gray-900 dark:text-gray-400"),A(e,"viewBox","0 0 24 24"),A(e,"fill","currentColor"),A(e,"xmlns","http://www.w3.org/2000/svg")},m(o,l){ee(o,e,l),q(e,t),q(t,i),q(e,s),q(e,r),q(e,a)},p:kt,d(o){o&&S(e)}}}function Rae(n){let e,t;return{c(){e=te("div"),t=_t(n[3]),this.h()},l(i){e=ne(i,"DIV",{class:!0,style:!0});var s=V(e);t=vt(s,n[3]),s.forEach(S),this.h()},h(){A(e,"class","transition-all rounded-full"),rn(e,"font-size",(n[6]*100>4?"13":n[6]*100>2?"12":n[6]*100>1?"11.5":"11")+"rem"),rn(e,"width","100%"),rn(e,"text-align","center")},m(i,s){ee(i,e,s),q(e,t)},p(i,s){s[0]&8&&St(t,i[3]),s[0]&64&&rn(e,"font-size",(i[6]*100>4?"13":i[6]*100>2?"12":i[6]*100>1?"11.5":"11")+"rem")},d(i){i&&S(e)}}}function Mae(n){let e,t;return e=new Ci({props:{content:n[11].t("Camera"),$$slots:{default:[Nae]},$$scope:{ctx:n}}}),{c(){pe(e.$$.fragment)},l(i){ye(e.$$.fragment,i)},m(i,s){be(e,i,s),t=!0},p(i,s){const r={};s[0]&2048&&(r.content=i[11].t("Camera")),s[2]&16&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(L(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){xe(e,i)}}}function Pae(n){let e,t;return e=new vae({props:{devices:n[8],$$slots:{default:[Oae]},$$scope:{ctx:n}}}),e.$on("change",n[29]),{c(){pe(e.$$.fragment)},l(i){ye(e.$$.fragment,i)},m(i,s){be(e,i,s),t=!0},p(i,s){const r={};s[0]&256&&(r.devices=i[8]),s[2]&16&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(L(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){xe(e,i)}}}function Nae(n){let e,t='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5"><path stroke-linecap="round" stroke-linejoin="round" d="M6.827 6.175A2.31 2.31 0 0 1 5.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 0 0-1.134-.175 2.31 2.31 0 0 1-1.64-1.055l-.822-1.316a2.192 2.192 0 0 0-1.736-1.039 48.774 48.774 0 0 0-5.232 0 2.192 2.192 0 0 0-1.736 1.039l-.821 1.316Z"></path><path stroke-linecap="round" stroke-linejoin="round" d="M16.5 12.75a4.5 4.5 0 1 1-9 0 4.5 4.5 0 0 1 9 0ZM18.75 10.5h.008v.008h-.008V10.5Z"></path></svg>',i,s;return{c(){e=te("button"),e.innerHTML=t,this.h()},l(r){e=ne(r,"BUTTON",{class:!0,type:!0,"data-svelte-h":!0}),Ro(e)!=="svelte-1n1gs9g"&&(e.innerHTML=t),this.h()},h(){A(e,"class","p-3 rounded-full bg-gray-50 dark:bg-gray-900"),A(e,"type","button")},m(r,a){ee(r,e,a),i||(s=pt(e,"click",n[30]),i=!0)},p:kt,d(r){r&&S(e),i=!1,s()}}}function Oae(n){let e,t='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="size-5"><path fill-rule="evenodd" d="M15.312 11.424a5.5 5.5 0 0 1-9.201 2.466l-.312-.311h2.433a.75.75 0 0 0 0-1.5H3.989a.75.75 0 0 0-.75.75v4.242a.75.75 0 0 0 1.5 0v-2.43l.31.31a7 7 0 0 0 11.712-3.138.75.75 0 0 0-1.449-.39Zm1.23-3.723a.75.75 0 0 0 .219-.53V2.929a.75.75 0 0 0-1.5 0V5.36l-.31-.31A7 7 0 0 0 3.239 8.188a.75.75 0 1 0 1.448.389A5.5 5.5 0 0 1 13.89 6.11l.311.31h-2.432a.75.75 0 0 0 0 1.5h4.243a.75.75 0 0 0 .53-.219Z" clip-rule="evenodd"></path></svg>';return{c(){e=te("button"),e.innerHTML=t,this.h()},l(i){e=ne(i,"BUTTON",{class:!0,type:!0,"data-svelte-h":!0}),Ro(e)!=="svelte-5e0pue"&&(e.innerHTML=t),this.h()},h(){A(e,"class","p-3 rounded-full bg-gray-50 dark:bg-gray-900"),A(e,"type","button")},m(i,s){ee(i,e,s)},p:kt,d(i){i&&S(e)}}}function Dae(n){let e=n[11].t("Listening...")+"",t;return{c(){t=_t(e)},l(i){t=vt(i,e)},m(i,s){ee(i,t,s)},p(i,s){s[0]&2048&&e!==(e=i[11].t("Listening...")+"")&&St(t,e)},d(i){i&&S(t)}}}function Fae(n){let e=n[11].t("Tap to interrupt")+"",t;return{c(){t=_t(e)},l(i){t=vt(i,e)},m(i,s){ee(i,t,s)},p(i,s){s[0]&2048&&e!==(e=i[11].t("Tap to interrupt")+"")&&St(t,e)},d(i){i&&S(t)}}}function Lae(n){let e=n[11].t("Thinking...")+"",t;return{c(){t=_t(e)},l(i){t=vt(i,e)},m(i,s){ee(i,t,s)},p(i,s){s[0]&2048&&e!==(e=i[11].t("Thinking...")+"")&&St(t,e)},d(i){i&&S(t)}}}function Bae(n){let e,t,i=n[10]&&pI(n);return{c(){i&&i.c(),e=Ut()},l(s){i&&i.l(s),e=Ut()},m(s,r){i&&i.m(s,r),ee(s,e,r),t=!0},p(s,r){s[10]?i?(i.p(s,r),r[0]&1024&&L(i,1)):(i=pI(s),i.c(),L(i,1),i.m(e.parentNode,e)):i&&(ot(),j(i,1,1,()=>{i=null}),lt())},i(s){t||(L(i),t=!0)},o(s){j(i),t=!1},d(s){s&&S(e),i&&i.d(s)}}}function Uae(n,e,t){let i,s,r,a,o,l;Pe(n,em,Re=>t(45,i=Re)),Pe(n,$g,Re=>t(46,s=Re)),Pe(n,Ya,Re=>t(47,r=Re)),Pe(n,r8,Re=>t(48,a=Re)),Pe(n,Va,Re=>t(10,o=Re));const c=eo(),h=hs("i18n");Pe(n,h,Re=>t(11,l=Re));let{eventTarget:u}=e,{submitPrompt:d}=e,{stopResponse:f}=e,{files:g}=e,{chatId:m}=e,{modelId:b}=e,p=null,y=null,w=!1,_=!1,v=!1,C=null,k=!1,I=null,E=!1,T=0,M=!1,D,H=null,R=[],z=[],P=null;const B=async()=>{const Re=await navigator.mediaDevices.enumerateDevices();t(8,z=Re.filter(Mt=>Mt.kind==="videoinput")),navigator.mediaDevices.getDisplayMedia&&t(8,z=[...z,{deviceId:"screen",label:"Screen Share"}]),P===null&&z.length>0&&t(9,P=z[0].deviceId)},Z=async()=>{if(await B(),I===null){t(4,k=!0),await hn();try{await G()}catch(Re){console.error("Error accessing webcam: ",Re)}}},G=async()=>{const Re=document.getElementById("camera-feed");Re&&(P==="screen"?t(5,I=await navigator.mediaDevices.getDisplayMedia({video:{cursor:"always"},audio:!1})):t(5,I=await navigator.mediaDevices.getUserMedia({video:{deviceId:P?{exact:P}:void 0}})),I&&(await B(),Re.srcObject=I,await Re.play()))},Y=async()=>{I&&I.getTracks().forEach(Mt=>Mt.stop()),t(5,I=null)},J=()=>{const Re=document.getElementById("camera-feed"),Mt=document.getElementById("camera-canvas");if(!Mt)return;const yt=Mt.getContext("2d");Mt.width=Re.videoWidth,Mt.height=Re.videoHeight,yt.drawImage(Re,0,0,Re.videoWidth,Re.videoHeight);const Gt=Mt.toDataURL("image/png");return Gt},se=async()=>{await Y(),t(4,k=!1)},fe=-55,he=async Re=>{var Gt,un;await hn();const Mt=JD(Re,"recording.wav"),yt=await tL(localStorage.token,Mt,(un=(Gt=r==null?void 0:r.audio)==null?void 0:Gt.stt)==null?void 0:un.language,!1).catch(Kn=>(Jt.error(`${Kn}`),null));if(yt&&(yt.text,yt.text!=="")){const Kn=await d(yt.text,{_raw:!0})}},de=async(Re=!0)=>{if(o){const Mt=R.slice(0);if(R=[],D=!1,Re&&ge(),_){if(t(1,w=!0),t(3,C=null),I){const Gt=J();t(20,g=[{type:"image",url:Gt}])}const yt=new Blob(Mt,{type:"audio/wav"});await he(yt),_=!1,t(1,w=!1)}}else R=[],D=!1,H&&H.getTracks().forEach(yt=>yt.stop()),t(7,H=null)},ge=async()=>{o&&(H||t(7,H=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0}})),D=new MediaRecorder(H),D.onstart=()=>{R=[]},D.ondataavailable=Re=>{M&&R.push(Re.data)},D.onstop=Re=>{de()},oe(H))},N=async()=>{try{D&&D.stop()}catch(Re){}H&&(H.getAudioTracks().forEach(function(Re){Re.stop()}),t(7,H=null))},K=Re=>{let Mt=0;for(let yt=0;yt<Re.length;yt++){const Gt=(Re[yt]-128)/128;Mt+=Gt*Gt}return Math.sqrt(Mt/Re.length)},oe=Re=>{const Mt=new AudioContext,yt=Mt.createMediaStreamSource(Re),Gt=Mt.createAnalyser();Gt.minDecibels=fe,yt.connect(Gt);const un=Gt.frequencyBinCount,Kn=new Uint8Array(un),di=new Uint8Array(Gt.fftSize);let qi=Date.now();M=!1,(()=>{const Wi=()=>{if(!D||!o)return;if(v&&!((r==null?void 0:r.voiceInterruption)??!1)?(Gt.maxDecibels=0,Gt.minDecibels=-1):(Gt.minDecibels=fe,Gt.maxDecibels=-30),Gt.getByteTimeDomainData(di),Gt.getByteFrequencyData(Kn),t(6,T=K(di)),Kn.some(Ki=>Ki>0)&&(D&&D.state!=="recording"&&D.start(),M||(M=!0,Ke()),qi=Date.now()),M&&Date.now()-qi>2e3&&(_=!0,D)){D.stop();return}window.requestAnimationFrame(Wi)};window.requestAnimationFrame(Wi)})()};let W={},le=null,ce=null;const Ce=Re=>o?new Promise(Mt=>{let yt=[];const Gt=setInterval(async()=>{var un,Kn,di;if(yt=await speechSynthesis.getVoices(),yt.length>0){clearInterval(Gt);const qi=((un=yt==null?void 0:yt.filter(Cs=>{var Wi,Ms,Ki,yi;return Cs.voiceURI===(((Ms=(Wi=r==null?void 0:r.audio)==null?void 0:Wi.tts)==null?void 0:Ms.voice)??((yi=(Ki=s==null?void 0:s.audio)==null?void 0:Ki.tts)==null?void 0:yi.voice))}))==null?void 0:un.at(0))??void 0;ce=new SpeechSynthesisUtterance(Re),ce.rate=((di=(Kn=r.audio)==null?void 0:Kn.tts)==null?void 0:di.playbackRate)??1,qi&&(ce.voice=qi),speechSynthesis.speak(ce),ce.onend=async Cs=>{await new Promise(Wi=>setTimeout(Wi,200)),Mt(Cs)}}},100)}):Promise.resolve(),X=Re=>o?new Promise(Mt=>{var Gt,un;const yt=document.getElementById("audioElement");yt&&(yt.src=Re.src,yt.muted=!0,yt.playbackRate=((un=(Gt=r.audio)==null?void 0:Gt.tts)==null?void 0:un.playbackRate)??1,yt.play().then(()=>{yt.muted=!1}).catch(Kn=>{console.error(Kn)}),yt.onended=async Kn=>{await new Promise(di=>setTimeout(di,100)),Mt(Kn)})}):Promise.resolve(),Ke=async()=>{t(2,v=!1),E&&f(),ce&&(speechSynthesis.cancel(),ce=null);const Re=document.getElementById("audioElement");Re&&(Re.muted=!0,Re.pause(),Re.currentTime=0)};let qe=new AbortController;const He=new Map,Me=new Map,Ne=async Re=>{var Mt,yt,Gt,un,Kn,di,qi,Cs,Wi,Ms,Ki,yi,yr,Ps;if(!He.has(Re))try{if((r==null?void 0:r.showEmojiInCall)??!1){const Ns=await uF(localStorage.token,b,Re,m);Ns&&Me.set(Re,Ns)}if(((yt=(Mt=r.audio)==null?void 0:Mt.tts)==null?void 0:yt.engine)==="browser-kokoro"){const Ns=await a.generate({text:Re,voice:((un=(Gt=r==null?void 0:r.audio)==null?void 0:Gt.tts)==null?void 0:un.voice)??((di=(Kn=s==null?void 0:s.audio)==null?void 0:Kn.tts)==null?void 0:di.voice)}).catch(Oe=>{console.error(Oe),Jt.error(`${Oe}`)});Ns&&He.set(Re,new Audio(Ns))}else if(s.audio.tts.engine!==""){const Ns=await eL(localStorage.token,((Cs=(qi=r==null?void 0:r.audio)==null?void 0:qi.tts)==null?void 0:Cs.defaultVoice)===s.audio.tts.voice?((Ms=(Wi=r==null?void 0:r.audio)==null?void 0:Wi.tts)==null?void 0:Ms.voice)??((yi=(Ki=s==null?void 0:s.audio)==null?void 0:Ki.tts)==null?void 0:yi.voice):(Ps=(yr=s==null?void 0:s.audio)==null?void 0:yr.tts)==null?void 0:Ps.voice,Re).catch(Oe=>(console.error(Oe),null));if(Ns){const Oe=await Ns.blob(),je=URL.createObjectURL(Oe);He.set(Re,new Audio(je))}}else He.set(Re,!0)}catch(Ns){console.error("Error synthesizing speech:",Ns)}return He.get(Re)};let Qe={};const gt=async(Re,Mt)=>{for(;!Mt.aborted;)if(Qe[Re]&&Qe[Re].length>0){const yt=Qe[Re].shift();if(He.has(yt))if(((r==null?void 0:r.showEmojiInCall)??!1)&&Me.has(yt)?t(3,C=Me.get(yt)):t(3,C=null),s.audio.tts.engine!=="")try{`${yt}`;const Gt=He.get(yt);await X(Gt),`${yt}`,await new Promise(un=>setTimeout(un,200))}catch(Gt){console.error("Error playing audio:",Gt)}else await Ce(yt);else Qe[Re].unshift(yt),`${yt}`,await new Promise(Gt=>setTimeout(Gt,200))}else if(W[Re]&&Qe[Re]&&Qe[Re].length===0){t(2,v=!1);break}else await new Promise(yt=>setTimeout(yt,200));`${Re}`},mt=async Re=>{const{id:Mt}=Re.detail;E=!0,le!==Mt&&(`${Mt}`,le=Mt,qe&&qe.abort(),qe=new AbortController,t(2,v=!0),gt(Mt,qe.signal))},Xe=async Re=>{const{id:Mt,content:yt}=Re.detail;if(le===Mt){`${Mt}${yt}`;try{Qe[Mt]===void 0?Qe[Mt]=[yt]:Qe[Mt].push(yt),Ne(yt)}catch(Gt){console.error("Failed to fetch or play audio:",Gt)}}},rt=async Re=>{const{id:Mt,content:yt}=Re.detail;W[Mt]=!0,E=!1};fl(async()=>{const Re=async()=>{try{p=await navigator.wakeLock.request("screen")}catch(Mt){}p&&p.addEventListener("release",()=>{})};return"wakeLock"in navigator&&(await Re(),document.addEventListener("visibilitychange",async()=>{p!==null&&document.visibilityState==="visible"&&await Re()})),t(0,y=i.find(Mt=>Mt.id===b)),ge(),u.addEventListener("chat:start",mt),u.addEventListener("chat",Xe),u.addEventListener("chat:finish",rt),async()=>{await Ke(),N(),u.removeEventListener("chat:start",mt),u.removeEventListener("chat",Xe),u.removeEventListener("chat:finish",rt),qe.abort(),await hn(),await Ke(),await de(!1),await se()}}),$h(async()=>{await Ke(),await de(!1),await se(),await N(),u.removeEventListener("chat:start",mt),u.removeEventListener("chat",Xe),u.removeEventListener("chat:finish",rt),qe.abort(),await hn(),await Ke()});const me=()=>{v&&Ke()},Rt=()=>{v&&Ke()},ct=()=>{se()},at=async Re=>{Re.detail,t(9,P=Re.detail),await Y(),await G()},ze=async()=>{await navigator.mediaDevices.getUserMedia({video:!0}),Z()},Ht=()=>{v&&Ke()},on=async()=>{await N(),await Y(),Va.set(!1),c("close")};return n.$$set=Re=>{"eventTarget"in Re&&t(21,u=Re.eventTarget),"submitPrompt"in Re&&t(22,d=Re.submitPrompt),"stopResponse"in Re&&t(23,f=Re.stopResponse),"files"in Re&&t(20,g=Re.files),"chatId"in Re&&t(24,m=Re.chatId),"modelId"in Re&&t(25,b=Re.modelId)},[y,w,v,C,k,I,T,H,z,P,o,l,c,h,Z,G,Y,se,N,Ke,g,u,d,f,m,b,me,Rt,ct,at,ze,Ht,on]}class uD extends Nt{constructor(e){super(),Ot(this,e,Uae,Bae,Ft,{eventTarget:21,submitPrompt:22,stopResponse:23,files:20,chatId:24,modelId:25},null,[-1,-1,-1])}}function Hae(n){var _,v,C,k,I,E,T,M,D,H;let e,t,i,s,r,a,o=(((v=(_=n[0])==null?void 0:_.model)==null?void 0:v.name)??((k=(C=n[0])==null?void 0:C.message)==null?void 0:k.model)??"Assistant")+"",l,c,h,u,d,f,g,m,b;t=new QI({props:{src:((M=(T=(E=(I=n[0])==null?void 0:I.model)==null?void 0:E.info)==null?void 0:T.meta)==null?void 0:M.profile_image_url)??"",className:"size-5 -translate-y-[1px]"}}),u=new $F({props:{className:"size-3 "+((H=(D=n[0])==null?void 0:D.message)!=null&&H.favorite?"fill-red-500 stroke-red-500":"hover:fill-red-500 hover:stroke-red-500")+" ",strokeWidth:"2.5"}});function p(R,z){var P,B;return(B=(P=R[0])==null?void 0:P.message)!=null&&B.error?Gae:jae}let y=p(n),w=y(n);return{c(){e=te("div"),pe(t.$$.fragment),i=Ae(),s=te("div"),r=te("div"),a=te("div"),l=_t(o),c=Ae(),h=te("button"),pe(u.$$.fragment),f=Ae(),w.c(),this.h()},l(R){e=ne(R,"DIV",{class:!0});var z=V(e);ye(t.$$.fragment,z),i=Se(z),s=ne(z,"DIV",{class:!0});var P=V(s);r=ne(P,"DIV",{class:!0});var B=V(r);a=ne(B,"DIV",{class:!0});var Z=V(a);l=vt(Z,o),Z.forEach(S),c=Se(B),h=ne(B,"BUTTON",{class:!0});var G=V(h);ye(u.$$.fragment,G),G.forEach(S),B.forEach(S),f=Se(P),w.l(P),P.forEach(S),z.forEach(S),this.h()},h(){var R,z;A(a,"class","text-xs text-black dark:text-white font-medium line-clamp-1"),A(h,"class",d=(z=(R=n[0])==null?void 0:R.message)!=null&&z.favorite?"":"invisible group-hover:visible"),A(r,"class","flex justify-between items-center"),A(s,"class","ml-2"),A(e,"class","flex w-full")},m(R,z){ee(R,e,z),be(t,e,null),q(e,i),q(e,s),q(s,r),q(r,a),q(a,l),q(r,c),q(r,h),be(u,h,null),q(s,f),w.m(s,null),g=!0,m||(b=pt(h,"click",n[1]),m=!0)},p(R,z){var Z,G,Y,J,se,fe,he,de,ge,N,K,oe;const P={};z&1&&(P.src=((J=(Y=(G=(Z=R[0])==null?void 0:Z.model)==null?void 0:G.info)==null?void 0:Y.meta)==null?void 0:J.profile_image_url)??""),t.$set(P),(!g||z&1)&&o!==(o=(((fe=(se=R[0])==null?void 0:se.model)==null?void 0:fe.name)??((de=(he=R[0])==null?void 0:he.message)==null?void 0:de.model)??"Assistant")+"")&&St(l,o);const B={};z&1&&(B.className="size-3 "+((N=(ge=R[0])==null?void 0:ge.message)!=null&&N.favorite?"fill-red-500 stroke-red-500":"hover:fill-red-500 hover:stroke-red-500")+" "),u.$set(B),(!g||z&1&&d!==(d=(oe=(K=R[0])==null?void 0:K.message)!=null&&oe.favorite?"":"invisible group-hover:visible"))&&A(h,"class",d),y===(y=p(R))&&w?w.p(R,z):(w.d(1),w=y(R),w&&(w.c(),w.m(s,null)))},i(R){g||(L(t.$$.fragment,R),L(u.$$.fragment,R),g=!0)},o(R){j(t.$$.fragment,R),j(u.$$.fragment,R),g=!1},d(R){R&&S(e),xe(t),xe(u),w.d(),m=!1,b()}}}function zae(n){var g,m,b;let e,t,i,s,r,a,o=(((m=(g=n[0])==null?void 0:g.user)==null?void 0:m.name)??"User")+"",l,c,h;t=new QI({props:{src:((b=n[0].user)==null?void 0:b.profile_image_url)??`${tl}/user.png`,className:"size-5 -translate-y-[1px]"}});function u(p,y){var w,_;return(_=(w=p[0])==null?void 0:w.message)!=null&&_.error?qae:Vae}let d=u(n),f=d(n);return{c(){e=te("div"),pe(t.$$.fragment),i=Ae(),s=te("div"),r=te("div"),a=te("div"),l=_t(o),c=Ae(),f.c(),this.h()},l(p){e=ne(p,"DIV",{class:!0});var y=V(e);ye(t.$$.fragment,y),i=Se(y),s=ne(y,"DIV",{class:!0});var w=V(s);r=ne(w,"DIV",{class:!0});var _=V(r);a=ne(_,"DIV",{class:!0});var v=V(a);l=vt(v,o),v.forEach(S),_.forEach(S),c=Se(w),f.l(w),w.forEach(S),y.forEach(S),this.h()},h(){A(a,"class","text-xs text-black dark:text-white font-medium line-clamp-1"),A(r,"class","flex justify-between items-center"),A(s,"class","ml-2"),A(e,"class","flex w-full")},m(p,y){ee(p,e,y),be(t,e,null),q(e,i),q(e,s),q(s,r),q(r,a),q(a,l),q(s,c),f.m(s,null),h=!0},p(p,y){var _,v,C;const w={};y&1&&(w.src=((_=p[0].user)==null?void 0:_.profile_image_url)??`${tl}/user.png`),t.$set(w),(!h||y&1)&&o!==(o=(((C=(v=p[0])==null?void 0:v.user)==null?void 0:C.name)??"User")+"")&&St(l,o),d===(d=u(p))&&f?f.p(p,y):(f.d(1),f=d(p),f&&(f.c(),f.m(s,null)))},i(p){h||(L(t.$$.fragment,p),h=!0)},o(p){j(t.$$.fragment,p),h=!1},d(p){p&&S(e),xe(t),f.d()}}}function jae(n){let e,t=n[0].message.content+"",i;return{c(){e=te("div"),i=_t(t),this.h()},l(s){e=ne(s,"DIV",{class:!0});var r=V(e);i=vt(r,t),r.forEach(S),this.h()},h(){A(e,"class","text-gray-500 line-clamp-2 text-xs mt-0.5")},m(s,r){ee(s,e,r),q(e,i)},p(s,r){r&1&&t!==(t=s[0].message.content+"")&&St(i,t)},d(s){s&&S(e)}}}function Gae(n){let e,t=n[0].message.error.content+"",i;return{c(){e=te("div"),i=_t(t),this.h()},l(s){e=ne(s,"DIV",{class:!0});var r=V(e);i=vt(r,t),r.forEach(S),this.h()},h(){A(e,"class","text-red-500 line-clamp-2 text-xs mt-0.5")},m(s,r){ee(s,e,r),q(e,i)},p(s,r){r&1&&t!==(t=s[0].message.error.content+"")&&St(i,t)},d(s){s&&S(e)}}}function Vae(n){let e,t=n[0].message.content+"",i;return{c(){e=te("div"),i=_t(t),this.h()},l(s){e=ne(s,"DIV",{class:!0});var r=V(e);i=vt(r,t),r.forEach(S),this.h()},h(){A(e,"class","text-gray-500 line-clamp-2 text-xs mt-0.5")},m(s,r){ee(s,e,r),q(e,i)},p(s,r){r&1&&t!==(t=s[0].message.content+"")&&St(i,t)},d(s){s&&S(e)}}}function qae(n){let e,t=n[0].message.error.content+"",i;return{c(){e=te("div"),i=_t(t),this.h()},l(s){e=ne(s,"DIV",{class:!0});var r=V(e);i=vt(r,t),r.forEach(S),this.h()},h(){A(e,"class","text-red-500 line-clamp-2 text-xs mt-0.5")},m(s,r){ee(s,e,r),q(e,i)},p(s,r){r&1&&t!==(t=s[0].message.error.content+"")&&St(i,t)},d(s){s&&S(e)}}}function Wae(n){let e,t,i,s;const r=[zae,Hae],a=[];function o(l,c){return l[0].message.role==="user"?0:1}return e=o(n),t=a[e]=r[e](n),{c(){t.c(),i=Ut()},l(l){t.l(l),i=Ut()},m(l,c){a[e].m(l,c),ee(l,i,c),s=!0},p(l,c){let h=e;e=o(l),e===h?a[e].p(l,c):(ot(),j(a[h],1,1,()=>{a[h]=null}),lt(),t=a[e],t?t.p(l,c):(t=a[e]=r[e](l),t.c()),L(t,1),t.m(i.parentNode,i))},i(l){s||(L(t),s=!0)},o(l){j(t),s=!1},d(l){l&&S(i),a[e].d(l)}}}function Kae(n){var l,c;let e,t,i,s,r,a,o;return t=new Ci({props:{content:(c=(l=n[0])==null?void 0:l.message)!=null&&c.error?n[0].message.error.content:n[0].message.content,class:"w-full",allowHTML:!1,$$slots:{default:[Wae]},$$scope:{ctx:n}}}),s=new Yg({props:{type:"target",position:xn.Top,class:"w-2 rounded-full dark:bg-gray-900"}}),a=new Yg({props:{type:"source",position:xn.Bottom,class:"w-2 rounded-full dark:bg-gray-900"}}),{c(){e=te("div"),pe(t.$$.fragment),i=Ae(),pe(s.$$.fragment),r=Ae(),pe(a.$$.fragment),this.h()},l(h){e=ne(h,"DIV",{class:!0});var u=V(e);ye(t.$$.fragment,u),i=Se(u),ye(s.$$.fragment,u),r=Se(u),ye(a.$$.fragment,u),u.forEach(S),this.h()},h(){A(e,"class","px-4 py-3 shadow-md rounded-xl dark:bg-black bg-white border dark:border-gray-900 w-60 h-20 group")},m(h,u){ee(h,e,u),be(t,e,null),q(e,i),be(s,e,null),q(e,r),be(a,e,null),o=!0},p(h,[u]){var f,g;const d={};u&1&&(d.content=(g=(f=h[0])==null?void 0:f.message)!=null&&g.error?h[0].message.error.content:h[0].message.content),u&5&&(d.$$scope={dirty:u,ctx:h}),t.$set(d)},i(h){o||(L(t.$$.fragment,h),L(s.$$.fragment,h),L(a.$$.fragment,h),o=!0)},o(h){j(t.$$.fragment,h),j(s.$$.fragment,h),j(a.$$.fragment,h),o=!1},d(h){h&&S(e),xe(t),xe(s),xe(a)}}}function Xae(n,e,t){let{data:i}=e;const s=()=>{var r;t(0,i.message.favorite=!(((r=i==null?void 0:i.message)==null?void 0:r.favorite)??!1),i)};return n.$$set=r=>{"data"in r&&t(0,i=r.data)},[i,s]}let Yae=class extends Nt{constructor(e){super(),Ot(this,e,Xae,Kae,Ft,{data:0})}};function Jae(n){let e,t,i,s;return e=new Hre({props:{showLock:!1}}),i=new Qre({props:{variant:y0.Dots}}),{c(){pe(e.$$.fragment),t=Ae(),pe(i.$$.fragment)},l(r){ye(e.$$.fragment,r),t=Se(r),ye(i.$$.fragment,r)},m(r,a){be(e,r,a),ee(r,t,a),be(i,r,a),s=!0},p:kt,i(r){s||(L(e.$$.fragment,r),L(i.$$.fragment,r),s=!0)},o(r){j(e.$$.fragment,r),j(i.$$.fragment,r),s=!1},d(r){r&&S(t),xe(e,r),xe(i,r)}}}function Zae(n){let e,t;return e=new dre({props:{nodes:n[0],nodeTypes:n[1],edges:n[2],fitView:!0,minZoom:.001,colorMode:n[3].includes("dark")||n[3]==="system"&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",nodesConnectable:!1,nodesDraggable:!1,oninit:n[5],$$slots:{default:[Jae]},$$scope:{ctx:n}}}),e.$on("nodeclick",n[6]),{c(){pe(e.$$.fragment)},l(i){ye(e.$$.fragment,i)},m(i,s){be(e,i,s),t=!0},p(i,[s]){const r={};s&1&&(r.nodes=i[0]),s&2&&(r.nodeTypes=i[1]),s&4&&(r.edges=i[2]),s&8&&(r.colorMode=i[3].includes("dark")||i[3]==="system"&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),s&128&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(L(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){xe(e,i)}}}function Qae(n,e,t){let i;Pe(n,LD,h=>t(3,i=h));const s=eo();let{nodes:r}=e,{nodeTypes:a}=e,{edges:o}=e;const l=()=>{},c=h=>s("nodeclick",h.detail);return n.$$set=h=>{"nodes"in h&&t(0,r=h.nodes),"nodeTypes"in h&&t(1,a=h.nodeTypes),"edges"in h&&t(2,o=h.edges)},[r,a,o,i,s,l,c]}class $ae extends Nt{constructor(e){super(),Ot(this,e,Qae,Zae,Ft,{nodes:0,nodeTypes:1,edges:2})}}function eoe(n){let e,t;return{c(){e=nt("svg"),t=nt("path"),this.h()},l(i){e=it(i,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=V(e);t=it(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),V(t).forEach(S),s.forEach(S),this.h()},h(){A(t,"stroke-linecap","round"),A(t,"stroke-linejoin","round"),A(t,"d","M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"),A(e,"xmlns","http://www.w3.org/2000/svg"),A(e,"fill","none"),A(e,"viewBox","0 0 24 24"),A(e,"stroke-width",n[1]),A(e,"stroke","currentColor"),A(e,"class",n[0])},m(i,s){ee(i,e,s),q(e,t)},p(i,[s]){s&2&&A(e,"stroke-width",i[1]),s&1&&A(e,"class",i[0])},i:kt,o:kt,d(i){i&&S(e)}}}function toe(n,e,t){let{className:i="size-4"}=e,{strokeWidth:s="1.5"}=e;return n.$$set=r=>{"className"in r&&t(0,i=r.className),"strokeWidth"in r&&t(1,s=r.strokeWidth)},[i,s]}class dD extends Nt{constructor(e){super(),Ot(this,e,toe,eoe,Ft,{className:0,strokeWidth:1})}}function xI(n){let e,t;return e=new $ae({props:{nodes:n[6],nodeTypes:n[8],edges:n[7]}}),e.$on("nodeclick",n[12]),{c(){pe(e.$$.fragment)},l(i){ye(e.$$.fragment,i)},m(i,s){be(e,i,s),t=!0},p:kt,i(i){t||(L(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){xe(e,i)}}}function noe(n){let e,t,i,s,r,a,o,l=n[1].t("Chat Overview")+"",c,h,u,d,f,g,m,b;r=new dD({props:{className:"size-3.5"}}),d=new ux({props:{className:"size-3.5"}});let p=n[2].length>0&&xI(n);return{c(){e=te("div"),t=te("div"),i=te("div"),s=te("button"),pe(r.$$.fragment),a=Ae(),o=te("div"),c=_t(l),h=Ae(),u=te("button"),pe(d.$$.fragment),f=Ae(),p&&p.c(),this.h()},l(y){e=ne(y,"DIV",{class:!0});var w=V(e);t=ne(w,"DIV",{class:!0});var _=V(t);i=ne(_,"DIV",{class:!0});var v=V(i);s=ne(v,"BUTTON",{class:!0});var C=V(s);ye(r.$$.fragment,C),C.forEach(S),a=Se(v),o=ne(v,"DIV",{class:!0});var k=V(o);c=vt(k,l),k.forEach(S),v.forEach(S),h=Se(_),u=ne(_,"BUTTON",{class:!0});var I=V(u);ye(d.$$.fragment,I),I.forEach(S),_.forEach(S),f=Se(w),p&&p.l(w),w.forEach(S),this.h()},h(){A(s,"class","self-center p-0.5"),A(o,"class","text-lg font-medium self-center font-primary"),A(i,"class","flex items-center gap-2.5"),A(u,"class","self-center p-0.5"),A(t,"class","absolute z-50 w-full flex justify-between dark:text-gray-100 px-4 py-3.5"),A(e,"class","w-full h-full relative")},m(y,w){ee(y,e,w),q(e,t),q(t,i),q(i,s),be(r,s,null),q(i,a),q(i,o),q(o,c),q(t,h),q(t,u),be(d,u,null),q(e,f),p&&p.m(e,null),g=!0,m||(b=[pt(s,"click",n[10]),pt(u,"click",n[11])],m=!0)},p(y,[w]){(!g||w&2)&&l!==(l=y[1].t("Chat Overview")+"")&&St(c,l),y[2].length>0?p?(p.p(y,w),w&4&&L(p,1)):(p=xI(y),p.c(),L(p,1),p.m(e,null)):p&&(ot(),j(p,1,1,()=>{p=null}),lt())},i(y){g||(L(r.$$.fragment,y),L(d.$$.fragment,y),L(p),g=!0)},o(y){j(r.$$.fragment,y),j(d.$$.fragment,y),j(p),g=!1},d(y){y&&S(e),xe(r),xe(d),p&&p.d(),m=!1,ia(b)}}}function ioe(n,e,t){let i,s,r,a;Pe(n,em,E=>t(13,i=E)),Pe(n,T0,E=>t(14,s=E));const o=eo(),l=hs("i18n");Pe(n,l,E=>t(1,r=E));const{width:c,height:h}=rs(),{fitView:u,getViewport:d}=$re(),f=eae();let{history:g}=e,m=null;const b=nn([]);Pe(n,b,E=>t(2,a=E));const p=nn([]),y={custom:Yae},w=async()=>{m===null?await u({nodes:[{id:g.currentId}]}):await u({nodes:[{id:m}]}),t(0,m=null)},_=async()=>{const E=[],T=[];let H=new Map,R={};Object.keys(g.messages).forEach(z=>{var Z;const P=g.messages[z],B=P.parentId?(((Z=H.get(P.parentId))==null?void 0:Z.level)??-1)+1:0;R[B]||(R[B]=0),H.set(z,{id:P.id,level:B,position:R[B]++})}),Object.keys(g.messages).forEach(z=>{const P=H.get(z),B=P.position*250,Z=P.level*150,G=B;E.push({id:P.id,type:"custom",data:{user:s,message:g.messages[z],model:i.find(J=>J.id===g.messages[z].model)},position:{x:G,y:Z}});const Y=g.messages[z].parentId;Y&&T.push({id:Y+"-"+P.id,source:Y,target:P.id,selectable:!1,class:" dark:fill-gray-300 fill-gray-300",type:"smoothstep",animated:g.currentId===z||v(z,g.currentId)})}),await p.set([...T]),await b.set([...E])},v=(E,T)=>{const M=g.messages[E];return M.childrenIds&&M.childrenIds.some(D=>D===T||v(D,T))};fl(()=>{_(),f.subscribe(async E=>{E&&(await hn(),await u({nodes:[{id:g.currentId}]}))}),c.subscribe(E=>{E&&u({nodes:[{id:g.currentId}]})}),h.subscribe(E=>{E&&u({nodes:[{id:g.currentId}]})})}),$h(()=>{b.set([]),p.set([])});const C=()=>{u0.set(!1)},k=()=>{o("close"),u0.set(!1)},I=E=>{E.detail.node.data,o("nodeclick",E.detail),t(0,m=E.detail.node.data.message.id),u({nodes:[{id:m}]})};return n.$$set=E=>{"history"in E&&t(9,g=E.history)},n.$$.update=()=>{n.$$.dirty&512&&g&&_(),n.$$.dirty&512&&g&&g.currentId&&w()},[m,r,a,o,l,u,b,p,y,g,C,k,I]}class fD extends Nt{constructor(e){super(),Ot(this,e,ioe,noe,Ft,{history:9})}}function soe(n){let e,t;return{c(){e=nt("svg"),t=nt("path"),this.h()},l(i){e=it(i,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=V(e);t=it(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),V(t).forEach(S),s.forEach(S),this.h()},h(){A(t,"stroke-linecap","round"),A(t,"stroke-linejoin","round"),A(t,"d","M3.75 3.75v4.5m0-4.5h4.5m-4.5 0L9 9M3.75 20.25v-4.5m0 4.5h4.5m-4.5 0L9 15M20.25 3.75h-4.5m4.5 0v4.5m0-4.5L15 9m5.25 11.25h-4.5m4.5 0v-4.5m0 4.5L15 15"),A(e,"xmlns","http://www.w3.org/2000/svg"),A(e,"fill","none"),A(e,"viewBox","0 0 24 24"),A(e,"stroke-width",n[1]),A(e,"stroke","currentColor"),A(e,"class",n[0])},m(i,s){ee(i,e,s),q(e,t)},p(i,[s]){s&2&&A(e,"stroke-width",i[1]),s&1&&A(e,"class",i[0])},i:kt,o:kt,d(i){i&&S(e)}}}function roe(n,e,t){let{className:i="size-4"}=e,{strokeWidth:s="1.5"}=e;return n.$$set=r=>{"className"in r&&t(0,i=r.className),"strokeWidth"in r&&t(1,s=r.strokeWidth)},[i,s]}class aoe extends Nt{constructor(e){super(),Ot(this,e,roe,soe,Ft,{className:0,strokeWidth:1})}}function yI(n){let e,t,i,s,r,a,o,l,c,h,u,d,f,g=n[5].t("Version {{selectedVersion}} of {{totalVersions}}",{selectedVersion:n[2]+1,totalVersions:n[1].length})+"",m,b,p,y,w,_,v,C,k,I=(n[3]?n[5].t("Copied"):n[5].t("Copy"))+"",E,T,M,D,H,R,z,P,B,Z;i=new dD({props:{className:"size-3.5  text-gray-900 dark:text-white"}}),M=new Ci({props:{content:n[5].t("Download"),$$slots:{default:[ooe]},$$scope:{ctx:n}}});let G=n[1][n[2]].type==="iframe"&&wI(n);return z=new ux({props:{className:"size-3.5 text-gray-900 dark:text-white"}}),{c(){e=te("div"),t=te("button"),pe(i.$$.fragment),s=Ae(),r=te("div"),a=te("div"),o=te("div"),l=te("button"),c=nt("svg"),h=nt("path"),d=Ae(),f=te("div"),m=_t(g),b=Ae(),p=te("button"),y=nt("svg"),w=nt("path"),v=Ae(),C=te("div"),k=te("button"),E=_t(I),T=Ae(),pe(M.$$.fragment),D=Ae(),G&&G.c(),H=Ae(),R=te("button"),pe(z.$$.fragment),this.h()},l(Y){e=ne(Y,"DIV",{class:!0});var J=V(e);t=ne(J,"BUTTON",{class:!0});var se=V(t);ye(i.$$.fragment,se),se.forEach(S),s=Se(J),r=ne(J,"DIV",{class:!0});var fe=V(r);a=ne(fe,"DIV",{class:!0});var he=V(a);o=ne(he,"DIV",{class:!0,dir:!0});var de=V(o);l=ne(de,"BUTTON",{class:!0});var ge=V(l);c=it(ge,"svg",{xmlns:!0,fill:!0,viewBox:!0,stroke:!0,"stroke-width":!0,class:!0});var N=V(c);h=it(N,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),V(h).forEach(S),N.forEach(S),ge.forEach(S),d=Se(de),f=ne(de,"DIV",{class:!0});var K=V(f);m=vt(K,g),K.forEach(S),b=Se(de),p=ne(de,"BUTTON",{class:!0});var oe=V(p);y=it(oe,"svg",{xmlns:!0,fill:!0,viewBox:!0,stroke:!0,"stroke-width":!0,class:!0});var W=V(y);w=it(W,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),V(w).forEach(S),W.forEach(S),oe.forEach(S),de.forEach(S),he.forEach(S),v=Se(fe),C=ne(fe,"DIV",{class:!0});var le=V(C);k=ne(le,"BUTTON",{class:!0});var ce=V(k);E=vt(ce,I),ce.forEach(S),T=Se(le),ye(M.$$.fragment,le),D=Se(le),G&&G.l(le),le.forEach(S),fe.forEach(S),H=Se(J),R=ne(J,"BUTTON",{class:!0});var Ce=V(R);ye(z.$$.fragment,Ce),Ce.forEach(S),J.forEach(S),this.h()},h(){A(t,"class","self-center pointer-events-auto p-1 rounded-full bg-white dark:bg-gray-850"),A(h,"stroke-linecap","round"),A(h,"stroke-linejoin","round"),A(h,"d","M15.75 19.5 8.25 12l7.5-7.5"),A(c,"xmlns","http://www.w3.org/2000/svg"),A(c,"fill","none"),A(c,"viewBox","0 0 24 24"),A(c,"stroke","currentColor"),A(c,"stroke-width","2.5"),A(c,"class","size-3.5"),A(l,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition disabled:cursor-not-allowed"),l.disabled=u=n[1].length<=1,A(f,"class","text-xs self-center dark:text-gray-100 min-w-fit"),A(w,"stroke-linecap","round"),A(w,"stroke-linejoin","round"),A(w,"d","m8.25 4.5 7.5 7.5-7.5 7.5"),A(y,"xmlns","http://www.w3.org/2000/svg"),A(y,"fill","none"),A(y,"viewBox","0 0 24 24"),A(y,"stroke","currentColor"),A(y,"stroke-width","2.5"),A(y,"class","size-3.5"),A(p,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition disabled:cursor-not-allowed"),p.disabled=_=n[1].length<=1,A(o,"class","flex items-center gap-0.5 self-center min-w-fit"),A(o,"dir","ltr"),A(a,"class","flex items-center space-x-2"),A(k,"class","copy-code-button bg-none border-none text-xs bg-gray-50 hover:bg-gray-100 dark:bg-gray-850 dark:hover:bg-gray-800 transition rounded-md px-1.5 py-0.5"),A(C,"class","flex items-center gap-1.5"),A(r,"class","flex-1 flex items-center justify-between pr-1"),A(R,"class","self-center pointer-events-auto p-1 rounded-full bg-white dark:bg-gray-850"),A(e,"class","pointer-events-auto z-20 flex justify-between items-center p-2.5 font-primar text-gray-900 dark:text-white")},m(Y,J){ee(Y,e,J),q(e,t),be(i,t,null),q(e,s),q(e,r),q(r,a),q(a,o),q(o,l),q(l,c),q(c,h),q(o,d),q(o,f),q(f,m),q(o,b),q(o,p),q(p,y),q(y,w),q(r,v),q(r,C),q(C,k),q(k,E),q(C,T),be(M,C,null),q(C,D),G&&G.m(C,null),q(e,H),q(e,R),be(z,R,null),P=!0,B||(Z=[pt(t,"click",n[14]),pt(l,"click",n[15]),pt(p,"click",n[16]),pt(k,"click",n[17]),pt(R,"click",n[18])],B=!0)},p(Y,J){(!P||J&2&&u!==(u=Y[1].length<=1))&&(l.disabled=u),(!P||J&38)&&g!==(g=Y[5].t("Version {{selectedVersion}} of {{totalVersions}}",{selectedVersion:Y[2]+1,totalVersions:Y[1].length})+"")&&St(m,g),(!P||J&2&&_!==(_=Y[1].length<=1))&&(p.disabled=_),(!P||J&40)&&I!==(I=(Y[3]?Y[5].t("Copied"):Y[5].t("Copy"))+"")&&St(E,I);const se={};J&32&&(se.content=Y[5].t("Download")),J&8388608&&(se.$$scope={dirty:J,ctx:Y}),M.$set(se),Y[1][Y[2]].type==="iframe"?G?(G.p(Y,J),J&6&&L(G,1)):(G=wI(Y),G.c(),L(G,1),G.m(C,null)):G&&(ot(),j(G,1,1,()=>{G=null}),lt())},i(Y){P||(L(i.$$.fragment,Y),L(M.$$.fragment,Y),L(G),L(z.$$.fragment,Y),P=!0)},o(Y){j(i.$$.fragment,Y),j(M.$$.fragment,Y),j(G),j(z.$$.fragment,Y),P=!1},d(Y){Y&&S(e),xe(i),xe(M),G&&G.d(),xe(z),B=!1,ia(Z)}}}function ooe(n){let e,t,i,s,r;return t=new jF({props:{className:"size-3.5"}}),{c(){e=te("button"),pe(t.$$.fragment),this.h()},l(a){e=ne(a,"BUTTON",{class:!0});var o=V(e);ye(t.$$.fragment,o),o.forEach(S),this.h()},h(){A(e,"class","bg-none border-none text-xs bg-gray-50 hover:bg-gray-100 dark:bg-gray-850 dark:hover:bg-gray-800 transition rounded-md p-0.5")},m(a,o){ee(a,e,o),be(t,e,null),i=!0,s||(r=pt(e,"click",n[12]),s=!0)},p:kt,i(a){i||(L(t.$$.fragment,a),i=!0)},o(a){j(t.$$.fragment,a),i=!1},d(a){a&&S(e),xe(t),s=!1,r()}}}function wI(n){let e,t;return e=new Ci({props:{content:n[5].t("Open in full screen"),$$slots:{default:[loe]},$$scope:{ctx:n}}}),{c(){pe(e.$$.fragment)},l(i){ye(e.$$.fragment,i)},m(i,s){be(e,i,s),t=!0},p(i,s){const r={};s&32&&(r.content=i[5].t("Open in full screen")),s&8388608&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(L(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){xe(e,i)}}}function loe(n){let e,t,i,s,r;return t=new aoe({props:{className:"size-3.5"}}),{c(){e=te("button"),pe(t.$$.fragment),this.h()},l(a){e=ne(a,"BUTTON",{class:!0});var o=V(e);ye(t.$$.fragment,o),o.forEach(S),this.h()},h(){A(e,"class","bg-none border-none text-xs bg-gray-50 hover:bg-gray-100 dark:bg-gray-850 dark:hover:bg-gray-800 transition rounded-md p-0.5")},m(a,o){ee(a,e,o),be(t,e,null),i=!0,s||(r=pt(e,"click",n[11]),s=!0)},p:kt,i(a){i||(L(t.$$.fragment,a),i=!0)},o(a){j(t.$$.fragment,a),i=!1},d(a){a&&S(e),xe(t),s=!1,r()}}}function _I(n){let e;return{c(){e=te("div"),this.h()},l(t){e=ne(t,"DIV",{class:!0}),V(e).forEach(S),this.h()},h(){A(e,"class","absolute top-0 left-0 right-0 bottom-0 z-10")},m(t,i){ee(t,e,i)},d(t){t&&S(e)}}}function coe(n){let e,t=n[5].t("No HTML, CSS, or JavaScript content found.")+"",i;return{c(){e=te("div"),i=_t(t),this.h()},l(s){e=ne(s,"DIV",{class:!0});var r=V(e);i=vt(r,t),r.forEach(S),this.h()},h(){A(e,"class","m-auto font-medium text-xs text-gray-900 dark:text-white")},m(s,r){ee(s,e,r),q(e,i)},p(s,r){r&32&&t!==(t=s[5].t("No HTML, CSS, or JavaScript content found.")+"")&&St(i,t)},i:kt,o:kt,d(s){s&&S(e)}}}function hoe(n){let e,t,i,s;const r=[doe,uoe],a=[];function o(l,c){return l[1][l[2]].type==="iframe"?0:l[1][l[2]].type==="svg"?1:-1}return~(t=o(n))&&(i=a[t]=r[t](n)),{c(){e=te("div"),i&&i.c(),this.h()},l(l){e=ne(l,"DIV",{class:!0});var c=V(e);i&&i.l(c),c.forEach(S),this.h()},h(){A(e,"class","max-w-full w-full h-full")},m(l,c){ee(l,e,c),~t&&a[t].m(e,null),s=!0},p(l,c){let h=t;t=o(l),t===h?~t&&a[t].p(l,c):(i&&(ot(),j(a[h],1,1,()=>{a[h]=null}),lt()),~t?(i=a[t],i?i.p(l,c):(i=a[t]=r[t](l),i.c()),L(i,1),i.m(e,null)):i=null)},i(l){s||(L(i),s=!0)},o(l){j(i),s=!1},d(l){l&&S(e),~t&&a[t].d()}}}function uoe(n){let e,t;return e=new SD({props:{className:" w-full h-full max-h-full overflow-hidden",svg:n[1][n[2]].content}}),{c(){pe(e.$$.fragment)},l(i){ye(e.$$.fragment,i)},m(i,s){be(e,i,s),t=!0},p(i,s){const r={};s&6&&(r.svg=i[1][i[2]].content),e.$set(r)},i(i){t||(L(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){xe(e,i)}}}function doe(n){let e,t,i,s,r;return{c(){e=te("iframe"),this.h()},l(a){e=ne(a,"IFRAME",{title:!0,srcdoc:!0,class:!0,sandbox:!0}),V(e).forEach(S),this.h()},h(){var a,o;A(e,"title","Content"),A(e,"srcdoc",t=n[1][n[2]].content),A(e,"class","w-full border-0 h-full rounded-none"),A(e,"sandbox",i="allow-scripts allow-downloads"+(((a=n[6])==null?void 0:a.iframeSandboxAllowForms)??!1?" allow-forms":"")+(((o=n[6])==null?void 0:o.iframeSandboxAllowSameOrigin)??!1?" allow-same-origin":""))},m(a,o){ee(a,e,o),n[19](e),s||(r=pt(e,"load",n[10]),s=!0)},p(a,o){var l,c;o&6&&t!==(t=a[1][a[2]].content)&&A(e,"srcdoc",t),o&64&&i!==(i="allow-scripts allow-downloads"+(((l=a[6])==null?void 0:l.iframeSandboxAllowForms)??!1?" allow-forms":"")+(((c=a[6])==null?void 0:c.iframeSandboxAllowSameOrigin)??!1?" allow-same-origin":""))&&A(e,"sandbox",i)},i:kt,o:kt,d(a){a&&S(e),n[19](null),s=!1,r()}}}function foe(n){let e,t,i,s,r,a,o,l,c,h=n[1].length>0&&yI(n),u=n[0]&&_I();const d=[hoe,coe],f=[];function g(m,b){return m[1].length>0?0:1}return o=g(n),l=f[o]=d[o](n),{c(){e=te("div"),t=te("div"),h&&h.c(),i=Ae(),u&&u.c(),s=Ae(),r=te("div"),a=te("div"),l.c(),this.h()},l(m){e=ne(m,"DIV",{class:!0});var b=V(e);t=ne(b,"DIV",{class:!0});var p=V(t);h&&h.l(p),i=Se(p),u&&u.l(p),s=Se(p),r=ne(p,"DIV",{class:!0});var y=V(r);a=ne(y,"DIV",{class:!0});var w=V(a);l.l(w),w.forEach(S),y.forEach(S),p.forEach(S),b.forEach(S),this.h()},h(){A(a,"class","h-full flex flex-col"),A(r,"class","flex-1 w-full h-full"),A(t,"class","w-full h-full flex flex-col flex-1 relative"),A(e,"class","w-full h-full relative flex flex-col bg-gray-50 dark:bg-gray-850")},m(m,b){ee(m,e,b),q(e,t),h&&h.m(t,null),q(t,i),u&&u.m(t,null),q(t,s),q(t,r),q(r,a),f[o].m(a,null),c=!0},p(m,[b]){m[1].length>0?h?(h.p(m,b),b&2&&L(h,1)):(h=yI(m),h.c(),L(h,1),h.m(t,i)):h&&(ot(),j(h,1,1,()=>{h=null}),lt()),m[0]?u||(u=_I(),u.c(),u.m(t,s)):u&&(u.d(1),u=null);let p=o;o=g(m),o===p?f[o].p(m,b):(ot(),j(f[p],1,1,()=>{f[p]=null}),lt(),l=f[o],l?l.p(m,b):(l=f[o]=d[o](m),l.c()),L(l,1),l.m(a,null))},i(m){c||(L(h),L(l),c=!0)},o(m){j(h),j(l),c=!1},d(m){m&&S(e),h&&h.d(),u&&u.d(),f[o].d()}}}function goe(n,e,t){let i,s,r;Pe(n,xu,T=>t(21,i=T)),Pe(n,Ya,T=>t(6,r=T));const a=hs("i18n");Pe(n,a,T=>t(5,s=T));const o=eo();let{overlay:l=!1}=e,{history:c}=e,h=[],u=[],d=0,f=!1,g;const m=()=>{t(1,u=[]),h.forEach(T=>{if((T==null?void 0:T.role)!=="user"&&(T!=null&&T.content)){const M=T.content.match(/```[\s\S]*?```/g);let D=[];M&&M.forEach(G=>{const Y=G.split(`
`)[0].replace("```","").trim().toLowerCase(),J=G.replace(/```[\s\S]*?\n/,"").replace(/```$/,"");D.push({lang:Y,code:J})});let H="",R="",z="";D.forEach(G=>{const{lang:Y,code:J}=G;Y==="html"?H+=J+`
`:Y==="css"?R+=J+`
`:(Y==="javascript"||Y==="js")&&(z+=J+`
`)});const P=T.content.match(/<html>[\s\S]*?<\/html>/gi),B=T.content.match(/<style>[\s\S]*?<\/style>/gi),Z=T.content.match(/<script>[\s\S]*?<\/script>/gi);if(P&&P.forEach(G=>{const Y=G.replace(/<\/?html>/gi,"");H+=Y+`
`}),B&&B.forEach(G=>{const Y=G.replace(/<\/?style>/gi,"");R+=Y+`
`}),Z&&Z.forEach(G=>{const Y=G.replace(/<\/?script>/gi,"");z+=Y+`
`}),H||R||z){const G=`
                        <!DOCTYPE html>
                        <html lang="en">
                        <head>
                            <meta charset="UTF-8">
                            <meta name="viewport" content="width=device-width, initial-scale=1.0">
							<style>
								body {
									background-color: white; /* Ensure the iframe has a white background */
								}

								${R}
							</style>
                        </head>
                        <body>
                            ${H}

							<script>
                            	${z}
							<\/script>
                        </body>
                        </html>
                    `;t(1,u=[...u,{type:"iframe",content:G}])}else for(const G of D)(G.lang==="svg"||G.lang==="xml"&&G.code.includes("<svg"))&&t(1,u=[...u,{type:"svg",content:G.code}])}}),u.length===0&&(Qi.set(!1),ic.set(!1)),t(2,d=u?u.length-1:0)};function b(T){t(2,d=T==="prev"?Math.max(d-1,0):Math.min(d+1,u.length-1))}const p=()=>{g.contentWindow.addEventListener("click",function(T){const M=T.target.closest("a");if(M&&M.href){T.preventDefault();const D=new URL(M.href,g.baseURI);D.origin===window.location.origin?g.contentWindow.history.pushState(null,"",D.pathname+D.search+D.hash):console.info("External navigation blocked:",D.href)}},!0),g.contentWindow.addEventListener("mouseenter",function(T){T.preventDefault(),g.contentWindow.addEventListener("dragstart",M=>{M.preventDefault()})})},y=()=>{g.requestFullscreen?g.requestFullscreen():g.webkitRequestFullscreen?g.webkitRequestFullscreen():g.msRequestFullscreen&&g.msRequestFullscreen()},w=()=>{const T=new Blob([u[d].content],{type:"text/html"}),M=URL.createObjectURL(T),D=document.createElement("a");D.href=M,D.download=`artifact-${i}-${d}.html`,document.body.appendChild(D),D.click(),document.body.removeChild(D),URL.revokeObjectURL(M)};fl(()=>{BD.subscribe(T=>{if(u){const M=u.findIndex(D=>D.content.includes(T));t(2,d=M!==-1?M:0)}})});const _=()=>{ic.set(!1)},v=()=>b("prev"),C=()=>b("next"),k=()=>{l4(u[d].content),t(3,f=!0),setTimeout(()=>{t(3,f=!1)},2e3)},I=()=>{o("close"),Qi.set(!1),ic.set(!1)};function E(T){At[T?"unshift":"push"](()=>{g=T,t(4,g)})}return n.$$set=T=>{"overlay"in T&&t(0,l=T.overlay),"history"in T&&t(13,c=T.history)},n.$$.update=()=>{n.$$.dirty&8192&&(c?(h=da(c,c.currentId),m()):(h=[],m()))},[l,u,d,f,g,s,r,a,o,b,p,y,w,c,_,v,C,k,I,E]}class gD extends Nt{constructor(e){super(),Ot(this,e,goe,foe,Ft,{overlay:0,history:13})}}function moe(n){let e,t,i,s,r=n[16]&&vI(n);function a(l){n[37](l)}let o={defaultSize:0,onResize:n[35],onCollapse:n[36],collapsible:!0,class:" z-10 ",$$slots:{default:[voe]},$$scope:{ctx:n}};return n[4]!==void 0&&(o.pane=n[4]),t=new VI({props:o}),At.push(()=>qt(t,"pane",a)),{c(){r&&r.c(),e=Ae(),pe(t.$$.fragment)},l(l){r&&r.l(l),e=Se(l),ye(t.$$.fragment,l)},m(l,c){r&&r.m(l,c),ee(l,e,c),be(t,l,c),s=!0},p(l,c){l[16]?r?c[0]&65536&&L(r,1):(r=vI(l),r.c(),L(r,1),r.m(e.parentNode,e)):r&&(ot(),j(r,1,1,()=>{r=null}),lt());const h={};c[0]&81936&&(h.onResize=l[35]),c[0]&503791|c[1]&4096&&(h.$$scope={dirty:c,ctx:l}),!i&&c[0]&16&&(i=!0,h.pane=l[4],Wt(()=>i=!1)),t.$set(h)},i(l){s||(L(r),L(t.$$.fragment,l),s=!0)},o(l){j(r),j(t.$$.fragment,l),s=!1},d(l){l&&S(e),r&&r.d(l),xe(t,l)}}}function poe(n){let e,t,i=n[16]&&CI(n);return{c(){i&&i.c(),e=Ut()},l(s){i&&i.l(s),e=Ut()},m(s,r){i&&i.m(s,r),ee(s,e,r),t=!0},p(s,r){s[16]?i?(i.p(s,r),r[0]&65536&&L(i,1)):(i=CI(s),i.c(),L(i,1),i.m(e.parentNode,e)):i&&(ot(),j(i,1,1,()=>{i=null}),lt())},i(s){t||(L(i),t=!0)},o(s){j(i),t=!1},d(s){s&&S(e),i&&i.d(s)}}}function vI(n){let e,t;return e=new PD({props:{class:"relative flex w-2 items-center justify-center bg-background group",$$slots:{default:[boe]},$$scope:{ctx:n}}}),{c(){pe(e.$$.fragment)},l(i){ye(e.$$.fragment,i)},m(i,s){be(e,i,s),t=!0},i(i){t||(L(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){xe(e,i)}}}function boe(n){let e,t,i;return t=new nL({props:{className:"size-4 invisible group-hover:visible"}}),{c(){e=te("div"),pe(t.$$.fragment),this.h()},l(s){e=ne(s,"DIV",{class:!0});var r=V(e);ye(t.$$.fragment,r),r.forEach(S),this.h()},h(){A(e,"class","z-10 flex h-7 w-5 items-center justify-center rounded-xs")},m(s,r){ee(s,e,r),be(t,e,null),i=!0},p:kt,i(s){i||(L(t.$$.fragment,s),i=!0)},o(s){j(t.$$.fragment,s),i=!1},d(s){s&&S(e),xe(t)}}}function kI(n){let e,t,i,s,r,a;const o=[_oe,woe,yoe,xoe],l=[];function c(h,u){return h[15]?0:h[18]?1:h[17]?2:3}return i=c(n),s=l[i]=o[i](n),{c(){e=te("div"),t=te("div"),s.c(),this.h()},l(h){e=ne(h,"DIV",{class:!0});var u=V(e);t=ne(u,"DIV",{class:!0});var d=V(t);s.l(d),d.forEach(S),u.forEach(S),this.h()},h(){A(t,"class",r="w-full "+((n[17]||n[18])&&!n[15]?" ":"px-4 py-4 bg-white dark:shadow-lg dark:bg-gray-850  border border-gray-100 dark:border-gray-850")+" z-40 pointer-events-auto overflow-y-auto scrollbar-hidden"),A(e,"class","flex max-h-full min-h-full")},m(h,u){ee(h,e,u),q(e,t),l[i].m(t,null),a=!0},p(h,u){let d=i;i=c(h),i===d?l[i].p(h,u):(ot(),j(l[d],1,1,()=>{l[d]=null}),lt(),s=l[i],s?s.p(h,u):(s=l[i]=o[i](h),s.c()),L(s,1),s.m(t,null)),(!a||u[0]&425984&&r!==(r="w-full "+((h[17]||h[18])&&!h[15]?" ":"px-4 py-4 bg-white dark:shadow-lg dark:bg-gray-850  border border-gray-100 dark:border-gray-850")+" z-40 pointer-events-auto overflow-y-auto scrollbar-hidden"))&&A(t,"class",r)},i(h){a||(L(s),a=!0)},o(h){j(s),a=!1},d(h){h&&S(e),l[i].d()}}}function xoe(n){let e,t,i,s;function r(l){n[32](l)}function a(l){n[33](l)}let o={models:n[5]};return n[1]!==void 0&&(o.chatFiles=n[1]),n[2]!==void 0&&(o.params=n[2]),e=new hD({props:o}),At.push(()=>qt(e,"chatFiles",r)),At.push(()=>qt(e,"params",a)),e.$on("close",n[34]),{c(){pe(e.$$.fragment)},l(l){ye(e.$$.fragment,l)},m(l,c){be(e,l,c),s=!0},p(l,c){const h={};c[0]&32&&(h.models=l[5]),!t&&c[0]&2&&(t=!0,h.chatFiles=l[1],Wt(()=>t=!1)),!i&&c[0]&4&&(i=!0,h.params=l[2],Wt(()=>i=!1)),e.$set(h)},i(l){s||(L(e.$$.fragment,l),s=!0)},o(l){j(e.$$.fragment,l),s=!1},d(l){xe(e,l)}}}function yoe(n){let e,t;return e=new fD({props:{history:n[0]}}),e.$on("nodeclick",n[30]),e.$on("close",n[31]),{c(){pe(e.$$.fragment)},l(i){ye(e.$$.fragment,i)},m(i,s){be(e,i,s),t=!0},p(i,s){const r={};s[0]&1&&(r.history=i[0]),e.$set(r)},i(i){t||(L(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){xe(e,i)}}}function woe(n){let e,t;return e=new gD({props:{history:n[0],overlay:n[13]}}),{c(){pe(e.$$.fragment)},l(i){ye(e.$$.fragment,i)},m(i,s){be(e,i,s),t=!0},p(i,s){const r={};s[0]&1&&(r.history=i[0]),s[0]&8192&&(r.overlay=i[13]),e.$set(r)},i(i){t||(L(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){xe(e,i)}}}function _oe(n){let e,t,i,s;function r(o){n[28](o)}let a={submitPrompt:n[8],stopResponse:n[9],modelId:n[11],chatId:n[6],eventTarget:n[7]};return n[3]!==void 0&&(a.files=n[3]),t=new uD({props:a}),At.push(()=>qt(t,"files",r)),t.$on("close",n[29]),{c(){e=te("div"),pe(t.$$.fragment),this.h()},l(o){e=ne(o,"DIV",{class:!0});var l=V(e);ye(t.$$.fragment,l),l.forEach(S),this.h()},h(){A(e,"class","w-full h-full flex justify-center")},m(o,l){ee(o,e,l),be(t,e,null),s=!0},p(o,l){const c={};l[0]&256&&(c.submitPrompt=o[8]),l[0]&512&&(c.stopResponse=o[9]),l[0]&2048&&(c.modelId=o[11]),l[0]&64&&(c.chatId=o[6]),l[0]&128&&(c.eventTarget=o[7]),!i&&l[0]&8&&(i=!0,c.files=o[3],Wt(()=>i=!1)),t.$set(c)},i(o){s||(L(t.$$.fragment,o),s=!0)},o(o){j(t.$$.fragment,o),s=!1},d(o){o&&S(e),xe(t)}}}function voe(n){let e,t,i=n[16]&&kI(n);return{c(){i&&i.c(),e=Ut()},l(s){i&&i.l(s),e=Ut()},m(s,r){i&&i.m(s,r),ee(s,e,r),t=!0},p(s,r){s[16]?i?(i.p(s,r),r[0]&65536&&L(i,1)):(i=kI(s),i.c(),L(i,1),i.m(e.parentNode,e)):i&&(ot(),j(i,1,1,()=>{i=null}),lt())},i(s){t||(L(i),t=!0)},o(s){j(i),t=!1},d(s){s&&S(e),i&&i.d(s)}}}function CI(n){let e,t;return e=new IF({props:{show:n[16],onClose:n[27],$$slots:{default:[Ioe]},$$scope:{ctx:n}}}),{c(){pe(e.$$.fragment)},l(i){ye(e.$$.fragment,i)},m(i,s){be(e,i,s),t=!0},p(i,s){const r={};s[0]&65536&&(r.show=i[16]),s[0]&430063|s[1]&4096&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(L(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){xe(e,i)}}}function koe(n){let e,t,i,s;function r(l){n[24](l)}function a(l){n[25](l)}let o={models:n[5]};return n[1]!==void 0&&(o.chatFiles=n[1]),n[2]!==void 0&&(o.params=n[2]),e=new hD({props:o}),At.push(()=>qt(e,"chatFiles",r)),At.push(()=>qt(e,"params",a)),e.$on("close",n[26]),{c(){pe(e.$$.fragment)},l(l){ye(e.$$.fragment,l)},m(l,c){be(e,l,c),s=!0},p(l,c){const h={};c[0]&32&&(h.models=l[5]),!t&&c[0]&2&&(t=!0,h.chatFiles=l[1],Wt(()=>t=!1)),!i&&c[0]&4&&(i=!0,h.params=l[2],Wt(()=>i=!1)),e.$set(h)},i(l){s||(L(e.$$.fragment,l),s=!0)},o(l){j(e.$$.fragment,l),s=!1},d(l){xe(e,l)}}}function Coe(n){let e,t;return e=new fD({props:{history:n[0]}}),e.$on("nodeclick",n[22]),e.$on("close",n[23]),{c(){pe(e.$$.fragment)},l(i){ye(e.$$.fragment,i)},m(i,s){be(e,i,s),t=!0},p(i,s){const r={};s[0]&1&&(r.history=i[0]),e.$set(r)},i(i){t||(L(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){xe(e,i)}}}function Aoe(n){let e,t;return e=new gD({props:{history:n[0]}}),{c(){pe(e.$$.fragment)},l(i){ye(e.$$.fragment,i)},m(i,s){be(e,i,s),t=!0},p(i,s){const r={};s[0]&1&&(r.history=i[0]),e.$set(r)},i(i){t||(L(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){xe(e,i)}}}function Soe(n){let e,t,i,s;function r(o){n[20](o)}let a={submitPrompt:n[8],stopResponse:n[9],modelId:n[11],chatId:n[6],eventTarget:n[7]};return n[3]!==void 0&&(a.files=n[3]),t=new uD({props:a}),At.push(()=>qt(t,"files",r)),t.$on("close",n[21]),{c(){e=te("div"),pe(t.$$.fragment),this.h()},l(o){e=ne(o,"DIV",{class:!0});var l=V(e);ye(t.$$.fragment,l),l.forEach(S),this.h()},h(){A(e,"class","h-full max-h-[100dvh] bg-white text-gray-700 dark:bg-black dark:text-gray-300 flex justify-center")},m(o,l){ee(o,e,l),be(t,e,null),s=!0},p(o,l){const c={};l[0]&256&&(c.submitPrompt=o[8]),l[0]&512&&(c.stopResponse=o[9]),l[0]&2048&&(c.modelId=o[11]),l[0]&64&&(c.chatId=o[6]),l[0]&128&&(c.eventTarget=o[7]),!i&&l[0]&8&&(i=!0,c.files=o[3],Wt(()=>i=!1)),t.$set(c)},i(o){s||(L(t.$$.fragment,o),s=!0)},o(o){j(t.$$.fragment,o),s=!1},d(o){o&&S(e),xe(t)}}}function Ioe(n){let e,t,i,s,r;const a=[Soe,Aoe,Coe,koe],o=[];function l(c,h){return c[15]?0:c[18]?1:c[17]?2:3}return t=l(n),i=o[t]=a[t](n),{c(){e=te("div"),i.c(),this.h()},l(c){e=ne(c,"DIV",{class:!0});var h=V(e);i.l(h),h.forEach(S),this.h()},h(){A(e,"class",s=(n[15]||n[17]||n[18]?" h-screen  w-full":"px-6 py-4")+" h-full")},m(c,h){ee(c,e,h),o[t].m(e,null),r=!0},p(c,h){let u=t;t=l(c),t===u?o[t].p(c,h):(ot(),j(o[u],1,1,()=>{o[u]=null}),lt(),i=o[t],i?i.p(c,h):(i=o[t]=a[t](c),i.c()),L(i,1),i.m(e,null)),(!r||h[0]&425984&&s!==(s=(c[15]||c[17]||c[18]?" h-screen  w-full":"px-6 py-4")+" h-full"))&&A(e,"class",s)},i(c){r||(L(i),r=!0)},o(c){j(i),r=!1},d(c){c&&S(e),o[t].d()}}}function Eoe(n){let e,t,i,s;const r=[poe,moe],a=[];function o(l,c){return l[12]?1:0}return e=o(n),t=a[e]=r[e](n),{c(){t.c(),i=Ut()},l(l){t.l(l),i=Ut()},m(l,c){a[e].m(l,c),ee(l,i,c),s=!0},p(l,c){let h=e;e=o(l),e===h?a[e].p(l,c):(ot(),j(a[h],1,1,()=>{a[h]=null}),lt(),t=a[e],t?t.p(l,c):(t=a[e]=r[e](l),t.c()),L(t,1),t.m(i.parentNode,i))},i(l){s||(L(t),s=!0)},o(l){j(t),s=!1},d(l){l&&S(i),a[e].d(l)}}}function Toe(n){let e,t;return e=new mre({props:{$$slots:{default:[Eoe]},$$scope:{ctx:n}}}),{c(){pe(e.$$.fragment)},l(i){ye(e.$$.fragment,i)},m(i,s){be(e,i,s),t=!0},p(i,s){const r={};s[0]&524287|s[1]&4096&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(L(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){xe(e,i)}}}function Roe(n,e,t){let i,s,r,a;Pe(n,Va,W=>t(15,i=W)),Pe(n,Qi,W=>t(16,s=W)),Pe(n,u0,W=>t(17,r=W)),Pe(n,ic,W=>t(18,a=W));let{history:o}=e,{models:l=[]}=e,{chatId:c=null}=e,{chatFiles:h=[]}=e,{params:u={}}=e,{eventTarget:d}=e,{submitPrompt:f}=e,{stopResponse:g}=e,{showMessage:m}=e,{files:b}=e,{modelId:p}=e,{pane:y}=e,w,_=!1,v=!1,C=0;const k=()=>{parseInt(localStorage==null?void 0:localStorage.chatControlsSize)?y.resize(parseInt(localStorage==null?void 0:localStorage.chatControlsSize)):y.resize(C)},I=async W=>{W.matches?(t(12,_=!0),i&&(Va.set(!1),await hn(),Va.set(!0))):(t(12,_=!1),i&&(Va.set(!1),await hn(),Va.set(!0)),t(4,y=null))},E=W=>{t(13,v=!0)},T=W=>{t(13,v=!1)};fl(()=>{w=window.matchMedia("(min-width: 1024px)"),w.addEventListener("change",I),I(w);const W=document.getElementById("chat-container");t(14,C=Math.floor(350/W.clientWidth*100)),new ResizeObserver(ce=>{for(let Ce of ce){const Ke=350/Ce.contentRect.width*100;t(14,C=Math.floor(Ke)),s&&y&&y.isExpanded()&&y.getSize()<C&&y.resize(C)}}).observe(W),document.addEventListener("mousedown",E),document.addEventListener("mouseup",T)}),$h(()=>{Qi.set(!1),w.removeEventListener("change",I),document.removeEventListener("mousedown",E),document.removeEventListener("mouseup",T)});const M=()=>{Qi.set(!1),u0.set(!1),ic.set(!1),i&&Va.set(!1)};function D(W){b=W,t(3,b)}const H=()=>{Qi.set(!1)},R=W=>{m(W.detail.node.data.message)},z=()=>{Qi.set(!1)};function P(W){h=W,t(1,h)}function B(W){u=W,t(2,u)}const Z=()=>{Qi.set(!1)},G=()=>{Qi.set(!1)};function Y(W){b=W,t(3,b)}const J=()=>{Qi.set(!1)},se=W=>{W.detail.node.data.message.favorite?t(0,o.messages[W.detail.node.data.message.id].favorite=!0,o):t(0,o.messages[W.detail.node.data.message.id].favorite=null,o),m(W.detail.node.data.message)},fe=()=>{Qi.set(!1)};function he(W){h=W,t(1,h)}function de(W){u=W,t(2,u)}const ge=()=>{Qi.set(!1)},N=W=>{s&&y.isExpanded()&&(W<C&&y.resize(C),W<C?localStorage.chatControlsSize=0:localStorage.chatControlsSize=W)},K=()=>{Qi.set(!1)};function oe(W){y=W,t(4,y)}return n.$$set=W=>{"history"in W&&t(0,o=W.history),"models"in W&&t(5,l=W.models),"chatId"in W&&t(6,c=W.chatId),"chatFiles"in W&&t(1,h=W.chatFiles),"params"in W&&t(2,u=W.params),"eventTarget"in W&&t(7,d=W.eventTarget),"submitPrompt"in W&&t(8,f=W.submitPrompt),"stopResponse"in W&&t(9,g=W.stopResponse),"showMessage"in W&&t(10,m=W.showMessage),"files"in W&&t(3,b=W.files),"modelId"in W&&t(11,p=W.modelId),"pane"in W&&t(4,y=W.pane)},n.$$.update=()=>{n.$$.dirty[0]&64&&(c||M())},[o,h,u,b,y,l,c,d,f,g,m,p,_,v,C,i,s,r,a,k,D,H,R,z,P,B,Z,G,Y,J,se,fe,he,de,ge,N,K,oe]}class Moe extends Nt{constructor(e){super(),Ot(this,e,Roe,Toe,Ft,{history:0,models:5,chatId:6,chatFiles:1,params:2,eventTarget:7,submitPrompt:8,stopResponse:9,showMessage:10,files:3,modelId:11,pane:4,openPane:19},null,[-1,-1])}get openPane(){return this.$$.ctx[19]}}function AI(n,e,t){const i=n.slice();return i[11]=e[t],i[13]=t,i}function SI(n){let e,t,i,s=[],r=new Map,a,o=n[0].length>0&&II(n),l=n[0].length===0&&EI(n),c=Qn(n[0]);const h=u=>u[11].id;for(let u=0;u<c.length;u+=1){let d=AI(n,c,u),f=h(d);r.set(f,s[u]=RI(f,d))}return{c(){o&&o.c(),e=Ae(),t=te("div"),l&&l.c(),i=Ae();for(let u=0;u<s.length;u+=1)s[u].c();this.h()},l(u){o&&o.l(u),e=Se(u),t=ne(u,"DIV",{class:!0});var d=V(t);l&&l.l(d),i=Se(d);for(let f=0;f<s.length;f+=1)s[f].l(d);d.forEach(S),this.h()},h(){A(t,"class","text-left text-sm w-full mb-3")},m(u,d){o&&o.m(u,d),ee(u,e,d),ee(u,t,d),l&&l.m(t,null),q(t,i);for(let f=0;f<s.length;f+=1)s[f]&&s[f].m(t,null);a=!0},p(u,d){u[0].length>0?o?(o.p(u,d),d&1&&L(o,1)):(o=II(u),o.c(),L(o,1),o.m(e.parentNode,e)):o&&(ot(),j(o,1,1,()=>{o=null}),lt()),u[0].length===0?l?l.p(u,d):(l=EI(u),l.c(),l.m(t,i)):l&&(l.d(1),l=null),d&9&&(c=Qn(u[0]),s=hx(s,d,h,1,u,c,r,t,wF,RI,null,AI))},i(u){a||(L(o),a=!0)},o(u){j(o),a=!1},d(u){u&&(S(e),S(t)),o&&o.d(u),l&&l.d();for(let d=0;d<s.length;d+=1)s[d].d()}}}function II(n){let e,t,i,s=n[3].t("Title")+"",r,a,o,l,c,h,u,d=n[3].t("Updated at")+"",f,g,m,b,p,y,w;const _=[Noe,Poe],v=[];function C(T,M){return T[1]==="title"?0:1}o=C(n),l=v[o]=_[o](n);const k=[Loe,Foe],I=[];function E(T,M){return T[1]==="updated_at"?0:1}return m=E(n),b=I[m]=k[m](n),{c(){e=te("div"),t=te("button"),i=te("div"),r=_t(s),a=Ae(),l.c(),c=Ae(),h=te("button"),u=te("div"),f=_t(d),g=Ae(),b.c(),this.h()},l(T){e=ne(T,"DIV",{class:!0});var M=V(e);t=ne(M,"BUTTON",{class:!0});var D=V(t);i=ne(D,"DIV",{class:!0});var H=V(i);r=vt(H,s),a=Se(H),l.l(H),H.forEach(S),D.forEach(S),c=Se(M),h=ne(M,"BUTTON",{class:!0});var R=V(h);u=ne(R,"DIV",{class:!0});var z=V(u);f=vt(z,d),g=Se(z),b.l(z),z.forEach(S),R.forEach(S),M.forEach(S),this.h()},h(){A(i,"class","flex gap-1.5 items-center"),A(t,"class","px-1.5 py-1 cursor-pointer select-none basis-3/5"),A(u,"class","flex gap-1.5 items-center"),A(h,"class","px-1.5 py-1 cursor-pointer select-none hidden sm:flex sm:basis-2/5 justify-end"),A(e,"class","flex text-xs font-medium mb-1 items-center -mr-0.5")},m(T,M){ee(T,e,M),q(e,t),q(t,i),q(i,r),q(i,a),v[o].m(i,null),q(e,c),q(e,h),q(h,u),q(u,f),q(u,g),I[m].m(u,null),p=!0,y||(w=[pt(t,"click",n[7]),pt(h,"click",n[8])],y=!0)},p(T,M){(!p||M&8)&&s!==(s=T[3].t("Title")+"")&&St(r,s);let D=o;o=C(T),o===D?v[o].p(T,M):(ot(),j(v[D],1,1,()=>{v[D]=null}),lt(),l=v[o],l?l.p(T,M):(l=v[o]=_[o](T),l.c()),L(l,1),l.m(i,null)),(!p||M&8)&&d!==(d=T[3].t("Updated at")+"")&&St(f,d);let H=m;m=E(T),m===H?I[m].p(T,M):(ot(),j(I[H],1,1,()=>{I[H]=null}),lt(),b=I[m],b?b.p(T,M):(b=I[m]=k[m](T),b.c()),L(b,1),b.m(u,null))},i(T){p||(L(l),L(b),p=!0)},o(T){j(l),j(b),p=!1},d(T){T&&S(e),v[o].d(),I[m].d(),y=!1,ia(w)}}}function Poe(n){let e,t,i;return t=new $5({props:{className:"size-2"}}),{c(){e=te("span"),pe(t.$$.fragment),this.h()},l(s){e=ne(s,"SPAN",{class:!0});var r=V(e);ye(t.$$.fragment,r),r.forEach(S),this.h()},h(){A(e,"class","invisible")},m(s,r){ee(s,e,r),be(t,e,null),i=!0},p:kt,i(s){i||(L(t.$$.fragment,s),i=!0)},o(s){j(t.$$.fragment,s),i=!1},d(s){s&&S(e),xe(t)}}}function Noe(n){let e,t,i,s;const r=[Doe,Ooe],a=[];function o(l,c){return l[2]==="asc"?0:1}return t=o(n),i=a[t]=r[t](n),{c(){e=te("span"),i.c(),this.h()},l(l){e=ne(l,"SPAN",{class:!0});var c=V(e);i.l(c),c.forEach(S),this.h()},h(){A(e,"class","font-normal")},m(l,c){ee(l,e,c),a[t].m(e,null),s=!0},p(l,c){let h=t;t=o(l),t!==h&&(ot(),j(a[h],1,1,()=>{a[h]=null}),lt(),i=a[t],i||(i=a[t]=r[t](l),i.c()),L(i,1),i.m(e,null))},i(l){s||(L(i),s=!0)},o(l){j(i),s=!1},d(l){l&&S(e),a[t].d()}}}function Ooe(n){let e,t;return e=new eE({props:{className:"size-2"}}),{c(){pe(e.$$.fragment)},l(i){ye(e.$$.fragment,i)},m(i,s){be(e,i,s),t=!0},i(i){t||(L(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){xe(e,i)}}}function Doe(n){let e,t;return e=new $5({props:{className:"size-2"}}),{c(){pe(e.$$.fragment)},l(i){ye(e.$$.fragment,i)},m(i,s){be(e,i,s),t=!0},i(i){t||(L(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){xe(e,i)}}}function Foe(n){let e,t,i;return t=new $5({props:{className:"size-2"}}),{c(){e=te("span"),pe(t.$$.fragment),this.h()},l(s){e=ne(s,"SPAN",{class:!0});var r=V(e);ye(t.$$.fragment,r),r.forEach(S),this.h()},h(){A(e,"class","invisible")},m(s,r){ee(s,e,r),be(t,e,null),i=!0},p:kt,i(s){i||(L(t.$$.fragment,s),i=!0)},o(s){j(t.$$.fragment,s),i=!1},d(s){s&&S(e),xe(t)}}}function Loe(n){let e,t,i,s;const r=[Uoe,Boe],a=[];function o(l,c){return l[2]==="asc"?0:1}return t=o(n),i=a[t]=r[t](n),{c(){e=te("span"),i.c(),this.h()},l(l){e=ne(l,"SPAN",{class:!0});var c=V(e);i.l(c),c.forEach(S),this.h()},h(){A(e,"class","font-normal")},m(l,c){ee(l,e,c),a[t].m(e,null),s=!0},p(l,c){let h=t;t=o(l),t!==h&&(ot(),j(a[h],1,1,()=>{a[h]=null}),lt(),i=a[t],i||(i=a[t]=r[t](l),i.c()),L(i,1),i.m(e,null))},i(l){s||(L(i),s=!0)},o(l){j(i),s=!1},d(l){l&&S(e),a[t].d()}}}function Boe(n){let e,t;return e=new eE({props:{className:"size-2"}}),{c(){pe(e.$$.fragment)},l(i){ye(e.$$.fragment,i)},m(i,s){be(e,i,s),t=!0},i(i){t||(L(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){xe(e,i)}}}function Uoe(n){let e,t;return e=new $5({props:{className:"size-2"}}),{c(){pe(e.$$.fragment)},l(i){ye(e.$$.fragment,i)},m(i,s){be(e,i,s),t=!0},i(i){t||(L(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){xe(e,i)}}}function EI(n){let e,t=n[3].t("No chats found")+"",i;return{c(){e=te("div"),i=_t(t),this.h()},l(s){e=ne(s,"DIV",{class:!0});var r=V(e);i=vt(r,t),r.forEach(S),this.h()},h(){A(e,"class","text-xs text-gray-500 dark:text-gray-400 text-center px-5 min-h-20 w-full h-full flex justify-center items-center")},m(s,r){ee(s,e,r),q(e,i)},p(s,r){r&8&&t!==(t=s[3].t("No chats found")+"")&&St(i,t)},d(s){s&&S(e)}}}function TI(n){let e,t=n[3].t(n[11].time_range)+"",i,s;return{c(){e=te("div"),i=_t(t),this.h()},l(r){e=ne(r,"DIV",{class:!0});var a=V(e);i=vt(a,t),a.forEach(S),this.h()},h(){A(e,"class",s="w-full text-xs text-gray-500 dark:text-gray-500 font-medium "+(n[13]===0?"":"pt-5")+" pb-2 px-2")},m(r,a){ee(r,e,a),q(e,i)},p(r,a){a&9&&t!==(t=r[3].t(r[11].time_range)+"")&&St(i,t),a&1&&s!==(s="w-full text-xs text-gray-500 dark:text-gray-500 font-medium "+(r[13]===0?"":"pt-5")+" pb-2 px-2")&&A(e,"class",s)},d(r){r&&S(e)}}}function RI(n,e){var y,w,_;let t,i,s,r,a=((y=e[11])==null?void 0:y.title)+"",o,l,c,h,u=l8(((w=e[11])==null?void 0:w.updated_at)*1e3).calendar()+"",d,f,g,m,b,p=(e[13]===0||e[13]>0&&e[11].time_range!==e[0][e[13]-1].time_range)&&((_=e[11])==null?void 0:_.time_range)&&TI(e);return{key:n,first:null,c(){t=Ut(),p&&p.c(),i=Ae(),s=te("a"),r=te("div"),o=_t(a),l=Ae(),c=te("div"),h=te("div"),d=_t(u),f=Ae(),this.h()},l(v){t=Ut(),p&&p.l(v),i=Se(v),s=ne(v,"A",{class:!0,draggable:!0,href:!0});var C=V(s);r=ne(C,"DIV",{class:!0});var k=V(r);o=vt(k,a),k.forEach(S),l=Se(C),c=ne(C,"DIV",{class:!0});var I=V(c);h=ne(I,"DIV",{class:!0});var E=V(h);d=vt(E,u),E.forEach(S),I.forEach(S),f=Se(C),C.forEach(S),this.h()},h(){A(r,"class","text-ellipsis line-clamp-1 w-full sm:basis-3/5"),A(h,"class","text-gray-500 dark:text-gray-400 text-xs"),A(c,"class","hidden sm:flex sm:basis-2/5 items-center justify-end"),A(s,"class","w-full flex justify-between items-center rounded-lg text-sm py-2 px-3 hover:bg-gray-50 dark:hover:bg-gray-850"),A(s,"draggable","false"),A(s,"href",g=`/c/${e[11].id}`),this.first=t},m(v,C){ee(v,t,C),p&&p.m(v,C),ee(v,i,C),ee(v,s,C),q(s,r),q(r,o),q(s,l),q(s,c),q(c,h),q(h,d),q(s,f),m||(b=pt(s,"click",e[9]),m=!0)},p(v,C){var k,I,E;e=v,(e[13]===0||e[13]>0&&e[11].time_range!==e[0][e[13]-1].time_range)&&((k=e[11])!=null&&k.time_range)?p?p.p(e,C):(p=TI(e),p.c(),p.m(i.parentNode,i)):p&&(p.d(1),p=null),C&1&&a!==(a=((I=e[11])==null?void 0:I.title)+"")&&St(o,a),C&1&&u!==(u=l8(((E=e[11])==null?void 0:E.updated_at)*1e3).calendar()+"")&&St(d,u),C&1&&g!==(g=`/c/${e[11].id}`)&&A(s,"href",g)},d(v){v&&(S(t),S(i),S(s)),p&&p.d(v),m=!1,b()}}}function Hoe(n){let e,t,i=n[0]&&SI(n);return{c(){i&&i.c(),e=Ut()},l(s){i&&i.l(s),e=Ut()},m(s,r){i&&i.m(s,r),ee(s,e,r),t=!0},p(s,[r]){s[0]?i?(i.p(s,r),r&1&&L(i,1)):(i=SI(s),i.c(),L(i,1),i.m(e.parentNode,e)):i&&(ot(),j(i,1,1,()=>{i=null}),lt())},i(s){t||(L(i),t=!0)},o(s){j(i),t=!1},d(s){s&&S(e),i&&i.d(s)}}}function zoe(n,e,t){let i;const s=hs("i18n");Pe(n,s,g=>t(3,i=g)),l8.extend(ZD);let{chats:r=[]}=e,a=null;const o=async()=>{r.length===0?t(0,a=[]):(t(0,a=r.map(g=>({...g,time_range:QD(g.updated_at)}))),a.sort((g,m)=>h==="asc"?g[c]>m[c]?1:-1:g[c]<m[c]?1:-1))},l=g=>{c===g?t(2,h=h==="asc"?"desc":"asc"):(t(1,c=g),t(2,h="asc")),o()};let c="updated_at",h="desc";const u=()=>l("title"),d=()=>l("updated_at"),f=()=>show=!1;return n.$$set=g=>{"chats"in g&&t(6,r=g.chats)},n.$$.update=()=>{n.$$.dirty&64&&r&&o()},[a,c,h,i,s,l,r,u,d,f]}class joe extends Nt{constructor(e){super(),Ot(this,e,zoe,Hoe,Ft,{chats:6})}}class Goe extends Nt{constructor(e){super(),Ot(this,e,null,null,Ft,{})}}function Voe(n){var i,s;let e,t;return e=new joe({props:{chats:((s=(i=n[0])==null?void 0:i.items)==null?void 0:s.chats)??[]}}),{c(){pe(e.$$.fragment)},l(r){ye(e.$$.fragment,r)},m(r,a){be(e,r,a),t=!0},p(r,a){var l,c;const o={};a&1&&(o.chats=((c=(l=r[0])==null?void 0:l.items)==null?void 0:c.chats)??[]),e.$set(o)},i(r){t||(L(e.$$.fragment,r),t=!0)},o(r){j(e.$$.fragment,r),t=!1},d(r){xe(e,r)}}}function qoe(n){let e,t;return e=new Goe({}),{c(){pe(e.$$.fragment)},l(i){ye(e.$$.fragment,i)},m(i,s){be(e,i,s),t=!0},p:kt,i(i){t||(L(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){xe(e,i)}}}function Woe(n){let e,t,i,s,r;const a=[qoe,Voe],o=[];function l(c,h){return 1}return~(i=l())&&(s=o[i]=a[i](n)),{c(){e=te("div"),t=te("div"),s&&s.c(),this.h()},l(c){e=ne(c,"DIV",{});var h=V(e);t=ne(h,"DIV",{class:!0});var u=V(t);s&&s.l(u),u.forEach(S),h.forEach(S),this.h()},h(){A(t,"class","")},m(c,h){ee(c,e,h),q(e,t),~i&&o[i].m(t,null),r=!0},p(c,[h]){s&&s.p(c,h)},i(c){r||(L(s),r=!0)},o(c){j(s),r=!1},d(c){c&&S(e),~i&&o[i].d()}}}function Koe(n,e,t){hs("i18n");let{folder:i=null}=e;return n.$$set=s=>{"folder"in s&&t(0,i=s.folder)},[i]}class Xoe extends Nt{constructor(e){super(),Ot(this,e,Koe,Woe,Ft,{folder:0})}}function Yoe(n){let e,t;return{c(){e=nt("svg"),t=nt("path"),this.h()},l(i){e=it(i,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=V(e);t=it(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),V(t).forEach(S),s.forEach(S),this.h()},h(){A(t,"stroke-linecap","round"),A(t,"stroke-linejoin","round"),A(t,"d","M2.25 12.75V12A2.25 2.25 0 0 1 4.5 9.75h15A2.25 2.25 0 0 1 21.75 12v.75m-8.69-6.44-2.12-2.12a1.5 1.5 0 0 0-1.061-.44H4.5A2.25 2.25 0 0 0 2.25 6v12a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9a2.25 2.25 0 0 0-2.25-2.25h-5.379a1.5 1.5 0 0 1-1.06-.44Z"),A(e,"xmlns","http://www.w3.org/2000/svg"),A(e,"fill","none"),A(e,"viewBox","0 0 24 24"),A(e,"stroke-width",n[1]),A(e,"stroke","currentColor"),A(e,"class",n[0])},m(i,s){ee(i,e,s),q(e,t)},p(i,[s]){s&2&&A(e,"stroke-width",i[1]),s&1&&A(e,"class",i[0])},i:kt,o:kt,d(i){i&&S(e)}}}function Joe(n,e,t){let{className:i="size-4"}=e,{strokeWidth:s="1.5"}=e;return n.$$set=r=>{"className"in r&&t(0,i=r.className),"strokeWidth"in r&&t(1,s=r.strokeWidth)},[i,s]}class Zoe extends Nt{constructor(e){super(),Ot(this,e,Joe,Yoe,Ft,{className:0,strokeWidth:1})}}function MI(n){let e,t,i,s,r,a,o,l,c,h,u,d,f=n[0].name+"",g,m,b,p,y;function w(k){n[10](k)}let _={edit:!0,folder:n[0],onSubmit:n[5]};n[1]!==void 0&&(_.show=n[1]),e=new LF({props:_}),At.push(()=>qt(e,"show",w));function v(k){n[11](k)}let C={title:n[3].t("Delete folder?"),$$slots:{default:[Qoe]},$$scope:{ctx:n}};return n[2]!==void 0&&(C.show=n[2]),s=new $I({props:C}),At.push(()=>qt(s,"show",v)),s.$on("confirm",n[12]),h=new Zoe({props:{className:"size-4.5",strokeWidth:"2"}}),p=new BF({props:{align:"end",onEdit:n[13],onDelete:n[14],onExport:n[15],$$slots:{default:[$oe]},$$scope:{ctx:n}}}),{c(){pe(e.$$.fragment),i=Ae(),pe(s.$$.fragment),a=Ae(),o=te("div"),l=te("div"),c=te("div"),pe(h.$$.fragment),u=Ae(),d=te("div"),g=_t(f),m=Ae(),b=te("div"),pe(p.$$.fragment),this.h()},l(k){ye(e.$$.fragment,k),i=Se(k),ye(s.$$.fragment,k),a=Se(k),o=ne(k,"DIV",{class:!0});var I=V(o);l=ne(I,"DIV",{class:!0});var E=V(l);c=ne(E,"DIV",{class:!0});var T=V(c);ye(h.$$.fragment,T),T.forEach(S),u=Se(E),d=ne(E,"DIV",{class:!0});var M=V(d);g=vt(M,f),M.forEach(S),E.forEach(S),m=Se(I),b=ne(I,"DIV",{class:!0});var D=V(b);ye(p.$$.fragment,D),D.forEach(S),I.forEach(S),this.h()},h(){A(c,"class","rounded-full bg-gray-50 dark:bg-gray-800 p-3 w-fit"),A(d,"class","text-3xl"),A(l,"class","text-center flex gap-3.5 items-center"),A(b,"class","flex items-center translate-x-2.5"),A(o,"class","mb-3 px-6 @md:max-w-3xl justify-between w-full flex relative group items-center")},m(k,I){be(e,k,I),ee(k,i,I),be(s,k,I),ee(k,a,I),ee(k,o,I),q(o,l),q(l,c),be(h,c,null),q(l,u),q(l,d),q(d,g),q(o,m),q(o,b),be(p,b,null),y=!0},p(k,I){const E={};I&1&&(E.folder=k[0]),!t&&I&2&&(t=!0,E.show=k[1],Wt(()=>t=!1)),e.$set(E);const T={};I&8&&(T.title=k[3].t("Delete folder?")),I&131081&&(T.$$scope={dirty:I,ctx:k}),!r&&I&4&&(r=!0,T.show=k[2],Wt(()=>r=!1)),s.$set(T),(!y||I&1)&&f!==(f=k[0].name+"")&&St(g,f);const M={};I&2&&(M.onEdit=k[13]),I&4&&(M.onDelete=k[14]),I&131072&&(M.$$scope={dirty:I,ctx:k}),p.$set(M)},i(k){y||(L(e.$$.fragment,k),L(s.$$.fragment,k),L(h.$$.fragment,k),L(p.$$.fragment,k),y=!0)},o(k){j(e.$$.fragment,k),j(s.$$.fragment,k),j(h.$$.fragment,k),j(p.$$.fragment,k),y=!1},d(k){k&&(S(i),S(a),S(o)),xe(e,k),xe(s,k),xe(h),xe(p)}}}function Qoe(n){let e,t,i=_3.sanitize(n[3].t("This will delete <strong>{{NAME}}</strong> and <strong>all its contents</strong>.",{NAME:n[0].name}))+"";return{c(){e=te("div"),t=new r4(!1),this.h()},l(s){e=ne(s,"DIV",{class:!0});var r=V(e);t=a4(r,!1),r.forEach(S),this.h()},h(){t.a=null,A(e,"class","text-sm text-gray-700 dark:text-gray-300 flex-1 line-clamp-3")},m(s,r){ee(s,e,r),t.m(i,e)},p(s,r){r&9&&i!==(i=_3.sanitize(s[3].t("This will delete <strong>{{NAME}}</strong> and <strong>all its contents</strong>.",{NAME:s[0].name}))+"")&&t.p(i)},d(s){s&&S(e)}}}function $oe(n){let e,t,i,s,r;return t=new sL({props:{className:"size-4",strokeWidth:"2.5"}}),{c(){e=te("button"),pe(t.$$.fragment),this.h()},l(a){e=ne(a,"BUTTON",{class:!0});var o=V(e);ye(t.$$.fragment,o),o.forEach(S),this.h()},h(){A(e,"class","p-1.5 dark:hover:bg-gray-850 rounded-full touch-auto")},m(a,o){ee(a,e,o),be(t,e,null),i=!0,s||(r=pt(e,"click",tle),s=!0)},p:kt,i(a){i||(L(t.$$.fragment,a),i=!0)},o(a){j(t.$$.fragment,a),i=!1},d(a){a&&S(e),xe(t),s=!1,r()}}}function ele(n){let e,t,i=n[0]&&MI(n);return{c(){i&&i.c(),e=Ut()},l(s){i&&i.l(s),e=Ut()},m(s,r){i&&i.m(s,r),ee(s,e,r),t=!0},p(s,[r]){s[0]?i?(i.p(s,r),r&1&&L(i,1)):(i=MI(s),i.c(),L(i,1),i.m(e.parentNode,e)):i&&(ot(),j(i,1,1,()=>{i=null}),lt())},i(s){t||(L(i),t=!0)},o(s){j(i),t=!1},d(s){s&&S(e),i&&i.d(s)}}}const tle=n=>{};function nle(n,e,t){let i;const s=hs("i18n");Pe(n,s,_=>t(3,i=_));const{saveAs:r}=ZI;let{folder:a=null}=e,{onUpdate:o=_=>{}}=e,{onDelete:l=_=>{}}=e,c=!1,h=!1;const u=async({name:_,data:v})=>{if(_===""){Jt.error(i.t("Folder name cannot be empty."));return}const C=a.name;_=_.trim(),t(0,a.name=_,a),await UF(localStorage.token,a.id,{name:_,...v?{data:v}:{}}).catch(I=>(Jt.error(`${I}`),t(0,a.name=C,a),null))&&(t(0,a.name=_,a),v&&t(0,a.data=v,a),Jt.success(i.t("Folder updated successfully")),n1.set(a),o(a))},d=async()=>{await HF(localStorage.token,a.id).catch(v=>(Jt.error(`${v}`),null))&&(Jt.success(i.t("Folder deleted successfully")),l(a))},f=async()=>{const _=await iF(localStorage.token,a.id).catch(C=>(Jt.error(`${C}`),null));if(!_)return;const v=new Blob([JSON.stringify(_)],{type:"application/json"});r(v,`folder-${a.name}-export-${Date.now()}.json`)};function g(_){c=_,t(1,c)}function m(_){h=_,t(2,h)}const b=()=>{d()},p=()=>{t(1,c=!0)},y=()=>{t(2,h=!0)},w=()=>{f()};return n.$$set=_=>{"folder"in _&&t(0,a=_.folder),"onUpdate"in _&&t(8,o=_.onUpdate),"onDelete"in _&&t(9,l=_.onDelete)},[a,c,h,i,s,u,d,f,o,l,g,m,b,p,y,w]}class ile extends Nt{constructor(e){super(),Ot(this,e,nle,ele,Ft,{folder:0,onUpdate:8,onDelete:9})}}function PI(n,e,t){const i=n.slice();return i[45]=e[t],i[47]=t,i}function NI(n){let e,t;return e=new Ci({props:{content:n[21].t("This chat won't appear in history and your messages will not be saved."),className:"w-full flex justify-center mb-0.5",placement:"top",$$slots:{default:[sle]},$$scope:{ctx:n}}}),{c(){pe(e.$$.fragment)},l(i){ye(e.$$.fragment,i)},m(i,s){be(e,i,s),t=!0},p(i,s){const r={};s[0]&2097152&&(r.content=i[21].t("This chat won't appear in history and your messages will not be saved.")),s[0]&2097152|s[1]&131072&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(L(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){xe(e,i)}}}function sle(n){let e,t,i=n[21].t("Temporary Chat")+"",s,r;return t=new iL({props:{strokeWidth:"2.5",className:"size-4"}}),{c(){e=te("div"),pe(t.$$.fragment),s=_t(i),this.h()},l(a){e=ne(a,"DIV",{class:!0});var o=V(e);ye(t.$$.fragment,o),s=vt(o,i),o.forEach(S),this.h()},h(){A(e,"class","flex items-center gap-2 text-gray-500 font-medium text-base my-2 w-fit")},m(a,o){ee(a,e,o),be(t,e,null),q(e,s),r=!0},p(a,o){(!r||o[0]&2097152)&&i!==(i=a[21].t("Temporary Chat")+"")&&St(s,i)},i(a){r||(L(t.$$.fragment,a),r=!0)},o(a){j(t.$$.fragment,a),r=!1},d(a){a&&S(e),xe(t)}}}function rle(n){var C,k,I;let e,t,i,s,r,a,o,l,c,h,u,d,f,g,m=Qn(n[18]),b=[];for(let E=0;E<m.length;E+=1)b[E]=OI(PI(n,m,E));const p=E=>j(b[E],1,1,()=>{b[E]=null}),y=[cle,lle],w=[];function _(E,T){var M;return(M=E[18][E[19]])!=null&&M.name?0:1}o=_(n),l=w[o]=y[o](n);let v=(((I=(k=(C=n[18][n[19]])==null?void 0:C.info)==null?void 0:k.meta)==null?void 0:I.description)??null)&&DI(n);return{c(){e=te("div"),t=te("div"),i=te("div");for(let E=0;E<b.length;E+=1)b[E].c();r=Ae(),a=te("div"),l.c(),h=Ae(),u=te("div"),d=te("div"),v&&v.c(),this.h()},l(E){e=ne(E,"DIV",{class:!0});var T=V(e);t=ne(T,"DIV",{class:!0});var M=V(t);i=ne(M,"DIV",{class:!0});var D=V(i);for(let P=0;P<b.length;P+=1)b[P].l(D);D.forEach(S),M.forEach(S),r=Se(T),a=ne(T,"DIV",{class:!0});var H=V(a);l.l(H),H.forEach(S),T.forEach(S),h=Se(E),u=ne(E,"DIV",{class:!0});var R=V(u);d=ne(R,"DIV",{});var z=V(d);v&&v.l(z),z.forEach(S),R.forEach(S),this.h()},h(){A(i,"class","flex -space-x-4 mb-0.5"),A(t,"class","flex shrink-0 justify-center"),A(a,"class","text-3xl @sm:text-3xl line-clamp-1 flex items-center"),A(e,"class","flex flex-row justify-center gap-3 @sm:gap-3.5 w-fit px-5 max-w-xl"),A(u,"class","flex mt-1 mb-2")},m(E,T){ee(E,e,T),q(e,t),q(t,i);for(let M=0;M<b.length;M+=1)b[M]&&b[M].m(i,null);q(e,r),q(e,a),w[o].m(a,null),ee(E,h,T),ee(E,u,T),q(u,d),v&&v.m(d,null),g=!0},p(E,T){var D,H,R;if(T[0]&2883584){m=Qn(E[18]);let z;for(z=0;z<m.length;z+=1){const P=PI(E,m,z);b[z]?(b[z].p(P,T),L(b[z],1)):(b[z]=OI(P),b[z].c(),L(b[z],1),b[z].m(i,null))}for(ot(),z=m.length;z<b.length;z+=1)p(z);lt()}let M=o;o=_(E),o===M?w[o].p(E,T):(ot(),j(w[M],1,1,()=>{w[M]=null}),lt(),l=w[o],l?l.p(E,T):(l=w[o]=y[o](E),l.c()),L(l,1),l.m(a,null)),((R=(H=(D=E[18][E[19]])==null?void 0:D.info)==null?void 0:H.meta)==null?void 0:R.description)??null?v?(v.p(E,T),T[0]&786432&&L(v,1)):(v=DI(E),v.c(),L(v,1),v.m(d,null)):v&&(ot(),j(v,1,1,()=>{v=null}),lt())},i(E){if(!g){for(let T=0;T<m.length;T+=1)L(b[T]);E&&(s||h0(()=>{s=e1(i,i1,{duration:100}),s.start()})),L(l),E&&(c||h0(()=>{c=e1(a,i1,{duration:100}),c.start()})),L(v),E&&(f||h0(()=>{f=e1(d,i1,{duration:100,delay:50}),f.start()})),g=!0}},o(E){b=b.filter(Boolean);for(let T=0;T<b.length;T+=1)j(b[T]);j(l),j(v),g=!1},d(E){E&&(S(e),S(h),S(u)),To(b,E),w[o].d(),v&&v.d()}}}function ale(n){let e,t;return e=new ile({props:{folder:n[22],onUpdate:n[29],onDelete:n[30]}}),{c(){pe(e.$$.fragment)},l(i){ye(e.$$.fragment,i)},m(i,s){be(e,i,s),t=!0},p(i,s){const r={};s[0]&4194304&&(r.folder=i[22]),s[0]&8388608&&(r.onUpdate=i[29]),s[0]&8388608&&(r.onDelete=i[30]),e.$set(r)},i(i){t||(L(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){xe(e,i)}}}function ole(n){let e,t,i,s,r,a,o,l;function c(){return n[31](n[47])}return{c(){e=te("button"),t=te("img"),a=Ae(),this.h()},l(h){e=ne(h,"BUTTON",{"aria-hidden":!0,"aria-label":!0});var u=V(e);t=ne(u,"IMG",{crossorigin:!0,src:!0,class:!0,"aria-hidden":!0,draggable:!0}),u.forEach(S),a=Se(h),this.h()},h(){var h,u,d,f;A(t,"crossorigin","anonymous"),k0(t.src,i=((d=(u=(h=n[45])==null?void 0:h.info)==null?void 0:u.meta)==null?void 0:d.profile_image_url)??(n[21].language==="dg-DG"?`${tl}/doge.png`:`${tl}/static/favicon.png`))||A(t,"src",i),A(t,"class","size-9 @sm:size-10 rounded-full border-[1px] border-gray-100 dark:border-none"),A(t,"aria-hidden","true"),A(t,"draggable","false"),A(e,"aria-hidden",s=n[18].length<=1),A(e,"aria-label",r=n[21].t("Get information on {{name}} in the UI",{name:(f=n[18][n[47]])==null?void 0:f.name}))},m(h,u){ee(h,e,u),q(e,t),ee(h,a,u),o||(l=pt(e,"click",c),o=!0)},p(h,u){var d,f,g,m;n=h,u[0]&2359296&&!k0(t.src,i=((g=(f=(d=n[45])==null?void 0:d.info)==null?void 0:f.meta)==null?void 0:g.profile_image_url)??(n[21].language==="dg-DG"?`${tl}/doge.png`:`${tl}/static/favicon.png`))&&A(t,"src",i),u[0]&262144&&s!==(s=n[18].length<=1)&&A(e,"aria-hidden",s),u[0]&2359296&&r!==(r=n[21].t("Get information on {{name}} in the UI",{name:(m=n[18][n[47]])==null?void 0:m.name}))&&A(e,"aria-label",r)},d(h){h&&(S(e),S(a)),o=!1,l()}}}function OI(n){var i,s,r;let e,t;return e=new Ci({props:{content:(((r=(s=(i=n[18][n[47]])==null?void 0:i.info)==null?void 0:s.meta)==null?void 0:r.tags)??[]).map(LI).join(", "),placement:"top",$$slots:{default:[ole]},$$scope:{ctx:n}}}),{c(){pe(e.$$.fragment)},l(a){ye(e.$$.fragment,a)},m(a,o){be(e,a,o),t=!0},p(a,o){var c,h,u;const l={};o[0]&262144&&(l.content=(((u=(h=(c=a[18][a[47]])==null?void 0:c.info)==null?void 0:h.meta)==null?void 0:u.tags)??[]).map(LI).join(", ")),o[0]&2883584|o[1]&131072&&(l.$$scope={dirty:o,ctx:a}),e.$set(l)},i(a){t||(L(e.$$.fragment,a),t=!0)},o(a){j(e.$$.fragment,a),t=!1},d(a){xe(e,a)}}}function lle(n){var i;let e=n[21].t("Hello, {{name}}",{name:(i=n[24])==null?void 0:i.name})+"",t;return{c(){t=_t(e)},l(s){t=vt(s,e)},m(s,r){ee(s,t,r)},p(s,r){var a;r[0]&18874368&&e!==(e=s[21].t("Hello, {{name}}",{name:(a=s[24])==null?void 0:a.name})+"")&&St(t,e)},i:kt,o:kt,d(s){s&&S(t)}}}function cle(n){var i;let e,t;return e=new Ci({props:{content:(i=n[18][n[19]])==null?void 0:i.name,placement:"top",className:" flex items-center ",$$slots:{default:[hle]},$$scope:{ctx:n}}}),{c(){pe(e.$$.fragment)},l(s){ye(e.$$.fragment,s)},m(s,r){be(e,s,r),t=!0},p(s,r){var o;const a={};r[0]&786432&&(a.content=(o=s[18][s[19]])==null?void 0:o.name),r[0]&786432|r[1]&131072&&(a.$$scope={dirty:r,ctx:s}),e.$set(a)},i(s){t||(L(e.$$.fragment,s),t=!0)},o(s){j(e.$$.fragment,s),t=!1},d(s){xe(e,s)}}}function hle(n){var s;let e,t=((s=n[18][n[19]])==null?void 0:s.name)+"",i;return{c(){e=te("span"),i=_t(t),this.h()},l(r){e=ne(r,"SPAN",{class:!0});var a=V(e);i=vt(a,t),a.forEach(S),this.h()},h(){A(e,"class","line-clamp-1")},m(r,a){ee(r,e,a),q(e,i)},p(r,a){var o;a[0]&786432&&t!==(t=((o=r[18][r[19]])==null?void 0:o.name)+"")&&St(i,t)},d(r){r&&S(e)}}}function DI(n){var a,o,l,c,h,u;let e,t,i,s;e=new Ci({props:{className:" w-fit",content:Pg.parse(w3(((l=(o=(a=n[18][n[19]])==null?void 0:a.info)==null?void 0:o.meta)==null?void 0:l.description)??"").replaceAll(`
`,"<br>")),placement:"top",$$slots:{default:[ule]},$$scope:{ctx:n}}});let r=((u=(h=(c=n[18][n[19]])==null?void 0:c.info)==null?void 0:h.meta)==null?void 0:u.user)&&FI(n);return{c(){pe(e.$$.fragment),t=Ae(),r&&r.c(),i=Ut()},l(d){ye(e.$$.fragment,d),t=Se(d),r&&r.l(d),i=Ut()},m(d,f){be(e,d,f),ee(d,t,f),r&&r.m(d,f),ee(d,i,f),s=!0},p(d,f){var m,b,p,y,w,_;const g={};f[0]&786432&&(g.content=Pg.parse(w3(((p=(b=(m=d[18][d[19]])==null?void 0:m.info)==null?void 0:b.meta)==null?void 0:p.description)??"").replaceAll(`
`,"<br>"))),f[0]&786432|f[1]&131072&&(g.$$scope={dirty:f,ctx:d}),e.$set(g),(_=(w=(y=d[18][d[19]])==null?void 0:y.info)==null?void 0:w.meta)!=null&&_.user?r?r.p(d,f):(r=FI(d),r.c(),r.m(i.parentNode,i)):r&&(r.d(1),r=null)},i(d){s||(L(e.$$.fragment,d),s=!0)},o(d){j(e.$$.fragment,d),s=!1},d(d){d&&(S(t),S(i)),xe(e,d),r&&r.d(d)}}}function ule(n){var s,r,a;let e,t,i=Pg.parse(w3(((a=(r=(s=n[18][n[19]])==null?void 0:s.info)==null?void 0:r.meta)==null?void 0:a.description)??"").replaceAll(`
`,"<br>"))+"";return{c(){e=te("div"),t=new r4(!1),this.h()},l(o){e=ne(o,"DIV",{class:!0});var l=V(e);t=a4(l,!1),l.forEach(S),this.h()},h(){t.a=null,A(e,"class","mt-0.5 px-2 text-sm font-normal text-gray-500 dark:text-gray-400 line-clamp-2 max-w-xl markdown")},m(o,l){ee(o,e,l),t.m(i,e)},p(o,l){var c,h,u;l[0]&786432&&i!==(i=Pg.parse(w3(((u=(h=(c=o[18][o[19]])==null?void 0:c.info)==null?void 0:h.meta)==null?void 0:u.description)??"").replaceAll(`
`,"<br>"))+"")&&t.p(i)},d(o){o&&S(e)}}}function FI(n){let e,t;function i(a,o){var l,c,h;return(h=(c=(l=a[18][a[19]])==null?void 0:l.info)==null?void 0:c.meta)!=null&&h.user.community?fle:dle}let s=i(n),r=s(n);return{c(){e=te("div"),t=_t(`By
									`),r.c(),this.h()},l(a){e=ne(a,"DIV",{class:!0});var o=V(e);t=vt(o,`By
									`),r.l(o),o.forEach(S),this.h()},h(){A(e,"class","mt-0.5 text-sm font-normal text-gray-400 dark:text-gray-500")},m(a,o){ee(a,e,o),q(e,t),r.m(e,null)},p(a,o){s===(s=i(a))&&r?r.p(a,o):(r.d(1),r=s(a),r&&(r.c(),r.m(e,null)))},d(a){a&&S(e),r.d()}}}function dle(n){var i,s,r;let e=((r=(s=(i=n[18][n[19]])==null?void 0:i.info)==null?void 0:s.meta)==null?void 0:r.user.name)+"",t;return{c(){t=_t(e)},l(a){t=vt(a,e)},m(a,o){ee(a,t,o)},p(a,o){var l,c,h;o[0]&786432&&e!==(e=((h=(c=(l=a[18][a[19]])==null?void 0:l.info)==null?void 0:c.meta)==null?void 0:h.user.name)+"")&&St(t,e)},d(a){a&&S(t)}}}function fle(n){var r,a,o,l,c,h,u,d,f;let e,t=((o=(a=(r=n[18][n[19]])==null?void 0:r.info)==null?void 0:a.meta)!=null&&o.user.name?(h=(c=(l=n[18][n[19]])==null?void 0:l.info)==null?void 0:c.meta)==null?void 0:h.user.name:`@${(f=(d=(u=n[18][n[19]])==null?void 0:u.info)==null?void 0:d.meta)==null?void 0:f.user.username}`)+"",i,s;return{c(){e=te("a"),i=_t(t),this.h()},l(g){e=ne(g,"A",{href:!0});var m=V(e);i=vt(m,t),m.forEach(S),this.h()},h(){var g,m,b;A(e,"href",s="https://openwebui.com/m/"+((b=(m=(g=n[18][n[19]])==null?void 0:g.info)==null?void 0:m.meta)==null?void 0:b.user.username))},m(g,m){ee(g,e,m),q(e,i)},p(g,m){var b,p,y,w,_,v,C,k,I,E,T,M;m[0]&786432&&t!==(t=((y=(p=(b=g[18][g[19]])==null?void 0:b.info)==null?void 0:p.meta)!=null&&y.user.name?(v=(_=(w=g[18][g[19]])==null?void 0:w.info)==null?void 0:_.meta)==null?void 0:v.user.name:`@${(I=(k=(C=g[18][g[19]])==null?void 0:C.info)==null?void 0:k.meta)==null?void 0:I.user.username}`)+"")&&St(i,t),m[0]&786432&&s!==(s="https://openwebui.com/m/"+((M=(T=(E=g[18][g[19]])==null?void 0:E.info)==null?void 0:T.meta)==null?void 0:M.user.username))&&A(e,"href",s)},d(g){g&&S(e)}}}function gle(n){var a,o,l,c,h,u,d;let e,t,i,s,r;return i=new NF({props:{suggestionPrompts:((l=(o=(a=n[1])==null?void 0:a.info)==null?void 0:o.meta)==null?void 0:l.suggestion_prompts)??((u=(h=(c=n[18][n[19]])==null?void 0:c.info)==null?void 0:h.meta)==null?void 0:u.suggestion_prompts)??((d=n[25])==null?void 0:d.default_prompt_suggestions)??[],inputValue:n[2],onSelect:n[15]}}),{c(){e=te("div"),t=te("div"),pe(i.$$.fragment),this.h()},l(f){e=ne(f,"DIV",{class:!0});var g=V(e);t=ne(g,"DIV",{class:!0});var m=V(t);ye(i.$$.fragment,m),m.forEach(S),g.forEach(S),this.h()},h(){A(t,"class","mx-5"),A(e,"class","mx-auto max-w-2xl font-primary mt-2")},m(f,g){ee(f,e,g),q(e,t),be(i,t,null),r=!0},p(f,g){var b,p,y,w,_,v,C;const m={};g[0]&34340866&&(m.suggestionPrompts=((y=(p=(b=f[1])==null?void 0:b.info)==null?void 0:p.meta)==null?void 0:y.suggestion_prompts)??((v=(_=(w=f[18][f[19]])==null?void 0:w.info)==null?void 0:_.meta)==null?void 0:v.suggestion_prompts)??((C=f[25])==null?void 0:C.default_prompt_suggestions)??[]),g[0]&4&&(m.inputValue=f[2]),g[0]&32768&&(m.onSelect=f[15]),i.$set(m)},i(f){r||(L(i.$$.fragment,f),f&&(s||h0(()=>{s=e1(e,i1,{duration:200,delay:200}),s.start()})),r=!0)},o(f){j(i.$$.fragment,f),r=!1},d(f){f&&S(e),xe(i)}}}function mle(n){let e,t,i,s;return t=new Xoe({props:{folder:n[22]}}),{c(){e=te("div"),pe(t.$$.fragment),this.h()},l(r){e=ne(r,"DIV",{class:!0});var a=V(e);ye(t.$$.fragment,a),a.forEach(S),this.h()},h(){A(e,"class","mx-auto px-4 md:max-w-3xl md:px-6 font-primary min-h-62")},m(r,a){ee(r,e,a),be(t,e,null),s=!0},p(r,a){const o={};a[0]&4194304&&(o.folder=r[22]),t.$set(o)},i(r){s||(L(t.$$.fragment,r),r&&(i||h0(()=>{i=e1(e,i1,{duration:200,delay:200}),i.start()})),s=!0)},o(r){j(t.$$.fragment,r),s=!1},d(r){r&&S(e),xe(t)}}}function ple(n){let e,t,i,s,r,a,o,l,c,h,u,d,f,g,m,b,p,y,w,_,v,C,k,I,E=n[20]&&NI(n);const T=[ale,rle],M=[];function D(N,K){return N[22]?0:1}r=D(n),a=M[r]=T[r](n);function H(N){n[33](N)}function R(N){n[34](N)}function z(N){n[35](N)}function P(N){n[36](N)}function B(N){n[37](N)}function Z(N){n[38](N)}function G(N){n[39](N)}function Y(N){n[40](N)}function J(N){n[41](N)}function se(N){n[42](N)}let fe={history:n[14],selectedModels:n[13],toolServers:n[17],stopResponse:n[12],createMessagePair:n[11],placeholder:n[21].t("How can I help you today?"),onChange:n[16]};n[3]!==void 0&&(fe.files=n[3]),n[2]!==void 0&&(fe.prompt=n[2]),n[0]!==void 0&&(fe.autoScroll=n[0]),n[5]!==void 0&&(fe.selectedToolIds=n[5]),n[6]!==void 0&&(fe.selectedFilterIds=n[6]),n[8]!==void 0&&(fe.imageGenerationEnabled=n[8]),n[9]!==void 0&&(fe.codeInterpreterEnabled=n[9]),n[10]!==void 0&&(fe.webSearchEnabled=n[10]),n[1]!==void 0&&(fe.atSelectedModel=n[1]),n[7]!==void 0&&(fe.showCommands=n[7]),c=new TO({props:fe}),n[32](c),At.push(()=>qt(c,"files",H)),At.push(()=>qt(c,"prompt",R)),At.push(()=>qt(c,"autoScroll",z)),At.push(()=>qt(c,"selectedToolIds",P)),At.push(()=>qt(c,"selectedFilterIds",B)),At.push(()=>qt(c,"imageGenerationEnabled",Z)),At.push(()=>qt(c,"codeInterpreterEnabled",G)),At.push(()=>qt(c,"webSearchEnabled",Y)),At.push(()=>qt(c,"atSelectedModel",J)),At.push(()=>qt(c,"showCommands",se)),c.$on("upload",n[43]),c.$on("submit",n[44]);const he=[mle,gle],de=[];function ge(N,K){return N[22]?0:1}return C=ge(n),k=de[C]=he[C](n),{c(){e=te("div"),E&&E.c(),t=Ae(),i=te("div"),s=te("div"),a.c(),o=Ae(),l=te("div"),pe(c.$$.fragment),v=Ae(),k.c(),this.h()},l(N){e=ne(N,"DIV",{class:!0});var K=V(e);E&&E.l(K),t=Se(K),i=ne(K,"DIV",{class:!0});var oe=V(i);s=ne(oe,"DIV",{class:!0});var W=V(s);a.l(W),o=Se(W),l=ne(W,"DIV",{class:!0});var le=V(l);ye(c.$$.fragment,le),le.forEach(S),W.forEach(S),oe.forEach(S),v=Se(K),k.l(K),K.forEach(S),this.h()},h(){A(l,"class",_="text-base font-normal @md:max-w-3xl w-full py-3 "+(n[1]?"mt-2":"")),A(s,"class","w-full flex flex-col justify-center items-center"),A(i,"class","w-full text-3xl text-gray-800 dark:text-gray-100 text-center flex items-center gap-4 font-primary"),A(e,"class","m-auto w-full max-w-6xl px-2 @2xl:px-20 translate-y-6 py-24 text-center")},m(N,K){ee(N,e,K),E&&E.m(e,null),q(e,t),q(e,i),q(i,s),M[r].m(s,null),q(s,o),q(s,l),be(c,l,null),q(e,v),de[C].m(e,null),I=!0},p(N,K){N[20]?E?(E.p(N,K),K[0]&1048576&&L(E,1)):(E=NI(N),E.c(),L(E,1),E.m(e,t)):E&&(ot(),j(E,1,1,()=>{E=null}),lt());let oe=r;r=D(N),r===oe?M[r].p(N,K):(ot(),j(M[oe],1,1,()=>{M[oe]=null}),lt(),a=M[r],a?a.p(N,K):(a=M[r]=T[r](N),a.c()),L(a,1),a.m(s,o));const W={};K[0]&16384&&(W.history=N[14]),K[0]&8192&&(W.selectedModels=N[13]),K[0]&131072&&(W.toolServers=N[17]),K[0]&4096&&(W.stopResponse=N[12]),K[0]&2048&&(W.createMessagePair=N[11]),K[0]&2097152&&(W.placeholder=N[21].t("How can I help you today?")),K[0]&65536&&(W.onChange=N[16]),!h&&K[0]&8&&(h=!0,W.files=N[3],Wt(()=>h=!1)),!u&&K[0]&4&&(u=!0,W.prompt=N[2],Wt(()=>u=!1)),!d&&K[0]&1&&(d=!0,W.autoScroll=N[0],Wt(()=>d=!1)),!f&&K[0]&32&&(f=!0,W.selectedToolIds=N[5],Wt(()=>f=!1)),!g&&K[0]&64&&(g=!0,W.selectedFilterIds=N[6],Wt(()=>g=!1)),!m&&K[0]&256&&(m=!0,W.imageGenerationEnabled=N[8],Wt(()=>m=!1)),!b&&K[0]&512&&(b=!0,W.codeInterpreterEnabled=N[9],Wt(()=>b=!1)),!p&&K[0]&1024&&(p=!0,W.webSearchEnabled=N[10],Wt(()=>p=!1)),!y&&K[0]&2&&(y=!0,W.atSelectedModel=N[1],Wt(()=>y=!1)),!w&&K[0]&128&&(w=!0,W.showCommands=N[7],Wt(()=>w=!1)),c.$set(W),(!I||K[0]&2&&_!==(_="text-base font-normal @md:max-w-3xl w-full py-3 "+(N[1]?"mt-2":"")))&&A(l,"class",_);let le=C;C=ge(N),C===le?de[C].p(N,K):(ot(),j(de[le],1,1,()=>{de[le]=null}),lt(),k=de[C],k?k.p(N,K):(k=de[C]=he[C](N),k.c()),L(k,1),k.m(e,null))},i(N){I||(L(E),L(a),L(c.$$.fragment,N),L(k),I=!0)},o(N){j(E),j(a),j(c.$$.fragment,N),j(k),I=!1},d(N){N&&S(e),E&&E.d(),M[r].d(),n[32](null),xe(c),de[C].d()}}}const LI=n=>n.name.toUpperCase();function ble(n,e,t){let i,s,r,a,o,l,c;Pe(n,em,ce=>t(28,i=ce)),Pe(n,Gd,ce=>t(20,s=ce)),Pe(n,n1,ce=>t(22,a=ce)),Pe(n,Tl,ce=>t(23,o=ce)),Pe(n,T0,ce=>t(24,l=ce)),Pe(n,$g,ce=>t(25,c=ce));const h=eo(),u=hs("i18n");Pe(n,u,ce=>t(21,r=ce));let{createMessagePair:d}=e,{stopResponse:f}=e,{autoScroll:g=!1}=e,{atSelectedModel:m}=e,{selectedModels:b}=e,{history:p}=e,{prompt:y=""}=e,{files:w=[]}=e,{messageInput:_=null}=e,{selectedToolIds:v=[]}=e,{selectedFilterIds:C=[]}=e,{showCommands:k=!1}=e,{imageGenerationEnabled:I=!1}=e,{codeInterpreterEnabled:E=!1}=e,{webSearchEnabled:T=!1}=e,{onSelect:M=ce=>{}}=e,{onChange:D=ce=>{}}=e,{toolServers:H=[]}=e,R=[],z=0;fl(()=>{});const P=async ce=>{n1.set(ce),await _c.set(await D0(localStorage.token,o)),Tl.set(1)},B=async()=>{await _c.set(await D0(localStorage.token,o)),Tl.set(1),n1.set(null)},Z=ce=>{t(19,z=ce)};function G(ce){At[ce?"unshift":"push"](()=>{_=ce,t(4,_)})}function Y(ce){w=ce,t(3,w)}function J(ce){y=ce,t(2,y)}function se(ce){g=ce,t(0,g)}function fe(ce){v=ce,t(5,v)}function he(ce){C=ce,t(6,C)}function de(ce){I=ce,t(8,I)}function ge(ce){E=ce,t(9,E)}function N(ce){T=ce,t(10,T)}function K(ce){m=ce,t(1,m)}function oe(ce){k=ce,t(7,k)}const W=ce=>{h("upload",ce.detail)},le=ce=>{h("submit",ce.detail)};return n.$$set=ce=>{"createMessagePair"in ce&&t(11,d=ce.createMessagePair),"stopResponse"in ce&&t(12,f=ce.stopResponse),"autoScroll"in ce&&t(0,g=ce.autoScroll),"atSelectedModel"in ce&&t(1,m=ce.atSelectedModel),"selectedModels"in ce&&t(13,b=ce.selectedModels),"history"in ce&&t(14,p=ce.history),"prompt"in ce&&t(2,y=ce.prompt),"files"in ce&&t(3,w=ce.files),"messageInput"in ce&&t(4,_=ce.messageInput),"selectedToolIds"in ce&&t(5,v=ce.selectedToolIds),"selectedFilterIds"in ce&&t(6,C=ce.selectedFilterIds),"showCommands"in ce&&t(7,k=ce.showCommands),"imageGenerationEnabled"in ce&&t(8,I=ce.imageGenerationEnabled),"codeInterpreterEnabled"in ce&&t(9,E=ce.codeInterpreterEnabled),"webSearchEnabled"in ce&&t(10,T=ce.webSearchEnabled),"onSelect"in ce&&t(15,M=ce.onSelect),"onChange"in ce&&t(16,D=ce.onChange),"toolServers"in ce&&t(17,H=ce.toolServers)},n.$$.update=()=>{n.$$.dirty[0]&268443648&&t(18,R=b.map(ce=>i.find(Ce=>Ce.id===ce))),n.$$.dirty[0]&270336&&b.length>0&&t(19,z=R.length-1)},[g,m,y,w,_,v,C,k,I,E,T,d,f,b,p,M,D,H,R,z,s,r,a,o,l,c,h,u,i,P,B,Z,G,Y,J,se,fe,he,de,ge,N,K,oe,W,le]}class xle extends Nt{constructor(e){super(),Ot(this,e,ble,ple,Ft,{createMessagePair:11,stopResponse:12,autoScroll:0,atSelectedModel:1,selectedModels:13,history:14,prompt:2,files:3,messageInput:4,selectedToolIds:5,selectedFilterIds:6,showCommands:7,imageGenerationEnabled:8,codeInterpreterEnabled:9,webSearchEnabled:10,onSelect:15,onChange:16,toolServers:17},null,[-1,-1])}}const{document:i8}=jI;function yle(n){let e,t,i,s;return i=new f4({props:{className:"size-5"}}),{c(){e=te("div"),t=te("div"),pe(i.$$.fragment),this.h()},l(r){e=ne(r,"DIV",{class:!0});var a=V(e);t=ne(a,"DIV",{class:!0});var o=V(t);ye(i.$$.fragment,o),o.forEach(S),a.forEach(S),this.h()},h(){A(t,"class","m-auto"),A(e,"class","flex items-center justify-center h-full w-full")},m(r,a){ee(r,e,a),q(e,t),be(i,t,null),s=!0},p:kt,i(r){s||(L(i.$$.fragment,r),s=!0)},o(r){j(i.$$.fragment,r),s=!1},d(r){r&&S(e),xe(i)}}}function wle(n){var o,l,c;let e,t,i,s,r,a=(((o=n[33])==null?void 0:o.backgroundImageUrl)??((c=(l=n[35])==null?void 0:l.license_metadata)==null?void 0:c.background_image_url)??null)&&BI(n);return i=new ND({props:{direction:"horizontal",class:"w-full h-full",$$slots:{default:[Cle]},$$scope:{ctx:n}}}),{c(){e=te("div"),a&&a.c(),t=Ae(),pe(i.$$.fragment),this.h()},l(h){e=ne(h,"DIV",{class:!0});var u=V(e);a&&a.l(u),t=Se(u),ye(i.$$.fragment,u),u.forEach(S),this.h()},h(){A(e,"class","w-full h-full flex flex-col")},m(h,u){ee(h,e,u),a&&a.m(e,null),q(e,t),be(i,e,null),r=!0},p(h,u){var f,g,m;((f=h[33])==null?void 0:f.backgroundImageUrl)??((m=(g=h[35])==null?void 0:g.license_metadata)==null?void 0:m.background_image_url)??null?a?a.p(h,u):(a=BI(h),a.c(),a.m(e,t)):a&&(a.d(1),a=null);const d={};u[0]&2147353591|u[1]&111|u[4]&16384&&(d.$$scope={dirty:u,ctx:h}),i.$set(d)},i(h){r||(L(i.$$.fragment,h),h&&(s||h0(()=>{s=e1(e,i1,{duration:50}),s.start()})),r=!0)},o(h){j(i.$$.fragment,h),r=!1},d(h){h&&S(e),a&&a.d(),xe(i)}}}function BI(n){let e,t,i,s;return{c(){e=te("div"),i=Ae(),s=te("div"),this.h()},l(r){e=ne(r,"DIV",{class:!0,style:!0}),V(e).forEach(S),i=Se(r),s=ne(r,"DIV",{class:!0}),V(s).forEach(S),this.h()},h(){var r,a,o;A(e,"class",t="absolute "+(n[39]?"md:max-w-[calc(100%-260px)] md:translate-x-[260px]":"")+" top-0 left-0 w-full h-full bg-cover bg-center bg-no-repeat"),rn(e,"background-image","url("+(((r=n[33])==null?void 0:r.backgroundImageUrl)??((o=(a=n[35])==null?void 0:a.license_metadata)==null?void 0:o.background_image_url))+")"),A(s,"class","absolute top-0 left-0 w-full h-full bg-linear-to-t from-white to-white/85 dark:from-gray-900 dark:to-gray-900/90 z-0")},m(r,a){ee(r,e,a),ee(r,i,a),ee(r,s,a)},p(r,a){var o,l,c;a[1]&256&&t!==(t="absolute "+(r[39]?"md:max-w-[calc(100%-260px)] md:translate-x-[260px]":"")+" top-0 left-0 w-full h-full bg-cover bg-center bg-no-repeat")&&A(e,"class",t),a[1]&20&&rn(e,"background-image","url("+(((o=r[33])==null?void 0:o.backgroundImageUrl)??((c=(l=r[35])==null?void 0:l.license_metadata)==null?void 0:c.background_image_url))+")")},d(r){r&&(S(e),S(i),S(s))}}}function _le(n){let e,t,i,s,r,a,o,l,c,h,u,d,f,g;function m(M){n[88](M)}function b(M){n[89](M)}function p(M){n[90](M)}function y(M){n[91](M)}function w(M){n[92](M)}function _(M){n[93](M)}function v(M){n[94](M)}function C(M){n[95](M)}function k(M){n[96](M)}function I(M){n[97](M)}function E(M){n[98](M)}let T={history:n[24],selectedModels:n[0],toolServers:n[36],stopResponse:n[53],createMessagePair:n[49],onSelect:n[42],onChange:n[87]};return n[6]!==void 0&&(T.messageInput=n[6]),n[28]!==void 0&&(T.files=n[28]),n[26]!==void 0&&(T.prompt=n[26]),n[7]!==void 0&&(T.autoScroll=n[7]),n[17]!==void 0&&(T.selectedToolIds=n[17]),n[18]!==void 0&&(T.selectedFilterIds=n[18]),n[19]!==void 0&&(T.imageGenerationEnabled=n[19]),n[21]!==void 0&&(T.codeInterpreterEnabled=n[21]),n[20]!==void 0&&(T.webSearchEnabled=n[20]),n[1]!==void 0&&(T.atSelectedModel=n[1]),n[22]!==void 0&&(T.showCommands=n[22]),t=new xle({props:T}),At.push(()=>qt(t,"messageInput",m)),At.push(()=>qt(t,"files",b)),At.push(()=>qt(t,"prompt",p)),At.push(()=>qt(t,"autoScroll",y)),At.push(()=>qt(t,"selectedToolIds",w)),At.push(()=>qt(t,"selectedFilterIds",_)),At.push(()=>qt(t,"imageGenerationEnabled",v)),At.push(()=>qt(t,"codeInterpreterEnabled",C)),At.push(()=>qt(t,"webSearchEnabled",k)),At.push(()=>qt(t,"atSelectedModel",I)),At.push(()=>qt(t,"showCommands",E)),t.$on("upload",n[99]),t.$on("submit",n[100]),{c(){e=te("div"),pe(t.$$.fragment),this.h()},l(M){e=ne(M,"DIV",{class:!0});var D=V(e);ye(t.$$.fragment,D),D.forEach(S),this.h()},h(){A(e,"class","flex items-center h-full")},m(M,D){ee(M,e,D),be(t,e,null),g=!0},p(M,D){const H={};D[0]&16777216&&(H.history=M[24]),D[0]&1&&(H.selectedModels=M[0]),D[1]&32&&(H.toolServers=M[36]),D[0]&1073741824&&(H.onChange=M[87]),!i&&D[0]&64&&(i=!0,H.messageInput=M[6],Wt(()=>i=!1)),!s&&D[0]&268435456&&(s=!0,H.files=M[28],Wt(()=>s=!1)),!r&&D[0]&67108864&&(r=!0,H.prompt=M[26],Wt(()=>r=!1)),!a&&D[0]&128&&(a=!0,H.autoScroll=M[7],Wt(()=>a=!1)),!o&&D[0]&131072&&(o=!0,H.selectedToolIds=M[17],Wt(()=>o=!1)),!l&&D[0]&262144&&(l=!0,H.selectedFilterIds=M[18],Wt(()=>l=!1)),!c&&D[0]&524288&&(c=!0,H.imageGenerationEnabled=M[19],Wt(()=>c=!1)),!h&&D[0]&2097152&&(h=!0,H.codeInterpreterEnabled=M[21],Wt(()=>h=!1)),!u&&D[0]&1048576&&(u=!0,H.webSearchEnabled=M[20],Wt(()=>u=!1)),!d&&D[0]&2&&(d=!0,H.atSelectedModel=M[1],Wt(()=>d=!1)),!f&&D[0]&4194304&&(f=!0,H.showCommands=M[22],Wt(()=>f=!1)),t.$set(H)},i(M){g||(L(t.$$.fragment,M),g=!0)},o(M){j(t.$$.fragment,M),g=!1},d(M){M&&S(e),xe(t)}}}function vle(n){let e,t,i,s,r,a,o,l,c,h,u,d,f,g,m,b,p,y,w,_,v,C="",k,I,E;function T(de){n[68](de)}function M(de){n[69](de)}function D(de){n[70](de)}let H={chatId:n[31],setInputText:n[67],selectedModels:n[0],atSelectedModel:n[1],sendMessage:n[52],showMessage:n[43],submitMessage:n[54],continueResponse:n[56],regenerateResponse:n[55],mergeResponses:n[57],chatActionHandler:n[48],addMessages:n[50],topPadding:!0,bottomPadding:n[28].length>0,onSelect:n[42]};n[24]!==void 0&&(H.history=n[24]),n[7]!==void 0&&(H.autoScroll=n[7]),n[26]!==void 0&&(H.prompt=n[26]),i=new OF({props:H}),At.push(()=>qt(i,"history",T)),At.push(()=>qt(i,"autoScroll",M)),At.push(()=>qt(i,"prompt",D));function R(de){n[75](de)}function z(de){n[76](de)}function P(de){n[77](de)}function B(de){n[78](de)}function Z(de){n[79](de)}function G(de){n[80](de)}function Y(de){n[81](de)}function J(de){n[82](de)}function se(de){n[83](de)}function fe(de){n[84](de)}let he={history:n[24],taskIds:n[25],selectedModels:n[0],toolServers:n[36],generating:n[23],stopResponse:n[53],createMessagePair:n[49],onChange:n[73]};return n[28]!==void 0&&(he.files=n[28]),n[26]!==void 0&&(he.prompt=n[26]),n[7]!==void 0&&(he.autoScroll=n[7]),n[17]!==void 0&&(he.selectedToolIds=n[17]),n[18]!==void 0&&(he.selectedFilterIds=n[18]),n[19]!==void 0&&(he.imageGenerationEnabled=n[19]),n[21]!==void 0&&(he.codeInterpreterEnabled=n[21]),n[20]!==void 0&&(he.webSearchEnabled=n[20]),n[1]!==void 0&&(he.atSelectedModel=n[1]),n[22]!==void 0&&(he.showCommands=n[22]),c=new TO({props:he}),n[74](c),At.push(()=>qt(c,"files",R)),At.push(()=>qt(c,"prompt",z)),At.push(()=>qt(c,"autoScroll",P)),At.push(()=>qt(c,"selectedToolIds",B)),At.push(()=>qt(c,"selectedFilterIds",Z)),At.push(()=>qt(c,"imageGenerationEnabled",G)),At.push(()=>qt(c,"codeInterpreterEnabled",Y)),At.push(()=>qt(c,"webSearchEnabled",J)),At.push(()=>qt(c,"atSelectedModel",se)),At.push(()=>qt(c,"showCommands",fe)),c.$on("upload",n[85]),c.$on("submit",n[86]),{c(){e=te("div"),t=te("div"),pe(i.$$.fragment),o=Ae(),l=te("div"),pe(c.$$.fragment),_=Ae(),v=te("div"),v.innerHTML=C,this.h()},l(de){e=ne(de,"DIV",{class:!0,id:!0});var ge=V(e);t=ne(ge,"DIV",{class:!0});var N=V(t);ye(i.$$.fragment,N),N.forEach(S),ge.forEach(S),o=Se(de),l=ne(de,"DIV",{class:!0});var K=V(l);ye(c.$$.fragment,K),_=Se(K),v=ne(K,"DIV",{class:!0,"data-svelte-h":!0}),Ro(v)!=="svelte-ko82kn"&&(v.innerHTML=C),K.forEach(S),this.h()},h(){A(t,"class","h-full w-full flex flex-col"),A(e,"class","pb-2.5 flex flex-col justify-between w-full flex-auto overflow-auto h-0 max-w-full z-10 scrollbar-hidden"),A(e,"id","messages-container"),A(v,"class","absolute bottom-1 text-xs text-gray-500 text-center line-clamp-1 right-0 left-0"),A(l,"class","pb-2")},m(de,ge){ee(de,e,ge),q(e,t),be(i,t,null),n[71](e),ee(de,o,ge),ee(de,l,ge),be(c,l,null),q(l,_),q(l,v),k=!0,I||(E=pt(e,"scroll",n[72]),I=!0)},p(de,ge){const N={};ge[1]&1&&(N.chatId=de[31]),ge[0]&64&&(N.setInputText=de[67]),ge[0]&1&&(N.selectedModels=de[0]),ge[0]&2&&(N.atSelectedModel=de[1]),ge[0]&268435456&&(N.bottomPadding=de[28].length>0),!s&&ge[0]&16777216&&(s=!0,N.history=de[24],Wt(()=>s=!1)),!r&&ge[0]&128&&(r=!0,N.autoScroll=de[7],Wt(()=>r=!1)),!a&&ge[0]&67108864&&(a=!0,N.prompt=de[26],Wt(()=>a=!1)),i.$set(N);const K={};ge[0]&16777216&&(K.history=de[24]),ge[0]&33554432&&(K.taskIds=de[25]),ge[0]&1&&(K.selectedModels=de[0]),ge[1]&32&&(K.toolServers=de[36]),ge[0]&8388608&&(K.generating=de[23]),ge[0]&1073741824|ge[1]&1&&(K.onChange=de[73]),!h&&ge[0]&268435456&&(h=!0,K.files=de[28],Wt(()=>h=!1)),!u&&ge[0]&67108864&&(u=!0,K.prompt=de[26],Wt(()=>u=!1)),!d&&ge[0]&128&&(d=!0,K.autoScroll=de[7],Wt(()=>d=!1)),!f&&ge[0]&131072&&(f=!0,K.selectedToolIds=de[17],Wt(()=>f=!1)),!g&&ge[0]&262144&&(g=!0,K.selectedFilterIds=de[18],Wt(()=>g=!1)),!m&&ge[0]&524288&&(m=!0,K.imageGenerationEnabled=de[19],Wt(()=>m=!1)),!b&&ge[0]&2097152&&(b=!0,K.codeInterpreterEnabled=de[21],Wt(()=>b=!1)),!p&&ge[0]&1048576&&(p=!0,K.webSearchEnabled=de[20],Wt(()=>p=!1)),!y&&ge[0]&2&&(y=!0,K.atSelectedModel=de[1],Wt(()=>y=!1)),!w&&ge[0]&4194304&&(w=!0,K.showCommands=de[22],Wt(()=>w=!1)),c.$set(K)},i(de){k||(L(i.$$.fragment,de),L(c.$$.fragment,de),k=!0)},o(de){j(i.$$.fragment,de),j(c.$$.fragment,de),k=!1},d(de){de&&(S(e),S(o),S(l)),xe(i),n[71](null),n[74](null),xe(c),I=!1,E()}}}function kle(n){let e,t,i,s,r,a,o,l;function c(g){n[66](g)}let h={chat:{id:n[31],chat:{title:n[37],models:n[0],system:n[33].system??void 0,params:n[29],history:n[24],timestamp:Date.now()}},history:n[24],title:n[37],shareEnabled:!!n[24].currentId,initNewChat:n[47],showBanners:!n[22]};n[0]!==void 0&&(h.selectedModels=n[0]),e=new mne({props:h}),n[65](e),At.push(()=>qt(e,"selectedModels",c));const u=[vle,_le],d=[];function f(g,m){var b;return m[0]&16777216|m[1]&6&&(r=null),r==null&&(r=((b=g[33])==null?void 0:b.landingPageMode)==="chat"&&!g[32]||da(g[24],g[24].currentId).length>0),r?0:1}return a=f(n,[-1,-1,-1,-1,-1]),o=d[a]=u[a](n),{c(){pe(e.$$.fragment),i=Ae(),s=te("div"),o.c(),this.h()},l(g){ye(e.$$.fragment,g),i=Se(g),s=ne(g,"DIV",{class:!0});var m=V(s);o.l(m),m.forEach(S),this.h()},h(){A(s,"class","flex flex-col flex-auto z-10 w-full @container overflow-auto")},m(g,m){be(e,g,m),ee(g,i,m),ee(g,s,m),d[a].m(s,null),l=!0},p(g,m){const b={};m[0]&553648129|m[1]&69&&(b.chat={id:g[31],chat:{title:g[37],models:g[0],system:g[33].system??void 0,params:g[29],history:g[24],timestamp:Date.now()}}),m[0]&16777216&&(b.history=g[24]),m[1]&64&&(b.title=g[37]),m[0]&16777216&&(b.shareEnabled=!!g[24].currentId),m[0]&4194304&&(b.showBanners=!g[22]),!t&&m[0]&1&&(t=!0,b.selectedModels=g[0],Wt(()=>t=!1)),e.$set(b);let p=a;a=f(g,m),a===p?d[a].p(g,m):(ot(),j(d[p],1,1,()=>{d[p]=null}),lt(),o=d[a],o?o.p(g,m):(o=d[a]=u[a](g),o.c()),L(o,1),o.m(s,null))},i(g){l||(L(e.$$.fragment,g),L(o),l=!0)},o(g){j(e.$$.fragment,g),j(o),l=!1},d(g){g&&(S(i),S(s)),n[65](null),xe(e,g),d[a].d()}}}function Cle(n){var b;let e,t,i,s,r,a,o,l,c;e=new VI({props:{defaultSize:50,class:"h-full flex relative max-w-full flex-col",$$slots:{default:[kle]},$$scope:{ctx:n}}});function h(p){n[103](p)}function u(p){n[104](p)}function d(p){n[105](p)}function f(p){n[106](p)}function g(p){n[107](p)}let m={chatId:n[31],modelId:((b=n[2])==null?void 0:b.at(0))??null,models:n[2].reduce(n[101],[]),submitPrompt:n[51],stopResponse:n[53],showMessage:n[43],eventTarget:n[41]};return n[24]!==void 0&&(m.history=n[24]),n[27]!==void 0&&(m.chatFiles=n[27]),n[29]!==void 0&&(m.params=n[29]),n[28]!==void 0&&(m.files=n[28]),n[4]!==void 0&&(m.pane=n[4]),i=new Moe({props:m}),n[102](i),At.push(()=>qt(i,"history",h)),At.push(()=>qt(i,"chatFiles",u)),At.push(()=>qt(i,"params",d)),At.push(()=>qt(i,"files",f)),At.push(()=>qt(i,"pane",g)),{c(){pe(e.$$.fragment),t=Ae(),pe(i.$$.fragment)},l(p){ye(e.$$.fragment,p),t=Se(p),ye(i.$$.fragment,p)},m(p,y){be(e,p,y),ee(p,t,y),be(i,p,y),c=!0},p(p,y){var v;const w={};y[0]&2013135811|y[1]&103|y[4]&16384&&(w.$$scope={dirty:y,ctx:p}),e.$set(w);const _={};y[1]&1&&(_.chatId=p[31]),y[0]&4&&(_.modelId=((v=p[2])==null?void 0:v.at(0))??null),y[0]&4|y[1]&8&&(_.models=p[2].reduce(p[101],[])),!s&&y[0]&16777216&&(s=!0,_.history=p[24],Wt(()=>s=!1)),!r&&y[0]&134217728&&(r=!0,_.chatFiles=p[27],Wt(()=>r=!1)),!a&&y[0]&536870912&&(a=!0,_.params=p[29],Wt(()=>a=!1)),!o&&y[0]&268435456&&(o=!0,_.files=p[28],Wt(()=>o=!1)),!l&&y[0]&16&&(l=!0,_.pane=p[4],Wt(()=>l=!1)),i.$set(_)},i(p){c||(L(e.$$.fragment,p),L(i.$$.fragment,p),c=!0)},o(p){j(e.$$.fragment,p),j(i.$$.fragment,p),c=!1},d(p){p&&S(t),xe(e,p),n[102](null),xe(i,p)}}}function Ale(n){let e,t,i,s,r,a,o,l,c,h,u,d,f;i8.title=e=`
		`+(n[37]?`${n[37].length>30?`${n[37].slice(0,30)}...`:n[37]} • ${n[38]}`:`${n[38]}`)+`
	`;function g(w){n[62](w)}let m={title:n[11],message:n[12],input:n[13],inputPlaceholder:n[14],inputValue:n[15]};n[10]!==void 0&&(m.show=n[10]),a=new $I({props:m}),At.push(()=>qt(a,"show",g)),a.$on("confirm",n[63]),a.$on("cancel",n[64]);const b=[wle,yle],p=[];function y(w,_){return w[3]?w[3]?1:-1:0}return~(h=y(n))&&(u=p[h]=b[h](n)),{c(){t=Ae(),i=te("audio"),r=Ae(),pe(a.$$.fragment),l=Ae(),c=te("div"),u&&u.c(),this.h()},l(w){wD("svelte-5280jy",i8.head).forEach(S),t=Se(w),i=ne(w,"AUDIO",{id:!0,src:!0,style:!0}),V(i).forEach(S),r=Se(w),ye(a.$$.fragment,w),l=Se(w),c=ne(w,"DIV",{class:!0,id:!0});var v=V(c);u&&u.l(v),v.forEach(S),this.h()},h(){A(i,"id","audioElement"),k0(i.src,s="")||A(i,"src",s),rn(i,"display","none"),A(c,"class",d="h-screen max-h-[100dvh] transition-width duration-200 ease-in-out "+(n[39]?"  md:max-w-[calc(100%-260px)]":" ")+" w-full max-w-full flex flex-col"),A(c,"id","chat-container")},m(w,_){ee(w,t,_),ee(w,i,_),ee(w,r,_),be(a,w,_),ee(w,l,_),ee(w,c,_),~h&&p[h].m(c,null),f=!0},p(w,_){(!f||_[1]&192)&&e!==(e=`
		`+(w[37]?`${w[37].length>30?`${w[37].slice(0,30)}...`:w[37]} • ${w[38]}`:`${w[38]}`)+`
	`)&&(i8.title=e);const v={};_[0]&2048&&(v.title=w[11]),_[0]&4096&&(v.message=w[12]),_[0]&8192&&(v.input=w[13]),_[0]&16384&&(v.inputPlaceholder=w[14]),_[0]&32768&&(v.inputValue=w[15]),!o&&_[0]&1024&&(o=!0,v.show=w[10],Wt(()=>o=!1)),a.$set(v);let C=h;h=y(w),h===C?~h&&p[h].p(w,_):(u&&(ot(),j(p[C],1,1,()=>{p[C]=null}),lt()),~h?(u=p[h],u?u.p(w,_):(u=p[h]=b[h](w),u.c()),L(u,1),u.m(c,null)):u=null),(!f||_[1]&256&&d!==(d="h-screen max-h-[100dvh] transition-width duration-200 ease-in-out "+(w[39]?"  md:max-w-[calc(100%-260px)]":" ")+" w-full max-w-full flex flex-col"))&&A(c,"class",d)},i(w){f||(L(a.$$.fragment,w),L(u),f=!0)},o(w){j(a.$$.fragment,w),j(u),f=!1},d(w){w&&(S(t),S(i),S(r),S(l),S(c)),xe(a,w),~h&&p[h].d()}}}const Sle=5e3;function Ile(n,e,t){let i,s,r,a,o,l,c,h,u,d,f,g,m,b,p,y,w,_;Pe(n,Tl,Q=>t(113,i=Q)),Pe(n,Gd,Q=>t(30,s=Q)),Pe(n,xu,Q=>t(31,r=Q)),Pe(n,n1,Q=>t(32,a=Q)),Pe(n,Ya,Q=>t(33,o=Q)),Pe(n,em,Q=>t(34,c=Q)),Pe(n,UD,Q=>t(115,h=Q)),Pe(n,T0,Q=>t(116,u=Q)),Pe(n,$g,Q=>t(35,d=Q)),Pe(n,qI,Q=>t(36,f=Q)),Pe(n,Va,Q=>t(117,g=Q)),Pe(n,mv,Q=>t(118,m=Q)),Pe(n,cx,Q=>t(119,b=Q)),Pe(n,Jd,Q=>t(120,p=Q)),Pe(n,Dx,Q=>t(37,y=Q)),Pe(n,WI,Q=>t(38,w=Q)),Pe(n,a8,Q=>t(39,_=Q));const v=hs("i18n");Pe(n,v,Q=>t(114,l=Q));let{chatIdProp:C=""}=e,k=!0;const I=new EventTarget;let E,T,M,D=!0,H,R,z=!1,P="",B="",Z=!1,G="",Y="",J=null,se=[""],fe,he=[],de=[],ge=[],N=!1,K=!1,oe=!1,W=!1,le=!1,ce=null,Ce=null,X={messages:{},currentId:null},Ke=null,qe="",He=[],Me=[],Ne={};const Qe=async()=>{t(3,k=!0),t(26,qe=""),M==null||M.setText(""),t(28,Me=[]),t(17,de=[]),t(18,ge=[]),t(20,K=!1),t(19,N=!1);const Q=sessionStorage.getItem(`chat-input${C?`-${C}`:""}`);if(C&&await Gt()){if(await hn(),t(3,k=!1),window.setTimeout(()=>un(),0),await hn(),Q)try{const Fe=JSON.parse(Q);s||(M==null||M.setText(Fe.prompt),t(28,Me=Fe.files),t(17,de=Fe.selectedToolIds),t(18,ge=Fe.selectedFilterIds),t(20,K=Fe.webSearchEnabled),t(19,N=Fe.imageGenerationEnabled),t(21,oe=Fe.codeInterpreterEnabled))}catch{}const we=document.getElementById("chat-input");we==null||we.focus()}else await gv("/")},gt=async Q=>{const{type:we,data:Fe}=Q;we==="prompt"&&(M==null||M.setText(Fe))},mt=()=>{se.length===0||se.length===1&&se[0]===""||(sessionStorage.selectedModels=JSON.stringify(se),sessionStorage.selectedModels)};let Xe=[""];const rt=()=>{Xe.filter(Q=>Q).length>0&&me(),t(61,Xe=he)},me=()=>{Rt(),t(18,ge=[]),t(20,K=!1),t(19,N=!1),t(21,oe=!1)},Rt=async()=>{var we,Fe,bt,st;if(p||Jd.set(await c4(localStorage.token)),se.length!==1&&!fe)return;const Q=fe??c.find($e=>$e.id===se[0]);Q&&((Fe=(we=Q==null?void 0:Q.info)==null?void 0:we.meta)!=null&&Fe.toolIds)?t(17,de=[...new Set([...((st=(bt=Q==null?void 0:Q.info)==null?void 0:bt.meta)==null?void 0:st.toolIds)??[]].filter($e=>p.find(It=>It.id===$e)))]):t(17,de=[])},ct=async Q=>{await hn();const we=JSON.parse(JSON.stringify(r));let Fe=JSON.parse(JSON.stringify(Q.id)),bt=[];for(Fe===null?bt=Object.keys(X.messages).filter(st=>X.messages[st].parentId===null):bt=X.messages[Fe].childrenIds;bt.length!==0;)Fe=bt.at(-1),bt=X.messages[Fe].childrenIds;if(t(24,X.currentId=Fe,X),await hn(),await hn(),await hn(),(o==null?void 0:o.scrollOnBranchChange)??!0){const st=document.getElementById(`message-${Q.id}`);st&&st.scrollIntoView({behavior:"smooth"})}await hn(),En(we,X)},at=async(Q,we)=>{var Fe,bt;if(Q.chat_id===r){await hn();let st=X.messages[Q.message_id];if(st){const $e=((Fe=Q==null?void 0:Q.data)==null?void 0:Fe.type)??null,It=((bt=Q==null?void 0:Q.data)==null?void 0:bt.data)??null;if($e==="status")st!=null&&st.statusHistory?st.statusHistory.push(It):st.statusHistory=[It];else if($e==="chat:completion")Ms(It,st,Q.chat_id);else if($e==="chat:message:delta"||$e==="message")st.content+=It.content;else if($e==="chat:message"||$e==="replace")st.content=It.content;else if($e==="chat:message:files"||$e==="files")st.files=It.files;else if($e==="chat:message:follow_ups")st.followUps=It.follow_ups,D&&un("smooth");else if($e==="chat:title")Dx.set(It),Tl.set(1),await _c.set(await D0(localStorage.token,i));else if($e==="chat:tags")Ce=await o8(localStorage.token,r),HD.set(await rF(localStorage.token));else if($e==="source"||$e==="citation")if((It==null?void 0:It.type)==="code_execution"){st!=null&&st.code_executions||(st.code_executions=[]);const Vt=st.code_executions.findIndex(Pt=>Pt.id===It.id);Vt!==-1?st.code_executions[Vt]=It:st.code_executions.push(It),st.code_executions=st.code_executions}else st!=null&&st.sources?st.sources.push(It):st.sources=[It];else if($e==="notification"){const Vt=(It==null?void 0:It.type)??"info",Pt=(It==null?void 0:It.content)??"";Vt==="success"?Jt.success(Pt):Vt==="error"?Jt.error(Pt):Vt==="warning"?Jt.warning(Pt):Jt.info(Pt)}else if($e==="confirmation")t(16,J=we),t(13,Z=!1),t(10,z=!0),t(11,P=It.title),t(12,B=It.message);else if($e==="execute"){t(16,J=we);try{const Pt=await new Function(`return (async () => { ${It.code} })()`)();we&&we(Pt)}catch(Vt){console.error("Error executing code:",Vt)}}else $e==="input"&&(t(16,J=we),t(13,Z=!0),t(10,z=!0),t(11,P=It.title),t(12,B=It.message),t(14,G=It.placeholder),t(15,Y=(It==null?void 0:It.value)??""));t(24,X.messages[Q.message_id]=st,X)}}},ze=async Q=>{if(Q.origin===window.origin){if(Q.data.type==="input:prompt"){Q.data.text;const we=document.getElementById("chat-input");we&&(M==null||M.setText(Q.data.text),we.focus())}Q.data.type==="action:submit"&&(Q.data.text,qe!==""&&(await hn(),Ki(qe))),Q.data.type==="input:prompt:submit"&&(Q.data.text,Q.data.text!==""&&(await hn(),Ki(Q.data.text)))}};let Ht=null;fl(async()=>{t(3,k=!0),window.addEventListener("message",ze),h==null||h.on("chat-events",at),Ht=mv.subscribe(async Fe=>{Fe.url.pathname==="/"&&(await hn(),yt())});const Q=sessionStorage.getItem(`chat-input${C?`-${C}`:""}`);if(C||(t(3,k=!1),await hn()),Q){t(26,qe=""),M==null||M.setText(""),t(28,Me=[]),t(17,de=[]),t(18,ge=[]),t(20,K=!1),t(19,N=!1),t(21,oe=!1);try{const Fe=JSON.parse(Q);s||(M==null||M.setText(Fe.prompt),t(28,Me=Fe.files),t(17,de=Fe.selectedToolIds),t(18,ge=Fe.selectedFilterIds),t(20,K=Fe.webSearchEnabled),t(19,N=Fe.imageGenerationEnabled),t(21,oe=Fe.codeInterpreterEnabled))}catch{}}Qi.subscribe(async Fe=>{if(E&&!b)try{Fe?T.openPane():E.collapse()}catch{}Fe||(Va.set(!1),u0.set(!1),ic.set(!1))});const we=document.getElementById("chat-input");we==null||we.focus(),_c.subscribe(()=>{})}),$h(()=>{Ht(),window.removeEventListener("message",ze),h==null||h.off("chat-events",at)});const on=async Q=>{var bt,st,$e,It,Vt,Pt;if(Q.id,Q.name,Q.url,`${token}`,!(Q!=null&&Q.id)||!(Q!=null&&Q.name)||!(Q!=null&&Q.url)||!((bt=Q==null?void 0:Q.headers)!=null&&bt.Authorization))throw new Error("Invalid file data provided");const we=Rl(),Fe={type:"file",file:"",id:null,url:Q.url,name:Q.name,collection_name:"",status:"uploading",error:"",itemId:we,size:0};try{t(28,Me=[...Me,Fe]),Q.url;const Un={headers:{Authorization:Q.headers.Authorization,Accept:"*/*"},method:"GET"},In=await fetch(Q.url,Un);if(!In.ok){const yl=await In.text();throw new Error(`Failed to fetch file (${In.status}): ${yl}`)}const pn=In.headers.get("content-type")||"application/octet-stream",fi=await In.blob();if(fi.size===0)throw new Error("Retrieved file is empty");fi.size,fi.type;const Ji=new File([fi],Q.name,{type:fi.type||pn});if(Ji.name,Ji.size,Ji.type,Ji.size===0)throw new Error("Created file is empty");let va=null;(Ji.type.startsWith("audio/")||Ji.type.startsWith("video/"))&&(($e=(st=o==null?void 0:o.audio)==null?void 0:st.stt)!=null&&$e.language)&&(va={language:(Vt=(It=o==null?void 0:o.audio)==null?void 0:It.stt)==null?void 0:Vt.language});const $s=await uploadFile(localStorage.token,Ji,va);if(!$s)throw new Error("Server returned null response for file upload");Fe.status="uploaded",Fe.file=$s,Fe.id=$s.id,Fe.size=Ji.size,Fe.collection_name=(Pt=$s==null?void 0:$s.meta)==null?void 0:Pt.collection_name,Fe.url=`${WEBUI_API_BASE_URL}/files/${$s.id}`,t(28,Me),Jt.success(l.t("File uploaded successfully"))}catch(Un){console.error("Error uploading file:",Un),t(28,Me=Me.filter(In=>In.itemId!==we)),Jt.error(l.t("Error uploading file: {{error}}",{error:Un.message||"Unknown error"}))}},Re=async Q=>{const we={type:"doc",name:Q,collection_name:"",status:"uploading",url:Q,error:""};try{t(28,Me=[...Me,we]);const Fe=await lF(localStorage.token,"",Q);Fe&&(we.status="uploaded",we.collection_name=Fe.collection_name,we.file={...Fe.file,...we.file},t(28,Me))}catch(Fe){t(28,Me=Me.filter(bt=>bt.name!==Q)),Jt.error(JSON.stringify(Fe))}},Mt=async Q=>{const we={type:"doc",name:Q,collection_name:"",status:"uploading",context:"full",url:Q,error:""};try{t(28,Me=[...Me,we]);const Fe=await cF(localStorage.token,Q);Fe&&(we.status="uploaded",we.collection_name=Fe.collection_name,we.file={...Fe.file,...we.file},t(28,Me))}catch(Fe){t(28,Me=Me.filter(bt=>bt.name!==Q)),Jt.error(`${Fe}`)}},yt=async()=>{var bt,st,$e,It,Vt;(u==null?void 0:u.role)!=="admin"&&((st=(bt=u==null?void 0:u.permissions)==null?void 0:bt.chat)!=null&&st.temporary_enforced)&&await Gd.set(!0);const Q=c.filter(Pt=>{var Un,In;return!(((In=(Un=Pt==null?void 0:Pt.info)==null?void 0:Un.meta)==null?void 0:In.hidden)??!1)}).map(Pt=>Pt.id);if(m.url.searchParams.get("models")||m.url.searchParams.get("model")){const Pt=($e=m.url.searchParams.get("models")||m.url.searchParams.get("model")||"")==null?void 0:$e.split(",");if(Pt.length===1)if(c.find(In=>In.id===Pt[0]))t(0,se=Pt);else{const In=document.getElementById("model-selector-0-button");if(In){In.click(),await hn();const pn=document.getElementById("model-search-input");pn&&(pn.focus(),pn.value=Pt[0],pn.dispatchEvent(new Event("input")))}}else t(0,se=Pt);t(0,se=se.filter(Un=>c.map(In=>In.id).includes(Un)))}else sessionStorage.selectedModels?(t(0,se=JSON.parse(sessionStorage.selectedModels)),sessionStorage.removeItem("selectedModels")):o!=null&&o.models?t(0,se=o==null?void 0:o.models):d!=null&&d.default_models&&(d==null||d.default_models.split(","),t(0,se=d==null?void 0:d.default_models.split(","))),t(0,se=se.filter(Pt=>Q.includes(Pt)));if((se.length===0||se.length===1&&se[0]==="")&&(Q.length>0?t(0,se=[(Q==null?void 0:Q.at(0))??""]):t(0,se=[""])),await Qi.set(!1),await Va.set(!1),await u0.set(!1),await ic.set(!1),m.url.pathname.includes("/c/")&&window.history.replaceState(X.state,"","/"),t(7,D=!0),me(),await xu.set(""),await Dx.set(""),t(24,X={messages:{},currentId:null}),t(27,He=[]),t(29,Ne={}),m.url.searchParams.get("youtube")&&Mt(`https://www.youtube.com/watch?v=${m.url.searchParams.get("youtube")}`),m.url.searchParams.get("load-url")&&await Re(m.url.searchParams.get("load-url")),m.url.searchParams.get("web-search")==="true"&&t(20,K=!0),m.url.searchParams.get("image-generation")==="true"&&t(19,N=!0),m.url.searchParams.get("code-interpreter")==="true"&&t(21,oe=!0),m.url.searchParams.get("tools")?t(17,de=(It=m.url.searchParams.get("tools"))==null?void 0:It.split(",").map(Pt=>Pt.trim()).filter(Pt=>Pt)):m.url.searchParams.get("tool-ids")&&t(17,de=(Vt=m.url.searchParams.get("tool-ids"))==null?void 0:Vt.split(",").map(Pt=>Pt.trim()).filter(Pt=>Pt)),m.url.searchParams.get("call")==="true"&&(Va.set(!0),Qi.set(!0)),m.url.searchParams.get("q")){const Pt=m.url.searchParams.get("q")??"";M==null||M.setText(Pt),Pt&&(m.url.searchParams.get("submit")??"true")==="true"&&(await hn(),Ki(Pt))}t(0,se=se.map(Pt=>c.map(Un=>Un.id).includes(Pt)?Pt:""));const we=await wv(localStorage.token);we?Ya.set(we.ui):Ya.set(JSON.parse(localStorage.getItem("settings")??"{}"));const Fe=document.getElementById("chat-input");setTimeout(()=>Fe==null?void 0:Fe.focus(),0)},Gt=async()=>{var Q,we;if(xu.set(C),s&&Gd.set(!1),Ce=await o8(localStorage.token,r).catch(async Fe=>(await gv("/"),null)),Ce){await aF(localStorage.token,r).catch(async bt=>[]);const Fe=Ce.chat;if(Fe){t(0,se=((Fe==null?void 0:Fe.models)??void 0)!==void 0?Fe.models:[Fe.models??""]),(u==null?void 0:u.role)==="admin"||(((we=(Q=u==null?void 0:u.permissions)==null?void 0:Q.chat)==null?void 0:we.multiple_models)??!0)||t(0,se=se.length>0?[se[0]]:[""]),t(61,Xe=se),t(24,X=((Fe==null?void 0:Fe.history)??void 0)!==void 0?Fe.history:nF(Fe.messages)),Dx.set(Fe.title);const bt=await wv(localStorage.token);if(bt?await Ya.set(bt.ui):await Ya.set(JSON.parse(localStorage.getItem("settings")??"{}")),t(29,Ne=(Fe==null?void 0:Fe.params)??{}),t(27,He=(Fe==null?void 0:Fe.files)??[]),t(7,D=!0),await hn(),X.currentId)for(const $e of Object.values(X.messages))$e.role==="assistant"&&($e.done=!0);const st=await dF(localStorage.token,r).catch($e=>null);return st&&t(25,Ke=st.task_ids),await hn(),!0}else return null}},un=async(Q="auto")=>{await hn(),H&&H.scrollTo({top:H.scrollHeight,behavior:Q})},Kn=async(Q,we,Fe,bt)=>{const st=await pF(localStorage.token,{model:we,messages:bt.map($e=>({id:$e.id,role:$e.role,content:$e.content,info:$e.info?$e.info:void 0,timestamp:$e.timestamp,...$e.usage?{usage:$e.usage}:{},...$e.sources?{sources:$e.sources}:{}})),filter_ids:ge.length>0?ge:void 0,model_item:c.find($e=>$e.id===we),chat_id:Q,session_id:h==null?void 0:h.id,id:Fe}).catch($e=>(Jt.error(`${$e}`),bt.at(-1).error={content:$e},null));if(st!==null&&st.messages)for(const $e of st.messages)$e!=null&&$e.id&&t(24,X.messages[$e.id]={...X.messages[$e.id],...X.messages[$e.id].content!==$e.content?{originalContent:X.messages[$e.id].content}:{},...$e},X);await hn(),r==Q&&(s||(Ce=await cw(localStorage.token,Q,{models:se,messages:bt,history:X,params:Ne,files:He}),Tl.set(1),await _c.set(await D0(localStorage.token,i)))),t(25,Ke=null)},di=async(Q,we,Fe,bt,st=null)=>{const $e=da(X,bt),It=await fF(localStorage.token,we,{model:Fe,messages:$e.map(Vt=>({id:Vt.id,role:Vt.role,content:Vt.content,info:Vt.info?Vt.info:void 0,timestamp:Vt.timestamp,...Vt.sources?{sources:Vt.sources}:{}})),...st?{event:st}:{},model_item:c.find(Vt=>Vt.id===Fe),chat_id:Q,session_id:h==null?void 0:h.id,id:bt}).catch(Vt=>(Jt.error(`${Vt}`),$e.at(-1).error={content:Vt},null));if(It!==null&&It.messages)for(const Vt of It.messages)t(24,X.messages[Vt.id]={...X.messages[Vt.id],...X.messages[Vt.id].content!==Vt.content?{originalContent:X.messages[Vt.id].content}:{},...Vt},X);r==Q&&(s||(Ce=await cw(localStorage.token,Q,{models:se,messages:$e,history:X,params:Ne,files:He}),Tl.set(1),await _c.set(await D0(localStorage.token,i))))},qi=async(Q,we="")=>setInterval(()=>{h==null||h.emit("usage",{action:"chat",model:Q,chat_id:we})},1e3),Cs=async Q=>{if(M==null||M.setText(""),se.length===0)Jt.error(l.t("Model not selected"));else{const we=se[0],Fe=c.filter(Un=>Un.id===we).at(0),bt=da(X,X.currentId),st=bt.length!==0?bt.at(-1):null,$e=Rl(),It=Rl(),Vt={id:$e,parentId:st?st.id:null,childrenIds:[It],role:"user",content:Q||`[PROMPT] ${$e}`,timestamp:Math.floor(Date.now()/1e3)},Pt={id:It,parentId:$e,childrenIds:[],role:"assistant",content:`[RESPONSE] ${It}`,done:!0,model:we,modelName:Fe.name??Fe.id,modelIdx:0,timestamp:Math.floor(Date.now()/1e3)};st&&(st.childrenIds.push($e),t(24,X.messages[st.id]=st,X)),t(24,X.messages[$e]=Vt,X),t(24,X.messages[It]=Pt,X),t(24,X.currentId=It,X),await hn(),D&&un(),bt.length===0?await tn(X):await En(r,X)}},Wi=async({modelId:Q,parentId:we,messages:Fe})=>{const bt=c.filter(It=>It.id===Q).at(0);let st=X.messages[we],$e=st?st.id:null;for(const It of Fe){let Vt=Rl();if(It.role==="user"){const Pt={id:Vt,parentId:$e,childrenIds:[],timestamp:Math.floor(Date.now()/1e3),...It};st&&(st.childrenIds.push(Vt),t(24,X.messages[st.id]=st,X)),t(24,X.messages[Vt]=Pt,X),st=Pt,$e=Vt}else{const Pt={id:Vt,parentId:$e,childrenIds:[],done:!0,model:bt.id,modelName:bt.name??bt.id,modelIdx:0,timestamp:Math.floor(Date.now()/1e3),...It};st&&(st.childrenIds.push(Vt),t(24,X.messages[st.id]=st,X)),t(24,X.messages[Vt]=Pt,X),st=Pt,$e=Vt}}t(24,X.currentId=$e,X),await hn(),D&&un(),Fe.length===0?await tn(X):await En(r,X)},Ms=async(Q,we,Fe)=>{var pn,fi,Ji,va,$s,yl,R0,tu,M0,nu,vm,km,Cm,Am;const{id:bt,done:st,choices:$e,content:It,sources:Vt,selected_model_id:Pt,error:Un,usage:In}=Q;if(Un&&await Ps(Un,we),Vt&&!(we!=null&&we.sources)&&(we.sources=Vt),$e)if((fi=(pn=$e[0])==null?void 0:pn.message)!=null&&fi.content)we.content+=(va=(Ji=$e[0])==null?void 0:Ji.message)==null?void 0:va.content;else{let er=((yl=($s=$e[0])==null?void 0:$s.delta)==null?void 0:yl.content)??"";if(!(we.content==""&&er==`
`)){we.content+=er,navigator.vibrate&&((o==null?void 0:o.hapticFeedback)??!1)&&navigator.vibrate(5);const Po=ow(lw(we.content),((tu=(R0=d==null?void 0:d.audio)==null?void 0:R0.tts)==null?void 0:tu.split_on)??"punctuation");Po.pop(),Po.length>0&&Po[Po.length-1]!==we.lastSentence&&(we.lastSentence=Po[Po.length-1],I.dispatchEvent(new CustomEvent("chat",{detail:{id:we.id,content:Po[Po.length-1]}})))}}if(It){we.content=It,navigator.vibrate&&((o==null?void 0:o.hapticFeedback)??!1)&&navigator.vibrate(5);const er=ow(lw(we.content),((nu=(M0=d==null?void 0:d.audio)==null?void 0:M0.tts)==null?void 0:nu.split_on)??"punctuation");er.pop(),er.length>0&&er[er.length-1]!==we.lastSentence&&(we.lastSentence=er[er.length-1],I.dispatchEvent(new CustomEvent("chat",{detail:{id:we.id,content:er[er.length-1]}})))}if(Pt&&(we.selectedModelId=Pt,we.arena=!0),In&&(we.usage=In),t(24,X.messages[we.id]=we,X),st){we.done=!0,o.responseAutoCopy&&l4(we.content),o.responseAutoPlayback&&!g&&(await hn(),(vm=document.getElementById(`speak-button-${we.id}`))==null||vm.click());let er=((Am=ow(lw(we.content),((Cm=(km=d==null?void 0:d.audio)==null?void 0:km.tts)==null?void 0:Cm.split_on)??"punctuation"))==null?void 0:Am.at(-1))??"";er&&I.dispatchEvent(new CustomEvent("chat",{detail:{id:we.id,content:er}})),I.dispatchEvent(new CustomEvent("chat:finish",{detail:{id:we.id,content:we.content}})),t(24,X.messages[we.id]=we,X),await hn(),D&&un(),await Kn(Fe,we.model,we.id,da(X,we.id))}await hn(),D&&un()},Ki=async(Q,{_raw:we=!1}={})=>{var Pt,Un,In;const Fe=da(X,X.currentId),bt=se.map(pn=>c.map(fi=>fi.id).includes(pn)?pn:"");if(JSON.stringify(se)!==JSON.stringify(bt)&&t(0,se=bt),Q===""&&Me.length===0){Jt.error(l.t("Please enter a prompt"));return}if(se.includes("")){Jt.error(l.t("Model not selected"));return}if(Fe.length!=0&&Fe.at(-1).done!=!0)return;if(Fe.length!=0&&Fe.at(-1).error&&!Fe.at(-1).content){Jt.error(l.t("Oops! There was an error in the previous response."));return}if(Me.length>0&&Me.filter(pn=>pn.type!=="image"&&pn.status==="uploading").length>0){Jt.error(l.t("Oops! There are files still uploading. Please wait for the upload to complete."));return}if((((Pt=d==null?void 0:d.file)==null?void 0:Pt.max_count)??null)!==null&&Me.length+He.length>((Un=d==null?void 0:d.file)==null?void 0:Un.max_count)){Jt.error(l.t("You can only chat with a maximum of {{maxCount}} file(s) at a time.",{maxCount:(In=d==null?void 0:d.file)==null?void 0:In.max_count}));return}if(M==null||M.setText(""),!((o==null?void 0:o.richTextInput)??!0)){const pn=document.getElementById("chat-input");pn&&(await hn(),pn.style.height="")}const st=JSON.parse(JSON.stringify(Me));He.push(...st.filter(pn=>["doc","file","collection"].includes(pn.type))),t(27,He=He.filter((pn,fi,Ji)=>Ji.findIndex(va=>JSON.stringify(va)===JSON.stringify(pn))===fi)),t(28,Me=[]),M==null||M.setText("");let $e=Rl(),It={id:$e,parentId:Fe.length!==0?Fe.at(-1).id:null,childrenIds:[],role:"user",content:Q,files:st.length>0?st:void 0,timestamp:Math.floor(Date.now()/1e3),models:se};t(24,X.messages[$e]=It,X),t(24,X.currentId=$e,X),Fe.length!==0&&X.messages[Fe.at(-1).id].childrenIds.push($e);const Vt=document.getElementById("chat-input");Vt==null||Vt.focus(),mt(),await yi(X,$e,{newChat:!0})},yi=async(Q,we,{messages:Fe=null,modelId:bt=null,modelIdx:st=null,newChat:$e=!1}={})=>{D&&un();let It=JSON.parse(JSON.stringify(r));Q=JSON.parse(JSON.stringify(Q));const Vt={};let Pt=bt?[bt]:fe!==void 0?[fe.id]:se;for(const[Un,In]of Pt.entries()){const pn=c.filter(fi=>fi.id===In).at(0);if(pn){let fi=Rl(),Ji={parentId:we,id:fi,childrenIds:[],role:"assistant",content:"",model:pn.id,modelName:pn.name??pn.id,modelIdx:st||Un,timestamp:Math.floor(Date.now()/1e3)};t(24,X.messages[fi]=Ji,X),t(24,X.currentId=fi,X),we!==null&&X.messages[we]&&t(24,X.messages[we].childrenIds=[...X.messages[we].childrenIds,fi],X),Vt[`${In}-${st||Un}`]=fi}}t(24,X),$e&&Q.messages[Q.currentId].parentId===null&&(It=await tn(Q)),await hn(),Q=JSON.parse(JSON.stringify(X)),await En(It,Q),await Promise.all(Pt.map(async(Un,In)=>{var fi,Ji,va;const pn=c.filter($s=>$s.id===Un).at(0);if(pn){da(Q,we).some(tu=>{var M0;return(M0=tu.files)==null?void 0:M0.some(nu=>nu.type==="image")})&&!(((va=(Ji=(fi=pn.info)==null?void 0:fi.meta)==null?void 0:Ji.capabilities)==null?void 0:va.vision)??!0)&&Jt.error(l.t("Model {{modelName}} is not vision capable",{modelName:pn.name??pn.id}));let yl=Vt[`${Un}-${st||In}`];const R0=await qi(pn.id,It);un(),await yr(pn,Fe&&Fe.length>0?Fe:da(Q,yl),Q,yl),R0&&clearInterval(R0)}else Jt.error(l.t("Model {{modelId}} not found",{modelId:Un}))})),Tl.set(1),_c.set(await D0(localStorage.token,i))},yr=async(Q,we,Fe,bt,st)=>{var fi,Ji,va,$s,yl,R0,tu,M0,nu,vm,km,Cm,Am,er,Po,sv,rv,av,ov;const $e=Fe.messages[bt],It=Fe.messages[$e.parentId],Vt=we.filter($t=>$t.files).flatMap($t=>$t.files);t(27,He=He.filter($t=>Vt.some(iu=>iu.id===$t.id)));let Pt=JSON.parse(JSON.stringify(He));Pt.push(...((It==null?void 0:It.files)??[]).filter($t=>["doc","text","file","note","collection"].includes($t.type))),Pt=Pt.filter(($t,no,iu)=>iu.findIndex(Nx=>JSON.stringify(Nx)===JSON.stringify($t))===no),un(),I.dispatchEvent(new CustomEvent("chat:start",{detail:{id:bt}})),await hn();const Un=((Ji=(fi=Q==null?void 0:Q.info)==null?void 0:fi.params)==null?void 0:Ji.stream_response)??((va=o==null?void 0:o.params)==null?void 0:va.stream_response)??(Ne==null?void 0:Ne.stream_response)??!0;let In=[Ne!=null&&Ne.system||o.system?{role:"system",content:`${$D((Ne==null?void 0:Ne.system)??(o==null?void 0:o.system)??"",u==null?void 0:u.name,o!=null&&o.userLocation?await _v(localStorage.token).catch($t=>{console.error($t)}):void 0)}`}:void 0,...we.map($t=>({...$t,content:eF($t.content)}))].filter($t=>$t);In=In.map(($t,no,iu)=>{var Nx,lv,cv;return{role:$t.role,...((Nx=$t.files)==null?void 0:Nx.filter(Sm=>Sm.type==="image").length)>0&&$t.role==="user"?{content:[{type:"text",text:((lv=$t==null?void 0:$t.merged)==null?void 0:lv.content)??$t.content},...$t.files.filter(Sm=>Sm.type==="image").map(Sm=>({type:"image_url",image_url:{url:Sm.url}}))]}:{content:((cv=$t==null?void 0:$t.merged)==null?void 0:cv.content)??$t.content}}}).filter($t=>{var no;return($t==null?void 0:$t.role)==="user"||((no=$t==null?void 0:$t.content)==null?void 0:no.trim())});const pn=await oF(localStorage.token,{stream:Un,model:Q.id,messages:In,params:{...o==null?void 0:o.params,...Ne,stop:(Ne==null?void 0:Ne.stop)??(($s=o==null?void 0:o.params)==null?void 0:$s.stop)??void 0?((Ne==null?void 0:Ne.stop.split(",").map($t=>$t.trim()))??o.params.stop).map($t=>decodeURIComponent(JSON.parse('"'+$t.replace(/\"/g,'\\"')+'"'))):void 0},files:((Pt==null?void 0:Pt.length)??0)>0?Pt:void 0,filter_ids:ge.length>0?ge:void 0,tool_ids:de.length>0?de:void 0,tool_servers:f,features:{image_generation:(yl=d==null?void 0:d.features)!=null&&yl.enable_image_generation&&((u==null?void 0:u.role)==="admin"||(tu=(R0=u==null?void 0:u.permissions)==null?void 0:R0.features)!=null&&tu.image_generation)?N:!1,code_interpreter:(M0=d==null?void 0:d.features)!=null&&M0.enable_code_interpreter&&((u==null?void 0:u.role)==="admin"||(vm=(nu=u==null?void 0:u.permissions)==null?void 0:nu.features)!=null&&vm.code_interpreter)?oe:!1,web_search:(km=d==null?void 0:d.features)!=null&&km.enable_web_search&&((u==null?void 0:u.role)==="admin"||(Am=(Cm=u==null?void 0:u.permissions)==null?void 0:Cm.features)!=null&&Am.web_search)?K||((o==null?void 0:o.webSearch)??!1)==="always":!1,memory:(o==null?void 0:o.memory)??!1},variables:{...tF(u==null?void 0:u.name,o!=null&&o.userLocation?await _v(localStorage.token).catch($t=>{console.error($t)}):void 0)},model_item:c.find($t=>$t.id===Q.id),session_id:h==null?void 0:h.id,chat_id:r,id:bt,background_tasks:{...!s&&(In.length==1||In.length==2&&((er=In.at(0))==null?void 0:er.role)==="system"&&((Po=In.at(1))==null?void 0:Po.role)==="user")&&(se[0]===Q.id||fe!==void 0)?{title_generation:((sv=o==null?void 0:o.title)==null?void 0:sv.auto)??!0,tags_generation:(o==null?void 0:o.autoTags)??!0}:{},follow_up_generation:(o==null?void 0:o.autoFollowUps)??!0},...Un&&(((ov=(av=(rv=Q.info)==null?void 0:rv.meta)==null?void 0:av.capabilities)==null?void 0:ov.usage)??!1)?{stream_options:{include_usage:!0}}:{}},`${tl}/api`).catch(async $t=>{var iu;let no=$t;return(iu=$t==null?void 0:$t.error)!=null&&iu.message?no=$t.error.message:$t!=null&&$t.message&&(no=$t.message),typeof no=="object"&&(no=l.t("Uh-oh! There was an issue with the response.")),Jt.error(`${no}`),$e.error={content:$t},$e.done=!0,t(24,X.messages[bt]=$e,X),t(24,X.currentId=bt,X),null});pn&&(pn.error?await Ps(pn.error,$e):Ke?Ke.push(pn.task_id):t(25,Ke=[pn.task_id])),await hn(),un()},Ps=async(Q,we)=>{let Fe="",bt;Q&&(bt=Q),console.error(bt),"detail"in bt?(Jt.error(bt.detail),Fe=bt.detail):"error"in bt?"message"in bt.error?(Jt.error(bt.error.message),Fe=bt.error.message):(Jt.error(bt.error),Fe=bt.error):"message"in bt&&(Jt.error(bt.message),Fe=bt.message),we.error={content:l.t("Uh-oh! There was an issue with the response.")+`
`+Fe},we.done=!0,we.statusHistory&&(we.statusHistory=we.statusHistory.filter(st=>st.action!=="knowledge_search")),t(24,X.messages[we.id]=we,X)},Ns=async()=>{if(Ke){for(const we of Ke)await gF(localStorage.token,we).catch(Fe=>(Jt.error(`${Fe}`),null));t(25,Ke=null);const Q=X.messages[X.currentId];for(const we of X.messages[Q.parentId].childrenIds)t(24,X.messages[we].done=!0,X);t(24,X.messages[X.currentId]=Q,X),D&&un()}le&&(t(23,le=!1),ce==null||ce.abort(),ce=null)},Oe=async(Q,we)=>{let Fe=we,bt=Rl(),st={id:bt,parentId:Q,childrenIds:[],role:"user",content:Fe,models:se,timestamp:Math.floor(Date.now()/1e3)};Q!==null&&t(24,X.messages[Q].childrenIds=[...X.messages[Q].childrenIds,bt],X),t(24,X.messages[bt]=st,X),t(24,X.currentId=bt,X),await hn(),D&&un(),await yi(X,bt)},je=async(Q,we=null)=>{if(X.currentId){let Fe=X.messages[Q.parentId];D&&un(),await yi(X,Fe.id,{...we?{messages:[...da(X,Q.id),{role:"user",content:we}]}:{},...((Fe==null?void 0:Fe.models)??[...se]).length>1?{modelId:Q.model,modelIdx:Q.modelIdx}:{}})}},ht=async()=>{if(JSON.parse(JSON.stringify(r)),X.currentId&&X.messages[X.currentId].done==!0){const Q=X.messages[X.currentId];Q.done=!1,await hn();const we=c.filter(Fe=>Fe.id===((Q==null?void 0:Q.selectedModelId)??Q.model)).at(0);we&&await yr(we,da(X,Q.id),X,Q.id)}},Xt=async(Q,we,Fe)=>{const bt=X.messages[Q],st={status:!0,content:""};bt.merged=st,t(24,X.messages[Q]=bt,X);try{t(23,le=!0);const[$e,It]=await mF(localStorage.token,bt.model,X.messages[bt.parentId].content,we);if($e&&$e.ok&&$e.body&&le){ce=It;const Vt=await SL($e.body,o.splitLargeChunks);for await(const Pt of Vt){const{value:Un,done:In,sources:pn,error:fi,usage:Ji}=Pt;if(fi||In){t(23,le=!1),ce=null;break}st.content==""&&Un==`
`||(st.content+=Un,t(24,X.messages[Q]=bt,X),D&&un())}await En(Fe,X)}else console.error($e)}catch($e){console.error($e)}},tn=async Q=>{let we=r;return s?(we="local",await xu.set("local")):(Ce=await sF(localStorage.token,{id:we,title:l.t("New Chat"),models:se,system:o.system??void 0,params:Ne,history:Q,messages:da(Q,Q.currentId),tags:[],timestamp:Date.now()},a==null?void 0:a.id),we=Ce.id,await xu.set(we),window.history.replaceState(Q.state,"",`/c/${we}`),await hn(),await _c.set(await D0(localStorage.token,i)),Tl.set(1),n1.set(null)),await hn(),we},En=async(Q,we)=>{r==Q&&(s||(Ce=await cw(localStorage.token,Q,{models:se,history:we,messages:da(we,we.currentId),params:Ne,files:He}),Tl.set(1),await _c.set(await D0(localStorage.token,i))))};let mn=null;const Pn=async(Q,we=null)=>{mn&&clearTimeout(mn),Q.prompt!==null&&Q.prompt.length<Sle?mn=setTimeout(async()=>{await sessionStorage.setItem(`chat-input${we?`-${we}`:""}`,JSON.stringify(Q))},500):sessionStorage.removeItem(`chat-input${we?`-${we}`:""}`)},Bn=async(Q=null)=>{mn&&clearTimeout(mn),await sessionStorage.removeItem(`chat-input${Q?`-${Q}`:""}`)};function xl(Q){z=Q,t(10,z)}const wr=Q=>{Q.detail?J(Q.detail):J(!0)},om=()=>{J(!1)};function lm(Q){At[Q?"unshift":"push"](()=>{R=Q,t(9,R)})}function cm(Q){se=Q,t(0,se)}const hm=Q=>{M==null||M.setText(Q)};function um(Q){X=Q,t(24,X)}function dm(Q){D=Q,t(7,D)}function fm(Q){qe=Q,t(26,qe)}function gm(Q){At[Q?"unshift":"push"](()=>{H=Q,t(8,H)})}const mm=Q=>{t(7,D=H.scrollHeight-H.scrollTop<=H.clientHeight+5)},pm=Q=>{s||Pn(Q,r)};function bm(Q){At[Q?"unshift":"push"](()=>{M=Q,t(6,M)})}function xm(Q){Me=Q,t(28,Me)}function ym(Q){qe=Q,t(26,qe)}function wm(Q){D=Q,t(7,D)}function _m(Q){de=Q,t(17,de)}function ke(Q){ge=Q,t(18,ge)}function Gy(Q){N=Q,t(19,N)}function Vy(Q){oe=Q,t(21,oe)}function qy(Q){K=Q,t(20,K)}function Wy(Q){fe=Q,t(1,fe)}function Ky(Q){W=Q,t(22,W)}const Xy=async Q=>{const{type:we,data:Fe}=Q.detail;we==="web"?await Re(Fe):we==="youtube"?await Mt(Fe):we==="google-drive"&&await on(Fe)},Yy=async Q=>{Bn(),(Q.detail||Me.length>0)&&(await hn(),Ki((o==null?void 0:o.richTextInput)??!0?Q.detail.replaceAll(`

`,`
`):Q.detail))},Jy=Q=>{s||Pn(Q)};function Zy(Q){M=Q,t(6,M)}function Qy(Q){Me=Q,t(28,Me)}function $y(Q){qe=Q,t(26,qe)}function ew(Q){D=Q,t(7,D)}function tw(Q){de=Q,t(17,de)}function nw(Q){ge=Q,t(18,ge)}function iw(Q){N=Q,t(19,N)}function $(Q){oe=Q,t(21,oe)}function Ve(Q){K=Q,t(20,K)}function xt(Q){fe=Q,t(1,fe)}function wt(Q){W=Q,t(22,W)}const Ze=async Q=>{const{type:we,data:Fe}=Q.detail;we==="web"?await Re(Fe):we==="youtube"&&await Mt(Fe)},Tt=async Q=>{Bn(),(Q.detail||Me.length>0)&&(await hn(),Ki((o==null?void 0:o.richTextInput)??!0?Q.detail.replaceAll(`

`,`
`):Q.detail))},ii=(Q,we,Fe,bt)=>{const st=c.find($e=>$e.id===we);return st?[...Q,st]:Q};function fs(Q){At[Q?"unshift":"push"](()=>{T=Q,t(5,T)})}function _r(Q){X=Q,t(24,X)}function wi(Q){He=Q,t(27,He)}function ai(Q){Ne=Q,t(29,Ne)}function ci(Q){Me=Q,t(28,Me)}function jn(Q){E=Q,t(4,E)}return n.$$set=Q=>{"chatIdProp"in Q&&t(60,C=Q.chatIdProp)},n.$$.update=()=>{n.$$.dirty[0]&3&&t(2,he=fe!==void 0?[fe.id]:se),n.$$.dirty[1]&536870912&&C&&Qe(),n.$$.dirty[0]&1|n.$$.dirty[1]&536870912&&se&&C!==""&&mt(),n.$$.dirty[0]&4|n.$$.dirty[1]&1073741824&&JSON.stringify(he)!==JSON.stringify(Xe)&&rt()},[se,fe,he,k,E,T,M,D,H,R,z,P,B,Z,G,Y,J,de,ge,N,K,oe,W,le,X,Ke,qe,He,Me,Ne,s,r,a,o,c,d,f,y,w,_,v,I,gt,ct,on,Re,Mt,yt,di,Cs,Wi,Ki,yi,Ns,Oe,je,ht,Xt,Pn,Bn,C,Xe,xl,wr,om,lm,cm,hm,um,dm,fm,gm,mm,pm,bm,xm,ym,wm,_m,ke,Gy,Vy,qy,Wy,Ky,Xy,Yy,Jy,Zy,Qy,$y,ew,tw,nw,iw,$,Ve,xt,wt,Ze,Tt,ii,fs,_r,wi,ai,ci,jn]}class qce extends Nt{constructor(e){super(),Ot(this,e,Ile,Ale,Ft,{chatIdProp:60},null,[-1,-1,-1,-1,-1])}}export{qce as C};
//# sourceMappingURL=CiHQrilW.js.map
